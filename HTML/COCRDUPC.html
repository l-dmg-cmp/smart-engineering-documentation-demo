
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="COCRDSLC.html">
      
      
        <link rel="next" href="COMEN01C.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>COCRDUPC - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cocrdupc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              COCRDUPC
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT04C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDLIC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDSLC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="COCRDUPC.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-main" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-return" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON-RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-main-exit" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-process-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      1000-PROCESS-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-process-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1000-PROCESS-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-receive-map" class="md-nav__link">
    <span class="md-ellipsis">
      1100-RECEIVE-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-receive-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1100-RECEIVE-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-edit-map-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      1200-EDIT-MAP-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-edit-map-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1200-EDIT-MAP-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210-edit-account" class="md-nav__link">
    <span class="md-ellipsis">
      1210-EDIT-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210-edit-account-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1210-EDIT-ACCOUNT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1220-edit-card" class="md-nav__link">
    <span class="md-ellipsis">
      1220-EDIT-CARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1220-edit-card-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1220-EDIT-CARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1230-edit-name" class="md-nav__link">
    <span class="md-ellipsis">
      1230-EDIT-NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1230-edit-name-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1230-EDIT-NAME-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1240-edit-cardstatus" class="md-nav__link">
    <span class="md-ellipsis">
      1240-EDIT-CARDSTATUS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1240-edit-cardstatus-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1240-EDIT-CARDSTATUS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-edit-expiry-mon" class="md-nav__link">
    <span class="md-ellipsis">
      1250-EDIT-EXPIRY-MON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-edit-expiry-mon-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1250-EDIT-EXPIRY-MON-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1260-edit-expiry-year" class="md-nav__link">
    <span class="md-ellipsis">
      1260-EDIT-EXPIRY-YEAR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1260-edit-expiry-year-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1260-EDIT-EXPIRY-YEAR-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-decide-action" class="md-nav__link">
    <span class="md-ellipsis">
      2000-DECIDE-ACTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-decide-action-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2000-DECIDE-ACTION-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3000-send-map" class="md-nav__link">
    <span class="md-ellipsis">
      3000-SEND-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3000-send-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3000-SEND-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3100-screen-init" class="md-nav__link">
    <span class="md-ellipsis">
      3100-SCREEN-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3100-screen-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3100-SCREEN-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3200-setup-screen-vars" class="md-nav__link">
    <span class="md-ellipsis">
      3200-SETUP-SCREEN-VARS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3200-setup-screen-vars-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3200-SETUP-SCREEN-VARS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3250-setup-infomsg" class="md-nav__link">
    <span class="md-ellipsis">
      3250-SETUP-INFOMSG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3250-setup-infomsg-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3250-SETUP-INFOMSG-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3300-setup-screen-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      3300-SETUP-SCREEN-ATTRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3300-setup-screen-attrs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3300-SETUP-SCREEN-ATTRS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3400-send-screen" class="md-nav__link">
    <span class="md-ellipsis">
      3400-SEND-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3400-send-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3400-SEND-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-write-processing" class="md-nav__link">
    <span class="md-ellipsis">
      9200-WRITE-PROCESSING
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-write-processing-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9200-WRITE-PROCESSING-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-check-change-in-rec" class="md-nav__link">
    <span class="md-ellipsis">
      9300-CHECK-CHANGE-IN-REC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-check-change-in-rec-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9300-CHECK-CHANGE-IN-REC-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abend-routine" class="md-nav__link">
    <span class="md-ellipsis">
      ABEND-ROUTINE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abend-routine-exit" class="md-nav__link">
    <span class="md-ellipsis">
      ABEND-ROUTINE-EXIT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CORPT00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-main" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-return" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON-RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-main-exit" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-process-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      1000-PROCESS-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-process-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1000-PROCESS-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-receive-map" class="md-nav__link">
    <span class="md-ellipsis">
      1100-RECEIVE-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-receive-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1100-RECEIVE-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-edit-map-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      1200-EDIT-MAP-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-edit-map-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1200-EDIT-MAP-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210-edit-account" class="md-nav__link">
    <span class="md-ellipsis">
      1210-EDIT-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210-edit-account-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1210-EDIT-ACCOUNT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1220-edit-card" class="md-nav__link">
    <span class="md-ellipsis">
      1220-EDIT-CARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1220-edit-card-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1220-EDIT-CARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1230-edit-name" class="md-nav__link">
    <span class="md-ellipsis">
      1230-EDIT-NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1230-edit-name-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1230-EDIT-NAME-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1240-edit-cardstatus" class="md-nav__link">
    <span class="md-ellipsis">
      1240-EDIT-CARDSTATUS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1240-edit-cardstatus-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1240-EDIT-CARDSTATUS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-edit-expiry-mon" class="md-nav__link">
    <span class="md-ellipsis">
      1250-EDIT-EXPIRY-MON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-edit-expiry-mon-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1250-EDIT-EXPIRY-MON-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1260-edit-expiry-year" class="md-nav__link">
    <span class="md-ellipsis">
      1260-EDIT-EXPIRY-YEAR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1260-edit-expiry-year-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1260-EDIT-EXPIRY-YEAR-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-decide-action" class="md-nav__link">
    <span class="md-ellipsis">
      2000-DECIDE-ACTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-decide-action-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2000-DECIDE-ACTION-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3000-send-map" class="md-nav__link">
    <span class="md-ellipsis">
      3000-SEND-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3000-send-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3000-SEND-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3100-screen-init" class="md-nav__link">
    <span class="md-ellipsis">
      3100-SCREEN-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3100-screen-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3100-SCREEN-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3200-setup-screen-vars" class="md-nav__link">
    <span class="md-ellipsis">
      3200-SETUP-SCREEN-VARS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3200-setup-screen-vars-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3200-SETUP-SCREEN-VARS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3250-setup-infomsg" class="md-nav__link">
    <span class="md-ellipsis">
      3250-SETUP-INFOMSG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3250-setup-infomsg-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3250-SETUP-INFOMSG-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3300-setup-screen-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      3300-SETUP-SCREEN-ATTRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3300-setup-screen-attrs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3300-SETUP-SCREEN-ATTRS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3400-send-screen" class="md-nav__link">
    <span class="md-ellipsis">
      3400-SEND-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3400-send-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      3400-SEND-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-write-processing" class="md-nav__link">
    <span class="md-ellipsis">
      9200-WRITE-PROCESSING
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-write-processing-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9200-WRITE-PROCESSING-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-check-change-in-rec" class="md-nav__link">
    <span class="md-ellipsis">
      9300-CHECK-CHANGE-IN-REC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-check-change-in-rec-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9300-CHECK-CHANGE-IN-REC-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abend-routine" class="md-nav__link">
    <span class="md-ellipsis">
      ABEND-ROUTINE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abend-routine-exit" class="md-nav__link">
    <span class="md-ellipsis">
      ABEND-ROUTINE-EXIT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cocrdupc">COCRDUPC</h1>
<h2 id="overview">Overview</h2>
<p>This program, COCRDUPC, is a business logic component of the CardDemo application that handles credit card detail updates. It provides a CICS transaction interface for users to modify credit card information such as the embossed name, expiration date, and active status. The program follows a structured workflow where it first retrieves card details based on account and card number inputs, displays them to the user, validates any changes made, and then updates the card record in the database after confirmation. It includes comprehensive input validation for all fields, handles various error conditions (such as record locking issues or concurrent updates), and provides appropriate user feedback through status messages. The program integrates with other components of the CardDemo system through a shared communication area and maintains proper transaction integrity using CICS commands for reading, updating, and synchronizing data operations.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>COCRDUPC</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    actor User
    participant Main as 0000-MAIN
    participant ProcessInputs as 1000-PROCESS-INPUTS
    participant DecideAction as 2000-DECIDE-ACTION
    participant SendMap as 3000-SEND-MAP
    participant ReadData as 9000-READ-DATA
    participant WriteProcessing as 9200-WRITE-PROCESSING
    participant CICS as CICS System

    User-&gt;&gt;Main: Start transaction
    activate Main

    Main-&gt;&gt;CICS: HANDLE ABEND
    Main-&gt;&gt;Main: Initialize working storage

    alt First time entry or from menu
        Main-&gt;&gt;Main: Initialize commarea
        Main-&gt;&gt;SendMap: Display initial screen
        SendMap--&gt;&gt;User: Show search screen
    else Coming from card list screen
        Main-&gt;&gt;ReadData: Fetch card details
        ReadData-&gt;&gt;CICS: READ card file
        CICS--&gt;&gt;ReadData: Return card data
        Main-&gt;&gt;SendMap: Display card details
        SendMap--&gt;&gt;User: Show card details
    else Processing user input
        Main-&gt;&gt;ProcessInputs: Process map inputs
        activate ProcessInputs
        ProcessInputs-&gt;&gt;CICS: RECEIVE MAP
        CICS--&gt;&gt;ProcessInputs: Return user input
        ProcessInputs-&gt;&gt;ProcessInputs: Validate inputs
        deactivate ProcessInputs

        Main-&gt;&gt;DecideAction: Determine next action
        activate DecideAction

        alt No details fetched yet
            DecideAction-&gt;&gt;ReadData: Retrieve card data
            ReadData-&gt;&gt;CICS: READ card file
            CICS--&gt;&gt;ReadData: Return card data
        else Changes made and confirmed
            DecideAction-&gt;&gt;WriteProcessing: Update card record
            activate WriteProcessing
            WriteProcessing-&gt;&gt;CICS: READ with UPDATE
            CICS--&gt;&gt;WriteProcessing: Return locked record
            WriteProcessing-&gt;&gt;WriteProcessing: Check for concurrent changes
            WriteProcessing-&gt;&gt;CICS: REWRITE record
            CICS--&gt;&gt;WriteProcessing: Update confirmation
            deactivate WriteProcessing
        end

        deactivate DecideAction

        Main-&gt;&gt;SendMap: Display appropriate screen
        SendMap--&gt;&gt;User: Show updated screen
    end

    alt User pressed PF03 or finished
        Main-&gt;&gt;CICS: SYNCPOINT
        Main-&gt;&gt;CICS: XCTL to next program
    else Continue processing
        Main-&gt;&gt;CICS: RETURN with commarea
    end

    deactivate Main</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CSDAT01Y.html"><code>CSDAT01Y</code></a></li>
<li><code>DFHAID</code></li>
<li><a href="copybooks/CVCUS01Y.html"><code>CVCUS01Y</code></a></li>
<li><a href="copybooks/CVACT01Y.html"><code>CVACT01Y</code></a></li>
<li><a href="copybooks/CSUSR01Y.html"><code>CSUSR01Y</code></a></li>
<li><a href="copybooks/COCOM01Y.html"><code>COCOM01Y</code></a></li>
<li><a href="copybooks/CVCRD01Y.html"><code>CVCRD01Y</code></a></li>
<li><a href="copybooks/CSSTRPFY.html"><code>CSSTRPFY</code></a></li>
<li><code>DFHBMSCA</code></li>
<li><a href="copybooks/CVACT03Y.html"><code>CVACT03Y</code></a></li>
<li><a href="copybooks/CVACT02Y.html"><code>CVACT02Y</code></a></li>
<li><a href="copybooks/COTTL01Y.html"><code>COTTL01Y</code></a></li>
<li><a href="copybooks/CSMSG02Y.html"><code>CSMSG02Y</code></a></li>
<li><a href="copybooks/CSMSG01Y.html"><code>CSMSG01Y</code></a></li>
<li><code>COCRDUP</code></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="input-output-section">INPUT-OUTPUT SECTION</h3>
<p>This section would typically contain the INPUT-OUTPUT SECTION of the COCRDUPC program, which would define file assignments and external resources used by the program. However, the provided snippet is empty, suggesting that this program likely doesn't directly interact with physical files but instead relies on CICS commands for data access and manipulation. This is consistent with the program's role as a CICS transaction interface for credit card updates, where data access would be handled through CICS services rather than direct file operations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This working storage section defines the data structures used in the COCRDUPC program for credit card detail updates. It contains several key components:</p>
<ol>
<li>CICS processing variables for handling responses and transaction IDs</li>
<li>Extensive input validation flags and fields for each card attribute (account number, card number, embossed name, status, expiration date)</li>
<li>Data conversion fields for numeric/alphanumeric transformations</li>
<li>File handling structures including record identifiers and error message formatting</li>
<li>Message construction areas for user feedback, including predefined status messages for various scenarios (success, validation errors, record locking)</li>
<li>Program constants and literals defining transaction IDs, program names, mapsets, and valid character sets</li>
<li>A program-specific communication area (WS-THIS-PROGCOMMAREA) that maintains both old and new card details to track changes</li>
<li>References to numerous copybooks for common structures including card record layouts, screen definitions, date handling, and user information</li>
</ol>
<p>The section is particularly focused on supporting the validation and update workflow, with comprehensive error handling for all possible input conditions and database operations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">01  WS</span><span class="o">-</span><span class="nv">MISC-STORAGE</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      * General CICS related                                                    </span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-CICS-PROCESSNG-VARS</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-RESP-CD</span><span class="w">                          </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-REAS-CD</span><span class="w">                          </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-TRANID</span><span class="w">                           </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-UCTRANS</span><span class="w">                          </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c">      *      Input edits                                                        </span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-INPUT-FLAG</span><span class="w">                         </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-OK</span><span class="w">                            </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-ERROR</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-PENDING</span><span class="w">                       </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-ACCT-FLAG</span><span class="w">                     </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARD-FLAG</span><span class="w">                     </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">             </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARDNAME-FLAG</span><span class="w">                 </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDNAME-NOT-OK</span><span class="w">                 </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDNAME-ISVALID</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDNAME-BLANK</span><span class="w">                  </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARDSTATUS-FLAG</span><span class="w">              </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDSTATUS-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDSTATUS-ISVALID</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDSTATUS-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARDEXPMON-FLAG</span><span class="w">              </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDEXPMON-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDEXPMON-ISVALID</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDEXPMON-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARDEXPYEAR-FLAG</span><span class="w">             </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDEXPYEAR-NOT-OK</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDEXPYEAR-ISVALID</span><span class="w">             </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDEXPYEAR-BLANK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-RETURN-FLAG</span><span class="w">                        </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-FLAG-OFF</span><span class="w">                  </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-FLAG-ON</span><span class="w">                   </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-PFK-FLAG</span><span class="w">                           </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PFK-VALID</span><span class="w">                           </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PFK-INVALID</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">CARD-NAME-CHECK</span><span class="w">                       </span><span class="kt">PIC X(50)                    </span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">FLG-YES-NO-CHECK</span><span class="w">                      </span><span class="kt">PIC X(1)                     </span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">FLG-YES-NO-VALID</span><span class="w">                     </span><span class="kp">VALUES </span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">CARD-MONTH-CHECK</span><span class="w">                      </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">CARD-MONTH-CHECK-N</span><span class="w"> </span><span class="kp">REDEFINES                                       </span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="kp">            </span><span class="w"> </span><span class="nv">CARD-MONTH-CHECK</span><span class="w">                      </span><span class="kt">PIC 9(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="c">      </span><span class="w">       </span><span class="mi">88 </span><span class="nv">VALID-MONTH</span><span class="w">                        </span><span class="kp">VALUES</span><span class="w"> </span><span class="mi">1 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">12</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">CARD-YEAR-CHECK</span><span class="w">                      </span><span class="kt">PIC X(4)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">CARD-YEAR-CHECK-N</span><span class="w"> </span><span class="kp">REDEFINES                                        </span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="kp">            </span><span class="w"> </span><span class="nv">CARD-YEAR-CHECK</span><span class="w">                      </span><span class="kt">PIC 9(4)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="c">      </span><span class="w">       </span><span class="mi">88 </span><span class="nv">VALID-YEAR</span><span class="w">                        </span><span class="kp">VALUES</span><span class="w"> </span><span class="mi">1950 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2099</span><span class="p">.</span><span class="w">        </span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="c">      * Output edits                                                            </span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">CICS-OUTPUT-EDIT-VARS</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-ACCT-ID-X</span><span class="w">                      </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-ACCT-ID-N</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">CARD-ACCT-ID-X</span><span class="w">                          </span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                       </span><span class="kt">PIC X(03)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CVV-CD-N</span><span class="w"> </span><span class="kp">REDEFINES </span><span class="w"> </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                           </span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(03)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CARD-NUM-X</span><span class="w">                     </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CARD-NUM-N</span><span class="w"> </span><span class="kp">REDEFINES </span><span class="w"> </span><span class="nv">CARD-CARD-NUM-X</span><span class="w">                       </span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-NAME-EMBOSSED-X</span><span class="w">                </span><span class="kt">PIC X(50)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-STATUS-X</span><span class="w">                       </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                       </span>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="w">               </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">CARD-EXPIRY-YEAR</span><span class="w">                 </span><span class="kt">PIC X(4)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="kp">FILLER                          </span><span class="w"> </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">CARD-EXPIRY-MONTH</span><span class="w">                </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="kp">FILLER                          </span><span class="w"> </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">CARD-EXPIRY-DAY</span><span class="w">                  </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-EXPIRAION-DATE-N</span><span class="w"> </span><span class="kp">REDEFINES                                  </span>
<a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a><span class="kp">              </span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="w">               </span><span class="kt">PIC 9(10)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a>
<a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a><span class="c">      *      File and data Handling                                             </span>
<a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-CARD-RID</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                 </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="w">                 </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">WS-CARD-RID-ACCT-ID-X</span><span class="w"> </span><span class="kp">REDEFINES                                  </span>
<a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a><span class="kp">                 </span><span class="w"> </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="w">              </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(12)                    </span>
<a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;File Error: &#39;</span><span class="p">.</span><span class="w">        </span>
<a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-OPNAME</span><span class="w">                        </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39; on &#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-FILE</span><span class="w">                          </span><span class="kt">PIC X(9)                     </span>
<a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(15)                    </span>
<a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a><span class="kp">                                                   </span><span class="s1">&#39; returned RESP &#39;</span><span class="p">.</span><span class="w">           </span>
<a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-RESP</span><span class="w">                          </span><span class="kt">PIC X(10)                    </span>
<a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;,RESP2 &#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-RESP2</span><span class="w">                         </span><span class="kt">PIC X(10)                    </span>
<a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a><span class="c">      </span><span class="w">    </span><span class="mi">10  </span><span class="kp">FILLER                              </span><span class="w"> </span><span class="kt">PIC X(5)                     </span>
<a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-119" name="__codelineno-1-119" href="#__codelineno-1-119"></a><span class="c">      *      Output Message Construction                                        </span>
<a id="__codelineno-1-120" name="__codelineno-1-120" href="#__codelineno-1-120"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-121" name="__codelineno-1-121" href="#__codelineno-1-121"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-LONG-MSG</span><span class="w">                           </span><span class="kt">PIC X(500)</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-122" name="__codelineno-1-122" href="#__codelineno-1-122"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-INFO-MSG</span><span class="w">                           </span><span class="kt">PIC X(40)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-123" name="__codelineno-1-123" href="#__codelineno-1-123"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                 </span><span class="kp">VALUES                        </span>
<a id="__codelineno-1-124" name="__codelineno-1-124" href="#__codelineno-1-124"></a><span class="kp">                                                 </span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-125" name="__codelineno-1-125" href="#__codelineno-1-125"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">             </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-126" name="__codelineno-1-126" href="#__codelineno-1-126"></a><span class="kp">               </span><span class="s1">&#39;Details of selected card shown above&#39;</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-1-127" name="__codelineno-1-127" href="#__codelineno-1-127"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PROMPT-FOR-SEARCH-KEYS</span><span class="w">              </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-128" name="__codelineno-1-128" href="#__codelineno-1-128"></a><span class="kp">               </span><span class="s1">&#39;Please enter Account and Card Number&#39;</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-1-129" name="__codelineno-1-129" href="#__codelineno-1-129"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PROMPT-FOR-CHANGES</span><span class="w">                  </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-130" name="__codelineno-1-130" href="#__codelineno-1-130"></a><span class="kp">               </span><span class="s1">&#39;Update card details presented above.&#39;</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-1-131" name="__codelineno-1-131" href="#__codelineno-1-131"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PROMPT-FOR-CONFIRMATION</span><span class="w">             </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-132" name="__codelineno-1-132" href="#__codelineno-1-132"></a><span class="kp">               </span><span class="s1">&#39;Changes validated.Press F5 to save&#39;</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-1-133" name="__codelineno-1-133" href="#__codelineno-1-133"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">CONFIRM-UPDATE-SUCCESS</span><span class="w">              </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-134" name="__codelineno-1-134" href="#__codelineno-1-134"></a><span class="kp">               </span><span class="s1">&#39;Changes committed to database&#39;</span><span class="p">.</span><span class="w">                                 </span>
<a id="__codelineno-1-135" name="__codelineno-1-135" href="#__codelineno-1-135"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INFORM-FAILURE</span><span class="w">                      </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-136" name="__codelineno-1-136" href="#__codelineno-1-136"></a><span class="kp">               </span><span class="s1">&#39;Changes unsuccessful. Please try again&#39;</span><span class="p">.</span><span class="w">                        </span>
<a id="__codelineno-1-137" name="__codelineno-1-137" href="#__codelineno-1-137"></a>
<a id="__codelineno-1-138" name="__codelineno-1-138" href="#__codelineno-1-138"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-RETURN-MSG</span><span class="w">                         </span><span class="kt">PIC X(75)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-139" name="__codelineno-1-139" href="#__codelineno-1-139"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                   </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-140" name="__codelineno-1-140" href="#__codelineno-1-140"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-EXIT-MESSAGE</span><span class="w">                     </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-141" name="__codelineno-1-141" href="#__codelineno-1-141"></a><span class="kp">               </span><span class="s1">&#39;PF03 pressed.Exiting              &#39;</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-1-142" name="__codelineno-1-142" href="#__codelineno-1-142"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-PROMPT-FOR-ACCT</span><span class="w">                  </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-143" name="__codelineno-1-143" href="#__codelineno-1-143"></a><span class="kp">               </span><span class="s1">&#39;Account number not provided&#39;</span><span class="p">.</span><span class="w">                                   </span>
<a id="__codelineno-1-144" name="__codelineno-1-144" href="#__codelineno-1-144"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-PROMPT-FOR-CARD</span><span class="w">                  </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-145" name="__codelineno-1-145" href="#__codelineno-1-145"></a><span class="kp">               </span><span class="s1">&#39;Card number not provided&#39;</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-146" name="__codelineno-1-146" href="#__codelineno-1-146"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-PROMPT-FOR-NAME</span><span class="w">                  </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-147" name="__codelineno-1-147" href="#__codelineno-1-147"></a><span class="kp">               </span><span class="s1">&#39;Card name not provided&#39;</span><span class="p">.</span><span class="w">                                        </span>
<a id="__codelineno-1-148" name="__codelineno-1-148" href="#__codelineno-1-148"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-NAME-MUST-BE-ALPHA</span><span class="w">               </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-149" name="__codelineno-1-149" href="#__codelineno-1-149"></a><span class="kp">               </span><span class="s1">&#39;Card name can only contain alphabets and spaces&#39;</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-150" name="__codelineno-1-150" href="#__codelineno-1-150"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">NO-SEARCH-CRITERIA-RECEIVED</span><span class="w">         </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-151" name="__codelineno-1-151" href="#__codelineno-1-151"></a><span class="kp">               </span><span class="s1">&#39;No input received&#39;</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-152" name="__codelineno-1-152" href="#__codelineno-1-152"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">NO-CHANGES-DETECTED</span><span class="w">                 </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-153" name="__codelineno-1-153" href="#__codelineno-1-153"></a><span class="kp">               </span><span class="s1">&#39;No change detected with respect to values fetched.&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-154" name="__codelineno-1-154" href="#__codelineno-1-154"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">SEARCHED-ACCT-ZEROES</span><span class="w">                </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-155" name="__codelineno-1-155" href="#__codelineno-1-155"></a><span class="kp">               </span><span class="s1">&#39;Account number must be a non zero 11 digit number&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-156" name="__codelineno-1-156" href="#__codelineno-1-156"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">SEARCHED-ACCT-NOT-NUMERIC</span><span class="w">           </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-157" name="__codelineno-1-157" href="#__codelineno-1-157"></a><span class="kp">               </span><span class="s1">&#39;Account number must be a non zero 11 digit number&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-158" name="__codelineno-1-158" href="#__codelineno-1-158"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">SEARCHED-CARD-NOT-NUMERIC</span><span class="w">           </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-159" name="__codelineno-1-159" href="#__codelineno-1-159"></a><span class="kp">               </span><span class="s1">&#39;Card number if supplied must be a 16 digit number&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-160" name="__codelineno-1-160" href="#__codelineno-1-160"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">CARD-STATUS-MUST-BE-YES-NO</span><span class="w">          </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-161" name="__codelineno-1-161" href="#__codelineno-1-161"></a><span class="kp">               </span><span class="s1">&#39;Card Active Status must be Y or N&#39;</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-1-162" name="__codelineno-1-162" href="#__codelineno-1-162"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">CARD-EXPIRY-MONTH-NOT-VALID</span><span class="w">          </span><span class="kp">VALUE                       </span>
<a id="__codelineno-1-163" name="__codelineno-1-163" href="#__codelineno-1-163"></a><span class="kp">               </span><span class="s1">&#39;Card expiry month must be between 1 and 12&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-164" name="__codelineno-1-164" href="#__codelineno-1-164"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">CARD-EXPIRY-YEAR-NOT-VALID</span><span class="w">          </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-165" name="__codelineno-1-165" href="#__codelineno-1-165"></a><span class="kp">               </span><span class="s1">&#39;Invalid card expiry year&#39;</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-166" name="__codelineno-1-166" href="#__codelineno-1-166"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">DID-NOT-FIND-ACCT-IN-CARDXREF</span><span class="w">       </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-167" name="__codelineno-1-167" href="#__codelineno-1-167"></a><span class="kp">               </span><span class="s1">&#39;Did not find this account in cards database&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-168" name="__codelineno-1-168" href="#__codelineno-1-168"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">DID-NOT-FIND-ACCTCARD-COMBO</span><span class="w">         </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-169" name="__codelineno-1-169" href="#__codelineno-1-169"></a><span class="kp">               </span><span class="s1">&#39;Did not find cards for this search condition&#39;</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-170" name="__codelineno-1-170" href="#__codelineno-1-170"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">COULD-NOT-LOCK-FOR-UPDATE</span><span class="w">           </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-171" name="__codelineno-1-171" href="#__codelineno-1-171"></a><span class="kp">               </span><span class="s1">&#39;Could not lock record for update&#39;</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-1-172" name="__codelineno-1-172" href="#__codelineno-1-172"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">DATA-WAS-CHANGED-BEFORE-UPDATE</span><span class="w">      </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-173" name="__codelineno-1-173" href="#__codelineno-1-173"></a><span class="kp">               </span><span class="s1">&#39;Record changed by some one else. Please review&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-174" name="__codelineno-1-174" href="#__codelineno-1-174"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">LOCKED-BUT-UPDATE-FAILED</span><span class="w">            </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-175" name="__codelineno-1-175" href="#__codelineno-1-175"></a><span class="kp">               </span><span class="s1">&#39;Update of record failed&#39;</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-1-176" name="__codelineno-1-176" href="#__codelineno-1-176"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">XREF-READ-ERROR</span><span class="w">                     </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-177" name="__codelineno-1-177" href="#__codelineno-1-177"></a><span class="kp">               </span><span class="s1">&#39;Error reading Card Data File&#39;</span><span class="p">.</span><span class="w">                                  </span>
<a id="__codelineno-1-178" name="__codelineno-1-178" href="#__codelineno-1-178"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">CODING-TO-BE-DONE</span><span class="w">                   </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-179" name="__codelineno-1-179" href="#__codelineno-1-179"></a><span class="kp">               </span><span class="s1">&#39;Looks Good.... so far&#39;</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-1-180" name="__codelineno-1-180" href="#__codelineno-1-180"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-181" name="__codelineno-1-181" href="#__codelineno-1-181"></a><span class="c">      *      Literals and Constants                                             </span>
<a id="__codelineno-1-182" name="__codelineno-1-182" href="#__codelineno-1-182"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-183" name="__codelineno-1-183" href="#__codelineno-1-183"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-LITERALS</span><span class="p">.</span><span class="w">                                                          </span>
<a id="__codelineno-1-184" name="__codelineno-1-184" href="#__codelineno-1-184"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISPGM</span><span class="w">                           </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-185" name="__codelineno-1-185" href="#__codelineno-1-185"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDUPC&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-186" name="__codelineno-1-186" href="#__codelineno-1-186"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISTRANID</span><span class="w">                        </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-187" name="__codelineno-1-187" href="#__codelineno-1-187"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCUP&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-188" name="__codelineno-1-188" href="#__codelineno-1-188"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISMAPSET</span><span class="w">                        </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-189" name="__codelineno-1-189" href="#__codelineno-1-189"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDUP &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-190" name="__codelineno-1-190" href="#__codelineno-1-190"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISMAP</span><span class="w">                           </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-191" name="__codelineno-1-191" href="#__codelineno-1-191"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDUPA&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-192" name="__codelineno-1-192" href="#__codelineno-1-192"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                         </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-193" name="__codelineno-1-193" href="#__codelineno-1-193"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDLIC&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-194" name="__codelineno-1-194" href="#__codelineno-1-194"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTTRANID</span><span class="w">                      </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-195" name="__codelineno-1-195" href="#__codelineno-1-195"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCLI&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-196" name="__codelineno-1-196" href="#__codelineno-1-196"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTMAPSET</span><span class="w">                      </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-197" name="__codelineno-1-197" href="#__codelineno-1-197"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDLI&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-198" name="__codelineno-1-198" href="#__codelineno-1-198"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTMAP</span><span class="w">                         </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-199" name="__codelineno-1-199" href="#__codelineno-1-199"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDSLA&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-200" name="__codelineno-1-200" href="#__codelineno-1-200"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUPGM</span><span class="w">                           </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-201" name="__codelineno-1-201" href="#__codelineno-1-201"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN01C&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-202" name="__codelineno-1-202" href="#__codelineno-1-202"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUTRANID</span><span class="w">                        </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-203" name="__codelineno-1-203" href="#__codelineno-1-203"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CM00&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-204" name="__codelineno-1-204" href="#__codelineno-1-204"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUMAPSET</span><span class="w">                        </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-205" name="__codelineno-1-205" href="#__codelineno-1-205"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN01&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-206" name="__codelineno-1-206" href="#__codelineno-1-206"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUMAP</span><span class="w">                           </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-207" name="__codelineno-1-207" href="#__codelineno-1-207"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN1A&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-208" name="__codelineno-1-208" href="#__codelineno-1-208"></a><span class="c">      </span><span class="w">    </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLPGM</span><span class="w">                       </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-209" name="__codelineno-1-209" href="#__codelineno-1-209"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDSLC&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-210" name="__codelineno-1-210" href="#__codelineno-1-210"></a><span class="c">      </span><span class="w">    </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLTRANID</span><span class="w">                    </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-211" name="__codelineno-1-211" href="#__codelineno-1-211"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCDL&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-212" name="__codelineno-1-212" href="#__codelineno-1-212"></a><span class="c">      </span><span class="w">    </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLMAPSET</span><span class="w">                    </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-213" name="__codelineno-1-213" href="#__codelineno-1-213"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDSL&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-214" name="__codelineno-1-214" href="#__codelineno-1-214"></a><span class="c">      </span><span class="w">    </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLMAP</span><span class="w">                       </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-215" name="__codelineno-1-215" href="#__codelineno-1-215"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDSLA&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-216" name="__codelineno-1-216" href="#__codelineno-1-216"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CARDFILENAME</span><span class="w">                      </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-217" name="__codelineno-1-217" href="#__codelineno-1-217"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CARDDAT &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-218" name="__codelineno-1-218" href="#__codelineno-1-218"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CARDFILENAME-ACCT-PATH</span><span class="w">            </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-219" name="__codelineno-1-219" href="#__codelineno-1-219"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CARDAIX &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-220" name="__codelineno-1-220" href="#__codelineno-1-220"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-ALL-ALPHA-FROM</span><span class="w">                    </span><span class="kt">PIC X(52)                    </span>
<a id="__codelineno-1-221" name="__codelineno-1-221" href="#__codelineno-1-221"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE                                                              </span>
<a id="__codelineno-1-222" name="__codelineno-1-222" href="#__codelineno-1-222"></a><span class="kp">             </span><span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-223" name="__codelineno-1-223" href="#__codelineno-1-223"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-ALL-SPACES-TO</span><span class="w">                     </span><span class="kt">PIC X(52)                    </span>
<a id="__codelineno-1-224" name="__codelineno-1-224" href="#__codelineno-1-224"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-225" name="__codelineno-1-225" href="#__codelineno-1-225"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-UPPER</span><span class="w">                             </span><span class="kt">PIC X(26)                    </span>
<a id="__codelineno-1-226" name="__codelineno-1-226" href="#__codelineno-1-226"></a><span class="kt">                                </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-227" name="__codelineno-1-227" href="#__codelineno-1-227"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-LOWER</span><span class="w">                             </span><span class="kt">PIC X(26)                    </span>
<a id="__codelineno-1-228" name="__codelineno-1-228" href="#__codelineno-1-228"></a><span class="kt">                                </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-229" name="__codelineno-1-229" href="#__codelineno-1-229"></a>
<a id="__codelineno-1-230" name="__codelineno-1-230" href="#__codelineno-1-230"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-231" name="__codelineno-1-231" href="#__codelineno-1-231"></a><span class="c">      *Other common working storage Variables                                   </span>
<a id="__codelineno-1-232" name="__codelineno-1-232" href="#__codelineno-1-232"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-233" name="__codelineno-1-233" href="#__codelineno-1-233"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVCRD01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-234" name="__codelineno-1-234" href="#__codelineno-1-234"></a>
<a id="__codelineno-1-235" name="__codelineno-1-235" href="#__codelineno-1-235"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-236" name="__codelineno-1-236" href="#__codelineno-1-236"></a><span class="c">      *Application Commmarea Copybook                                           </span>
<a id="__codelineno-1-237" name="__codelineno-1-237" href="#__codelineno-1-237"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCOM01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-238" name="__codelineno-1-238" href="#__codelineno-1-238"></a>
<a id="__codelineno-1-239" name="__codelineno-1-239" href="#__codelineno-1-239"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="p">.</span><span class="w">                                                 </span>
<a id="__codelineno-1-240" name="__codelineno-1-240" href="#__codelineno-1-240"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CARD-UPDATE-SCREEN-DATA</span><span class="p">.</span><span class="w">                                           </span>
<a id="__codelineno-1-241" name="__codelineno-1-241" href="#__codelineno-1-241"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-CHANGE-ACTION</span><span class="w">                 </span><span class="kt">PIC X(1)                     </span>
<a id="__codelineno-1-242" name="__codelineno-1-242" href="#__codelineno-1-242"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-243" name="__codelineno-1-243" href="#__codelineno-1-243"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">        </span><span class="kp">VALUES                       </span>
<a id="__codelineno-1-244" name="__codelineno-1-244" href="#__codelineno-1-244"></a><span class="kp">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">,</span><span class="w">                  </span>
<a id="__codelineno-1-245" name="__codelineno-1-245" href="#__codelineno-1-245"></a><span class="c">      </span><span class="w">                                             </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-246" name="__codelineno-1-246" href="#__codelineno-1-246"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;S&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-247" name="__codelineno-1-247" href="#__codelineno-1-247"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-MADE</span><span class="w">               </span><span class="kp">VALUES </span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w">              </span>
<a id="__codelineno-1-248" name="__codelineno-1-248" href="#__codelineno-1-248"></a><span class="c">      </span><span class="w">                                                  </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="w">              </span>
<a id="__codelineno-1-249" name="__codelineno-1-249" href="#__codelineno-1-249"></a><span class="c">      </span><span class="w">                                                  </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-250" name="__codelineno-1-250" href="#__codelineno-1-250"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">             </span><span class="kp">VALUE </span><span class="s1">&#39;E&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-251" name="__codelineno-1-251" href="#__codelineno-1-251"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w">   </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-252" name="__codelineno-1-252" href="#__codelineno-1-252"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">    </span><span class="kp">VALUE </span><span class="s1">&#39;C&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-253" name="__codelineno-1-253" href="#__codelineno-1-253"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-FAILED</span><span class="w">             </span><span class="kp">VALUES </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-254" name="__codelineno-1-254" href="#__codelineno-1-254"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-OKAYED-LOCK-ERROR</span><span class="w">  </span><span class="kp">VALUE </span><span class="s1">&#39;L&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-255" name="__codelineno-1-255" href="#__codelineno-1-255"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">CCUP-CHANGES-OKAYED-BUT-FAILED</span><span class="w">  </span><span class="kp">VALUE </span><span class="s1">&#39;F&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-256" name="__codelineno-1-256" href="#__codelineno-1-256"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CCUP-OLD-DETAILS</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-257" name="__codelineno-1-257" href="#__codelineno-1-257"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-OLD-ACCTID</span><span class="w">                    </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-258" name="__codelineno-1-258" href="#__codelineno-1-258"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-OLD-CARDID</span><span class="w">                    </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-259" name="__codelineno-1-259" href="#__codelineno-1-259"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-OLD-CVV-CD</span><span class="w">                    </span><span class="kt">PIC X(3)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-260" name="__codelineno-1-260" href="#__codelineno-1-260"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-OLD-CARDDATA</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-261" name="__codelineno-1-261" href="#__codelineno-1-261"></a><span class="c">      </span><span class="w">          </span><span class="mi">20 </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">                </span><span class="kt">PIC X(50)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-262" name="__codelineno-1-262" href="#__codelineno-1-262"></a><span class="c">      </span><span class="w">          </span><span class="mi">20 </span><span class="nv">CCUP-OLD-EXPIRAION-DATE</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-1-263" name="__codelineno-1-263" href="#__codelineno-1-263"></a><span class="c">      </span><span class="w">             </span><span class="mi">25 </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">             </span><span class="kt">PIC X(4)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-264" name="__codelineno-1-264" href="#__codelineno-1-264"></a><span class="c">      </span><span class="w">             </span><span class="mi">25 </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">              </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-265" name="__codelineno-1-265" href="#__codelineno-1-265"></a><span class="c">      </span><span class="w">             </span><span class="mi">25 </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">              </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-266" name="__codelineno-1-266" href="#__codelineno-1-266"></a><span class="c">      </span><span class="w">          </span><span class="mi">20 </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">                </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-267" name="__codelineno-1-267" href="#__codelineno-1-267"></a>
<a id="__codelineno-1-268" name="__codelineno-1-268" href="#__codelineno-1-268"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CCUP-NEW-DETAILS</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-269" name="__codelineno-1-269" href="#__codelineno-1-269"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-NEW-ACCTID</span><span class="w">                    </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-270" name="__codelineno-1-270" href="#__codelineno-1-270"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">                    </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-271" name="__codelineno-1-271" href="#__codelineno-1-271"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-NEW-CVV-CD</span><span class="w">                    </span><span class="kt">PIC X(3)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-272" name="__codelineno-1-272" href="#__codelineno-1-272"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CCUP-NEW-CARDDATA</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-273" name="__codelineno-1-273" href="#__codelineno-1-273"></a><span class="c">      </span><span class="w">          </span><span class="mi">20 </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">                </span><span class="kt">PIC X(50)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-274" name="__codelineno-1-274" href="#__codelineno-1-274"></a><span class="c">      </span><span class="w">          </span><span class="mi">20 </span><span class="nv">CCUP-NEW-EXPIRAION-DATE</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-1-275" name="__codelineno-1-275" href="#__codelineno-1-275"></a><span class="c">      </span><span class="w">             </span><span class="mi">25 </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">             </span><span class="kt">PIC X(4)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-276" name="__codelineno-1-276" href="#__codelineno-1-276"></a><span class="c">      </span><span class="w">             </span><span class="mi">25 </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">              </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-277" name="__codelineno-1-277" href="#__codelineno-1-277"></a><span class="c">      </span><span class="w">             </span><span class="mi">25 </span><span class="nv">CCUP-NEW-EXPDAY</span><span class="w">              </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-278" name="__codelineno-1-278" href="#__codelineno-1-278"></a><span class="c">      </span><span class="w">          </span><span class="mi">20 </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">                </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-279" name="__codelineno-1-279" href="#__codelineno-1-279"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CARD-UPDATE-RECORD</span><span class="p">.</span><span class="w">                                                </span>
<a id="__codelineno-1-280" name="__codelineno-1-280" href="#__codelineno-1-280"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CARD-UPDATE-NUM</span><span class="w">                   </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-281" name="__codelineno-1-281" href="#__codelineno-1-281"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CARD-UPDATE-ACCT-ID</span><span class="w">               </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-282" name="__codelineno-1-282" href="#__codelineno-1-282"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CARD-UPDATE-CVV-CD</span><span class="w">                </span><span class="kt">PIC 9(03)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-283" name="__codelineno-1-283" href="#__codelineno-1-283"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CARD-UPDATE-EMBOSSED-NAME</span><span class="w">         </span><span class="kt">PIC X(50)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-284" name="__codelineno-1-284" href="#__codelineno-1-284"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CARD-UPDATE-EXPIRAION-DATE</span><span class="w">        </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-285" name="__codelineno-1-285" href="#__codelineno-1-285"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CARD-UPDATE-ACTIVE-STATUS</span><span class="w">         </span><span class="kt">PIC X(01)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-286" name="__codelineno-1-286" href="#__codelineno-1-286"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="kp">FILLER                           </span><span class="w"> </span><span class="kt">PIC X(59)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-287" name="__codelineno-1-287" href="#__codelineno-1-287"></a>
<a id="__codelineno-1-288" name="__codelineno-1-288" href="#__codelineno-1-288"></a>
<a id="__codelineno-1-289" name="__codelineno-1-289" href="#__codelineno-1-289"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">WS-COMMAREA</span><span class="w">                             </span><span class="kt">PIC X(2000)</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-290" name="__codelineno-1-290" href="#__codelineno-1-290"></a>
<a id="__codelineno-1-291" name="__codelineno-1-291" href="#__codelineno-1-291"></a><span class="c">      *IBM SUPPLIED COPYBOOKS                                                   </span>
<a id="__codelineno-1-292" name="__codelineno-1-292" href="#__codelineno-1-292"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHBMSCA</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-293" name="__codelineno-1-293" href="#__codelineno-1-293"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHAID</span><span class="p">.</span><span class="w">                                                             </span>
<a id="__codelineno-1-294" name="__codelineno-1-294" href="#__codelineno-1-294"></a>
<a id="__codelineno-1-295" name="__codelineno-1-295" href="#__codelineno-1-295"></a><span class="c">      *COMMON COPYBOOKS                                                         </span>
<a id="__codelineno-1-296" name="__codelineno-1-296" href="#__codelineno-1-296"></a><span class="c">      *Screen Titles                                                            </span>
<a id="__codelineno-1-297" name="__codelineno-1-297" href="#__codelineno-1-297"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COTTL01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-298" name="__codelineno-1-298" href="#__codelineno-1-298"></a><span class="c">      *Credit Card Update Screen Layout                                         </span>
<a id="__codelineno-1-299" name="__codelineno-1-299" href="#__codelineno-1-299"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCRDUP</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-1-300" name="__codelineno-1-300" href="#__codelineno-1-300"></a>
<a id="__codelineno-1-301" name="__codelineno-1-301" href="#__codelineno-1-301"></a><span class="c">      *Current Date                                                             </span>
<a id="__codelineno-1-302" name="__codelineno-1-302" href="#__codelineno-1-302"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSDAT01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-303" name="__codelineno-1-303" href="#__codelineno-1-303"></a>
<a id="__codelineno-1-304" name="__codelineno-1-304" href="#__codelineno-1-304"></a><span class="c">      *Common Messages                                                          </span>
<a id="__codelineno-1-305" name="__codelineno-1-305" href="#__codelineno-1-305"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-306" name="__codelineno-1-306" href="#__codelineno-1-306"></a>
<a id="__codelineno-1-307" name="__codelineno-1-307" href="#__codelineno-1-307"></a><span class="c">      *Abend Variables                                                          </span>
<a id="__codelineno-1-308" name="__codelineno-1-308" href="#__codelineno-1-308"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG02Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-309" name="__codelineno-1-309" href="#__codelineno-1-309"></a>
<a id="__codelineno-1-310" name="__codelineno-1-310" href="#__codelineno-1-310"></a><span class="c">      *Signed on user data                                                      </span>
<a id="__codelineno-1-311" name="__codelineno-1-311" href="#__codelineno-1-311"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSUSR01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-312" name="__codelineno-1-312" href="#__codelineno-1-312"></a>
<a id="__codelineno-1-313" name="__codelineno-1-313" href="#__codelineno-1-313"></a><span class="c">      *Dataset layouts                                                          </span>
<a id="__codelineno-1-314" name="__codelineno-1-314" href="#__codelineno-1-314"></a><span class="c">      *ACCOUNT RECORD LAYOUT                                                    </span>
<a id="__codelineno-1-315" name="__codelineno-1-315" href="#__codelineno-1-315"></a><span class="c">      *COPY CVACT01Y.                                                           </span>
<a id="__codelineno-1-316" name="__codelineno-1-316" href="#__codelineno-1-316"></a>
<a id="__codelineno-1-317" name="__codelineno-1-317" href="#__codelineno-1-317"></a><span class="c">      *CARD RECORD LAYOUT                                                       </span>
<a id="__codelineno-1-318" name="__codelineno-1-318" href="#__codelineno-1-318"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT02Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-319" name="__codelineno-1-319" href="#__codelineno-1-319"></a>
<a id="__codelineno-1-320" name="__codelineno-1-320" href="#__codelineno-1-320"></a><span class="c">      *CARD XREF LAYOUT                                                         </span>
<a id="__codelineno-1-321" name="__codelineno-1-321" href="#__codelineno-1-321"></a><span class="c">      *COPY CVACT03Y.                                                           </span>
<a id="__codelineno-1-322" name="__codelineno-1-322" href="#__codelineno-1-322"></a>
<a id="__codelineno-1-323" name="__codelineno-1-323" href="#__codelineno-1-323"></a><span class="c">      *CUSTOMER LAYOUT                                                          </span>
<a id="__codelineno-1-324" name="__codelineno-1-324" href="#__codelineno-1-324"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVCUS01Y</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="linkage-section">LINKAGE SECTION</h3>
<p>This linkage section defines the DFHCOMMAREA structure used for communication between CICS programs. It contains a single field defined as a variable-length array of 1-byte elements that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive and process communication areas of different sizes from calling programs within the CardDemo credit card update functionality.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">01  DF</span><span class="nv">HCOMMAREA</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="kp">FILLER                               </span><span class="w"> </span><span class="kt">PIC X(1)                     </span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kt">            </span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="mi">32767 </span><span class="kp">TIMES</span><span class="w"> </span><span class="kp">DEPENDING</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="p">.</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="0000-main">0000-MAIN</h3>
<p>This paragraph serves as the main control flow for the COCRDUPC program, handling the credit card update functionality. It initializes working storage, establishes error handling, and manages program state through a commarea. The paragraph processes user navigation through various program states by evaluating PF keys and program conditions. Key functions include: handling program exit (PF03), retrieving card details when coming from the card list screen (PF12), presenting initial entry screens, processing user inputs after card details are displayed, and managing the workflow between data entry, validation, and confirmation states. The code maintains context between screens by preserving program state in the commarea and handles transaction integrity with CICS SYNCPOINT commands when exiting to other programs.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="nv">HANDLE</span><span class="w"> </span><span class="nv">ABEND</span><span class="w">                                               </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c">      </span><span class="w">               </span><span class="kp">LABEL</span><span class="p">(</span><span class="nv">ABEND-ROUTINE</span><span class="p">)</span><span class="w">                                       </span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CC-WORK-AREA</span><span class="w">                                              </span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-MISC-STORAGE</span><span class="w">                                           </span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-COMMAREA</span><span class="w">                                               </span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c">      * Store our context                                                       </span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">                               </span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c">      * Ensure error message is cleared                               *         </span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="nb">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c">      * Store passed data if  any                *                              </span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">0                                            </span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="mi">               </span><span class="ow">OR </span><span class="p">(</span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span><span class="w">                             </span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="p">)</span><span class="w">                                       </span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="c">      </span><span class="w">        </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">                                      </span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="c">      </span><span class="w">                   </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                                   </span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="nb">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">  </span><span class="kp">TO              </span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="kp">                               </span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">                               </span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">                 </span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="c">      </span><span class="w">                         </span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kp">TO              </span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="kp">                               </span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                            </span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="c">      * Remap PFkeys as needed.                                                 </span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="c">      * Store the Mapped PF Key                                                 </span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">YYYY-STORE-PFKEY</span><span class="w">                                             </span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="nv">YYYY-STORE-PFKEY-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="c">      * Check the AID to see if its valid at this point               *         </span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="c">      * F3 - Exit                                                               </span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="c">      * Enter show screen again                                                 </span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PFK-INVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                              </span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="nb">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w"> </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="ow">             </span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w"> </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="ow">              </span><span class="p">(</span><span class="nv">CCARD-AID-PFK05</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="p">)</span><span class="w">               </span>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="c">      </span><span class="w">                        </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="ow">              </span><span class="p">(</span><span class="nv">CCARD-AID-PFK12</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="p">)</span><span class="w">                </span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PFK-VALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                             </span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">PFK-INVALID</span><span class="w">                                                       </span>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>
<a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a><span class="c">      * Decide what to do based on inputs received                              </span>
<a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a><span class="nb">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a><span class="c">      *       USER PRESSES PF03 TO EXIT                                         </span>
<a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="c">      *  OR   USER IS DONE WITH UPDATE                                          </span>
<a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="c">      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         </span>
<a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w">                                              </span>
<a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN </span><span class="p">(</span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">                                </span>
<a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND </span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTMAPSET</span><span class="p">)</span><span class="w">                 </span>
<a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN </span><span class="p">(</span><span class="nv">CCUP-CHANGES-FAILED</span><span class="w">                                         </span>
<a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND </span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTMAPSET</span><span class="p">)</span><span class="w">                 </span>
<a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a>
<a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="no">                  </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                         </span>
<a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="no">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-MENUTRANID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-TRANID</span><span class="w">                   </span>
<a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a><span class="c">      </span><span class="w">             </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-TRANID</span><span class="w">                </span>
<a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a>
<a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a><span class="no">                  </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                         </span>
<a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a><span class="no">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span><span class="w">                  </span>
<a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a><span class="c">      </span><span class="w">             </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span><span class="w">               </span>
<a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a>
<a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                 </span>
<a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                </span>
<a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a>
<a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTMAPSET</span><span class="w">               </span>
<a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROS         </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                     </span>
<a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a><span class="c">      </span><span class="w">                                        </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                    </span>
<a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a>
<a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                 </span>
<a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                    </span>
<a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a>
<a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a><span class="c">      </span><span class="w">             </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w">                                                    </span>
<a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a><span class="c">      </span><span class="w">                  </span><span class="nv">SYNCPOINT</span><span class="w">                                               </span>
<a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a><span class="c">      </span><span class="w">             </span><span class="nv">END-EXEC</span><span class="w">                                                     </span>
<a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a><span class="c">      *                                                                         </span>
<a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a><span class="c">      </span><span class="w">             </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">XCTL</span><span class="w">                                               </span>
<a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a><span class="c">      </span><span class="w">                  </span><span class="kp">PROGRAM </span><span class="p">(</span><span class="nv">CDEMO-TO-PROGRAM</span><span class="p">)</span><span class="w">                              </span>
<a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a><span class="c">      </span><span class="w">                  </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a><span class="c">      </span><span class="w">             </span><span class="nv">END-EXEC</span><span class="w">                                                     </span>
<a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a><span class="c">      *       USER CAME FROM CREDIT CARD LIST SCREEN                            </span>
<a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a><span class="c">      *            SO WE ALREADY HAVE THE FILTER KEYS                           </span>
<a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a><span class="c">      *            FETCH THE ASSSOCIATED CARD DETAILS FOR UPDATE                </span>
<a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                              </span>
<a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                      </span>
<a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK12</span><span class="w">                                              </span>
<a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                      </span>
<a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                             </span>
<a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-OK</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                             </span>
<a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                          </span>
<a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                          </span>
<a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w">                     </span>
<a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w">                    </span>
<a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA</span><span class="w">                                       </span>
<a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                        </span>
<a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a><span class="c">      </span><span class="w">             </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                          </span>
<a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a><span class="c">      *       FRESH ENTRY INTO PROGRAM                                          </span>
<a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a><span class="c">      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED        </span>
<a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">                                     </span>
<a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                              </span>
<a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span><span class="w">                       </span>
<a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">                                        </span>
<a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a><span class="c">      </span><span class="w">             </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                              </span>
<a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w"> </span><span class="kp">THRU                                   </span>
<a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a><span class="kp">                          </span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                          </span>
<a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-144" name="__codelineno-3-144" href="#__codelineno-3-144"></a><span class="c">      *       CARD DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY           </span>
<a id="__codelineno-3-145" name="__codelineno-3-145" href="#__codelineno-3-145"></a><span class="c">      *            RESET THE SEARCH KEYS                                        </span>
<a id="__codelineno-3-146" name="__codelineno-3-146" href="#__codelineno-3-146"></a><span class="c">      *            ASK THE USER FOR FRESH SEARCH CRITERIA                       </span>
<a id="__codelineno-3-147" name="__codelineno-3-147" href="#__codelineno-3-147"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-148" name="__codelineno-3-148" href="#__codelineno-3-148"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">                                 </span>
<a id="__codelineno-3-149" name="__codelineno-3-149" href="#__codelineno-3-149"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-FAILED</span><span class="w">                                          </span>
<a id="__codelineno-3-150" name="__codelineno-3-150" href="#__codelineno-3-150"></a><span class="c">      </span><span class="w">             </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                              </span>
<a id="__codelineno-3-151" name="__codelineno-3-151" href="#__codelineno-3-151"></a><span class="c">      </span><span class="w">                        </span><span class="nv">WS-MISC-STORAGE</span><span class="w">                                   </span>
<a id="__codelineno-3-152" name="__codelineno-3-152" href="#__codelineno-3-152"></a><span class="c">      </span><span class="w">                        </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                     </span>
<a id="__codelineno-3-153" name="__codelineno-3-153" href="#__codelineno-3-153"></a><span class="c">      </span><span class="w">                        </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                                    </span>
<a id="__codelineno-3-154" name="__codelineno-3-154" href="#__codelineno-3-154"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-3-155" name="__codelineno-3-155" href="#__codelineno-3-155"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w"> </span><span class="kp">THRU                                   </span>
<a id="__codelineno-3-156" name="__codelineno-3-156" href="#__codelineno-3-156"></a><span class="kp">                          </span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-3-157" name="__codelineno-3-157" href="#__codelineno-3-157"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-3-158" name="__codelineno-3-158" href="#__codelineno-3-158"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-3-159" name="__codelineno-3-159" href="#__codelineno-3-159"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                          </span>
<a id="__codelineno-3-160" name="__codelineno-3-160" href="#__codelineno-3-160"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-161" name="__codelineno-3-161" href="#__codelineno-3-161"></a><span class="c">      *      CARD DATA HAS BEEN PRESENTED TO USER                               </span>
<a id="__codelineno-3-162" name="__codelineno-3-162" href="#__codelineno-3-162"></a><span class="c">      *            CHECK THE USER INPUTS                                        </span>
<a id="__codelineno-3-163" name="__codelineno-3-163" href="#__codelineno-3-163"></a><span class="c">      *            DECIDE WHAT TO DO                                            </span>
<a id="__codelineno-3-164" name="__codelineno-3-164" href="#__codelineno-3-164"></a><span class="c">      *            PRESENT NEXT STEPS TO USER                                   </span>
<a id="__codelineno-3-165" name="__codelineno-3-165" href="#__codelineno-3-165"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-166" name="__codelineno-3-166" href="#__codelineno-3-166"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                        </span>
<a id="__codelineno-3-167" name="__codelineno-3-167" href="#__codelineno-3-167"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">PROCESS-INPUTS</span><span class="w">                                  </span>
<a id="__codelineno-3-168" name="__codelineno-3-168" href="#__codelineno-3-168"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">PROCESS-INPUTS-EXIT</span><span class="w">                             </span>
<a id="__codelineno-3-169" name="__codelineno-3-169" href="#__codelineno-3-169"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2000</span><span class="o">-</span><span class="nv">DECIDE-ACTION</span><span class="w">                                   </span>
<a id="__codelineno-3-170" name="__codelineno-3-170" href="#__codelineno-3-170"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2000</span><span class="o">-</span><span class="nv">DECIDE-ACTION-EXIT</span><span class="w">                              </span>
<a id="__codelineno-3-171" name="__codelineno-3-171" href="#__codelineno-3-171"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                        </span>
<a id="__codelineno-3-172" name="__codelineno-3-172" href="#__codelineno-3-172"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-3-173" name="__codelineno-3-173" href="#__codelineno-3-173"></a><span class="c">      </span><span class="w">             </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                          </span>
<a id="__codelineno-3-174" name="__codelineno-3-174" href="#__codelineno-3-174"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-3-175" name="__codelineno-3-175" href="#__codelineno-3-175"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="common-return">COMMON-RETURN</h3>
<p>This paragraph handles the program's return logic by first copying the return message to the error message field in the communication area. It then preserves both the common CardDemo communication area and this program's specific communication area by concatenating them together into a combined working storage area. Finally, it executes a CICS RETURN command that maintains the same transaction ID and passes back the combined communication area, ensuring that both shared and program-specific data are preserved for the next program invocation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">MOVE W</span><span class="nv">S-RETURN-MSG</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                            </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="w">                            </span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="kp">TO                                        </span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="kp">                 </span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">                  </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c">      </span><span class="w">                         </span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="p">)</span><span class="w">                 </span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="kr">               </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">LIT-THISTRANID</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c">      </span><span class="w">          </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-COMMAREA</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="0000-main-exit">0000-MAIN-EXIT</h3>
<p>This paragraph serves as the exit point for the program. It's a simple termination point that marks the end of a processing section, allowing control to return to the calling routine. This is a standard COBOL structural element used to properly end program flow in the credit card update process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1000-process-inputs">1000-PROCESS-INPUTS</h3>
<p>This paragraph orchestrates the initial input processing workflow for the credit card update transaction. It first calls the 1100-RECEIVE-MAP paragraph to retrieve user input from the screen, then performs validation of the input data through the 1200-EDIT-MAP-INPUTS paragraph. After validation, it captures any error messages in the communication area and sets up the program flow to return to the same screen by configuring the next program, mapset, and map names to the current ones. This ensures proper handling of input errors by returning the user to the same screen with appropriate feedback.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">1100</span><span class="o">-</span><span class="nv">RECEIVE-MAP</span><span class="w">                                             </span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1100</span><span class="o">-</span><span class="nv">RECEIVE-MAP-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">EDIT-MAP-INPUTS</span><span class="w">                                         </span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">EDIT-MAP-INPUTS-EXIT</span><span class="w">                                    </span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                               </span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                               </span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                             </span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                                </span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1000-process-inputs-exit">1000-PROCESS-INPUTS-EXIT</h3>
<p>This paragraph serves as an exit point for the 1000-PROCESS-INPUTS section of the COCRDUPC program. It marks the end of the input processing logic for credit card detail updates, allowing the program flow to return to the calling section after input validation and processing has been completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1100-receive-map">1100-RECEIVE-MAP</h3>
<p>This paragraph receives user input from a CICS map and processes it for credit card updates. It first executes a CICS RECEIVE command to capture the data entered by the user into the CCRDUPAI structure. The paragraph then initializes the CCUP-NEW-DETAILS structure and processes each input field from the map. For each field (account ID, card number, card name, status code, and expiration date components), it applies consistent validation logic - if the field contains an asterisk or spaces, it's replaced with LOW-VALUES; otherwise, the entered value is stored. The paragraph handles both identification fields (account and card numbers) by storing them in both the CC fields (likely for record lookup) and the CCUP-NEW fields (for update processing). This ensures proper handling of user inputs before validation and database update operations occur in subsequent paragraphs.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">RECEIVE</span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="nv">LIT-THISMAP</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="c">      </span><span class="w">               </span><span class="nv">MAPSET</span><span class="p">(</span><span class="nv">LIT-THISMAPSET</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">               </span><span class="kp">INTO</span><span class="p">(</span><span class="nv">CCRDUPAI</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                           </span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CCUP-NEW-DETAILS</span><span class="w">                                          </span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c">      *    REPLACE * WITH LOW-VALUES                                            </span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">                         </span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="c">      </span><span class="w">                                       </span><span class="nv">CCUP-NEW-ACCTID</span><span class="w">                    </span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">                         </span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="c">      </span><span class="w">                                       </span><span class="nv">CCUP-NEW-ACCTID</span><span class="w">                    </span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">                        </span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="c">      </span><span class="w">                                       </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">                    </span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">                        </span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="c">      </span><span class="w">                                       </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">                    </span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CRDNAMEI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">CRDNAMEI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">                   </span>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDNAMEI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">                   </span>
<a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>
<a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CRDSTCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">CRDSTCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">                   </span>
<a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSTCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">                   </span>
<a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>
<a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">EXPDAYI</span><span class="w">     </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">  </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-EXPDAY</span><span class="w">                    </span>
<a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a>
<a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">EXPMONI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                        </span>
<a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">EXPMONI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                     </span>
<a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">                    </span>
<a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">EXPMONI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">  </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">                    </span>
<a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a>
<a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">EXPYEARI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">EXPYEARI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">                   </span>
<a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">EXPYEARI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">                   </span>
<a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1100-receive-map-exit">1100-RECEIVE-MAP-EXIT</h3>
<p>This paragraph serves as an exit point for the 1100-RECEIVE-MAP section of the COCRDUPC program. It marks the end of the map receiving process where user input from the CICS screen is captured for credit card update operations. The paragraph contains only the EXIT statement followed by a period, indicating a clean termination point for this processing section before control is passed to the next logical section in the program flow.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1200-edit-map-inputs">1200-EDIT-MAP-INPUTS</h3>
<p>This paragraph handles the validation of user inputs when updating credit card details. It first checks if card details have been fetched yet. If not, it validates only the search criteria (account and card numbers) and exits. If card details have already been fetched, it copies the existing card data to working fields and checks if any changes were made by comparing the new data with the original data. When changes are detected and not yet confirmed or processed, it performs validation on each editable field: embossed name, card status, expiration month, and expiration year through separate validation routines. Based on validation results, it either marks the input as having errors or sets a flag indicating changes are valid but not yet confirmed. The paragraph maintains the state of the update process through various status flags to ensure proper workflow progression.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">SET IN</span><span class="nv">PUT-OK</span><span class="w">                  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">                                         </span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c">      *        VALIDATE THE SEARCH KEYS                                         </span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT</span><span class="w">                                        </span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c">      </span><span class="w">            </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1220</span><span class="o">-</span><span class="nv">EDIT-CARD</span><span class="w">                                           </span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c">      </span><span class="w">            </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                      </span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES                </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-NEW-CARDDATA</span><span class="w">             </span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c">      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS SKIP OTHER EDITS           </span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">NO-SEARCH-CRITERIA-RECEIVED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="nb">              </span><span class="w"> </span><span class="kr">END-IF                                                           </span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="kr">              </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">EDIT-MAP-INPUTS-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="kr">              </span><span class="w"> </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="kr">SEARCH</span><span class="w"> </span><span class="nv">KEYS</span><span class="w"> </span><span class="nv">ALREADY</span><span class="w"> </span><span class="nv">VALIDATED</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="kr">DATA</span><span class="w"> </span><span class="nv">FETCHED</span><span class="w">                       </span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                  </span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                  </span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                  </span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="nb">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-ACCTID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                            </span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CARDID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                           </span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">                       </span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w">                       </span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-EXPIRY-DAY</span><span class="w">                          </span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-EXPIRY-MONTH</span><span class="w">                        </span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-EXPIRY-YEAR</span><span class="w">                         </span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="c">      *    NEW DATA IS SAME AS OLD DATA                                         </span>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF  </span><span class="p">(</span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">UPPER-CASE</span><span class="p">(</span><span class="nv">CCUP-NEW-CARDDATA</span><span class="p">)</span><span class="w"> </span><span class="ow">EQUAL                    </span>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="ow">               </span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">UPPER-CASE</span><span class="p">(</span><span class="nv">CCUP-OLD-CARDDATA</span><span class="p">))</span><span class="w">                         </span>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="c">      </span><span class="w">         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">NO-CHANGES-DETECTED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                  </span>
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>
<a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">NO-CHANGES-DETECTED</span><span class="w">                                              </span>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w">                                    </span>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">                                     </span>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="c">      </span><span class="w">         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDNAME-ISVALID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="nb">              </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="nb">              </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="nb">              </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="nb">              </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">EDIT-MAP-INPUTS-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a>
<a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a>
<a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="kr">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                   </span>
<a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a>
<a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a><span class="nb">          </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1230</span><span class="o">-</span><span class="nv">EDIT-NAME</span><span class="w">                                               </span>
<a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1230</span><span class="o">-</span><span class="nv">EDIT-NAME-EXIT</span><span class="w">                                          </span>
<a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a>
<a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1240</span><span class="o">-</span><span class="nv">EDIT-CARDSTATUS</span><span class="w">                                         </span>
<a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1240</span><span class="o">-</span><span class="nv">EDIT-CARDSTATUS-EXIT</span><span class="w">                                    </span>
<a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a>
<a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1250</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-MON</span><span class="w">                                         </span>
<a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1250</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-MON-EXIT</span><span class="w">                                    </span>
<a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a>
<a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1260</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-YEAR</span><span class="w">                                        </span>
<a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1260</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-YEAR-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a>
<a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                                                       </span>
<a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1200-edit-map-inputs-exit">1200-EDIT-MAP-INPUTS-EXIT</h3>
<p>This paragraph serves as an exit point for the 1200-EDIT-MAP-INPUTS routine. It provides a clean termination point for the input validation logic, allowing the program to return control to the calling section after completing the validation of user inputs from the map.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1210-edit-account">1210-EDIT-ACCOUNT</h3>
<p>This paragraph validates the account ID input field for credit card updates. It first checks if the account ID is empty (spaces, low-values, or zeros) and sets appropriate error flags while prompting the user for an account if necessary. If an account ID is provided, it verifies that the value is numeric and 11 digits long. When validation fails, it clears the account ID fields and sets error indicators. Upon successful validation, it copies the account ID to the required program variables and marks the account filter as valid. The paragraph maintains error status flags and conditional messaging to guide the user through proper account ID entry.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">SET FL</span><span class="nv">G-ACCTFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                    </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                     </span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                         </span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                          </span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-ACCT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                </span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES  </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-NEW-ACCTID</span><span class="w">                              </span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                     </span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="c">      *    Not numeric                                                          </span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="c">      *    Not 11 characters                                                    </span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">  </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                        </span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="kp">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                           </span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="c">      </span><span class="w">          </span><span class="kr">MOVE                                                            </span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="kr">              </span><span class="s1">&#39;ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER&#39;</span><span class="w">            </span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="c">      </span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">                                  </span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                  </span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-NEW-ACCTID</span><span class="w">                                </span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">1210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                      </span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                  </span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="c">      </span><span class="w">                           </span><span class="nv">CCUP-NEW-ACCTID</span><span class="w">                                </span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1210-edit-account-exit">1210-EDIT-ACCOUNT-EXIT</h3>
<p>This paragraph serves as an exit point for the account editing process. It's a simple paragraph marker that allows the program to return control to the calling routine after completing the account validation logic.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1220-edit-card">1220-EDIT-CARD</h3>
<p>This paragraph validates the credit card number input during the card update process. It performs several checks: first, it verifies if the card number was provided at all (checking for spaces, low-values, or zeros). If the card number is missing, it sets appropriate error flags, clears the card number fields, and prompts the user for input if messaging is enabled. If a card number is provided, it validates that the input is numeric and 16 digits long. When validation fails, it sets error flags, displays an error message if messaging is enabled, and clears the card number fields. When validation succeeds, it moves the card number to the appropriate program variables and sets a flag indicating the card number is valid. The paragraph is part of the input validation workflow that ensures data integrity before proceeding with card updates.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c">*    N</span><span class="nv">ot</span><span class="w"> </span><span class="kp">numeric                                                          </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kp">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="mi">16 </span><span class="kp">characters                                                    </span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="kp">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                    </span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                    </span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                        </span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                         </span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-CARD</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES       </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">                              </span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="c">      *    Not numeric                                                          </span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="c">      *    Not 16 characters                                                    </span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">  </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                       </span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="kp">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                           </span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE                                                           </span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="kr">              </span><span class="s1">&#39;CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER&#39;</span><span class="w">            </span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="c">      </span><span class="w">                           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">                               </span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO         </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES   </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">                             </span>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">1220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                         </span>
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">                             </span>
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1220-edit-card-exit">1220-EDIT-CARD-EXIT</h3>
<p>This paragraph serves as an exit point for the card editing process in the COCRDUPC program. It marks the end of the card validation and editing logic, allowing the program flow to return to the calling section after completing the validation of credit card details.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1230-edit-name">1230-EDIT-NAME</h3>
<p>This paragraph validates the credit card embossed name input. It first checks if the name field is empty (blank, zeros, or low-values), setting appropriate error flags and prompting the user to enter a name if needed. Then it performs character validation by converting all alphabetic characters to spaces and checking if anything remains - ensuring only alphabetic characters and spaces are allowed in the name field. If non-alphabetic characters are found, it sets error flags and provides a specific error message. When validation passes, it sets a flag indicating the card name is valid. The paragraph includes conditional error message handling based on the current message display settings.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c">*    N</span><span class="nv">ot</span><span class="w"> </span><span class="kp">BLANK                                                            </span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="kp">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDNAME-NOT-OK</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                               </span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                   </span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                    </span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDNAME-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                   </span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-NAME</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1230</span><span class="o">-</span><span class="nv">EDIT-NAME-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="kp">Only</span><span class="w"> </span><span class="nv">Alphabets</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="no">space</span><span class="w"> </span><span class="nv">allowed</span><span class="w">                                     </span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-NAME-CHECK</span><span class="w">                      </span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">INSPECT</span><span class="w"> </span><span class="nv">CARD-NAME-CHECK</span><span class="w">                                              </span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="c">      </span><span class="w">       </span><span class="kp">CONVERTING</span><span class="w"> </span><span class="nv">LIT-ALL-ALPHA-FROM</span><span class="w">                                      </span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="c">      </span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">LIT-ALL-SPACES-TO</span><span class="w">                                       </span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">TRIM</span><span class="p">(</span><span class="nv">CARD-NAME-CHECK</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0               </span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="mi">              </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDNAME-NOT-OK</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-NAME-MUST-BE-ALPHA</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                             </span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1230</span><span class="o">-</span><span class="nv">EDIT-NAME-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a><span class="kr">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDNAME-ISVALID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="nb">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1230-edit-name-exit">1230-EDIT-NAME-EXIT</h3>
<p>This paragraph serves as an exit point for the name editing routine in the credit card update process. It marks the end of the name validation logic, allowing the program to continue with the next step in the card update workflow after name field processing is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1240-edit-cardstatus">1240-EDIT-CARDSTATUS</h3>
<p>This paragraph validates the card status input field in the credit card update process. It first checks if the card status value is provided, setting an error flag and appropriate message if the field is blank, spaces, or zeros. If a value is provided, it validates that the input is either 'Y' or 'N' by moving the input to a flag field and checking if it's valid. When validation fails, it sets error flags and a message indicating that card status must be either Yes or No. The paragraph includes conditional message handling based on the WS-RETURN-MSG-OFF flag, which controls whether error messages are displayed to the user. Valid inputs result in setting the FLG-CARDSTATUS-ISVALID flag before exiting the paragraph.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">*    M</span><span class="nv">ust</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nv">N</span><span class="w">                                                       </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-NOT-OK</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                               </span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                   </span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                    </span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CARD-STATUS-MUST-BE-YES-NO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1240</span><span class="o">-</span><span class="nv">EDIT-CARDSTATUS-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FLG-YES-NO-CHECK</span><span class="w">                   </span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-YES-NO-VALID</span><span class="w">                                                  </span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="nb">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-NOT-OK</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CARD-STATUS-MUST-BE-YES-NO</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1240</span><span class="o">-</span><span class="nv">EDIT-CARDSTATUS-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1240-edit-cardstatus-exit">1240-EDIT-CARDSTATUS-EXIT</h3>
<p>This paragraph serves as an exit point for the CARDSTATUS field validation routine. It marks the end of the validation logic for the card status field, allowing the program flow to return to the calling section after the validation checks have been completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1250-edit-expiry-mon">1250-EDIT-EXPIRY-MON</h3>
<p>This paragraph validates the credit card expiration month entered by the user. It first sets a flag indicating the month is invalid by default. The validation checks if the month is blank or not supplied (spaces, zeros, or low-values), in which case it sets appropriate error flags and exits. If a value is provided, it moves the input to a check field and verifies it's a valid month (1-12) using a predefined condition. When validation fails, it sets error flags and, if message display is enabled, sets a specific error message flag for invalid expiration month. The paragraph maintains validation state through multiple flags that can be used by the calling routine to determine appropriate action.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c">SET FL</span><span class="nv">G-CARDEXPMON-NOT-OK</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                </span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                     </span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CARD-EXPIRY-MONTH-NOT-VALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1250</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-MON-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="nv">Must</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="kp">numeric                                                      </span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="kp">      </span><span class="o">*</span><span class="w">    </span><span class="nv">Must</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="mi">1 </span><span class="kp">to</span><span class="w"> </span><span class="mi">12                                                      </span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="mi">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-MONTH-CHECK</span><span class="w">                   </span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">VALID-MONTH</span><span class="w">                                                       </span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="nb">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-NOT-OK</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CARD-EXPIRY-MONTH-NOT-VALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1250</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-MON-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1250-edit-expiry-mon-exit">1250-EDIT-EXPIRY-MON-EXIT</h3>
<p>This paragraph serves as an exit point for the expiration month validation routine. It marks the end of the validation logic for the credit card expiration month field, allowing the program to continue with the next processing step after validation is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1260-edit-expiry-year">1260-EDIT-EXPIRY-YEAR</h3>
<p>This paragraph validates the expiration year field during credit card updates. It performs two key validation checks: first ensuring the field is not empty (not spaces, zeros, or low-values), and then verifying the year is numeric and within a valid range. If validation fails, it sets appropriate error flags (INPUT-ERROR and specific field error flags) and conditionally sets a user-friendly error message (CARD-EXPIRY-YEAR-NOT-VALID) if message display is enabled. The validation logic uses a VALID-YEAR condition, likely defined elsewhere, to determine if the supplied year meets business requirements. The paragraph exits immediately upon detecting any validation error, preventing further processing with invalid data.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c">*    N</span><span class="nv">ot</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                               </span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                   </span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                    </span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CARD-EXPIRY-YEAR-NOT-VALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1260</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-YEAR-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="nv">Must</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="kp">numeric                                                      </span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="kp">      </span><span class="o">*</span><span class="w">    </span><span class="nv">Must</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="mi">1 </span><span class="kp">to</span><span class="w"> </span><span class="mi">12                                                      </span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="mi">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-NOT-OK</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="nb">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-YEAR-CHECK</span><span class="w">                   </span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">VALID-YEAR</span><span class="w">                                                        </span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-ISVALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="nb">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-NOT-OK</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CARD-EXPIRY-YEAR-NOT-VALID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">1260</span><span class="o">-</span><span class="nv">EDIT-EXPIRY-YEAR-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1260-edit-expiry-year-exit">1260-EDIT-EXPIRY-YEAR-EXIT</h3>
<p>This paragraph serves as an exit point for the expiration year validation routine. It marks the end of the validation logic for the credit card expiration year field, allowing the program to return control to the calling section after completing the validation checks.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2000-decide-action">2000-DECIDE-ACTION</h3>
<p>This paragraph implements the core decision logic for the credit card update process based on the current state of the transaction and user actions. It uses an EVALUATE statement to handle multiple workflow scenarios: initial data retrieval, handling user cancellations, validating changes, confirming updates, processing update confirmations, and handling update outcomes (including lock errors, update failures, and concurrent update conflicts). When updates are successfully completed, it resets account information if not called from another transaction. The paragraph maintains transaction state through status flags and includes error handling that will trigger an abend routine if an unexpected scenario is encountered. This logic ensures the update process follows a controlled path with appropriate validation and confirmation steps before committing changes to the database.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c">EVALUA</span><span class="nv">TE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nb">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c">      *       NO DETAILS SHOWN.                                                 </span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c">      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN                          </span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">                                     </span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="c">      *       CHANGES MADE. BUT USER CANCELS                                    </span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK12</span><span class="w">                                              </span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="c">      </span><span class="w">           </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">                                     </span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="c">      </span><span class="w">           </span><span class="ow">AND</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">                                     </span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="c">      </span><span class="w">               </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA</span><span class="w">                                     </span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="c">      </span><span class="w">                  </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA-EXIT</span><span class="w">                                </span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="c">      </span><span class="w">               </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">                                 </span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="c">      </span><span class="w">                  </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="nb">                    </span><span class="w"> </span><span class="kr">END-IF                                                     </span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="kr">                </span><span class="w"> </span><span class="kr">END-IF                                                         </span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="c">      *       DETAILS SHOWN                                                     </span>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="c">      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD                        </span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">                                            </span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="c">      </span><span class="w">           </span><span class="kr">IF</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                                                 </span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="c">      </span><span class="w">           </span><span class="ow">OR</span><span class="w"> </span><span class="nv">NO-CHANGES-DETECTED</span><span class="w">                                         </span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="c">      </span><span class="w">              </span><span class="kr">CONTINUE                                                    </span>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="kr">                </span><span class="w"> </span><span class="kr">ELSE                                                           </span>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="kr">                   </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                   </span>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a><span class="nb">                </span><span class="w"> </span><span class="kr">END-IF                                                         </span>
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="c">      *       DETAILS SHOWN                                                     </span>
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a><span class="c">      *       BUT INPUT EDIT ERRORS FOUND                                       </span>
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                          </span>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a><span class="c">      </span><span class="w">            </span><span class="kr">CONTINUE                                                      </span>
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a><span class="c">      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 </span>
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a><span class="c">      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES                            </span>
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w">                                </span>
<a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCARD-AID-PFK05</span><span class="w">                                              </span>
<a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9200</span><span class="o">-</span><span class="nv">WRITE-PROCESSING</span><span class="w">                                  </span>
<a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a><span class="c">      </span><span class="w">              </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9200</span><span class="o">-</span><span class="nv">WRITE-PROCESSING-EXIT</span><span class="w">                             </span>
<a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a><span class="c">      </span><span class="w">           </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                  </span>
<a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a><span class="nb">                   </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">COULD-NOT-LOCK-FOR-UPDATE</span><span class="w">                              </span>
<a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a><span class="c">      </span><span class="w">                   </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-LOCK-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE             </span>
<a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a><span class="nb">                   </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">LOCKED-BUT-UPDATE-FAILED</span><span class="w">                               </span>
<a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a><span class="c">      </span><span class="w">                 </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-BUT-FAILED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE               </span>
<a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a><span class="nb">                   </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DATA-WAS-CHANGED-BEFORE-UPDATE</span><span class="w">                         </span>
<a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a><span class="c">      </span><span class="w">                  </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                </span>
<a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a><span class="nb">                   </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                  </span>
<a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a><span class="kp">                      </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE               </span>
<a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a><span class="nb">                </span><span class="w"> </span><span class="kr">END-EVALUATE                                                   </span>
<a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a><span class="c">      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 </span>
<a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a><span class="c">      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN                     </span>
<a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w">                                </span>
<a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a><span class="c">      </span><span class="w">            </span><span class="kr">CONTINUE                                                      </span>
<a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a><span class="c">      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1                            </span>
<a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">                                 </span>
<a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                      </span>
<a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a><span class="no">                 </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                          </span>
<a id="__codelineno-24-67" name="__codelineno-24-67" href="#__codelineno-24-67"></a><span class="no">                    </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                         </span>
<a id="__codelineno-24-68" name="__codelineno-24-68" href="#__codelineno-24-68"></a><span class="c">      </span><span class="w">                                    </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                        </span>
<a id="__codelineno-24-69" name="__codelineno-24-69" href="#__codelineno-24-69"></a><span class="c">      </span><span class="w">               </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES  </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-STATUS</span><span class="w">                     </span>
<a id="__codelineno-24-70" name="__codelineno-24-70" href="#__codelineno-24-70"></a><span class="c">      </span><span class="w">            </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-24-71" name="__codelineno-24-71" href="#__codelineno-24-71"></a><span class="kr">             </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                        </span>
<a id="__codelineno-24-72" name="__codelineno-24-72" href="#__codelineno-24-72"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-CULPRIT</span><span class="w">                         </span>
<a id="__codelineno-24-73" name="__codelineno-24-73" href="#__codelineno-24-73"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;0001&#39;</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-CODE</span><span class="w">                            </span>
<a id="__codelineno-24-74" name="__codelineno-24-74" href="#__codelineno-24-74"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES        </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-REASON</span><span class="w">                          </span>
<a id="__codelineno-24-75" name="__codelineno-24-75" href="#__codelineno-24-75"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;UNEXPECTED DATA SCENARIO&#39;</span><span class="w">                              </span>
<a id="__codelineno-24-76" name="__codelineno-24-76" href="#__codelineno-24-76"></a><span class="c">      </span><span class="w">                                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-MSG</span><span class="w">                             </span>
<a id="__codelineno-24-77" name="__codelineno-24-77" href="#__codelineno-24-77"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">ABEND-ROUTINE</span><span class="w">                                        </span>
<a id="__codelineno-24-78" name="__codelineno-24-78" href="#__codelineno-24-78"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="nv">ABEND-ROUTINE-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-24-79" name="__codelineno-24-79" href="#__codelineno-24-79"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-24-80" name="__codelineno-24-80" href="#__codelineno-24-80"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2000-decide-action-exit">2000-DECIDE-ACTION-EXIT</h3>
<p>This paragraph serves as an exit point for the 2000-DECIDE-ACTION section of the COCRDUPC program. It provides a clean termination point for the logic that determines what action to take based on user input when updating credit card details.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3000-send-map">3000-SEND-MAP</h3>
<p>This paragraph orchestrates the preparation and display of the user interface for the credit card update transaction. It follows a structured sequence by first initializing the screen (3100-SCREEN-INIT), then setting up the screen variables with appropriate data values (3200-SETUP-SCREEN-VARS), preparing any informational messages for the user (3250-SETUP-INFOMSG), configuring the screen attributes for proper field display and interaction (3300-SETUP-SCREEN-ATTRS), and finally sending the completed screen to the terminal (3400-SEND-SCREEN). This modular approach separates the different aspects of screen preparation and display, making the code more maintainable and easier to troubleshoot.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">3100</span><span class="o">-</span><span class="nv">SCREEN-INIT</span><span class="w">                                             </span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3100</span><span class="o">-</span><span class="nv">SCREEN-INIT-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3200</span><span class="o">-</span><span class="nv">SETUP-SCREEN-VARS</span><span class="w">                                       </span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3200</span><span class="o">-</span><span class="nv">SETUP-SCREEN-VARS-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3250</span><span class="o">-</span><span class="nv">SETUP-INFOMSG</span><span class="w">                                           </span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3250</span><span class="o">-</span><span class="nv">SETUP-INFOMSG-EXIT</span><span class="w">                                      </span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3300</span><span class="o">-</span><span class="nv">SETUP-SCREEN-ATTRS</span><span class="w">                                      </span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3300</span><span class="o">-</span><span class="nv">SETUP-SCREEN-ATTRS-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">3400</span><span class="o">-</span><span class="nv">SEND-SCREEN</span><span class="w">                                             </span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">3400</span><span class="o">-</span><span class="nv">SEND-SCREEN-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3000-send-map-exit">3000-SEND-MAP-EXIT</h3>
<p>This paragraph serves as an exit point for the SEND-MAP routine in the credit card update program. It provides a clean termination point for the routine that handles displaying information to the user interface, allowing the program to return control to its calling section after map display operations are complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3100-screen-init">3100-SCREEN-INIT</h3>
<p>This paragraph initializes the screen display for the credit card update transaction. It clears the output area (CCRDUPAO) by setting it to LOW-VALUES, then retrieves the current system date and time. The paragraph populates the screen header with application titles from the communication area, transaction ID, and program name. It formats the current date as MM/DD/YY and the current time as HH:MM:SS, then places these values in their respective screen fields. This initialization ensures the screen displays up-to-date information and proper identification headers before presenting card data to the user.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c">MOVE L</span><span class="nv">OW-VALUES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                                          </span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE    </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span><span class="w">                    </span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE01</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE01O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE02</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE02O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PGMNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE    </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span><span class="w">                    </span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MM</span><span class="w">                      </span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DD</span><span class="w">                      </span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-YY</span><span class="w">                      </span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MM-DD-YY</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURDATEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HOURS</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-HH</span><span class="w">                      </span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-MINUTE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-MM</span><span class="w">                      </span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-SECOND</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-SS</span><span class="w">                      </span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HH-MM-SS</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURTIMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3100-screen-init-exit">3100-SCREEN-INIT-EXIT</h3>
<p>This paragraph serves as an exit point for the screen initialization process in the COCRDUPC program. It provides a clean termination point for the 3100-SCREEN-INIT section, allowing the program flow to return to the calling routine after screen initialization tasks are completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3200-setup-screen-vars">3200-SETUP-SCREEN-VARS</h3>
<p>This paragraph initializes the screen variables for the credit card update interface based on the current program state. If the program is being entered for the first time, it continues without initialization. Otherwise, it populates the account ID and card number fields with either existing values or LOW-VALUES if they haven't been provided. The paragraph then uses an EVALUATE statement to handle different display scenarios: when card details haven't been fetched yet (clearing all fields), when showing existing details (displaying the original card information), when changes have been made (showing the updated values), or other cases (reverting to original values). Notably, there's a commented section indicating that the expiration day field is not editable by users, so the original value is always used regardless of any changes made to other fields.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c">*    I</span><span class="nv">NITIALIZE</span><span class="w"> </span><span class="kr">SEARCH</span><span class="w"> </span><span class="nv">CRITERIA</span><span class="w">                                           </span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                                   </span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                               </span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="mi">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES         </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="c">      </span><span class="w">        </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="kr">                </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                              </span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="mi">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="kr">               </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">               </span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="kr">             </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                     </span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="nb">                 </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">                                 </span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES        </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="c">      </span><span class="w">                                            </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="c">      </span><span class="w">                                            </span><span class="nv">CRDSTCDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="c">      </span><span class="w">                                            </span><span class="nv">EXPDAYO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="c">      </span><span class="w">                                            </span><span class="nv">EXPMONO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="c">      </span><span class="w">                                            </span><span class="nv">EXPYEARO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">                                        </span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPDAYO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-MADE</span><span class="w">                                        </span>
<a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a><span class="c">      *               MOVE OLD VALUES TO NON-DISPLAY FIELDS                     </span>
<a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="c">      *               THAT WE ARE NOT ALLOWING USER TO CHANGE(FOR NOW)          </span>
<a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a><span class="c">      *               MOVE CCUP-NEW-EXPDAY     TO EXPDAYO  OF CCRDUPAO          </span>
<a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPDAYO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                    </span>
<a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a><span class="kp">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPDAYO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-EVALUATE                                                      </span>
<a id="__codelineno-30-49" name="__codelineno-30-49" href="#__codelineno-30-49"></a>
<a id="__codelineno-30-50" name="__codelineno-30-50" href="#__codelineno-30-50"></a>
<a id="__codelineno-30-51" name="__codelineno-30-51" href="#__codelineno-30-51"></a><span class="kr">           </span><span class="w"> </span><span class="kr">END-IF                                                              </span>
<a id="__codelineno-30-52" name="__codelineno-30-52" href="#__codelineno-30-52"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3200-setup-screen-vars-exit">3200-SETUP-SCREEN-VARS-EXIT</h3>
<p>This paragraph serves as an exit point for the 3200-SETUP-SCREEN-VARS routine. It provides a clean termination point for the screen variable setup process, allowing the program to return control to the calling routine after completing the screen preparation tasks.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3250-setup-infomsg">3250-SETUP-INFOMSG</h3>
<p>This paragraph handles the setup of information messages for the user interface based on the current state of the credit card update process. It evaluates various program states (such as initial entry, search results display, validation failures, confirmation requests, or update outcomes) and sets the appropriate message flag. Based on the program state, it determines what guidance or feedback should be displayed to the user - whether prompting for search criteria, requesting confirmation of changes, or reporting success/failure of update operations. The paragraph concludes by moving the selected information message and any error message to the output screen fields. This provides contextual feedback to users as they navigate through the card update workflow.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c">*    S</span><span class="nv">ETUP</span><span class="w"> </span><span class="nv">INFORMATION</span><span class="w"> </span><span class="err">MESSAGE                                            </span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="err">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                             </span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET </span><span class="w"> </span><span class="nv">PROMPT-FOR-SEARCH-KEYS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">                                    </span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PROMPT-FOR-SEARCH-KEYS</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">                                           </span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                         </span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PROMPT-FOR-CHANGES</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w">                               </span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PROMPT-FOR-CONFIRMATION</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">                                </span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CONFIRM-UPDATE-SUCCESS</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-LOCK-ERROR</span><span class="w">                              </span>
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INFORM-FAILURE</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-BUT-FAILED</span><span class="w">                              </span>
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INFORM-FAILURE</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                                          </span>
<a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PROMPT-FOR-SEARCH-KEYS</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                      </span>
<a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>
<a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-INFO-MSG</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">          </span>
<a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>
<a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">           </span>
<a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3250-setup-infomsg-exit">3250-SETUP-INFOMSG-EXIT</h3>
<p>This paragraph serves as an exit point for the SETUP-INFOMSG routine at line 3250. It provides a simple termination point for the routine without performing any additional processing, allowing the program to return control to the calling section after information messages have been configured.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3300-setup-screen-attrs">3300-SETUP-SCREEN-ATTRS</h3>
<p>This paragraph manages the screen attributes for the credit card update interface based on the current processing state. It dynamically controls field protection status (protected or unprotected), cursor positioning, and visual formatting (colors and highlighting) to guide user interaction. The code uses EVALUATE statements to determine appropriate field attributes based on the transaction's current state - whether initial data entry, displaying fetched details, showing validation errors, or confirming changes. It positions the cursor intelligently on fields requiring attention, particularly on error fields when validation fails. The paragraph implements visual feedback by highlighting error fields in red and marking missing required fields with asterisks. It also handles special display conditions like darkening unavailable fields and brightening information messages when present. This logic ensures the user interface remains context-appropriate throughout the card update workflow.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c">*    P</span><span class="nv">ROTECT</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">UNPROTECT</span><span class="w"> </span><span class="kp">BASED</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">CONTEXT</span><span class="w">                                </span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="nb">             </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-DETAILS-NOT-FETCHED</span><span class="w">                                     </span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CRDSTCDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c">      *                                  EXPDAYA  OF CCRDUPAI                   </span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPMONA</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPYEARA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN </span><span class="w"> </span><span class="nv">CCUP-SHOW-DETAILS</span><span class="w">                                           </span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN </span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                         </span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="c">      *                                  EXPDAYA  OF CCRDUPAI                   </span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CRDSTCDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPMONA</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPYEARA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OK-NOT-CONFIRMED</span><span class="w">                                </span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCUP-CHANGES-OKAYED-AND-DONE</span><span class="w">                                 </span>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CRDNAMEA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CRDSTCDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="c">      *                                  EXPDAYA  OF CCRDUPAI                   </span>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPMONA</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPYEARA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                        </span>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">CRDSTCDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a><span class="c">      *                                  EXPDAYA  OF CCRDUPAI                   </span>
<a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPMONA</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a><span class="c">      </span><span class="w">                                   </span><span class="nv">EXPYEARA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                   </span>
<a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a>
<a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="kp">POSITION</span><span class="w"> </span><span class="kp">CURSOR                                                      </span>
<a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a><span class="kp">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a><span class="nb">             </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">                                      </span>
<a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">NO-CHANGES-DETECTED</span><span class="w">                                          </span>
<a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                        </span>
<a id="__codelineno-34-46" name="__codelineno-34-46" href="#__codelineno-34-46"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-34-47" name="__codelineno-34-47" href="#__codelineno-34-47"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-48" name="__codelineno-34-48" href="#__codelineno-34-48"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                        </span>
<a id="__codelineno-34-49" name="__codelineno-34-49" href="#__codelineno-34-49"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-34-50" name="__codelineno-34-50" href="#__codelineno-34-50"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-51" name="__codelineno-34-51" href="#__codelineno-34-51"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDNAME-NOT-OK</span><span class="w">                                          </span>
<a id="__codelineno-34-52" name="__codelineno-34-52" href="#__codelineno-34-52"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDNAME-BLANK</span><span class="w">                                           </span>
<a id="__codelineno-34-53" name="__codelineno-34-53" href="#__codelineno-34-53"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEL</span><span class="w"> </span><span class="kp">OF </span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                 </span>
<a id="__codelineno-34-54" name="__codelineno-34-54" href="#__codelineno-34-54"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-NOT-OK</span><span class="w">                                        </span>
<a id="__codelineno-34-55" name="__codelineno-34-55" href="#__codelineno-34-55"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-34-56" name="__codelineno-34-56" href="#__codelineno-34-56"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDL</span><span class="w"> </span><span class="kp">OF </span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                 </span>
<a id="__codelineno-34-57" name="__codelineno-34-57" href="#__codelineno-34-57"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-NOT-OK</span><span class="w">                                        </span>
<a id="__codelineno-34-58" name="__codelineno-34-58" href="#__codelineno-34-58"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-34-59" name="__codelineno-34-59" href="#__codelineno-34-59"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONL</span><span class="w">  </span><span class="kp">OF </span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                 </span>
<a id="__codelineno-34-60" name="__codelineno-34-60" href="#__codelineno-34-60"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-NOT-OK</span><span class="w">                                       </span>
<a id="__codelineno-34-61" name="__codelineno-34-61" href="#__codelineno-34-61"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-BLANK</span><span class="w">                                        </span>
<a id="__codelineno-34-62" name="__codelineno-34-62" href="#__codelineno-34-62"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARL</span><span class="w"> </span><span class="kp">OF </span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                 </span>
<a id="__codelineno-34-63" name="__codelineno-34-63" href="#__codelineno-34-63"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                        </span>
<a id="__codelineno-34-64" name="__codelineno-34-64" href="#__codelineno-34-64"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-65" name="__codelineno-34-65" href="#__codelineno-34-65"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-34-66" name="__codelineno-34-66" href="#__codelineno-34-66"></a>
<a id="__codelineno-34-67" name="__codelineno-34-67" href="#__codelineno-34-67"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="nv">SETUP</span><span class="w"> </span><span class="nv">COLOR</span><span class="w">                                                          </span>
<a id="__codelineno-34-68" name="__codelineno-34-68" href="#__codelineno-34-68"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTMAPSET</span><span class="w">                        </span>
<a id="__codelineno-34-69" name="__codelineno-34-69" href="#__codelineno-34-69"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHDFCOL</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-70" name="__codelineno-34-70" href="#__codelineno-34-70"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHDFCOL</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-71" name="__codelineno-34-71" href="#__codelineno-34-71"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-72" name="__codelineno-34-72" href="#__codelineno-34-72"></a>
<a id="__codelineno-34-73" name="__codelineno-34-73" href="#__codelineno-34-73"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-34-74" name="__codelineno-34-74" href="#__codelineno-34-74"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-75" name="__codelineno-34-75" href="#__codelineno-34-75"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-76" name="__codelineno-34-76" href="#__codelineno-34-76"></a>
<a id="__codelineno-34-77" name="__codelineno-34-77" href="#__codelineno-34-77"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-34-78" name="__codelineno-34-78" href="#__codelineno-34-78"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">                                                </span>
<a id="__codelineno-34-79" name="__codelineno-34-79" href="#__codelineno-34-79"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-80" name="__codelineno-34-80" href="#__codelineno-34-80"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-81" name="__codelineno-34-81" href="#__codelineno-34-81"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-82" name="__codelineno-34-82" href="#__codelineno-34-82"></a>
<a id="__codelineno-34-83" name="__codelineno-34-83" href="#__codelineno-34-83"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-34-84" name="__codelineno-34-84" href="#__codelineno-34-84"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-85" name="__codelineno-34-85" href="#__codelineno-34-85"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-86" name="__codelineno-34-86" href="#__codelineno-34-86"></a>
<a id="__codelineno-34-87" name="__codelineno-34-87" href="#__codelineno-34-87"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-34-88" name="__codelineno-34-88" href="#__codelineno-34-88"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">                                                </span>
<a id="__codelineno-34-89" name="__codelineno-34-89" href="#__codelineno-34-89"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-90" name="__codelineno-34-90" href="#__codelineno-34-90"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-91" name="__codelineno-34-91" href="#__codelineno-34-91"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-92" name="__codelineno-34-92" href="#__codelineno-34-92"></a>
<a id="__codelineno-34-93" name="__codelineno-34-93" href="#__codelineno-34-93"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDNAME-NOT-OK</span><span class="w">                                               </span>
<a id="__codelineno-34-94" name="__codelineno-34-94" href="#__codelineno-34-94"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-95" name="__codelineno-34-95" href="#__codelineno-34-95"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-96" name="__codelineno-34-96" href="#__codelineno-34-96"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-97" name="__codelineno-34-97" href="#__codelineno-34-97"></a>
<a id="__codelineno-34-98" name="__codelineno-34-98" href="#__codelineno-34-98"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDNAME-BLANK</span><span class="w">                                               </span>
<a id="__codelineno-34-99" name="__codelineno-34-99" href="#__codelineno-34-99"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-100" name="__codelineno-34-100" href="#__codelineno-34-100"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-101" name="__codelineno-34-101" href="#__codelineno-34-101"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-102" name="__codelineno-34-102" href="#__codelineno-34-102"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-103" name="__codelineno-34-103" href="#__codelineno-34-103"></a>
<a id="__codelineno-34-104" name="__codelineno-34-104" href="#__codelineno-34-104"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-34-105" name="__codelineno-34-105" href="#__codelineno-34-105"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-106" name="__codelineno-34-106" href="#__codelineno-34-106"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-107" name="__codelineno-34-107" href="#__codelineno-34-107"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-108" name="__codelineno-34-108" href="#__codelineno-34-108"></a>
<a id="__codelineno-34-109" name="__codelineno-34-109" href="#__codelineno-34-109"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDSTATUS-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-34-110" name="__codelineno-34-110" href="#__codelineno-34-110"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-111" name="__codelineno-34-111" href="#__codelineno-34-111"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-112" name="__codelineno-34-112" href="#__codelineno-34-112"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-113" name="__codelineno-34-113" href="#__codelineno-34-113"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-114" name="__codelineno-34-114" href="#__codelineno-34-114"></a>
<a id="__codelineno-34-115" name="__codelineno-34-115" href="#__codelineno-34-115"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMDAR</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPDAYC</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-116" name="__codelineno-34-116" href="#__codelineno-34-116"></a>
<a id="__codelineno-34-117" name="__codelineno-34-117" href="#__codelineno-34-117"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-34-118" name="__codelineno-34-118" href="#__codelineno-34-118"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-119" name="__codelineno-34-119" href="#__codelineno-34-119"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONC</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-120" name="__codelineno-34-120" href="#__codelineno-34-120"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-121" name="__codelineno-34-121" href="#__codelineno-34-121"></a>
<a id="__codelineno-34-122" name="__codelineno-34-122" href="#__codelineno-34-122"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDEXPMON-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-34-123" name="__codelineno-34-123" href="#__codelineno-34-123"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-124" name="__codelineno-34-124" href="#__codelineno-34-124"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-125" name="__codelineno-34-125" href="#__codelineno-34-125"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONC</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-126" name="__codelineno-34-126" href="#__codelineno-34-126"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-127" name="__codelineno-34-127" href="#__codelineno-34-127"></a>
<a id="__codelineno-34-128" name="__codelineno-34-128" href="#__codelineno-34-128"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-NOT-OK</span><span class="w">                                           </span>
<a id="__codelineno-34-129" name="__codelineno-34-129" href="#__codelineno-34-129"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-130" name="__codelineno-34-130" href="#__codelineno-34-130"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-131" name="__codelineno-34-131" href="#__codelineno-34-131"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-132" name="__codelineno-34-132" href="#__codelineno-34-132"></a>
<a id="__codelineno-34-133" name="__codelineno-34-133" href="#__codelineno-34-133"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDEXPYEAR-BLANK</span><span class="w">                                            </span>
<a id="__codelineno-34-134" name="__codelineno-34-134" href="#__codelineno-34-134"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CCUP-CHANGES-NOT-OK</span><span class="w">                                              </span>
<a id="__codelineno-34-135" name="__codelineno-34-135" href="#__codelineno-34-135"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-136" name="__codelineno-34-136" href="#__codelineno-34-136"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAO</span><span class="w">                  </span>
<a id="__codelineno-34-137" name="__codelineno-34-137" href="#__codelineno-34-137"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-138" name="__codelineno-34-138" href="#__codelineno-34-138"></a>
<a id="__codelineno-34-139" name="__codelineno-34-139" href="#__codelineno-34-139"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                                               </span>
<a id="__codelineno-34-140" name="__codelineno-34-140" href="#__codelineno-34-140"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMDAR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-141" name="__codelineno-34-141" href="#__codelineno-34-141"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-34-142" name="__codelineno-34-142" href="#__codelineno-34-142"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMBRY</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-143" name="__codelineno-34-143" href="#__codelineno-34-143"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-144" name="__codelineno-34-144" href="#__codelineno-34-144"></a>
<a id="__codelineno-34-145" name="__codelineno-34-145" href="#__codelineno-34-145"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">PROMPT-FOR-CONFIRMATION</span><span class="w">                                           </span>
<a id="__codelineno-34-146" name="__codelineno-34-146" href="#__codelineno-34-146"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMBRY</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FKEYSCA</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDUPAI</span><span class="w">                  </span>
<a id="__codelineno-34-147" name="__codelineno-34-147" href="#__codelineno-34-147"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-34-148" name="__codelineno-34-148" href="#__codelineno-34-148"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3300-setup-screen-attrs-exit">3300-SETUP-SCREEN-ATTRS-EXIT</h3>
<p>This paragraph serves as an exit point for the screen attributes setup routine in the credit card update program. It marks the end of the process that configures display attributes for the user interface elements, allowing the program to return control to the calling section after screen formatting is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3400-send-screen">3400-SEND-SCREEN</h3>
<p>This paragraph handles the display of the credit card update screen to the user. It first sets the next map and mapset values in the communication area, then uses a CICS SEND MAP command to display the screen. The command sends the map defined in CCARD-NEXT-MAP from the CCRDUPAO data structure, positions the cursor appropriately, clears the screen (ERASE), and enables keyboard input (FREEKB). The response code from this operation is captured in WS-RESP-CD for error handling purposes.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c">MOVE L</span><span class="nv">IT-THISMAPSET</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                     </span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                        </span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="nv">CCARD-NEXT-MAP</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="c">      </span><span class="w">                    </span><span class="nv">MAPSET</span><span class="p">(</span><span class="nv">CCARD-NEXT-MAPSET</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="c">      </span><span class="w">                    </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">CCRDUPAO</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="c">      </span><span class="w">                    </span><span class="kp">CURSOR                                                </span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="kp">                         </span><span class="w"> </span><span class="kp">ERASE                                                 </span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="kp">                         </span><span class="w"> </span><span class="nv">FREEKB</span><span class="w">                                                </span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="c">      </span><span class="w">                    </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                      </span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="3400-send-screen-exit">3400-SEND-SCREEN-EXIT</h3>
<p>This paragraph serves as an exit point for the screen sending process in the credit card update program. It marks the end of the screen display routine, allowing the program to return control to the calling section after the user interface has been presented. This is a simple control flow marker that helps maintain the structured programming approach used throughout the COCRDUPC program.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9000-read-data">9000-READ-DATA</h3>
<p>This paragraph initializes and populates the CCUP-OLD-DETAILS structure with credit card information retrieved from the database. It first clears the structure, then sets the account ID and card number from the communication area. The paragraph calls the 9100-GETCARD-BYACCTCARD routine to fetch the card record, and if found, extracts key card details including the CVV code, embossed name (converting lowercase to uppercase), expiration date (parsed into separate year, month, and day components), and active status. These values are stored in the "OLD" fields, establishing a baseline of the current card data before any updates are made, which will likely be used later for comparison or display purposes.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c">INITIA</span><span class="nv">LIZE</span><span class="w"> </span><span class="nv">CCUP-OLD-DETAILS</span><span class="w">                                          </span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-ACCTID</span><span class="w">                      </span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CARDID</span><span class="w">                      </span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">GETCARD-BYACCTCARD</span><span class="w">                                      </span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">GETCARD-BYACCTCARD-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">                                           </span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-CVV-CD</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CVV-CD</span><span class="w">                      </span>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">INSPECT</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">                                        </span>
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="c">      </span><span class="w">        </span><span class="kp">CONVERTING</span><span class="w"> </span><span class="nv">LIT-LOWER</span><span class="w">                                              </span>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="c">      </span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">LIT-UPPER</span><span class="w">                                              </span>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">                     </span>
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">                     </span>
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">                      </span>
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">                      </span>
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">                     </span>
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9000-read-data-exit">9000-READ-DATA-EXIT</h3>
<p>This paragraph serves as an exit point for the data reading process in the credit card update program. It marks the end of the read operation logic, allowing the program to return control to the calling section after retrieving card details from the database.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9100-getcard-byacctcard">9100-GETCARD-BYACCTCARD</h3>
<p>This paragraph retrieves a credit card record from the card file using the card number as the key. It performs a CICS READ operation on the CARDFILENAME file using the card number stored in WS-CARD-RID-CARDNUM. The paragraph handles three possible outcomes: if the read is successful, it sets a flag indicating the card was found; if the record is not found, it sets error flags for both account and card filters and potentially sets a message indicating the account/card combination doesn't exist; for any other response code, it sets an input error flag, captures the error details (operation, file name, response codes), and prepares an error message. This paragraph is a critical validation step in the card update process, ensuring the requested card exists before allowing modifications.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c">*    R</span><span class="nv">ead</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Card</span><span class="w"> </span><span class="kr">file                                                   </span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="c">      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  </span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                  </span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">READ                                                       </span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="kr">               </span><span class="w"> </span><span class="kr">FILE      </span><span class="p">(</span><span class="nv">LIT-CARDFILENAME</span><span class="p">)</span><span class="w">                                    </span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                 </span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                       </span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                         </span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                                  </span>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                           </span>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">NOTFND</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                         </span>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="c">      </span><span class="w">               </span><span class="kr">SET</span><span class="w"> </span><span class="nv">DID-NOT-FIND-ACCTCARD-COMBO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-40-28" name="__codelineno-40-28" href="#__codelineno-40-28"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                         </span>
<a id="__codelineno-40-29" name="__codelineno-40-29" href="#__codelineno-40-29"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-40-30" name="__codelineno-40-30" href="#__codelineno-40-30"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-40-31" name="__codelineno-40-31" href="#__codelineno-40-31"></a><span class="kr">                 </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">            </span>
<a id="__codelineno-40-32" name="__codelineno-40-32" href="#__codelineno-40-32"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDFILENAME</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">              </span>
<a id="__codelineno-40-33" name="__codelineno-40-33" href="#__codelineno-40-33"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">              </span>
<a id="__codelineno-40-34" name="__codelineno-40-34" href="#__codelineno-40-34"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">             </span>
<a id="__codelineno-40-35" name="__codelineno-40-35" href="#__codelineno-40-35"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">           </span>
<a id="__codelineno-40-36" name="__codelineno-40-36" href="#__codelineno-40-36"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-40-37" name="__codelineno-40-37" href="#__codelineno-40-37"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9100-getcard-byacctcard-exit">9100-GETCARD-BYACCTCARD-EXIT</h3>
<p>This paragraph serves as an exit point for the GETCARD-BYACCTCARD routine. It provides a clean termination point for the process that retrieves card details using account and card number as search criteria. The paragraph contains only the EXIT statement followed by a period, indicating the end of the logical processing block with no additional actions performed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9200-write-processing">9200-WRITE-PROCESSING</h3>
<p>This paragraph handles the critical update process for credit card records. It first attempts to read and lock the card record using the card number as the key. If the lock is successful, it checks if the record has been modified by another user since it was initially retrieved (via the 9300-CHECK-CHANGE-IN-REC paragraph). If no concurrent modification is detected, it prepares the update by initializing a CARD-UPDATE-RECORD structure and populating it with the new values from the user input, including card ID, CVV code, embossed name, expiration date, and active status. The paragraph then attempts to rewrite the record to the card file and checks if the update was successful. Error handling is implemented for lock failures and update failures, with appropriate status flags set to communicate the outcome back to the calling process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c">*    R</span><span class="nv">ead</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Card</span><span class="w"> </span><span class="kr">file                                                   </span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="c">      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  </span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                  </span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">READ                                                       </span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="kr">               </span><span class="w"> </span><span class="kr">FILE      </span><span class="p">(</span><span class="nv">LIT-CARDFILENAME</span><span class="p">)</span><span class="w">                                    </span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="c">      </span><span class="w">          </span><span class="kp">UPDATE                                                          </span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="kp">               </span><span class="w"> </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                 </span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                       </span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                         </span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="c">      *    Could we lock the record ?                                           </span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                             </span>
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">COULD-NOT-LOCK-FOR-UPDATE</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a><span class="kr">             </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">9200</span><span class="o">-</span><span class="nv">WRITE-PROCESSING-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a><span class="c">      *    Did someone change the record while we were out ?                    </span>
<a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9300</span><span class="o">-</span><span class="nv">CHECK-CHANGE-IN-REC</span><span class="w">                                     </span>
<a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9300</span><span class="o">-</span><span class="nv">CHECK-CHANGE-IN-REC-EXIT</span><span class="w">                                </span>
<a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">DATA-WAS-CHANGED-BEFORE-UPDATE</span><span class="w">                                    </span>
<a id="__codelineno-42-35" name="__codelineno-42-35" href="#__codelineno-42-35"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">9200</span><span class="o">-</span><span class="nv">WRITE-PROCESSING-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-42-36" name="__codelineno-42-36" href="#__codelineno-42-36"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-42-37" name="__codelineno-42-37" href="#__codelineno-42-37"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-42-38" name="__codelineno-42-38" href="#__codelineno-42-38"></a><span class="c">      * Prepare the update                                                      </span>
<a id="__codelineno-42-39" name="__codelineno-42-39" href="#__codelineno-42-39"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-42-40" name="__codelineno-42-40" href="#__codelineno-42-40"></a><span class="c">      </span><span class="w">     </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CARD-UPDATE-RECORD</span><span class="w">                                        </span>
<a id="__codelineno-42-41" name="__codelineno-42-41" href="#__codelineno-42-41"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CARDID</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-UPDATE-NUM</span><span class="w">                  </span>
<a id="__codelineno-42-42" name="__codelineno-42-42" href="#__codelineno-42-42"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-UPDATE-ACCT-ID</span><span class="w">              </span>
<a id="__codelineno-42-43" name="__codelineno-42-43" href="#__codelineno-42-43"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CVV-CD</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                    </span>
<a id="__codelineno-42-44" name="__codelineno-42-44" href="#__codelineno-42-44"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-CVV-CD-N</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-UPDATE-CVV-CD</span><span class="w">               </span>
<a id="__codelineno-42-45" name="__codelineno-42-45" href="#__codelineno-42-45"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDNAME</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-UPDATE-EMBOSSED-NAME</span><span class="w">        </span>
<a id="__codelineno-42-46" name="__codelineno-42-46" href="#__codelineno-42-46"></a><span class="c">      </span><span class="w">     </span><span class="kr">STRING </span><span class="w"> </span><span class="nv">CCUP-NEW-EXPYEAR</span><span class="w">                                             </span>
<a id="__codelineno-42-47" name="__codelineno-42-47" href="#__codelineno-42-47"></a><span class="c">      </span><span class="w">             </span><span class="s1">&#39;-&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-42-48" name="__codelineno-42-48" href="#__codelineno-42-48"></a><span class="c">      </span><span class="w">             </span><span class="nv">CCUP-NEW-EXPMON</span><span class="w">                                              </span>
<a id="__codelineno-42-49" name="__codelineno-42-49" href="#__codelineno-42-49"></a><span class="c">      </span><span class="w">             </span><span class="s1">&#39;-&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-42-50" name="__codelineno-42-50" href="#__codelineno-42-50"></a><span class="c">      </span><span class="w">             </span><span class="nv">CCUP-NEW-EXPDAY</span><span class="w">                                              </span>
<a id="__codelineno-42-51" name="__codelineno-42-51" href="#__codelineno-42-51"></a><span class="c">      </span><span class="w">             </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE                                            </span>
<a id="__codelineno-42-52" name="__codelineno-42-52" href="#__codelineno-42-52"></a><span class="kp">             </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">CARD-UPDATE-EXPIRAION-DATE</span><span class="w">                                   </span>
<a id="__codelineno-42-53" name="__codelineno-42-53" href="#__codelineno-42-53"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-STRING                                                           </span>
<a id="__codelineno-42-54" name="__codelineno-42-54" href="#__codelineno-42-54"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCUP-NEW-CRDSTCD</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-UPDATE-ACTIVE-STATUS</span><span class="w">        </span>
<a id="__codelineno-42-55" name="__codelineno-42-55" href="#__codelineno-42-55"></a>
<a id="__codelineno-42-56" name="__codelineno-42-56" href="#__codelineno-42-56"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w">                                                            </span>
<a id="__codelineno-42-57" name="__codelineno-42-57" href="#__codelineno-42-57"></a><span class="c">      </span><span class="w">          </span><span class="kr">REWRITE</span><span class="w"> </span><span class="kr">FILE</span><span class="p">(</span><span class="nv">LIT-CARDFILENAME</span><span class="p">)</span><span class="w">                                  </span>
<a id="__codelineno-42-58" name="__codelineno-42-58" href="#__codelineno-42-58"></a><span class="c">      </span><span class="w">                  </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">CARD-UPDATE-RECORD</span><span class="p">)</span><span class="w">                                </span>
<a id="__codelineno-42-59" name="__codelineno-42-59" href="#__codelineno-42-59"></a><span class="c">      </span><span class="w">                  </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-UPDATE-RECORD</span><span class="p">)</span><span class="w">                    </span>
<a id="__codelineno-42-60" name="__codelineno-42-60" href="#__codelineno-42-60"></a><span class="c">      </span><span class="w">                  </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                  </span>
<a id="__codelineno-42-61" name="__codelineno-42-61" href="#__codelineno-42-61"></a><span class="c">      </span><span class="w">                  </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                  </span>
<a id="__codelineno-42-62" name="__codelineno-42-62" href="#__codelineno-42-62"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-42-63" name="__codelineno-42-63" href="#__codelineno-42-63"></a>
<a id="__codelineno-42-64" name="__codelineno-42-64" href="#__codelineno-42-64"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-42-65" name="__codelineno-42-65" href="#__codelineno-42-65"></a><span class="c">      * Did the update succeed ?  *                                             </span>
<a id="__codelineno-42-66" name="__codelineno-42-66" href="#__codelineno-42-66"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-42-67" name="__codelineno-42-67" href="#__codelineno-42-67"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-42-68" name="__codelineno-42-68" href="#__codelineno-42-68"></a><span class="c">      </span><span class="w">       </span><span class="kr">CONTINUE                                                           </span>
<a id="__codelineno-42-69" name="__codelineno-42-69" href="#__codelineno-42-69"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-42-70" name="__codelineno-42-70" href="#__codelineno-42-70"></a><span class="kr">            </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">LOCKED-BUT-UPDATE-FAILED</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-42-71" name="__codelineno-42-71" href="#__codelineno-42-71"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-42-72" name="__codelineno-42-72" href="#__codelineno-42-72"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9200-write-processing-exit">9200-WRITE-PROCESSING-EXIT</h3>
<p>This paragraph serves as an exit point for the write processing routine in the COCRDUPC program. It provides a clean termination point for the write processing logic, allowing the program flow to return to the calling section after database update operations are completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9300-check-change-in-rec">9300-CHECK-CHANGE-IN-REC</h3>
<p>This paragraph checks if the card record has been modified by another user since it was initially retrieved. It first converts the embossed name to uppercase for consistent comparison. Then it compares all current card details (CVV code, embossed name, expiration date components, and active status) with the values that were originally read. If all fields match, processing continues normally. If any field has changed, indicating concurrent modification by another user, it sets a flag indicating data was changed before update, updates the stored "old" values with the current values from the database, and exits the current processing flow by branching to the write processing exit paragraph. This prevents overwriting changes made by other users and maintains data integrity in a multi-user environment.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="c">INSPEC</span><span class="nv">T</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">                                           </span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="c">      </span><span class="w">     </span><span class="kp">CONVERTING</span><span class="w"> </span><span class="nv">LIT-LOWER</span><span class="w">                                                 </span>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="c">      </span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">LIT-UPPER</span><span class="w">                                                 </span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARD-CVV-CD</span><span class="w">              </span><span class="ow">EQUAL </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CVV-CD</span><span class="w">               </span>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">       </span><span class="ow">EQUAL </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">              </span>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="ow">EQUAL </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">              </span>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">EQUAL </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">               </span>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">EQUAL </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">               </span>
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w">       </span><span class="ow">EQUAL </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">              </span>
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">DATA-WAS-CHANGED-BEFORE-UPDATE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="nb">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-CVV-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CVV-CD</span><span class="w">               </span>
<a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDNAME</span><span class="w">              </span>
<a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPYEAR</span><span class="w">              </span>
<a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPMON</span><span class="w">               </span>
<a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-EXPDAY</span><span class="w">               </span>
<a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCUP-OLD-CRDSTCD</span><span class="w">              </span>
<a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">9200</span><span class="o">-</span><span class="nv">WRITE-PROCESSING-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span><span class="w"> </span><span class="kr">EXIT                                                          </span>
<a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9300-check-change-in-rec-exit">9300-CHECK-CHANGE-IN-REC-EXIT</h3>
<p>This paragraph serves as an exit point for the record change verification process in the credit card update functionality. It includes a call to the 'CSSTRPFY' copybook, which contains common code for storing PF key information. This structure helps maintain consistent handling of function key inputs across the application while properly terminating the current processing logic.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="c">      *Common code to store PFKey</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="c">      ******************************************************************</span>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY </span><span class="s1">&#39;CSSTRPFY&#39;</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="c">      </span><span class="w">                                                                  </span><span class="mi">340000</span>
</code></pre></div>
</details>

<h3 id="abend-routine">ABEND-ROUTINE</h3>
<p>This paragraph handles abnormal termination (abend) processing in the credit card update program. It first checks if an error message has been set, and if not, assigns a default "unexpected abend" message. It then identifies the current program as the source of the error, displays the abend information to the user with a screen clear, cancels any existing abend handlers to prevent recursive error handling, and finally forces a controlled termination with abend code '9999'. This ensures that when unexpected errors occur during card update operations, the system fails gracefully with appropriate user notification rather than continuing with potentially corrupted data.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="c">IF ABE</span><span class="nv">ND-MSG</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                        </span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="no">             </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;UNEXPECTED ABEND OCCURRED.&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-MSG</span><span class="w">                    </span>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-CULPRIT</span><span class="w">                              </span>
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND                                                       </span>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="err">                           </span><span class="w"> </span><span class="kp">FROM </span><span class="p">(</span><span class="nv">ABEND-DATA</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="c">      </span><span class="w">                      </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">ABEND-DATA</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="c">      </span><span class="w">                      </span><span class="nv">NOHANDLE</span><span class="w">                                            </span>
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="c">      </span><span class="w">                      </span><span class="kp">ERASE                                               </span>
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="kp">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>
<a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">HANDLE</span><span class="w"> </span><span class="nv">ABEND</span><span class="w">                                               </span>
<a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="c">      </span><span class="w">          </span><span class="kr">CANCEL                                                          </span>
<a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a><span class="kr">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a>
<a id="__codelineno-46-18" name="__codelineno-46-18" href="#__codelineno-46-18"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">ABEND</span><span class="w">                                                      </span>
<a id="__codelineno-46-19" name="__codelineno-46-19" href="#__codelineno-46-19"></a><span class="c">      </span><span class="w">          </span><span class="nv">ABCODE</span><span class="p">(</span><span class="s1">&#39;9999&#39;</span><span class="p">)</span><span class="w">                                                  </span>
<a id="__codelineno-46-20" name="__codelineno-46-20" href="#__codelineno-46-20"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-46-21" name="__codelineno-46-21" href="#__codelineno-46-21"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="abend-routine-exit">ABEND-ROUTINE-EXIT</h3>
<p>This paragraph serves as the exit point for the ABEND-ROUTINE section in the COCRDUPC program. It marks the end of the abend handling logic with a simple EXIT statement. The paragraph includes version control information showing this code is part of CardDemo version 1.0-15-g27d6c6f-68, dated July 19, 2022.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="c">      *</span>
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT</span>
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>