
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="COCRDLIC.html">
      
      
        <link rel="next" href="COCRDUPC.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>COCRDSLC - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cocrdslc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              COCRDSLC
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT04C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDLIC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="COCRDSLC.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-main" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-return" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON-RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-main-exit" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-setup-screen-vars" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SETUP-SCREEN-VARS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-setup-screen-vars-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SETUP-SCREEN-VARS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-send-screen" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SEND-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-send-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SEND-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-process-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      2000-PROCESS-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-process-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2000-PROCESS-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-map" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-map-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-MAP-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-map-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-MAP-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9150-getcard-byacct" class="md-nav__link">
    <span class="md-ellipsis">
      9150-GETCARD-BYACCT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9150-getcard-byacct-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9150-GETCARD-BYACCT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abend-routine" class="md-nav__link">
    <span class="md-ellipsis">
      ABEND-ROUTINE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CORPT00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-main" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-return" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON-RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-main-exit" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-setup-screen-vars" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SETUP-SCREEN-VARS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-setup-screen-vars-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SETUP-SCREEN-VARS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-send-screen" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SEND-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-send-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SEND-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-process-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      2000-PROCESS-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-process-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2000-PROCESS-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-map" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-map-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-MAP-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-map-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-MAP-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-data-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-DATA-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-getcard-byacctcard-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9100-GETCARD-BYACCTCARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9150-getcard-byacct" class="md-nav__link">
    <span class="md-ellipsis">
      9150-GETCARD-BYACCT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9150-getcard-byacct-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9150-GETCARD-BYACCT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abend-routine" class="md-nav__link">
    <span class="md-ellipsis">
      ABEND-ROUTINE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cocrdslc">COCRDSLC</h1>
<h2 id="overview">Overview</h2>
<p>This program, COCRDSLC, is a CICS-based business logic component of the CardDemo application that handles credit card detail requests. It allows users to view detailed information about a specific credit card by accepting account and card number inputs. The program retrieves card information from a card data file using the provided identifiers and displays details such as the embossed name, expiration date, and card status.</p>
<p>The program supports navigation from other screens in the application, particularly from the credit card list screen (COCRDLIC), and provides appropriate validation of input parameters. It performs field-level validations to ensure account numbers are 11-digit numeric values and card numbers are 16-digit numeric values. The program handles various error conditions, including invalid inputs and record not found scenarios, displaying appropriate error messages to guide the user.</p>
<p>The application follows a structured approach with clear separation between screen handling, input processing, data retrieval, and error management functions. It integrates with the broader CardDemo application through a common communication area structure and supports standard PF key navigation, including PF3 for returning to the previous screen or main menu.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>COCRDSLC</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    actor User
    participant Main as 0000-MAIN
    participant SendMap as 1000-SEND-MAP
    participant ProcessInputs as 2000-PROCESS-INPUTS
    participant ReadData as 9000-READ-DATA
    participant CardFile as Card File

    User-&gt;&gt;Main: Start transaction

    Main-&gt;&gt;Main: Initialize work areas
    Main-&gt;&gt;Main: Store context
    Main-&gt;&gt;Main: Process communication area

    alt PF3 pressed
        Main-&gt;&gt;User: Return to previous screen
    else Coming from credit card list screen
        Main-&gt;&gt;ReadData: Read card details
        ReadData-&gt;&gt;CardFile: READ using card number
        CardFile--&gt;&gt;ReadData: Card record
        ReadData--&gt;&gt;Main: Card details
        Main-&gt;&gt;SendMap: Display card details
        SendMap--&gt;&gt;User: Show card details screen
    else Initial entry
        Main-&gt;&gt;SendMap: Display input screen
        SendMap--&gt;&gt;User: Show input screen
    else Re-entry after input
        Main-&gt;&gt;ProcessInputs: Process user inputs
        ProcessInputs-&gt;&gt;ProcessInputs: Receive map data
        ProcessInputs-&gt;&gt;ProcessInputs: Validate account ID
        ProcessInputs-&gt;&gt;ProcessInputs: Validate card number

        alt Input valid
            ProcessInputs--&gt;&gt;Main: Valid input
            Main-&gt;&gt;ReadData: Read card details
            ReadData-&gt;&gt;CardFile: READ using card number

            alt Record found
                CardFile--&gt;&gt;ReadData: Card record
                ReadData--&gt;&gt;Main: Card details
                Main-&gt;&gt;SendMap: Display card details
                SendMap--&gt;&gt;User: Show card details screen
            else Record not found
                CardFile--&gt;&gt;ReadData: NOTFND response
                ReadData--&gt;&gt;Main: Error - record not found
                Main-&gt;&gt;SendMap: Display error message
                SendMap--&gt;&gt;User: Show error message
            end
        else Input invalid
            ProcessInputs--&gt;&gt;Main: Invalid input
            Main-&gt;&gt;SendMap: Display error message
            SendMap--&gt;&gt;User: Show error message
        end
    end

    Main-&gt;&gt;Main: Return to CICS</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CSDAT01Y.html"><code>CSDAT01Y</code></a></li>
<li><code>COCRDSL</code></li>
<li><a href="copybooks/CVCUS01Y.html"><code>CVCUS01Y</code></a></li>
<li><code>DFHAID</code></li>
<li><a href="copybooks/CVACT01Y.html"><code>CVACT01Y</code></a></li>
<li><a href="copybooks/CSUSR01Y.html"><code>CSUSR01Y</code></a></li>
<li><a href="copybooks/COCOM01Y.html"><code>COCOM01Y</code></a></li>
<li><a href="copybooks/CVCRD01Y.html"><code>CVCRD01Y</code></a></li>
<li><a href="copybooks/CSSTRPFY.html"><code>CSSTRPFY</code></a></li>
<li><code>DFHBMSCA</code></li>
<li><a href="copybooks/CVACT03Y.html"><code>CVACT03Y</code></a></li>
<li><a href="copybooks/CVACT02Y.html"><code>CVACT02Y</code></a></li>
<li><a href="copybooks/COTTL01Y.html"><code>COTTL01Y</code></a></li>
<li><a href="copybooks/CSMSG02Y.html"><code>CSMSG02Y</code></a></li>
<li><a href="copybooks/CSMSG01Y.html"><code>CSMSG01Y</code></a></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="input-output-section">INPUT-OUTPUT SECTION</h3>
<p>This section would typically contain file-related configuration details for the COCRDSLC program, including file assignments, record descriptions, and access methods for the card data files used in the credit card detail request processing. However, the provided snippet is empty, suggesting that the program may handle all its data access through CICS commands rather than direct file access statements, or that the INPUT-OUTPUT SECTION might be defined elsewhere in the program structure.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This Working Storage Section defines the data structures used in the COCRDSLC program for handling credit card detail requests. It contains several key components:</p>
<ol>
<li>CICS processing variables for handling responses and transaction IDs</li>
<li>Input validation flags for tracking the status of account and card number validations</li>
<li>Output edit variables for formatting and processing card details including account ID, card number, CVV code, embossed name, status, and expiration date</li>
<li>File handling structures including record identifiers and error message formatting</li>
<li>Message construction fields for user feedback, including informational messages and error conditions</li>
<li>Program constants and literals defining program names, transaction IDs, mapsets, and file names</li>
<li>References to several copybooks that provide additional data structures:</li>
<li>CVCRD01Y for card-related data</li>
<li>COCOM01Y for application communication area</li>
<li>Standard IBM copybooks for CICS functionality</li>
<li>Screen layout definitions (COCRDSL)</li>
<li>Date handling (CSDAT01Y)</li>
<li>Message formatting (CSMSG01Y, CSMSG02Y)</li>
<li>User data (CSUSR01Y)</li>
<li>Record layouts for cards (CVACT02Y) and customers (CVCUS01Y)</li>
</ol>
<p>The section includes comprehensive status flags and condition names to track validation states and error conditions throughout the card detail retrieval process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">01  WS</span><span class="o">-</span><span class="nv">MISC-STORAGE</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      * General CICS related                                                    </span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-CICS-PROCESSNG-VARS</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-RESP-CD</span><span class="w">                          </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-REAS-CD</span><span class="w">                          </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-TRANID</span><span class="w">                           </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">      *      Input edits                                                        </span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-INPUT-FLAG</span><span class="w">                         </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-OK</span><span class="w">                            </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-ERROR</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-PENDING</span><span class="w">                       </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-ACCT-FLAG</span><span class="w">                     </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARD-FLAG</span><span class="w">                     </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">             </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-RETURN-FLAG</span><span class="w">                        </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-FLAG-OFF</span><span class="w">                  </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-FLAG-ON</span><span class="w">                   </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-PFK-FLAG</span><span class="w">                           </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PFK-VALID</span><span class="w">                           </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PFK-INVALID</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="c">      * Output edits                                                            </span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">CICS-OUTPUT-EDIT-VARS</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-ACCT-ID-X</span><span class="w">                      </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-ACCT-ID-N</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">CARD-ACCT-ID-X</span><span class="w">                          </span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                       </span><span class="kt">PIC X(03)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CVV-CD-N</span><span class="w"> </span><span class="kp">REDEFINES </span><span class="w"> </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                           </span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(03)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CARD-NUM-X</span><span class="w">                     </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CARD-NUM-N</span><span class="w"> </span><span class="kp">REDEFINES </span><span class="w"> </span><span class="nv">CARD-CARD-NUM-X</span><span class="w">                       </span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-NAME-EMBOSSED-X</span><span class="w">                </span><span class="kt">PIC X(50)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-STATUS-X</span><span class="w">                       </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                       </span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="w">               </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">CARD-EXPIRY-YEAR</span><span class="w">                 </span><span class="kt">PIC X(4)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="kp">FILLER                          </span><span class="w"> </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">CARD-EXPIRY-MONTH</span><span class="w">                </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="kp">FILLER                          </span><span class="w"> </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">CARD-EXPIRY-DAY</span><span class="w">                  </span><span class="kt">PIC X(2)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-EXPIRAION-DATE-N</span><span class="w"> </span><span class="kp">REDEFINES                                  </span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="kp">              </span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="w">               </span><span class="kt">PIC 9(10)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="c">      *      File and data Handling                                             </span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-CARD-RID</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                 </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="w">                 </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">WS-CARD-RID-ACCT-ID-X</span><span class="w"> </span><span class="kp">REDEFINES                                  </span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="kp">                 </span><span class="w"> </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="w">              </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(12)                    </span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;File Error: &#39;</span><span class="p">.</span><span class="w">        </span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-OPNAME</span><span class="w">                        </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39; on &#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-FILE</span><span class="w">                          </span><span class="kt">PIC X(9)                     </span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(15)                    </span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="kp">                                                   </span><span class="s1">&#39; returned RESP &#39;</span><span class="p">.</span><span class="w">           </span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-RESP</span><span class="w">                          </span><span class="kt">PIC X(10)                    </span>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;,RESP2 &#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-RESP2</span><span class="w">                         </span><span class="kt">PIC X(10)                    </span>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a><span class="c">      </span><span class="w">    </span><span class="mi">10  </span><span class="kp">FILLER                              </span><span class="w"> </span><span class="kt">PIC X(5)                     </span>
<a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a><span class="c">      *      Output Message Construction                                        </span>
<a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-LONG-MSG</span><span class="w">                           </span><span class="kt">PIC X(500)</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-INFO-MSG</span><span class="w">                           </span><span class="kt">PIC X(40)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                 </span><span class="kp">VALUES                        </span>
<a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a><span class="kp">                                                 </span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">             </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a><span class="kp">               </span><span class="s1">&#39;   Displaying requested details&#39;</span><span class="p">.</span><span class="w">                               </span>
<a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-PROMPT-FOR-INPUT</span><span class="w">                 </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a><span class="kp">               </span><span class="s1">&#39;Please enter Account and Card Number&#39;</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a>
<a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-RETURN-MSG</span><span class="w">                         </span><span class="kt">PIC X(75)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                   </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-EXIT-MESSAGE</span><span class="w">                     </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a><span class="kp">               </span><span class="s1">&#39;PF03 pressed.Exiting              &#39;</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-PROMPT-FOR-ACCT</span><span class="w">                  </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a><span class="kp">               </span><span class="s1">&#39;Account number not provided&#39;</span><span class="p">.</span><span class="w">                                   </span>
<a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-PROMPT-FOR-CARD</span><span class="w">                  </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a><span class="kp">               </span><span class="s1">&#39;Card number not provided&#39;</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">NO-SEARCH-CRITERIA-RECEIVED</span><span class="w">         </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a><span class="kp">               </span><span class="s1">&#39;No input received&#39;</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">SEARCHED-ACCT-ZEROES</span><span class="w">                </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a><span class="kp">               </span><span class="s1">&#39;Account number must be a non zero 11 digit number&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">SEARCHED-ACCT-NOT-NUMERIC</span><span class="w">           </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a><span class="kp">               </span><span class="s1">&#39;Account number must be a non zero 11 digit number&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">SEARCHED-CARD-NOT-NUMERIC</span><span class="w">           </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a><span class="kp">               </span><span class="s1">&#39;Card number if supplied must be a 16 digit number&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a>
<a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">DID-NOT-FIND-ACCT-IN-CARDXREF</span><span class="w">       </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a><span class="kp">               </span><span class="s1">&#39;Did not find this account in cards database&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">DID-NOT-FIND-ACCTCARD-COMBO</span><span class="w">         </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-119" name="__codelineno-1-119" href="#__codelineno-1-119"></a><span class="kp">               </span><span class="s1">&#39;Did not find cards for this search condition&#39;</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-120" name="__codelineno-1-120" href="#__codelineno-1-120"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">XREF-READ-ERROR</span><span class="w">                     </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-121" name="__codelineno-1-121" href="#__codelineno-1-121"></a><span class="kp">               </span><span class="s1">&#39;Error reading Card Data File&#39;</span><span class="p">.</span><span class="w">                                  </span>
<a id="__codelineno-1-122" name="__codelineno-1-122" href="#__codelineno-1-122"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">CODING-TO-BE-DONE</span><span class="w">                   </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-123" name="__codelineno-1-123" href="#__codelineno-1-123"></a><span class="kp">               </span><span class="s1">&#39;Looks Good.... so far&#39;</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-1-124" name="__codelineno-1-124" href="#__codelineno-1-124"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-125" name="__codelineno-1-125" href="#__codelineno-1-125"></a><span class="c">      *      Literals and Constants                                             </span>
<a id="__codelineno-1-126" name="__codelineno-1-126" href="#__codelineno-1-126"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-127" name="__codelineno-1-127" href="#__codelineno-1-127"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-LITERALS</span><span class="p">.</span><span class="w">                                                          </span>
<a id="__codelineno-1-128" name="__codelineno-1-128" href="#__codelineno-1-128"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISPGM</span><span class="w">                           </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-129" name="__codelineno-1-129" href="#__codelineno-1-129"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDSLC&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-130" name="__codelineno-1-130" href="#__codelineno-1-130"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISTRANID</span><span class="w">                        </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-131" name="__codelineno-1-131" href="#__codelineno-1-131"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCDL&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-132" name="__codelineno-1-132" href="#__codelineno-1-132"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISMAPSET</span><span class="w">                        </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-133" name="__codelineno-1-133" href="#__codelineno-1-133"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDSL &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-134" name="__codelineno-1-134" href="#__codelineno-1-134"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-THISMAP</span><span class="w">                           </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-135" name="__codelineno-1-135" href="#__codelineno-1-135"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDSLA&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-136" name="__codelineno-1-136" href="#__codelineno-1-136"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                         </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-137" name="__codelineno-1-137" href="#__codelineno-1-137"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDLIC&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-138" name="__codelineno-1-138" href="#__codelineno-1-138"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTTRANID</span><span class="w">                      </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-139" name="__codelineno-1-139" href="#__codelineno-1-139"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCLI&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-140" name="__codelineno-1-140" href="#__codelineno-1-140"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTMAPSET</span><span class="w">                      </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-141" name="__codelineno-1-141" href="#__codelineno-1-141"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDLI&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-142" name="__codelineno-1-142" href="#__codelineno-1-142"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CCLISTMAP</span><span class="w">                         </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-143" name="__codelineno-1-143" href="#__codelineno-1-143"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDSLA&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-144" name="__codelineno-1-144" href="#__codelineno-1-144"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUPGM</span><span class="w">                           </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-145" name="__codelineno-1-145" href="#__codelineno-1-145"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN01C&#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-146" name="__codelineno-1-146" href="#__codelineno-1-146"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUTRANID</span><span class="w">                        </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-147" name="__codelineno-1-147" href="#__codelineno-1-147"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CM00&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-148" name="__codelineno-1-148" href="#__codelineno-1-148"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUMAPSET</span><span class="w">                        </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-149" name="__codelineno-1-149" href="#__codelineno-1-149"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN01&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-150" name="__codelineno-1-150" href="#__codelineno-1-150"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-MENUMAP</span><span class="w">                           </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-151" name="__codelineno-1-151" href="#__codelineno-1-151"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN1A&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-152" name="__codelineno-1-152" href="#__codelineno-1-152"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CARDFILENAME</span><span class="w">                      </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-153" name="__codelineno-1-153" href="#__codelineno-1-153"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CARDDAT &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-154" name="__codelineno-1-154" href="#__codelineno-1-154"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">LIT-CARDFILENAME-ACCT-PATH</span><span class="w">            </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-155" name="__codelineno-1-155" href="#__codelineno-1-155"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CARDAIX &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-156" name="__codelineno-1-156" href="#__codelineno-1-156"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-157" name="__codelineno-1-157" href="#__codelineno-1-157"></a><span class="c">      *Other common working storage Variables                                   </span>
<a id="__codelineno-1-158" name="__codelineno-1-158" href="#__codelineno-1-158"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-159" name="__codelineno-1-159" href="#__codelineno-1-159"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVCRD01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-160" name="__codelineno-1-160" href="#__codelineno-1-160"></a>
<a id="__codelineno-1-161" name="__codelineno-1-161" href="#__codelineno-1-161"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-162" name="__codelineno-1-162" href="#__codelineno-1-162"></a><span class="c">      *Application Commmarea Copybook                                           </span>
<a id="__codelineno-1-163" name="__codelineno-1-163" href="#__codelineno-1-163"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCOM01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-164" name="__codelineno-1-164" href="#__codelineno-1-164"></a>
<a id="__codelineno-1-165" name="__codelineno-1-165" href="#__codelineno-1-165"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="p">.</span><span class="w">                                                 </span>
<a id="__codelineno-1-166" name="__codelineno-1-166" href="#__codelineno-1-166"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CA-CALL-CONTEXT</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-167" name="__codelineno-1-167" href="#__codelineno-1-167"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CA-FROM-PROGRAM</span><span class="w">                    </span><span class="kt">PIC X(08)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-168" name="__codelineno-1-168" href="#__codelineno-1-168"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CA-FROM-TRANID</span><span class="w">                     </span><span class="kt">PIC X(04)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-169" name="__codelineno-1-169" href="#__codelineno-1-169"></a>
<a id="__codelineno-1-170" name="__codelineno-1-170" href="#__codelineno-1-170"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">WS-COMMAREA</span><span class="w">                             </span><span class="kt">PIC X(2000)</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-171" name="__codelineno-1-171" href="#__codelineno-1-171"></a>
<a id="__codelineno-1-172" name="__codelineno-1-172" href="#__codelineno-1-172"></a><span class="c">      *IBM SUPPLIED COPYBOOKS                                                   </span>
<a id="__codelineno-1-173" name="__codelineno-1-173" href="#__codelineno-1-173"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHBMSCA</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-174" name="__codelineno-1-174" href="#__codelineno-1-174"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHAID</span><span class="p">.</span><span class="w">                                                             </span>
<a id="__codelineno-1-175" name="__codelineno-1-175" href="#__codelineno-1-175"></a>
<a id="__codelineno-1-176" name="__codelineno-1-176" href="#__codelineno-1-176"></a><span class="c">      *COMMON COPYBOOKS                                                         </span>
<a id="__codelineno-1-177" name="__codelineno-1-177" href="#__codelineno-1-177"></a><span class="c">      *Screen Titles                                                            </span>
<a id="__codelineno-1-178" name="__codelineno-1-178" href="#__codelineno-1-178"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COTTL01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-179" name="__codelineno-1-179" href="#__codelineno-1-179"></a><span class="c">      *Credit Card Search Screen Layout                                         </span>
<a id="__codelineno-1-180" name="__codelineno-1-180" href="#__codelineno-1-180"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCRDSL</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-1-181" name="__codelineno-1-181" href="#__codelineno-1-181"></a>
<a id="__codelineno-1-182" name="__codelineno-1-182" href="#__codelineno-1-182"></a><span class="c">      *Current Date                                                             </span>
<a id="__codelineno-1-183" name="__codelineno-1-183" href="#__codelineno-1-183"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSDAT01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-184" name="__codelineno-1-184" href="#__codelineno-1-184"></a>
<a id="__codelineno-1-185" name="__codelineno-1-185" href="#__codelineno-1-185"></a><span class="c">      *Common Messages                                                          </span>
<a id="__codelineno-1-186" name="__codelineno-1-186" href="#__codelineno-1-186"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-187" name="__codelineno-1-187" href="#__codelineno-1-187"></a>
<a id="__codelineno-1-188" name="__codelineno-1-188" href="#__codelineno-1-188"></a><span class="c">      *Abend Variables                                                          </span>
<a id="__codelineno-1-189" name="__codelineno-1-189" href="#__codelineno-1-189"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG02Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-190" name="__codelineno-1-190" href="#__codelineno-1-190"></a>
<a id="__codelineno-1-191" name="__codelineno-1-191" href="#__codelineno-1-191"></a><span class="c">      *Signed on user data                                                      </span>
<a id="__codelineno-1-192" name="__codelineno-1-192" href="#__codelineno-1-192"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSUSR01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-193" name="__codelineno-1-193" href="#__codelineno-1-193"></a>
<a id="__codelineno-1-194" name="__codelineno-1-194" href="#__codelineno-1-194"></a><span class="c">      *Dataset layouts                                                          </span>
<a id="__codelineno-1-195" name="__codelineno-1-195" href="#__codelineno-1-195"></a><span class="c">      *ACCOUNT RECORD LAYOUT                                                    </span>
<a id="__codelineno-1-196" name="__codelineno-1-196" href="#__codelineno-1-196"></a><span class="c">      *COPY CVACT01Y.                                                           </span>
<a id="__codelineno-1-197" name="__codelineno-1-197" href="#__codelineno-1-197"></a>
<a id="__codelineno-1-198" name="__codelineno-1-198" href="#__codelineno-1-198"></a><span class="c">      *CARD RECORD LAYOUT                                                       </span>
<a id="__codelineno-1-199" name="__codelineno-1-199" href="#__codelineno-1-199"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT02Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-200" name="__codelineno-1-200" href="#__codelineno-1-200"></a>
<a id="__codelineno-1-201" name="__codelineno-1-201" href="#__codelineno-1-201"></a><span class="c">      *CARD XREF LAYOUT                                                         </span>
<a id="__codelineno-1-202" name="__codelineno-1-202" href="#__codelineno-1-202"></a><span class="c">      *COPY CVACT03Y.                                                           </span>
<a id="__codelineno-1-203" name="__codelineno-1-203" href="#__codelineno-1-203"></a>
<a id="__codelineno-1-204" name="__codelineno-1-204" href="#__codelineno-1-204"></a><span class="c">      *CUSTOMER LAYOUT                                                          </span>
<a id="__codelineno-1-205" name="__codelineno-1-205" href="#__codelineno-1-205"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVCUS01Y</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="linkage-section">LINKAGE SECTION</h3>
<p>This section defines the DFHCOMMAREA in the Linkage Section, which is the standard CICS communication area used to pass data between programs. It contains a single field defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length passed (EIBCALEN). This flexible structure allows the program to receive communication data of varying sizes from calling programs within the CardDemo application.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">01  DF</span><span class="nv">HCOMMAREA</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="kp">FILLER                               </span><span class="w"> </span><span class="kt">PIC X(1)                     </span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kt">            </span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="mi">32767 </span><span class="kp">TIMES</span><span class="w"> </span><span class="kp">DEPENDING</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="p">.</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="0000-main">0000-MAIN</h3>
<p>This paragraph serves as the main control flow for the COCRDSLC program, handling program initialization, navigation, and processing logic. It begins by setting up error handling through CICS HANDLE ABEND and initializing work areas. The code then preserves program context, processes any passed communication area data, and validates function key inputs (accepting only ENTER and PF3).</p>
<p>The core of the paragraph is an EVALUATE statement that directs program flow based on user actions:
- When PF3 is pressed, it transfers control back to the calling program or main menu
- When entering from the credit card list screen (COCRDLIC), it processes the already validated account and card numbers
- When entering from other contexts, it displays the initial input screen
- When re-entering after input, it validates the data, reads card details if valid, and redisplays the screen</p>
<p>The paragraph implements navigation logic between screens in the CardDemo application, maintaining context through the communication area. It also includes error handling to ensure appropriate messages are displayed when validation fails or unexpected conditions occur.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="nv">HANDLE</span><span class="w"> </span><span class="nv">ABEND</span><span class="w">                                               </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c">      </span><span class="w">               </span><span class="kp">LABEL</span><span class="p">(</span><span class="nv">ABEND-ROUTINE</span><span class="p">)</span><span class="w">                                       </span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CC-WORK-AREA</span><span class="w">                                              </span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-MISC-STORAGE</span><span class="w">                                           </span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-COMMAREA</span><span class="w">                                               </span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c">      * Store our context                                                       </span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">                               </span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c">      * Ensure error message is cleared                               *         </span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="nb">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c">      * Store passed data if  any                *                              </span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">0                                            </span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="mi">               </span><span class="ow">OR </span><span class="p">(</span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="c">      </span><span class="w">        </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">                                      </span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="c">      </span><span class="w">                   </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                                   </span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">  </span><span class="kp">TO              </span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="kp">                               </span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">                               </span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">                 </span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="c">      </span><span class="w">                         </span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kp">TO              </span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="kp">                               </span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                            </span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="c">      * Remap PFkeys as needed.                                                 </span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="c">      * Store the Mapped PF Key                                                 </span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">YYYY-STORE-PFKEY</span><span class="w">                                             </span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="nv">YYYY-STORE-PFKEY-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="c">      * Check the AID to see if its valid at this point               *         </span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="c">      * F3 - Exit                                                               </span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="c">      * Enter show screen again                                                 </span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PFK-INVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                              </span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="nb">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w"> </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="ow">             </span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w">                                                   </span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PFK-VALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                             </span>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">PFK-INVALID</span><span class="w">                                                       </span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="c">      * Decide what to do based on inputs received                              </span>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a><span class="nb">             </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w">                                              </span>
<a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a><span class="c">      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         </span>
<a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a><span class="no">                  </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">    </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                         </span>
<a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a><span class="no">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-MENUTRANID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-TRANID</span><span class="w">                   </span>
<a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="c">      </span><span class="w">             </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-TRANID</span><span class="w">                </span>
<a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a>
<a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a><span class="no">                  </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                         </span>
<a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a><span class="no">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span><span class="w">                  </span>
<a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a><span class="c">      </span><span class="w">             </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span><span class="w">               </span>
<a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a>
<a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                 </span>
<a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                </span>
<a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a>
<a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                 </span>
<a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                    </span>
<a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a><span class="c">      *                                                                         </span>
<a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a><span class="c">      </span><span class="w">             </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">XCTL</span><span class="w">                                               </span>
<a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a><span class="c">      </span><span class="w">                       </span><span class="kp">PROGRAM </span><span class="p">(</span><span class="nv">CDEMO-TO-PROGRAM</span><span class="p">)</span><span class="w">                         </span>
<a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a><span class="c">      </span><span class="w">                       </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a><span class="c">      </span><span class="w">             </span><span class="nv">END-EXEC</span><span class="w">                                                     </span>
<a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a><span class="c">      *            COMING FROM CREDIT CARD LIST SCREEN                          </span>
<a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a><span class="c">      *            SELECTION CRITERIA ALREADY VALIDATED                         </span>
<a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                              </span>
<a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a><span class="c">      </span><span class="w">         </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                      </span>
<a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                         </span>
<a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w">                     </span>
<a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w">                    </span>
<a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA</span><span class="w">                                       </span>
<a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                        </span>
<a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a><span class="c">      </span><span class="w">               </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                    </span>
<a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a><span class="c">      </span><span class="w">             </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                          </span>
<a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                              </span>
<a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a><span class="c">      *            COMING FROM SOME OTHER CONTEXT                               </span>
<a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a><span class="c">      *            SELECTION CRITERIA TO BE GATHERED                            </span>
<a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w"> </span><span class="kp">THRU                                   </span>
<a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a><span class="kp">                          </span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                   </span>
<a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a><span class="c">      </span><span class="w">             </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                          </span>
<a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">                                            </span>
<a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2000</span><span class="o">-</span><span class="nv">PROCESS-INPUTS</span><span class="w">                                  </span>
<a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2000</span><span class="o">-</span><span class="nv">PROCESS-INPUTS-EXIT</span><span class="w">                             </span>
<a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                                               </span>
<a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a><span class="c">      </span><span class="w">                </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                     </span>
<a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a><span class="c">      </span><span class="w">                   </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                </span>
<a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a><span class="c">      </span><span class="w">                </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                       </span>
<a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a><span class="c">      </span><span class="w">             </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA</span><span class="w">                                    </span>
<a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a><span class="c">      </span><span class="w">                   </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-DATA-EXIT</span><span class="w">                               </span>
<a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a><span class="c">      </span><span class="w">                </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                     </span>
<a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a><span class="c">      </span><span class="w">                   </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                </span>
<a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a><span class="c">      </span><span class="w">                </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                       </span>
<a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a>
<a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a>
<a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a><span class="kr">             </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                        </span>
<a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-CULPRIT</span><span class="w">                         </span>
<a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;0001&#39;</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-CODE</span><span class="w">                            </span>
<a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES        </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-REASON</span><span class="w">                          </span>
<a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;UNEXPECTED DATA SCENARIO&#39;</span><span class="w">                              </span>
<a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a><span class="c">      </span><span class="w">                                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">                         </span>
<a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-PLAIN-TEXT</span><span class="w">                                      </span>
<a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="nv">SEND-PLAIN-TEXT-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a>
<a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a>
<a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a><span class="kr">      </span><span class="o">*</span><span class="w"> </span><span class="kr">If</span><span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">had</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="kp">error</span><span class="w"> </span><span class="nv">setup</span><span class="w"> </span><span class="kp">error</span><span class="w"> </span><span class="err">message</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">slipped</span><span class="w"> </span><span class="kp">through             </span>
<a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a><span class="kp">      </span><span class="o">*</span><span class="w"> </span><span class="kr">Display</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="kr">return                                                      </span>
<a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                                                       </span>
<a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                            </span>
<a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                             </span>
<a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a><span class="c">      </span><span class="w">           </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                               </span>
<a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="common-return">COMMON-RETURN</h3>
<p>This paragraph handles the common return logic for the program, preparing the communication area before returning control to CICS. It first moves any return message to the error message field in the card data structure. Then it constructs a composite communication area by copying the standard CardDemo communication area to the working storage area, followed by appending this program's specific communication area data. Finally, it executes a CICS RETURN command that specifies the same transaction ID for continuation, passes the constructed communication area, and specifies its length. This ensures that both application-wide and program-specific context is preserved when control returns to the user or when the transaction is restarted.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">MOVE W</span><span class="nv">S-RETURN-MSG</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                            </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="w">                            </span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="kp">TO                                        </span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="kp">                 </span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">                  </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c">      </span><span class="w">                         </span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="p">)</span><span class="w">                 </span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="kr">               </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">LIT-THISTRANID</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c">      </span><span class="w">          </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-COMMAREA</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="0000-main-exit">0000-MAIN-EXIT</h3>
<p>This paragraph serves as the exit point for the program, marking the end of a logical processing block. It's a standard COBOL construct used to terminate the current paragraph's execution and return control to the calling routine.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1000-send-map">1000-SEND-MAP</h3>
<p>This paragraph orchestrates the process of preparing and sending the credit card detail screen to the user. It follows a structured sequence by first initializing the screen (1100-SCREEN-INIT), then setting up the screen variables with appropriate data values (1200-SETUP-SCREEN-VARS), configuring the screen attributes for proper display formatting (1300-SETUP-SCREEN-ATTRS), and finally sending the completed screen to the terminal (1400-SEND-SCREEN). This modular approach separates the different aspects of screen preparation and display into distinct, reusable components.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">1100</span><span class="o">-</span><span class="nv">SCREEN-INIT</span><span class="w">                                             </span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1100</span><span class="o">-</span><span class="nv">SCREEN-INIT-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">SETUP-SCREEN-VARS</span><span class="w">                                       </span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">SETUP-SCREEN-VARS-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1300</span><span class="o">-</span><span class="nv">SETUP-SCREEN-ATTRS</span><span class="w">                                      </span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1300</span><span class="o">-</span><span class="nv">SETUP-SCREEN-ATTRS-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1400</span><span class="o">-</span><span class="nv">SEND-SCREEN</span><span class="w">                                             </span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1400</span><span class="o">-</span><span class="nv">SEND-SCREEN-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1000-send-map-exit">1000-SEND-MAP-EXIT</h3>
<p>This paragraph serves as an exit point for the SEND-MAP routine in the COCRDSLC program. It marks the end of the map sending process and provides a clean return point for control flow when the program has completed displaying the credit card details screen to the user.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1100-screen-init">1100-SCREEN-INIT</h3>
<p>This paragraph initializes the screen display for the credit card detail screen. It clears the output area by setting it to LOW-VALUES, then retrieves the current date and time. The paragraph populates the screen header with application titles from the communication area, sets the transaction ID and program name, and formats the current date (MM/DD/YY) and time (HH:MM:SS) for display in the screen header. This establishes the standard header information that appears at the top of the screen before any card-specific data is displayed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">MOVE L</span><span class="nv">OW-VALUES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                                          </span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span><span class="w">                       </span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE01</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE01O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE02</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE02O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PGMNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span><span class="w">                       </span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MM</span><span class="w">                         </span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DD</span><span class="w">                         </span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-YY</span><span class="w">                         </span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MM-DD-YY</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURDATEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HOURS</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-HH</span><span class="w">                         </span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-MINUTE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-MM</span><span class="w">                         </span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-SECOND</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-SS</span><span class="w">                         </span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HH-MM-SS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURTIMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1100-screen-init-exit">1100-SCREEN-INIT-EXIT</h3>
<p>This paragraph serves as an exit point for the screen initialization routine in the COCRDSLC program. It marks the end of the screen initialization process and allows the program flow to return to the calling section.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1200-setup-screen-vars">1200-SETUP-SCREEN-VARS</h3>
<p>This paragraph initializes and populates the screen variables for the credit card detail display. It first checks if the program was called with parameters (EIBCALEN). If not, it sets a prompt for user input. Otherwise, it processes the incoming account and card information, transferring values from the communication area to the screen fields. When account or card numbers are zero, it sets the corresponding screen fields to LOW-VALUES. If card data was successfully found (FOUND-CARDS-FOR-ACCOUNT), it populates the display fields with card details including the embossed name, expiration date (split into month and year components), and card status. The paragraph concludes by setting appropriate informational or error messages on the screen based on the processing status.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">*    I</span><span class="nv">NITIALIZE</span><span class="w"> </span><span class="kr">SEARCH</span><span class="w"> </span><span class="nv">CRITERIA</span><span class="w">                                           </span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                                      </span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="mi">              </span><span class="kr">SET </span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-INPUT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                  </span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="nb">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                              </span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="mi">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES  </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                      </span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c">      </span><span class="w">        </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="kr">                </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                      </span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                             </span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="mi">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES  </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                       </span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="kr">               </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                       </span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w">                                        </span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EMBOSSED-NAME</span><span class="w">                                        </span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                 </span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE</span><span class="w">                                       </span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARD-EXPIRAION-DATE-X</span><span class="w">                </span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRY-MONTH</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPMONO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                 </span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-EXPIRY-YEAR</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EXPYEARO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                 </span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTCDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                </span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="kr">           </span><span class="w"> </span><span class="kr">END-IF                                                              </span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="nv">SETUP</span><span class="w"> </span><span class="err">MESSAGE                                                        </span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="err">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                                                </span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="c">      </span><span class="w">       </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-INPUT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                    </span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                   </span>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-INFO-MSG</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1200-setup-screen-vars-exit">1200-SETUP-SCREEN-VARS-EXIT</h3>
<p>This paragraph serves as an exit point for the 1200-SETUP-SCREEN-VARS routine. It marks the end of the screen variable setup process in the COCRDSLC program, allowing the program flow to return to the calling section after screen variables have been properly initialized or configured.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1300-setup-screen-attrs">1300-SETUP-SCREEN-ATTRS</h3>
<p>This paragraph configures the screen attributes for the credit card detail screen based on context and validation results. It determines whether input fields should be protected or unprotected depending on navigation flow - protecting fields when coming from the card list screen and making them editable otherwise. The paragraph handles cursor positioning logic, placing the cursor on the first field with an error or defaulting to the account ID field. It also manages color attributes for fields, highlighting validation errors in red, marking required fields with an asterisk when blank on reentry, and setting appropriate colors for information messages. This creates a user-friendly interface that guides users through error correction and data entry.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">*    P</span><span class="nv">ROTECT</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">UNPROTECT</span><span class="w"> </span><span class="kp">BASED</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">CONTEXT</span><span class="w">                                </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTMAPSET</span><span class="w"> </span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                           </span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                         </span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                         </span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                        </span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                        </span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="kp">POSITION</span><span class="w"> </span><span class="kp">CURSOR                                                      </span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="kp">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="nb">             </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                        </span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                  </span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                        </span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                                         </span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                  </span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="c">      </span><span class="w">        </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                        </span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w">                  </span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="nv">SETUP</span><span class="w"> </span><span class="nv">COLOR</span><span class="w">                                                          </span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTMAPSET</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-CCLISTPGM</span><span class="w">                          </span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHDFCOL</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                         </span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHDFCOL</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                         </span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a>
<a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">                                                </span>
<a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a>
<a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">                                                </span>
<a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-49" name="__codelineno-12-49" href="#__codelineno-12-49"></a>
<a id="__codelineno-12-50" name="__codelineno-12-50" href="#__codelineno-12-50"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                                               </span>
<a id="__codelineno-12-51" name="__codelineno-12-51" href="#__codelineno-12-51"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMDAR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-52" name="__codelineno-12-52" href="#__codelineno-12-52"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-53" name="__codelineno-12-53" href="#__codelineno-12-53"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHNEUTR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAO</span><span class="w">                  </span>
<a id="__codelineno-12-54" name="__codelineno-12-54" href="#__codelineno-12-54"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-55" name="__codelineno-12-55" href="#__codelineno-12-55"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1300-setup-screen-attrs-exit">1300-SETUP-SCREEN-ATTRS-EXIT</h3>
<p>This paragraph serves as an exit point for the screen attribute setup routine in the COCRDSLC program. It marks the end of the 1300-SETUP-SCREEN-ATTRS section, allowing the program to return control to the calling section after screen attributes have been configured for the credit card detail display.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kr">EXIT</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1400-send-screen">1400-SEND-SCREEN</h3>
<p>This paragraph handles the screen display functionality for the credit card detail screen. It sets up the next map and mapset values in the common communication area, indicating the program should be re-entered after the screen is displayed. The paragraph then uses a CICS SEND MAP command to display the screen to the user, positioning the cursor appropriately, clearing the previous screen content (ERASE), and freeing the keyboard for user input. The response code from this operation is captured in WS-RESP-CD for potential error handling.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c">MOVE L</span><span class="nv">IT-THISMAPSET</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                     </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                        </span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="nb">          </span><span class="w"> </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="nv">CCARD-NEXT-MAP</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c">      </span><span class="w">                    </span><span class="nv">MAPSET</span><span class="p">(</span><span class="nv">CCARD-NEXT-MAPSET</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c">      </span><span class="w">                    </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">CCRDSLAO</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c">      </span><span class="w">                    </span><span class="kp">CURSOR                                                </span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="kp">                         </span><span class="w"> </span><span class="kp">ERASE                                                 </span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="kp">                         </span><span class="w"> </span><span class="nv">FREEKB</span><span class="w">                                                </span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="c">      </span><span class="w">                    </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                      </span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1400-send-screen-exit">1400-SEND-SCREEN-EXIT</h3>
<p>This paragraph serves as an exit point for the SEND-SCREEN routine in the COCRDSLC program. It provides a clean termination point for the screen display logic, allowing the program to return control to the calling routine after the credit card detail screen has been formatted and sent to the user terminal.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2000-process-inputs">2000-PROCESS-INPUTS</h3>
<p>This paragraph handles the initial processing of user inputs from the screen. It first receives the map data from the user interface, then validates the input fields through the edit map inputs routine. After validation, it sets up the communication area with any error messages generated during validation and prepares for the next screen interaction by setting the program, mapset, and map names to the current program's values, ensuring the application will return to this same screen after processing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">2100</span><span class="o">-</span><span class="nv">RECEIVE-MAP</span><span class="w">                                             </span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2100</span><span class="o">-</span><span class="nv">RECEIVE-MAP-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2200</span><span class="o">-</span><span class="nv">EDIT-MAP-INPUTS</span><span class="w">                                         </span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2200</span><span class="o">-</span><span class="nv">EDIT-MAP-INPUTS-EXIT</span><span class="w">                                    </span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                               </span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                               </span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                             </span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                                </span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2000-process-inputs-exit">2000-PROCESS-INPUTS-EXIT</h3>
<p>This paragraph serves as an exit point for the 2000-PROCESS-INPUTS section, marking the end of input processing logic. It provides a clean termination point for the section that handles validation and processing of account and card number inputs in the credit card detail request flow.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2100-receive-map">2100-RECEIVE-MAP</h3>
<p>This paragraph receives user input from the screen map named in LIT-THISMAP within the mapset LIT-THISMAPSET. The data is stored in the CCRDSLAI structure, which likely contains the fields displayed on the credit card detail screen. The paragraph captures both response and reason codes in WS-RESP-CD and WS-REAS-CD respectively, which will be used elsewhere in the program to determine if the receive operation was successful or to handle any errors that occurred during the operation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">RECEIVE</span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="nv">LIT-THISMAP</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c">      </span><span class="w">               </span><span class="nv">MAPSET</span><span class="p">(</span><span class="nv">LIT-THISMAPSET</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c">      </span><span class="w">               </span><span class="kp">INTO</span><span class="p">(</span><span class="nv">CCRDSLAI</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                           </span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2100-receive-map-exit">2100-RECEIVE-MAP-EXIT</h3>
<p>This paragraph serves as an exit point for the RECEIVE-MAP routine in the COCRDSLC program. It marks the end of the map receiving process where user input from the credit card detail screen is captured. The paragraph contains only the EXIT statement, which transfers control back to the calling routine after the map receiving operations are complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2200-edit-map-inputs">2200-EDIT-MAP-INPUTS</h3>
<p>This paragraph processes and validates user input from the credit card detail screen. It first sets flags to indicate valid input status, then handles the account ID and card number fields by converting asterisks or spaces to low-values (which indicates no filter). The code then performs individual field validation by calling separate paragraphs for account and card number validation. Finally, it performs cross-field validation to determine if no search criteria were provided (both fields blank). This validation logic ensures proper input formatting before attempting to retrieve card details from the database.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c">SET IN</span><span class="nv">PUT-OK</span><span class="w">                  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="err">REPLACE </span><span class="o">*</span><span class="w"> </span><span class="kp">WITH</span><span class="w"> </span><span class="no">LOW-VALUES                                            </span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="no">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">                         </span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">                         </span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w">                                       </span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="c">      </span><span class="w">     </span><span class="ow">OR </span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES                                    </span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES          </span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">                        </span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDSLAI</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">                        </span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="nv">INDIVIDUAL</span><span class="w"> </span><span class="nv">FIELD</span><span class="w"> </span><span class="nv">EDITS</span><span class="w">                                               </span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT</span><span class="w">                                            </span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                       </span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD</span><span class="w">                                               </span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                          </span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="c">      *    CROSS FIELD EDITS                                                    </span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                                             </span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="c">      </span><span class="w">         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">NO-SEARCH-CRITERIA-RECEIVED</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                          </span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2200-edit-map-inputs-exit">2200-EDIT-MAP-INPUTS-EXIT</h3>
<p>This paragraph serves as an exit point for the 2200-EDIT-MAP-INPUTS routine. It marks the end of the input validation logic for the credit card detail screen, allowing the program flow to return to the calling section after input field validation is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2210-edit-account">2210-EDIT-ACCOUNT</h3>
<p>This paragraph validates the account ID input field for the credit card detail screen. It performs several checks: first determining if the account ID is empty (blank, low-values, or zeros), in which case it sets an input error flag and prompts the user for an account number. Next, it verifies that the account ID is both numeric and 11 digits in length. If these validations fail, it sets appropriate error flags and generates an error message. When the account ID passes all validations, it moves the value to the CDEMO-ACCT-ID field and sets a flag indicating the account filter is valid. The paragraph uses control flags to manage error handling and conditional message display based on the application's current state.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c">SET FL</span><span class="nv">G-ACCTFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                    </span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                     </span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                         </span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                          </span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-ACCT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                </span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                     </span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="c">      *    Not numeric                                                          </span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="c">      *    Not 11 characters                                                    </span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">  </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                        </span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="kp">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                           </span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="c">      </span><span class="w">          </span><span class="kr">MOVE                                                            </span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="kr">              </span><span class="s1">&#39;ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER&#39;</span><span class="w">            </span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="c">      </span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">                                  </span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                  </span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                      </span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                  </span>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2210-edit-account-exit">2210-EDIT-ACCOUNT-EXIT</h3>
<p>This paragraph serves as an exit point for the account number validation routine. It marks the end of the account number editing process, allowing the program to continue with the next processing step after account validation is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2220-edit-card">2220-EDIT-CARD</h3>
<p>This paragraph validates the credit card number input in the card detail request screen. It performs several checks: first, it verifies if the card number was provided at all (checking for spaces, low-values, or zeros). If the card number is missing, it sets appropriate error flags, prompts the user to enter a card number (if message display is enabled), and exits the validation routine. If a card number was entered, it then checks if the value is numeric and 16 digits long. When the input fails this validation, it sets error flags and displays a message informing the user that the card ID must be a 16-digit number. If the card number passes all validations, it moves the numeric value to the CDEMO-CARD-NUM field and sets a flag indicating the card filter is valid. This validation is critical for ensuring proper record retrieval from the card data file.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c">*    N</span><span class="nv">ot</span><span class="w"> </span><span class="kp">numeric                                                          </span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="kp">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="mi">16 </span><span class="kp">characters                                                    </span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="kp">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                    </span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                    </span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                        </span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                         </span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="c">      </span><span class="w">           </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-PROMPT-FOR-CARD</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="nb">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                               </span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="c">      *    Not numeric                                                          </span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="c">      *    Not 16 characters                                                    </span>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">  </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                       </span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="kp">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                           </span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                              </span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE                                                           </span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="kr">              </span><span class="s1">&#39;CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER&#39;</span><span class="w">            </span>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="c">      </span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">                                  </span>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                                 </span>
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                         </span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2220-edit-card-exit">2220-EDIT-CARD-EXIT</h3>
<p>This paragraph serves as an exit point for the card editing process in the COCRDSLC program. It marks the end of the card validation and editing logic, providing a clean return point for the program flow after completing the validation checks on the credit card information.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9000-read-data">9000-READ-DATA</h3>
<p>This paragraph calls the 9100-GETCARD-BYACCTCARD routine to retrieve credit card details based on the account and card number inputs. It serves as a wrapper for the actual data retrieval logic, maintaining the program's structured approach to data access.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">GETCARD-BYACCTCARD</span><span class="w">                                      </span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">GETCARD-BYACCTCARD-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9000-read-data-exit">9000-READ-DATA-EXIT</h3>
<p>This paragraph serves as an exit point for the data reading routine in the COCRDSLC program. It provides a clean termination point for the 9000-READ-DATA section, allowing control to return to the calling routine after data retrieval operations have been completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9100-getcard-byacctcard">9100-GETCARD-BYACCTCARD</h3>
<p>This paragraph retrieves a credit card record from the card file using the card number as the key. It performs a CICS READ operation on the card file and evaluates the response code to determine the outcome. If the read is successful, it sets a flag indicating that cards were found for the account. If the record is not found, it sets error flags for both account and card filters and potentially sets a message indicating the account/card combination was not found. For other error conditions, it captures detailed error information including operation name, file name, and response codes to generate an appropriate error message. The paragraph handles all possible outcomes of the file read operation with appropriate error handling.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c">*    R</span><span class="nv">ead</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Card</span><span class="w"> </span><span class="kr">file                                                   </span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c">      *    MOVE CC-ACCT-ID-N      TO WS-CARD-RID-ACCT-ID                        </span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                        </span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">READ                                                       </span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="kr">               </span><span class="w"> </span><span class="kr">FILE      </span><span class="p">(</span><span class="nv">LIT-CARDFILENAME</span><span class="p">)</span><span class="w">                                    </span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                 </span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                       </span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                         </span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                                  </span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                           </span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">NOTFND</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                         </span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">DID-NOT-FIND-ACCTCARD-COMBO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                   </span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">WS-RETURN-MSG-OFF</span><span class="w">                                         </span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                    </span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a><span class="kr">                 </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">            </span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDFILENAME</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">            </span>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">              </span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">             </span>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">           </span>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9100-getcard-byacctcard-exit">9100-GETCARD-BYACCTCARD-EXIT</h3>
<p>This paragraph serves as the exit point for the GETCARD-BYACCTCARD routine. It marks the end of the process that retrieves credit card details using account and card number identifiers. The paragraph contains only the EXIT statement, which returns control to the calling routine after the card retrieval operation has completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9150-getcard-byacct">9150-GETCARD-BYACCT</h3>
<p>This paragraph retrieves a credit card record from the card file using the account ID as the access key through an alternate index. It executes a CICS READ command against the card file's account path (LIT-CARDFILENAME-ACCT-PATH) using the account ID stored in WS-CARD-RID-ACCT-ID as the key. The paragraph then evaluates the response code from the read operation and sets appropriate flags based on the outcome. If the read is successful (NORMAL response), it sets the FOUND-CARDS-FOR-ACCOUNT flag. If the record is not found, it sets error flags indicating the account filter is invalid and the account was not found in the card cross-reference. For any other response, it sets error flags and populates error information fields with details about the failed operation, including the operation name, file name, response code, and reason code, and prepares an error message for display to the user.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c">*    R</span><span class="nv">ead</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Card</span><span class="w"> </span><span class="kr">file</span><span class="p">.</span><span class="w"> </span><span class="kp">Access</span><span class="w"> </span><span class="nv">via</span><span class="w"> </span><span class="nv">alternate</span><span class="w"> </span><span class="kp">index</span><span class="w"> </span><span class="nv">ACCTID</span><span class="w">                </span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c">      *                                                                         </span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">READ                                                       </span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="kr">               </span><span class="w"> </span><span class="kr">FILE      </span><span class="p">(</span><span class="nv">LIT-CARDFILENAME-ACCT-PATH</span><span class="p">)</span><span class="w">                          </span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="p">)</span><span class="w">                                 </span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="p">)</span><span class="w">                       </span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                         </span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                                  </span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FOUND-CARDS-FOR-ACCOUNT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                           </span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">NOTFND</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE              </span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">DID-NOT-FIND-ACCT-IN-CARDXREF</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                     </span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE              </span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">                     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">               </span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDFILENAME-ACCT-PATH</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">                 </span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">                 </span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">                </span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="w">              </span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9150-getcard-byacct-exit">9150-GETCARD-BYACCT-EXIT</h3>
<p>This paragraph serves as an exit point for the GETCARD-BYACCT routine. It includes a comment block explaining that there's functionality to display long text for debugging purposes, but notes that this debugging feature should not be used during normal program operation. The paragraph is minimally implemented with just an EXIT statement followed by a period.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="c">      * Display Long text and exit                                    *         </span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="c">      * This is primarily for debugging and should not be used in     *         </span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="c">      * regular course                                                *         </span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="send-long-text">SEND-LONG-TEXT</h3>
<p>This paragraph sends an extended message to the user's terminal screen using CICS SEND TEXT command. It displays the content stored in the WS-LONG-MSG field, clears the screen (ERASE), and unlocks the keyboard (FREEKB). After sending the message, it returns control to CICS, effectively ending the current transaction. This functionality is typically used for displaying detailed error messages or informational text that requires more space than standard screen fields.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="err">TEXT                                                  </span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="err">                    </span><span class="w"> </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">WS-LONG-MSG</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="c">      </span><span class="w">               </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-LONG-MSG</span><span class="p">)</span><span class="w">                              </span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c">      </span><span class="w">               </span><span class="kp">ERASE                                                      </span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="kp">                    </span><span class="w"> </span><span class="nv">FREEKB</span><span class="w">                                                     </span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="kr">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="send-long-text-exit">SEND-LONG-TEXT-EXIT</h3>
<p>This paragraph serves as a placeholder exit point for the SEND-LONG-TEXT routine in the COCRDSLC program. It contains a warning comment indicating that this is a plain text implementation that should not be used in production environments. This suggests it may be a simplified or unencrypted version of text handling that lacks proper security measures required for production use.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="c">      * Plain text exit - Dont use in production                      *         </span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="send-plain-text">SEND-PLAIN-TEXT</h3>
<p>This paragraph sends a plain text message to the user's terminal screen. It uses the CICS SEND TEXT command to display the contents of the WS-RETURN-MSG field, specifying the length of the message, clearing the screen (ERASE), and freeing the keyboard (FREEKB). After sending the message, it executes a CICS RETURN command to end the transaction and return control to CICS. This functionality is typically used for displaying error messages or informational text when normal screen formatting isn't required.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="err">TEXT                                                  </span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="err">                    </span><span class="w"> </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">WS-RETURN-MSG</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c">      </span><span class="w">               </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-RETURN-MSG</span><span class="p">)</span><span class="w">                            </span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c">      </span><span class="w">               </span><span class="kp">ERASE                                                      </span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="kp">                    </span><span class="w"> </span><span class="nv">FREEKB</span><span class="w">                                                     </span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="kr">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="send-plain-text-exit">SEND-PLAIN-TEXT-EXIT</h3>
<p>This paragraph serves as an exit point for the SEND-PLAIN-TEXT routine in the COCRDSLC program. It incorporates a copybook named 'CSSTRPFY' which contains common code for storing PF key information. This is part of the program's navigation handling mechanism, ensuring that function key inputs from the user interface are properly captured and preserved for subsequent processing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="c">      *Common code to store PFKey</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="c">      ******************************************************************</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY </span><span class="s1">&#39;CSSTRPFY&#39;</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="abend-routine">ABEND-ROUTINE</h3>
<p>This paragraph handles unexpected abend (abnormal end) conditions in the COCRDSLC program. If no specific abend message has been set (ABEND-MSG equals LOW-VALUES), it sets a default message indicating an unexpected abend occurred. It then identifies the current program as the source of the error by storing the program name in ABEND-CULPRIT. The routine sends the abend information to the user's terminal using CICS SEND, cancels any existing abend handling with CICS HANDLE ABEND CANCEL, and finally forces a controlled termination of the program with a specific abend code ('9999') using CICS ABEND. This provides a graceful error handling mechanism that displays useful diagnostic information before terminating the program when unexpected errors occur.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c">IF ABE</span><span class="nv">ND-MSG</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                        </span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="no">             </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;UNEXPECTED ABEND OCCURRED.&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-MSG</span><span class="w">                    </span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABEND-CULPRIT</span><span class="w">                              </span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND                                                       </span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="err">                           </span><span class="w"> </span><span class="kp">FROM </span><span class="p">(</span><span class="nv">ABEND-DATA</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="c">      </span><span class="w">                      </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">ABEND-DATA</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="c">      </span><span class="w">                      </span><span class="nv">NOHANDLE</span><span class="w">                                            </span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">HANDLE</span><span class="w"> </span><span class="nv">ABEND</span><span class="w">                                               </span>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="c">      </span><span class="w">          </span><span class="kr">CANCEL                                                          </span>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="kr">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">ABEND</span><span class="w">                                                      </span>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="c">      </span><span class="w">          </span><span class="nv">ABCODE</span><span class="p">(</span><span class="s1">&#39;9999&#39;</span><span class="p">)</span><span class="w">                                                  </span>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a>
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a><span class="c">      *</span>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT</span>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>