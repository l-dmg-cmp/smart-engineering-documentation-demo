
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="COBIL00C.html">
      
      
        <link rel="next" href="COCRDSLC.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>COCRDLIC - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cocrdlic" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              COCRDLIC
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT04C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="COCRDLIC.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-main" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-return" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON-RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-main-exit" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-screen-array-init" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SCREEN-ARRAY-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-screen-array-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SCREEN-ARRAY-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-setup-array-attribs" class="md-nav__link">
    <span class="md-ellipsis">
      1250-SETUP-ARRAY-ATTRIBS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-setup-array-attribs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1250-SETUP-ARRAY-ATTRIBS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-setup-message" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SETUP-MESSAGE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-setup-message-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SETUP-MESSAGE-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-send-screen" class="md-nav__link">
    <span class="md-ellipsis">
      1500-SEND-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-send-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1500-SEND-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-receive-map" class="md-nav__link">
    <span class="md-ellipsis">
      2000-RECEIVE-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-receive-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2000-RECEIVE-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-screen" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2250-edit-array" class="md-nav__link">
    <span class="md-ellipsis">
      2250-EDIT-ARRAY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2250-edit-array-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2250-EDIT-ARRAY-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-forward" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-FORWARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-forward-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-FORWARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-read-backwards" class="md-nav__link">
    <span class="md-ellipsis">
      9100-READ-BACKWARDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-read-backwards-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9100-READ-BACKWARDS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9500-filter-records" class="md-nav__link">
    <span class="md-ellipsis">
      9500-FILTER-RECORDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9500-filter-records-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9500-FILTER-RECORDS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT-EXIT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDSLC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CORPT00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-main" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-return" class="md-nav__link">
    <span class="md-ellipsis">
      COMMON-RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-main-exit" class="md-nav__link">
    <span class="md-ellipsis">
      0000-MAIN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-send-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1000-SEND-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-screen-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1100-SCREEN-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-screen-array-init" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SCREEN-ARRAY-INIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-screen-array-init-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1200-SCREEN-ARRAY-INIT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-setup-array-attribs" class="md-nav__link">
    <span class="md-ellipsis">
      1250-SETUP-ARRAY-ATTRIBS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1250-setup-array-attribs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1250-SETUP-ARRAY-ATTRIBS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-setup-screen-attrs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1300-SETUP-SCREEN-ATTRS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-setup-message" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SETUP-MESSAGE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-setup-message-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1400-SETUP-MESSAGE-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-send-screen" class="md-nav__link">
    <span class="md-ellipsis">
      1500-SEND-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-send-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      1500-SEND-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-receive-map" class="md-nav__link">
    <span class="md-ellipsis">
      2000-RECEIVE-MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2000-receive-map-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2000-RECEIVE-MAP-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-screen" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2100-receive-screen-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2100-RECEIVE-SCREEN-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-INPUTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2200-edit-inputs-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2200-EDIT-INPUTS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2210-edit-account-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2210-EDIT-ACCOUNT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2220-edit-card-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2220-EDIT-CARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2250-edit-array" class="md-nav__link">
    <span class="md-ellipsis">
      2250-EDIT-ARRAY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2250-edit-array-exit" class="md-nav__link">
    <span class="md-ellipsis">
      2250-EDIT-ARRAY-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-forward" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-FORWARD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-read-forward-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9000-READ-FORWARD-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-read-backwards" class="md-nav__link">
    <span class="md-ellipsis">
      9100-READ-BACKWARDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-read-backwards-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9100-READ-BACKWARDS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9500-filter-records" class="md-nav__link">
    <span class="md-ellipsis">
      9500-FILTER-RECORDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9500-filter-records-exit" class="md-nav__link">
    <span class="md-ellipsis">
      9500-FILTER-RECORDS-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-plain-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-PLAIN-TEXT-EXIT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-long-text-exit" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-LONG-TEXT-EXIT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cocrdlic">COCRDLIC</h1>
<h2 id="overview">Overview</h2>
<p>This program, COCRDLIC, is a business logic component of the CardDemo application that manages the display and navigation of credit card listings. It provides a user interface for viewing credit cards with filtering capabilities and access to detailed card information.</p>
<p>The program implements role-based access control, showing either all cards for admin users or only cards associated with a specific account for regular users. It supports pagination through card records with forward and backward navigation using PF7/PF8 keys.</p>
<p>Key functionality includes:
- Filtering card records by account ID and/or card number
- Displaying up to 7 card records per screen with pagination
- Allowing users to select individual cards for detailed view or update operations
- Input validation for account and card number filters
- Navigation between related screens in the application</p>
<p>The program interacts with the CARDDAT file to retrieve card information and handles various user actions including entering search criteria, selecting records for viewing or updating, and navigating between pages of results. Error handling is implemented throughout the program to provide appropriate feedback to users when invalid inputs are detected or when system errors occur.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>COCRDLIC</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    actor User
    participant Main as 0000-MAIN
    participant SendMap as 1000-SEND-MAP
    participant ReceiveMap as 2000-RECEIVE-MAP
    participant ReadForward as 9000-READ-FORWARD
    participant ReadBackwards as 9100-READ-BACKWARDS
    participant FilterRecords as 9500-FILTER-RECORDS
    participant CICS
    participant CardFile as CARDDAT File

    User-&gt;&gt;Main: Start transaction

    Main-&gt;&gt;Main: Initialize work areas
    Main-&gt;&gt;Main: Check COMMAREA

    alt First execution
        Main-&gt;&gt;Main: Initialize COMMAREA
    else Subsequent call
        Main-&gt;&gt;Main: Retrieve COMMAREA data
    end

    Main-&gt;&gt;Main: Store PF key

    alt User pressed PF3 (Exit)
        Main-&gt;&gt;CICS: XCTL to menu program
    else User pressed PF7 (Page Up)
        alt First page
            Main-&gt;&gt;ReadForward: Read current page
            ReadForward-&gt;&gt;CardFile: STARTBR
            ReadForward-&gt;&gt;CardFile: READNEXT (multiple)
            CardFile--&gt;&gt;ReadForward: Card records
            ReadForward-&gt;&gt;FilterRecords: Filter records
            ReadForward-&gt;&gt;CardFile: ENDBR
            ReadForward--&gt;&gt;Main: Return filtered records
        else Not first page
            Main-&gt;&gt;ReadBackwards: Read previous page
            ReadBackwards-&gt;&gt;CardFile: STARTBR
            ReadBackwards-&gt;&gt;CardFile: READPREV (multiple)
            CardFile--&gt;&gt;ReadBackwards: Card records
            ReadBackwards-&gt;&gt;FilterRecords: Filter records
            ReadBackwards-&gt;&gt;CardFile: ENDBR
            ReadBackwards--&gt;&gt;Main: Return filtered records
        end
    else User pressed PF8 (Page Down)
        alt More pages exist
            Main-&gt;&gt;ReadForward: Read next page
            ReadForward-&gt;&gt;CardFile: STARTBR
            ReadForward-&gt;&gt;CardFile: READNEXT (multiple)
            CardFile--&gt;&gt;ReadForward: Card records
            ReadForward-&gt;&gt;FilterRecords: Filter records
            ReadForward-&gt;&gt;CardFile: ENDBR
            ReadForward--&gt;&gt;Main: Return filtered records
        else Last page
            Main-&gt;&gt;SendMap: Display current page
        end
    else User pressed ENTER
        alt View card details selected
            Main-&gt;&gt;CICS: XCTL to card detail program
        else Update card selected
            Main-&gt;&gt;CICS: XCTL to card update program
        else Filter/search entered
            Main-&gt;&gt;ReceiveMap: Process input
            ReceiveMap-&gt;&gt;ReceiveMap: Validate account ID
            ReceiveMap-&gt;&gt;ReceiveMap: Validate card number
            ReceiveMap-&gt;&gt;ReceiveMap: Validate selections

            alt Input valid
                Main-&gt;&gt;ReadForward: Read filtered records
                ReadForward-&gt;&gt;CardFile: STARTBR
                ReadForward-&gt;&gt;CardFile: READNEXT (multiple)
                CardFile--&gt;&gt;ReadForward: Card records
                ReadForward-&gt;&gt;FilterRecords: Filter records
                ReadForward-&gt;&gt;CardFile: ENDBR
                ReadForward--&gt;&gt;Main: Return filtered records
            else Input error
                Main-&gt;&gt;SendMap: Display error message
            end
        end
    end

    Main-&gt;&gt;SendMap: Prepare screen
    SendMap-&gt;&gt;SendMap: Initialize screen
    SendMap-&gt;&gt;SendMap: Setup array data
    SendMap-&gt;&gt;SendMap: Setup array attributes
    SendMap-&gt;&gt;SendMap: Setup screen attributes
    SendMap-&gt;&gt;SendMap: Setup messages
    SendMap-&gt;&gt;CICS: SEND MAP

    Main-&gt;&gt;CICS: RETURN with COMMAREA
    CICS--&gt;&gt;User: Display screen</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CSDAT01Y.html"><code>CSDAT01Y</code></a></li>
<li><code>COCRDSL</code></li>
<li><code>DFHAID</code></li>
<li><a href="copybooks/CSUSR01Y.html"><code>CSUSR01Y</code></a></li>
<li><a href="copybooks/COCOM01Y.html"><code>COCOM01Y</code></a></li>
<li><a href="copybooks/CVCRD01Y.html"><code>CVCRD01Y</code></a></li>
<li><a href="copybooks/CSSTRPFY.html"><code>CSSTRPFY</code></a></li>
<li><code>DFHBMSCA</code></li>
<li><a href="copybooks/CVACT02Y.html"><code>CVACT02Y</code></a></li>
<li><code>COCRDLI</code></li>
<li><a href="copybooks/COTTL01Y.html"><code>COTTL01Y</code></a></li>
<li><a href="copybooks/CSMSG02Y.html"><code>CSMSG02Y</code></a></li>
<li><a href="copybooks/CSMSG01Y.html"><code>CSMSG01Y</code></a></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="input-output-section">INPUT-OUTPUT SECTION</h3>
<p>This section would typically contain the file definitions and I/O configurations for the COCRDLIC program, but appears to be empty in the provided snippet. In a complete program, the INPUT-OUTPUT SECTION would define the file control entries for files used by the program, such as the CARDDAT file mentioned in the program description. This section would specify file names, access methods, organization types, and record keys for the data files that the program reads from or writes to.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This Working Storage Section defines the data structures used in the COCRDLIC program for managing credit card listings. It contains several key components:</p>
<ol>
<li>CICS processing variables for handling responses and transaction IDs</li>
<li>Input validation flags and fields for filtering by account ID and card number</li>
<li>Selection handling variables that track user selections on the card listing screen</li>
<li>Output formatting and message construction fields for user feedback</li>
<li>File handling variables for CARDDAT file access and record filtering</li>
<li>Program constants including screen limits (7 lines per page) and program/transaction IDs for navigation</li>
<li>A commarea structure that maintains state between program invocations, particularly for pagination</li>
<li>Screen data arrays to store and display up to 7 card records per screen</li>
</ol>
<p>The section includes flags for role-based access control, pagination tracking (first/last page indicators), and error handling. It incorporates several copybooks for common structures like card records (CVACT02Y), user information (CSUSR01Y), and screen layouts (COCRDLI). The structure supports the program's core functionality of displaying filtered card listings with pagination and allowing users to select records for detailed viewing or updates.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">01  WS</span><span class="o">-</span><span class="nv">MISC-STORAGE</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      * General CICS related                                                    </span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-CICS-PROCESSNG-VARS</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-RESP-CD</span><span class="w">                          </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-REAS-CD</span><span class="w">                          </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c">      </span><span class="w">      </span><span class="mi">07 </span><span class="nv">WS-TRANID</span><span class="w">                           </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      * Input edits                                                             </span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-INPUT-FLAG</span><span class="w">                          </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-OK</span><span class="w">                            </span><span class="kp">VALUES </span><span class="s1">&#39;0&#39;</span><span class="w">                   </span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c">      </span><span class="w">                                                    </span><span class="s1">&#39; &#39;</span><span class="w">                   </span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">                                             </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">INPUT-ERROR</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-ACCT-FLAG</span><span class="w">                     </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">             </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-EDIT-CARD-FLAG</span><span class="w">                     </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">             </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-EDIT-SELECT-COUNTER</span><span class="w">                </span><span class="kt">PIC S9(04)                    </span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="kt">                                                 </span><span class="w"> </span><span class="kp">USAGE</span><span class="w"> </span><span class="kt">COMP-3                  </span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="kt">                                                 </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-EDIT-SELECT-FLAGS</span><span class="w">                  </span><span class="kt">PIC X(7)                      </span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="kt">                                                 </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-EDIT-SELECT-ARRAY</span><span class="w"> </span><span class="kp">REDEFINES </span><span class="w"> </span><span class="nv">WS-EDIT-SELECT-FLAGS</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-EDIT-SELECT</span><span class="w">                      </span><span class="kt">PIC X(1)                     </span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="kt">                                                 </span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">7 </span><span class="kp">TIMES</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">SELECT-OK</span><span class="w">                        </span><span class="kp">VALUES </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">VIEW-REQUESTED-ON</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39;S&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">UPDATE-REQUESTED-ON</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;U&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">SELECT-BLANK</span><span class="w">                     </span><span class="kp">VALUES                       </span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="kp">                                                   </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w">                         </span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="c">      </span><span class="w">                                             </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-EDIT-SELECT-ERROR-FLAGS</span><span class="w">             </span><span class="kt">PIC X(7)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-EDIT-SELECT-ERROR-FLAGX</span><span class="w">     </span><span class="kp">REDEFINES                            </span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="kp">           </span><span class="w"> </span><span class="nv">WS-EDIT-SELECT-ERROR-FLAGS</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-EDIT-SELECT-ERRORS</span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">7 </span><span class="kp">TIMES</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="c">      </span><span class="w">         </span><span class="mi">20 </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="w">          </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="c">      </span><span class="w">            </span><span class="mi">88 </span><span class="nv">WS-ROW-SELECT-ERROR</span><span class="w">          </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-SUBSCRIPT-VARS</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">I</span><span class="w">                                  </span><span class="kt">PIC S9(4)</span><span class="w"> </span><span class="kt">COMP                </span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="kt">                                                 </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">I-SELECTED</span><span class="w">                         </span><span class="kt">PIC S9(4)</span><span class="w"> </span><span class="kt">COMP                </span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="kt">                                                 </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">DETAIL-WAS-REQUESTED</span><span class="w">            </span><span class="kp">VALUES</span><span class="w"> </span><span class="mi">1 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="w">              </span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="c">      * Output edits                                                            </span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">CICS-OUTPUT-EDIT-VARS</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-ACCT-ID-X</span><span class="w">                      </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-ACCT-ID-N</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">CARD-ACCT-ID-X</span><span class="w">                          </span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                       </span><span class="kt">PIC X(03)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">CARD-CVV-CD-N</span><span class="w"> </span><span class="kp">REDEFINES </span><span class="w"> </span><span class="nv">CARD-CVV-CD-X</span><span class="w">                           </span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="c">      </span><span class="w">                                             </span><span class="kt">PIC 9(03)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">FLG-PROTECT-SELECT-ROWS</span><span class="w">             </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-PROTECT-SELECT-ROWS-NO</span><span class="w">          </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a><span class="c">      * Output Message Construction                                             </span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-LONG-MSG</span><span class="w">                           </span><span class="kt">PIC X(500)</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-INFO-MSG</span><span class="w">                           </span><span class="kt">PIC X(45)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                 </span><span class="kp">VALUES                        </span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="kp">                                                 </span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-INFORM-REC-ACTIONS</span><span class="w">          </span><span class="kp">VALUE                             </span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="kp">               </span><span class="s1">&#39;TYPE S FOR DETAIL, U TO UPDATE ANY RECORD&#39;</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-ERROR-MSG</span><span class="w">                         </span><span class="kt">PIC X(75)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-ERROR-MSG-OFF</span><span class="w">                   </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-EXIT-MESSAGE</span><span class="w">                     </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="kp">               </span><span class="s1">&#39;PF03 PRESSED.EXITING&#39;</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-NO-RECORDS-FOUND</span><span class="w">                 </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="kp">               </span><span class="s1">&#39;NO RECORDS FOUND FOR THIS SEARCH CONDITION.&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-MORE-THAN-1-ACTION</span><span class="w">              </span><span class="kp">VALUE                         </span>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a><span class="kp">               </span><span class="s1">&#39;PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE&#39;</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-INVALID-ACTION-CODE</span><span class="w">              </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a><span class="kp">               </span><span class="s1">&#39;INVALID ACTION CODE&#39;</span><span class="p">.</span><span class="w">                                           </span>
<a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-PFK-FLAG</span><span class="w">                           </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PFK-VALID</span><span class="w">                           </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">PFK-INVALID</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-CONTEXT-FLAG</span><span class="w">                       </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-CONTEXT-FRESH-START</span><span class="w">              </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-CONTEXT-FRESH-START-NO</span><span class="w">           </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a><span class="c">      * File and data Handling                                                  </span>
<a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-FILE-HANDLING-VARS</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a><span class="c">      </span><span class="w">      </span><span class="mi">10  </span><span class="nv">WS-CARD-RID</span><span class="p">.</span><span class="w">                                                    </span>
<a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a><span class="c">      </span><span class="w">          </span><span class="mi">20  </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">            </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a><span class="c">      </span><span class="w">          </span><span class="mi">20  </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="w">            </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a><span class="c">      </span><span class="w">          </span><span class="mi">20  </span><span class="nv">WS-CARD-RID-ACCT-ID-X</span><span class="w">          </span><span class="kp">REDEFINES                    </span>
<a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a><span class="kp">                   </span><span class="w"> </span><span class="nv">WS-CARD-RID-ACCT-ID</span><span class="w">            </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a>
<a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a>
<a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a>
<a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-SCRN-COUNTER</span><span class="w">               </span><span class="kt">PIC S9(4)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">              </span>
<a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a>
<a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-FILTER-RECORD-FLAG</span><span class="w">                 </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-EXCLUDE-THIS-RECORD</span><span class="w">               </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-DONOT-EXCLUDE-THIS-RECORD</span><span class="w">         </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-RECORDS-TO-PROCESS-FLAG</span><span class="w">            </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">READ-LOOP-EXIT</span><span class="w">                      </span><span class="kp">VALUE </span><span class="s1">&#39;0&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">MORE-RECORDS-TO-READ</span><span class="w">                </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(12)                    </span>
<a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;File Error:&#39;</span><span class="p">.</span><span class="w">         </span>
<a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-OPNAME</span><span class="w">                        </span><span class="kt">PIC X(8)                     </span>
<a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(4)                     </span>
<a id="__codelineno-1-119" name="__codelineno-1-119" href="#__codelineno-1-119"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39; on &#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-120" name="__codelineno-1-120" href="#__codelineno-1-120"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-FILE</span><span class="w">                          </span><span class="kt">PIC X(9)                     </span>
<a id="__codelineno-1-121" name="__codelineno-1-121" href="#__codelineno-1-121"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-122" name="__codelineno-1-122" href="#__codelineno-1-122"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(15)                    </span>
<a id="__codelineno-1-123" name="__codelineno-1-123" href="#__codelineno-1-123"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE                        </span>
<a id="__codelineno-1-124" name="__codelineno-1-124" href="#__codelineno-1-124"></a><span class="kp">                                                   </span><span class="s1">&#39; returned RESP &#39;</span><span class="p">.</span><span class="w">           </span>
<a id="__codelineno-1-125" name="__codelineno-1-125" href="#__codelineno-1-125"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-RESP</span><span class="w">                          </span><span class="kt">PIC X(10)                    </span>
<a id="__codelineno-1-126" name="__codelineno-1-126" href="#__codelineno-1-126"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-127" name="__codelineno-1-127" href="#__codelineno-1-127"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="kp">FILLER                             </span><span class="w"> </span><span class="kt">PIC X(7)                     </span>
<a id="__codelineno-1-128" name="__codelineno-1-128" href="#__codelineno-1-128"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;,RESP2 &#39;</span><span class="p">.</span><span class="w">             </span>
<a id="__codelineno-1-129" name="__codelineno-1-129" href="#__codelineno-1-129"></a><span class="c">      </span><span class="w">     </span><span class="mi">10  </span><span class="nv">ERROR-RESP2</span><span class="w">                         </span><span class="kt">PIC X(10)                    </span>
<a id="__codelineno-1-130" name="__codelineno-1-130" href="#__codelineno-1-130"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-131" name="__codelineno-1-131" href="#__codelineno-1-131"></a><span class="c">      </span><span class="w">    </span><span class="mi">10  </span><span class="kp">FILLER                              </span><span class="w"> </span><span class="kt">PIC X(5)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-132" name="__codelineno-1-132" href="#__codelineno-1-132"></a>
<a id="__codelineno-1-133" name="__codelineno-1-133" href="#__codelineno-1-133"></a><span class="c">      ******************************************************************</span>
<a id="__codelineno-1-134" name="__codelineno-1-134" href="#__codelineno-1-134"></a><span class="c">      * Literals and Constants                                                  </span>
<a id="__codelineno-1-135" name="__codelineno-1-135" href="#__codelineno-1-135"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-136" name="__codelineno-1-136" href="#__codelineno-1-136"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-CONSTANTS</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-1-137" name="__codelineno-1-137" href="#__codelineno-1-137"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">WS-MAX-SCREEN-LINES</span><span class="w">                    </span><span class="kt">PIC S9(4)</span><span class="w"> </span><span class="kt">COMP              </span>
<a id="__codelineno-1-138" name="__codelineno-1-138" href="#__codelineno-1-138"></a><span class="kt">                                                   </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-139" name="__codelineno-1-139" href="#__codelineno-1-139"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-THISPGM</span><span class="w">                            </span><span class="kt">PIC X(8)                    </span>
<a id="__codelineno-1-140" name="__codelineno-1-140" href="#__codelineno-1-140"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDLIC&#39;</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-141" name="__codelineno-1-141" href="#__codelineno-1-141"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-THISTRANID</span><span class="w">                         </span><span class="kt">PIC X(4)                    </span>
<a id="__codelineno-1-142" name="__codelineno-1-142" href="#__codelineno-1-142"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCLI&#39;</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-143" name="__codelineno-1-143" href="#__codelineno-1-143"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-THISMAPSET</span><span class="w">                         </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-144" name="__codelineno-1-144" href="#__codelineno-1-144"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDLI&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-145" name="__codelineno-1-145" href="#__codelineno-1-145"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-THISMAP</span><span class="w">                            </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-146" name="__codelineno-1-146" href="#__codelineno-1-146"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDLIA&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-147" name="__codelineno-1-147" href="#__codelineno-1-147"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-MENUPGM</span><span class="w">                            </span><span class="kt">PIC X(8)                    </span>
<a id="__codelineno-1-148" name="__codelineno-1-148" href="#__codelineno-1-148"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN01C&#39;</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-149" name="__codelineno-1-149" href="#__codelineno-1-149"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-MENUTRANID</span><span class="w">                         </span><span class="kt">PIC X(4)                    </span>
<a id="__codelineno-1-150" name="__codelineno-1-150" href="#__codelineno-1-150"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CM00&#39;</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-151" name="__codelineno-1-151" href="#__codelineno-1-151"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-MENUMAPSET</span><span class="w">                         </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-152" name="__codelineno-1-152" href="#__codelineno-1-152"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN01&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-153" name="__codelineno-1-153" href="#__codelineno-1-153"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-MENUMAP</span><span class="w">                            </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-154" name="__codelineno-1-154" href="#__codelineno-1-154"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COMEN1A&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-155" name="__codelineno-1-155" href="#__codelineno-1-155"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLPGM</span><span class="w">                         </span><span class="kt">PIC X(8)                    </span>
<a id="__codelineno-1-156" name="__codelineno-1-156" href="#__codelineno-1-156"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDSLC&#39;</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-157" name="__codelineno-1-157" href="#__codelineno-1-157"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLTRANID</span><span class="w">                      </span><span class="kt">PIC X(4)                    </span>
<a id="__codelineno-1-158" name="__codelineno-1-158" href="#__codelineno-1-158"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCDL&#39;</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-159" name="__codelineno-1-159" href="#__codelineno-1-159"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLMAPSET</span><span class="w">                      </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-160" name="__codelineno-1-160" href="#__codelineno-1-160"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDSL&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-161" name="__codelineno-1-161" href="#__codelineno-1-161"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDDTLMAP</span><span class="w">                         </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-162" name="__codelineno-1-162" href="#__codelineno-1-162"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDSLA&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-163" name="__codelineno-1-163" href="#__codelineno-1-163"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDUPDPGM</span><span class="w">                         </span><span class="kt">PIC X(8)                    </span>
<a id="__codelineno-1-164" name="__codelineno-1-164" href="#__codelineno-1-164"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDUPC&#39;</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-165" name="__codelineno-1-165" href="#__codelineno-1-165"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDUPDTRANID</span><span class="w">                      </span><span class="kt">PIC X(4)                    </span>
<a id="__codelineno-1-166" name="__codelineno-1-166" href="#__codelineno-1-166"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCUP&#39;</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-167" name="__codelineno-1-167" href="#__codelineno-1-167"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDUPDMAPSET</span><span class="w">                      </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-168" name="__codelineno-1-168" href="#__codelineno-1-168"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COCRDUP&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-169" name="__codelineno-1-169" href="#__codelineno-1-169"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARDUPDMAP</span><span class="w">                         </span><span class="kt">PIC X(7)                    </span>
<a id="__codelineno-1-170" name="__codelineno-1-170" href="#__codelineno-1-170"></a><span class="kt">            </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCRDUPA&#39;</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-171" name="__codelineno-1-171" href="#__codelineno-1-171"></a>
<a id="__codelineno-1-172" name="__codelineno-1-172" href="#__codelineno-1-172"></a>
<a id="__codelineno-1-173" name="__codelineno-1-173" href="#__codelineno-1-173"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARD-FILE</span><span class="w">                          </span><span class="kt">PIC X(8)                    </span>
<a id="__codelineno-1-174" name="__codelineno-1-174" href="#__codelineno-1-174"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CARDDAT &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-175" name="__codelineno-1-175" href="#__codelineno-1-175"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LIT-CARD-FILE-ACCT-PATH</span><span class="w">                </span><span class="kt">PIC X(8)                    </span>
<a id="__codelineno-1-176" name="__codelineno-1-176" href="#__codelineno-1-176"></a>
<a id="__codelineno-1-177" name="__codelineno-1-177" href="#__codelineno-1-177"></a><span class="kt">                                                  </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CARDAIX &#39;</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-178" name="__codelineno-1-178" href="#__codelineno-1-178"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-179" name="__codelineno-1-179" href="#__codelineno-1-179"></a><span class="c">      *Other common working storage Variables                                   </span>
<a id="__codelineno-1-180" name="__codelineno-1-180" href="#__codelineno-1-180"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-181" name="__codelineno-1-181" href="#__codelineno-1-181"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVCRD01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-182" name="__codelineno-1-182" href="#__codelineno-1-182"></a>
<a id="__codelineno-1-183" name="__codelineno-1-183" href="#__codelineno-1-183"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-184" name="__codelineno-1-184" href="#__codelineno-1-184"></a><span class="c">      *  Commarea manipulations                                                 </span>
<a id="__codelineno-1-185" name="__codelineno-1-185" href="#__codelineno-1-185"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-186" name="__codelineno-1-186" href="#__codelineno-1-186"></a><span class="c">      *Application Commmarea Copybook                                           </span>
<a id="__codelineno-1-187" name="__codelineno-1-187" href="#__codelineno-1-187"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCOM01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-188" name="__codelineno-1-188" href="#__codelineno-1-188"></a>
<a id="__codelineno-1-189" name="__codelineno-1-189" href="#__codelineno-1-189"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="p">.</span><span class="w">                                                 </span>
<a id="__codelineno-1-190" name="__codelineno-1-190" href="#__codelineno-1-190"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-CA-LAST-CARDKEY</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-191" name="__codelineno-1-191" href="#__codelineno-1-191"></a><span class="c">      </span><span class="w">         </span><span class="mi">15  </span><span class="nv">WS-CA-LAST-CARD-NUM</span><span class="w">                </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-192" name="__codelineno-1-192" href="#__codelineno-1-192"></a><span class="c">      </span><span class="w">         </span><span class="mi">15  </span><span class="nv">WS-CA-LAST-CARD-ACCT-ID</span><span class="w">            </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-193" name="__codelineno-1-193" href="#__codelineno-1-193"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-CA-FIRST-CARDKEY</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-1-194" name="__codelineno-1-194" href="#__codelineno-1-194"></a><span class="c">      </span><span class="w">         </span><span class="mi">15  </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">               </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-195" name="__codelineno-1-195" href="#__codelineno-1-195"></a><span class="c">      </span><span class="w">         </span><span class="mi">15  </span><span class="nv">WS-CA-FIRST-CARD-ACCT-ID</span><span class="w">           </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-196" name="__codelineno-1-196" href="#__codelineno-1-196"></a>
<a id="__codelineno-1-197" name="__codelineno-1-197" href="#__codelineno-1-197"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w">                       </span><span class="kt">PIC 9(1)</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-198" name="__codelineno-1-198" href="#__codelineno-1-198"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">CA-FIRST-PAGE</span><span class="w">                          </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-199" name="__codelineno-1-199" href="#__codelineno-1-199"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-CA-LAST-PAGE-DISPLAYED</span><span class="w">              </span><span class="kt">PIC 9(1)</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-200" name="__codelineno-1-200" href="#__codelineno-1-200"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">CA-LAST-PAGE-SHOWN</span><span class="w">                     </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-201" name="__codelineno-1-201" href="#__codelineno-1-201"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">CA-LAST-PAGE-NOT-SHOWN</span><span class="w">                 </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">9</span><span class="p">.</span><span class="w">               </span>
<a id="__codelineno-1-202" name="__codelineno-1-202" href="#__codelineno-1-202"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-CA-NEXT-PAGE-IND</span><span class="w">                    </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-203" name="__codelineno-1-203" href="#__codelineno-1-203"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">CA-NEXT-PAGE-NOT-EXISTS</span><span class="w">             </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">         </span>
<a id="__codelineno-1-204" name="__codelineno-1-204" href="#__codelineno-1-204"></a><span class="c">      </span><span class="w">         </span><span class="mi">88 </span><span class="nv">CA-NEXT-PAGE-EXISTS</span><span class="w">                 </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span><span class="w">                </span>
<a id="__codelineno-1-205" name="__codelineno-1-205" href="#__codelineno-1-205"></a>
<a id="__codelineno-1-206" name="__codelineno-1-206" href="#__codelineno-1-206"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-RETURN-FLAG</span><span class="w">                        </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-207" name="__codelineno-1-207" href="#__codelineno-1-207"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-FLAG-OFF</span><span class="w">                  </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-208" name="__codelineno-1-208" href="#__codelineno-1-208"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">WS-RETURN-FLAG-ON</span><span class="w">                   </span><span class="kp">VALUE </span><span class="s1">&#39;1&#39;</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-209" name="__codelineno-1-209" href="#__codelineno-1-209"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-210" name="__codelineno-1-210" href="#__codelineno-1-210"></a><span class="c">      *  File Data Array         28 CHARS X 7 ROWS = 196                        </span>
<a id="__codelineno-1-211" name="__codelineno-1-211" href="#__codelineno-1-211"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-1-212" name="__codelineno-1-212" href="#__codelineno-1-212"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-SCREEN-DATA</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-213" name="__codelineno-1-213" href="#__codelineno-1-213"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-ALL-ROWS</span><span class="w">                         </span><span class="kt">PIC X(196)</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-1-214" name="__codelineno-1-214" href="#__codelineno-1-214"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">WS-ALL-ROWS</span><span class="p">.</span><span class="w">                                    </span>
<a id="__codelineno-1-215" name="__codelineno-1-215" href="#__codelineno-1-215"></a><span class="c">      </span><span class="w">         </span><span class="mi">15 </span><span class="nv">WS-SCREEN-ROWS</span><span class="w"> </span><span class="kp">OCCURS </span><span class="w"> </span><span class="mi">7 </span><span class="kp">TIMES</span><span class="p">.</span><span class="w">                               </span>
<a id="__codelineno-1-216" name="__codelineno-1-216" href="#__codelineno-1-216"></a><span class="c">      </span><span class="w">            </span><span class="mi">20 </span><span class="nv">WS-EACH-ROW</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-1-217" name="__codelineno-1-217" href="#__codelineno-1-217"></a><span class="c">      </span><span class="w">               </span><span class="mi">25 </span><span class="nv">WS-EACH-CARD</span><span class="p">.</span><span class="w">                                           </span>
<a id="__codelineno-1-218" name="__codelineno-1-218" href="#__codelineno-1-218"></a><span class="c">      </span><span class="w">                  </span><span class="mi">30 </span><span class="nv">WS-ROW-ACCTNO</span><span class="w">           </span><span class="kt">PIC X(11)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-219" name="__codelineno-1-219" href="#__codelineno-1-219"></a><span class="c">      </span><span class="w">                  </span><span class="mi">30 </span><span class="nv">WS-ROW-CARD-NUM</span><span class="w">         </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                   </span>
<a id="__codelineno-1-220" name="__codelineno-1-220" href="#__codelineno-1-220"></a><span class="c">      </span><span class="w">                  </span><span class="mi">30 </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="w">      </span><span class="kt">PIC X(1)</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-1-221" name="__codelineno-1-221" href="#__codelineno-1-221"></a>
<a id="__codelineno-1-222" name="__codelineno-1-222" href="#__codelineno-1-222"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">WS-COMMAREA</span><span class="w">                             </span><span class="kt">PIC X(2000)</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-1-223" name="__codelineno-1-223" href="#__codelineno-1-223"></a>
<a id="__codelineno-1-224" name="__codelineno-1-224" href="#__codelineno-1-224"></a>
<a id="__codelineno-1-225" name="__codelineno-1-225" href="#__codelineno-1-225"></a>
<a id="__codelineno-1-226" name="__codelineno-1-226" href="#__codelineno-1-226"></a><span class="c">      *IBM SUPPLIED COPYBOOKS                                                   </span>
<a id="__codelineno-1-227" name="__codelineno-1-227" href="#__codelineno-1-227"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHBMSCA</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-228" name="__codelineno-1-228" href="#__codelineno-1-228"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHAID</span><span class="p">.</span><span class="w">                                                             </span>
<a id="__codelineno-1-229" name="__codelineno-1-229" href="#__codelineno-1-229"></a>
<a id="__codelineno-1-230" name="__codelineno-1-230" href="#__codelineno-1-230"></a><span class="c">      *COMMON COPYBOOKS                                                         </span>
<a id="__codelineno-1-231" name="__codelineno-1-231" href="#__codelineno-1-231"></a><span class="c">      *Screen Titles                                                            </span>
<a id="__codelineno-1-232" name="__codelineno-1-232" href="#__codelineno-1-232"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COTTL01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-233" name="__codelineno-1-233" href="#__codelineno-1-233"></a><span class="c">      *Credit Card Search Screen Layout                                         </span>
<a id="__codelineno-1-234" name="__codelineno-1-234" href="#__codelineno-1-234"></a><span class="c">      *COPY COCRDSL.                                                            </span>
<a id="__codelineno-1-235" name="__codelineno-1-235" href="#__codelineno-1-235"></a><span class="c">      *Credit Card List Screen Layout                                           </span>
<a id="__codelineno-1-236" name="__codelineno-1-236" href="#__codelineno-1-236"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCRDLI</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-1-237" name="__codelineno-1-237" href="#__codelineno-1-237"></a>
<a id="__codelineno-1-238" name="__codelineno-1-238" href="#__codelineno-1-238"></a><span class="c">      *Current Date                                                             </span>
<a id="__codelineno-1-239" name="__codelineno-1-239" href="#__codelineno-1-239"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSDAT01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-240" name="__codelineno-1-240" href="#__codelineno-1-240"></a><span class="c">      *Common Messages                                                          </span>
<a id="__codelineno-1-241" name="__codelineno-1-241" href="#__codelineno-1-241"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-242" name="__codelineno-1-242" href="#__codelineno-1-242"></a><span class="c">      *Abend Variables                                                          </span>
<a id="__codelineno-1-243" name="__codelineno-1-243" href="#__codelineno-1-243"></a><span class="c">      *COPY CSMSG02Y.                                                           </span>
<a id="__codelineno-1-244" name="__codelineno-1-244" href="#__codelineno-1-244"></a><span class="c">      *Signed on user data                                                      </span>
<a id="__codelineno-1-245" name="__codelineno-1-245" href="#__codelineno-1-245"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSUSR01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-246" name="__codelineno-1-246" href="#__codelineno-1-246"></a>
<a id="__codelineno-1-247" name="__codelineno-1-247" href="#__codelineno-1-247"></a><span class="c">      *Dataset layouts                                                          </span>
<a id="__codelineno-1-248" name="__codelineno-1-248" href="#__codelineno-1-248"></a>
<a id="__codelineno-1-249" name="__codelineno-1-249" href="#__codelineno-1-249"></a><span class="c">      *CARD RECORD LAYOUT                                                       </span>
<a id="__codelineno-1-250" name="__codelineno-1-250" href="#__codelineno-1-250"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT02Y</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="linkage-section">LINKAGE SECTION</h3>
<p>This section defines the DFHCOMMAREA structure in the Linkage Section, which serves as the communication area for passing data between CICS programs. It contains a single field defined as a variable-length array of 1-byte elements (PIC X(1)) that can occur from 1 to 32,767 times, with the actual length determined by the EIBCALEN special register. This flexible structure allows the program to receive and process communication data of varying lengths from calling programs within the CardDemo application.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">01  DF</span><span class="nv">HCOMMAREA</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="kp">FILLER                               </span><span class="w"> </span><span class="kt">PIC X(1)                     </span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kt">            </span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="mi">32767 </span><span class="kp">TIMES</span><span class="w"> </span><span class="kp">DEPENDING</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="p">.</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="0000-main">0000-MAIN</h3>
<p>This paragraph serves as the main control flow for the COCRDLIC program, handling initialization, user input processing, and navigation between screens. It begins by initializing work areas and setting up the program context, then processes the communication area to determine if this is the first execution or a subsequent call.</p>
<p>The paragraph implements key navigation logic, handling various function keys (PF3 for exit, PF7 for page up, PF8 for page down) and the ENTER key. It contains extensive conditional logic to evaluate user actions and determine the appropriate response, including:</p>
<ol>
<li>Validating user input and displaying error messages when needed</li>
<li>Implementing pagination through card records with first/last page boundary checks</li>
<li>Processing user selections for viewing or updating specific card details</li>
<li>Transferring control to other programs when a card is selected for detailed view or update</li>
</ol>
<p>The code uses an EVALUATE statement to handle different scenarios based on user actions and program state, directing the flow to appropriate sections for reading records forward or backward, sending maps to display, or transferring to other programs in the application workflow. Throughout the paragraph, the program maintains context information in the communication area to support navigation between related screens.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">INITIA</span><span class="nv">LIZE</span><span class="w"> </span><span class="nv">CC-WORK-AREA</span><span class="w">                                              </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-MISC-STORAGE</span><span class="w">                                           </span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-COMMAREA</span><span class="w">                                               </span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c">      * Store our context                                                       </span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">                               </span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c">      * Ensure error message is cleared                               *         </span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-ERROR-MSG-OFF</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                        </span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="nb">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c">      * Retrived passed data if  any. Initialize them if first run.             </span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="mi">              </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="c">      </span><span class="w">                   </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                   </span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                  </span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="nb">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                      </span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                   </span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-LAST-PAGE-NOT-SHOWN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="nb">          </span><span class="w"> </span><span class="kr">ELSE</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w"> </span><span class="kp">TO               </span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="kp">                               </span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">                               </span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">                 </span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="c">      </span><span class="w">                         </span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="p">)</span><span class="kp">TO               </span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="kp">                               </span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                            </span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="c">      * If coming in from menu. Lets forget the past and start afresh *         </span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="p">(</span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                                  </span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="c">      </span><span class="w">         </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="c">      </span><span class="w">         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="nb">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                       </span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="c">      </span><span class="w">         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="nb">              </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-LAST-PAGE-NOT-SHOWN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF </span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="c">      * Remap PFkeys as needed.                                                 </span>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="c">      * Store the Mapped PF Key                                                 </span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">YYYY-STORE-PFKEY</span><span class="w">                                             </span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="nv">YYYY-STORE-PFKEY-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="c">      * If something is present in commarea                                     </span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="c">      * and the from program is this program itself,                            </span>
<a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a><span class="c">      * read and edit the inputs given                                          </span>
<a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0                                                     </span>
<a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a><span class="mi">           </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">                            </span>
<a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2000</span><span class="o">-</span><span class="nv">RECEIVE-MAP</span><span class="w">                                         </span>
<a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a><span class="c">      </span><span class="w">         </span><span class="kp">THRU   </span><span class="w"> </span><span class="mi">2000</span><span class="o">-</span><span class="nv">RECEIVE-MAP-EXIT</span><span class="w">                                    </span>
<a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>
<a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="c">      * Check the mapped key  to see if its valid at this point       *         </span>
<a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a><span class="c">      * F3    - Exit                                                            </span>
<a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a><span class="c">      * Enter - List of cards for current start key                             </span>
<a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a><span class="c">      * F8    - Page down                                                       </span>
<a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a><span class="c">      * F7    - Page up                                                         </span>
<a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PFK-INVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                              </span>
<a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a><span class="nb">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w"> </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a><span class="ow">             </span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w"> </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="ow">             </span><span class="w"> </span><span class="nv">CCARD-AID-PFK07</span><span class="w"> </span><span class="ow">OR                                                </span>
<a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="ow">             </span><span class="w"> </span><span class="nv">CCARD-AID-PFK08</span><span class="w">                                                   </span>
<a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a><span class="c">      </span><span class="w">         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">PFK-VALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                            </span>
<a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a>
<a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">PFK-INVALID</span><span class="w">                                                       </span>
<a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                       </span>
<a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a><span class="c">      * If the user pressed PF3 go back to main menu                            </span>
<a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF  </span><span class="p">(</span><span class="nv">CCARD-AID-PFK03</span><span class="w">                                                 </span>
<a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="p">)</span><span class="w">                           </span>
<a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                        </span>
<a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                       </span>
<a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                    </span>
<a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                     </span>
<a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a><span class="nb">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                        </span>
<a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                           </span>
<a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span><span class="w">                         </span>
<a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a>
<a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-MENUMAPSET</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                        </span>
<a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                           </span>
<a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-EXIT-MESSAGE</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a>
<a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a><span class="nb">      </span><span class="o">*</span><span class="w">       </span><span class="kr">CALL</span><span class="w"> </span><span class="nv">MENU</span><span class="w"> </span><span class="kp">PROGRAM                                                 </span>
<a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a><span class="kp">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                     </span>
<a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a><span class="nb">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a><span class="c">      </span><span class="w">        </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">XCTL</span><span class="w">                                                    </span>
<a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a><span class="c">      </span><span class="w">                  </span><span class="kp">PROGRAM </span><span class="p">(</span><span class="nv">LIT-MENUPGM</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a><span class="c">      </span><span class="w">                  </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a><span class="c">      </span><span class="w">        </span><span class="nv">END-EXEC</span><span class="w">                                                          </span>
<a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a><span class="c">      * If the user did not press PF8, lets reset the last page flag            </span>
<a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CCARD-AID-PFK08</span><span class="w">                                                   </span>
<a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a><span class="kr">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-LAST-PAGE-NOT-SHOWN</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                              </span>
<a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a><span class="kr">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a><span class="c">      * Now we decide what to do                                                </span>
<a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                                                 </span>
<a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a><span class="c">      *        ASK FOR CORRECTIONS TO INPUTS                                    </span>
<a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                     </span>
<a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                  </span>
<a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                   </span>
<a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                      </span>
<a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a>
<a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                     </span>
<a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                   </span>
<a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                      </span>
<a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a><span class="c">      </span><span class="w">              </span><span class="kr">IF </span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                               </span>
<a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a><span class="c">      </span><span class="w">              </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                               </span>
<a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD</span><span class="w">                                </span>
<a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a><span class="c">      </span><span class="w">                    </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD-EXIT</span><span class="w">                           </span>
<a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a><span class="c">      </span><span class="w">              </span><span class="kr">END-IF                                                      </span>
<a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a><span class="kr">                   </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a><span class="c">      </span><span class="w">              </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                         </span>
<a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK07</span><span class="w">                                             </span>
<a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a><span class="c">      </span><span class="w">              </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">                                           </span>
<a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="c">      *        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE                        </span>
<a id="__codelineno-3-144" name="__codelineno-3-144" href="#__codelineno-3-144"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-145" name="__codelineno-3-145" href="#__codelineno-3-145"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK07</span><span class="w">                                             </span>
<a id="__codelineno-3-146" name="__codelineno-3-146" href="#__codelineno-3-146"></a><span class="c">      </span><span class="w">              </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">                                           </span>
<a id="__codelineno-3-147" name="__codelineno-3-147" href="#__codelineno-3-147"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">                                   </span>
<a id="__codelineno-3-148" name="__codelineno-3-148" href="#__codelineno-3-148"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                        </span>
<a id="__codelineno-3-149" name="__codelineno-3-149" href="#__codelineno-3-149"></a><span class="c">      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               </span>
<a id="__codelineno-3-150" name="__codelineno-3-150" href="#__codelineno-3-150"></a><span class="c">      *                           TO WS-CARD-RID-ACCT-ID                        </span>
<a id="__codelineno-3-151" name="__codelineno-3-151" href="#__codelineno-3-151"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD</span><span class="w">                                   </span>
<a id="__codelineno-3-152" name="__codelineno-3-152" href="#__codelineno-3-152"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD-EXIT</span><span class="w">                              </span>
<a id="__codelineno-3-153" name="__codelineno-3-153" href="#__codelineno-3-153"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-154" name="__codelineno-3-154" href="#__codelineno-3-154"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-155" name="__codelineno-3-155" href="#__codelineno-3-155"></a><span class="c">      </span><span class="w">              </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                         </span>
<a id="__codelineno-3-156" name="__codelineno-3-156" href="#__codelineno-3-156"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-157" name="__codelineno-3-157" href="#__codelineno-3-157"></a><span class="c">      *        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM                    </span>
<a id="__codelineno-3-158" name="__codelineno-3-158" href="#__codelineno-3-158"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-159" name="__codelineno-3-159" href="#__codelineno-3-159"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK03</span><span class="w">                                             </span>
<a id="__codelineno-3-160" name="__codelineno-3-160" href="#__codelineno-3-160"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w"> </span><span class="ow">AND                                       </span>
<a id="__codelineno-3-161" name="__codelineno-3-161" href="#__codelineno-3-161"></a><span class="ow">                   </span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">                    </span>
<a id="__codelineno-3-162" name="__codelineno-3-162" href="#__codelineno-3-162"></a>
<a id="__codelineno-3-163" name="__codelineno-3-163" href="#__codelineno-3-163"></a><span class="c">      </span><span class="w">              </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">                                </span>
<a id="__codelineno-3-164" name="__codelineno-3-164" href="#__codelineno-3-164"></a><span class="c">      </span><span class="w">                         </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w">                             </span>
<a id="__codelineno-3-165" name="__codelineno-3-165" href="#__codelineno-3-165"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">               </span>
<a id="__codelineno-3-166" name="__codelineno-3-166" href="#__codelineno-3-166"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">              </span>
<a id="__codelineno-3-167" name="__codelineno-3-167" href="#__codelineno-3-167"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-3-168" name="__codelineno-3-168" href="#__codelineno-3-168"></a><span class="nb">                   </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-3-169" name="__codelineno-3-169" href="#__codelineno-3-169"></a><span class="nb">                   </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                  </span>
<a id="__codelineno-3-170" name="__codelineno-3-170" href="#__codelineno-3-170"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">               </span>
<a id="__codelineno-3-171" name="__codelineno-3-171" href="#__codelineno-3-171"></a><span class="c">      </span><span class="w">              </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-3-172" name="__codelineno-3-172" href="#__codelineno-3-172"></a><span class="nb">                   </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-LAST-PAGE-NOT-SHOWN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                          </span>
<a id="__codelineno-3-173" name="__codelineno-3-173" href="#__codelineno-3-173"></a>
<a id="__codelineno-3-174" name="__codelineno-3-174" href="#__codelineno-3-174"></a><span class="nb">                   </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">                                   </span>
<a id="__codelineno-3-175" name="__codelineno-3-175" href="#__codelineno-3-175"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                        </span>
<a id="__codelineno-3-176" name="__codelineno-3-176" href="#__codelineno-3-176"></a><span class="c">      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               </span>
<a id="__codelineno-3-177" name="__codelineno-3-177" href="#__codelineno-3-177"></a><span class="c">      *                           TO WS-CARD-RID-ACCT-ID                        </span>
<a id="__codelineno-3-178" name="__codelineno-3-178" href="#__codelineno-3-178"></a>
<a id="__codelineno-3-179" name="__codelineno-3-179" href="#__codelineno-3-179"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD</span><span class="w">                                   </span>
<a id="__codelineno-3-180" name="__codelineno-3-180" href="#__codelineno-3-180"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD-EXIT</span><span class="w">                              </span>
<a id="__codelineno-3-181" name="__codelineno-3-181" href="#__codelineno-3-181"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-182" name="__codelineno-3-182" href="#__codelineno-3-182"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-183" name="__codelineno-3-183" href="#__codelineno-3-183"></a><span class="c">      </span><span class="w">              </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                         </span>
<a id="__codelineno-3-184" name="__codelineno-3-184" href="#__codelineno-3-184"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-185" name="__codelineno-3-185" href="#__codelineno-3-185"></a><span class="c">      *        PAGE DOWN                                                        </span>
<a id="__codelineno-3-186" name="__codelineno-3-186" href="#__codelineno-3-186"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-187" name="__codelineno-3-187" href="#__codelineno-3-187"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK08</span><span class="w">                                             </span>
<a id="__codelineno-3-188" name="__codelineno-3-188" href="#__codelineno-3-188"></a><span class="c">      </span><span class="w">              </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-EXISTS</span><span class="w">                                     </span>
<a id="__codelineno-3-189" name="__codelineno-3-189" href="#__codelineno-3-189"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-NUM</span><span class="w">                                    </span>
<a id="__codelineno-3-190" name="__codelineno-3-190" href="#__codelineno-3-190"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                        </span>
<a id="__codelineno-3-191" name="__codelineno-3-191" href="#__codelineno-3-191"></a><span class="c">      *             MOVE WS-CA-LAST-CARD-ACCT-ID                                </span>
<a id="__codelineno-3-192" name="__codelineno-3-192" href="#__codelineno-3-192"></a><span class="c">      *                           TO WS-CARD-RID-ACCT-ID                        </span>
<a id="__codelineno-3-193" name="__codelineno-3-193" href="#__codelineno-3-193"></a><span class="c">      </span><span class="w">              </span><span class="kr">ADD   </span><span class="o">+</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w">                          </span>
<a id="__codelineno-3-194" name="__codelineno-3-194" href="#__codelineno-3-194"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD</span><span class="w">                                   </span>
<a id="__codelineno-3-195" name="__codelineno-3-195" href="#__codelineno-3-195"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD-EXIT</span><span class="w">                              </span>
<a id="__codelineno-3-196" name="__codelineno-3-196" href="#__codelineno-3-196"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-197" name="__codelineno-3-197" href="#__codelineno-3-197"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-3-198" name="__codelineno-3-198" href="#__codelineno-3-198"></a><span class="c">      </span><span class="w">              </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                         </span>
<a id="__codelineno-3-199" name="__codelineno-3-199" href="#__codelineno-3-199"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-200" name="__codelineno-3-200" href="#__codelineno-3-200"></a><span class="c">      *        PAGE UP                                                          </span>
<a id="__codelineno-3-201" name="__codelineno-3-201" href="#__codelineno-3-201"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-202" name="__codelineno-3-202" href="#__codelineno-3-202"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK07</span><span class="w">                                             </span>
<a id="__codelineno-3-203" name="__codelineno-3-203" href="#__codelineno-3-203"></a><span class="c">      </span><span class="w">              </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">                                       </span>
<a id="__codelineno-3-204" name="__codelineno-3-204" href="#__codelineno-3-204"></a>
<a id="__codelineno-3-205" name="__codelineno-3-205" href="#__codelineno-3-205"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">                                   </span>
<a id="__codelineno-3-206" name="__codelineno-3-206" href="#__codelineno-3-206"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                        </span>
<a id="__codelineno-3-207" name="__codelineno-3-207" href="#__codelineno-3-207"></a><span class="c">      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               </span>
<a id="__codelineno-3-208" name="__codelineno-3-208" href="#__codelineno-3-208"></a><span class="c">      *                           TO WS-CARD-RID-ACCT-ID                        </span>
<a id="__codelineno-3-209" name="__codelineno-3-209" href="#__codelineno-3-209"></a><span class="c">      </span><span class="w">              </span><span class="kr">SUBTRACT</span><span class="w"> </span><span class="mi">1    </span><span class="kp">FROM</span><span class="w"> </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w">                         </span>
<a id="__codelineno-3-210" name="__codelineno-3-210" href="#__codelineno-3-210"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">READ-BACKWARDS</span><span class="w">                                 </span>
<a id="__codelineno-3-211" name="__codelineno-3-211" href="#__codelineno-3-211"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">READ-BACKWARDS-EXIT</span><span class="w">                            </span>
<a id="__codelineno-3-212" name="__codelineno-3-212" href="#__codelineno-3-212"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-213" name="__codelineno-3-213" href="#__codelineno-3-213"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-3-214" name="__codelineno-3-214" href="#__codelineno-3-214"></a><span class="c">      </span><span class="w">              </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                         </span>
<a id="__codelineno-3-215" name="__codelineno-3-215" href="#__codelineno-3-215"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-216" name="__codelineno-3-216" href="#__codelineno-3-216"></a><span class="c">      *        TRANSFER TO CARD DETAIL VIEW                                     </span>
<a id="__codelineno-3-217" name="__codelineno-3-217" href="#__codelineno-3-217"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-218" name="__codelineno-3-218" href="#__codelineno-3-218"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w">                                             </span>
<a id="__codelineno-3-219" name="__codelineno-3-219" href="#__codelineno-3-219"></a><span class="c">      </span><span class="w">          </span><span class="ow">AND</span><span class="w"> </span><span class="nv">VIEW-REQUESTED-ON</span><span class="p">(</span><span class="nv">I-SELECTED</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-3-220" name="__codelineno-3-220" href="#__codelineno-3-220"></a><span class="c">      </span><span class="w">          </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">                       </span>
<a id="__codelineno-3-221" name="__codelineno-3-221" href="#__codelineno-3-221"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                  </span>
<a id="__codelineno-3-222" name="__codelineno-3-222" href="#__codelineno-3-222"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                 </span>
<a id="__codelineno-3-223" name="__codelineno-3-223" href="#__codelineno-3-223"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-3-224" name="__codelineno-3-224" href="#__codelineno-3-224"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-3-225" name="__codelineno-3-225" href="#__codelineno-3-225"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                  </span>
<a id="__codelineno-3-226" name="__codelineno-3-226" href="#__codelineno-3-226"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                     </span>
<a id="__codelineno-3-227" name="__codelineno-3-227" href="#__codelineno-3-227"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDDTLPGM</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                    </span>
<a id="__codelineno-3-228" name="__codelineno-3-228" href="#__codelineno-3-228"></a>
<a id="__codelineno-3-229" name="__codelineno-3-229" href="#__codelineno-3-229"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDDTLMAPSET</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                  </span>
<a id="__codelineno-3-230" name="__codelineno-3-230" href="#__codelineno-3-230"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDDTLMAP</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                     </span>
<a id="__codelineno-3-231" name="__codelineno-3-231" href="#__codelineno-3-231"></a>
<a id="__codelineno-3-232" name="__codelineno-3-232" href="#__codelineno-3-232"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="w"> </span><span class="p">(</span><span class="nv">I-SELECTED</span><span class="p">)</span><span class="w">                              </span>
<a id="__codelineno-3-233" name="__codelineno-3-233" href="#__codelineno-3-233"></a><span class="c">      </span><span class="w">                                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                      </span>
<a id="__codelineno-3-234" name="__codelineno-3-234" href="#__codelineno-3-234"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="w"> </span><span class="p">(</span><span class="nv">I-SELECTED</span><span class="p">)</span><span class="w">                            </span>
<a id="__codelineno-3-235" name="__codelineno-3-235" href="#__codelineno-3-235"></a><span class="c">      </span><span class="w">                                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                     </span>
<a id="__codelineno-3-236" name="__codelineno-3-236" href="#__codelineno-3-236"></a>
<a id="__codelineno-3-237" name="__codelineno-3-237" href="#__codelineno-3-237"></a><span class="c">      *            CALL CARD DETAIL PROGRAM                                     </span>
<a id="__codelineno-3-238" name="__codelineno-3-238" href="#__codelineno-3-238"></a><span class="c">      *                                                                         </span>
<a id="__codelineno-3-239" name="__codelineno-3-239" href="#__codelineno-3-239"></a><span class="c">      </span><span class="w">             </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">XCTL</span><span class="w">                                               </span>
<a id="__codelineno-3-240" name="__codelineno-3-240" href="#__codelineno-3-240"></a><span class="c">      </span><span class="w">                  </span><span class="kp">PROGRAM </span><span class="p">(</span><span class="nv">CCARD-NEXT-PROG</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-3-241" name="__codelineno-3-241" href="#__codelineno-3-241"></a><span class="c">      </span><span class="w">                  </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-3-242" name="__codelineno-3-242" href="#__codelineno-3-242"></a><span class="c">      </span><span class="w">             </span><span class="nv">END-EXEC</span><span class="w">                                                     </span>
<a id="__codelineno-3-243" name="__codelineno-3-243" href="#__codelineno-3-243"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-244" name="__codelineno-3-244" href="#__codelineno-3-244"></a><span class="c">      *        TRANSFER TO CARD UPDATED PROGRAM                                 </span>
<a id="__codelineno-3-245" name="__codelineno-3-245" href="#__codelineno-3-245"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-246" name="__codelineno-3-246" href="#__codelineno-3-246"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-ENTER</span><span class="w">                                             </span>
<a id="__codelineno-3-247" name="__codelineno-3-247" href="#__codelineno-3-247"></a><span class="c">      </span><span class="w">          </span><span class="ow">AND</span><span class="w"> </span><span class="nv">UPDATE-REQUESTED-ON</span><span class="p">(</span><span class="nv">I-SELECTED</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-3-248" name="__codelineno-3-248" href="#__codelineno-3-248"></a><span class="c">      </span><span class="w">          </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">  </span><span class="ow">EQUAL</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">                       </span>
<a id="__codelineno-3-249" name="__codelineno-3-249" href="#__codelineno-3-249"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                  </span>
<a id="__codelineno-3-250" name="__codelineno-3-250" href="#__codelineno-3-250"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                 </span>
<a id="__codelineno-3-251" name="__codelineno-3-251" href="#__codelineno-3-251"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-USRTYP-USER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-3-252" name="__codelineno-3-252" href="#__codelineno-3-252"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">SET </span><span class="w"> </span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-3-253" name="__codelineno-3-253" href="#__codelineno-3-253"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                  </span>
<a id="__codelineno-3-254" name="__codelineno-3-254" href="#__codelineno-3-254"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                     </span>
<a id="__codelineno-3-255" name="__codelineno-3-255" href="#__codelineno-3-255"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDUPDPGM</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                    </span>
<a id="__codelineno-3-256" name="__codelineno-3-256" href="#__codelineno-3-256"></a>
<a id="__codelineno-3-257" name="__codelineno-3-257" href="#__codelineno-3-257"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDUPDMAPSET</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                  </span>
<a id="__codelineno-3-258" name="__codelineno-3-258" href="#__codelineno-3-258"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARDUPDMAP</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                     </span>
<a id="__codelineno-3-259" name="__codelineno-3-259" href="#__codelineno-3-259"></a>
<a id="__codelineno-3-260" name="__codelineno-3-260" href="#__codelineno-3-260"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="w"> </span><span class="p">(</span><span class="nv">I-SELECTED</span><span class="p">)</span><span class="w">                              </span>
<a id="__codelineno-3-261" name="__codelineno-3-261" href="#__codelineno-3-261"></a><span class="c">      </span><span class="w">                                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                      </span>
<a id="__codelineno-3-262" name="__codelineno-3-262" href="#__codelineno-3-262"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="w"> </span><span class="p">(</span><span class="nv">I-SELECTED</span><span class="p">)</span><span class="w">                            </span>
<a id="__codelineno-3-263" name="__codelineno-3-263" href="#__codelineno-3-263"></a><span class="c">      </span><span class="w">                                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                     </span>
<a id="__codelineno-3-264" name="__codelineno-3-264" href="#__codelineno-3-264"></a>
<a id="__codelineno-3-265" name="__codelineno-3-265" href="#__codelineno-3-265"></a><span class="c">      *            CALL CARD UPDATE PROGRAM                                     </span>
<a id="__codelineno-3-266" name="__codelineno-3-266" href="#__codelineno-3-266"></a><span class="c">      *                                                                         </span>
<a id="__codelineno-3-267" name="__codelineno-3-267" href="#__codelineno-3-267"></a><span class="c">      </span><span class="w">             </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">XCTL</span><span class="w">                                               </span>
<a id="__codelineno-3-268" name="__codelineno-3-268" href="#__codelineno-3-268"></a><span class="c">      </span><span class="w">                  </span><span class="kp">PROGRAM </span><span class="p">(</span><span class="nv">CCARD-NEXT-PROG</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-3-269" name="__codelineno-3-269" href="#__codelineno-3-269"></a><span class="c">      </span><span class="w">                  </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-3-270" name="__codelineno-3-270" href="#__codelineno-3-270"></a><span class="c">      </span><span class="w">             </span><span class="nv">END-EXEC</span><span class="w">                                                     </span>
<a id="__codelineno-3-271" name="__codelineno-3-271" href="#__codelineno-3-271"></a>
<a id="__codelineno-3-272" name="__codelineno-3-272" href="#__codelineno-3-272"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-273" name="__codelineno-3-273" href="#__codelineno-3-273"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-3-274" name="__codelineno-3-274" href="#__codelineno-3-274"></a><span class="kp">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-3-275" name="__codelineno-3-275" href="#__codelineno-3-275"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">                                   </span>
<a id="__codelineno-3-276" name="__codelineno-3-276" href="#__codelineno-3-276"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="w">                        </span>
<a id="__codelineno-3-277" name="__codelineno-3-277" href="#__codelineno-3-277"></a><span class="c">      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               </span>
<a id="__codelineno-3-278" name="__codelineno-3-278" href="#__codelineno-3-278"></a><span class="c">      *                           TO WS-CARD-RID-ACCT-ID                        </span>
<a id="__codelineno-3-279" name="__codelineno-3-279" href="#__codelineno-3-279"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD</span><span class="w">                                   </span>
<a id="__codelineno-3-280" name="__codelineno-3-280" href="#__codelineno-3-280"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9000</span><span class="o">-</span><span class="nv">READ-FORWARD-EXIT</span><span class="w">                              </span>
<a id="__codelineno-3-281" name="__codelineno-3-281" href="#__codelineno-3-281"></a><span class="c">      </span><span class="w">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-282" name="__codelineno-3-282" href="#__codelineno-3-282"></a><span class="c">      </span><span class="w">                 </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1000</span><span class="o">-</span><span class="nv">SEND-MAP</span><span class="w">                                       </span>
<a id="__codelineno-3-283" name="__codelineno-3-283" href="#__codelineno-3-283"></a><span class="c">      </span><span class="w">              </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                         </span>
<a id="__codelineno-3-284" name="__codelineno-3-284" href="#__codelineno-3-284"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-3-285" name="__codelineno-3-285" href="#__codelineno-3-285"></a>
<a id="__codelineno-3-286" name="__codelineno-3-286" href="#__codelineno-3-286"></a><span class="kr">      </span><span class="o">*</span><span class="w"> </span><span class="kr">If</span><span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">had</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="kp">error</span><span class="w"> </span><span class="nv">setup</span><span class="w"> </span><span class="kp">error</span><span class="w"> </span><span class="err">message</span><span class="w"> </span><span class="kp">to</span><span class="w"> </span><span class="kr">display</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="kr">return            </span>
<a id="__codelineno-3-287" name="__codelineno-3-287" href="#__codelineno-3-287"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">                                                       </span>
<a id="__codelineno-3-288" name="__codelineno-3-288" href="#__codelineno-3-288"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-ERROR-MSG</span><span class="w">                            </span>
<a id="__codelineno-3-289" name="__codelineno-3-289" href="#__codelineno-3-289"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                        </span>
<a id="__codelineno-3-290" name="__codelineno-3-290" href="#__codelineno-3-290"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                         </span>
<a id="__codelineno-3-291" name="__codelineno-3-291" href="#__codelineno-3-291"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                            </span>
<a id="__codelineno-3-292" name="__codelineno-3-292" href="#__codelineno-3-292"></a>
<a id="__codelineno-3-293" name="__codelineno-3-293" href="#__codelineno-3-293"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                           </span>
<a id="__codelineno-3-294" name="__codelineno-3-294" href="#__codelineno-3-294"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAPSET</span><span class="w">                         </span>
<a id="__codelineno-3-295" name="__codelineno-3-295" href="#__codelineno-3-295"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-MAP</span><span class="w">                            </span>
<a id="__codelineno-3-296" name="__codelineno-3-296" href="#__codelineno-3-296"></a><span class="c">      *       PERFORM 1000-SEND-MAP                                             </span>
<a id="__codelineno-3-297" name="__codelineno-3-297" href="#__codelineno-3-297"></a><span class="c">      *          THRU 1000-SEND-MAP                                             </span>
<a id="__codelineno-3-298" name="__codelineno-3-298" href="#__codelineno-3-298"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                               </span>
<a id="__codelineno-3-299" name="__codelineno-3-299" href="#__codelineno-3-299"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-3-300" name="__codelineno-3-300" href="#__codelineno-3-300"></a>
<a id="__codelineno-3-301" name="__codelineno-3-301" href="#__codelineno-3-301"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCARD-NEXT-PROG</span><span class="w">                           </span>
<a id="__codelineno-3-302" name="__codelineno-3-302" href="#__codelineno-3-302"></a><span class="c">      </span><span class="w">     </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COMMON-RETURN</span><span class="w">                                                  </span>
<a id="__codelineno-3-303" name="__codelineno-3-303" href="#__codelineno-3-303"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="common-return">COMMON-RETURN</h3>
<p>This paragraph handles the program's return logic, preparing the communication area (COMMAREA) before returning control to CICS. It stores transaction context information including the current transaction ID, program name, mapset, and map in the common communication area. The paragraph then combines the standard CardDemo communication area with this program's specific communication area into a single working storage area (WS-COMMAREA). Finally, it executes a CICS RETURN command that specifies the transaction ID to maintain program control and passes the prepared communication area to preserve state information between transactions.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">MOVE  </span><span class="nv">LIT-THISTRANID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span><span class="w">                            </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w">                          </span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">LIT-THISMAPSET</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAPSET</span><span class="w">                           </span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">LIT-THISMAP</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-LAST-MAP</span><span class="w">                              </span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="w">                            </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="kp">TO                                        </span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="kp">                 </span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w">                  </span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c">      </span><span class="w">                         </span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-THIS-PROGCOMMAREA</span><span class="w"> </span><span class="p">)</span><span class="w">                 </span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="kr">               </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">LIT-THISTRANID</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c">      </span><span class="w">          </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-COMMAREA</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-COMMAREA</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="0000-main-exit">0000-MAIN-EXIT</h3>
<p>This paragraph serves as a standard exit point for the program, providing a clean termination point that can be called from various parts of the program when processing needs to end. It contains only the EXIT statement followed by a period, which marks the end of the paragraph. This is a common COBOL programming pattern used to centralize program termination logic.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1000-send-map">1000-SEND-MAP</h3>
<p>This paragraph orchestrates the initialization and display of the card listing screen. It follows a sequential process by first initializing the screen, setting up the array elements for displaying multiple card records, configuring the visual attributes for the array elements, establishing screen-level attributes, preparing any user messages, and finally sending the completed screen to the terminal. This structured approach ensures the screen is properly formatted with appropriate visual cues and populated with the correct data before being presented to the user.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">1100</span><span class="o">-</span><span class="nv">SCREEN-INIT</span><span class="w">                                             </span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1100</span><span class="o">-</span><span class="nv">SCREEN-INIT-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">SCREEN-ARRAY-INIT</span><span class="w">                                       </span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">SCREEN-ARRAY-INIT-EXIT</span><span class="w">                                  </span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1250</span><span class="o">-</span><span class="nv">SETUP-ARRAY-ATTRIBS</span><span class="w">                                     </span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1250</span><span class="o">-</span><span class="nv">SETUP-ARRAY-ATTRIBS-EXIT</span><span class="w">                                </span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1300</span><span class="o">-</span><span class="nv">SETUP-SCREEN-ATTRS</span><span class="w">                                      </span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1300</span><span class="o">-</span><span class="nv">SETUP-SCREEN-ATTRS-EXIT</span><span class="w">                                 </span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1400</span><span class="o">-</span><span class="nv">SETUP-MESSAGE</span><span class="w">                                           </span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1400</span><span class="o">-</span><span class="nv">SETUP-MESSAGE-EXIT</span><span class="w">                                      </span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1500</span><span class="o">-</span><span class="nv">SEND-SCREEN</span><span class="w">                                             </span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">1500</span><span class="o">-</span><span class="nv">SEND-SCREEN-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1000-send-map-exit">1000-SEND-MAP-EXIT</h3>
<p>This paragraph serves as an exit point for the 1000-SEND-MAP routine in the COCRDLIC program. It provides a clean termination point for the routine that handles displaying the credit card listing interface to users.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1100-screen-init">1100-SCREEN-INIT</h3>
<p>This paragraph initializes the screen display for the credit card listing interface. It clears the output area, retrieves the current date and time, and populates standard header information including titles, transaction ID, program name, current date (in MM/DD/YY format), and current time (in HH:MM:SS format). It also sets the page number from a working storage variable and initializes the information message area with no message and highlighted display attributes. This setup creates a consistent user interface header before specific card listing data is displayed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">MOVE L</span><span class="nv">OW-VALUES</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                              </span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span><span class="w">                       </span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE01</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE01O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE02</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE02O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISTRANID</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-THISPGM</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PGMNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span><span class="w">                       </span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MM</span><span class="w">                         </span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DD</span><span class="w">                         </span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-YY</span><span class="w">                         </span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MM-DD-YY</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURDATEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HOURS</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-HH</span><span class="w">                         </span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-MINUTE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-MM</span><span class="w">                         </span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-SECOND</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-SS</span><span class="w">                         </span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HH-MM-SS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURTIMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="c">      *    PAGE NUMBER                                                          </span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="c">      *                                                                         </span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PAGENOO</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                  </span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="nb">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-INFO-MSG</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMDAR</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1100-screen-init-exit">1100-SCREEN-INIT-EXIT</h3>
<p>This paragraph serves as an exit point for the screen initialization routine in the COCRDLIC program. It provides a clean termination point for the 1100-SCREEN-INIT section, allowing the program to return control to the calling routine after completing the screen initialization process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1200-screen-array-init">1200-SCREEN-ARRAY-INIT</h3>
<p>This paragraph populates the credit card listing display screen with data from working storage arrays. For each of the seven possible card entries on the screen, it checks if the corresponding array element contains data (not LOW-VALUES). When data exists, it transfers the selection field, account number, card number, and card status from working storage arrays to their corresponding screen output fields. The code follows a repetitive pattern for each of the seven possible display rows, with a comment at the top suggesting that this repetitive structure could be improved through the use of REDEFINES. This paragraph is responsible for formatting the paginated display of credit card information that users see when browsing cards in the system.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">*    U</span><span class="nv">SE</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CLEAN</span><span class="w"> </span><span class="kp">UP</span><span class="w"> </span><span class="nv">REPETITIVE</span><span class="w"> </span><span class="kp">CODE </span><span class="err">!!</span><span class="w">                        </span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL1O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO1O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM1O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS1O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">        </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                         </span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL2O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO2O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM2O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS2O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">        </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                         </span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL3O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO3O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM3O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS3O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">        </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                         </span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL4O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO4O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM4O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS4O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">        </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                         </span>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL5O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO5O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM5O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS5O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>
<a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">        </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                         </span>
<a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL6O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO6O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM6O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS6O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>
<a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">        </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                         </span>
<a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="no">             </span><span class="w"> </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL7O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTNO7O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDNUM7O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSTS7O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1200-screen-array-init-exit">1200-SCREEN-ARRAY-INIT-EXIT</h3>
<p>This paragraph serves as an exit point for the 1200-SCREEN-ARRAY-INIT routine. It simply marks the end of the routine with no additional processing, allowing the program to return control to the calling section after the screen array initialization is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1250-setup-array-attribs">1250-SETUP-ARRAY-ATTRIBS</h3>
<p>This paragraph configures the display attributes for the card selection fields in the card listing screen. For each of the seven possible card rows on the screen, it determines whether the selection field should be protected or unprotected based on data availability and application state. When a row contains card data and selection is allowed, the field is made input-capable (DFHBMFSE). Otherwise, it's protected (DFHBMPRO/DFHBMPRF). The paragraph also handles error highlighting by setting fields to red (DFHRED) when validation errors occur and positions the cursor at the first error field. The code includes a comment suggesting that this repetitive logic could be improved through the use of REDEFINES. There's also a stray "I" character in the fourth row's logic that appears to be a typo.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">*    U</span><span class="nv">SE</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CLEAN</span><span class="w"> </span><span class="kp">UP</span><span class="w"> </span><span class="nv">REPETITIVE</span><span class="w"> </span><span class="kp">CODE </span><span class="err">!!</span><span class="w">                        </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRF</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL1A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL1C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c">      </span><span class="w">           </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACE</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="no">                   </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;*&#39;</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL1O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="c">      </span><span class="w">           </span><span class="kr">END-IF                                                         </span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="kr">             </span><span class="w"> </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL1A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRO</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL2A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL2C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL2L</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL2A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRO</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL3A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL3C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL3L</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL3A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a>
<a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRO</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL4A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a><span class="c">      </span><span class="w">        </span><span class="nv">I</span><span class="w">                                                                 </span>
<a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL4C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL4L</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL4A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-49" name="__codelineno-12-49" href="#__codelineno-12-49"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-50" name="__codelineno-12-50" href="#__codelineno-12-50"></a>
<a id="__codelineno-12-51" name="__codelineno-12-51" href="#__codelineno-12-51"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-52" name="__codelineno-12-52" href="#__codelineno-12-52"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-53" name="__codelineno-12-53" href="#__codelineno-12-53"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRO</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL5A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-54" name="__codelineno-12-54" href="#__codelineno-12-54"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-55" name="__codelineno-12-55" href="#__codelineno-12-55"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-56" name="__codelineno-12-56" href="#__codelineno-12-56"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL5C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-57" name="__codelineno-12-57" href="#__codelineno-12-57"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL5L</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-58" name="__codelineno-12-58" href="#__codelineno-12-58"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-59" name="__codelineno-12-59" href="#__codelineno-12-59"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL5A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-60" name="__codelineno-12-60" href="#__codelineno-12-60"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-61" name="__codelineno-12-61" href="#__codelineno-12-61"></a>
<a id="__codelineno-12-62" name="__codelineno-12-62" href="#__codelineno-12-62"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-63" name="__codelineno-12-63" href="#__codelineno-12-63"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-64" name="__codelineno-12-64" href="#__codelineno-12-64"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRO</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL6A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-65" name="__codelineno-12-65" href="#__codelineno-12-65"></a>
<a id="__codelineno-12-66" name="__codelineno-12-66" href="#__codelineno-12-66"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-67" name="__codelineno-12-67" href="#__codelineno-12-67"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-68" name="__codelineno-12-68" href="#__codelineno-12-68"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL6C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-69" name="__codelineno-12-69" href="#__codelineno-12-69"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL6L</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-70" name="__codelineno-12-70" href="#__codelineno-12-70"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-71" name="__codelineno-12-71" href="#__codelineno-12-71"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL6A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-72" name="__codelineno-12-72" href="#__codelineno-12-72"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-73" name="__codelineno-12-73" href="#__codelineno-12-73"></a>
<a id="__codelineno-12-74" name="__codelineno-12-74" href="#__codelineno-12-74"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-EACH-CARD</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">            </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                     </span>
<a id="__codelineno-12-75" name="__codelineno-12-75" href="#__codelineno-12-75"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR  </span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w">                                     </span>
<a id="__codelineno-12-76" name="__codelineno-12-76" href="#__codelineno-12-76"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMPRO</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL7A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-77" name="__codelineno-12-77" href="#__codelineno-12-77"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-78" name="__codelineno-12-78" href="#__codelineno-12-78"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-79" name="__codelineno-12-79" href="#__codelineno-12-79"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL7C</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">              </span>
<a id="__codelineno-12-80" name="__codelineno-12-80" href="#__codelineno-12-80"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL7L</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-81" name="__codelineno-12-81" href="#__codelineno-12-81"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-12-82" name="__codelineno-12-82" href="#__codelineno-12-82"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CRDSEL7A</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">              </span>
<a id="__codelineno-12-83" name="__codelineno-12-83" href="#__codelineno-12-83"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-84" name="__codelineno-12-84" href="#__codelineno-12-84"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1250-setup-array-attribs-exit">1250-SETUP-ARRAY-ATTRIBS-EXIT</h3>
<p>This paragraph serves as an exit point for the 1250-SETUP-ARRAY-ATTRIBS routine. It provides a clean termination point for the routine that sets up display attributes for the card listing array, allowing the program to return control to the calling routine after attribute setup is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1300-setup-screen-attrs">1300-SETUP-SCREEN-ATTRS</h3>
<p>This paragraph initializes and configures the screen attributes for the credit card listing interface. It handles the setup of search criteria fields (account ID and card number) based on various conditions including previous user input, validation status, and navigation context. The paragraph performs three main functions:</p>
<ol>
<li>
<p>Initializes search criteria fields by evaluating the current state of filters and preserving valid user inputs. It determines whether to display previously entered values or clear the fields based on validation flags and program flow.</p>
</li>
<li>
<p>Sets cursor positioning and highlighting for error conditions by applying red color attributes to invalid input fields (account ID or card number) that failed validation.</p>
</li>
<li>
<p>Establishes default cursor positioning at the account ID field when no errors are present, improving user experience by placing the cursor at the logical starting point for new searches.</p>
</li>
</ol>
<p>The code uses CICS screen attribute bytes (like DFHBMFSE for field selection and DFHRED for error highlighting) to control the visual presentation of the interface elements based on the current application state.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c">*    I</span><span class="nv">NITIALIZE</span><span class="w"> </span><span class="kr">SEARCH</span><span class="w"> </span><span class="nv">CRITERIA</span><span class="w">                                           </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                                      </span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="mi">           </span><span class="ow">OR </span><span class="p">(</span><span class="nv">CDEMO-PGM-ENTER</span><span class="w">                                                  </span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LIT-MENUPGM</span><span class="p">)</span><span class="w">                                </span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="kr">             </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                     </span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="nb">                 </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">                                   </span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                    </span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="c">      </span><span class="w">               </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="c">      </span><span class="w">               </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                        </span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="mi">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES  </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                    </span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="kp">                   </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-EVALUATE                                                      </span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="kr">             </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                     </span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="nb">                 </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">                                   </span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                    </span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="c">      </span><span class="w">               </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="c">      </span><span class="w">               </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                       </span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="mi">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES  </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="c">      </span><span class="w">            </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                    </span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="kp">                   </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                                         </span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="c">      </span><span class="w">                                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="c">      </span><span class="w">              </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHBMFSE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDA</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-EVALUATE                                                      </span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="kp">POSITION</span><span class="w"> </span><span class="kp">CURSOR                                                      </span>
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="kp">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE </span><span class="w"> </span><span class="o">-</span><span class="mi">1                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>
<a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                             </span>
<a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE </span><span class="w"> </span><span class="nv">DFHRED</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                  </span>
<a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE </span><span class="w"> </span><span class="o">-</span><span class="mi">1                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a>
<a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="kr">      </span><span class="o">*</span><span class="w">    </span><span class="kr">IF</span><span class="w"> </span><span class="kp">NO</span><span class="w"> </span><span class="nv">ERRORS</span><span class="w"> </span><span class="kp">POSITION</span><span class="w"> </span><span class="kp">CURSOR</span><span class="w"> </span><span class="kp">AT</span><span class="w"> </span><span class="nv">ACCTID</span><span class="w">                               </span>
<a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a>
<a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">INPUT-OK</span><span class="w">                                                          </span>
<a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a><span class="c">      </span><span class="w">       </span><span class="kr">MOVE  </span><span class="w"> </span><span class="o">-</span><span class="mi">1                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTSIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">                  </span>
<a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a>
<a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a>
<a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1300-setup-screen-attrs-exit">1300-SETUP-SCREEN-ATTRS-EXIT</h3>
<p>This paragraph serves as an exit point for the 1300-SETUP-SCREEN-ATTRS routine. It's a simple exit paragraph that marks the end of the screen attributes setup process, allowing the program to return control to the calling routine.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1400-setup-message">1400-SETUP-MESSAGE</h3>
<p>This paragraph handles the setup and display of appropriate messages to the user based on various navigation and filtering conditions in the card listing screen. It evaluates multiple scenarios to determine what message should be displayed:</p>
<ol>
<li>When filter validation has failed (account or card number), it continues without changing the existing error message</li>
<li>When the user presses PF7 (backward) but is already on the first page, it displays "NO PREVIOUS PAGES TO DISPLAY"</li>
<li>When the user presses PF8 (forward) but there are no more pages and the last page is already shown, it displays "NO MORE PAGES TO DISPLAY"</li>
<li>When the user presses PF8 and there are no more pages but the last page flag isn't set, it sets the last page indicator and displays record action information</li>
<li>When there are more pages available, it displays information about record actions</li>
</ol>
<p>The paragraph then moves the appropriate message to the screen fields, handling both error messages and informational messages with proper formatting. This logic ensures users receive clear feedback about pagination limits and available actions while browsing card records.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c">*    S</span><span class="nv">ETUP</span><span class="w"> </span><span class="err">MESSAGE                                                        </span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="err">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                        </span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="nb">               </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w">                                      </span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c">      </span><span class="w">          </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w">                                      </span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c">      </span><span class="w">            </span><span class="kr">CONTINUE                                                      </span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="kr">               </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK07</span><span class="w">                                            </span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c">      </span><span class="w">              </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-FIRST-PAGE</span><span class="w">                                           </span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE </span><span class="s1">&#39;NO PREVIOUS PAGES TO DISPLAY&#39;</span><span class="w">                           </span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c">      </span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">                                               </span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="c">      </span><span class="w">          </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK08</span><span class="w">                                            </span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c">      </span><span class="w">           </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-NOT-EXISTS</span><span class="w">                                    </span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c">      </span><span class="w">           </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-LAST-PAGE-SHOWN</span><span class="w">                                         </span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE </span><span class="s1">&#39;NO MORE PAGES TO DISPLAY&#39;</span><span class="w">                               </span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="c">      </span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">                                               </span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="c">      </span><span class="w">          </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CCARD-AID-PFK08</span><span class="w">                                            </span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="c">      </span><span class="w">           </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-NOT-EXISTS</span><span class="w">                                    </span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-INFORM-REC-ACTIONS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                             </span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CA-LAST-PAGE-NOT-SHOWN</span><span class="w">                                    </span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="c">      </span><span class="w">            </span><span class="ow">AND</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-NOT-EXISTS</span><span class="w">                                   </span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-LAST-PAGE-SHOWN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="kr">               </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                                         </span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="c">      </span><span class="w">          </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-EXISTS</span><span class="w">                                        </span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-INFORM-REC-ACTIONS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                             </span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="nb">               </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                      </span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                    </span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">WS-NO-INFO-MESSAGE</span><span class="w">                                           </span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="c">      </span><span class="w">     </span><span class="ow">AND</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">WS-NO-RECORDS-FOUND</span><span class="w">                                          </span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-INFO-MSG</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                   </span>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHNEUTR</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">INFOMSGC</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAO</span><span class="w">                   </span>
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1400-setup-message-exit">1400-SETUP-MESSAGE-EXIT</h3>
<p>This paragraph serves as an exit point for the message setup routine in the COCRDLIC program. It provides a clean termination point for the message handling logic, allowing the program to return control to the calling routine after message processing has been completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1500-send-screen">1500-SEND-SCREEN</h3>
<p>This paragraph sends the credit card listing screen to the terminal using CICS SEND MAP command. It displays the screen defined by LIT-THISMAP within the LIT-THISMAPSET mapset, populating it with data from the CCRDLIAO structure. The CURSOR parameter positions the cursor at a predefined location, while ERASE clears the screen before displaying the new content. The FREEKB option unlocks the keyboard for user input, and the operation's response code is captured in WS-RESP-CD for error handling.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="nv">LIT-THISMAP</span><span class="p">)</span><span class="w">                                      </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c">      </span><span class="w">                    </span><span class="nv">MAPSET</span><span class="p">(</span><span class="nv">LIT-THISMAPSET</span><span class="p">)</span><span class="w">                                </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c">      </span><span class="w">                    </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">CCRDLIAO</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c">      </span><span class="w">                    </span><span class="kp">CURSOR                                                </span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="kp">                         </span><span class="w"> </span><span class="kp">ERASE                                                 </span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="kp">                         </span><span class="w"> </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                      </span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c">      </span><span class="w">                    </span><span class="nv">FREEKB</span><span class="w">                                                </span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1500-send-screen-exit">1500-SEND-SCREEN-EXIT</h3>
<p>This paragraph serves as an exit point for the 1500-SEND-SCREEN routine in the COCRDLIC program. It provides a clean termination point for the screen sending process, allowing control to return to the calling routine after the card listing screen has been prepared and sent to the user interface.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2000-receive-map">2000-RECEIVE-MAP</h3>
<p>This paragraph handles the initial processing of user input from the screen. It first calls the 2100-RECEIVE-SCREEN paragraph to capture the data entered by the user, then passes that data to the 2200-EDIT-INPUTS paragraph which validates the input values. This two-step process separates the concerns of data collection and data validation, ensuring all user inputs are properly received and checked before further processing occurs.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="mi">2100</span><span class="o">-</span><span class="nv">RECEIVE-SCREEN</span><span class="w">                                          </span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2100</span><span class="o">-</span><span class="nv">RECEIVE-SCREEN-EXIT</span><span class="w">                                     </span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2200</span><span class="o">-</span><span class="nv">EDIT-INPUTS</span><span class="w">                                             </span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c">      </span><span class="w">      </span><span class="kp">THRU  </span><span class="w"> </span><span class="mi">2200</span><span class="o">-</span><span class="nv">EDIT-INPUTS-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2000-receive-map-exit">2000-RECEIVE-MAP-EXIT</h3>
<p>This paragraph serves as an exit point for the 2000-RECEIVE-MAP section of the COCRDLIC program. It provides a clean termination point for the section that handles receiving user input from the screen map, allowing control to return to the calling routine after map processing is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2100-receive-screen">2100-RECEIVE-SCREEN</h3>
<p>This paragraph receives user input from the screen using CICS RECEIVE MAP command and processes the data entered by the user. It captures the account ID and card number filters entered by the user and stores them in the CC-ACCT-ID and CC-CARD-NUM fields respectively. Additionally, it retrieves the selection indicators (likely checkboxes or action codes) for up to 7 card records displayed on the screen, storing them in the WS-EDIT-SELECT array for subsequent processing. This paragraph is a key part of the program's user interaction handling, collecting the input that will determine which filtering or selection actions to perform.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">RECEIVE</span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="nv">LIT-THISMAP</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c">      </span><span class="w">                    </span><span class="nv">MAPSET</span><span class="p">(</span><span class="nv">LIT-THISMAPSET</span><span class="p">)</span><span class="w">                                </span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c">      </span><span class="w">                    </span><span class="kp">INTO</span><span class="p">(</span><span class="nv">CCRDLIAI</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c">      </span><span class="w">                    </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                      </span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">                             </span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARDSIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">                            </span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL1I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL2I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL3I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL4I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL5I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL6I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CRDSEL7I</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CCRDLIAI</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">                      </span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2100-receive-screen-exit">2100-RECEIVE-SCREEN-EXIT</h3>
<p>This paragraph serves as an exit point for the 2100-RECEIVE-SCREEN routine in the COCRDLIC program. It provides a clean termination point for the screen receiving process, allowing control to return to the calling routine after the screen input has been processed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2200-edit-inputs">2200-EDIT-INPUTS</h3>
<p>This paragraph validates user inputs for the card listing screen. It first sets the input status to valid and allows row selection. Then it performs three validation routines in sequence: account number validation (2210), card number validation (2220), and validation of the array of selectable card records (2250). This ensures all user inputs are properly validated before processing continues, maintaining data integrity and preventing invalid operations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c">SET IN</span><span class="nv">PUT-OK</span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-NO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="nb">          </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT</span><span class="w">                                            </span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                       </span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD</span><span class="w">                                               </span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                          </span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">2250</span><span class="o">-</span><span class="nv">EDIT-ARRAY</span><span class="w">                                              </span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="c">      </span><span class="w">        </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">2250</span><span class="o">-</span><span class="nv">EDIT-ARRAY-EXIT</span><span class="w">                                         </span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2200-edit-inputs-exit">2200-EDIT-INPUTS-EXIT</h3>
<p>This paragraph serves as an exit point for the input validation routine in the COCRDLIC program. It marks the end of the 2200-EDIT-INPUTS section, which validates user inputs for account ID and card number filters before processing card listing requests.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2210-edit-account">2210-EDIT-ACCOUNT</h3>
<p>This paragraph validates the account ID filter input for the card listing screen. It first checks if the account ID is blank or empty, setting a flag to indicate no account filter is being applied. If an account ID is provided, it validates that the input is numeric and properly formatted (must be an 11-digit number). When validation fails, it sets error flags, displays an appropriate error message, and clears the account ID field. For valid account IDs, it moves the value to the CDEMO-ACCT-ID field and sets a flag indicating a valid account filter is in place. This validation ensures proper filtering of card records by account ID and prevents processing with invalid filter criteria.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c">SET FL</span><span class="nv">G-ACCTFILTER-BLANK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                     </span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                     </span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                         </span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-ACCT-ID-N</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                          </span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="nb">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                </span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                     </span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="c">      *    Not numeric                                                          </span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="c">      *    Not 11 characters                                                    </span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">  </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                        </span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="kp">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                           </span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                           </span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="nb">             </span><span class="w"> </span><span class="kr">MOVE                                                              </span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="kr">              </span><span class="s1">&#39;ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER&#39;</span><span class="w">            </span>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="c">      </span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">                                   </span>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                  </span>
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">2210</span><span class="o">-</span><span class="nv">EDIT-ACCOUNT-EXIT</span><span class="w">                                      </span>
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-ACCT-ID</span><span class="w">                                  </span>
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2210-edit-account-exit">2210-EDIT-ACCOUNT-EXIT</h3>
<p>This paragraph serves as an exit point for the account validation routine. It marks the end of the account number editing process, allowing the program to return control to the calling paragraph after account validation is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2220-edit-card">2220-EDIT-CARD</h3>
<p>This paragraph validates the card number filter input provided by the user. It first checks if the card number is blank, empty, or zero, in which case it sets a flag indicating no card filter is being applied and clears the card number field. If a card number is provided, it verifies that the input is numeric and 16 digits long. When the input fails validation, it sets error flags, displays an appropriate error message to the user, clears the card number field, and prevents row selection. If the card number passes validation, it stores the numeric value in the CDEMO-CARD-NUM field and sets a flag indicating the card filter is valid. This validation ensures that only properly formatted card numbers are used for filtering the displayed records.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c">*    N</span><span class="nv">ot</span><span class="w"> </span><span class="kp">numeric                                                          </span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="kp">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="mi">16 </span><span class="kp">characters                                                    </span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="kp">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                     </span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="nb">      </span><span class="o">*</span><span class="w">    </span><span class="ow">Not</span><span class="w"> </span><span class="nv">supplied</span><span class="w">                                                         </span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">LOW-VALUES                                    </span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">   </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">SPACES                                        </span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="no">          </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="ow">EQUAL</span><span class="w"> </span><span class="no">ZEROS                                         </span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="no">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-BLANK</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="nb">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                               </span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="kr">      </span><span class="o">*</span><span class="w">                                                                         </span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="c">      *    Not numeric                                                          </span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="c">      *    Not 16 characters                                                    </span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CC-CARD-NUM</span><span class="w">  </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                       </span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="kp">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                           </span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-NOT-OK</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                 </span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="nb">             </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-PROTECT-SELECT-ROWS-YES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                           </span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="nb">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ERROR-MSG-OFF</span><span class="w">                                               </span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE                                                           </span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="kr">              </span><span class="s1">&#39;CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER&#39;</span><span class="w">            </span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="c">      </span><span class="w">                        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">                                   </span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO      </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                                 </span>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">2220</span><span class="o">-</span><span class="nv">EDIT-CARD-EXIT</span><span class="w">                                         </span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a><span class="c">      </span><span class="w">        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a><span class="nb">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2220-edit-card-exit">2220-EDIT-CARD-EXIT</h3>
<p>This paragraph serves as an exit point for the EDIT-CARD routine in the COCRDLIC program. It provides a clean termination point for the card editing process, allowing the program flow to return to the calling routine after card validation and processing has been completed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2250-edit-array">2250-EDIT-ARRAY</h3>
<p>This paragraph validates user selections in the card listing screen. It first checks if there are any existing input errors before proceeding. It then counts how many cards have been selected with either 'S' (select) or 'U' (update) actions. If more than one card is selected, it flags this as an error and marks the selected rows in an error tracking array. The code then processes each of the 7 possible card rows on the screen, validating that any selection codes are valid ('S' or 'U' or blank) and tracking which row was selected. For any invalid selection codes, it sets appropriate error flags and error messages. This ensures users can only select one card at a time for further processing and that they use valid selection codes.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c">IF INP</span><span class="nv">UT-ERROR</span><span class="w">                                                       </span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c">      </span><span class="w">        </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">2250</span><span class="o">-</span><span class="nv">EDIT-ARRAY-EXIT</span><span class="w">                                        </span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="kr">          </span><span class="w"> </span><span class="kr">INSPECT </span><span class="w"> </span><span class="nv">WS-EDIT-SELECT-FLAGS</span><span class="w">                                        </span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="c">      </span><span class="w">     </span><span class="kp">TALLYING</span><span class="w"> </span><span class="nv">I</span><span class="w">                                                           </span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="c">      </span><span class="w">     </span><span class="kp">FOR</span><span class="w"> </span><span class="kp">ALL </span><span class="s1">&#39;S&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="c">      </span><span class="w">         </span><span class="kp">ALL </span><span class="s1">&#39;U&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">+</span><span class="mi">1                                                            </span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="mi">               </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                     </span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="nb">              </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-MORE-THAN-1-ACTION</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                </span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="nb">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT-FLAGS</span><span class="w">                                        </span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="c">      </span><span class="w">                             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT-ERROR-FLAGS</span><span class="w">                </span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="c">      </span><span class="w">         </span><span class="kr">INSPECT</span><span class="w"> </span><span class="nv">WS-EDIT-SELECT-ERROR-FLAGS</span><span class="w">                               </span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="c">      </span><span class="w">           </span><span class="kp">REPLACING</span><span class="w"> </span><span class="kp">ALL </span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="kp">BY </span><span class="s1">&#39;1&#39;</span><span class="w">                                       </span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="c">      </span><span class="w">                     </span><span class="kp">ALL </span><span class="s1">&#39;U&#39;</span><span class="w"> </span><span class="kp">BY </span><span class="s1">&#39;1&#39;</span><span class="w">                                       </span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="c">      </span><span class="w">           </span><span class="kp">CHARACTERS       </span><span class="w"> </span><span class="kp">BY </span><span class="s1">&#39;0&#39;</span><span class="w">                                       </span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZERO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">I-SELECTED</span><span class="w">                                              </span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="kp">VARYING</span><span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="kp">FROM</span><span class="w"> </span><span class="mi">1 </span><span class="kp">BY</span><span class="w"> </span><span class="mi">1 </span><span class="kp">UNTIL</span><span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">7                            </span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="mi">               </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE                                                    </span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="nb">                </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">SELECT-OK</span><span class="p">(</span><span class="nv">I</span><span class="p">)</span><span class="w">                                              </span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">I-SELECTED</span><span class="w">                                         </span>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-MORE-THAN-1-ACTION</span><span class="w">                                     </span>
<a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="nv">I</span><span class="p">)</span><span class="w">                     </span>
<a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a><span class="kr">                </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">SELECT-BLANK</span><span class="p">(</span><span class="nv">I</span><span class="p">)</span><span class="w">                                           </span>
<a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a><span class="c">      </span><span class="w">             </span><span class="kr">CONTINUE                                                     </span>
<a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a><span class="kr">                </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                     </span>
<a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">INPUT-ERROR</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                      </span>
<a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ROW-CRDSELECT-ERROR</span><span class="p">(</span><span class="nv">I</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ERROR-MSG-OFF</span><span class="w">                                          </span>
<a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-INVALID-ACTION-CODE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a><span class="kr">             </span><span class="w"> </span><span class="kr">END-EVALUATE                                                      </span>
<a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-PERFORM                                                          </span>
<a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>
<a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="2250-edit-array-exit">2250-EDIT-ARRAY-EXIT</h3>
<p>This paragraph serves as an exit point for the EDIT-ARRAY routine in the COCRDLIC program. It marks the end of the array editing logic that likely handles the filtering and preparation of credit card records for display. The paragraph contains only the EXIT statement, which returns control to the calling routine after the array processing is complete.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9000-read-forward">9000-READ-FORWARD</h3>
<p>This paragraph implements forward pagination through credit card records in the CardDemo application. It starts a browse operation on the card file using the current card number as a key, then reads records sequentially forward, populating a screen buffer with up to 7 card records (the maximum screen lines). </p>
<p>The routine filters records based on criteria defined elsewhere in the program, tracking the first and last card displayed on the current page. It also performs a look-ahead read after filling the screen to determine if more pages exist, setting appropriate flags for navigation controls.</p>
<p>The paragraph handles various response conditions including normal processing, end-of-file conditions, and error scenarios. When the end of file is reached, it sets appropriate status flags and displays a "NO MORE RECORDS TO SHOW" message. For empty result sets, it sets a special flag indicating no records were found. Any unexpected errors during file operations are captured with detailed information for error reporting.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c">MOVE L</span><span class="nv">OW-VALUES</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ALL-ROWS</span><span class="w">                             </span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c">      *    Start Browse                                                         </span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">STARTBR</span><span class="w">                                                    </span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="c">      </span><span class="w">          </span><span class="nv">GTEQ</span><span class="w">                                                            </span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                                </span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                               </span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="c">      *    Loop through records and fetch max screen records                    </span>
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w">                                       </span>
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-EXISTS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                   </span>
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">MORE-RECORDS-TO-READ</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                   </span>
<a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>
<a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a><span class="nb">          </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="kp">UNTIL</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">                                         </span>
<a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>
<a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">READNEXT</span><span class="w">                                                   </span>
<a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                              </span>
<a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                                </span>
<a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                               </span>
<a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a>
<a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                                  </span>
<a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-32-35" name="__codelineno-32-35" href="#__codelineno-32-35"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">DUPREC</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-32-36" name="__codelineno-32-36" href="#__codelineno-32-36"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9500</span><span class="o">-</span><span class="nv">FILTER-RECORDS</span><span class="w">                                  </span>
<a id="__codelineno-32-37" name="__codelineno-32-37" href="#__codelineno-32-37"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9500</span><span class="o">-</span><span class="nv">FILTER-RECORDS-EXIT</span><span class="w">                             </span>
<a id="__codelineno-32-38" name="__codelineno-32-38" href="#__codelineno-32-38"></a>
<a id="__codelineno-32-39" name="__codelineno-32-39" href="#__codelineno-32-39"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-DONOT-EXCLUDE-THIS-RECORD</span><span class="w">                              </span>
<a id="__codelineno-32-40" name="__codelineno-32-40" href="#__codelineno-32-40"></a><span class="c">      </span><span class="w">                </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w">                      </span>
<a id="__codelineno-32-41" name="__codelineno-32-41" href="#__codelineno-32-41"></a>
<a id="__codelineno-32-42" name="__codelineno-32-42" href="#__codelineno-32-42"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="w">                     </span>
<a id="__codelineno-32-43" name="__codelineno-32-43" href="#__codelineno-32-43"></a><span class="c">      </span><span class="w">                </span><span class="nv">WS-SCRN-COUNTER</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-32-44" name="__codelineno-32-44" href="#__codelineno-32-44"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w"> </span><span class="kp">TO                                      </span>
<a id="__codelineno-32-45" name="__codelineno-32-45" href="#__codelineno-32-45"></a><span class="kp">                     </span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="nv">WS-SCRN-COUNTER</span><span class="p">)</span><span class="w">                            </span>
<a id="__codelineno-32-46" name="__codelineno-32-46" href="#__codelineno-32-46"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-32-47" name="__codelineno-32-47" href="#__codelineno-32-47"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="w">                  </span>
<a id="__codelineno-32-48" name="__codelineno-32-48" href="#__codelineno-32-48"></a><span class="c">      </span><span class="w">                                  </span><span class="nv">WS-SCRN-COUNTER</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-32-49" name="__codelineno-32-49" href="#__codelineno-32-49"></a>
<a id="__codelineno-32-50" name="__codelineno-32-50" href="#__codelineno-32-50"></a><span class="c">      </span><span class="w">                </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1                                    </span>
<a id="__codelineno-32-51" name="__codelineno-32-51" href="#__codelineno-32-51"></a><span class="mi">                         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w">                                      </span>
<a id="__codelineno-32-52" name="__codelineno-32-52" href="#__codelineno-32-52"></a><span class="c">      </span><span class="w">                                  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-ACCT-ID</span><span class="w">             </span>
<a id="__codelineno-32-53" name="__codelineno-32-53" href="#__codelineno-32-53"></a><span class="c">      </span><span class="w">                   </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">                 </span>
<a id="__codelineno-32-54" name="__codelineno-32-54" href="#__codelineno-32-54"></a><span class="c">      </span><span class="w">                   </span><span class="kr">IF  </span><span class="w"> </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                              </span>
<a id="__codelineno-32-55" name="__codelineno-32-55" href="#__codelineno-32-55"></a><span class="mi">                           </span><span class="kr">ADD   </span><span class="o">+</span><span class="mi">1     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w">                     </span>
<a id="__codelineno-32-56" name="__codelineno-32-56" href="#__codelineno-32-56"></a><span class="c">      </span><span class="w">                   </span><span class="kr">ELSE                                                   </span>
<a id="__codelineno-32-57" name="__codelineno-32-57" href="#__codelineno-32-57"></a><span class="kr">                          </span><span class="w"> </span><span class="kr">CONTINUE                                             </span>
<a id="__codelineno-32-58" name="__codelineno-32-58" href="#__codelineno-32-58"></a><span class="kr">                        </span><span class="w"> </span><span class="kr">END-IF                                                 </span>
<a id="__codelineno-32-59" name="__codelineno-32-59" href="#__codelineno-32-59"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">ELSE                                                      </span>
<a id="__codelineno-32-60" name="__codelineno-32-60" href="#__codelineno-32-60"></a><span class="kr">                        </span><span class="w"> </span><span class="kr">CONTINUE                                               </span>
<a id="__codelineno-32-61" name="__codelineno-32-61" href="#__codelineno-32-61"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">END-IF                                                    </span>
<a id="__codelineno-32-62" name="__codelineno-32-62" href="#__codelineno-32-62"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-32-63" name="__codelineno-32-63" href="#__codelineno-32-63"></a><span class="kr">                      </span><span class="w"> </span><span class="kr">CONTINUE                                                 </span>
<a id="__codelineno-32-64" name="__codelineno-32-64" href="#__codelineno-32-64"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-32-65" name="__codelineno-32-65" href="#__codelineno-32-65"></a><span class="kr">      </span><span class="o">******************************************************************</span><span class="w">        </span>
<a id="__codelineno-32-66" name="__codelineno-32-66" href="#__codelineno-32-66"></a><span class="c">      *            Max Screen size                                              </span>
<a id="__codelineno-32-67" name="__codelineno-32-67" href="#__codelineno-32-67"></a><span class="c">      ******************************************************************        </span>
<a id="__codelineno-32-68" name="__codelineno-32-68" href="#__codelineno-32-68"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">WS-MAX-SCREEN-LINES</span><span class="w">                     </span>
<a id="__codelineno-32-69" name="__codelineno-32-69" href="#__codelineno-32-69"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                               </span>
<a id="__codelineno-32-70" name="__codelineno-32-70" href="#__codelineno-32-70"></a>
<a id="__codelineno-32-71" name="__codelineno-32-71" href="#__codelineno-32-71"></a><span class="nb">                     </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-ACCT-ID</span><span class="w">          </span>
<a id="__codelineno-32-72" name="__codelineno-32-72" href="#__codelineno-32-72"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-NUM</span><span class="w">              </span>
<a id="__codelineno-32-73" name="__codelineno-32-73" href="#__codelineno-32-73"></a>
<a id="__codelineno-32-74" name="__codelineno-32-74" href="#__codelineno-32-74"></a><span class="c">      </span><span class="w">                </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">READNEXT</span><span class="w">                                        </span>
<a id="__codelineno-32-75" name="__codelineno-32-75" href="#__codelineno-32-75"></a><span class="c">      </span><span class="w">                  </span><span class="nv">DATASET</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                  </span>
<a id="__codelineno-32-76" name="__codelineno-32-76" href="#__codelineno-32-76"></a><span class="c">      </span><span class="w">                  </span><span class="kp">INTO </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                      </span>
<a id="__codelineno-32-77" name="__codelineno-32-77" href="#__codelineno-32-77"></a><span class="c">      </span><span class="w">                  </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                           </span>
<a id="__codelineno-32-78" name="__codelineno-32-78" href="#__codelineno-32-78"></a><span class="c">      </span><span class="w">                  </span><span class="nv">RIDFLD</span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-32-79" name="__codelineno-32-79" href="#__codelineno-32-79"></a><span class="c">      </span><span class="w">                  </span><span class="nv">KEYLENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                </span>
<a id="__codelineno-32-80" name="__codelineno-32-80" href="#__codelineno-32-80"></a><span class="c">      </span><span class="w">                  </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                        </span>
<a id="__codelineno-32-81" name="__codelineno-32-81" href="#__codelineno-32-81"></a><span class="c">      </span><span class="w">                  </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                       </span>
<a id="__codelineno-32-82" name="__codelineno-32-82" href="#__codelineno-32-82"></a><span class="c">      </span><span class="w">                </span><span class="nv">END-EXEC</span><span class="w">                                                  </span>
<a id="__codelineno-32-83" name="__codelineno-32-83" href="#__codelineno-32-83"></a>
<a id="__codelineno-32-84" name="__codelineno-32-84" href="#__codelineno-32-84"></a><span class="c">      </span><span class="w">                </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                       </span>
<a id="__codelineno-32-85" name="__codelineno-32-85" href="#__codelineno-32-85"></a><span class="c">      </span><span class="w">                   </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-32-86" name="__codelineno-32-86" href="#__codelineno-32-86"></a><span class="c">      </span><span class="w">                   </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">DUPREC</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-32-87" name="__codelineno-32-87" href="#__codelineno-32-87"></a><span class="c">      </span><span class="w">                        </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-EXISTS</span><span class="w">                           </span>
<a id="__codelineno-32-88" name="__codelineno-32-88" href="#__codelineno-32-88"></a><span class="c">      </span><span class="w">                                          </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                         </span>
<a id="__codelineno-32-89" name="__codelineno-32-89" href="#__codelineno-32-89"></a><span class="nb">                             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w"> </span><span class="kp">TO                              </span>
<a id="__codelineno-32-90" name="__codelineno-32-90" href="#__codelineno-32-90"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-ACCT-ID</span><span class="w">                      </span>
<a id="__codelineno-32-91" name="__codelineno-32-91" href="#__codelineno-32-91"></a><span class="c">      </span><span class="w">                        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-NUM</span><span class="w">          </span>
<a id="__codelineno-32-92" name="__codelineno-32-92" href="#__codelineno-32-92"></a><span class="c">      </span><span class="w">                  </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">ENDFILE</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-32-93" name="__codelineno-32-93" href="#__codelineno-32-93"></a><span class="c">      </span><span class="w">                      </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-NOT-EXISTS</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE             </span>
<a id="__codelineno-32-94" name="__codelineno-32-94" href="#__codelineno-32-94"></a>
<a id="__codelineno-32-95" name="__codelineno-32-95" href="#__codelineno-32-95"></a><span class="nb">                           </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ERROR-MSG-OFF</span><span class="w">                                 </span>
<a id="__codelineno-32-96" name="__codelineno-32-96" href="#__codelineno-32-96"></a><span class="c">      </span><span class="w">                          </span><span class="kr">MOVE </span><span class="s1">&#39;NO MORE RECORDS TO SHOW&#39;</span><span class="w">                  </span>
<a id="__codelineno-32-97" name="__codelineno-32-97" href="#__codelineno-32-97"></a><span class="c">      </span><span class="w">                                          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">                 </span>
<a id="__codelineno-32-98" name="__codelineno-32-98" href="#__codelineno-32-98"></a><span class="c">      </span><span class="w">                      </span><span class="kr">END-IF                                              </span>
<a id="__codelineno-32-99" name="__codelineno-32-99" href="#__codelineno-32-99"></a><span class="kr">                           </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                          </span>
<a id="__codelineno-32-100" name="__codelineno-32-100" href="#__codelineno-32-100"></a><span class="kp">      </span><span class="o">*</span><span class="w">                     </span><span class="nv">This</span><span class="w"> </span><span class="kp">is</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">kind</span><span class="w"> </span><span class="kp">of</span><span class="w"> </span><span class="kp">error</span><span class="p">.</span><span class="w"> </span><span class="nv">Change</span><span class="w"> </span><span class="kp">to</span><span class="w"> </span><span class="kr">END</span><span class="w"> </span><span class="nv">BR</span><span class="w">        </span>
<a id="__codelineno-32-101" name="__codelineno-32-101" href="#__codelineno-32-101"></a><span class="c">      *                     And exit                                            </span>
<a id="__codelineno-32-102" name="__codelineno-32-102" href="#__codelineno-32-102"></a><span class="c">      </span><span class="w">                      </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                     </span>
<a id="__codelineno-32-103" name="__codelineno-32-103" href="#__codelineno-32-103"></a><span class="nb">                           </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">            </span>
<a id="__codelineno-32-104" name="__codelineno-32-104" href="#__codelineno-32-104"></a><span class="c">      </span><span class="w">                      </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARD-FILE</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">              </span>
<a id="__codelineno-32-105" name="__codelineno-32-105" href="#__codelineno-32-105"></a><span class="c">      </span><span class="w">                      </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">              </span>
<a id="__codelineno-32-106" name="__codelineno-32-106" href="#__codelineno-32-106"></a><span class="c">      </span><span class="w">                      </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">             </span>
<a id="__codelineno-32-107" name="__codelineno-32-107" href="#__codelineno-32-107"></a><span class="c">      </span><span class="w">                    </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">            </span>
<a id="__codelineno-32-108" name="__codelineno-32-108" href="#__codelineno-32-108"></a><span class="c">      </span><span class="w">                </span><span class="kr">END-EVALUATE                                              </span>
<a id="__codelineno-32-109" name="__codelineno-32-109" href="#__codelineno-32-109"></a><span class="kr">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-32-110" name="__codelineno-32-110" href="#__codelineno-32-110"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">ENDFILE</span><span class="p">)</span><span class="w">                                            </span>
<a id="__codelineno-32-111" name="__codelineno-32-111" href="#__codelineno-32-111"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-32-112" name="__codelineno-32-112" href="#__codelineno-32-112"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-NOT-EXISTS</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                       </span>
<a id="__codelineno-32-113" name="__codelineno-32-113" href="#__codelineno-32-113"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-ACCT-ID</span><span class="w">              </span>
<a id="__codelineno-32-114" name="__codelineno-32-114" href="#__codelineno-32-114"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARD-NUM</span><span class="w">                  </span>
<a id="__codelineno-32-115" name="__codelineno-32-115" href="#__codelineno-32-115"></a><span class="c">      </span><span class="w">            </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-ERROR-MSG-OFF</span><span class="w">                                           </span>
<a id="__codelineno-32-116" name="__codelineno-32-116" href="#__codelineno-32-116"></a><span class="c">      </span><span class="w">               </span><span class="kr">MOVE </span><span class="s1">&#39;NO MORE RECORDS TO SHOW&#39;</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">            </span>
<a id="__codelineno-32-117" name="__codelineno-32-117" href="#__codelineno-32-117"></a><span class="c">      </span><span class="w">            </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-32-118" name="__codelineno-32-118" href="#__codelineno-32-118"></a><span class="kr">                 </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-CA-SCREEN-NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1                                       </span>
<a id="__codelineno-32-119" name="__codelineno-32-119" href="#__codelineno-32-119"></a><span class="mi">                  </span><span class="ow">AND</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                       </span>
<a id="__codelineno-32-120" name="__codelineno-32-120" href="#__codelineno-32-120"></a><span class="mi">      </span><span class="o">*</span><span class="w">               </span><span class="kr">MOVE </span><span class="s1">&#39;NO RECORDS TO SHOW&#39;</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">                </span>
<a id="__codelineno-32-121" name="__codelineno-32-121" href="#__codelineno-32-121"></a><span class="c">      </span><span class="w">                </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-NO-RECORDS-FOUND</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-32-122" name="__codelineno-32-122" href="#__codelineno-32-122"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">END-IF                                                        </span>
<a id="__codelineno-32-123" name="__codelineno-32-123" href="#__codelineno-32-123"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-32-124" name="__codelineno-32-124" href="#__codelineno-32-124"></a><span class="kp">      </span><span class="o">*</span><span class="w">           </span><span class="nv">This</span><span class="w"> </span><span class="kp">is</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">kind</span><span class="w"> </span><span class="kp">of</span><span class="w"> </span><span class="kp">error</span><span class="p">.</span><span class="w"> </span><span class="nv">Change</span><span class="w"> </span><span class="kp">to</span><span class="w"> </span><span class="kr">END</span><span class="w"> </span><span class="nv">BR</span><span class="w">                  </span>
<a id="__codelineno-32-125" name="__codelineno-32-125" href="#__codelineno-32-125"></a><span class="c">      *           And exit                                                      </span>
<a id="__codelineno-32-126" name="__codelineno-32-126" href="#__codelineno-32-126"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-32-127" name="__codelineno-32-127" href="#__codelineno-32-127"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">                     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">               </span>
<a id="__codelineno-32-128" name="__codelineno-32-128" href="#__codelineno-32-128"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARD-FILE</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">                 </span>
<a id="__codelineno-32-129" name="__codelineno-32-129" href="#__codelineno-32-129"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">                 </span>
<a id="__codelineno-32-130" name="__codelineno-32-130" href="#__codelineno-32-130"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">                </span>
<a id="__codelineno-32-131" name="__codelineno-32-131" href="#__codelineno-32-131"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">               </span>
<a id="__codelineno-32-132" name="__codelineno-32-132" href="#__codelineno-32-132"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-32-133" name="__codelineno-32-133" href="#__codelineno-32-133"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-PERFORM                                                          </span>
<a id="__codelineno-32-134" name="__codelineno-32-134" href="#__codelineno-32-134"></a>
<a id="__codelineno-32-135" name="__codelineno-32-135" href="#__codelineno-32-135"></a><span class="kr">          </span><span class="w"> </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">ENDBR</span><span class="w"> </span><span class="kr">FILE</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                  </span>
<a id="__codelineno-32-136" name="__codelineno-32-136" href="#__codelineno-32-136"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-32-137" name="__codelineno-32-137" href="#__codelineno-32-137"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9000-read-forward-exit">9000-READ-FORWARD-EXIT</h3>
<p>This paragraph serves as an exit point for the forward reading process in the card listing functionality. It's a simple exit paragraph that marks the end of the forward reading logic, allowing the program to return control to the calling section after completing the forward navigation through card records.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9100-read-backwards">9100-READ-BACKWARDS</h3>
<p>This paragraph implements backward pagination functionality for the card listing screen. It reads records in reverse order from the CARDDAT file to populate the previous page of card records. The process starts by initializing variables and beginning a browse operation at the current first record position. It then reads records in reverse sequence (using READPREV) to fill the screen from bottom to top, applying any active filters to determine which records to display. The paragraph maintains tracking of the first record on the new page for future navigation purposes. Error handling is implemented throughout the process to catch and report any file access issues. The maximum number of records displayed is controlled by WS-MAX-SCREEN-LINES, and the routine stops reading when this limit is reached or when no more records are available.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c">MOVE L</span><span class="nv">OW-VALUES</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ALL-ROWS</span><span class="w">                             </span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARDKEY</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-LAST-CARDKEY</span><span class="w">                      </span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="c">      *    Start Browse                                                         </span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">STARTBR</span><span class="w">                                                    </span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="c">      </span><span class="w">          </span><span class="nv">GTEQ</span><span class="w">                                                            </span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                                </span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                               </span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c">      *    Loop through records and fetch max screen records                    </span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w">                                            </span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="c">      </span><span class="w">                             </span><span class="nv">WS-MAX-SCREEN-LINES</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1                      </span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="mi">           </span><span class="kr">END-COMPUTE                                                          </span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a><span class="kr">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CA-NEXT-PAGE-EXISTS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                   </span>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">MORE-RECORDS-TO-READ</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                                   </span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="nb">      </span><span class="o">*****************************************************************</span><span class="w">         </span>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a><span class="c">      *    Now we show the records from previous set.                           </span>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">READPREV</span><span class="w">                                                   </span>
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                              </span>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                                </span>
<a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                               </span>
<a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a>
<a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                                  </span>
<a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">DUPREC</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a><span class="c">      </span><span class="w">             </span><span class="kr">SUBTRACT</span><span class="w"> </span><span class="mi">1          </span><span class="kp">FROM</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w">                     </span>
<a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a><span class="kp">      </span><span class="o">*</span><span class="w">           </span><span class="nv">This</span><span class="w"> </span><span class="kp">is</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">kind</span><span class="w"> </span><span class="kp">of</span><span class="w"> </span><span class="kp">error</span><span class="p">.</span><span class="w"> </span><span class="nv">Change</span><span class="w"> </span><span class="kp">to</span><span class="w"> </span><span class="kr">END</span><span class="w"> </span><span class="nv">BR</span><span class="w">                  </span>
<a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a><span class="c">      *           And exit                                                      </span>
<a id="__codelineno-34-46" name="__codelineno-34-46" href="#__codelineno-34-46"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-34-47" name="__codelineno-34-47" href="#__codelineno-34-47"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">                     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">               </span>
<a id="__codelineno-34-48" name="__codelineno-34-48" href="#__codelineno-34-48"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARD-FILE</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">                 </span>
<a id="__codelineno-34-49" name="__codelineno-34-49" href="#__codelineno-34-49"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">                 </span>
<a id="__codelineno-34-50" name="__codelineno-34-50" href="#__codelineno-34-50"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">                </span>
<a id="__codelineno-34-51" name="__codelineno-34-51" href="#__codelineno-34-51"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">               </span>
<a id="__codelineno-34-52" name="__codelineno-34-52" href="#__codelineno-34-52"></a><span class="c">      </span><span class="w">            </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">9100</span><span class="o">-</span><span class="nv">READ-BACKWARDS-EXIT</span><span class="w">                                </span>
<a id="__codelineno-34-53" name="__codelineno-34-53" href="#__codelineno-34-53"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-34-54" name="__codelineno-34-54" href="#__codelineno-34-54"></a>
<a id="__codelineno-34-55" name="__codelineno-34-55" href="#__codelineno-34-55"></a><span class="kr">          </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="kp">UNTIL</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">                                         </span>
<a id="__codelineno-34-56" name="__codelineno-34-56" href="#__codelineno-34-56"></a>
<a id="__codelineno-34-57" name="__codelineno-34-57" href="#__codelineno-34-57"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="nv">READPREV</span><span class="w">                                                   </span>
<a id="__codelineno-34-58" name="__codelineno-34-58" href="#__codelineno-34-58"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-34-59" name="__codelineno-34-59" href="#__codelineno-34-59"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO </span><span class="p">(</span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                              </span>
<a id="__codelineno-34-60" name="__codelineno-34-60" href="#__codelineno-34-60"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-RECORD</span><span class="p">)</span><span class="w">                                   </span>
<a id="__codelineno-34-61" name="__codelineno-34-61" href="#__codelineno-34-61"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="p">(</span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                                     </span>
<a id="__codelineno-34-62" name="__codelineno-34-62" href="#__codelineno-34-62"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-CARD-RID-CARDNUM</span><span class="p">)</span><span class="w">                        </span>
<a id="__codelineno-34-63" name="__codelineno-34-63" href="#__codelineno-34-63"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span><span class="w">                                                </span>
<a id="__codelineno-34-64" name="__codelineno-34-64" href="#__codelineno-34-64"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span><span class="w">                                               </span>
<a id="__codelineno-34-65" name="__codelineno-34-65" href="#__codelineno-34-65"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-34-66" name="__codelineno-34-66" href="#__codelineno-34-66"></a>
<a id="__codelineno-34-67" name="__codelineno-34-67" href="#__codelineno-34-67"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                                                  </span>
<a id="__codelineno-34-68" name="__codelineno-34-68" href="#__codelineno-34-68"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-34-69" name="__codelineno-34-69" href="#__codelineno-34-69"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">DUPREC</span><span class="p">)</span><span class="w">                                             </span>
<a id="__codelineno-34-70" name="__codelineno-34-70" href="#__codelineno-34-70"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9500</span><span class="o">-</span><span class="nv">FILTER-RECORDS</span><span class="w">                                  </span>
<a id="__codelineno-34-71" name="__codelineno-34-71" href="#__codelineno-34-71"></a><span class="c">      </span><span class="w">                </span><span class="kp">THRU</span><span class="w"> </span><span class="mi">9500</span><span class="o">-</span><span class="nv">FILTER-RECORDS-EXIT</span><span class="w">                             </span>
<a id="__codelineno-34-72" name="__codelineno-34-72" href="#__codelineno-34-72"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-DONOT-EXCLUDE-THIS-RECORD</span><span class="w">                              </span>
<a id="__codelineno-34-73" name="__codelineno-34-73" href="#__codelineno-34-73"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">                                             </span>
<a id="__codelineno-34-74" name="__codelineno-34-74" href="#__codelineno-34-74"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ROW-CARD-NUM</span><span class="p">(</span><span class="nv">WS-SCRN-COUNTER</span><span class="p">)</span><span class="w">           </span>
<a id="__codelineno-34-75" name="__codelineno-34-75" href="#__codelineno-34-75"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w">                                         </span>
<a id="__codelineno-34-76" name="__codelineno-34-76" href="#__codelineno-34-76"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ROW-ACCTNO</span><span class="p">(</span><span class="nv">WS-SCRN-COUNTER</span><span class="p">)</span><span class="w">             </span>
<a id="__codelineno-34-77" name="__codelineno-34-77" href="#__codelineno-34-77"></a><span class="c">      </span><span class="w">                </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACTIVE-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-34-78" name="__codelineno-34-78" href="#__codelineno-34-78"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO                                            </span>
<a id="__codelineno-34-79" name="__codelineno-34-79" href="#__codelineno-34-79"></a><span class="kp">                                 </span><span class="w"> </span><span class="nv">WS-ROW-CARD-STATUS</span><span class="p">(</span><span class="nv">WS-SCRN-COUNTER</span><span class="p">)</span><span class="w">           </span>
<a id="__codelineno-34-80" name="__codelineno-34-80" href="#__codelineno-34-80"></a>
<a id="__codelineno-34-81" name="__codelineno-34-81" href="#__codelineno-34-81"></a><span class="c">      </span><span class="w">                </span><span class="kr">SUBTRACT</span><span class="w"> </span><span class="mi">1  </span><span class="kp">FROM</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w">                          </span>
<a id="__codelineno-34-82" name="__codelineno-34-82" href="#__codelineno-34-82"></a><span class="c">      </span><span class="w">                </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-SCRN-COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                                    </span>
<a id="__codelineno-34-83" name="__codelineno-34-83" href="#__codelineno-34-83"></a><span class="mi">                         </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-34-84" name="__codelineno-34-84" href="#__codelineno-34-84"></a>
<a id="__codelineno-34-85" name="__codelineno-34-85" href="#__codelineno-34-85"></a><span class="nb">                        </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w">                                      </span>
<a id="__codelineno-34-86" name="__codelineno-34-86" href="#__codelineno-34-86"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-ACCT-ID</span><span class="w">                   </span>
<a id="__codelineno-34-87" name="__codelineno-34-87" href="#__codelineno-34-87"></a><span class="c">      </span><span class="w">                   </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w">                                          </span>
<a id="__codelineno-34-88" name="__codelineno-34-88" href="#__codelineno-34-88"></a><span class="c">      </span><span class="w">                            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CA-FIRST-CARD-NUM</span><span class="w">                       </span>
<a id="__codelineno-34-89" name="__codelineno-34-89" href="#__codelineno-34-89"></a><span class="c">      </span><span class="w">                </span><span class="kr">ELSE                                                      </span>
<a id="__codelineno-34-90" name="__codelineno-34-90" href="#__codelineno-34-90"></a><span class="kr">                        </span><span class="w"> </span><span class="kr">CONTINUE                                               </span>
<a id="__codelineno-34-91" name="__codelineno-34-91" href="#__codelineno-34-91"></a><span class="kr">                     </span><span class="w"> </span><span class="kr">END-IF                                                    </span>
<a id="__codelineno-34-92" name="__codelineno-34-92" href="#__codelineno-34-92"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">ELSE                                                         </span>
<a id="__codelineno-34-93" name="__codelineno-34-93" href="#__codelineno-34-93"></a><span class="kr">                      </span><span class="w"> </span><span class="kr">CONTINUE                                                 </span>
<a id="__codelineno-34-94" name="__codelineno-34-94" href="#__codelineno-34-94"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">END-IF                                                       </span>
<a id="__codelineno-34-95" name="__codelineno-34-95" href="#__codelineno-34-95"></a>
<a id="__codelineno-34-96" name="__codelineno-34-96" href="#__codelineno-34-96"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                       </span>
<a id="__codelineno-34-97" name="__codelineno-34-97" href="#__codelineno-34-97"></a><span class="kp">      </span><span class="o">*</span><span class="w">           </span><span class="nv">This</span><span class="w"> </span><span class="kp">is</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">kind</span><span class="w"> </span><span class="kp">of</span><span class="w"> </span><span class="kp">error</span><span class="p">.</span><span class="w"> </span><span class="nv">Change</span><span class="w"> </span><span class="kp">to</span><span class="w"> </span><span class="kr">END</span><span class="w"> </span><span class="nv">BR</span><span class="w">                  </span>
<a id="__codelineno-34-98" name="__codelineno-34-98" href="#__codelineno-34-98"></a><span class="c">      *           And exit                                                      </span>
<a id="__codelineno-34-99" name="__codelineno-34-99" href="#__codelineno-34-99"></a><span class="c">      </span><span class="w">            </span><span class="kr">SET</span><span class="w"> </span><span class="nv">READ-LOOP-EXIT</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                        </span>
<a id="__codelineno-34-100" name="__codelineno-34-100" href="#__codelineno-34-100"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;READ&#39;</span><span class="w">                     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-OPNAME</span><span class="w">               </span>
<a id="__codelineno-34-101" name="__codelineno-34-101" href="#__codelineno-34-101"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">LIT-CARD-FILE</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-FILE</span><span class="w">                 </span>
<a id="__codelineno-34-102" name="__codelineno-34-102" href="#__codelineno-34-102"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP</span><span class="w">                 </span>
<a id="__codelineno-34-103" name="__codelineno-34-103" href="#__codelineno-34-103"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-REAS-CD</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERROR-RESP2</span><span class="w">                </span>
<a id="__codelineno-34-104" name="__codelineno-34-104" href="#__codelineno-34-104"></a><span class="c">      </span><span class="w">            </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-FILE-ERROR-MESSAGE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="w">               </span>
<a id="__codelineno-34-105" name="__codelineno-34-105" href="#__codelineno-34-105"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-34-106" name="__codelineno-34-106" href="#__codelineno-34-106"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-PERFORM                                                          </span>
<a id="__codelineno-34-107" name="__codelineno-34-107" href="#__codelineno-34-107"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9100-read-backwards-exit">9100-READ-BACKWARDS-EXIT</h3>
<p>This paragraph terminates a backward browsing operation on the card file. It issues an ENDBR (End Browse) CICS command to release resources associated with the browse operation on the LIT-CARD-FILE, then exits the paragraph. This is typically called after completing a backward navigation through card records to ensure proper cleanup of CICS resources.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w">                                                            </span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c">      </span><span class="w">          </span><span class="nv">ENDBR</span><span class="w"> </span><span class="kr">FILE</span><span class="p">(</span><span class="nv">LIT-CARD-FILE</span><span class="p">)</span><span class="w">                                       </span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT                                                                 </span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9500-filter-records">9500-FILTER-RECORDS</h3>
<p>This paragraph filters credit card records based on user-specified criteria. It first sets a flag indicating the record should be included by default. Then it performs two separate filter checks: first by account ID (if an account filter is active) and then by card number (if a card number filter is active). If either filter is active and the current record doesn't match the filter criteria, the record is marked for exclusion and processing exits the paragraph. If no filters are active or if the record matches all active filter criteria, the record remains included for display in the card listing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c">SET WS</span><span class="o">-</span><span class="nv">DONOT-EXCLUDE-THIS-RECORD</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                             </span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="nb">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-ACCTFILTER-ISVALID</span><span class="w">                                            </span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARD-ACCT-ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">CC-ACCT-ID</span><span class="w">                                     </span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="c">      </span><span class="w">            </span><span class="kr">CONTINUE                                                      </span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="kr">             </span><span class="w"> </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="kr">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-EXCLUDE-THIS-RECORD</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                           </span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">9500</span><span class="o">-</span><span class="nv">FILTER-RECORDS-EXIT</span><span class="w">                                </span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="kr">            </span><span class="w"> </span><span class="kr">CONTINUE                                                           </span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">FLG-CARDFILTER-ISVALID</span><span class="w">                                            </span>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="c">      </span><span class="w">        </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARD-NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">CC-CARD-NUM-N</span><span class="w">                                      </span>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="c">      </span><span class="w">            </span><span class="kr">CONTINUE                                                      </span>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="kr">             </span><span class="w"> </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="kr">                 </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">WS-EXCLUDE-THIS-RECORD</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE                            </span>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="nb">                 </span><span class="w"> </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="mi">9500</span><span class="o">-</span><span class="nv">FILTER-RECORDS-EXIT</span><span class="w">                                </span>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a><span class="kr">            </span><span class="w"> </span><span class="kr">CONTINUE                                                           </span>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a><span class="kr">           </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9500-filter-records-exit">9500-FILTER-RECORDS-EXIT</h3>
<p>This paragraph serves as an exit point for the record filtering process in the COCRDLIC program. It includes a copybook 'CSSTRPFY' which contains common code for storing PF key information when the user exits this section of the program. The comment at the end warns that this is a plain text exit that should not be used in production environments, suggesting it may lack proper security measures or error handling needed for production code.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="c">      *****************************************************************</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="c">      *Common code to store PFKey                                      </span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="c">      *****************************************************************</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY </span><span class="s1">&#39;CSSTRPFY&#39;</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="c">      * Plain text exit - Dont use in production                      *         </span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="send-plain-text">SEND-PLAIN-TEXT</h3>
<p>This paragraph sends an error message to the user's terminal screen using CICS commands. It displays the contents of WS-ERROR-MSG field, erases the current screen content, frees the keyboard for user input, and then returns control to CICS. This is a standard error handling routine used to communicate issues to the user before terminating the current transaction.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="err">TEXT                                                  </span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="err">                    </span><span class="w"> </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">WS-ERROR-MSG</span><span class="p">)</span><span class="w">                                         </span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="c">      </span><span class="w">               </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-ERROR-MSG</span><span class="p">)</span><span class="w">                             </span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="c">      </span><span class="w">               </span><span class="kp">ERASE                                                      </span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="kp">                    </span><span class="w"> </span><span class="nv">FREEKB</span><span class="w">                                                     </span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="kr">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="send-plain-text-exit">SEND-PLAIN-TEXT-EXIT</h3>
<p>This paragraph serves as an exit point for displaying long text messages, primarily intended for debugging purposes. It is not meant to be used during normal program operation but rather as a diagnostic tool for developers. The comment block clearly indicates this is a specialized function that should be avoided in regular program execution.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="c">      * Display Long text and exit                                    *         </span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="c">      * This is primarily for debugging and should not be used in     *         </span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="c">      * regular course                                                *         </span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="send-long-text">SEND-LONG-TEXT</h3>
<p>This paragraph sends an error or information message to the user interface and terminates the transaction. It uses the CICS SEND TEXT command to display the contents of the WS-LONG-MSG field, clearing the screen (ERASE) and unlocking the keyboard (FREEKB). After displaying the message, it immediately returns control to CICS, effectively ending the current transaction. This is typically used for displaying error messages or important notifications that require the user to acknowledge before continuing with another operation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">SEND</span><span class="w"> </span><span class="err">TEXT                                                  </span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="err">                    </span><span class="w"> </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">WS-LONG-MSG</span><span class="p">)</span><span class="w">                                          </span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="c">      </span><span class="w">               </span><span class="kp">LENGTH</span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">WS-LONG-MSG</span><span class="p">)</span><span class="w">                              </span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="c">      </span><span class="w">               </span><span class="kp">ERASE                                                      </span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="kp">                    </span><span class="w"> </span><span class="nv">FREEKB</span><span class="w">                                                     </span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN                                                     </span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="kr">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="w">                                                             </span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="send-long-text-exit">SEND-LONG-TEXT-EXIT</h3>
<p>This paragraph serves as an exit point for the SEND-LONG-TEXT routine in the COCRDLIC program. It provides a clean termination point for the routine that handles displaying extended text information in the credit card listing interface. The paragraph includes version control information showing this code is part of CardDemo version 1.0-15-g27d6c6f-68, dated July 19, 2022.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c">EXIT  </span><span class="w">                                                               </span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="c">      </span><span class="w">     </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="c">      *</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>