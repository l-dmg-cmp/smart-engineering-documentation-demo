
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="CBACT03C.html">
      
      
        <link rel="next" href="CBCUS01C.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>CBACT04C - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cbact04c" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CBACT04C
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="CBACT04C.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-section" class="md-nav__link">
    <span class="md-ellipsis">
      FILE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-tcatbalf-open" class="md-nav__link">
    <span class="md-ellipsis">
      0000-TCATBALF-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0100-xreffile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0100-XREFFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0200-discgrp-open" class="md-nav__link">
    <span class="md-ellipsis">
      0200-DISCGRP-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0300-acctfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0300-ACCTFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0400-tranfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0400-TRANFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-tcatbalf-get-next" class="md-nav__link">
    <span class="md-ellipsis">
      1000-TCATBALF-GET-NEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1050-update-account" class="md-nav__link">
    <span class="md-ellipsis">
      1050-UPDATE-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-get-acct-data" class="md-nav__link">
    <span class="md-ellipsis">
      1100-GET-ACCT-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1110-get-xref-data" class="md-nav__link">
    <span class="md-ellipsis">
      1110-GET-XREF-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-get-interest-rate" class="md-nav__link">
    <span class="md-ellipsis">
      1200-GET-INTEREST-RATE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-a-get-default-int-rate" class="md-nav__link">
    <span class="md-ellipsis">
      1200-A-GET-DEFAULT-INT-RATE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-compute-interest" class="md-nav__link">
    <span class="md-ellipsis">
      1300-COMPUTE-INTEREST
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-b-write-tx" class="md-nav__link">
    <span class="md-ellipsis">
      1300-B-WRITE-TX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-compute-fees" class="md-nav__link">
    <span class="md-ellipsis">
      1400-COMPUTE-FEES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-tcatbalf-close" class="md-nav__link">
    <span class="md-ellipsis">
      9000-TCATBALF-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-xreffile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9100-XREFFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-discgrp-close" class="md-nav__link">
    <span class="md-ellipsis">
      9200-DISCGRP-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-acctfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9300-ACCTFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9400-tranfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9400-TRANFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-get-db2-format-timestamp" class="md-nav__link">
    <span class="md-ellipsis">
      Z-GET-DB2-FORMAT-TIMESTAMP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9999-abend-program" class="md-nav__link">
    <span class="md-ellipsis">
      9999-ABEND-PROGRAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9910-display-io-status" class="md-nav__link">
    <span class="md-ellipsis">
      9910-DISPLAY-IO-STATUS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDLIC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDSLC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CORPT00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-section" class="md-nav__link">
    <span class="md-ellipsis">
      FILE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0000-tcatbalf-open" class="md-nav__link">
    <span class="md-ellipsis">
      0000-TCATBALF-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0100-xreffile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0100-XREFFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0200-discgrp-open" class="md-nav__link">
    <span class="md-ellipsis">
      0200-DISCGRP-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0300-acctfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0300-ACCTFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0400-tranfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0400-TRANFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-tcatbalf-get-next" class="md-nav__link">
    <span class="md-ellipsis">
      1000-TCATBALF-GET-NEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1050-update-account" class="md-nav__link">
    <span class="md-ellipsis">
      1050-UPDATE-ACCOUNT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-get-acct-data" class="md-nav__link">
    <span class="md-ellipsis">
      1100-GET-ACCT-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1110-get-xref-data" class="md-nav__link">
    <span class="md-ellipsis">
      1110-GET-XREF-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-get-interest-rate" class="md-nav__link">
    <span class="md-ellipsis">
      1200-GET-INTEREST-RATE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1200-a-get-default-int-rate" class="md-nav__link">
    <span class="md-ellipsis">
      1200-A-GET-DEFAULT-INT-RATE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-compute-interest" class="md-nav__link">
    <span class="md-ellipsis">
      1300-COMPUTE-INTEREST
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1300-b-write-tx" class="md-nav__link">
    <span class="md-ellipsis">
      1300-B-WRITE-TX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1400-compute-fees" class="md-nav__link">
    <span class="md-ellipsis">
      1400-COMPUTE-FEES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-tcatbalf-close" class="md-nav__link">
    <span class="md-ellipsis">
      9000-TCATBALF-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-xreffile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9100-XREFFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-discgrp-close" class="md-nav__link">
    <span class="md-ellipsis">
      9200-DISCGRP-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-acctfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9300-ACCTFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9400-tranfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9400-TRANFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-get-db2-format-timestamp" class="md-nav__link">
    <span class="md-ellipsis">
      Z-GET-DB2-FORMAT-TIMESTAMP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9999-abend-program" class="md-nav__link">
    <span class="md-ellipsis">
      9999-ABEND-PROGRAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9910-display-io-status" class="md-nav__link">
    <span class="md-ellipsis">
      9910-DISPLAY-IO-STATUS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cbact04c">CBACT04C</h1>
<h2 id="overview">Overview</h2>
<p>This program, CBACT04C, is a batch COBOL application that calculates interest for credit card accounts. It processes transaction category balances and applies appropriate interest rates based on account groups and transaction types. The program reads account balances from an indexed file, retrieves interest rates from a disclosure group file, calculates monthly interest, updates account balances, and generates interest transaction records.</p>
<p>The program works by sequentially reading transaction category balance records, looking up the associated account and card information, determining the applicable interest rate from a disclosure group file, calculating interest based on that rate, and then writing transaction records for the interest charges. It also updates the account master records with the new balances that include the calculated interest.</p>
<p>Key features include the ability to fall back to default interest rates when specific rates aren't found, handling of multiple transaction categories per account, and proper maintenance of running totals for interest calculations. The program includes comprehensive error handling for file operations and maintains transaction audit trails by generating detailed transaction records for all interest charges.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>CBACT04C</code></p>
<p><strong>Author</strong>: <code>AWS</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    participant Main as Main Program
    participant TCatBal as Transaction Category Balance File
    participant XRef as Cross Reference File
    participant DiscGrp as Disclosure Group File
    participant Acct as Account File
    participant Trans as Transaction File

    Main-&gt;&gt;TCatBal: 0000-TCATBALF-OPEN
    Main-&gt;&gt;XRef: 0100-XREFFILE-OPEN
    Main-&gt;&gt;DiscGrp: 0200-DISCGRP-OPEN
    Main-&gt;&gt;Acct: 0300-ACCTFILE-OPEN
    Main-&gt;&gt;Trans: 0400-TRANFILE-OPEN

    loop Until END-OF-FILE = 'Y'
        Main-&gt;&gt;TCatBal: 1000-TCATBALF-GET-NEXT
        alt Not EOF
            Main-&gt;&gt;Acct: 1100-GET-ACCT-DATA (using FD-ACCT-ID)
            Main-&gt;&gt;XRef: 1110-GET-XREF-DATA (using FD-XREF-ACCT-ID)
            Main-&gt;&gt;DiscGrp: 1200-GET-INTEREST-RATE

            alt Disclosure Group Not Found
                Main-&gt;&gt;DiscGrp: 1200-A-GET-DEFAULT-INT-RATE
            end

            Main-&gt;&gt;Main: 1300-COMPUTE-INTEREST
            Main-&gt;&gt;Trans: 1300-B-WRITE-TX
            Main-&gt;&gt;Acct: 1050-UPDATE-ACCOUNT
        end
    end

    Main-&gt;&gt;TCatBal: 9000-TCATBALF-CLOSE
    Main-&gt;&gt;XRef: 9100-XREFFILE-CLOSE
    Main-&gt;&gt;DiscGrp: 9200-DISCGRP-CLOSE
    Main-&gt;&gt;Acct: 9300-ACCTFILE-CLOSE
    Main-&gt;&gt;Trans: 9400-TRANFILE-CLOSE</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CVACT01Y.html"><code>CVACT01Y</code></a></li>
<li><a href="copybooks/CVTRA05Y.html"><code>CVTRA05Y</code></a></li>
<li><a href="copybooks/CVTRA01Y.html"><code>CVTRA01Y</code></a></li>
<li><a href="copybooks/CVACT03Y.html"><code>CVACT03Y</code></a></li>
<li><a href="copybooks/CVTRA02Y.html"><code>CVTRA02Y</code></a></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="input-output-section">INPUT-OUTPUT SECTION</h3>
<p>This INPUT-OUTPUT SECTION defines the five key files used by the interest calculation program. It includes: 1) TCATBAL-FILE, an indexed file accessed sequentially that contains transaction category balances; 2) XREF-FILE, an indexed file accessed randomly by card number or account ID to cross-reference cards to accounts; 3) ACCOUNT-FILE, an indexed file accessed randomly by account ID to retrieve account information; 4) DISCGRP-FILE, an indexed file accessed randomly to retrieve disclosure group information containing interest rates; and 5) TRANSACT-FILE, a sequential output file where interest transaction records are written. Each file definition includes its organization, access mode, key fields, and associated file status variables for error handling.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c">FILE-C</span><span class="nv">ONTROL</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">TCATBAL-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TCATBALF</span><span class="w">                               </span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">SEQUENTIAL                                    </span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-TRAN-CAT-KEY</span><span class="w">                               </span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO  </span><span class="w"> </span><span class="nv">XREFFILE</span><span class="w">                                </span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">RANDOM                                        </span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-XREF-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c">      </span><span class="w">            </span><span class="nv">ALTERNATE</span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-XREF-ACCT-ID</span><span class="w">                       </span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">ACCOUNT-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCTFILE</span><span class="w">                               </span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">RANDOM                                        </span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-ACCT-ID</span><span class="w">                                    </span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">DISCGRP-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DISCGRP</span><span class="w">                                </span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">RANDOM                                        </span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-DISCGRP-KEY</span><span class="w">                                </span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="p">.</span><span class="w">                               </span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRANSACT</span><span class="w">                              </span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">SEQUENTIAL                                    </span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">SEQUENTIAL                                    </span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="c">      *</span>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="file-section">FILE SECTION</h3>
<p>This File Section defines the file structures used by the CBACT04C program for interest calculation processing. It includes five key files:</p>
<ol>
<li>
<p>TCATBAL-FILE: Contains transaction category balance records with a composite key consisting of account ID, transaction type code, and transaction category code, followed by transaction category data.</p>
</li>
<li>
<p>XREF-FILE: A cross-reference file that maps credit card numbers to customer numbers and account IDs, allowing the program to link transactions to the appropriate accounts.</p>
</li>
<li>
<p>DISCGRP-FILE: Stores disclosure group information with interest rates, keyed by account group ID, transaction type code, and transaction category code. This file provides the interest rates used in calculations.</p>
</li>
<li>
<p>ACCOUNT-FILE: Contains account master records identified by account ID, storing account details and balances that will be updated with calculated interest.</p>
</li>
<li>
<p>TRANSACT-FILE: Used to write interest transaction records generated by the program, with each record containing a transaction ID and associated account data.</p>
</li>
</ol>
<p>These file structures support the program's core functionality of retrieving account balances, looking up applicable interest rates, calculating interest, and recording the resulting transactions.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">FD  TC</span><span class="nv">ATBAL-FILE</span><span class="p">.</span><span class="w">                                                        </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">FD-TRAN-CAT-BAL-RECORD</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-TRAN-CAT-KEY</span><span class="p">.</span><span class="w">                                                  </span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      </span><span class="w">        </span><span class="mi">10 </span><span class="nv">FD-TRANCAT-ACCT-ID</span><span class="w">             </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">      </span><span class="w">        </span><span class="mi">10 </span><span class="nv">FD-TRANCAT-TYPE-CD</span><span class="w">             </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c">      </span><span class="w">        </span><span class="mi">10 </span><span class="nv">FD-TRANCAT-CD</span><span class="w">                  </span><span class="kt">PIC 9(04)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-FD-TRAN-CAT-DATA</span><span class="w">               </span><span class="kt">PIC X(33)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">FD-XREFFILE-REC</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-XREF-CARD-NUM</span><span class="w">                  </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-XREF-CUST-NUM</span><span class="w">                  </span><span class="kt">PIC 9(09)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-XREF-ACCT-ID</span><span class="w">                   </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-XREF-FILLER</span><span class="w">                    </span><span class="kt">PIC X(14)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">DISCGRP-FILE</span><span class="p">.</span><span class="w">                                                        </span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">FD-DISCGRP-REC</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-DISCGRP-KEY</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">        </span><span class="mi">10 </span><span class="nv">FD-DIS-ACCT-GROUP-ID</span><span class="w">           </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">        </span><span class="mi">10 </span><span class="nv">FD-DIS-TRAN-TYPE-CD</span><span class="w">            </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">        </span><span class="mi">10 </span><span class="nv">FD-DIS-TRAN-CAT-CD</span><span class="w">             </span><span class="kt">PIC 9(04)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-DISCGRP-DATA</span><span class="w">                   </span><span class="kt">PIC X(34)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">ACCOUNT-FILE</span><span class="p">.</span><span class="w">                                                        </span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">FD-ACCTFILE-REC</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-ACCT-ID</span><span class="w">                        </span><span class="kt">PIC 9(11)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-ACCT-DATA</span><span class="w">                      </span><span class="kt">PIC X(289)</span><span class="p">.</span><span class="w">                     </span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">FD-TRANFILE-REC</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-TRANS-ID</span><span class="w">                       </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-ACCT-DATA</span><span class="w">                      </span><span class="kt">PIC X(334)</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This Working Storage Section defines the data structures used by the CBACT04C program for interest calculation processing. It includes file status variables for all input/output files (transaction category balances, cross-reference, disclosure group, account master, and transaction files), each with two-byte status fields for error handling. The section incorporates several copybooks (CVTRA01Y, CVACT03Y, CVTRA02Y, CVACT01Y, CVTRA05Y) that likely contain record layouts for the various files processed.</p>
<p>The section also defines utility fields for binary-decimal conversion, application result codes with condition names for normal and end-of-file conditions, timestamp handling structures (with both COBOL and DB2 format representations), and program-specific working variables. These working variables include fields to track the last account number processed, monthly and total interest amounts, a first-time processing indicator, record counters, and a transaction ID suffix generator. These elements support the program's core functionality of calculating and recording interest charges for credit card accounts.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">*****************************************************************         </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TCATBALF-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TCATBALF-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TCATBALF-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT03Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">XREFFILE-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">XREFFILE-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">XREFFILE-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA02Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">DISCGRP-STATUS</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">DISCGRP-STAT1</span><span class="w">        </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">DISCGRP-STAT2</span><span class="w">        </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT01Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">ACCTFILE-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">ACCTFILE-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">ACCTFILE-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA05Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TRANFILE-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TRANFILE-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TRANFILE-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">IO-STATUS</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">IO-STAT1</span><span class="w">            </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">IO-STAT2</span><span class="w">            </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TWO-BYTES-BINARY</span><span class="w">        </span><span class="kt">PIC 9(4)</span><span class="w"> </span><span class="kt">BINARY</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TWO-BYTES-ALPHA</span><span class="w">         </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">TWO-BYTES-BINARY</span><span class="p">.</span><span class="w">                  </span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TWO-BYTES-LEFT</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TWO-BYTES-RIGHT</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">IO-STATUS-04</span><span class="p">.</span><span class="w">                                                        </span>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">IO-STATUS-0401</span><span class="w">      </span><span class="kt">PIC 9  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">IO-STATUS-0403</span><span class="w">      </span><span class="kt">PIC 999</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">APPL-RESULT</span><span class="w">             </span><span class="kt">PIC S9(9)  </span><span class="w"> </span><span class="kt">COMP</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">APPL-AOK</span><span class="w">            </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="c">      </span><span class="w">     </span><span class="mi">88  </span><span class="nv">APPL-EOF</span><span class="w">            </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">16</span><span class="p">.</span><span class="w">                                    </span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">END-OF-FILE</span><span class="w">             </span><span class="kt">PIC X(01)   </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">ABCODE</span><span class="w">                  </span><span class="kt">PIC S9(9)</span><span class="w"> </span><span class="kt">BINARY</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TIMING</span><span class="w">                  </span><span class="kt">PIC S9(9)</span><span class="w"> </span><span class="kt">BINARY</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="c">      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         </span>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">COBOL-TS</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-YYYY</span><span class="w">                  </span><span class="kt">PIC X(04)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-MM</span><span class="w">                    </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-DD</span><span class="w">                    </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-HH</span><span class="w">                    </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-MIN</span><span class="w">                   </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-SS</span><span class="w">                    </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-MIL</span><span class="w">                   </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">COB-REST</span><span class="w">                  </span><span class="kt">PIC X(05)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">DB2-FORMAT-TS</span><span class="w">                </span><span class="kt">PIC X(26)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="kp">FILLER</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">DB2-FORMAT-TS</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-YYYY</span><span class="w">                  </span><span class="kt">PIC X(004)</span><span class="p">.</span><span class="w">                      </span><span class="nf">E      </span>
<a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a><span class="nf">          </span><span class="w"> </span><span class="mi">06 </span><span class="nv">DB2-STREEP-1</span><span class="w">              </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                           </span><span class="o">-</span><span class="w">      </span>
<a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-MM</span><span class="w">                    </span><span class="kt">PIC X(002)</span><span class="p">.</span><span class="w">                      </span><span class="nv">M</span><span class="w">      </span>
<a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-STREEP-2</span><span class="w">              </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                           </span><span class="o">-</span><span class="w">      </span>
<a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-DD</span><span class="w">                    </span><span class="kt">PIC X(002)</span><span class="p">.</span><span class="w">                      </span><span class="nv">D</span><span class="w">      </span>
<a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-STREEP-3</span><span class="w">              </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                           </span><span class="o">-</span><span class="w">      </span>
<a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-HH</span><span class="w">                    </span><span class="kt">PIC X(002)</span><span class="p">.</span><span class="w">                      </span><span class="nv">U</span><span class="w">      </span>
<a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-DOT-1</span><span class="w">                 </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                  </span>
<a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-MIN</span><span class="w">                   </span><span class="kt">PIC X(002)</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-DOT-2</span><span class="w">                 </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                  </span>
<a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-SS</span><span class="w">                    </span><span class="kt">PIC X(002)</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-68" name="__codelineno-2-68" href="#__codelineno-2-68"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-DOT-3</span><span class="w">                 </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                  </span>
<a id="__codelineno-2-69" name="__codelineno-2-69" href="#__codelineno-2-69"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-MIL</span><span class="w">                   </span><span class="kt">PIC 9(002)</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-70" name="__codelineno-2-70" href="#__codelineno-2-70"></a><span class="c">      </span><span class="w">     </span><span class="mi">06 </span><span class="nv">DB2-REST</span><span class="w">                  </span><span class="kt">PIC X(04)</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-2-71" name="__codelineno-2-71" href="#__codelineno-2-71"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-MISC-VARS</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-2-72" name="__codelineno-2-72" href="#__codelineno-2-72"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-LAST-ACCT-NUM</span><span class="w">          </span><span class="kt">PIC X(11)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                 </span>
<a id="__codelineno-2-73" name="__codelineno-2-73" href="#__codelineno-2-73"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-MONTHLY-INT</span><span class="w">            </span><span class="kt">PIC S9(09)V99</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-2-74" name="__codelineno-2-74" href="#__codelineno-2-74"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-TOTAL-INT</span><span class="w">              </span><span class="kt">PIC S9(09)V99</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-2-75" name="__codelineno-2-75" href="#__codelineno-2-75"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-FIRST-TIME</span><span class="w">             </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span><span class="w">                    </span>
<a id="__codelineno-2-76" name="__codelineno-2-76" href="#__codelineno-2-76"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-COUNTERS</span><span class="p">.</span><span class="w">                                                          </span>
<a id="__codelineno-2-77" name="__codelineno-2-77" href="#__codelineno-2-77"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-RECORD-COUNT</span><span class="w">           </span><span class="kt">PIC 9(09)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-2-78" name="__codelineno-2-78" href="#__codelineno-2-78"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-TRANID-SUFFIX</span><span class="w">          </span><span class="kt">PIC 9(06)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="linkage-section">LINKAGE SECTION</h3>
<p>This linkage section defines the external parameters passed to the program. It contains a structure named EXTERNAL-PARMS with two fields: PARM-LENGTH, a 4-digit signed computational field that stores the length of the parameter data, and PARM-DATE, a 10-character field that likely contains the processing date for interest calculations. These parameters allow the calling program to specify the date for which interest should be calculated.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">01  EX</span><span class="nv">TERNAL-PARMS</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">PARM-LENGTH</span><span class="w">         </span><span class="kt">PIC S9(04)</span><span class="w"> </span><span class="kt">COMP</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">PARM-DATE</span><span class="w">           </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                                   </span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="0000-tcatbalf-open">0000-TCATBALF-OPEN</h3>
<p>This paragraph handles the opening of the Transaction Category Balance file for input processing. It sets an initial result code of 8, attempts to open the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the file opens successfully (APPL-AOK condition), processing continues. Otherwise, the paragraph displays an error message about the failed file open operation, calls a routine to display the specific I/O status code, and then aborts the program execution by calling the program termination routine. This ensures proper error handling when the critical transaction category balance file cannot be accessed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">TCATBAL-FILE</span><span class="w">                                              </span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING TRANSACTION CATEGORY BALANCE&#39;</span><span class="w">             </span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0100-xreffile-open">0100-XREFFILE-OPEN</h3>
<p>This paragraph handles the opening of the cross-reference file (XREF-FILE) used in the interest calculation process. It initializes the application result code to 8, attempts to open the file in input mode, and then sets the result code to 0 if successful or 12 if unsuccessful. If the file fails to open (indicated by APPL-AOK being false), the paragraph displays an error message showing the file status, calls a routine to display detailed I/O status information, and then aborts the program execution. This ensures that the program cannot proceed without proper access to the cross-reference data needed for interest calculations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="w">                                                 </span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING CROSS REF FILE&#39;</span><span class="w">   </span><span class="nv">XREFFILE-STATUS</span><span class="w">         </span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0200-discgrp-open">0200-DISCGRP-OPEN</h3>
<p>This paragraph handles the opening of the disclosure group file (DISCGRP-FILE) which contains interest rate information. It initializes the application result code to 8, attempts to open the file in INPUT mode, and then sets the result code to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message (though incorrectly referencing "DALY REJECTS FILE" instead of the disclosure group file), logs the file status code, and abends the program. This is a critical initialization step as the disclosure group file provides the interest rates needed for the program's core interest calculation functionality.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">DISCGRP-FILE</span><span class="w">                                              </span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING DALY REJECTS FILE&#39;</span><span class="w">                        </span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0300-acctfile-open">0300-ACCTFILE-OPEN</h3>
<p>This paragraph handles the opening of the Account Master File in I-O (input-output) mode. It sets an initial result code of 8, attempts to open the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, calls a routine to display the specific I/O status code, and then abends the program. This is a critical error-handling routine since the Account Master File is essential for the interest calculation process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">I-O</span><span class="w"> </span><span class="nv">ACCOUNT-FILE</span><span class="w">                                                </span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING ACCOUNT MASTER FILE&#39;</span><span class="w">                      </span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0400-tranfile-open">0400-TRANFILE-OPEN</h3>
<p>This paragraph handles the opening of the transaction output file. It initializes the application result code to 8, attempts to open the transaction file in output mode, and then sets the result code to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, retrieves the file status code, calls procedures to display the I/O status details and abnormally terminate the program. This is part of the program's initialization process and includes error handling to ensure the transaction file is properly available before proceeding with interest calculations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">OUTPUT</span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="w">                                            </span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING TRANSACTION FILE&#39;</span><span class="w">                         </span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1000-tcatbalf-get-next">1000-TCATBALF-GET-NEXT</h3>
<p>This paragraph reads the next record from the Transaction Category Balance file (TCATBAL-FILE) into the TRAN-CAT-BAL-RECORD structure. It handles three possible outcomes: successful read (status '00'), end-of-file condition (status '10'), or a read error (any other status). For successful reads, processing continues normally. When end-of-file is reached, it sets the END-OF-FILE flag to 'Y'. For any other file status, it displays an error message, calls routines to display the I/O status details, and abends the program. This paragraph is a critical part of the main processing loop that retrieves transaction category balances for interest calculation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">READ T</span><span class="nv">CATBAL-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">TRAN-CAT-BAL-RECORD</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                          </span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="kr">              </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w">                                      </span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">16 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                       </span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c">      </span><span class="w">         </span><span class="kr">ELSE                                                             </span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                       </span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">END-IF                                                           </span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="kr">              </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-EOF</span><span class="w">                                                     </span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">END-OF-FILE</span><span class="w">                                      </span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="c">      </span><span class="w">         </span><span class="kr">ELSE                                                             </span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING TRANSACTION CATEGORY FILE&#39;</span><span class="w">            </span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                            </span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                   </span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="c">      </span><span class="w">         </span><span class="kr">END-IF                                                           </span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1050-update-account">1050-UPDATE-ACCOUNT</h3>
<p>This paragraph updates the account record with the calculated interest charges. It adds the total interest amount (WS-TOTAL-INT) to the current account balance (ACCT-CURR-BAL) and resets the current cycle credit and debit amounts to zero. The updated account record is then rewritten to the account file. If the rewrite operation is successful (status '00'), processing continues normally. Otherwise, the program displays an error message, shows the I/O status code, and terminates abnormally. This paragraph is crucial for maintaining accurate account balances after interest calculations have been applied.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">* Upda</span><span class="nv">te</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">balances</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="nv">account</span><span class="w"> </span><span class="kp">record</span><span class="w"> </span><span class="kp">to</span><span class="w"> </span><span class="nv">reflect</span><span class="w"> </span><span class="nv">posted</span><span class="w"> </span><span class="nv">trans</span><span class="p">.</span><span class="w">          </span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="nv">WS-TOTAL-INT</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCT-CURR-BAL</span><span class="w">                                   </span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCT-CURR-CYC-CREDIT</span><span class="w">                                       </span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACCT-CURR-CYC-DEBIT</span><span class="w">                                        </span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">REWRITE</span><span class="w"> </span><span class="nv">FD-ACCTFILE-REC</span><span class="w"> </span><span class="kp">FROM </span><span class="w"> </span><span class="nv">ACCOUNT-RECORD</span><span class="w">                         </span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                          </span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR RE-WRITING ACCOUNT FILE&#39;</span><span class="w">                          </span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1100-get-acct-data">1100-GET-ACCT-DATA</h3>
<p>This paragraph retrieves account data from the ACCOUNT-FILE using the account ID stored in FD-ACCT-ID. It performs error handling by checking the file status after the read operation. If the account is successfully read (status '00'), processing continues normally. If the account is not found or another error occurs, the paragraph displays an error message, logs the file status, and terminates the program through the 9999-ABEND-PROGRAM routine. This is a critical data retrieval step that ensures the program has valid account information before proceeding with interest calculations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">READ A</span><span class="nv">CCOUNT-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">ACCOUNT-RECORD</span><span class="w">                                </span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c">      </span><span class="w">         </span><span class="kp">INVALID</span><span class="w"> </span><span class="kp">KEY                                                      </span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ACCOUNT NOT FOUND: &#39;</span><span class="w"> </span><span class="nv">FD-ACCT-ID</span><span class="w">                      </span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-READ                                                             </span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                          </span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING ACCOUNT FILE&#39;</span><span class="w">                             </span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1110-get-xref-data">1110-GET-XREF-DATA</h3>
<p>This paragraph retrieves cross-reference data for a credit card account from the XREF-FILE using the account ID as the key. It reads a record into CARD-XREF-RECORD and handles the case when an account is not found by displaying an error message. The paragraph sets APPL-RESULT to 0 for successful reads or 12 for failures. If the read operation fails, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then aborts the program execution. This cross-reference data is essential for linking account information with the appropriate card details during the interest calculation process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">READ X</span><span class="nv">REF-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">CARD-XREF-RECORD</span><span class="w">                                 </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c">      </span><span class="w">      </span><span class="kp">KEY</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-XREF-ACCT-ID</span><span class="w">                                              </span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c">      </span><span class="w">         </span><span class="kp">INVALID</span><span class="w"> </span><span class="kp">KEY                                                      </span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ACCOUNT NOT FOUND: &#39;</span><span class="w"> </span><span class="nv">FD-XREF-ACCT-ID</span><span class="w">                 </span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-READ                                                             </span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                         </span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING XREF FILE&#39;</span><span class="w">                                </span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1200-get-interest-rate">1200-GET-INTEREST-RATE</h3>
<p>This paragraph retrieves the interest rate from the disclosure group file based on the account group ID. It first attempts to read the record from the DISCGRP-FILE. If the record is found (status '00') or not found (status '23'), it sets APPL-RESULT to 0 indicating normal processing. For any other file status, it sets APPL-RESULT to 12, displays an error message, and abends the program after showing the I/O status. When a specific disclosure group record is not found (status '23'), the paragraph switches to using a default group code by setting FD-DIS-ACCT-GROUP-ID to 'DEFAULT' and calling the 1200-A-GET-DEFAULT-INT-RATE paragraph to retrieve the default interest rate. This ensures the program can continue processing even when specific interest rate information is unavailable.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c">READ D</span><span class="nv">ISCGRP-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">DIS-GROUP-RECORD</span><span class="w">                              </span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c">      </span><span class="w">          </span><span class="kp">INVALID</span><span class="w"> </span><span class="kp">KEY                                                     </span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;DISCLOSURE GROUP RECORD MISSING&#39;</span><span class="w">                    </span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c">      </span><span class="w">             </span><span class="kr">DISPLAY </span><span class="s1">&#39;TRY WITH DEFAULT GROUP CODE&#39;</span><span class="w">                        </span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-READ</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">  </span><span class="ow">OR </span><span class="s1">&#39;23&#39;</span><span class="w">                                  </span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING DISCLOSURE GROUP FILE&#39;</span><span class="w">                    </span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;23&#39;</span><span class="w">                                           </span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;DEFAULT&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-DIS-ACCT-GROUP-ID</span><span class="w">                           </span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1200</span><span class="o">-</span><span class="nv">A-GET-DEFAULT-INT-RATE</span><span class="w">                              </span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1200-a-get-default-int-rate">1200-A-GET-DEFAULT-INT-RATE</h3>
<p>This paragraph retrieves the default interest rate from the disclosure group file. It attempts to read a record from the DISCGRP-FILE into the DIS-GROUP-RECORD structure. If the read operation is successful (status '00'), it sets APPL-RESULT to 0 indicating success. If the read fails, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message about failing to read the default disclosure group, calls a routine to display the I/O status code, and then abends the program. This functionality serves as a fallback mechanism when specific interest rates cannot be found for an account.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c">READ D</span><span class="nv">ISCGRP-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">DIS-GROUP-RECORD</span><span class="w">                              </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING DEFAULT DISCLOSURE GROUP&#39;</span><span class="w">                 </span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1300-compute-interest">1300-COMPUTE-INTEREST</h3>
<p>This paragraph calculates the monthly interest for a credit card account based on the transaction category balance and the applicable interest rate. It divides the interest rate by 1200 (converting the annual percentage rate to a monthly decimal rate) and multiplies it by the balance to determine the interest amount. The calculated interest is then added to a running total (WS-TOTAL-INT) to track the cumulative interest across all processed transactions. After calculation, it calls the 1300-B-WRITE-TX paragraph to generate a transaction record for the interest charge.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c">COMPUT</span><span class="nv">E</span><span class="w"> </span><span class="nv">WS-MONTHLY-INT</span><span class="w">                                               </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c">      </span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">TRAN-CAT-BAL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">DIS-INT-RATE</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1200                             </span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="mi">           </span><span class="kr">ADD</span><span class="w"> </span><span class="nv">WS-MONTHLY-INT</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TOTAL-INT</span><span class="w">                                  </span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1300</span><span class="o">-</span><span class="nv">B-WRITE-TX</span><span class="p">.</span><span class="w">                                             </span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1300-b-write-tx">1300-B-WRITE-TX</h3>
<p>This paragraph generates and writes interest transaction records to the transaction file. It first creates a unique transaction ID by concatenating the parameter date with an incremented suffix counter. The paragraph then populates the transaction record with specific values for an interest charge, including setting the transaction type code to '01', category code to '05', and source to 'System'. It constructs a description that includes the account ID, assigns the calculated monthly interest amount, sets the card number from cross-reference data, and obtains a timestamp for both the original and processing timestamps. After writing the record to the transaction file, it performs error handling to verify the write operation was successful, displaying an error message and aborting the program if the write fails. This ensures each interest calculation is properly recorded as a transaction in the system with appropriate audit information.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c">ADD 1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRANID-SUFFIX</span><span class="w">                                            </span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">STRING</span><span class="w"> </span><span class="nv">PARM-DATE</span><span class="p">,</span><span class="w">                                                    </span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c">      </span><span class="w">            </span><span class="nv">WS-TRANID-SUFFIX</span><span class="w">                                              </span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c">      </span><span class="w">       </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE                                                  </span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="kp">            </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="w">                                                       </span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-STRING</span><span class="p">.</span><span class="w">                                                          </span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="s1">&#39;01&#39;</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-TYPE-CD</span><span class="w">                            </span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="s1">&#39;05&#39;</span><span class="w">                 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-CAT-CD</span><span class="w">                             </span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="s1">&#39;System&#39;</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-SOURCE</span><span class="w">                             </span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">STRING </span><span class="s1">&#39;Int. for a/c &#39;</span><span class="w"> </span><span class="p">,</span><span class="w">                                             </span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c">      </span><span class="w">            </span><span class="nv">ACCT-ID</span><span class="w">                                                       </span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="c">      </span><span class="w">            </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE                                             </span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="kp">           </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">TRAN-DESC</span><span class="w">                                                      </span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-STRING                                                           </span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-MONTHLY-INT</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-AMT</span><span class="w">                                </span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0                    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-ID</span><span class="w">                        </span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-NAME</span><span class="w">                      </span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-CITY</span><span class="w">                      </span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-ZIP</span><span class="w">                       </span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREF-CARD-NUM</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-CARD-NUM</span><span class="w">                           </span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">Z-GET-DB2-FORMAT-TIMESTAMP</span><span class="w">                                   </span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DB2-FORMAT-TS</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-ORIG-TS</span><span class="w">                            </span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DB2-FORMAT-TS</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-PROC-TS</span><span class="w">                            </span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">WRITE</span><span class="w"> </span><span class="nv">FD-TRANFILE-REC</span><span class="w"> </span><span class="kp">FROM</span><span class="w"> </span><span class="nv">TRAN-RECORD</span><span class="w">                               </span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                         </span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR WRITING TRANSACTION RECORD&#39;</span><span class="w">                       </span>
<a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                              </span>
<a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>
<a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1400-compute-fees">1400-COMPUTE-FEES</h3>
<p>This paragraph is a placeholder for future functionality related to fee computation. It currently contains only an EXIT statement with a comment indicating that the fee calculation logic is yet to be implemented. This suggests that while the program currently handles interest calculations, the capability to compute additional fees has been identified as a requirement but not yet developed.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c">* To b</span><span class="nv">e</span><span class="w"> </span><span class="nv">implemented</span><span class="w">                                                       </span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9000-tcatbalf-close">9000-TCATBALF-CLOSE</h3>
<p>This paragraph handles the closing of the Transaction Category Balance file (TCATBAL-FILE). It sets an initial result code of 8, attempts to close the file, and then checks the status. If the file closes successfully (status '00'), it sets the result code to 0. If the close operation fails, it sets the result code to 12. When an error occurs, the paragraph displays an error message, captures the file status code, displays the I/O status details, and aborts the program execution. This is part of the program's cleanup and error handling mechanism to ensure proper file closure before program termination.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO </span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                              </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">TCATBAL-FILE</span><span class="w">                                                   </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO </span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING TRANSACTION BALANCE FILE&#39;</span><span class="w">                 </span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TCATBALF-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9100-xreffile-close">9100-XREFFILE-CLOSE</h3>
<p>This paragraph handles the closing of the cross-reference file (XREF-FILE) with error handling. It sets an initial result code of 8, attempts to close the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the close operation fails, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then aborts the program execution. This ensures proper file closure and appropriate error handling for maintaining data integrity.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="w">                                                      </span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING CROSS REF FILE&#39;</span><span class="w">                           </span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREFFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9200-discgrp-close">9200-DISCGRP-CLOSE</h3>
<p>This paragraph handles the closing of the Disclosure Group file, which contains interest rate information used in the credit card interest calculation process. It sets an initial result code of 8, attempts to close the file, and then updates the result code based on the operation's success (0) or failure (12). If the file closes successfully, processing continues; otherwise, the paragraph displays an error message about the Disclosure Group file closure failure, calls a routine to display the specific I/O status code, and then aborts the program execution by calling the program termination routine. This error handling ensures that any file closure issues are properly identified and logged before program termination.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">DISCGRP-FILE</span><span class="w">                                                   </span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING DISCLOSURE GROUP FILE&#39;</span><span class="w">                    </span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DISCGRP-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9300-acctfile-close">9300-ACCTFILE-CLOSE</h3>
<p>This paragraph handles the closing of the Account File with error handling. It initially sets a result code of 8, attempts to close the file, and then sets the result to 0 if successful or 12 if unsuccessful. If the close operation fails, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper file closure and provides meaningful error information if the operation fails.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">ACCOUNT-FILE</span><span class="w">                                                   </span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                          </span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING ACCOUNT FILE&#39;</span><span class="w">                             </span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">ACCTFILE-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9400-tranfile-close">9400-TRANFILE-CLOSE</h3>
<p>This paragraph handles the closing of the transaction file and performs error handling. It sets an initial result code of 8, attempts to close the TRANSACT-FILE, and then sets the result code to 0 if successful or 12 if unsuccessful. If the close operation fails (APPL-AOK is false), it displays an error message, captures the file status code, displays the I/O status details, and aborts the program execution. The paragraph ensures proper file closure and appropriate error handling for transaction file operations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="w">                                                  </span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                          </span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING TRANSACTION FILE&#39;</span><span class="w">                         </span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                               </span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="z-get-db2-format-timestamp">Z-GET-DB2-FORMAT-TIMESTAMP</h3>
<p>This paragraph retrieves the current system date and time and formats it into a DB2-compatible timestamp format. It first obtains the current date using the FUNCTION CURRENT-DATE intrinsic function, then maps individual components (year, month, day, hour, minute, second, millisecond) from the COBOL timestamp structure to the corresponding DB2 timestamp fields. The paragraph adds necessary formatting characters like hyphens and decimal points to create a properly formatted DB2 timestamp, and sets the microsecond portion to zeros. This formatted timestamp is likely used for transaction logging or database operations within the credit card interest calculation process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c">MOVE F</span><span class="nv">UNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COBOL-TS</span><span class="w">                               </span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-YYYY</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-YYYY</span><span class="w">                                            </span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-MM</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-MM</span><span class="w">                                              </span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-DD</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-DD</span><span class="w">                                              </span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-HH</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-HH</span><span class="w">                                              </span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-MIN</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-MIN</span><span class="w">                                             </span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-SS</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-SS</span><span class="w">                                              </span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">COB-MIL</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-MIL</span><span class="w">                                             </span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="s1">&#39;0000&#39;</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-REST</span><span class="w">                                            </span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-STREEP-1</span><span class="w"> </span><span class="nv">DB2-STREEP-2</span><span class="w"> </span><span class="nv">DB2-STREEP-3</span><span class="w">                   </span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DB2-DOT-1</span><span class="w"> </span><span class="nv">DB2-DOT-2</span><span class="w"> </span><span class="nv">DB2-DOT-3</span><span class="w">                            </span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="c">      *    DISPLAY &#39;DB2-TIMESTAMP = &#39; DB2-FORMAT-TS                             </span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9999-abend-program">9999-ABEND-PROGRAM</h3>
<p>This paragraph handles abnormal program termination by displaying an "ABENDING PROGRAM" message, resetting the timing variable to zero, setting an abend code of 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program abort. This is likely used as a last resort error handling mechanism when the program encounters a critical error that prevents further processing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c">DISPLA</span><span class="nv">Y</span><span class="w"> </span><span class="s1">&#39;ABENDING PROGRAM&#39;</span><span class="w">                                           </span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TIMING</span><span class="w">                                                     </span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">999 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABCODE</span><span class="w">                                                   </span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">CALL </span><span class="s1">&#39;CEE3ABD&#39;</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="9910-display-io-status">9910-DISPLAY-IO-STATUS</h3>
<p>This paragraph handles the formatting and display of file I/O status codes for error reporting. When an I/O operation encounters an issue, this routine formats the status code for consistent display. It has special handling for extended file status codes (where the first digit is '9'), converting the second byte to a binary value for proper representation. For standard file status codes, it formats them within a 4-character field. In both cases, the formatted status code is displayed with a descriptive prefix. This routine helps with troubleshooting by providing standardized error reporting for file operations throughout the program.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c">IF  IO</span><span class="o">-</span><span class="nv">STATUS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                            </span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="kp">          </span><span class="w"> </span><span class="ow">OR </span><span class="w"> </span><span class="nv">IO-STAT1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;9&#39;</span><span class="w">                                                   </span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">IO-STAT1</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TWO-BYTES-BINARY</span><span class="w">                                </span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">IO-STAT2</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TWO-BYTES-RIGHT</span><span class="w">                                 </span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TWO-BYTES-BINARY</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-0403</span><span class="w">                          </span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="c">      </span><span class="w">         </span><span class="kr">DISPLAY </span><span class="s1">&#39;FILE STATUS IS: NNNN&#39;</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="w">                      </span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;0000&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="w">                                      </span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">                              </span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="c">      </span><span class="w">         </span><span class="kr">DISPLAY </span><span class="s1">&#39;FILE STATUS IS: NNNN&#39;</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="w">                      </span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="c">      *</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT</span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>