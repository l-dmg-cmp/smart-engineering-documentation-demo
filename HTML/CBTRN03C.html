
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="CBTRN02C.html">
      
      
        <link rel="next" href="COACTUPC.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>CBTRN03C - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cbtrn03c" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CBTRN03C
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT04C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="CBTRN03C.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-section" class="md-nav__link">
    <span class="md-ellipsis">
      FILE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0550-dateparm-read" class="md-nav__link">
    <span class="md-ellipsis">
      0550-DATEPARM-READ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-tranfile-get-next" class="md-nav__link">
    <span class="md-ellipsis">
      1000-TRANFILE-GET-NEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-write-transaction-report" class="md-nav__link">
    <span class="md-ellipsis">
      1100-WRITE-TRANSACTION-REPORT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1110-write-page-totals" class="md-nav__link">
    <span class="md-ellipsis">
      1110-WRITE-PAGE-TOTALS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1120-write-account-totals" class="md-nav__link">
    <span class="md-ellipsis">
      1120-WRITE-ACCOUNT-TOTALS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1110-write-grand-totals" class="md-nav__link">
    <span class="md-ellipsis">
      1110-WRITE-GRAND-TOTALS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1120-write-headers" class="md-nav__link">
    <span class="md-ellipsis">
      1120-WRITE-HEADERS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1111-write-report-rec" class="md-nav__link">
    <span class="md-ellipsis">
      1111-WRITE-REPORT-REC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1120-write-detail" class="md-nav__link">
    <span class="md-ellipsis">
      1120-WRITE-DETAIL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-tranfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0000-TRANFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0100-reptfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0100-REPTFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0200-cardxref-open" class="md-nav__link">
    <span class="md-ellipsis">
      0200-CARDXREF-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0300-trantype-open" class="md-nav__link">
    <span class="md-ellipsis">
      0300-TRANTYPE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0400-trancatg-open" class="md-nav__link">
    <span class="md-ellipsis">
      0400-TRANCATG-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0500-dateparm-open" class="md-nav__link">
    <span class="md-ellipsis">
      0500-DATEPARM-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-a-lookup-xref" class="md-nav__link">
    <span class="md-ellipsis">
      1500-A-LOOKUP-XREF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-b-lookup-trantype" class="md-nav__link">
    <span class="md-ellipsis">
      1500-B-LOOKUP-TRANTYPE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-c-lookup-trancatg" class="md-nav__link">
    <span class="md-ellipsis">
      1500-C-LOOKUP-TRANCATG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-tranfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9000-TRANFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-reptfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9100-REPTFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-cardxref-close" class="md-nav__link">
    <span class="md-ellipsis">
      9200-CARDXREF-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-trantype-close" class="md-nav__link">
    <span class="md-ellipsis">
      9300-TRANTYPE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9400-trancatg-close" class="md-nav__link">
    <span class="md-ellipsis">
      9400-TRANCATG-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9500-dateparm-close" class="md-nav__link">
    <span class="md-ellipsis">
      9500-DATEPARM-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9999-abend-program" class="md-nav__link">
    <span class="md-ellipsis">
      9999-ABEND-PROGRAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9910-display-io-status" class="md-nav__link">
    <span class="md-ellipsis">
      9910-DISPLAY-IO-STATUS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDLIC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDSLC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CORPT00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-output-section" class="md-nav__link">
    <span class="md-ellipsis">
      INPUT-OUTPUT SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-section" class="md-nav__link">
    <span class="md-ellipsis">
      FILE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0550-dateparm-read" class="md-nav__link">
    <span class="md-ellipsis">
      0550-DATEPARM-READ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1000-tranfile-get-next" class="md-nav__link">
    <span class="md-ellipsis">
      1000-TRANFILE-GET-NEXT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1100-write-transaction-report" class="md-nav__link">
    <span class="md-ellipsis">
      1100-WRITE-TRANSACTION-REPORT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1110-write-page-totals" class="md-nav__link">
    <span class="md-ellipsis">
      1110-WRITE-PAGE-TOTALS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1120-write-account-totals" class="md-nav__link">
    <span class="md-ellipsis">
      1120-WRITE-ACCOUNT-TOTALS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1110-write-grand-totals" class="md-nav__link">
    <span class="md-ellipsis">
      1110-WRITE-GRAND-TOTALS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1120-write-headers" class="md-nav__link">
    <span class="md-ellipsis">
      1120-WRITE-HEADERS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1111-write-report-rec" class="md-nav__link">
    <span class="md-ellipsis">
      1111-WRITE-REPORT-REC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1120-write-detail" class="md-nav__link">
    <span class="md-ellipsis">
      1120-WRITE-DETAIL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0000-tranfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0000-TRANFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0100-reptfile-open" class="md-nav__link">
    <span class="md-ellipsis">
      0100-REPTFILE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0200-cardxref-open" class="md-nav__link">
    <span class="md-ellipsis">
      0200-CARDXREF-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0300-trantype-open" class="md-nav__link">
    <span class="md-ellipsis">
      0300-TRANTYPE-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0400-trancatg-open" class="md-nav__link">
    <span class="md-ellipsis">
      0400-TRANCATG-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0500-dateparm-open" class="md-nav__link">
    <span class="md-ellipsis">
      0500-DATEPARM-OPEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-a-lookup-xref" class="md-nav__link">
    <span class="md-ellipsis">
      1500-A-LOOKUP-XREF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-b-lookup-trantype" class="md-nav__link">
    <span class="md-ellipsis">
      1500-B-LOOKUP-TRANTYPE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1500-c-lookup-trancatg" class="md-nav__link">
    <span class="md-ellipsis">
      1500-C-LOOKUP-TRANCATG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9000-tranfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9000-TRANFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9100-reptfile-close" class="md-nav__link">
    <span class="md-ellipsis">
      9100-REPTFILE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9200-cardxref-close" class="md-nav__link">
    <span class="md-ellipsis">
      9200-CARDXREF-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9300-trantype-close" class="md-nav__link">
    <span class="md-ellipsis">
      9300-TRANTYPE-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9400-trancatg-close" class="md-nav__link">
    <span class="md-ellipsis">
      9400-TRANCATG-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9500-dateparm-close" class="md-nav__link">
    <span class="md-ellipsis">
      9500-DATEPARM-CLOSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9999-abend-program" class="md-nav__link">
    <span class="md-ellipsis">
      9999-ABEND-PROGRAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9910-display-io-status" class="md-nav__link">
    <span class="md-ellipsis">
      9910-DISPLAY-IO-STATUS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cbtrn03c">CBTRN03C</h1>
<h2 id="overview">Overview</h2>
<p>This batch COBOL program (CBTRN03C) generates a transaction detail report for the CardDemo application. The program reads transaction records from a sequential file and filters them based on a date range specified in a parameter file. For each transaction within the date range, it looks up additional information from three indexed files: a card cross-reference file to get account information, a transaction type file for transaction descriptions, and a transaction category file for category descriptions. The program organizes the report by card number, calculating and displaying page totals, account totals, and grand totals for transaction amounts. The report includes transaction details such as transaction ID, account ID, transaction type, category, source, and amount. Error handling is implemented throughout the program to manage file access issues and invalid data conditions.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>CBTRN03C</code></p>
<p><strong>Author</strong>: <code>AWS</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    participant Main as Main Program
    participant DateParm as Date Parameters File
    participant TranFile as Transaction File
    participant XrefFile as Card Cross-Reference File
    participant TypeFile as Transaction Type File
    participant CatgFile as Transaction Category File
    participant ReptFile as Report File

    Main-&gt;&gt;DateParm: 0500-DATEPARM-OPEN
    Main-&gt;&gt;TranFile: 0000-TRANFILE-OPEN
    Main-&gt;&gt;XrefFile: 0200-CARDXREF-OPEN
    Main-&gt;&gt;TypeFile: 0300-TRANTYPE-OPEN
    Main-&gt;&gt;CatgFile: 0400-TRANCATG-OPEN
    Main-&gt;&gt;ReptFile: 0100-REPTFILE-OPEN

    Main-&gt;&gt;DateParm: 0550-DATEPARM-READ
    DateParm--&gt;&gt;Main: Return date range parameters

    rect rgb(240, 240, 240)
        Note over Main,ReptFile: Main Processing Loop
        loop Until End-Of-File
            Main-&gt;&gt;TranFile: 1000-TRANFILE-GET-NEXT
            TranFile--&gt;&gt;Main: Return transaction record

            alt Transaction date within range
                Main-&gt;&gt;XrefFile: 1500-A-LOOKUP-XREF
                XrefFile--&gt;&gt;Main: Return account information

                Main-&gt;&gt;TypeFile: 1500-B-LOOKUP-TRANTYPE
                TypeFile--&gt;&gt;Main: Return transaction type description

                Main-&gt;&gt;CatgFile: 1500-C-LOOKUP-TRANCATG
                CatgFile--&gt;&gt;Main: Return category description

                alt First transaction or new card number
                    Main-&gt;&gt;ReptFile: 1120-WRITE-HEADERS
                end

                alt Page limit reached
                    Main-&gt;&gt;ReptFile: 1110-WRITE-PAGE-TOTALS
                    Main-&gt;&gt;ReptFile: 1120-WRITE-HEADERS
                end

                alt New account number
                    Main-&gt;&gt;ReptFile: 1120-WRITE-ACCOUNT-TOTALS
                end

                Main-&gt;&gt;ReptFile: 1120-WRITE-DETAIL
            end
        end
    end

    Main-&gt;&gt;ReptFile: 1110-WRITE-PAGE-TOTALS
    Main-&gt;&gt;ReptFile: 1110-WRITE-GRAND-TOTALS

    Main-&gt;&gt;DateParm: 9500-DATEPARM-CLOSE
    Main-&gt;&gt;TranFile: 9000-TRANFILE-CLOSE
    Main-&gt;&gt;XrefFile: 9200-CARDXREF-CLOSE
    Main-&gt;&gt;TypeFile: 9300-TRANTYPE-CLOSE
    Main-&gt;&gt;CatgFile: 9400-TRANCATG-CLOSE
    Main-&gt;&gt;ReptFile: 9100-REPTFILE-CLOSE</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CVTRA05Y.html"><code>CVTRA05Y</code></a></li>
<li><a href="copybooks/CVTRA04Y.html"><code>CVTRA04Y</code></a></li>
<li><a href="copybooks/CVTRA07Y.html"><code>CVTRA07Y</code></a></li>
<li><a href="copybooks/CVACT03Y.html"><code>CVACT03Y</code></a></li>
<li><a href="copybooks/CVTRA03Y.html"><code>CVTRA03Y</code></a></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="input-output-section">INPUT-OUTPUT SECTION</h3>
<p>This section defines the file control entries for the transaction report program. It specifies five files: a sequential transaction file (TRANSACT-FILE) that contains the source transaction data, three indexed files accessed randomly - a card cross-reference file (XREF-FILE) for account lookups, a transaction type file (TRANTYPE-FILE) for transaction descriptions, and a transaction category file (TRANCATG-FILE) for category information. It also defines a sequential report output file (REPORT-FILE) and a sequential date parameters file (DATE-PARMS-FILE) that likely contains the date range criteria for filtering transactions. Each file has an associated file status variable for error handling.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c">FILE-C</span><span class="nv">ONTROL</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRANFILE</span><span class="w">                              </span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">SEQUENTIAL                                    </span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDXREF</span><span class="w">                                  </span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">RANDOM                                        </span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-XREF-CARD-NUM</span><span class="w">                              </span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">CARDXREF-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">TRANTYPE-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRANTYPE</span><span class="w">                              </span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">RANDOM                                        </span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-TRAN-TYPE</span><span class="w">                                  </span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">TRANTYPE-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">TRANCATG-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRANCATG</span><span class="w">                              </span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">INDEXED                                       </span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">ACCESS</span><span class="w"> </span><span class="kp">MODE </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">RANDOM                                        </span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="kp">                 </span><span class="w"> </span><span class="kp">RECORD</span><span class="w"> </span><span class="kp">KEY  </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">FD-TRAN-CAT-KEY</span><span class="w">                               </span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c">      </span><span class="w">            </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">TRANCATG-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">REPORT-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRANREPT</span><span class="w">                                </span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">SEQUENTIAL                                    </span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="c">      </span><span class="w">     </span><span class="kp">SELECT</span><span class="w"> </span><span class="nv">DATE-PARMS-FILE</span><span class="w"> </span><span class="kp">ASSIGN</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">DATEPARM</span><span class="w">                            </span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="c">      </span><span class="w">            </span><span class="kp">ORGANIZATION</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="kp">SEQUENTIAL                                    </span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="kp">                 </span><span class="w"> </span><span class="kr">FILE</span><span class="w"> </span><span class="kp">STATUS </span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="p">.</span><span class="w">                              </span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="c">      *</span>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="file-section">FILE SECTION</h3>
<p>This File Section defines the file structures used in the CBTRN03C program for generating transaction reports. It includes six file definitions: TRANSACT-FILE for transaction records with a 350-byte structure containing transaction data and timestamp; XREF-FILE for card cross-reference records with card number and related data; TRANTYPE-FILE for transaction type lookup with type code and descriptive data; TRANCATG-FILE for transaction category information with composite keys (type code and category code); REPORT-FILE for the 133-byte output report records; and DATE-PARMS-FILE for reading the 80-byte date range parameters that control which transactions are included in the report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">FD  TR</span><span class="nv">ANSACT-FILE</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">FD-TRANFILE-REC</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">FD-TRANS-DATA</span><span class="w">      </span><span class="kt">PIC X(304)</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">FD-TRAN-PROC-TS</span><span class="w">    </span><span class="kt">PIC X(26)</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">FD-FILLER</span><span class="w">          </span><span class="kt">PIC X(20)</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">FD-CARDXREF-REC</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-XREF-CARD-NUM</span><span class="w">                  </span><span class="kt">PIC X(16)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">FD-XREF-DATA</span><span class="w">                      </span><span class="kt">PIC X(34)</span><span class="p">.</span><span class="w">                      </span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">TRANTYPE-FILE</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">FD-TRANTYPE-REC</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">FD-TRAN-TYPE</span><span class="w">       </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">FD-TRAN-DATA</span><span class="w">       </span><span class="kt">PIC X(58)</span><span class="p">.</span><span class="w">                                      </span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">TRANCATG-FILE</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">FD-TRAN-CAT-RECORD</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">FD-TRAN-CAT-KEY</span><span class="p">.</span><span class="w">                                                 </span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">        </span><span class="mi">10  </span><span class="nv">FD-TRAN-TYPE-CD</span><span class="w">                         </span><span class="kt">PIC X(02)</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">        </span><span class="mi">10  </span><span class="nv">FD-TRAN-CAT-CD</span><span class="w">                          </span><span class="kt">PIC 9(04)</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">FD-TRAN-CAT-DATA</span><span class="w">                           </span><span class="kt">PIC X(54)</span><span class="p">.</span><span class="w">            </span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">REPORT-FILE</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">FD-REPTFILE-REC</span><span class="w">       </span><span class="kt">PIC X(133)</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">      </span><span class="w"> </span><span class="kr">FD </span><span class="w"> </span><span class="nv">DATE-PARMS-FILE</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">FD-DATEPARM-REC</span><span class="w">       </span><span class="kt">PIC X(80)</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This Working-Storage section defines the data structures used by the CBTRN03C transaction report program. It includes file status variables for all input and output files (transaction file, card cross-reference file, transaction type file, transaction category file, report file, and date parameter file). The section incorporates several copybooks (CVTRA05Y, CVACT03Y, CVTRA03Y, CVTRA04Y, CVTRA07Y) that likely contain record layouts for these files. It defines a structure for the date parameter record that stores the start and end dates for filtering transactions. Report-specific variables track page formatting (line counter, page size), financial totals (page total, account total, grand total), and the current card number being processed. Additional utility fields are defined for I/O status handling, binary data manipulation, and program flow control, including end-of-file indicators and application result codes.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">*****************************************************************         </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA05Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">TRANFILE-STATUS</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">TRANFILE-STAT1</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">TRANFILE-STAT2</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT03Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">CARDXREF-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">CARDXREF-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">CARDXREF-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA03Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TRANTYPE-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TRANTYPE-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TRANTYPE-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA04Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="c">      </span><span class="w"> </span><span class="mi">01  </span><span class="nv">TRANCATG-STATUS</span><span class="p">.</span><span class="w">                                                     </span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TRANCATG-STAT1</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="c">      </span><span class="w">     </span><span class="mi">05  </span><span class="nv">TRANCATG-STAT2</span><span class="w">      </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                       </span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA07Y</span><span class="p">.</span><span class="w">                                                           </span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">TRANREPT-STATUS</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">REPTFILE-STAT1</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">REPTFILE-STAT2</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">DATEPARM-STATUS</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">DATEPARM-STAT1</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">DATEPARM-STAT2</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                         </span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-DATEPARM-RECORD</span><span class="p">.</span><span class="w">                                                   </span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-START-DATE</span><span class="w">      </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="kp">FILLER            </span><span class="w"> </span><span class="kt">PIC X(01)</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-END-DATE</span><span class="w">        </span><span class="kt">PIC X(10)</span><span class="p">.</span><span class="w">                                     </span>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">WS-REPORT-VARS</span><span class="p">.</span><span class="w">                                                       </span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-FIRST-TIME</span><span class="w">      </span><span class="kt">PIC X     </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span><span class="w">                          </span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-LINE-COUNTER</span><span class="w">    </span><span class="kt">PIC 9(09)</span><span class="w"> </span><span class="kt">COMP-3                               </span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="kt">                                           </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-PAGE-SIZE</span><span class="w">       </span><span class="kt">PIC 9(03)</span><span class="w"> </span><span class="kt">COMP-3                               </span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a><span class="kt">                                           </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">20</span><span class="p">.</span><span class="w">                           </span>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-BLANK-LINE</span><span class="w">      </span><span class="kt">PIC X(133)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                       </span>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-PAGE-TOTAL</span><span class="w">      </span><span class="kt">PIC S9(09)V99</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                         </span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-ACCOUNT-TOTAL</span><span class="w">   </span><span class="kt">PIC S9(09)V99</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                         </span>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-GRAND-TOTAL</span><span class="w">     </span><span class="kt">PIC S9(09)V99</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                         </span>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a><span class="c">      </span><span class="w">     </span><span class="mi">05 </span><span class="nv">WS-CURR-CARD-NUM</span><span class="w">   </span><span class="kt">PIC X(16)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span><span class="w">                        </span>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">IO-STATUS</span><span class="p">.</span><span class="w">                                                            </span>
<a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">IO-STAT1</span><span class="w">           </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">IO-STAT2</span><span class="w">           </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">TWO-BYTES-BINARY</span><span class="w">      </span><span class="kt">PIC 9(4)</span><span class="w"> </span><span class="kt">BINARY</span><span class="p">.</span><span class="w">                                </span>
<a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">TWO-BYTES-ALPHA</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">TWO-BYTES-BINARY</span><span class="p">.</span><span class="w">                           </span>
<a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">TWO-BYTES-LEFT</span><span class="w">     </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">TWO-BYTES-RIGHT</span><span class="w">    </span><span class="kt">PIC X</span><span class="p">.</span><span class="w">                                          </span>
<a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">IO-STATUS-04</span><span class="p">.</span><span class="w">                                                         </span>
<a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">IO-STATUS-0401</span><span class="w">     </span><span class="kt">PIC 9     </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">IO-STATUS-0403</span><span class="w">     </span><span class="kt">PIC 999   </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>
<a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">APPL-RESULT</span><span class="w">           </span><span class="kt">PIC S9(9)</span><span class="w"> </span><span class="kt">COMP</span><span class="p">.</span><span class="w">                                 </span>
<a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a><span class="c">      </span><span class="w">    </span><span class="mi">88 </span><span class="nv">APPL-AOK</span><span class="w">                      </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="w">                             </span>
<a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a><span class="c">      </span><span class="w">    </span><span class="mi">88 </span><span class="nv">APPL-EOF</span><span class="w">                      </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">16</span><span class="p">.</span><span class="w">                            </span>
<a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a>
<a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">END-OF-FILE</span><span class="w">           </span><span class="kt">PIC X(01) </span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span><span class="w">                           </span>
<a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">ABCODE</span><span class="w">                </span><span class="kt">PIC S9(9)</span><span class="w"> </span><span class="kt">BINARY</span><span class="p">.</span><span class="w">                               </span>
<a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">TIMING</span><span class="w">                </span><span class="kt">PIC S9(9)</span><span class="w"> </span><span class="kt">BINARY</span><span class="p">.</span><span class="w">                               </span>
<a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a>
<a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="0550-dateparm-read">0550-DATEPARM-READ</h3>
<p>This paragraph reads a date parameter record from the DATE-PARMS-FILE into the WS-DATEPARM-RECORD work area. It evaluates the file status after the read operation: setting APPL-RESULT to 0 for successful reads, 16 for end-of-file conditions, and 12 for other errors. When the read is successful (APPL-AOK), it displays the date range (from WS-START-DATE to WS-END-DATE) that will be used for transaction filtering. If an end-of-file condition occurs, it sets the END-OF-FILE flag to 'Y'. For any other file errors, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then abends the program. This paragraph is crucial for establishing the date parameters that control which transactions will be included in the report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">READ D</span><span class="nv">ATE-PARMS-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">WS-DATEPARM-RECORD</span><span class="w">                         </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="w">                                             </span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c">      </span><span class="w">       </span><span class="kp">WHEN </span><span class="s1">&#39;00&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                          </span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c">      </span><span class="w">       </span><span class="kp">WHEN </span><span class="s1">&#39;10&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">16 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                         </span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c">      </span><span class="w">       </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                         </span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="kp">                </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                         </span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">DISPLAY </span><span class="s1">&#39;Reporting from &#39;</span><span class="w"> </span><span class="nv">WS-START-DATE</span><span class="w">                           </span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c">      </span><span class="w">           </span><span class="s1">&#39; to &#39;</span><span class="w"> </span><span class="nv">WS-END-DATE</span><span class="w">                                             </span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-EOF</span><span class="w">                                                       </span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">END-OF-FILE</span><span class="w">                                        </span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="kr">                </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING DATEPARM FILE&#39;</span><span class="w">                          </span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                              </span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                     </span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="kr">           </span><span class="p">.</span><span class="w">                                                                    </span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="c">      *****************************************************************         </span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="c">      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         </span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="1000-tranfile-get-next">1000-TRANFILE-GET-NEXT</h3>
<p>This paragraph handles the reading of transaction records from the TRANSACT-FILE. It evaluates the file status after each read operation and sets appropriate result codes: 0 for successful reads, 16 for end-of-file conditions, and 12 for other file errors. When a successful read occurs, processing continues normally. When end-of-file is reached, it sets the END-OF-FILE flag to 'Y'. For any other file errors, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This paragraph implements standard file handling with proper error detection and handling to ensure data integrity during report generation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">READ T</span><span class="nv">RANSACT-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">TRAN-RECORD</span><span class="p">.</span><span class="w">                                 </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w">                                             </span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c">      </span><span class="w">       </span><span class="kp">WHEN </span><span class="s1">&#39;00&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                          </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c">      </span><span class="w">       </span><span class="kp">WHEN </span><span class="s1">&#39;10&#39;</span><span class="w">                                                          </span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">16 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                         </span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c">      </span><span class="w">       </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER                                                         </span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="kp">                </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                         </span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE                                                         </span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="kr">             </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-EOF</span><span class="w">                                                       </span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">END-OF-FILE</span><span class="w">                                        </span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="c">      </span><span class="w">        </span><span class="kr">ELSE                                                              </span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="kr">                </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR READING TRANSACTION FILE&#39;</span><span class="w">                       </span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                              </span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                     </span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="c">      </span><span class="w">        </span><span class="kr">END-IF                                                            </span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1100-write-transaction-report">1100-WRITE-TRANSACTION-REPORT</h3>
<p>This paragraph handles the writing of transaction records to the report. It first checks if this is the initial execution (WS-FIRST-TIME = 'Y'), and if so, initializes the report by setting the date range headers and writing the report headers. It then manages pagination by checking if the current line count has reached the page size limit, and if so, writes page totals and new headers. For each transaction, it accumulates the transaction amount into both page and account total accumulators before writing the transaction detail line to the report. The paragraph maintains proper report formatting and running totals throughout the report generation process.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">IF WS-</span><span class="nv">FIRST-TIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Y&#39;</span><span class="w">                                               </span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-FIRST-TIME</span><span class="w">                                         </span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-START-DATE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">REPT-START-DATE</span><span class="w">                             </span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-END-DATE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">REPT-END-DATE</span><span class="w">                                 </span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1120</span><span class="o">-</span><span class="nv">WRITE-HEADERS</span><span class="w">                                        </span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">MOD</span><span class="p">(</span><span class="nv">WS-LINE-COUNTER</span><span class="p">,</span><span class="w"> </span><span class="nv">WS-PAGE-SIZE</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0                   </span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="mi">              </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1110</span><span class="o">-</span><span class="nv">WRITE-PAGE-TOTALS</span><span class="w">                                    </span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1120</span><span class="o">-</span><span class="nv">WRITE-HEADERS</span><span class="w">                                        </span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ADD</span><span class="w"> </span><span class="nv">TRAN-AMT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-PAGE-TOTAL</span><span class="w">                                        </span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c">      </span><span class="w">                     </span><span class="nv">WS-ACCOUNT-TOTAL</span><span class="w">                                     </span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1120</span><span class="o">-</span><span class="nv">WRITE-DETAIL</span><span class="w">                                            </span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1110-write-page-totals">1110-WRITE-PAGE-TOTALS</h3>
<p>This paragraph handles the writing of page total information to the transaction detail report. It moves the accumulated page total to the report line, writes the page totals record to the report file, adds the page total to the running grand total, and then resets the page total to zero for the next page. After writing the page totals, it increments the line counter and writes a transaction header to start the next page of transaction details. The paragraph is part of the report formatting logic that maintains running totals at different levels of the report hierarchy.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">MOVE W</span><span class="nv">S-PAGE-TOTAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">REPT-PAGE-TOTAL</span><span class="w">                                </span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">REPORT-PAGE-TOTALS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                           </span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="nv">WS-PAGE-TOTAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-GRAND-TOTAL</span><span class="w">                                  </span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-PAGE-TOTAL</span><span class="w">                                              </span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANSACTION-HEADER-2</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                         </span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1120-write-account-totals">1120-WRITE-ACCOUNT-TOTALS</h3>
<p>This paragraph writes account total information to the transaction detail report. It formats the current account total amount into the report line, writes it to the report file, and then resets the account total to zero for the next account. After writing the account total line, it increments the line counter and writes a secondary header line to the report to prepare for the next account's transactions. This ensures that each account's transactions are properly summarized and visually separated in the final report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">MOVE W</span><span class="nv">S-ACCOUNT-TOTAL</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">REPT-ACCOUNT-TOTAL</span><span class="w">                        </span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">REPORT-ACCOUNT-TOTALS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                        </span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ACCOUNT-TOTAL</span><span class="w">                                           </span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANSACTION-HEADER-2</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                         </span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1110-write-grand-totals">1110-WRITE-GRAND-TOTALS</h3>
<p>This paragraph writes the grand total amount to the report. It moves the accumulated grand total from the working storage variable WS-GRAND-TOTAL to the report line field REPT-GRAND-TOTAL, then transfers the formatted grand totals line to the report file record area (FD-REPTFILE-REC). It then calls the 1111-WRITE-REPORT-REC paragraph to physically write the record to the report file before exiting.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">MOVE W</span><span class="nv">S-GRAND-TOTAL</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">REPT-GRAND-TOTAL</span><span class="w">                              </span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">REPORT-GRAND-TOTALS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                          </span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1120-write-headers">1120-WRITE-HEADERS</h3>
<p>This paragraph handles the writing of report headers to the transaction detail report. It sequentially writes four lines to the report file: the report name header, a blank line for spacing, and two transaction header lines that likely contain column titles or report metadata. After writing each line, it increments the line counter to track the current position on the page. The paragraph uses the 1111-WRITE-REPORT-REC paragraph to perform the actual writing operation for each line.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">MOVE R</span><span class="nv">EPORT-NAME-HEADER</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                           </span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-BLANK-LINE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                                </span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANSACTION-HEADER-1</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                         </span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANSACTION-HEADER-2</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                         </span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1111-write-report-rec">1111-WRITE-REPORT-REC</h3>
<p>This paragraph handles the writing of records to the report file and implements error handling for the operation. After attempting to write a record to FD-REPTFILE-REC, it checks the status code. If the write operation is successful (status '00'), it sets APPL-RESULT to 0 indicating success. Otherwise, it sets APPL-RESULT to 12 indicating an error. If the application status is not OK (APPL-AOK), it displays an error message, captures the file status code, displays the I/O status details by calling the 9910-DISPLAY-IO-STATUS paragraph, and then terminates the program by calling the 9999-ABEND-PROGRAM paragraph. This ensures that any file writing errors are properly handled and reported before abnormal termination.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">WRITE </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                                                </span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                             </span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="kr">             </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR WRITING REPTFILE&#39;</span><span class="w">                                  </span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                    </span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                        </span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="1120-write-detail">1120-WRITE-DETAIL</h3>
<p>This paragraph formats and writes a single transaction detail line to the report. It initializes the report line structure, then populates it with transaction information including the transaction ID, account ID, type code and description, category code and description, source, and amount. The data is sourced from the transaction record and related lookup files (cross-reference, transaction type, and category files). After formatting the line, it calls the 1111-WRITE-REPORT-REC paragraph to physically write the record to the report file and increments the line counter to track pagination.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">INITIA</span><span class="nv">LIZE</span><span class="w"> </span><span class="nv">TRANSACTION-DETAIL-REPORT</span><span class="w">                                 </span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-TRANS-ID</span><span class="w">                                 </span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREF-ACCT-ID</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-ACCOUNT-ID</span><span class="w">                          </span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-TYPE-CD</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-RECORD</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-TYPE-CD</span><span class="w">              </span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-TYPE-DESC</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-TYPE-DESC</span><span class="w">                         </span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-CAT-CD</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-RECORD</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-CAT-CD</span><span class="w">               </span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-CAT-TYPE-DESC</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-CAT-DESC</span><span class="w">                      </span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-SOURCE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-SOURCE</span><span class="w">                               </span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-AMT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-REPORT-AMT</span><span class="w">                                     </span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANSACTION-DETAIL-REPORT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">FD-REPTFILE-REC</span><span class="w">                    </span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">1111</span><span class="o">-</span><span class="nv">WRITE-REPORT-REC</span><span class="w">                                        </span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-LINE-COUNTER</span><span class="w">                                             </span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0000-tranfile-open">0000-TRANFILE-OPEN</h3>
<p>This paragraph handles the opening of the transaction input file (TRANSACT-FILE) and implements error handling for the operation. It initially sets APPL-RESULT to 8 (indicating a pending operation), then attempts to open the file in INPUT mode. If the operation succeeds (status code '00'), it sets APPL-RESULT to 0 indicating success; otherwise, it sets APPL-RESULT to 12 indicating failure. When the file opens successfully, processing continues. If the open operation fails, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details (9910-DISPLAY-IO-STATUS), and then terminates the program by calling the 9999-ABEND-PROGRAM paragraph. This ensures the program doesn't proceed with invalid file access.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="w">                                             </span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                             </span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="kr">             </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING TRANFILE&#39;</span><span class="w">                                  </span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                    </span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                        </span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0100-reptfile-open">0100-REPTFILE-OPEN</h3>
<p>This paragraph handles the opening of the output report file. It initializes APPL-RESULT to 8, then attempts to open the REPORT-FILE for output. If the operation is successful (status code '00'), it sets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12. The code then checks if the operation was successful (APPL-AOK condition). If not, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper error handling if the report file cannot be opened, preventing the program from continuing execution with an invalid output file.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">OUTPUT</span><span class="w"> </span><span class="nv">REPORT-FILE</span><span class="w">                                              </span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                             </span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="kr">             </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING REPTFILE&#39;</span><span class="w">                                  </span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                    </span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                        </span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0200-cardxref-open">0200-CARDXREF-OPEN</h3>
<p>This paragraph handles the opening of the card cross-reference file (XREF-FILE) used to retrieve account information. It sets an initial result code of 8, attempts to open the file in INPUT mode, and then checks the operation's success. If the file opens successfully (status '00'), it sets APPL-RESULT to 0 indicating success. Otherwise, it sets APPL-RESULT to 12 indicating failure. When a failure occurs, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This error handling ensures the program doesn't proceed without access to the critical cross-reference data needed for the transaction report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="w">                                                 </span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARDXREF-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING CROSS REF FILE&#39;</span><span class="w">                           </span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARDXREF-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0300-trantype-open">0300-TRANTYPE-OPEN</h3>
<p>This paragraph handles the opening of the transaction type reference file. It sets an initial result code of 8, then attempts to open the TRANTYPE-FILE in INPUT mode. If the file opens successfully (status '00'), it sets the result code to 0; otherwise, it sets it to 12. If the operation is successful (APPL-AOK condition), processing continues. If there's an error, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures the program terminates properly if it cannot access the transaction type reference data needed for report generation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">TRANTYPE-FILE</span><span class="w">                                             </span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANTYPE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING TRANSACTION TYPE FILE&#39;</span><span class="w">                    </span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANTYPE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0400-trancatg-open">0400-TRANCATG-OPEN</h3>
<p>This paragraph handles the opening of the Transaction Category file (TRANCATG-FILE) in input mode. It sets an initial result code of 8, then attempts to open the file. If the operation is successful (status '00'), it sets the result code to 0; otherwise, it sets it to 12. If the result indicates success (APPL-AOK), processing continues; otherwise, it displays an error message about failing to open the Transaction Category file, calls a routine to display the I/O status code, and then abends the program. This ensures the program terminates properly if it cannot access the critical Transaction Category reference data needed for the report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">TRANCATG-FILE</span><span class="w">                                             </span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANCATG-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING TRANSACTION CATG FILE&#39;</span><span class="w">                    </span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANCATG-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="0500-dateparm-open">0500-DATEPARM-OPEN</h3>
<p>This paragraph handles the opening of the date parameters input file. It initializes the application result code to 8, then attempts to open the DATE-PARMS-FILE. If the file opens successfully (status '00'), it sets the result code to 0; otherwise, it sets it to 12. The paragraph then checks if the operation was successful (APPL-AOK condition). If not, it displays an error message about the date parameter file, calls a routine to display the I/O status code, and then executes the program termination routine. This ensures the program cannot proceed without successfully accessing the date parameters that define the transaction date range for the report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">OPEN</span><span class="w"> </span><span class="kp">INPUT</span><span class="w"> </span><span class="nv">DATE-PARMS-FILE</span><span class="w">                                           </span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR OPENING DATE PARM FILE&#39;</span><span class="w">                           </span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1500-a-lookup-xref">1500-A-LOOKUP-XREF</h3>
<p>This paragraph performs a lookup operation in the card cross-reference file to retrieve account information based on a card number. It reads a record from the XREF-FILE into the CARD-XREF-RECORD structure. If the card number is not found (INVALID KEY condition), the paragraph displays an error message with the invalid card number, sets an error status code of 23, displays the I/O status details, and terminates the program abnormally. This validation ensures that only transactions with valid card numbers are processed in the report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">READ X</span><span class="nv">REF-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">CARD-XREF-RECORD</span><span class="w">                                 </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">INVALID</span><span class="w"> </span><span class="kp">KEY                                                       </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="kp">                </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;INVALID CARD NUMBER : &#39;</span><span class="w">  </span><span class="nv">FD-XREF-CARD-NUM</span><span class="w">             </span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">23 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                           </span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                     </span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-READ                                                             </span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1500-b-lookup-trantype">1500-B-LOOKUP-TRANTYPE</h3>
<p>This paragraph performs a lookup operation to retrieve transaction type information from the TRANTYPE-FILE using the transaction type code stored in FD-TRAN-TYPE. If the lookup fails (INVALID KEY condition), the program displays an error message showing the invalid transaction type, sets an error status code of 23, displays the I/O status details, and terminates the program through the abend routine. The paragraph is essential for obtaining descriptive information about transaction types to include in the transaction detail report.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">READ T</span><span class="nv">RANTYPE-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">TRAN-TYPE-RECORD</span><span class="w">                             </span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">INVALID</span><span class="w"> </span><span class="kp">KEY                                                       </span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kp">                </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;INVALID TRANSACTION TYPE : &#39;</span><span class="w">  </span><span class="nv">FD-TRAN-TYPE</span><span class="w">            </span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">23 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                           </span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                     </span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-READ                                                             </span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="1500-c-lookup-trancatg">1500-C-LOOKUP-TRANCATG</h3>
<p>This paragraph performs a lookup operation on the transaction category file (TRANCATG-FILE) using the current transaction category key (FD-TRAN-CAT-KEY). If the key is not found in the file, the program displays an error message with the invalid key value, sets an error status code of 23, displays the I/O status details, and then terminates the program through the abend routine. When successful, the transaction category record is read into the TRAN-CAT-RECORD structure for further processing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c">READ T</span><span class="nv">RANCATG-FILE</span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">TRAN-CAT-RECORD</span><span class="w">                              </span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c">      </span><span class="w">        </span><span class="kp">INVALID</span><span class="w"> </span><span class="kp">KEY                                                       </span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="kp">                </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;INVALID TRAN CATG KEY : &#39;</span><span class="w">  </span><span class="nv">FD-TRAN-CAT-KEY</span><span class="w">            </span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c">      </span><span class="w">           </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">23 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                           </span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="c">      </span><span class="w">           </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                     </span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-READ                                                             </span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9000-tranfile-close">9000-TRANFILE-CLOSE</h3>
<p>This paragraph handles the closing of the transaction file (TRANSACT-FILE) with error handling. It sets an initial result code of 8, then attempts to close the file. If the close operation is successful (status '00'), it resets the result code to 0. If unsuccessful, it sets the result code to 12. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This ensures proper resource cleanup and provides meaningful error information if the transaction file cannot be closed properly.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c">ADD 8 </span><span class="kp">TO</span><span class="w"> </span><span class="no">ZERO</span><span class="w"> </span><span class="kp">GIVING</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                    </span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">TRANSACT-FILE</span><span class="w">                                                  </span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">SUBTRACT</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w"> </span><span class="kp">FROM</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                             </span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="kr">             </span><span class="w"> </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="no">ZERO</span><span class="w"> </span><span class="kp">GIVING</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                 </span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="kr">             </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING POSTED TRANSACTION FILE&#39;</span><span class="w">                   </span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANFILE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                    </span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                        </span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9100-reptfile-close">9100-REPTFILE-CLOSE</h3>
<p>This paragraph handles the closing of the report output file in the transaction detail report program. It sets an initial result code of 8, then attempts to close the REPORT-FILE. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets the result code to 12. If the operation completes successfully (APPL-AOK condition), processing continues normally. If an error occurs, the paragraph displays an error message, captures the file status code, displays the I/O status details by calling the 9910-DISPLAY-IO-STATUS paragraph, and then terminates the program abnormally by calling the 9999-ABEND-PROGRAM paragraph. This ensures proper resource cleanup and error handling when closing the report file.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c">ADD 8 </span><span class="kp">TO</span><span class="w"> </span><span class="no">ZERO</span><span class="w"> </span><span class="kp">GIVING</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                    </span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">REPORT-FILE</span><span class="w">                                                    </span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                            </span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">SUBTRACT</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w"> </span><span class="kp">FROM</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                             </span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="kr">             </span><span class="w"> </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="no">ZERO</span><span class="w"> </span><span class="kp">GIVING</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                 </span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                          </span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="c">      </span><span class="w">        </span><span class="kr">CONTINUE                                                          </span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="kr">             </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING REPORT FILE&#39;</span><span class="w">                               </span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANREPT-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                 </span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                    </span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="c">      </span><span class="w">        </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                        </span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9200-cardxref-close">9200-CARDXREF-CLOSE</h3>
<p>This paragraph handles the closing of the card cross-reference file (XREF-FILE) with appropriate error handling. It initially sets APPL-RESULT to 8 (indicating a potential error), then attempts to close the file. If the close operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 to indicate a more severe error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This ensures proper resource cleanup and provides diagnostic information when file closing operations fail.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">XREF-FILE</span><span class="w">                                                      </span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">CARDXREF-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING CROSS REF FILE&#39;</span><span class="w">                           </span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARDXREF-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9300-trantype-close">9300-TRANTYPE-CLOSE</h3>
<p>This paragraph handles the closing of the transaction type file (TRANTYPE-FILE) with appropriate error handling. It initially sets the application result code to 8, then attempts to close the file. If the close operation is successful (status code '00'), it resets the result code to 0; otherwise, it sets it to 12. When the operation fails, the paragraph displays an error message, retrieves the I/O status code, calls a routine to display the status details, and then terminates the program abnormally. This ensures proper resource cleanup and provides meaningful error information if the file cannot be closed properly.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">TRANTYPE-FILE</span><span class="w">                                                  </span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANTYPE-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING TRANSACTION TYPE FILE&#39;</span><span class="w">                    </span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANTYPE-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9400-trancatg-close">9400-TRANCATG-CLOSE</h3>
<p>This paragraph handles the closing of the Transaction Category file (TRANCATG-FILE) with appropriate error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls routines to display the I/O status details and abnormally terminate the program. This is part of the program's cleanup process that ensures proper file handling before program termination.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">TRANCATG-FILE</span><span class="w">                                                  </span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">TRANCATG-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING TRANSACTION CATG FILE&#39;</span><span class="w">                    </span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRANCATG-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="c">      *---------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="9500-dateparm-close">9500-DATEPARM-CLOSE</h3>
<p>This paragraph handles the closing of the date parameters file and performs error handling. It initially sets a result code of 8, then attempts to close the DATE-PARMS-FILE. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets the result code to 12. If the operation was not successful, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper resource cleanup and appropriate error handling when the program is finished with the date parameters file.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c">MOVE 8</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="p">.</span><span class="w">                                               </span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">CLOSE</span><span class="w"> </span><span class="nv">DATE-PARMS-FILE</span><span class="w">                                                </span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF </span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">                                           </span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                            </span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">12 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">APPL-RESULT</span><span class="w">                                           </span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF </span><span class="w"> </span><span class="nv">APPL-AOK</span><span class="w">                                                         </span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE                                                         </span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;ERROR CLOSING DATE PARM FILE&#39;</span><span class="w">                           </span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DATEPARM-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w">                                </span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9910</span><span class="o">-</span><span class="nv">DISPLAY-IO-STATUS</span><span class="w">                                   </span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="mi">9999</span><span class="o">-</span><span class="nv">ABEND-PROGRAM</span><span class="w">                                       </span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span>
</code></pre></div>
</details>

<h3 id="9999-abend-program">9999-ABEND-PROGRAM</h3>
<p>This paragraph handles abnormal program termination by displaying an "ABENDING PROGRAM" message, resetting the TIMING variable to zero, setting an abort code (ABCODE) to 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program termination. This is likely used as a last resort error handling mechanism when the program encounters a critical error that prevents further processing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c">DISPLA</span><span class="nv">Y</span><span class="w"> </span><span class="s1">&#39;ABENDING PROGRAM&#39;</span><span class="w">                                           </span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TIMING</span><span class="w">                                                     </span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">999 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ABCODE</span><span class="w">                                                   </span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">CALL </span><span class="s1">&#39;CEE3ABD&#39;</span><span class="p">.</span><span class="w">                                                      </span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="c">      *****************************************************************</span>
</code></pre></div>
</details>

<h3 id="9910-display-io-status">9910-DISPLAY-IO-STATUS</h3>
<p>This paragraph handles the display of file I/O status codes in a standardized format. When an I/O operation encounters an error, this routine formats the status code for consistent display. If the status code is non-numeric or indicates a serious error (first digit is '9'), it processes the two status bytes separately, converting the second byte to binary format before display. Otherwise, it formats standard status codes by padding with leading zeros. In both cases, it displays the formatted status code with a descriptive prefix. This error handling routine helps with debugging file operations by providing clear, consistent error reporting throughout the program.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c">IF IO-</span><span class="nv">STATUS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC                                             </span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="kp">             </span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="nv">IO-STAT1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;9&#39;</span><span class="w">                                                 </span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">IO-STAT1</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w">                                </span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">0 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TWO-BYTES-BINARY</span><span class="w">                                        </span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">IO-STAT2</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TWO-BYTES-RIGHT</span><span class="w">                                  </span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TWO-BYTES-BINARY</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-0403</span><span class="w">                           </span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c">      </span><span class="w">        </span><span class="kr">DISPLAY </span><span class="s1">&#39;FILE STATUS IS: NNNN&#39;</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="w">                       </span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE                                                                 </span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="kr">             </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;0000&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="w">                                       </span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="c">      </span><span class="w">        </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">IO-STATUS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">                               </span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="c">      </span><span class="w">        </span><span class="kr">DISPLAY </span><span class="s1">&#39;FILE STATUS IS: NNNN&#39;</span><span class="w"> </span><span class="nv">IO-STATUS-04</span><span class="w">                       </span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF                                                               </span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EXIT</span><span class="p">.</span><span class="w">                                                                </span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="c">      *</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>