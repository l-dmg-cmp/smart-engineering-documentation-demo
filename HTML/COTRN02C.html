
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="COTRN01C.html">
      
      
        <link rel="next" href="COUSR00C.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>COTRN02C - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cotrn02c" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              COTRN02C
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT04C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDLIC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDSLC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CORPT00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="COTRN02C.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-section" class="md-nav__link">
    <span class="md-ellipsis">
      CONFIGURATION SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-para" class="md-nav__link">
    <span class="md-ellipsis">
      MAIN-PARA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-enter-key" class="md-nav__link">
    <span class="md-ellipsis">
      PROCESS-ENTER-KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-input-key-fields" class="md-nav__link">
    <span class="md-ellipsis">
      VALIDATE-INPUT-KEY-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-input-data-fields" class="md-nav__link">
    <span class="md-ellipsis">
      VALIDATE-INPUT-DATA-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-transaction" class="md-nav__link">
    <span class="md-ellipsis">
      ADD-TRANSACTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-last-tran-data" class="md-nav__link">
    <span class="md-ellipsis">
      COPY-LAST-TRAN-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-to-prev-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN-TO-PREV-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-trnadd-screen" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-TRNADD-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-trnadd-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RECEIVE-TRNADD-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populate-header-info" class="md-nav__link">
    <span class="md-ellipsis">
      POPULATE-HEADER-INFO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-cxacaix-file" class="md-nav__link">
    <span class="md-ellipsis">
      READ-CXACAIX-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-ccxref-file" class="md-nav__link">
    <span class="md-ellipsis">
      READ-CCXREF-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startbr-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      STARTBR-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readprev-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      READPREV-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#endbr-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      ENDBR-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      WRITE-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-current-screen" class="md-nav__link">
    <span class="md-ellipsis">
      CLEAR-CURRENT-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-all-fields" class="md-nav__link">
    <span class="md-ellipsis">
      INITIALIZE-ALL-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ws-message" class="md-nav__link">
    <span class="md-ellipsis">
      WS-MESSAGE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-section" class="md-nav__link">
    <span class="md-ellipsis">
      CONFIGURATION SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-para" class="md-nav__link">
    <span class="md-ellipsis">
      MAIN-PARA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-enter-key" class="md-nav__link">
    <span class="md-ellipsis">
      PROCESS-ENTER-KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-input-key-fields" class="md-nav__link">
    <span class="md-ellipsis">
      VALIDATE-INPUT-KEY-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-input-data-fields" class="md-nav__link">
    <span class="md-ellipsis">
      VALIDATE-INPUT-DATA-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-transaction" class="md-nav__link">
    <span class="md-ellipsis">
      ADD-TRANSACTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-last-tran-data" class="md-nav__link">
    <span class="md-ellipsis">
      COPY-LAST-TRAN-DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-to-prev-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN-TO-PREV-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-trnadd-screen" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-TRNADD-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-trnadd-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RECEIVE-TRNADD-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populate-header-info" class="md-nav__link">
    <span class="md-ellipsis">
      POPULATE-HEADER-INFO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-cxacaix-file" class="md-nav__link">
    <span class="md-ellipsis">
      READ-CXACAIX-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-ccxref-file" class="md-nav__link">
    <span class="md-ellipsis">
      READ-CCXREF-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startbr-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      STARTBR-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readprev-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      READPREV-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#endbr-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      ENDBR-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-transact-file" class="md-nav__link">
    <span class="md-ellipsis">
      WRITE-TRANSACT-FILE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-current-screen" class="md-nav__link">
    <span class="md-ellipsis">
      CLEAR-CURRENT-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-all-fields" class="md-nav__link">
    <span class="md-ellipsis">
      INITIALIZE-ALL-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ws-message" class="md-nav__link">
    <span class="md-ellipsis">
      WS-MESSAGE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cotrn02c">COTRN02C</h1>
<h2 id="overview">Overview</h2>
<p>This program (COTRN02C) is a CICS COBOL application that adds new transactions to the TRANSACT file in the CardDemo system. It provides a user interface for entering transaction details and performs comprehensive validation before writing records to the database.</p>
<p>The program handles the creation of credit card transactions by allowing users to enter either an account ID or card number, along with transaction details such as type code, category code, amount, description, dates, and merchant information. It performs extensive validation on all input fields, ensuring data integrity before adding records to the transaction file.</p>
<p>Key functionality includes:
- Validating account IDs and card numbers against cross-reference files
- Performing format validation on transaction amounts and dates
- Auto-generating sequential transaction IDs
- Providing a "copy last transaction" feature to streamline data entry
- Supporting navigation between screens in the CardDemo application</p>
<p>The program incorporates error handling for database operations and provides clear error messages to guide users through the data entry process. It demonstrates typical mainframe transaction processing patterns with field validation, file I/O operations, and screen management.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>COTRN02C</code></p>
<p><strong>Author</strong>: <code>AWS</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    actor User
    participant MainPara as MAIN-PARA
    participant ProcessEnter as PROCESS-ENTER-KEY
    participant ValidateKey as VALIDATE-INPUT-KEY-FIELDS
    participant ValidateData as VALIDATE-INPUT-DATA-FIELDS
    participant AddTran as ADD-TRANSACTION
    participant CopyLast as COPY-LAST-TRAN-DATA
    participant Screen as SEND-TRNADD-SCREEN
    participant Files as Database Files

    User-&gt;&gt;MainPara: Start transaction

    alt First time entry
        MainPara-&gt;&gt;Screen: Initialize and display screen
        Screen--&gt;&gt;User: Show transaction entry form
    else Re-entry
        MainPara-&gt;&gt;MainPara: Receive screen data

        alt ENTER key pressed
            MainPara-&gt;&gt;ProcessEnter: Process entered data
            ProcessEnter-&gt;&gt;ValidateKey: Validate key fields
            ValidateKey-&gt;&gt;Files: Read CXACAIX/CCXREF files
            Files--&gt;&gt;ValidateKey: Return account/card data

            ProcessEnter-&gt;&gt;ValidateData: Validate data fields

            alt Confirmation = 'Y'
                ProcessEnter-&gt;&gt;AddTran: Add transaction
                AddTran-&gt;&gt;Files: STARTBR TRANSACT file
                Files--&gt;&gt;AddTran: Position at end
                AddTran-&gt;&gt;Files: READPREV TRANSACT file
                Files--&gt;&gt;AddTran: Return last transaction
                AddTran-&gt;&gt;AddTran: Generate new transaction ID
                AddTran-&gt;&gt;Files: WRITE TRANSACT file
                Files--&gt;&gt;AddTran: Write confirmation
                AddTran-&gt;&gt;Screen: Display success message
                Screen--&gt;&gt;User: Show confirmation
            else Confirmation not 'Y'
                ProcessEnter-&gt;&gt;Screen: Request confirmation
                Screen--&gt;&gt;User: Prompt for confirmation
            end

        else PF3 key pressed
            MainPara-&gt;&gt;MainPara: Return to previous screen

        else PF4 key pressed
            MainPara-&gt;&gt;MainPara: Clear current screen
            MainPara-&gt;&gt;Screen: Display empty form
            Screen--&gt;&gt;User: Show cleared form

        else PF5 key pressed
            MainPara-&gt;&gt;CopyLast: Copy last transaction
            CopyLast-&gt;&gt;ValidateKey: Validate key fields
            CopyLast-&gt;&gt;Files: STARTBR TRANSACT file
            Files--&gt;&gt;CopyLast: Position at end
            CopyLast-&gt;&gt;Files: READPREV TRANSACT file
            Files--&gt;&gt;CopyLast: Return last transaction
            CopyLast-&gt;&gt;ProcessEnter: Process with copied data
            ProcessEnter-&gt;&gt;Screen: Display form with copied data
            Screen--&gt;&gt;User: Show form with copied data

        else Other key pressed
            MainPara-&gt;&gt;Screen: Display invalid key message
            Screen--&gt;&gt;User: Show error message
        end
    end</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CSDAT01Y.html"><code>CSDAT01Y</code></a></li>
<li><code>DFHAID</code></li>
<li><a href="copybooks/CVACT01Y.html"><code>CVACT01Y</code></a></li>
<li><a href="copybooks/CVTRA05Y.html"><code>CVTRA05Y</code></a></li>
<li><a href="copybooks/COCOM01Y.html"><code>COCOM01Y</code></a></li>
<li><code>COTRN02</code></li>
<li><code>DFHBMSCA</code></li>
<li><a href="copybooks/CVACT03Y.html"><code>CVACT03Y</code></a></li>
<li><a href="copybooks/COTTL01Y.html"><code>COTTL01Y</code></a></li>
<li><a href="copybooks/CSMSG01Y.html"><code>CSMSG01Y</code></a></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="configuration-section">CONFIGURATION SECTION</h3>
<p>This section would typically contain configuration settings for the COTRN02C program, including file assignments, special names, and system dependencies. However, the provided snippet is empty, indicating that the Configuration Section in this program doesn't contain any explicit configuration settings. This suggests that the program likely relies on standard CICS environment configurations or that the configuration details are defined elsewhere in the system, possibly in the CICS Resource Definition Online (RDO) or in JCL that executes this program.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This Working Storage section defines the key variables and data structures used in the COTRN02C transaction processing program. It contains program identifiers, file names for transaction and account data, status flags for error handling and user modifications, and various numeric fields for processing transaction amounts and IDs. The section includes specialized fields for data conversion and validation, particularly for handling transaction amounts and dates. It incorporates several copybooks that likely contain screen layouts, common data structures, and message definitions needed for the transaction entry interface. The CSUTLDTC-PARM structure suggests integration with a date validation utility. The section also defines program control variables to track transaction navigation and selection, supporting the program's ability to manage transaction entry across multiple screens.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">01 WS-</span><span class="nv">VARIABLES</span><span class="p">.</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-PGMNAME</span><span class="w">                 </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;COTRN02C&#39;</span><span class="p">.</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRANID</span><span class="w">                  </span><span class="kt">PIC X(04)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CT02&#39;</span><span class="p">.</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-MESSAGE</span><span class="w">                 </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRANSACT-FILE</span><span class="w">           </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;TRANSACT&#39;</span><span class="p">.</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-ACCTDAT-FILE</span><span class="w">            </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;ACCTDAT &#39;</span><span class="p">.</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-CCXREF-FILE</span><span class="w">             </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CCXREF  &#39;</span><span class="p">.</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-CXACAIX-FILE</span><span class="w">            </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CXACAIX &#39;</span><span class="p">.</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-ERR-FLG</span><span class="w">                 </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">ERR-FLG-ON</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">ERR-FLG-OFF</span><span class="w">                        </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-RESP-CD</span><span class="w">                 </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-REAS-CD</span><span class="w">                 </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-USR-MODIFIED</span><span class="w">            </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">USR-MODIFIED-YES</span><span class="w">                   </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">USR-MODIFIED-NO</span><span class="w">                    </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-AMT</span><span class="w">                </span><span class="kt">PIC +99999999.99</span><span class="p">.</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-DATE</span><span class="w">               </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;00/00/00&#39;</span><span class="p">.</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-ACCT-ID-N</span><span class="w">               </span><span class="kt">PIC 9(11)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-CARD-NUM-N</span><span class="w">              </span><span class="kt">PIC 9(16)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-ID-N</span><span class="w">               </span><span class="kt">PIC 9(16)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-AMT-N</span><span class="w">              </span><span class="kt">PIC S9(9)V99</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZERO</span><span class="p">.</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-AMT-E</span><span class="w">              </span><span class="kt">PIC +99999999.99</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-DATE-FORMAT</span><span class="w">             </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">.</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">CSUTLDTC-PARM</span><span class="p">.</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CSUTLDTC-DATE</span><span class="w">                   </span><span class="kt">PIC X(10)</span><span class="p">.</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CSUTLDTC-DATE-FORMAT</span><span class="w">            </span><span class="kt">PIC X(10)</span><span class="p">.</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CSUTLDTC-RESULT</span><span class="p">.</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CSUTLDTC-RESULT-SEV-CD</span><span class="w">       </span><span class="kt">PIC X(04)</span><span class="p">.</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="kp">FILLER                      </span><span class="w"> </span><span class="kt">PIC X(11)</span><span class="p">.</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CSUTLDTC-RESULT-MSG-NUM</span><span class="w">      </span><span class="kt">PIC X(04)</span><span class="p">.</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CSUTLDTC-RESULT-MSG</span><span class="w">          </span><span class="kt">PIC X(61)</span><span class="p">.</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCOM01Y</span><span class="p">.</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CDEMO-CT02-INFO</span><span class="p">.</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CDEMO-CT02-TRNID-FIRST</span><span class="w">     </span><span class="kt">PIC X(16)</span><span class="p">.</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CDEMO-CT02-TRNID-LAST</span><span class="w">      </span><span class="kt">PIC X(16)</span><span class="p">.</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CDEMO-CT02-PAGE-NUM</span><span class="w">        </span><span class="kt">PIC 9(08)</span><span class="p">.</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CDEMO-CT02-NEXT-PAGE-FLG</span><span class="w">   </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">NEXT-PAGE-YES</span><span class="w">                     </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="c">      </span><span class="w">          </span><span class="mi">88 </span><span class="nv">NEXT-PAGE-NO</span><span class="w">                      </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CDEMO-CT02-TRN-SEL-FLG</span><span class="w">     </span><span class="kt">PIC X(01)</span><span class="p">.</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CDEMO-CT02-TRN-SELECTED</span><span class="w">    </span><span class="kt">PIC X(16)</span><span class="p">.</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COTRN02</span><span class="p">.</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COTTL01Y</span><span class="p">.</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSDAT01Y</span><span class="p">.</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG01Y</span><span class="p">.</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA05Y</span><span class="p">.</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT01Y</span><span class="p">.</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVACT03Y</span><span class="p">.</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHAID</span><span class="p">.</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHBMSCA</span><span class="p">.</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="c">      *                        LINKAGE SECTION</span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="linkage-section">LINKAGE SECTION</h3>
<p>This section defines the linkage area used for communication between programs in the CICS environment. It contains a single field, LK-COMMAREA, which is defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive and process communication data of varying sizes from other programs in the CardDemo transaction processing system.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">01  DF</span><span class="nv">HCOMMAREA</span><span class="p">.</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LK-COMMAREA</span><span class="w">                           </span><span class="kt">PIC X(01)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kt">            </span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="mi">32767 </span><span class="kp">TIMES</span><span class="w"> </span><span class="kp">DEPENDING</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="p">.</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c">      *</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="main-para">MAIN-PARA</h3>
<p>This paragraph serves as the main control flow for the transaction addition screen. It initializes error flags, handles first-time entry versus re-entry to the program, and processes user input based on function keys. When first entered, it sets up the screen and positions the cursor at the account ID field. On re-entry, it evaluates the user's action based on the function key pressed: ENTER processes the transaction data, PF3 returns to the previous screen, PF4 clears the current screen, and PF5 copies data from the last transaction. The paragraph includes special handling for when a transaction is pre-selected from another screen. It concludes by returning control to CICS with the transaction ID and communication area preserved for the next interaction.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">SET ER</span><span class="nv">R-FLG-OFF</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">USR-MODIFIED-NO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="nb">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c">      </span><span class="w">                    </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="mi">               </span><span class="kr">MOVE </span><span class="s1">&#39;COSGN00C&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">RETURN-TO-PREV-SCREEN</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nv">EIBCALEN</span><span class="p">)</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES         </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-CT02-TRN-SELECTED</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c">      </span><span class="w">                                        </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="no">                      </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-CT02-TRN-SELECTED</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="kp">                           </span><span class="w"> </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">PROCESS-ENTER-KEY</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="c">      </span><span class="w">         </span><span class="kr">ELSE</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">RECEIVE-TRNADD-SCREEN</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="c">      </span><span class="w">             </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">EIBAID</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHENTER</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">PROCESS-ENTER-KEY</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHPF3</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="c">      </span><span class="w">                     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="no">                              </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;COMEN01C&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="c">      </span><span class="w">                     </span><span class="kr">ELSE</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="kr">                              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="kp">                              </span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="c">      </span><span class="w">                     </span><span class="kr">END-IF</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="kr">                          </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">RETURN-TO-PREV-SCREEN</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHPF4</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">CLEAR-CURRENT-SCREEN</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHPF5</span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">COPY-LAST-TRAN-DATA</span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="kp">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-MSG-INVALID-KEY</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="kr">              </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="kr">          </span><span class="w"> </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN</span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="kr">                    </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-TRANID</span><span class="p">)</span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="c">      </span><span class="w">               </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="c">      *                      PROCESS-ENTER-KEY</span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="process-enter-key">PROCESS-ENTER-KEY</h3>
<p>This paragraph processes the user's action when the Enter key is pressed during transaction entry. It first validates both key fields and data fields by calling their respective validation routines. Then it evaluates the confirmation input field ('CONFIRMI') to determine the next action. If the user confirms with 'Y' or 'y', it proceeds to add the transaction to the database. If the confirmation field is blank, contains 'N', 'n', or low-values, it prompts the user to confirm the transaction by setting an error flag and displaying a message. For any other input value, it displays an error message indicating that only 'Y' or 'N' are valid responses. In both error cases, it positions the cursor at the confirmation field and redisplays the transaction entry screen.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="nv">VALIDATE-INPUT-KEY-FIELDS</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">VALIDATE-INPUT-DATA-FIELDS</span><span class="p">.</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">CONFIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN </span><span class="s1">&#39;Y&#39;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN </span><span class="s1">&#39;y&#39;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">ADD-TRANSACTION</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN </span><span class="s1">&#39;N&#39;</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN </span><span class="s1">&#39;n&#39;</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="no">SPACES</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="no">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Confirm to add this transaction...&#39;</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c">      </span><span class="w">                          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CONFIRML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Invalid value. Valid values are (Y/N)...&#39;</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="c">      </span><span class="w">                          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CONFIRML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="c">      *                      VALIDATE-INPUT-KEY-FIELDS</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="validate-input-key-fields">VALIDATE-INPUT-KEY-FIELDS</h3>
<p>This paragraph validates the key input fields (Account ID or Card Number) required for transaction creation. It uses an EVALUATE statement to handle three scenarios: when an Account ID is provided, when a Card Number is provided, or when neither is provided. For Account ID validation, it checks that the value is numeric, converts it to a numeric format, and then retrieves the corresponding Card Number by reading the CXACAIX cross-reference file. Similarly, for Card Number validation, it verifies the numeric format, converts it to a numeric value, and retrieves the associated Account ID from the CCXREF file. If neither field is provided, it displays an error message requiring one of these fields to be entered. The paragraph ensures data integrity by validating input format and establishing the relationship between account IDs and card numbers before proceeding with transaction creation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">EVALUA</span><span class="nv">TE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">ACTIDINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="no">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">ACTIDINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kp">                      </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Account ID must be Numeric...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="kp">                                      </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-ACCT-ID-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL</span><span class="p">(</span><span class="nv">ACTIDINI</span><span class="w"> </span><span class="kp">OF</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="kp">                  </span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-ACCT-ID-N</span><span class="w">            </span><span class="kp">TO</span><span class="w"> </span><span class="nv">XREF-ACCT-ID</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="c">      </span><span class="w">                                          </span><span class="nv">ACTIDINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">READ-CXACAIX-FILE</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREF-CARD-NUM</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="no">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="kp">                      </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Card Number must be Numeric...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="kp">                                      </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDNINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-CARD-NUM-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL</span><span class="p">(</span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="kp">                  </span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">)</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CARD-NUM-N</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">XREF-CARD-NUM</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="c">      </span><span class="w">                                          </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">READ-CCXREF-FILE</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">XREF-ACCT-ID</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Account or Card Number must be entered...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="c">      *                 VALIDATE-INPUT-DATA-FIELDS</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="validate-input-data-fields">VALIDATE-INPUT-DATA-FIELDS</h3>
<p>This paragraph performs comprehensive validation of transaction input data fields before allowing a new transaction to be added. It first checks if an error flag is set, in which case it clears all input fields. Then it systematically validates each required field, ensuring none are empty or contain invalid values. The validation includes checking that type and category codes are numeric, transaction amount follows the format "-99999999.99", and dates conform to "YYYY-MM-DD" format. The code also performs advanced date validation by calling the CSUTLDTC utility to verify that dates are valid calendar dates. For each validation failure, it sets an error flag, positions the cursor at the problematic field, displays an appropriate error message, and redisplays the transaction entry screen. The paragraph also formats the transaction amount using NUMVAL-C function to ensure proper numeric representation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">IF ERR</span><span class="o">-</span><span class="nv">FLG-ON</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES     </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TTYPCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TCATCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TRNSRCI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TRNAMTI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TDESCI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MIDI</span><span class="w">     </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MNAMEI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MCITYI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MZIPI</span><span class="w">    </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span><span class="p">.</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TTYPCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Type CD can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TTYPCDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TCATCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Category CD can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TCATCDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TRNSRCI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Source can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNSRCL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TDESCI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Description can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TDESCL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Amount can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNAMTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Orig Date can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TORIGDTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Proc Date can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TPROCDTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">MIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Merchant ID can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">MNAMEI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Merchant Name can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MNAMEL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">MCITYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Merchant City can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MCITYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">MZIPI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Merchant Zip can NOT be empty...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MZIPL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>
<a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TTYPCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Type CD must be Numeric...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TTYPCDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TCATCDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Category CD must be Numeric...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TCATCDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a>
<a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="ow">AND </span><span class="s1">&#39;+&#39;</span>
<a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a><span class="kp">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;.&#39;</span>
<a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">11</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-108" name="__codelineno-6-108" href="#__codelineno-6-108"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-109" name="__codelineno-6-109" href="#__codelineno-6-109"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Amount should be in format -99999999.99&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-110" name="__codelineno-6-110" href="#__codelineno-6-110"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-111" name="__codelineno-6-111" href="#__codelineno-6-111"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNAMTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-112" name="__codelineno-6-112" href="#__codelineno-6-112"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-113" name="__codelineno-6-113" href="#__codelineno-6-113"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-6-114" name="__codelineno-6-114" href="#__codelineno-6-114"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-115" name="__codelineno-6-115" href="#__codelineno-6-115"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-6-116" name="__codelineno-6-116" href="#__codelineno-6-116"></a>
<a id="__codelineno-6-117" name="__codelineno-6-117" href="#__codelineno-6-117"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-6-118" name="__codelineno-6-118" href="#__codelineno-6-118"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-119" name="__codelineno-6-119" href="#__codelineno-6-119"></a><span class="kp">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL </span><span class="s1">&#39;-&#39;</span>
<a id="__codelineno-6-120" name="__codelineno-6-120" href="#__codelineno-6-120"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-121" name="__codelineno-6-121" href="#__codelineno-6-121"></a><span class="kp">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL </span><span class="s1">&#39;-&#39;</span>
<a id="__codelineno-6-122" name="__codelineno-6-122" href="#__codelineno-6-122"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-123" name="__codelineno-6-123" href="#__codelineno-6-123"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-124" name="__codelineno-6-124" href="#__codelineno-6-124"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Orig Date should be in format YYYY-MM-DD&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-125" name="__codelineno-6-125" href="#__codelineno-6-125"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-126" name="__codelineno-6-126" href="#__codelineno-6-126"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TORIGDTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-127" name="__codelineno-6-127" href="#__codelineno-6-127"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-128" name="__codelineno-6-128" href="#__codelineno-6-128"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-6-129" name="__codelineno-6-129" href="#__codelineno-6-129"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-130" name="__codelineno-6-130" href="#__codelineno-6-130"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-6-131" name="__codelineno-6-131" href="#__codelineno-6-131"></a>
<a id="__codelineno-6-132" name="__codelineno-6-132" href="#__codelineno-6-132"></a><span class="kr">          </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-6-133" name="__codelineno-6-133" href="#__codelineno-6-133"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-134" name="__codelineno-6-134" href="#__codelineno-6-134"></a><span class="kp">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL </span><span class="s1">&#39;-&#39;</span>
<a id="__codelineno-6-135" name="__codelineno-6-135" href="#__codelineno-6-135"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-136" name="__codelineno-6-136" href="#__codelineno-6-136"></a><span class="kp">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EQUAL </span><span class="s1">&#39;-&#39;</span>
<a id="__codelineno-6-137" name="__codelineno-6-137" href="#__codelineno-6-137"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-138" name="__codelineno-6-138" href="#__codelineno-6-138"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-139" name="__codelineno-6-139" href="#__codelineno-6-139"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Proc Date should be in format YYYY-MM-DD&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-140" name="__codelineno-6-140" href="#__codelineno-6-140"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-141" name="__codelineno-6-141" href="#__codelineno-6-141"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TPROCDTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-142" name="__codelineno-6-142" href="#__codelineno-6-142"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-143" name="__codelineno-6-143" href="#__codelineno-6-143"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-6-144" name="__codelineno-6-144" href="#__codelineno-6-144"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-145" name="__codelineno-6-145" href="#__codelineno-6-145"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-6-146" name="__codelineno-6-146" href="#__codelineno-6-146"></a>
<a id="__codelineno-6-147" name="__codelineno-6-147" href="#__codelineno-6-147"></a><span class="kr">          </span><span class="w"> </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span><span class="p">(</span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span>
<a id="__codelineno-6-148" name="__codelineno-6-148" href="#__codelineno-6-148"></a><span class="kp">          </span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">)</span>
<a id="__codelineno-6-149" name="__codelineno-6-149" href="#__codelineno-6-149"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-N</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-E</span>
<a id="__codelineno-6-150" name="__codelineno-6-150" href="#__codelineno-6-150"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-E</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-151" name="__codelineno-6-151" href="#__codelineno-6-151"></a>
<a id="__codelineno-6-152" name="__codelineno-6-152" href="#__codelineno-6-152"></a>
<a id="__codelineno-6-153" name="__codelineno-6-153" href="#__codelineno-6-153"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-6-154" name="__codelineno-6-154" href="#__codelineno-6-154"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-DATE-FORMAT</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-6-155" name="__codelineno-6-155" href="#__codelineno-6-155"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-6-156" name="__codelineno-6-156" href="#__codelineno-6-156"></a>
<a id="__codelineno-6-157" name="__codelineno-6-157" href="#__codelineno-6-157"></a><span class="c">      </span><span class="w">     </span><span class="kr">CALL </span><span class="s1">&#39;CSUTLDTC&#39;</span><span class="w"> </span><span class="kp">USING  </span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-6-158" name="__codelineno-6-158" href="#__codelineno-6-158"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-6-159" name="__codelineno-6-159" href="#__codelineno-6-159"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-6-160" name="__codelineno-6-160" href="#__codelineno-6-160"></a>
<a id="__codelineno-6-161" name="__codelineno-6-161" href="#__codelineno-6-161"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-SEV-CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0000&#39;</span>
<a id="__codelineno-6-162" name="__codelineno-6-162" href="#__codelineno-6-162"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-163" name="__codelineno-6-163" href="#__codelineno-6-163"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE</span>
<a id="__codelineno-6-164" name="__codelineno-6-164" href="#__codelineno-6-164"></a><span class="kr">              </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-MSG-NUM</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2513&#39;</span>
<a id="__codelineno-6-165" name="__codelineno-6-165" href="#__codelineno-6-165"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Orig Date - Not a valid date...&#39;</span>
<a id="__codelineno-6-166" name="__codelineno-6-166" href="#__codelineno-6-166"></a><span class="c">      </span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-167" name="__codelineno-6-167" href="#__codelineno-6-167"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-168" name="__codelineno-6-168" href="#__codelineno-6-168"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TORIGDTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-169" name="__codelineno-6-169" href="#__codelineno-6-169"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-170" name="__codelineno-6-170" href="#__codelineno-6-170"></a><span class="c">      </span><span class="w">         </span><span class="kr">END-IF</span>
<a id="__codelineno-6-171" name="__codelineno-6-171" href="#__codelineno-6-171"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-6-172" name="__codelineno-6-172" href="#__codelineno-6-172"></a>
<a id="__codelineno-6-173" name="__codelineno-6-173" href="#__codelineno-6-173"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-6-174" name="__codelineno-6-174" href="#__codelineno-6-174"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-DATE-FORMAT</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-6-175" name="__codelineno-6-175" href="#__codelineno-6-175"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-6-176" name="__codelineno-6-176" href="#__codelineno-6-176"></a>
<a id="__codelineno-6-177" name="__codelineno-6-177" href="#__codelineno-6-177"></a><span class="c">      </span><span class="w">     </span><span class="kr">CALL </span><span class="s1">&#39;CSUTLDTC&#39;</span><span class="w"> </span><span class="kp">USING  </span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-6-178" name="__codelineno-6-178" href="#__codelineno-6-178"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-6-179" name="__codelineno-6-179" href="#__codelineno-6-179"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-6-180" name="__codelineno-6-180" href="#__codelineno-6-180"></a>
<a id="__codelineno-6-181" name="__codelineno-6-181" href="#__codelineno-6-181"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-SEV-CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0000&#39;</span>
<a id="__codelineno-6-182" name="__codelineno-6-182" href="#__codelineno-6-182"></a><span class="c">      </span><span class="w">         </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-183" name="__codelineno-6-183" href="#__codelineno-6-183"></a><span class="kr">          </span><span class="w"> </span><span class="kr">ELSE</span>
<a id="__codelineno-6-184" name="__codelineno-6-184" href="#__codelineno-6-184"></a><span class="kr">              </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-MSG-NUM</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2513&#39;</span>
<a id="__codelineno-6-185" name="__codelineno-6-185" href="#__codelineno-6-185"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Proc Date - Not a valid date...&#39;</span>
<a id="__codelineno-6-186" name="__codelineno-6-186" href="#__codelineno-6-186"></a><span class="c">      </span><span class="w">               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-187" name="__codelineno-6-187" href="#__codelineno-6-187"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-188" name="__codelineno-6-188" href="#__codelineno-6-188"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TPROCDTL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-189" name="__codelineno-6-189" href="#__codelineno-6-189"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-190" name="__codelineno-6-190" href="#__codelineno-6-190"></a><span class="c">      </span><span class="w">         </span><span class="kr">END-IF</span>
<a id="__codelineno-6-191" name="__codelineno-6-191" href="#__codelineno-6-191"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-6-192" name="__codelineno-6-192" href="#__codelineno-6-192"></a>
<a id="__codelineno-6-193" name="__codelineno-6-193" href="#__codelineno-6-193"></a>
<a id="__codelineno-6-194" name="__codelineno-6-194" href="#__codelineno-6-194"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">MIDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-6-195" name="__codelineno-6-195" href="#__codelineno-6-195"></a><span class="kp">              </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-196" name="__codelineno-6-196" href="#__codelineno-6-196"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;Merchant ID must be Numeric...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-197" name="__codelineno-6-197" href="#__codelineno-6-197"></a><span class="kp">                              </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-198" name="__codelineno-6-198" href="#__codelineno-6-198"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MIDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-6-199" name="__codelineno-6-199" href="#__codelineno-6-199"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-6-200" name="__codelineno-6-200" href="#__codelineno-6-200"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span>
<a id="__codelineno-6-201" name="__codelineno-6-201" href="#__codelineno-6-201"></a><span class="kr">           </span><span class="p">.</span>
<a id="__codelineno-6-202" name="__codelineno-6-202" href="#__codelineno-6-202"></a>
<a id="__codelineno-6-203" name="__codelineno-6-203" href="#__codelineno-6-203"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-6-204" name="__codelineno-6-204" href="#__codelineno-6-204"></a><span class="c">      *                        ADD-TRANSACTION</span>
<a id="__codelineno-6-205" name="__codelineno-6-205" href="#__codelineno-6-205"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="add-transaction">ADD-TRANSACTION</h3>
<p>This paragraph handles the creation of a new transaction record in the system. It first determines the next available transaction ID by retrieving the highest existing ID from the TRANSACT file (using STARTBR, READPREV, and ENDBR operations), then incrementing it by one. The paragraph then initializes a new transaction record and populates it with data from the input screen (COTRN2AI), including transaction type, category, source, description, amount, card number, and merchant information. The transaction amount is converted from character format to numeric using the FUNCTION NUMVAL-C. After all fields are populated, the new transaction record is written to the TRANSACT file by calling the WRITE-TRANSACT-FILE paragraph.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">MOVE H</span><span class="nv">IGH-VALUES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-ID</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">STARTBR-TRANSACT-FILE</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">READPREV-TRANSACT-FILE</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">ENDBR-TRANSACT-FILE</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRAN-ID-N</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRAN-ID-N</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c">      </span><span class="w">     </span><span class="kr">INITIALIZE</span><span class="w"> </span><span class="nv">TRAN-RECORD</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRAN-ID-N</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-ID</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TTYPCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-TYPE-CD</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TCATCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-CAT-CD</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRNSRCI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-SOURCE</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TDESCI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-DESC</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span><span class="p">(</span><span class="nv">TRNAMTI</span><span class="w"> </span><span class="kp">OF</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="kp">          </span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="p">)</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-N</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-AMT</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-CARD-NUM</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">MIDI</span><span class="w">     </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-ID</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">MNAMEI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-NAME</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">MCITYI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-CITY</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">MZIPI</span><span class="w">    </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-ZIP</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-ORIG-TS</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-PROC-TS</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">WRITE-TRANSACT-FILE</span><span class="p">.</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="c">      *                      COPY-LAST-TRAN-DATA</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="copy-last-tran-data">COPY-LAST-TRAN-DATA</h3>
<p>This paragraph implements the "copy last transaction" feature, which retrieves the most recent transaction record and populates the input screen with its data. It first validates the key fields entered by the user, then retrieves the most recent transaction record by positioning to the end of the TRANSACT file (using HIGH-VALUES) and reading the previous record. If the retrieval is successful (no error flag), it transfers the transaction details from the retrieved record to the input screen fields, including transaction type, category, source, amount, description, dates, and merchant information. The paragraph concludes by processing the ENTER key, which likely refreshes the screen with the copied data. This functionality allows users to quickly create new transactions that share many details with previous ones, improving data entry efficiency.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="nv">VALIDATE-INPUT-KEY-FIELDS</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">HIGH-VALUES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-ID</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">STARTBR-TRANSACT-FILE</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">READPREV-TRANSACT-FILE</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">ENDBR-TRANSACT-FILE</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">ERR-FLG-ON</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-AMT</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-E</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-TYPE-CD</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TTYPCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-CAT-CD</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TCATCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-SOURCE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNSRCI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRAN-AMT-E</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNAMTI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-DESC</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TDESCI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-ORIG-TS</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-PROC-TS</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-ID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MIDI</span><span class="w">     </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-NAME</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MNAMEI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-CITY</span><span class="w">  </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MCITYI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">TRAN-MERCHANT-ZIP</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MZIPI</span><span class="w">    </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="kr">          </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">PROCESS-ENTER-KEY</span><span class="p">.</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="c">      *                      RETURN-TO-PREV-SCREEN</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="return-to-prev-screen">RETURN-TO-PREV-SCREEN</h3>
<p>This paragraph handles the navigation back to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, defaulting to 'COSGN00C' (likely the main menu or sign-on screen) if no value is provided. The paragraph then populates the communication area with the current transaction ID and program name as the "from" information, resets the program context to zeros, and uses the CICS XCTL command to transfer control to the target program while passing the communication area. This provides a standardized way to return to previous screens while maintaining navigation context throughout the application.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">IF CDE</span><span class="nv">MO-TO-PROGRAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">SPACES</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;COSGN00C&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-PGMNAME</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROS       </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-PGM-CONTEXT</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="c">      </span><span class="w">         </span><span class="nv">XCTL</span><span class="w"> </span><span class="kp">PROGRAM</span><span class="p">(</span><span class="nv">CDEMO-TO-PROGRAM</span><span class="p">)</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c">      </span><span class="w">         </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="c">      *                      SEND-TRNADD-SCREEN</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="send-trnadd-screen">SEND-TRNADD-SCREEN</h3>
<p>This paragraph displays the transaction addition screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up common header information, then moves any system message to the error message field on the screen. The paragraph uses CICS SEND to display the COTRN2A map from the COTRN02 mapset, erasing the previous screen content and positioning the cursor appropriately. After sending the screen, it executes a CICS RETURN with the current transaction ID and communication area, which effectively pauses the program and waits for user input. This implements the standard CICS pseudo-conversational programming pattern where the program displays a screen, then terminates until the user submits the screen data.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="nv">POPULATE-HEADER-INFO</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-MESSAGE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="err">                    </span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="s1">&#39;COTRN2A&#39;</span><span class="p">)</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c">      </span><span class="w">               </span><span class="nv">MAPSET</span><span class="p">(</span><span class="s1">&#39;COTRN02&#39;</span><span class="p">)</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c">      </span><span class="w">               </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">COTRN2AO</span><span class="p">)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c">      </span><span class="w">               </span><span class="kp">ERASE</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="kp">                    </span><span class="w"> </span><span class="kp">CURSOR</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="kp">          </span><span class="w"> </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="kr">                    </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-TRANID</span><span class="p">)</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c">      </span><span class="w">               </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c">      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="c">      *                      RECEIVE-TRNADD-SCREEN</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="receive-trnadd-screen">RECEIVE-TRNADD-SCREEN</h3>
<p>This paragraph receives user input from the COTRN2A map within the COTRN02 mapset, storing the data in the COTRN2AI structure. It captures the response and reason codes from the CICS RECEIVE operation to enable error handling. This is a standard CICS data entry pattern that collects transaction details entered by the user before processing them for validation and database operations.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">RECEIVE</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="err">                    </span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="s1">&#39;COTRN2A&#39;</span><span class="p">)</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c">      </span><span class="w">               </span><span class="nv">MAPSET</span><span class="p">(</span><span class="s1">&#39;COTRN02&#39;</span><span class="p">)</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c">      </span><span class="w">               </span><span class="kp">INTO</span><span class="p">(</span><span class="nv">COTRN2AI</span><span class="p">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c">      *                      POPULATE-HEADER-INFO</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="populate-header-info">POPULATE-HEADER-INFO</h3>
<p>This paragraph populates the header information on the COTRN2A screen. It retrieves the current system date and time, then formats and displays this information along with program identification details. The routine first obtains the current date using the CURRENT-DATE function, then transfers title information and transaction/program identifiers to the screen. It then formats the current date into MM/DD/YY format and the current time into HH:MM:SS format before displaying them in their respective screen fields. This provides users with contextual information about when the transaction is being processed and which program they are currently using.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">MOVE F</span><span class="nv">UNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE01</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE01O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE02</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE02O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-PGMNAME</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PGMNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MM</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DD</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-YY</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MM-DD-YY</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURDATEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HOURS</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-HH</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-MINUTE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-MM</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-SECOND</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-SS</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HH-MM-SS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURTIMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span><span class="p">.</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="c">      *                      READ-CXACAIX-FILE</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="read-cxacaix-file">READ-CXACAIX-FILE</h3>
<p>This paragraph performs a lookup in the CXACAIX file (Card Cross-Reference Alternate Index file) using the account ID as the key. It attempts to retrieve the corresponding card cross-reference record to validate that the entered account ID exists in the system. The paragraph handles three possible outcomes: successful retrieval (continues processing), record not found (displays an error message indicating the account ID is invalid), or a file access error (displays a technical error message). When validation fails, the cursor is positioned at the account ID field and the transaction entry screen is redisplayed with the appropriate error message to guide the user.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="kr">READ</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kr">               </span><span class="w"> </span><span class="nv">DATASET</span><span class="w">   </span><span class="p">(</span><span class="nv">WS-CXACAIX-FILE</span><span class="p">)</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">CARD-XREF-RECORD</span><span class="p">)</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-XREF-RECORD</span><span class="p">)</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">XREF-ACCT-ID</span><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">XREF-ACCT-ID</span><span class="p">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">CONTINUE</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">NOTFND</span><span class="p">)</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Account ID NOT found...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;RESP:&#39;</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="s1">&#39;REAS:&#39;</span><span class="w"> </span><span class="nv">WS-REAS-CD</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Unable to lookup Acct in XREF AIX file...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="c">      *                      READ-CCXREF-FILE</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="read-ccxref-file">READ-CCXREF-FILE</h3>
<p>This paragraph performs a CICS READ operation on the card cross-reference file (CCXREF) using the card number as the key. It validates whether the provided card number exists in the system. If the read is successful, processing continues normally. If the card number is not found, the program sets an error flag, displays an appropriate message to the user, positions the cursor at the card number input field, and redisplays the transaction entry screen. For any other database errors, it displays the response and reason codes, sets an error flag with a technical message, and returns to the input screen. This validation ensures that transactions can only be created for valid card numbers that exist in the system.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="kr">READ</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kr">               </span><span class="w"> </span><span class="nv">DATASET</span><span class="w">   </span><span class="p">(</span><span class="nv">WS-CCXREF-FILE</span><span class="p">)</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">CARD-XREF-RECORD</span><span class="p">)</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CARD-XREF-RECORD</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">XREF-CARD-NUM</span><span class="p">)</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">XREF-CARD-NUM</span><span class="p">)</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">CONTINUE</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">NOTFND</span><span class="p">)</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Card Number NOT found...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDNINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;RESP:&#39;</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="s1">&#39;REAS:&#39;</span><span class="w"> </span><span class="nv">WS-REAS-CD</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Unable to lookup Card # in XREF file...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDNINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="c">      *                    STARTBR-TRANSACT-FILE</span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="startbr-transact-file">STARTBR-TRANSACT-FILE</h3>
<p>This paragraph initiates a browse operation on the transaction file to locate records by transaction ID. It uses the CICS STARTBR command to position the file cursor at the specified transaction ID. The paragraph handles three possible outcomes: successful positioning (NORMAL response), transaction ID not found (NOTFND response), or other errors. For error conditions, it sets an error flag, displays an appropriate message to the user, positions the cursor at the account ID field, and redisplays the transaction entry screen. This functionality is part of the transaction lookup process that likely supports the "copy last transaction" feature mentioned in the program description.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="nv">STARTBR</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="w">   </span><span class="p">(</span><span class="nv">WS-TRANSACT-FILE</span><span class="p">)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">TRAN-ID</span><span class="p">)</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="p">)</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="c">      </span><span class="w">             </span><span class="kr">CONTINUE</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">NOTFND</span><span class="p">)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Transaction ID NOT found...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;RESP:&#39;</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="s1">&#39;REAS:&#39;</span><span class="w"> </span><span class="nv">WS-REAS-CD</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Unable to lookup Transaction...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="c">      *                    READPREV-TRANSACT-FILE</span>
<a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="readprev-transact-file">READPREV-TRANSACT-FILE</h3>
<p>This paragraph performs a backward read operation on the TRANSACT file to retrieve the previous transaction record. It uses the CICS READPREV command with the current transaction ID as the key. The paragraph handles three possible outcomes: successful read (continues processing), reaching the beginning of the file (sets transaction ID to zeros), or encountering an error (displays error codes, sets error flag, displays a user message, and repositions the cursor to the account ID field before redisplaying the transaction entry screen). This functionality is likely part of the "copy last transaction" feature, allowing users to navigate backward through transaction records.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="nv">READPREV</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="w">   </span><span class="p">(</span><span class="nv">WS-TRANSACT-FILE</span><span class="p">)</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c">      </span><span class="w">          </span><span class="kp">INTO      </span><span class="p">(</span><span class="nv">TRAN-RECORD</span><span class="p">)</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-RECORD</span><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">TRAN-ID</span><span class="p">)</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="p">)</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">CONTINUE</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">ENDFILE</span><span class="p">)</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROS</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRAN-ID</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;RESP:&#39;</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="s1">&#39;REAS:&#39;</span><span class="w"> </span><span class="nv">WS-REAS-CD</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Unable to lookup Transaction...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="c">      *                    ENDBR-TRANSACT-FILE</span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="endbr-transact-file">ENDBR-TRANSACT-FILE</h3>
<p>This paragraph terminates a browse operation on the TRANSACT file. It issues a CICS ENDBR (End Browse) command for the dataset identified by the working storage variable WS-TRANSACT-FILE. This is typically called after completing sequential processing of transaction records to release resources associated with the browse operation.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="nv">ENDBR</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c">      </span><span class="w">          </span><span class="nv">DATASET</span><span class="w">   </span><span class="p">(</span><span class="nv">WS-TRANSACT-FILE</span><span class="p">)</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="c">      *                    WRITE-TRANSACT-FILE</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="write-transact-file">WRITE-TRANSACT-FILE</h3>
<p>This paragraph handles the writing of a new transaction record to the TRANSACT file and processes the response from the CICS operation. After attempting to write the record, it evaluates the response code and takes appropriate action: on successful completion, it initializes fields, displays a success message with the transaction ID in green text, and refreshes the screen; if a duplicate key/record is detected, it sets an error flag and displays an appropriate message; for any other response, it logs the error codes, sets an error flag, and displays a generic error message. In all cases, the paragraph maintains user interaction by sending the transaction addition screen back to the user with appropriate positioning of the cursor.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="kr">WRITE</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="kr">               </span><span class="w"> </span><span class="nv">DATASET</span><span class="w">   </span><span class="p">(</span><span class="nv">WS-TRANSACT-FILE</span><span class="p">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c">      </span><span class="w">          </span><span class="kp">FROM      </span><span class="p">(</span><span class="nv">TRAN-RECORD</span><span class="p">)</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c">      </span><span class="w">          </span><span class="kp">LENGTH    </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-RECORD</span><span class="p">)</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c">      </span><span class="w">          </span><span class="nv">RIDFLD</span><span class="w">    </span><span class="p">(</span><span class="nv">TRAN-ID</span><span class="p">)</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c">      </span><span class="w">          </span><span class="nv">KEYLENGTH</span><span class="w"> </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="p">)</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP</span><span class="w">      </span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="c">      </span><span class="w">          </span><span class="nv">RESP2</span><span class="w">     </span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">INITIALIZE-ALL-FIELDS</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES            </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHGREEN</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGC</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AO</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">STRING </span><span class="s1">&#39;Transaction added successfully. &#39;</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="c">      </span><span class="w">                                         </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="kp">                     </span><span class="s1">&#39; Your Tran ID is &#39;</span><span class="w"> </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="kp">                         </span><span class="w"> </span><span class="nv">TRAN-ID</span><span class="w">  </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="no">SPACE</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="no">                          </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="kp">                    </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">DUPKEY</span><span class="p">)</span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="nv">DUPREC</span><span class="p">)</span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Tran ID already exist...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;RESP:&#39;</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="s1">&#39;REAS:&#39;</span><span class="w"> </span><span class="nv">WS-REAS-CD</span>
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Unable to Add Transaction...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span>
<a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a>
<a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a><span class="c">      *                    CLEAR-CURRENT-SCREEN</span>
<a id="__codelineno-18-41" name="__codelineno-18-41" href="#__codelineno-18-41"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="clear-current-screen">CLEAR-CURRENT-SCREEN</h3>
<p>This paragraph clears the current transaction entry screen by first initializing all fields to their default values and then redisplaying the transaction addition screen to the user. It provides a way to reset the form when users need to start a new transaction entry from scratch.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="nv">INITIALIZE-ALL-FIELDS</span><span class="p">.</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNADD-SCREEN</span><span class="p">.</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c">      *                    INITIALIZE-ALL-FIELDS</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="initialize-all-fields">INITIALIZE-ALL-FIELDS</h3>
<p>This paragraph initializes all input fields on the transaction entry screen (COTRN2AI) by setting them to spaces. It also positions the cursor at the ACTID field by setting its length field to -1, which is a standard CICS technique for cursor positioning. This initialization ensures the screen is cleared of any previous data when the program starts or when a reset operation is performed, providing users with a clean form for entering new transaction details.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c">MOVE -</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES         </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ACTIDINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CARDNINI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TTYPCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TCATCDI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TRNSRCI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TRNAMTI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TDESCI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TORIGDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="c">      </span><span class="w">                             </span><span class="nv">TPROCDTI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MIDI</span><span class="w">     </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MNAMEI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MCITYI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="c">      </span><span class="w">                             </span><span class="nv">MZIPI</span><span class="w">    </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CONFIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">COTRN2AI</span>
</code></pre></div>
</details>

<h3 id="ws-message">WS-MESSAGE</h3>
<p>This paragraph contains version control information for the CardDemo application. It indicates the specific version (CardDemo_v1.0-15-g27d6c6f-68) and the timestamp when this version was created or last modified (July 19, 2022, at 23:12:34 CDT). This information helps track which version of the code is being used and when it was implemented.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="o">*</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>