
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="COMEN01C.html">
      
      
        <link rel="next" href="COSGN00C.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>CORPT00C - Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
        
        
        
        <link rel="stylesheet" href="assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#corpt00c" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Project Documentation" class="md-header__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CORPT00C
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="CBACT01C.html" class="md-tabs__link">
          
  
  Technical Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-tabs__link">
          
  
  Backlog

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Project Documentation" class="md-nav__button md-logo" aria-label="Project Documentation" data-md-component="logo">
      
  <img src="logo.svg" alt="logo">

    </a>
    Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Technical Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Programs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBACT04C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBACT04C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBCUS01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBCUS01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CBTRN03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CBTRN03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COACTVWC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COACTVWC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COADM01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COADM01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COBIL00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COBIL00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDLIC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDLIC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDSLC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDSLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COCRDUPC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COCRDUPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COMEN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COMEN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="CORPT00C.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CORPT00C
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-section" class="md-nav__link">
    <span class="md-ellipsis">
      CONFIGURATION SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-para" class="md-nav__link">
    <span class="md-ellipsis">
      MAIN-PARA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-enter-key" class="md-nav__link">
    <span class="md-ellipsis">
      PROCESS-ENTER-KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-job-to-intrdr" class="md-nav__link">
    <span class="md-ellipsis">
      SUBMIT-JOB-TO-INTRDR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wirte-jobsub-tdq" class="md-nav__link">
    <span class="md-ellipsis">
      WIRTE-JOBSUB-TDQ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-to-prev-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN-TO-PREV-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-trnrpt-screen" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-TRNRPT-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-to-cics" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN-TO-CICS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-trnrpt-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RECEIVE-TRNRPT-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populate-header-info" class="md-nav__link">
    <span class="md-ellipsis">
      POPULATE-HEADER-INFO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-all-fields" class="md-nav__link">
    <span class="md-ellipsis">
      INITIALIZE-ALL-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ws-message" class="md-nav__link">
    <span class="md-ellipsis">
      WS-MESSAGE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COSGN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COSGN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COTRN02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COTRN02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR00C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR00C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR01C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR01C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR02C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR02C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="COUSR03C.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    COUSR03C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CSUTLDTC.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.6 16.6 4.6-4.6-4.6-4.6L16 6l6 6-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6z"/></svg>
  
  <span class="md-ellipsis">
    CSUTLDTC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="copybooks/CVCRD01Y.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Copybooks
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="jobs/BMSCMP.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Jobs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="backlog/epics/Customer%20Data%20Management%20Infrastructure.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Backlog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-copybooks" class="md-nav__link">
    <span class="md-ellipsis">
      Referenced Copybooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-division" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-section" class="md-nav__link">
    <span class="md-ellipsis">
      CONFIGURATION SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-division" class="md-nav__link">
    <span class="md-ellipsis">
      Data Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-storage-section" class="md-nav__link">
    <span class="md-ellipsis">
      WORKING-STORAGE SECTION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkage-section" class="md-nav__link">
    <span class="md-ellipsis">
      LINKAGE SECTION
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure-division" class="md-nav__link">
    <span class="md-ellipsis">
      Procedure Division
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedure Division">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-para" class="md-nav__link">
    <span class="md-ellipsis">
      MAIN-PARA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-enter-key" class="md-nav__link">
    <span class="md-ellipsis">
      PROCESS-ENTER-KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-job-to-intrdr" class="md-nav__link">
    <span class="md-ellipsis">
      SUBMIT-JOB-TO-INTRDR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wirte-jobsub-tdq" class="md-nav__link">
    <span class="md-ellipsis">
      WIRTE-JOBSUB-TDQ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-to-prev-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN-TO-PREV-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#send-trnrpt-screen" class="md-nav__link">
    <span class="md-ellipsis">
      SEND-TRNRPT-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-to-cics" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN-TO-CICS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receive-trnrpt-screen" class="md-nav__link">
    <span class="md-ellipsis">
      RECEIVE-TRNRPT-SCREEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populate-header-info" class="md-nav__link">
    <span class="md-ellipsis">
      POPULATE-HEADER-INFO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-all-fields" class="md-nav__link">
    <span class="md-ellipsis">
      INITIALIZE-ALL-FIELDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ws-message" class="md-nav__link">
    <span class="md-ellipsis">
      WS-MESSAGE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="corpt00c">CORPT00C</h1>
<h2 id="overview">Overview</h2>
<p>This program (CORPT00C) is a CICS COBOL application that allows users to generate transaction reports by submitting batch jobs from an online interface using an extra partition transient data queue (TDQ). The program provides three report options: monthly, yearly, and custom date range reports. </p>
<p>When executed, the program displays a screen where users can select a report type and specify date parameters for custom reports. After validation of user inputs (including date format validation using the CSUTLDTC utility), the program constructs a JCL job with the appropriate parameters and submits it to the internal reader via the "JOBS" TDQ. The batch job (TRNRPT00) will then execute the transaction report generation process based on the specified date range.</p>
<p>The program includes comprehensive error handling for input validation, ensuring dates are properly formatted and valid before job submission. It also requires user confirmation before submitting the report job. The interface provides navigation options, including the ability to return to a previous menu screen.</p>
<h2 id="metadata">Metadata</h2>
<p><strong>Program ID</strong>: <code>CORPT00C</code></p>
<p><strong>Author</strong>: <code>AWS</code></p>
<h2 id="sequence-diagram">Sequence Diagram</h2>
<pre class="mermaid"><code>sequenceDiagram
    actor User
    participant CORPT00C as "CORPT00C Program"
    participant CORPT0A as "Report Screen"
    participant CSUTLDTC as "Date Validation Utility"
    participant TDQ as "JOBS TDQ"
    participant BatchJob as "TRNRPT00 Batch Job"

    User-&gt;&gt;CORPT00C: Start Transaction

    CORPT00C-&gt;&gt;CORPT00C: MAIN-PARA

    alt First Entry
        CORPT00C-&gt;&gt;CORPT0A: Display Initial Report Screen
    else Re-entry
        CORPT00C-&gt;&gt;CORPT0A: RECEIVE-TRNRPT-SCREEN
        CORPT0A--&gt;&gt;CORPT00C: User Input

        alt ENTER Key
            CORPT00C-&gt;&gt;CORPT00C: PROCESS-ENTER-KEY

            alt Monthly Report
                CORPT00C-&gt;&gt;CORPT00C: Calculate Current Month Date Range
            else Yearly Report
                CORPT00C-&gt;&gt;CORPT00C: Calculate Current Year Date Range
            else Custom Date Range
                CORPT00C-&gt;&gt;CORPT00C: Validate Input Fields

                alt Valid Input Fields
                    CORPT00C-&gt;&gt;CSUTLDTC: Validate Start Date
                    CSUTLDTC--&gt;&gt;CORPT00C: Date Validation Result

                    CORPT00C-&gt;&gt;CSUTLDTC: Validate End Date
                    CSUTLDTC--&gt;&gt;CORPT00C: Date Validation Result
                else Invalid Input
                    CORPT00C-&gt;&gt;CORPT0A: Display Error Message
                end
            else No Report Type Selected
                CORPT00C-&gt;&gt;CORPT0A: Display Error Message
            end

            alt No Errors &amp; No Confirmation Yet
                CORPT00C-&gt;&gt;CORPT0A: Request Confirmation
            else No Errors &amp; Confirmed
                CORPT00C-&gt;&gt;CORPT00C: SUBMIT-JOB-TO-INTRDR

                loop For Each JCL Line
                    CORPT00C-&gt;&gt;CORPT00C: WIRTE-JOBSUB-TDQ
                    CORPT00C-&gt;&gt;TDQ: Write JCL Record
                    TDQ--&gt;&gt;BatchJob: Submit Job
                end

                CORPT00C-&gt;&gt;CORPT0A: Display Submission Confirmation
            end

        else PF3 Key
            CORPT00C-&gt;&gt;CORPT00C: RETURN-TO-PREV-SCREEN
        else Other Key
            CORPT00C-&gt;&gt;CORPT0A: Display Invalid Key Message
        end
    end

    CORPT00C-&gt;&gt;CORPT00C: RETURN-TO-CICS</code></pre>
<h2 id="referenced-copybooks">Referenced Copybooks</h2>
<ul>
<li><a href="copybooks/CSDAT01Y.html"><code>CSDAT01Y</code></a></li>
<li><code>DFHAID</code></li>
<li><a href="copybooks/CVTRA05Y.html"><code>CVTRA05Y</code></a></li>
<li><code>CORPT00</code></li>
<li><a href="copybooks/COCOM01Y.html"><code>COCOM01Y</code></a></li>
<li><code>DFHBMSCA</code></li>
<li><a href="copybooks/COTTL01Y.html"><code>COTTL01Y</code></a></li>
<li><a href="copybooks/CSMSG01Y.html"><code>CSMSG01Y</code></a></li>
</ul>
<h2 id="environment-division">Environment Division</h2>
<h3 id="configuration-section">CONFIGURATION SECTION</h3>
<p>This section would typically contain configuration details for the CORPT00C program, including file assignments, special names, and system dependencies. In this CICS COBOL application, the Configuration Section would define resources needed for the transaction report generation functionality, such as the "JOBS" TDQ used for job submission to the internal reader, any file definitions required for processing, and possibly special names for date handling with the CSUTLDTC utility. However, the specific configuration details are not provided in the snippet.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
</code></pre></div>
</details>

<h2 id="data-division">Data Division</h2>
<h3 id="working-storage-section">WORKING-STORAGE SECTION</h3>
<p>This Working Storage Section defines the data structures used in the CORPT00C program for transaction report generation. It includes variables for program control, error handling, and date processing. Key elements include flags for error handling and processing control, date fields structured in YYYY-MM-DD format for report date ranges, and an extensive JCL job template structure (JOB-DATA) that will be populated and submitted to the internal reader. The section also contains parameters for date validation using the CSUTLDTC utility. The program incorporates several copybooks for common functionality, including screen layouts (CORPT00), title components (COTTL01Y), date handling (CSDAT01Y), messaging (CSMSG01Y), transaction processing (CVTRA05Y), and standard CICS definitions (DFHAID, DFHBMSCA).</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">01 WS-</span><span class="nv">VARIABLES</span><span class="p">.</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-PGMNAME</span><span class="w">                 </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CORPT00C&#39;</span><span class="p">.</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRANID</span><span class="w">                  </span><span class="kt">PIC X(04)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;CR00&#39;</span><span class="p">.</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-MESSAGE</span><span class="w">                 </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRANSACT-FILE</span><span class="w">             </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;TRANSACT&#39;</span><span class="p">.</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-ERR-FLG</span><span class="w">                 </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">ERR-FLG-ON</span><span class="w">                         </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">ERR-FLG-OFF</span><span class="w">                        </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRANSACT-EOF</span><span class="w">            </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">TRANSACT-EOF</span><span class="w">                       </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">TRANSACT-NOT-EOF</span><span class="w">                   </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-SEND-ERASE-FLG</span><span class="w">          </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">SEND-ERASE-YES</span><span class="w">                     </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">SEND-ERASE-NO</span><span class="w">                      </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-END-LOOP</span><span class="w">                </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">END-LOOP-YES</span><span class="w">                       </span><span class="kp">VALUE </span><span class="s1">&#39;Y&#39;</span><span class="p">.</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c">      </span><span class="w">     </span><span class="mi">88 </span><span class="nv">END-LOOP-NO</span><span class="w">                        </span><span class="kp">VALUE </span><span class="s1">&#39;N&#39;</span><span class="p">.</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-RESP-CD</span><span class="w">                 </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-REAS-CD</span><span class="w">                 </span><span class="kt">PIC S9(09)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-REC-COUNT</span><span class="w">               </span><span class="kt">PIC S9(04)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-IDX</span><span class="w">                     </span><span class="kt">PIC S9(04)</span><span class="w"> </span><span class="kt">COMP</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">ZEROS</span><span class="p">.</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-REPORT-NAME</span><span class="w">             </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-START-DATE</span><span class="p">.</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-START-DATE-YYYY</span><span class="w">      </span><span class="kt">PIC X(04)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;-&#39;</span><span class="p">.</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-START-DATE-MM</span><span class="w">        </span><span class="kt">PIC X(02)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;-&#39;</span><span class="p">.</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-START-DATE-DD</span><span class="w">        </span><span class="kt">PIC X(02)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-END-DATE</span><span class="p">.</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-END-DATE-YYYY</span><span class="w">        </span><span class="kt">PIC X(04)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;-&#39;</span><span class="p">.</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-END-DATE-MM</span><span class="w">          </span><span class="kt">PIC X(02)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(01)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;-&#39;</span><span class="p">.</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">WS-END-DATE-DD</span><span class="w">          </span><span class="kt">PIC X(02)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-DATE-FORMAT</span><span class="w">             </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">.</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-NUM-99</span><span class="w">                  </span><span class="kt">PIC 99  </span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-NUM-9999</span><span class="w">                </span><span class="kt">PIC 9999</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-AMT</span><span class="w">                </span><span class="kt">PIC +99999999.99</span><span class="p">.</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">WS-TRAN-DATE</span><span class="w">               </span><span class="kt">PIC X(08)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39;00/00/00&#39;</span><span class="p">.</span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">JCL-RECORD</span><span class="w">                 </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s1">&#39; &#39;</span><span class="p">.</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">JOB-DATA</span><span class="p">.</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="c">      </span><span class="w">  </span><span class="mi">02 </span><span class="nv">JOB-DATA-1</span><span class="p">.</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="kp">         </span><span class="s2">&quot;//TRNRPT00 JOB &#39;TRAN REPORT&#39;,CLASS=A,MSGCLASS=0,&quot;</span><span class="p">.</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="kp">         </span><span class="s2">&quot;// NOTIFY=&amp;SYSUID&quot;</span><span class="p">.</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="kp">         </span><span class="s2">&quot;//*&quot;</span><span class="p">.</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="kp">         </span><span class="s2">&quot;//JOBLIB JCLLIB ORDER=(&#39;AWS.M2.CARDDEMO.PROC&#39;)&quot;</span><span class="p">.</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="kp">         </span><span class="s2">&quot;//*&quot;</span><span class="p">.</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="kp">         </span><span class="s2">&quot;//STEP10 EXEC PROC=TRANREPT&quot;</span><span class="p">.</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="kp">         </span><span class="s2">&quot;//*&quot;</span><span class="p">.</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="kp">         </span><span class="s2">&quot;//STEP05R.SYMNAMES DD *&quot;</span><span class="p">.</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="kp">         </span><span class="s2">&quot;TRAN-CARD-NUM,263,16,ZD&quot;</span><span class="p">.</span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="kp">         </span><span class="s2">&quot;TRAN-PROC-DT,305,10,CH&quot;</span><span class="p">.</span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">FILLER-1</span><span class="p">.</span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(18)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="kp">         </span><span class="s2">&quot;PARM-START-DATE,C&#39;&quot;</span><span class="p">.</span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">PARM-START-DATE-1</span><span class="w">       </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(52)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s2">&quot;&#39;&quot;</span><span class="p">.</span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">FILLER-2</span><span class="p">.</span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(16)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a><span class="kp">         </span><span class="s2">&quot;PARM-END-DATE,C&#39;&quot;</span><span class="p">.</span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">PARM-END-DATE-1</span><span class="w">         </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(54)</span><span class="w"> </span><span class="kp">VALUE </span><span class="s2">&quot;&#39;&quot;</span><span class="p">.</span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a><span class="kp">         </span><span class="s2">&quot;/*&quot;</span><span class="p">.</span>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="kp">         </span><span class="s2">&quot;//STEP10R.DATEPARM DD *&quot;</span><span class="p">.</span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">FILLER-3</span><span class="p">.</span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">PARM-START-DATE-2</span><span class="w">       </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACE</span><span class="p">.</span>
<a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="nv">PARM-END-DATE-2</span><span class="w">         </span><span class="kt">PIC X(10)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a><span class="c">      </span><span class="w">      </span><span class="mi">10 </span><span class="kp">FILLER                 </span><span class="w"> </span><span class="kt">PIC X(59)</span><span class="w"> </span><span class="kp">VALUE</span><span class="w"> </span><span class="no">SPACES</span><span class="p">.</span>
<a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a><span class="kp">         </span><span class="s2">&quot;/*&quot;</span><span class="p">.</span>
<a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="kp">FILLER                    </span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="w"> </span><span class="kp">VALUE</span>
<a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a><span class="kp">         </span><span class="s2">&quot;/*EOF&quot;</span><span class="p">.</span>
<a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a><span class="c">      </span><span class="w">  </span><span class="mi">02 </span><span class="nv">JOB-DATA-2</span><span class="w"> </span><span class="kp">REDEFINES</span><span class="w"> </span><span class="nv">JOB-DATA-1</span><span class="p">.</span>
<a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a><span class="c">      </span><span class="w">   </span><span class="mi">05 </span><span class="nv">JOB-LINES</span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">1000 </span><span class="kp">TIMES</span><span class="w"> </span><span class="kt">PIC X(80)</span><span class="p">.</span>
<a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a>
<a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a><span class="c">      </span><span class="w"> </span><span class="mi">01 </span><span class="nv">CSUTLDTC-PARM</span><span class="p">.</span>
<a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CSUTLDTC-DATE</span><span class="w">                   </span><span class="kt">PIC X(10)</span><span class="p">.</span>
<a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CSUTLDTC-DATE-FORMAT</span><span class="w">            </span><span class="kt">PIC X(10)</span><span class="p">.</span>
<a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a><span class="c">      </span><span class="w">    </span><span class="mi">05 </span><span class="nv">CSUTLDTC-RESULT</span><span class="p">.</span>
<a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CSUTLDTC-RESULT-SEV-CD</span><span class="w">       </span><span class="kt">PIC X(04)</span><span class="p">.</span>
<a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="kp">FILLER                      </span><span class="w"> </span><span class="kt">PIC X(11)</span><span class="p">.</span>
<a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CSUTLDTC-RESULT-MSG-NUM</span><span class="w">      </span><span class="kt">PIC X(04)</span><span class="p">.</span>
<a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a><span class="c">      </span><span class="w">       </span><span class="mi">10 </span><span class="nv">CSUTLDTC-RESULT-MSG</span><span class="w">          </span><span class="kt">PIC X(61)</span><span class="p">.</span>
<a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a>
<a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COCOM01Y</span><span class="p">.</span>
<a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a>
<a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CORPT00</span><span class="p">.</span>
<a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a>
<a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">COTTL01Y</span><span class="p">.</span>
<a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSDAT01Y</span><span class="p">.</span>
<a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CSMSG01Y</span><span class="p">.</span>
<a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a>
<a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">CVTRA05Y</span><span class="p">.</span>
<a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a>
<a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHAID</span><span class="p">.</span>
<a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a><span class="c">      </span><span class="w"> </span><span class="kp">COPY</span><span class="w"> </span><span class="nv">DFHBMSCA</span><span class="p">.</span>
<a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a>
<a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a><span class="c">      *                        LINKAGE SECTION</span>
<a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="linkage-section">LINKAGE SECTION</h3>
<p>This section defines the DFHCOMMAREA in the Linkage Section, which is used to receive and pass data between CICS transactions. It contains a single field, LK-COMMAREA, defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This structure allows the program to handle communication areas of different sizes when the program is invoked from other CICS programs or when control returns to this program after a transfer.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">01  DF</span><span class="nv">HCOMMAREA</span><span class="p">.</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c">      </span><span class="w">   </span><span class="mi">05  </span><span class="nv">LK-COMMAREA</span><span class="w">                           </span><span class="kt">PIC X(01)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kt">            </span><span class="w"> </span><span class="kp">OCCURS</span><span class="w"> </span><span class="mi">1 </span><span class="kp">TO</span><span class="w"> </span><span class="mi">32767 </span><span class="kp">TIMES</span><span class="w"> </span><span class="kp">DEPENDING</span><span class="w"> </span><span class="kp">ON</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="p">.</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c">      *</span>
</code></pre></div>
</details>

<h2 id="procedure-division">Procedure Division</h2>
<h3 id="main-para">MAIN-PARA</h3>
<p>This paragraph serves as the main control flow for the transaction report generation program. It initializes error flags, handles first-time entry versus re-entry to the program, and processes user interactions.</p>
<p>When first entered, the code checks if a communication area exists. If not, it returns to the sign-on program (COSGN00C). For valid entries, it either displays the initial report selection screen or processes user input from a previously displayed screen.</p>
<p>The paragraph implements navigation logic through function key handling - specifically processing ENTER key actions through a separate paragraph and allowing users to return to the menu screen (COMEN01C) via PF3. Any other key inputs trigger an error message.</p>
<p>The code maintains program state between interactions by returning with the transaction ID and communication area, enabling the conversation to continue when the user responds.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">SET ER</span><span class="nv">R-FLG-OFF</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">TRANSACT-NOT-EOF</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nb">          </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">SEND-ERASE-YES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nb">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c">      </span><span class="w">                    </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EIBCALEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="mi">               </span><span class="kr">MOVE </span><span class="s1">&#39;COSGN00C&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">RETURN-TO-PREV-SCREEN</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="kr">              </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHCOMMAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nv">EIBCALEN</span><span class="p">)</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CARDDEMO-COMMAREA</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c">      </span><span class="w">         </span><span class="kr">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c">      </span><span class="w">             </span><span class="kr">SET</span><span class="w"> </span><span class="nv">CDEMO-PGM-REENTER</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">LOW-VALUES         </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MONTHLYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="c">      </span><span class="w">         </span><span class="kr">ELSE</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">RECEIVE-TRNRPT-SCREEN</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="c">      </span><span class="w">             </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">EIBAID</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHENTER</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">PROCESS-ENTER-KEY</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHPF3</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;COMEN01C&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">RETURN-TO-PREV-SCREEN</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="kp">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MONTHLYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-MSG-INVALID-KEY</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="kr">              </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="kr">          </span><span class="w"> </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="kr">RETURN</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="kr">                    </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-TRANID</span><span class="p">)</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="c">      </span><span class="w">               </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="c">      *                      PROCESS-ENTER-KEY</span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="process-enter-key">PROCESS-ENTER-KEY</h3>
<p>This paragraph processes the Enter key action in the transaction report generation interface, handling three report types: monthly, yearly, and custom date range. For monthly and yearly reports, it automatically calculates appropriate date ranges (current month or current year respectively). For custom reports, it performs extensive validation of user-entered dates, checking for empty fields, numeric values, valid ranges (months 1-12, days 1-31), and valid calendar dates using the CSUTLDTC utility. After validation, it prepares the report parameters and calls the SUBMIT-JOB-TO-INTRDR paragraph to submit the batch job. The code includes comprehensive error handling with specific error messages for each validation failure, positioning the cursor at the problematic field. Upon successful submission, it displays a confirmation message indicating which report type was submitted.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">DISPLA</span><span class="nv">Y</span><span class="w"> </span><span class="s1">&#39;PROCESS ENTER KEY&#39;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">MONTHLYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Monthly&#39;</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-REPORT-NAME</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-YYYY</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-MM</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;01&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-DD</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-START-DATE</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PARM-START-DATE-1</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">PARM-START-DATE-2</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1               </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">12</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="mi">                       </span><span class="kr">ADD</span><span class="w"> </span><span class="mi">1           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="mi">1          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-CURDATE-N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">DATE-OF-INTEGER</span><span class="p">(</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="c">      </span><span class="w">                     </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">INTEGER-OF-DATE</span><span class="p">(</span><span class="nv">WS-CURDATE-N</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-YYYY</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-MM</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-DD</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-END-DATE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PARM-END-DATE-1</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">PARM-END-DATE-2</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SUBMIT-JOB-TO-INTRDR</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">YEARLYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="no">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Yearly&#39;</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-REPORT-NAME</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-YYYY</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">WS-END-DATE-YYYY</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;01&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-MM</span>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">WS-START-DATE-DD</span>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-START-DATE</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PARM-START-DATE-1</span>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">PARM-START-DATE-2</span>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;12&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-MM</span>
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;31&#39;</span><span class="w">                </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-DD</span>
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-END-DATE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PARM-END-DATE-1</span>
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">PARM-END-DATE-2</span>
<a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a>
<a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SUBMIT-JOB-TO-INTRDR</span>
<a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CUSTOMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a>
<a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a><span class="no">                  </span><span class="w"> </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a><span class="nb">                      </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">SDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a><span class="ow">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a><span class="no">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Month can NOT be empty...&#39;</span>
<a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-54" name="__codelineno-4-54" href="#__codelineno-4-54"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-55" name="__codelineno-4-55" href="#__codelineno-4-55"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTMML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-56" name="__codelineno-4-56" href="#__codelineno-4-56"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-57" name="__codelineno-4-57" href="#__codelineno-4-57"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">SDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-58" name="__codelineno-4-58" href="#__codelineno-4-58"></a><span class="ow">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-59" name="__codelineno-4-59" href="#__codelineno-4-59"></a><span class="no">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Day can NOT be empty...&#39;</span>
<a id="__codelineno-4-60" name="__codelineno-4-60" href="#__codelineno-4-60"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-61" name="__codelineno-4-61" href="#__codelineno-4-61"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-62" name="__codelineno-4-62" href="#__codelineno-4-62"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTDDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-63" name="__codelineno-4-63" href="#__codelineno-4-63"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-64" name="__codelineno-4-64" href="#__codelineno-4-64"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">SDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-65" name="__codelineno-4-65" href="#__codelineno-4-65"></a><span class="ow">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-66" name="__codelineno-4-66" href="#__codelineno-4-66"></a><span class="no">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Year can NOT be empty...&#39;</span>
<a id="__codelineno-4-67" name="__codelineno-4-67" href="#__codelineno-4-67"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-68" name="__codelineno-4-68" href="#__codelineno-4-68"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-69" name="__codelineno-4-69" href="#__codelineno-4-69"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTYYYYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-70" name="__codelineno-4-70" href="#__codelineno-4-70"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-71" name="__codelineno-4-71" href="#__codelineno-4-71"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">EDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-72" name="__codelineno-4-72" href="#__codelineno-4-72"></a><span class="ow">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-73" name="__codelineno-4-73" href="#__codelineno-4-73"></a><span class="no">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Month can NOT be empty...&#39;</span>
<a id="__codelineno-4-74" name="__codelineno-4-74" href="#__codelineno-4-74"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-75" name="__codelineno-4-75" href="#__codelineno-4-75"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-76" name="__codelineno-4-76" href="#__codelineno-4-76"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTMML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-77" name="__codelineno-4-77" href="#__codelineno-4-77"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-78" name="__codelineno-4-78" href="#__codelineno-4-78"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">EDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-79" name="__codelineno-4-79" href="#__codelineno-4-79"></a><span class="ow">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-80" name="__codelineno-4-80" href="#__codelineno-4-80"></a><span class="no">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Day can NOT be empty...&#39;</span>
<a id="__codelineno-4-81" name="__codelineno-4-81" href="#__codelineno-4-81"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-82" name="__codelineno-4-82" href="#__codelineno-4-82"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-83" name="__codelineno-4-83" href="#__codelineno-4-83"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTDDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-84" name="__codelineno-4-84" href="#__codelineno-4-84"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-85" name="__codelineno-4-85" href="#__codelineno-4-85"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">EDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-86" name="__codelineno-4-86" href="#__codelineno-4-86"></a><span class="ow">                                                  </span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-4-87" name="__codelineno-4-87" href="#__codelineno-4-87"></a><span class="no">                          </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Year can NOT be empty...&#39;</span>
<a id="__codelineno-4-88" name="__codelineno-4-88" href="#__codelineno-4-88"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-89" name="__codelineno-4-89" href="#__codelineno-4-89"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-90" name="__codelineno-4-90" href="#__codelineno-4-90"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTYYYYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-91" name="__codelineno-4-91" href="#__codelineno-4-91"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-92" name="__codelineno-4-92" href="#__codelineno-4-92"></a><span class="c">      </span><span class="w">                 </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-4-93" name="__codelineno-4-93" href="#__codelineno-4-93"></a><span class="kp">                          </span><span class="w"> </span><span class="kr">CONTINUE</span>
<a id="__codelineno-4-94" name="__codelineno-4-94" href="#__codelineno-4-94"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-4-95" name="__codelineno-4-95" href="#__codelineno-4-95"></a>
<a id="__codelineno-4-96" name="__codelineno-4-96" href="#__codelineno-4-96"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span>
<a id="__codelineno-4-97" name="__codelineno-4-97" href="#__codelineno-4-97"></a><span class="nf">                                         </span><span class="p">(</span><span class="nv">SDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-4-98" name="__codelineno-4-98" href="#__codelineno-4-98"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-99" name="__codelineno-4-99" href="#__codelineno-4-99"></a>
<a id="__codelineno-4-100" name="__codelineno-4-100" href="#__codelineno-4-100"></a><span class="c">      </span><span class="w">             </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span>
<a id="__codelineno-4-101" name="__codelineno-4-101" href="#__codelineno-4-101"></a><span class="nf">                                         </span><span class="p">(</span><span class="nv">SDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-4-102" name="__codelineno-4-102" href="#__codelineno-4-102"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-103" name="__codelineno-4-103" href="#__codelineno-4-103"></a>
<a id="__codelineno-4-104" name="__codelineno-4-104" href="#__codelineno-4-104"></a><span class="c">      </span><span class="w">             </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-NUM-9999</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span>
<a id="__codelineno-4-105" name="__codelineno-4-105" href="#__codelineno-4-105"></a><span class="nf">                                           </span><span class="p">(</span><span class="nv">SDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-4-106" name="__codelineno-4-106" href="#__codelineno-4-106"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-NUM-9999</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-107" name="__codelineno-4-107" href="#__codelineno-4-107"></a>
<a id="__codelineno-4-108" name="__codelineno-4-108" href="#__codelineno-4-108"></a><span class="c">      </span><span class="w">             </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span>
<a id="__codelineno-4-109" name="__codelineno-4-109" href="#__codelineno-4-109"></a><span class="nf">                                         </span><span class="p">(</span><span class="nv">EDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-4-110" name="__codelineno-4-110" href="#__codelineno-4-110"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-111" name="__codelineno-4-111" href="#__codelineno-4-111"></a>
<a id="__codelineno-4-112" name="__codelineno-4-112" href="#__codelineno-4-112"></a><span class="c">      </span><span class="w">             </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span>
<a id="__codelineno-4-113" name="__codelineno-4-113" href="#__codelineno-4-113"></a><span class="nf">                                         </span><span class="p">(</span><span class="nv">EDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-4-114" name="__codelineno-4-114" href="#__codelineno-4-114"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-NUM-99</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-115" name="__codelineno-4-115" href="#__codelineno-4-115"></a>
<a id="__codelineno-4-116" name="__codelineno-4-116" href="#__codelineno-4-116"></a><span class="c">      </span><span class="w">             </span><span class="kr">COMPUTE</span><span class="w"> </span><span class="nv">WS-NUM-9999</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">FUNCTION</span><span class="w"> </span><span class="nf">NUMVAL-C</span>
<a id="__codelineno-4-117" name="__codelineno-4-117" href="#__codelineno-4-117"></a><span class="nf">                                           </span><span class="p">(</span><span class="nv">EDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-4-118" name="__codelineno-4-118" href="#__codelineno-4-118"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-NUM-9999</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-119" name="__codelineno-4-119" href="#__codelineno-4-119"></a>
<a id="__codelineno-4-120" name="__codelineno-4-120" href="#__codelineno-4-120"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">SDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-121" name="__codelineno-4-121" href="#__codelineno-4-121"></a><span class="ow">                     </span><span class="w"> </span><span class="nv">SDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;12&#39;</span>
<a id="__codelineno-4-122" name="__codelineno-4-122" href="#__codelineno-4-122"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Not a valid Month...&#39;</span>
<a id="__codelineno-4-123" name="__codelineno-4-123" href="#__codelineno-4-123"></a><span class="c">      </span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-124" name="__codelineno-4-124" href="#__codelineno-4-124"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-125" name="__codelineno-4-125" href="#__codelineno-4-125"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTMML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-126" name="__codelineno-4-126" href="#__codelineno-4-126"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-127" name="__codelineno-4-127" href="#__codelineno-4-127"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-128" name="__codelineno-4-128" href="#__codelineno-4-128"></a>
<a id="__codelineno-4-129" name="__codelineno-4-129" href="#__codelineno-4-129"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">SDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-130" name="__codelineno-4-130" href="#__codelineno-4-130"></a><span class="ow">                     </span><span class="w"> </span><span class="nv">SDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;31&#39;</span>
<a id="__codelineno-4-131" name="__codelineno-4-131" href="#__codelineno-4-131"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Not a valid Day...&#39;</span>
<a id="__codelineno-4-132" name="__codelineno-4-132" href="#__codelineno-4-132"></a><span class="c">      </span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-133" name="__codelineno-4-133" href="#__codelineno-4-133"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-134" name="__codelineno-4-134" href="#__codelineno-4-134"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTDDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-135" name="__codelineno-4-135" href="#__codelineno-4-135"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-136" name="__codelineno-4-136" href="#__codelineno-4-136"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-137" name="__codelineno-4-137" href="#__codelineno-4-137"></a>
<a id="__codelineno-4-138" name="__codelineno-4-138" href="#__codelineno-4-138"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">SDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-4-139" name="__codelineno-4-139" href="#__codelineno-4-139"></a><span class="kp">                      </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Not a valid Year...&#39;</span>
<a id="__codelineno-4-140" name="__codelineno-4-140" href="#__codelineno-4-140"></a><span class="c">      </span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-141" name="__codelineno-4-141" href="#__codelineno-4-141"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-142" name="__codelineno-4-142" href="#__codelineno-4-142"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTYYYYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-143" name="__codelineno-4-143" href="#__codelineno-4-143"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-144" name="__codelineno-4-144" href="#__codelineno-4-144"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-145" name="__codelineno-4-145" href="#__codelineno-4-145"></a>
<a id="__codelineno-4-146" name="__codelineno-4-146" href="#__codelineno-4-146"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-147" name="__codelineno-4-147" href="#__codelineno-4-147"></a><span class="ow">                     </span><span class="w"> </span><span class="nv">EDTMMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;12&#39;</span>
<a id="__codelineno-4-148" name="__codelineno-4-148" href="#__codelineno-4-148"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Not a valid Month...&#39;</span>
<a id="__codelineno-4-149" name="__codelineno-4-149" href="#__codelineno-4-149"></a><span class="c">      </span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-150" name="__codelineno-4-150" href="#__codelineno-4-150"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-151" name="__codelineno-4-151" href="#__codelineno-4-151"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTMML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-152" name="__codelineno-4-152" href="#__codelineno-4-152"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-153" name="__codelineno-4-153" href="#__codelineno-4-153"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-154" name="__codelineno-4-154" href="#__codelineno-4-154"></a>
<a id="__codelineno-4-155" name="__codelineno-4-155" href="#__codelineno-4-155"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-4-156" name="__codelineno-4-156" href="#__codelineno-4-156"></a><span class="ow">                     </span><span class="w"> </span><span class="nv">EDTDDI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;31&#39;</span>
<a id="__codelineno-4-157" name="__codelineno-4-157" href="#__codelineno-4-157"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Not a valid Day...&#39;</span>
<a id="__codelineno-4-158" name="__codelineno-4-158" href="#__codelineno-4-158"></a><span class="c">      </span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-159" name="__codelineno-4-159" href="#__codelineno-4-159"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-160" name="__codelineno-4-160" href="#__codelineno-4-160"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTDDL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-161" name="__codelineno-4-161" href="#__codelineno-4-161"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-162" name="__codelineno-4-162" href="#__codelineno-4-162"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-163" name="__codelineno-4-163" href="#__codelineno-4-163"></a>
<a id="__codelineno-4-164" name="__codelineno-4-164" href="#__codelineno-4-164"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">EDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">IS</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="kp">NUMERIC</span>
<a id="__codelineno-4-165" name="__codelineno-4-165" href="#__codelineno-4-165"></a><span class="kp">                      </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Not a valid Year...&#39;</span>
<a id="__codelineno-4-166" name="__codelineno-4-166" href="#__codelineno-4-166"></a><span class="c">      </span><span class="w">                   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-167" name="__codelineno-4-167" href="#__codelineno-4-167"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-168" name="__codelineno-4-168" href="#__codelineno-4-168"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTYYYYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-169" name="__codelineno-4-169" href="#__codelineno-4-169"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-170" name="__codelineno-4-170" href="#__codelineno-4-170"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-171" name="__codelineno-4-171" href="#__codelineno-4-171"></a>
<a id="__codelineno-4-172" name="__codelineno-4-172" href="#__codelineno-4-172"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">SDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-YYYY</span>
<a id="__codelineno-4-173" name="__codelineno-4-173" href="#__codelineno-4-173"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">SDTMMI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-MM</span>
<a id="__codelineno-4-174" name="__codelineno-4-174" href="#__codelineno-4-174"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">SDTDDI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-START-DATE-DD</span>
<a id="__codelineno-4-175" name="__codelineno-4-175" href="#__codelineno-4-175"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">EDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-YYYY</span>
<a id="__codelineno-4-176" name="__codelineno-4-176" href="#__codelineno-4-176"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">EDTMMI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-MM</span>
<a id="__codelineno-4-177" name="__codelineno-4-177" href="#__codelineno-4-177"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">EDTDDI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-END-DATE-DD</span>
<a id="__codelineno-4-178" name="__codelineno-4-178" href="#__codelineno-4-178"></a>
<a id="__codelineno-4-179" name="__codelineno-4-179" href="#__codelineno-4-179"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-START-DATE</span><span class="w">        </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-4-180" name="__codelineno-4-180" href="#__codelineno-4-180"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-DATE-FORMAT</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-4-181" name="__codelineno-4-181" href="#__codelineno-4-181"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-4-182" name="__codelineno-4-182" href="#__codelineno-4-182"></a>
<a id="__codelineno-4-183" name="__codelineno-4-183" href="#__codelineno-4-183"></a><span class="c">      </span><span class="w">             </span><span class="kr">CALL </span><span class="s1">&#39;CSUTLDTC&#39;</span><span class="w"> </span><span class="kp">USING  </span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-4-184" name="__codelineno-4-184" href="#__codelineno-4-184"></a><span class="c">      </span><span class="w">                                     </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-4-185" name="__codelineno-4-185" href="#__codelineno-4-185"></a><span class="c">      </span><span class="w">                                     </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-4-186" name="__codelineno-4-186" href="#__codelineno-4-186"></a>
<a id="__codelineno-4-187" name="__codelineno-4-187" href="#__codelineno-4-187"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-SEV-CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0000&#39;</span>
<a id="__codelineno-4-188" name="__codelineno-4-188" href="#__codelineno-4-188"></a><span class="c">      </span><span class="w">                 </span><span class="kr">CONTINUE</span>
<a id="__codelineno-4-189" name="__codelineno-4-189" href="#__codelineno-4-189"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">ELSE</span>
<a id="__codelineno-4-190" name="__codelineno-4-190" href="#__codelineno-4-190"></a><span class="kr">                      </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-MSG-NUM</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2513&#39;</span>
<a id="__codelineno-4-191" name="__codelineno-4-191" href="#__codelineno-4-191"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Start Date - Not a valid date...&#39;</span>
<a id="__codelineno-4-192" name="__codelineno-4-192" href="#__codelineno-4-192"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-193" name="__codelineno-4-193" href="#__codelineno-4-193"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-194" name="__codelineno-4-194" href="#__codelineno-4-194"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">SDTMML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-195" name="__codelineno-4-195" href="#__codelineno-4-195"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-196" name="__codelineno-4-196" href="#__codelineno-4-196"></a><span class="c">      </span><span class="w">                 </span><span class="kr">END-IF</span>
<a id="__codelineno-4-197" name="__codelineno-4-197" href="#__codelineno-4-197"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-4-198" name="__codelineno-4-198" href="#__codelineno-4-198"></a>
<a id="__codelineno-4-199" name="__codelineno-4-199" href="#__codelineno-4-199"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-END-DATE</span><span class="w">          </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-4-200" name="__codelineno-4-200" href="#__codelineno-4-200"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-DATE-FORMAT</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-4-201" name="__codelineno-4-201" href="#__codelineno-4-201"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">SPACES              </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-4-202" name="__codelineno-4-202" href="#__codelineno-4-202"></a>
<a id="__codelineno-4-203" name="__codelineno-4-203" href="#__codelineno-4-203"></a><span class="c">      </span><span class="w">             </span><span class="kr">CALL </span><span class="s1">&#39;CSUTLDTC&#39;</span><span class="w"> </span><span class="kp">USING  </span><span class="w"> </span><span class="nv">CSUTLDTC-DATE</span>
<a id="__codelineno-4-204" name="__codelineno-4-204" href="#__codelineno-4-204"></a><span class="c">      </span><span class="w">                                     </span><span class="nv">CSUTLDTC-DATE-FORMAT</span>
<a id="__codelineno-4-205" name="__codelineno-4-205" href="#__codelineno-4-205"></a><span class="c">      </span><span class="w">                                     </span><span class="nv">CSUTLDTC-RESULT</span>
<a id="__codelineno-4-206" name="__codelineno-4-206" href="#__codelineno-4-206"></a>
<a id="__codelineno-4-207" name="__codelineno-4-207" href="#__codelineno-4-207"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-SEV-CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0000&#39;</span>
<a id="__codelineno-4-208" name="__codelineno-4-208" href="#__codelineno-4-208"></a><span class="c">      </span><span class="w">                 </span><span class="kr">CONTINUE</span>
<a id="__codelineno-4-209" name="__codelineno-4-209" href="#__codelineno-4-209"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">ELSE</span>
<a id="__codelineno-4-210" name="__codelineno-4-210" href="#__codelineno-4-210"></a><span class="kr">                      </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="nv">CSUTLDTC-RESULT-MSG-NUM</span><span class="w"> </span><span class="ow">NOT </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2513&#39;</span>
<a id="__codelineno-4-211" name="__codelineno-4-211" href="#__codelineno-4-211"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;End Date - Not a valid date...&#39;</span>
<a id="__codelineno-4-212" name="__codelineno-4-212" href="#__codelineno-4-212"></a><span class="c">      </span><span class="w">                       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-213" name="__codelineno-4-213" href="#__codelineno-4-213"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-214" name="__codelineno-4-214" href="#__codelineno-4-214"></a><span class="c">      </span><span class="w">                     </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">EDTMML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-215" name="__codelineno-4-215" href="#__codelineno-4-215"></a><span class="c">      </span><span class="w">                     </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-216" name="__codelineno-4-216" href="#__codelineno-4-216"></a><span class="c">      </span><span class="w">                 </span><span class="kr">END-IF</span>
<a id="__codelineno-4-217" name="__codelineno-4-217" href="#__codelineno-4-217"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-4-218" name="__codelineno-4-218" href="#__codelineno-4-218"></a>
<a id="__codelineno-4-219" name="__codelineno-4-219" href="#__codelineno-4-219"></a>
<a id="__codelineno-4-220" name="__codelineno-4-220" href="#__codelineno-4-220"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-START-DATE</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PARM-START-DATE-1</span>
<a id="__codelineno-4-221" name="__codelineno-4-221" href="#__codelineno-4-221"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">PARM-START-DATE-2</span>
<a id="__codelineno-4-222" name="__codelineno-4-222" href="#__codelineno-4-222"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-END-DATE</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PARM-END-DATE-1</span>
<a id="__codelineno-4-223" name="__codelineno-4-223" href="#__codelineno-4-223"></a><span class="c">      </span><span class="w">                                         </span><span class="nv">PARM-END-DATE-2</span>
<a id="__codelineno-4-224" name="__codelineno-4-224" href="#__codelineno-4-224"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Custom&#39;</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-REPORT-NAME</span>
<a id="__codelineno-4-225" name="__codelineno-4-225" href="#__codelineno-4-225"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">ERR-FLG-ON</span>
<a id="__codelineno-4-226" name="__codelineno-4-226" href="#__codelineno-4-226"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SUBMIT-JOB-TO-INTRDR</span>
<a id="__codelineno-4-227" name="__codelineno-4-227" href="#__codelineno-4-227"></a><span class="c">      </span><span class="w">             </span><span class="kr">END-IF</span>
<a id="__codelineno-4-228" name="__codelineno-4-228" href="#__codelineno-4-228"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-4-229" name="__codelineno-4-229" href="#__codelineno-4-229"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;Select a report type to print report...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-4-230" name="__codelineno-4-230" href="#__codelineno-4-230"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-231" name="__codelineno-4-231" href="#__codelineno-4-231"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-4-232" name="__codelineno-4-232" href="#__codelineno-4-232"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MONTHLYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-233" name="__codelineno-4-233" href="#__codelineno-4-233"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-234" name="__codelineno-4-234" href="#__codelineno-4-234"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-4-235" name="__codelineno-4-235" href="#__codelineno-4-235"></a>
<a id="__codelineno-4-236" name="__codelineno-4-236" href="#__codelineno-4-236"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">ERR-FLG-ON</span>
<a id="__codelineno-4-237" name="__codelineno-4-237" href="#__codelineno-4-237"></a>
<a id="__codelineno-4-238" name="__codelineno-4-238" href="#__codelineno-4-238"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">INITIALIZE-ALL-FIELDS</span>
<a id="__codelineno-4-239" name="__codelineno-4-239" href="#__codelineno-4-239"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">DFHGREEN</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGC</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-4-240" name="__codelineno-4-240" href="#__codelineno-4-240"></a><span class="c">      </span><span class="w">         </span><span class="kr">STRING</span><span class="w"> </span><span class="nv">WS-REPORT-NAME</span><span class="w">   </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="no">SPACE</span>
<a id="__codelineno-4-241" name="__codelineno-4-241" href="#__codelineno-4-241"></a><span class="no">                 </span><span class="s1">&#39; report submitted for printing ...&#39;</span>
<a id="__codelineno-4-242" name="__codelineno-4-242" href="#__codelineno-4-242"></a><span class="c">      </span><span class="w">                                 </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-4-243" name="__codelineno-4-243" href="#__codelineno-4-243"></a><span class="kp">                </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-4-244" name="__codelineno-4-244" href="#__codelineno-4-244"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MONTHLYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-4-245" name="__codelineno-4-245" href="#__codelineno-4-245"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-4-246" name="__codelineno-4-246" href="#__codelineno-4-246"></a>
<a id="__codelineno-4-247" name="__codelineno-4-247" href="#__codelineno-4-247"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span><span class="p">.</span>
<a id="__codelineno-4-248" name="__codelineno-4-248" href="#__codelineno-4-248"></a>
<a id="__codelineno-4-249" name="__codelineno-4-249" href="#__codelineno-4-249"></a>
<a id="__codelineno-4-250" name="__codelineno-4-250" href="#__codelineno-4-250"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-4-251" name="__codelineno-4-251" href="#__codelineno-4-251"></a><span class="c">      *                      SUBMIT-JOB-TO-INTRDR</span>
<a id="__codelineno-4-252" name="__codelineno-4-252" href="#__codelineno-4-252"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="submit-job-to-intrdr">SUBMIT-JOB-TO-INTRDR</h3>
<p>This paragraph handles the job submission confirmation process and writes the JCL to the transient data queue. It first checks if the user has provided confirmation input. If not, it prompts the user to confirm the report generation. When confirmation is provided, it validates the response ('Y' or 'N'), either continuing with job submission for 'Y' or reinitializing the screen for 'N'. For invalid confirmation values, it displays an error message. Once confirmed, the paragraph iterates through the pre-constructed JCL statements in the JOB-LINES array, writing each line to the JOBS transient data queue until it encounters an end marker ('/*EOF') or empty line. This effectively submits the batch job to the internal reader for execution.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">IF CON</span><span class="nv">FIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="no">              </span><span class="w"> </span><span class="kr">STRING</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kr">                 </span><span class="s1">&#39;Please confirm to print the &#39;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c">      </span><span class="w">                             </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="kp">                </span><span class="w"> </span><span class="nv">WS-REPORT-NAME</span><span class="w">    </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="no">SPACE</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="no">                 </span><span class="s1">&#39; report...&#39;</span><span class="w">      </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="kp">                </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="c">      </span><span class="w">         </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CONFIRML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c">      </span><span class="w">         </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="kr">          </span><span class="w"> </span><span class="kr">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="nv">ERR-FLG-ON</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c">      </span><span class="w">         </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="nb">                  </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CONFIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Y&#39;</span><span class="w"> </span><span class="ow">OR </span><span class="s1">&#39;y&#39;</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="c">      </span><span class="w">                 </span><span class="kr">CONTINUE</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="kr">                  </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">CONFIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="ow">OR </span><span class="s1">&#39;n&#39;</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">INITIALIZE-ALL-FIELDS</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="c">      </span><span class="w">             </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="kp">                      </span><span class="w"> </span><span class="kr">STRING</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="kr">                         </span><span class="s1">&#39;&quot;&#39;</span><span class="w">               </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="kp">                        </span><span class="w"> </span><span class="nv">CONFIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span><span class="w">    </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="no">SPACE</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="no">                         </span><span class="s1">&#39;&quot; is not a valid value to confirm...&#39;</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="c">      </span><span class="w">                                     </span><span class="kp">DELIMITED</span><span class="w"> </span><span class="kp">BY</span><span class="w"> </span><span class="kp">SIZE</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="kp">                        </span><span class="w"> </span><span class="kp">INTO</span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="c">      </span><span class="w">                 </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CONFIRML</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="c">      </span><span class="w">                 </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="c">      </span><span class="w">         </span><span class="kr">END-EVALUATE</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="kr">              </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">END-LOOP-NO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="nb">              </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="kp">VARYING</span><span class="w"> </span><span class="nv">WS-IDX</span><span class="w"> </span><span class="kp">FROM</span><span class="w"> </span><span class="mi">1 </span><span class="kp">BY</span><span class="w"> </span><span class="mi">1 </span><span class="kp">UNTIL</span><span class="w"> </span><span class="nv">WS-IDX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000 </span><span class="ow">OR</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="ow">                                     </span><span class="w"> </span><span class="nv">END-LOOP-YES</span><span class="w">  </span><span class="ow">OR</span><span class="w"> </span><span class="nv">ERR-FLG-ON</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">JOB-LINES</span><span class="p">(</span><span class="nv">WS-IDX</span><span class="p">)</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">JCL-RECORD</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="c">      </span><span class="w">             </span><span class="kr">IF</span><span class="w"> </span><span class="nv">JCL-RECORD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;/*EOF&#39;</span><span class="w"> </span><span class="ow">OR</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="ow">                     </span><span class="w"> </span><span class="nv">JCL-RECORD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SPACES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">LOW-VALUES</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="no">                      </span><span class="w"> </span><span class="kr">SET</span><span class="w"> </span><span class="nv">END-LOOP-YES</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nb">TRUE</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="nb">                  </span><span class="w"> </span><span class="kr">END-IF</span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="kr">                  </span><span class="w"> </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">WIRTE-JOBSUB-TDQ</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="c">      </span><span class="w">         </span><span class="kr">END-PERFORM</span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="kr">          </span><span class="w"> </span><span class="kr">END-IF</span><span class="p">.</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="c">      *                      WIRTE-JOBSUB-TDQ</span>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="wirte-jobsub-tdq">WIRTE-JOBSUB-TDQ</h3>
<p>This paragraph handles the submission of JCL job records to the "JOBS" transient data queue (TDQ) which serves as an interface to the internal reader. It writes the constructed JCL record to the queue and implements error handling logic. If the operation completes normally, processing continues. For any other response code, the paragraph displays diagnostic information (response and reason codes), sets an error flag, prepares an error message for the user, positions the cursor at the MONTHLY field on the input screen, and then calls the SEND-TRNRPT-SCREEN paragraph to display the error to the user. This is a critical component of the job submission process that ensures proper feedback when the TDQ write operation fails.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="nv">WRITEQ</span><span class="w"> </span><span class="nv">TD</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c">      </span><span class="w">       </span><span class="err">QUEUE </span><span class="p">(</span><span class="s1">&#39;JOBS&#39;</span><span class="p">)</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c">      </span><span class="w">       </span><span class="kp">FROM </span><span class="p">(</span><span class="nv">JCL-RECORD</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c">      </span><span class="w">       </span><span class="kp">LENGTH </span><span class="p">(</span><span class="kp">LENGTH</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">JCL-RECORD</span><span class="p">)</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c">      </span><span class="w">       </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c">      </span><span class="w">       </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">EVALUATE</span><span class="w"> </span><span class="nv">WS-RESP-CD</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c">      </span><span class="w">         </span><span class="kp">WHEN</span><span class="w"> </span><span class="nv">DFHRESP</span><span class="p">(</span><span class="err">NORMAL</span><span class="p">)</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c">      </span><span class="w">             </span><span class="kr">CONTINUE</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="kr">              </span><span class="w"> </span><span class="kp">WHEN</span><span class="w"> </span><span class="kp">OTHER</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="kp">                  </span><span class="w"> </span><span class="kr">DISPLAY </span><span class="s1">&#39;RESP:&#39;</span><span class="w"> </span><span class="nv">WS-RESP-CD</span><span class="w"> </span><span class="s1">&#39;REAS:&#39;</span><span class="w"> </span><span class="nv">WS-REAS-CD</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Y&#39;</span><span class="w">     </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-ERR-FLG</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE </span><span class="s1">&#39;Unable to Write TDQ (JOBS)...&#39;</span><span class="w"> </span><span class="kp">TO</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="kp">                                  </span><span class="w"> </span><span class="nv">WS-MESSAGE</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="c">      </span><span class="w">             </span><span class="kr">MOVE</span><span class="w"> </span><span class="o">-</span><span class="mi">1       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MONTHLYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c">      </span><span class="w">             </span><span class="kr">PERFORM</span><span class="w"> </span><span class="nv">SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-EVALUATE</span><span class="p">.</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="c">      *                      RETURN-TO-PREV-SCREEN</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="return-to-prev-screen">RETURN-TO-PREV-SCREEN</h3>
<p>This paragraph handles the navigation back to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, and if not, defaults to 'COSGN00C' (likely the main menu or sign-on screen). It then sets up the communication area with the current transaction ID and program name as the source of the transfer, resets the program context to zeros, and uses the CICS XCTL command to transfer control to the target program while passing the communication area. This provides a consistent navigation mechanism throughout the application.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c">IF CDE</span><span class="nv">MO-TO-PROGRAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">LOW-VALUES</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="no">SPACES</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="no">              </span><span class="w"> </span><span class="kr">MOVE </span><span class="s1">&#39;COSGN00C&#39;</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-TO-PROGRAM</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="kr">          </span><span class="w"> </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-TRANID</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-PGMNAME</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-FROM-PROGRAM</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="no">ZEROS       </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CDEMO-PGM-CONTEXT</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c">      </span><span class="w">         </span><span class="nv">XCTL</span><span class="w"> </span><span class="kp">PROGRAM</span><span class="p">(</span><span class="nv">CDEMO-TO-PROGRAM</span><span class="p">)</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c">      </span><span class="w">         </span><span class="nv">COMMAREA</span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c">      *                      SEND-TRNRPT-SCREEN</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="send-trnrpt-screen">SEND-TRNRPT-SCREEN</h3>
<p>This paragraph handles the display of the transaction report screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up common header information, then displays any system messages stored in WS-MESSAGE to the user. The paragraph uses conditional logic to determine whether to send the screen with the ERASE option (which clears the screen before displaying) or without it, based on the SEND-ERASE-YES flag. In both cases, it sends the CORPT0A map from the CORPT00 mapset with cursor positioning. After sending the screen, it transfers control to the RETURN-TO-CICS paragraph to return control to CICS.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">PERFOR</span><span class="nv">M</span><span class="w"> </span><span class="nv">POPULATE-HEADER-INFO</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-MESSAGE</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">ERRMSGO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">IF</span><span class="w"> </span><span class="nv">SEND-ERASE-YES</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c">      </span><span class="w">         </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="err">                        </span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="s1">&#39;CORPT0A&#39;</span><span class="p">)</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c">      </span><span class="w">                   </span><span class="nv">MAPSET</span><span class="p">(</span><span class="s1">&#39;CORPT00&#39;</span><span class="p">)</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c">      </span><span class="w">                   </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">CORPT0AO</span><span class="p">)</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c">      </span><span class="w">                   </span><span class="kp">ERASE</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="kp">                        </span><span class="w"> </span><span class="kp">CURSOR</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="kp">              </span><span class="w"> </span><span class="nv">END-EXEC</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c">      </span><span class="w">     </span><span class="kr">ELSE</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="kr">              </span><span class="w"> </span><span class="nv">EXEC</span><span class="w"> </span><span class="nv">CICS</span><span class="w"> </span><span class="err">SEND</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="err">                        </span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="s1">&#39;CORPT0A&#39;</span><span class="p">)</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c">      </span><span class="w">                   </span><span class="nv">MAPSET</span><span class="p">(</span><span class="s1">&#39;CORPT00&#39;</span><span class="p">)</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="c">      </span><span class="w">                   </span><span class="kp">FROM</span><span class="p">(</span><span class="nv">CORPT0AO</span><span class="p">)</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="c">      *                  ERASE</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c">      </span><span class="w">                   </span><span class="kp">CURSOR</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="kp">              </span><span class="w"> </span><span class="nv">END-EXEC</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="c">      </span><span class="w">     </span><span class="kr">END-IF</span><span class="p">.</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="c">      </span><span class="w">     </span><span class="kr">GO</span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">RETURN-TO-CICS</span><span class="p">.</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="c">      *                         RETURN-TO-CICS</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="return-to-cics">RETURN-TO-CICS</h3>
<p>This paragraph handles the return to CICS control after processing is complete. It executes a CICS RETURN command that specifies the transaction ID stored in WS-TRANID and passes the CARDDEMO-COMMAREA as the communication area for the next transaction. The LENGTH parameter is commented out, which means the system will use the default length of the COMMAREA. This is typically used at the end of processing to either terminate the transaction or to pass control back to CICS for the next transaction execution.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="kr">RETURN</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kr">                    </span><span class="w"> </span><span class="nv">TRANSID</span><span class="w"> </span><span class="p">(</span><span class="nv">WS-TRANID</span><span class="p">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c">      </span><span class="w">               </span><span class="nv">COMMAREA</span><span class="w"> </span><span class="p">(</span><span class="nv">CARDDEMO-COMMAREA</span><span class="p">)</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c">      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="c">      *                      RECEIVE-TRNRPT-SCREEN</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="receive-trnrpt-screen">RECEIVE-TRNRPT-SCREEN</h3>
<p>This paragraph receives user input from the transaction report selection screen (CORPT0A) into the input map area (CORPT0AI). It captures the user's report type selection and date parameters entered on the screen. The CICS RECEIVE command stores response codes in WS-RESP-CD and WS-REAS-CD variables for error handling. After receiving the screen data, control will flow to the POPULATE-HEADER-INFO paragraph which likely prepares common header information for the interface.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c">EXEC C</span><span class="nv">ICS</span><span class="w"> </span><span class="err">RECEIVE</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="err">                    </span><span class="w"> </span><span class="nv">MAP</span><span class="p">(</span><span class="s1">&#39;CORPT0A&#39;</span><span class="p">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c">      </span><span class="w">               </span><span class="nv">MAPSET</span><span class="p">(</span><span class="s1">&#39;CORPT00&#39;</span><span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c">      </span><span class="w">               </span><span class="kp">INTO</span><span class="p">(</span><span class="nv">CORPT0AI</span><span class="p">)</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP</span><span class="p">(</span><span class="nv">WS-RESP-CD</span><span class="p">)</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c">      </span><span class="w">               </span><span class="nv">RESP2</span><span class="p">(</span><span class="nv">WS-REAS-CD</span><span class="p">)</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c">      </span><span class="w">     </span><span class="nv">END-EXEC</span><span class="p">.</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c">      *                      POPULATE-HEADER-INFO</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="populate-header-info">POPULATE-HEADER-INFO</h3>
<p>This paragraph populates the header information for the transaction report screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information on the screen. The paragraph sets the screen title fields from constants, displays the transaction ID and program name, and formats the current date in MM/DD/YY format and the current time in HH:MM:SS format for display. This ensures the user interface shows accurate identifying information and timestamps when generating transaction reports.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">MOVE F</span><span class="nv">UNCTION</span><span class="w"> </span><span class="nf">CURRENT-DATE </span><span class="w"> </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DATA</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE01</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE01O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">CCDA-TITLE02</span><span class="w">           </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TITLE02O</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-TRANID</span><span class="w">              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">TRNNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-PGMNAME</span><span class="w">             </span><span class="kp">TO</span><span class="w"> </span><span class="nv">PGMNAMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MONTH</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-MM</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-DAY</span><span class="w">         </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-DD</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-YEAR</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURDATE-YY</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURDATE-MM-DD-YY</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURDATEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HOURS</span><span class="w">       </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-HH</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-MINUTE</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-MM</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-SECOND</span><span class="w">      </span><span class="kp">TO</span><span class="w"> </span><span class="nv">WS-CURTIME-SS</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="c">      </span><span class="w">     </span><span class="kr">MOVE</span><span class="w"> </span><span class="nv">WS-CURTIME-HH-MM-SS</span><span class="w">    </span><span class="kp">TO</span><span class="w"> </span><span class="nv">CURTIMEO</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AO</span><span class="p">.</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="c">      *----------------------------------------------------------------*</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="c">      *                      INITIALIZE-ALL-FIELDS</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="c">      *----------------------------------------------------------------*</span>
</code></pre></div>
</details>

<h3 id="initialize-all-fields">INITIALIZE-ALL-FIELDS</h3>
<p>This paragraph initializes the input fields on the transaction report generation screen. It first positions the cursor at the MONTHLY field by setting its length attribute to -1, then clears all input fields including report type selection options (MONTHLY, YEARLY, CUSTOM), start date components (month, day, year), end date components (month, day, year), and the confirmation field. This ensures the screen is reset to a clean state when the user first accesses the report generation interface or when fields need to be cleared during processing.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">MOVE -</span><span class="mi">1              </span><span class="kp">TO</span><span class="w"> </span><span class="nv">MONTHLYL</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c">      </span><span class="w">     </span><span class="kr">INITIALIZE             </span><span class="w"> </span><span class="nv">MONTHLYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c">      </span><span class="w">                             </span><span class="nv">YEARLYI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CUSTOMI</span><span class="w">  </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">      </span><span class="w">                             </span><span class="nv">SDTMMI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c">      </span><span class="w">                             </span><span class="nv">SDTDDI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c">      </span><span class="w">                             </span><span class="nv">SDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c">      </span><span class="w">                             </span><span class="nv">EDTMMI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c">      </span><span class="w">                             </span><span class="nv">EDTDDI</span><span class="w">   </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="c">      </span><span class="w">                             </span><span class="nv">EDTYYYYI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="c">      </span><span class="w">                             </span><span class="nv">CONFIRMI</span><span class="w"> </span><span class="kp">OF</span><span class="w"> </span><span class="nv">CORPT0AI</span>
</code></pre></div>
</details>

<h3 id="ws-message">WS-MESSAGE</h3>
<p>This paragraph contains version control information for the CORPT00C program, showing it's part of the CardDemo application version 1.0-15-g27d6c6f-68, with a timestamp of July 19, 2022, at 23:12:33 CDT. This helps track which version of the code is deployed and when it was last updated.</p>
<details><summary>Code</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">*</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c">      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c">      *</span>
</code></pre></div>
</details>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.top", "navigation.prune"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>