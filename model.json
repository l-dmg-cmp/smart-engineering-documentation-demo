{
  "programs": [
    {
      "id": "CBCUS01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.\n           SELECT CUSTFILE-FILE ASSIGN TO   CUSTFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS SEQUENTIAL\n                  RECORD KEY   IS FD-CUST-ID\n                  FILE STATUS  IS CUSTFILE-STATUS.\n      *",
            "description": "This section defines the file control parameters for the CUSTFILE-FILE, which is the indexed VSAM customer file used by the program. It specifies that the file will be accessed sequentially, uses FD-CUST-ID as the primary key field, and assigns CUSTFILE-STATUS as the file status field for error handling. The file is externally referenced by the CUSTFILE assignment name, allowing the actual file to be defined outside the program."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  CUSTFILE-FILE.\n       01  FD-CUSTFILE-REC.\n           05 FD-CUST-ID                        PIC 9(09).\n           05 FD-CUST-DATA                      PIC X(491).",
            "description": "This section defines the file structure for the CUSTFILE-FILE, which contains customer records. Each record consists of a 9-digit numeric customer ID field (FD-CUST-ID) followed by a 491-character data field (FD-CUST-DATA) that holds the remaining customer information. This structure allows the program to access the customer ID separately from the rest of the customer data when processing records from the indexed VSAM file."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************\n       COPY CVCUS01Y.\n       01  CUSTFILE-STATUS.\n           05  CUSTFILE-STAT1      PIC X.\n           05  CUSTFILE-STAT2      PIC X.\n\n       01  IO-STATUS.\n           05  IO-STAT1            PIC X.\n           05  IO-STAT2            PIC X.\n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.\n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.\n           05  TWO-BYTES-LEFT      PIC X.\n           05  TWO-BYTES-RIGHT     PIC X.\n       01  IO-STATUS-04.\n           05  IO-STATUS-0401      PIC 9   VALUE 0.\n           05  IO-STATUS-0403      PIC 999 VALUE 0.\n\n       01  APPL-RESULT             PIC S9(9)   COMP.\n           88  APPL-AOK            VALUE 0.\n           88  APPL-EOF            VALUE 16.\n\n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.\n       01  ABCODE                  PIC S9(9) BINARY.\n       01  TIMING                  PIC S9(9) BINARY. \n\n      *****************************************************************",
            "description": "This Working-Storage Section defines the data structures used for file status tracking and error handling in the CBCUS01C program. It includes the CVCUS01Y copybook and defines several status fields for monitoring VSAM file operations, including CUSTFILE-STATUS and IO-STATUS. The section contains binary fields for conversion purposes, condition codes for application processing results (with level-88 items for success and end-of-file conditions), and control variables for program flow and error handling. The END-OF-FILE flag tracks file processing completion, while ABCODE stores any abend code if errors occur. These structures support the program's comprehensive error handling capabilities when processing the customer file."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.\n       FD  CUSTFILE-FILE.\n       01  FD-CUSTFILE-REC.\n           05 FD-CUST-ID                        PIC 9(09).\n           05 FD-CUST-DATA                      PIC X(491).\n\n       WORKING-STORAGE SECTION.\n\n      *****************************************************************\n       COPY CVCUS01Y.\n       01  CUSTFILE-STATUS.\n           05  CUSTFILE-STAT1      PIC X.\n           05  CUSTFILE-STAT2      PIC X.\n\n       01  IO-STATUS.\n           05  IO-STAT1            PIC X.\n           05  IO-STAT2            PIC X.\n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.\n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.\n           05  TWO-BYTES-LEFT      PIC X.\n           05  TWO-BYTES-RIGHT     PIC X.\n       01  IO-STATUS-04.\n           05  IO-STATUS-0401      PIC 9   VALUE 0.\n           05  IO-STATUS-0403      PIC 999 VALUE 0.\n\n       01  APPL-RESULT             PIC S9(9)   COMP.\n           88  APPL-AOK            VALUE 0.\n           88  APPL-EOF            VALUE 16.\n\n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.\n       01  ABCODE                  PIC S9(9) BINARY.\n       01  TIMING                  PIC S9(9) BINARY. \n\n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "1000-CUSTFILE-GET-NEXT",
            "code": "READ CUSTFILE-FILE INTO CUSTOMER-RECORD.\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n               DISPLAY CUSTOMER-RECORD \n           ELSE\n               IF  CUSTFILE-STATUS = '10'\n                   MOVE 16 TO APPL-RESULT\n               ELSE\n                   MOVE 12 TO APPL-RESULT\n               END-IF\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               IF  APPL-EOF\n                   MOVE 'Y' TO END-OF-FILE\n               ELSE\n                   DISPLAY 'ERROR READING CUSTOMER FILE'\n                   MOVE CUSTFILE-STATUS TO IO-STATUS\n                   PERFORM Z-DISPLAY-IO-STATUS\n                   PERFORM Z-ABEND-PROGRAM\n               END-IF\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the sequential reading of customer records from the CUSTFILE. It attempts to read the next record into the CUSTOMER-RECORD structure and processes the result based on the file status. When successful (status '00'), it sets APPL-RESULT to 0 and displays the customer record. If end-of-file is reached (status '10'), it sets APPL-RESULT to 16. For any other status, it sets APPL-RESULT to 12, indicating an error. The paragraph then evaluates APPL-RESULT: if successful, processing continues; if end-of-file is detected, it sets the END-OF-FILE flag to 'Y'; for any other error, it displays an error message, captures the file status, displays the I/O status details, and abends the program."
          },
          {
            "name": "0000-CUSTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CUSTFILE-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CUSTFILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the CUSTFILE-FILE for input processing. It initializes APPL-RESULT to 8, attempts to open the customer file, and then sets APPL-RESULT to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, captures the file status code, displays the I/O status details through the Z-DISPLAY-IO-STATUS paragraph, and terminates the program abnormally via the Z-ABEND-PROGRAM paragraph. This robust error handling ensures that file access issues are properly identified and reported before proceeding with customer data processing."
          },
          {
            "name": "9000-CUSTFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CUSTFILE-FILE\n           IF  CUSTFILE-STATUS = '00'\n               SUBTRACT APPL-RESULT FROM APPL-RESULT\n           ELSE\n               ADD 12 TO ZERO GIVING APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.",
            "description": "This paragraph handles the closing of the customer file (CUSTFILE-FILE) with comprehensive error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to zero; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, displays the I/O status details through the Z-DISPLAY-IO-STATUS paragraph, and terminates the program abnormally via the Z-ABEND-PROGRAM paragraph. This structured approach ensures proper resource cleanup and clear error reporting when closing the customer file."
          },
          {
            "name": "Z-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'\n           MOVE 0 TO TIMING\n           MOVE 999 TO ABCODE\n           CALL 'CEE3ABD'.\n\n      *****************************************************************",
            "description": "This paragraph handles program termination by forcing an abnormal end (abend) when critical errors occur. It displays an \"ABENDING PROGRAM\" message, resets the timing variable to zero, sets the abend code to 999, and then calls the Language Environment service 'CEE3ABD' to terminate the program. This provides a controlled way to halt execution when unrecoverable errors are encountered."
          },
          {
            "name": "Z-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC\n           OR  IO-STAT1 = '9'\n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)\n               MOVE 0        TO TWO-BYTES-BINARY\n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT\n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04 \n           ELSE\n               MOVE '0000' TO IO-STATUS-04\n               MOVE IO-STATUS TO IO-STATUS-04(3:2)\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04 \n           END-IF\n           EXIT.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *",
            "description": "This paragraph handles the formatting and display of file I/O status codes for error reporting. It checks if the I/O status code is non-numeric or has a first digit of '9' (indicating a serious error). For these cases, it preserves the first digit and converts the second digit to a 4-digit display format. For standard numeric status codes, it formats them as a 4-digit code with leading zeros. The formatted status code is then displayed with a descriptive message. This routine provides consistent error reporting for file operations throughout the program, helping with troubleshooting file access issues."
          }
        ],
        "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBCUS01C'.\n           PERFORM 0000-CUSTFILE-OPEN.\n\n           PERFORM UNTIL END-OF-FILE = 'Y'\n               IF  END-OF-FILE = 'N'\n                   PERFORM 1000-CUSTFILE-GET-NEXT\n                   IF  END-OF-FILE = 'N'\n                       DISPLAY CUSTOMER-RECORD \n                   END-IF\n               END-IF\n           END-PERFORM.\n\n           PERFORM 9000-CUSTFILE-CLOSE.\n\n           DISPLAY 'END OF EXECUTION OF PROGRAM CBCUS01C'.\n\n           GOBACK.\n\n      *****************************************************************\n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *\n      *****************************************************************\n       1000-CUSTFILE-GET-NEXT.\n           READ CUSTFILE-FILE INTO CUSTOMER-RECORD.\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n               DISPLAY CUSTOMER-RECORD \n           ELSE\n               IF  CUSTFILE-STATUS = '10'\n                   MOVE 16 TO APPL-RESULT\n               ELSE\n                   MOVE 12 TO APPL-RESULT\n               END-IF\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               IF  APPL-EOF\n                   MOVE 'Y' TO END-OF-FILE\n               ELSE\n                   DISPLAY 'ERROR READING CUSTOMER FILE'\n                   MOVE CUSTFILE-STATUS TO IO-STATUS\n                   PERFORM Z-DISPLAY-IO-STATUS\n                   PERFORM Z-ABEND-PROGRAM\n               END-IF\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0000-CUSTFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CUSTFILE-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CUSTFILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9000-CUSTFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CUSTFILE-FILE\n           IF  CUSTFILE-STATUS = '00'\n               SUBTRACT APPL-RESULT FROM APPL-RESULT\n           ELSE\n               ADD 12 TO ZERO GIVING APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n       Z-ABEND-PROGRAM.\n           DISPLAY 'ABENDING PROGRAM'\n           MOVE 0 TO TIMING\n           MOVE 999 TO ABCODE\n           CALL 'CEE3ABD'.\n\n      *****************************************************************\n       Z-DISPLAY-IO-STATUS.\n           IF  IO-STATUS NOT NUMERIC\n           OR  IO-STAT1 = '9'\n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)\n               MOVE 0        TO TWO-BYTES-BINARY\n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT\n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04 \n           ELSE\n               MOVE '0000' TO IO-STATUS-04\n               MOVE IO-STATUS TO IO-STATUS-04(3:2)\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04 \n           END-IF\n           EXIT.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *"
      },
      "description": "This batch COBOL program (CBCUS01C) reads and displays customer data from an indexed VSAM file. It sequentially processes customer records from the CUSTFILE, displaying each record until the end of file is reached. The program includes comprehensive error handling for file operations, with specific routines for opening, reading, and closing the customer file. If any file operation errors occur, the program displays detailed status information and terminates with an abend. The program is part of the CardDemo application, which demonstrates AWS and partner technologies for mainframe migration and modernization use-cases.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBCUS01C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : Read and print customer data file.                \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.\n       PROGRAM-ID.    CBCUS01C.\n       AUTHOR.        AWS.\n \n       ENVIRONMENT DIVISION.\n       INPUT-OUTPUT SECTION.\n       FILE-CONTROL.\n           SELECT CUSTFILE-FILE ASSIGN TO   CUSTFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS SEQUENTIAL\n                  RECORD KEY   IS FD-CUST-ID\n                  FILE STATUS  IS CUSTFILE-STATUS.\n      *\n       DATA DIVISION.\n       FILE SECTION.\n       FD  CUSTFILE-FILE.\n       01  FD-CUSTFILE-REC.\n           05 FD-CUST-ID                        PIC 9(09).\n           05 FD-CUST-DATA                      PIC X(491).\n\n       WORKING-STORAGE SECTION.\n\n      *****************************************************************\n       COPY CVCUS01Y.\n       01  CUSTFILE-STATUS.\n           05  CUSTFILE-STAT1      PIC X.\n           05  CUSTFILE-STAT2      PIC X.\n\n       01  IO-STATUS.\n           05  IO-STAT1            PIC X.\n           05  IO-STAT2            PIC X.\n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.\n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.\n           05  TWO-BYTES-LEFT      PIC X.\n           05  TWO-BYTES-RIGHT     PIC X.\n       01  IO-STATUS-04.\n           05  IO-STATUS-0401      PIC 9   VALUE 0.\n           05  IO-STATUS-0403      PIC 999 VALUE 0.\n\n       01  APPL-RESULT             PIC S9(9)   COMP.\n           88  APPL-AOK            VALUE 0.\n           88  APPL-EOF            VALUE 16.\n\n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.\n       01  ABCODE                  PIC S9(9) BINARY.\n       01  TIMING                  PIC S9(9) BINARY. \n\n      *****************************************************************\n       PROCEDURE DIVISION.\n           DISPLAY 'START OF EXECUTION OF PROGRAM CBCUS01C'.\n           PERFORM 0000-CUSTFILE-OPEN.\n\n           PERFORM UNTIL END-OF-FILE = 'Y'\n               IF  END-OF-FILE = 'N'\n                   PERFORM 1000-CUSTFILE-GET-NEXT\n                   IF  END-OF-FILE = 'N'\n                       DISPLAY CUSTOMER-RECORD \n                   END-IF\n               END-IF\n           END-PERFORM.\n\n           PERFORM 9000-CUSTFILE-CLOSE.\n\n           DISPLAY 'END OF EXECUTION OF PROGRAM CBCUS01C'.\n\n           GOBACK.\n\n      *****************************************************************\n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *\n      *****************************************************************\n       1000-CUSTFILE-GET-NEXT.\n           READ CUSTFILE-FILE INTO CUSTOMER-RECORD.\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n               DISPLAY CUSTOMER-RECORD \n           ELSE\n               IF  CUSTFILE-STATUS = '10'\n                   MOVE 16 TO APPL-RESULT\n               ELSE\n                   MOVE 12 TO APPL-RESULT\n               END-IF\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               IF  APPL-EOF\n                   MOVE 'Y' TO END-OF-FILE\n               ELSE\n                   DISPLAY 'ERROR READING CUSTOMER FILE'\n                   MOVE CUSTFILE-STATUS TO IO-STATUS\n                   PERFORM Z-DISPLAY-IO-STATUS\n                   PERFORM Z-ABEND-PROGRAM\n               END-IF\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0000-CUSTFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CUSTFILE-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CUSTFILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9000-CUSTFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CUSTFILE-FILE\n           IF  CUSTFILE-STATUS = '00'\n               SUBTRACT APPL-RESULT FROM APPL-RESULT\n           ELSE\n               ADD 12 TO ZERO GIVING APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n       Z-ABEND-PROGRAM.\n           DISPLAY 'ABENDING PROGRAM'\n           MOVE 0 TO TIMING\n           MOVE 999 TO ABCODE\n           CALL 'CEE3ABD'.\n\n      *****************************************************************\n       Z-DISPLAY-IO-STATUS.\n           IF  IO-STATUS NOT NUMERIC\n           OR  IO-STAT1 = '9'\n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)\n               MOVE 0        TO TWO-BYTES-BINARY\n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT\n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04 \n           ELSE\n               MOVE '0000' TO IO-STATUS-04\n               MOVE IO-STATUS TO IO-STATUS-04(3:2)\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04 \n           END-IF\n           EXIT.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVCUS01Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as Main Program\n    participant Open as 0000-CUSTFILE-OPEN\n    participant Read as 1000-CUSTFILE-GET-NEXT\n    participant Close as 9000-CUSTFILE-CLOSE\n    participant IOStatus as Z-DISPLAY-IO-STATUS\n    participant Abend as Z-ABEND-PROGRAM\n    participant VSAM as CUSTFILE (VSAM File)\n    \n    Main->>Open: Perform CUSTFILE-OPEN\n    activate Open\n    Open->>VSAM: OPEN INPUT CUSTFILE-FILE\n    VSAM-->>Open: Return status\n    \n    alt Status = '00'\n        Open->>Main: Set APPL-RESULT to 0\n    else Status != '00'\n        Open->>IOStatus: Perform Z-DISPLAY-IO-STATUS\n        activate IOStatus\n        IOStatus-->>Open: Display formatted status\n        deactivate IOStatus\n        Open->>Abend: Perform Z-ABEND-PROGRAM\n        activate Abend\n        Abend->>Abend: Call 'CEE3ABD'\n        deactivate Abend\n    end\n    deactivate Open\n    \n    loop Until END-OF-FILE = 'Y'\n        Main->>Read: Perform CUSTFILE-GET-NEXT\n        activate Read\n        Read->>VSAM: READ CUSTFILE-FILE\n        VSAM-->>Read: Return record & status\n        \n        alt Status = '00'\n            Read->>Read: Display CUSTOMER-RECORD\n            Read->>Main: Set APPL-RESULT to 0\n        else Status = '10' (EOF)\n            Read->>Main: Set APPL-RESULT to 16\n            Read->>Read: Set END-OF-FILE to 'Y'\n        else Other Status\n            Read->>IOStatus: Perform Z-DISPLAY-IO-STATUS\n            activate IOStatus\n            IOStatus-->>Read: Display formatted status\n            deactivate IOStatus\n            Read->>Abend: Perform Z-ABEND-PROGRAM\n            activate Abend\n            Abend->>Abend: Call 'CEE3ABD'\n            deactivate Abend\n        end\n        deactivate Read\n    end\n    \n    Main->>Close: Perform CUSTFILE-CLOSE\n    activate Close\n    Close->>VSAM: CLOSE CUSTFILE-FILE\n    VSAM-->>Close: Return status\n    \n    alt Status = '00'\n        Close->>Main: Set APPL-RESULT to 0\n    else Status != '00'\n        Close->>IOStatus: Perform Z-DISPLAY-IO-STATUS\n        activate IOStatus\n        IOStatus-->>Close: Display formatted status\n        deactivate IOStatus\n        Close->>Abend: Perform Z-ABEND-PROGRAM\n        activate Abend\n        Abend->>Abend: Call 'CEE3ABD'\n        deactivate Abend\n    end\n    deactivate Close"
    },
    {
      "id": "COMEN01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration settings for the COMEN01C program, which is the main menu interface for regular users in the CardDemo application. The configuration section would define special names, file assignments, and system dependencies required for the program's operation. However, the provided snippet is empty, suggesting that this program may not require specific configuration settings beyond what might be defined elsewhere in the program or in shared configuration files. This aligns with the program's primary function as a menu interface that focuses on displaying options and routing user selections rather than performing complex file operations or system interactions."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COMEN01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CM00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-OPTION-X                PIC X(02) JUST RIGHT.\n         05 WS-OPTION                  PIC 9(02) VALUE 0.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-MENU-OPT-TXT            PIC X(40) VALUE SPACES.\n\n       COPY COCOM01Y.\n       COPY COMEN02Y.\n\n       COPY COMEN01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working-Storage section defines the main variables and data structures used by the COMEN01C program (the CardDemo main menu interface). It includes program identifiers, error handling flags, response codes, and variables for processing menu options. The section incorporates several copybooks that likely contain menu definitions (COMEN01, COMEN02Y), common data structures (COCOM01Y), title formatting (COTTL01Y), date handling (CSDAT01Y), messaging (CSMSG01Y), and user information (CSUSR01Y). It also includes standard CICS copybooks for AID keys and BMS attributes. The variables support the program's core functionality of displaying menu options, processing user selections, and handling navigation between different parts of the CardDemo application."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This linkage section defines the communication area (DFHCOMMAREA) used to pass data between programs in the CardDemo menu interface. It contains a single field, LK-COMMAREA, which is defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length of the communication area (EIBCALEN). This flexible structure allows the program to receive and process communication data of different sizes from calling programs within the application."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COMEN01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CM00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-OPTION-X                PIC X(02) JUST RIGHT.\n         05 WS-OPTION                  PIC 9(02) VALUE 0.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-MENU-OPT-TXT            PIC X(40) VALUE SPACES.\n\n       COPY COCOM01Y.\n       COPY COMEN02Y.\n\n       COPY COMEN01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COMEN1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM\n               PERFORM RETURN-TO-SIGNON-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COMEN1AO\n                   PERFORM SEND-MENU-SCREEN\n               ELSE\n                   PERFORM RECEIVE-MENU-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-SIGNON-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-MENU-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the main control flow of the menu interface program. It first clears any error flags and message fields, then checks if the program was called with a communication area. If no commarea exists, it returns to the sign-on screen. Otherwise, it retrieves the commarea data and determines if this is the first entry to the program or a re-entry. On first entry, it initializes the screen and displays the menu. On re-entry, it processes user input based on the key pressed: ENTER key triggers option processing, PF3 returns to the sign-on screen, and any other key generates an invalid key error message. The paragraph maintains session state by returning with the updated commarea and transaction ID to preserve context between interactions."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "PERFORM VARYING WS-IDX\n                   FROM LENGTH OF OPTIONI OF COMEN1AI BY -1 UNTIL\n                   OPTIONI OF COMEN1AI(WS-IDX:1) NOT = SPACES OR\n                   WS-IDX = 1\n           END-PERFORM\n           MOVE OPTIONI OF COMEN1AI(1:WS-IDX) TO WS-OPTION-X\n           INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'\n           MOVE WS-OPTION-X              TO WS-OPTION\n           MOVE WS-OPTION                TO OPTIONO OF COMEN1AO\n\n           IF WS-OPTION IS NOT NUMERIC OR\n              WS-OPTION > CDEMO-MENU-OPT-COUNT OR\n              WS-OPTION = ZEROS\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Please enter a valid option number...' TO\n                               WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n           IF CDEMO-USRTYP-USER AND\n              CDEMO-MENU-OPT-USRTYPE(WS-OPTION) = 'A'\n               SET ERR-FLG-ON          TO TRUE\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE 'No access - Admin Only option... ' TO\n                                       WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               IF CDEMO-MENU-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'\n                   MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                   MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n      *            MOVE WS-USER-ID   TO CDEMO-USER-ID\n      *            MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n                   MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n                   EXEC CICS\n                       XCTL PROGRAM(CDEMO-MENU-OPT-PGMNAME(WS-OPTION))\n                       COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n               END-IF\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE DFHGREEN           TO ERRMSGC  OF COMEN1AO\n               STRING 'This option '       DELIMITED BY SIZE\n                       CDEMO-MENU-OPT-NAME(WS-OPTION)\n                                       DELIMITED BY SPACE\n                       'is coming soon ...'   DELIMITED BY SIZE\n                  INTO WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-SIGNON-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph processes user menu selections when the Enter key is pressed. It first extracts and validates the option number entered by the user, removing trailing spaces and converting any remaining spaces to zeros. The code then performs several validation checks: ensuring the option is numeric, within the valid range of menu options, and not zero. If the user is a regular user attempting to access an admin-only option (designated by 'A'), an error message is displayed. For valid selections, the program transfers control to the appropriate program using CICS XCTL, passing the commarea to maintain session state. If the target program name begins with \"DUMMY\", the system displays a \"coming soon\" message instead of transferring control. Error conditions trigger appropriate error messages and redisplay of the menu screen."
          },
          {
            "name": "RETURN-TO-SIGNON-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-MENU-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the return to the sign-on screen functionality. It checks if the target program (CDEMO-TO-PROGRAM) is empty or contains spaces, and if so, sets it to 'COSGN00C' which is the sign-on program. It then uses the CICS XCTL command to transfer control to the specified program without returning to the calling program. This ensures users are properly redirected to the sign-on screen when logging out or when session navigation requires returning to the authentication interface."
          },
          {
            "name": "SEND-MENU-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n           PERFORM BUILD-MENU-OPTIONS\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COMEN1AO\n\n           EXEC CICS SEND\n                     MAP('COMEN1A')\n                     MAPSET('COMEN01')\n                     FROM(COMEN1AO)\n                     ERASE\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-MENU-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the display of the menu screen to the user. It first calls POPULATE-HEADER-INFO to set up standard header information (likely date, time, and user details) and then calls BUILD-MENU-OPTIONS to generate the appropriate menu items based on the user's access level. Any system messages or error notifications stored in WS-MESSAGE are transferred to the output map's error message field. Finally, it uses the CICS SEND command to display the COMEN1A map from the COMEN01 mapset to the user, clearing the previous screen content with the ERASE option."
          },
          {
            "name": "RECEIVE-MENU-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COMEN1A')\n                     MAPSET('COMEN01')\n                     INTO(COMEN1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the reception of user input from the menu screen. It uses the CICS RECEIVE command to capture data entered on the 'COMEN1A' map within the 'COMEN01' mapset, storing the received data in the COMEN1AI structure. The response codes from this operation are captured in WS-RESP-CD and WS-REAS-CD variables for subsequent error handling. This is a standard CICS interaction pattern for accepting user input before processing menu selections."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COMEN1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COMEN1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COMEN1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COMEN1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COMEN1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COMEN1AO.\n\n      *----------------------------------------------------------------*\n      *                      BUILD-MENU-OPTIONS\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the CardDemo main menu screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information on the screen. The paragraph sets the application title fields from predefined constants, displays the transaction ID and program name, and formats the current date in MM/DD/YY format and the current time in HH:MM:SS format. This creates a consistent header that provides context to users about which application they're using and when they're using it."
          },
          {
            "name": "BUILD-MENU-OPTIONS",
            "code": "PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL\n                           WS-IDX > CDEMO-MENU-OPT-COUNT\n\n               MOVE SPACES             TO WS-MENU-OPT-TXT\n\n               STRING CDEMO-MENU-OPT-NUM(WS-IDX)  DELIMITED BY SIZE\n                      '. '                         DELIMITED BY SIZE\n                      CDEMO-MENU-OPT-NAME(WS-IDX) DELIMITED BY SIZE\n                 INTO WS-MENU-OPT-TXT\n\n               EVALUATE WS-IDX\n                   WHEN 1\n                       MOVE WS-MENU-OPT-TXT TO OPTN001O\n                   WHEN 2\n                       MOVE WS-MENU-OPT-TXT TO OPTN002O\n                   WHEN 3\n                       MOVE WS-MENU-OPT-TXT TO OPTN003O\n                   WHEN 4\n                       MOVE WS-MENU-OPT-TXT TO OPTN004O\n                   WHEN 5\n                       MOVE WS-MENU-OPT-TXT TO OPTN005O\n                   WHEN 6\n                       MOVE WS-MENU-OPT-TXT TO OPTN006O\n                   WHEN 7\n                       MOVE WS-MENU-OPT-TXT TO OPTN007O\n                   WHEN 8\n                       MOVE WS-MENU-OPT-TXT TO OPTN008O\n                   WHEN 9\n                       MOVE WS-MENU-OPT-TXT TO OPTN009O\n                   WHEN 10\n                       MOVE WS-MENU-OPT-TXT TO OPTN010O\n                   WHEN 11\n                       MOVE WS-MENU-OPT-TXT TO OPTN011O\n                   WHEN 12\n                       MOVE WS-MENU-OPT-TXT TO OPTN012O\n                   WHEN OTHER\n                       CONTINUE\n               END-EVALUATE\n\n           END-PERFORM.\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *",
            "description": "This paragraph dynamically constructs and populates the menu options displayed to users in the CardDemo application's main menu interface. It iterates through the available menu options (stored in the CDEMO-MENU-OPT arrays) up to the total count of options. For each option, it formats a display string by combining the option number, a period and space, and the option name. Based on the current index position, it then assigns this formatted text to the appropriate screen field (OPTN001O through OPTN012O), supporting up to 12 menu options. This approach allows the menu to be built dynamically based on the user's access level, with different options potentially available to regular users versus administrators."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COMEN1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM\n               PERFORM RETURN-TO-SIGNON-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COMEN1AO\n                   PERFORM SEND-MENU-SCREEN\n               ELSE\n                   PERFORM RECEIVE-MENU-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-SIGNON-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-MENU-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           PERFORM VARYING WS-IDX\n                   FROM LENGTH OF OPTIONI OF COMEN1AI BY -1 UNTIL\n                   OPTIONI OF COMEN1AI(WS-IDX:1) NOT = SPACES OR\n                   WS-IDX = 1\n           END-PERFORM\n           MOVE OPTIONI OF COMEN1AI(1:WS-IDX) TO WS-OPTION-X\n           INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'\n           MOVE WS-OPTION-X              TO WS-OPTION\n           MOVE WS-OPTION                TO OPTIONO OF COMEN1AO\n\n           IF WS-OPTION IS NOT NUMERIC OR\n              WS-OPTION > CDEMO-MENU-OPT-COUNT OR\n              WS-OPTION = ZEROS\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Please enter a valid option number...' TO\n                               WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n           IF CDEMO-USRTYP-USER AND\n              CDEMO-MENU-OPT-USRTYPE(WS-OPTION) = 'A'\n               SET ERR-FLG-ON          TO TRUE\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE 'No access - Admin Only option... ' TO\n                                       WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               IF CDEMO-MENU-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'\n                   MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                   MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n      *            MOVE WS-USER-ID   TO CDEMO-USER-ID\n      *            MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n                   MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n                   EXEC CICS\n                       XCTL PROGRAM(CDEMO-MENU-OPT-PGMNAME(WS-OPTION))\n                       COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n               END-IF\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE DFHGREEN           TO ERRMSGC  OF COMEN1AO\n               STRING 'This option '       DELIMITED BY SIZE\n                       CDEMO-MENU-OPT-NAME(WS-OPTION)\n                                       DELIMITED BY SPACE\n                       'is coming soon ...'   DELIMITED BY SIZE\n                  INTO WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-SIGNON-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-SIGNON-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-MENU-SCREEN\n      *----------------------------------------------------------------*\n       SEND-MENU-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n           PERFORM BUILD-MENU-OPTIONS\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COMEN1AO\n\n           EXEC CICS SEND\n                     MAP('COMEN1A')\n                     MAPSET('COMEN01')\n                     FROM(COMEN1AO)\n                     ERASE\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-MENU-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-MENU-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COMEN1A')\n                     MAPSET('COMEN01')\n                     INTO(COMEN1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COMEN1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COMEN1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COMEN1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COMEN1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COMEN1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COMEN1AO.\n\n      *----------------------------------------------------------------*\n      *                      BUILD-MENU-OPTIONS\n      *----------------------------------------------------------------*\n       BUILD-MENU-OPTIONS.\n\n           PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL\n                           WS-IDX > CDEMO-MENU-OPT-COUNT\n\n               MOVE SPACES             TO WS-MENU-OPT-TXT\n\n               STRING CDEMO-MENU-OPT-NUM(WS-IDX)  DELIMITED BY SIZE\n                      '. '                         DELIMITED BY SIZE\n                      CDEMO-MENU-OPT-NAME(WS-IDX) DELIMITED BY SIZE\n                 INTO WS-MENU-OPT-TXT\n\n               EVALUATE WS-IDX\n                   WHEN 1\n                       MOVE WS-MENU-OPT-TXT TO OPTN001O\n                   WHEN 2\n                       MOVE WS-MENU-OPT-TXT TO OPTN002O\n                   WHEN 3\n                       MOVE WS-MENU-OPT-TXT TO OPTN003O\n                   WHEN 4\n                       MOVE WS-MENU-OPT-TXT TO OPTN004O\n                   WHEN 5\n                       MOVE WS-MENU-OPT-TXT TO OPTN005O\n                   WHEN 6\n                       MOVE WS-MENU-OPT-TXT TO OPTN006O\n                   WHEN 7\n                       MOVE WS-MENU-OPT-TXT TO OPTN007O\n                   WHEN 8\n                       MOVE WS-MENU-OPT-TXT TO OPTN008O\n                   WHEN 9\n                       MOVE WS-MENU-OPT-TXT TO OPTN009O\n                   WHEN 10\n                       MOVE WS-MENU-OPT-TXT TO OPTN010O\n                   WHEN 11\n                       MOVE WS-MENU-OPT-TXT TO OPTN011O\n                   WHEN 12\n                       MOVE WS-MENU-OPT-TXT TO OPTN012O\n                   WHEN OTHER\n                       CONTINUE\n               END-EVALUATE\n\n           END-PERFORM.\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *"
      },
      "description": "This program serves as the main menu interface for regular users in the CardDemo application. It displays a list of available menu options based on the user's access level, processes user selections, and routes to the appropriate program when a valid option is chosen. The program prevents regular users from accessing admin-only options, displays appropriate error messages for invalid inputs, and includes functionality to return to the sign-on screen. It maintains session state through a commarea and includes standard header information with current date and time. The menu is dynamically built based on predefined options, with different display logic for regular users versus administrators.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COMEN01C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Main Menu for the Regular users\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COMEN01C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COMEN01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CM00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-OPTION-X                PIC X(02) JUST RIGHT.\n         05 WS-OPTION                  PIC 9(02) VALUE 0.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-MENU-OPT-TXT            PIC X(40) VALUE SPACES.\n\n       COPY COCOM01Y.\n       COPY COMEN02Y.\n\n       COPY COMEN01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COMEN1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM\n               PERFORM RETURN-TO-SIGNON-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COMEN1AO\n                   PERFORM SEND-MENU-SCREEN\n               ELSE\n                   PERFORM RECEIVE-MENU-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-SIGNON-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-MENU-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           PERFORM VARYING WS-IDX\n                   FROM LENGTH OF OPTIONI OF COMEN1AI BY -1 UNTIL\n                   OPTIONI OF COMEN1AI(WS-IDX:1) NOT = SPACES OR\n                   WS-IDX = 1\n           END-PERFORM\n           MOVE OPTIONI OF COMEN1AI(1:WS-IDX) TO WS-OPTION-X\n           INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'\n           MOVE WS-OPTION-X              TO WS-OPTION\n           MOVE WS-OPTION                TO OPTIONO OF COMEN1AO\n\n           IF WS-OPTION IS NOT NUMERIC OR\n              WS-OPTION > CDEMO-MENU-OPT-COUNT OR\n              WS-OPTION = ZEROS\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Please enter a valid option number...' TO\n                               WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n           IF CDEMO-USRTYP-USER AND\n              CDEMO-MENU-OPT-USRTYPE(WS-OPTION) = 'A'\n               SET ERR-FLG-ON          TO TRUE\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE 'No access - Admin Only option... ' TO\n                                       WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               IF CDEMO-MENU-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'\n                   MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                   MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n      *            MOVE WS-USER-ID   TO CDEMO-USER-ID\n      *            MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n                   MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n                   EXEC CICS\n                       XCTL PROGRAM(CDEMO-MENU-OPT-PGMNAME(WS-OPTION))\n                       COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n               END-IF\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE DFHGREEN           TO ERRMSGC  OF COMEN1AO\n               STRING 'This option '       DELIMITED BY SIZE\n                       CDEMO-MENU-OPT-NAME(WS-OPTION)\n                                       DELIMITED BY SPACE\n                       'is coming soon ...'   DELIMITED BY SIZE\n                  INTO WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-SIGNON-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-SIGNON-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-MENU-SCREEN\n      *----------------------------------------------------------------*\n       SEND-MENU-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n           PERFORM BUILD-MENU-OPTIONS\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COMEN1AO\n\n           EXEC CICS SEND\n                     MAP('COMEN1A')\n                     MAPSET('COMEN01')\n                     FROM(COMEN1AO)\n                     ERASE\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-MENU-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-MENU-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COMEN1A')\n                     MAPSET('COMEN01')\n                     INTO(COMEN1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COMEN1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COMEN1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COMEN1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COMEN1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COMEN1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COMEN1AO.\n\n      *----------------------------------------------------------------*\n      *                      BUILD-MENU-OPTIONS\n      *----------------------------------------------------------------*\n       BUILD-MENU-OPTIONS.\n\n           PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL\n                           WS-IDX > CDEMO-MENU-OPT-COUNT\n\n               MOVE SPACES             TO WS-MENU-OPT-TXT\n\n               STRING CDEMO-MENU-OPT-NUM(WS-IDX)  DELIMITED BY SIZE\n                      '. '                         DELIMITED BY SIZE\n                      CDEMO-MENU-OPT-NAME(WS-IDX) DELIMITED BY SIZE\n                 INTO WS-MENU-OPT-TXT\n\n               EVALUATE WS-IDX\n                   WHEN 1\n                       MOVE WS-MENU-OPT-TXT TO OPTN001O\n                   WHEN 2\n                       MOVE WS-MENU-OPT-TXT TO OPTN002O\n                   WHEN 3\n                       MOVE WS-MENU-OPT-TXT TO OPTN003O\n                   WHEN 4\n                       MOVE WS-MENU-OPT-TXT TO OPTN004O\n                   WHEN 5\n                       MOVE WS-MENU-OPT-TXT TO OPTN005O\n                   WHEN 6\n                       MOVE WS-MENU-OPT-TXT TO OPTN006O\n                   WHEN 7\n                       MOVE WS-MENU-OPT-TXT TO OPTN007O\n                   WHEN 8\n                       MOVE WS-MENU-OPT-TXT TO OPTN008O\n                   WHEN 9\n                       MOVE WS-MENU-OPT-TXT TO OPTN009O\n                   WHEN 10\n                       MOVE WS-MENU-OPT-TXT TO OPTN010O\n                   WHEN 11\n                       MOVE WS-MENU-OPT-TXT TO OPTN011O\n                   WHEN 12\n                       MOVE WS-MENU-OPT-TXT TO OPTN012O\n                   WHEN OTHER\n                       CONTINUE\n               END-EVALUATE\n\n           END-PERFORM.\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "COTTL01Y",
        "DFHAID",
        "COMEN01",
        "COMEN02Y"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant MainMenu as COMEN01C\n    participant SignOn as COSGN00C\n    participant TargetProgram as Selected Program\n    \n    User->>MainMenu: Start transaction\n    \n    alt No COMMAREA\n        MainMenu->>SignOn: Return to sign-on screen\n    else Has COMMAREA\n        alt First entry\n            MainMenu->>MainMenu: Initialize screen\n            MainMenu->>MainMenu: POPULATE-HEADER-INFO\n            MainMenu->>MainMenu: BUILD-MENU-OPTIONS\n            MainMenu-->>User: Display menu screen\n        else Re-entry\n            MainMenu->>MainMenu: RECEIVE-MENU-SCREEN\n            \n            alt ENTER key pressed\n                MainMenu->>MainMenu: PROCESS-ENTER-KEY\n                \n                alt Invalid option\n                    MainMenu->>MainMenu: Set error message\n                    MainMenu-->>User: Redisplay menu with error\n                else Admin-only option for regular user\n                    MainMenu->>MainMenu: Set access error message\n                    MainMenu-->>User: Redisplay menu with error\n                else Valid option with real program\n                    MainMenu->>TargetProgram: XCTL with COMMAREA\n                else \"Coming soon\" option (DUMMY)\n                    MainMenu->>MainMenu: Set \"coming soon\" message\n                    MainMenu-->>User: Redisplay menu with message\n                end\n                \n            else PF3 key pressed\n                MainMenu->>SignOn: Return to sign-on screen\n            else Other key pressed\n                MainMenu->>MainMenu: Set invalid key message\n                MainMenu-->>User: Redisplay menu with error\n            end\n        end\n    end\n    \n    Note over MainMenu: Program returns with COMMAREA to preserve state"
    },
    {
      "id": "CBACT02C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.                                                            \n           SELECT CARDFILE-FILE ASSIGN TO   CARDFILE                            \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-CARD-NUM                                   \n                  FILE STATUS  IS CARDFILE-STATUS.                              \n      *",
            "description": "This section configures the CARDFILE-FILE as an indexed VSAM file with sequential access mode. It assigns the file to the external name CARDFILE, defines FD-CARD-NUM as the primary key field, and establishes CARDFILE-STATUS as the file status variable for error handling. The file will be processed sequentially, allowing the program to read through all card records in order."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  CARDFILE-FILE.                                                       \n       01  FD-CARDFILE-REC.                                                     \n           05 FD-CARD-NUM                       PIC X(16).                      \n           05 FD-CARD-DATA                      PIC X(134).",
            "description": "This section defines the file structure for CARDFILE-FILE, which contains credit card records. The record layout consists of two fields: a 16-character card number field (FD-CARD-NUM) and a 134-character field for additional card data (FD-CARD-DATA). This structure is used to read credit card information from the indexed VSAM file that the program processes."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************         \n       COPY CVACT02Y.                                                           \n       01  CARDFILE-STATUS.                                                     \n           05  CARDFILE-STAT1      PIC X.                                       \n           05  CARDFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************",
            "description": "This Working Storage section defines the data structures used for file status tracking and error handling in the CBACT02C program. It includes file status variables for CARDFILE operations, binary-to-character conversion fields, and program control flags. The section incorporates the CVACT02Y copybook and defines status codes for tracking file operations with detailed error reporting capabilities. Key elements include the APPL-RESULT field with condition names for normal processing and end-of-file conditions, an END-OF-FILE flag, and fields for storing abend codes and timing information. These structures support the program's primary function of reading and displaying card data while providing robust error handling."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.                                                            \n       FD  CARDFILE-FILE.                                                       \n       01  FD-CARDFILE-REC.                                                     \n           05 FD-CARD-NUM                       PIC X(16).                      \n           05 FD-CARD-DATA                      PIC X(134).                     \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVACT02Y.                                                           \n       01  CARDFILE-STATUS.                                                     \n           05  CARDFILE-STAT1      PIC X.                                       \n           05  CARDFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "1000-CARDFILE-GET-NEXT",
            "code": "READ CARDFILE-FILE INTO CARD-RECORD.                                 \n           IF  CARDFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n      *        DISPLAY CARD-RECORD                                              \n           ELSE                                                                 \n               IF  CARDFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING CARDFILE'                             \n                   MOVE CARDFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the sequential reading of records from the CARDFILE-FILE and processes the result based on file status codes. It reads a record into CARD-RECORD and sets APPL-RESULT to 0 for successful reads (status '00'), 16 for end-of-file conditions (status '10'), or 12 for other errors. When a record is successfully read, processing continues. When end-of-file is reached, it sets END-OF-FILE to 'Y'. For any other file errors, it displays an error message, captures the file status code, calls procedures to display the status details (9910-DISPLAY-IO-STATUS) and terminates the program with a controlled abend (9999-ABEND-PROGRAM). This paragraph implements standard error handling for sequential file reading operations within the CardDemo application."
          },
          {
            "name": "0000-CARDFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT CARDFILE-FILE                                             \n           IF  CARDFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CARDFILE'                                 \n               MOVE CARDFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the CARDFILE-FILE for input processing. It initializes APPL-RESULT to 8, attempts to open the file, and then sets APPL-RESULT to 0 if successful or 12 if unsuccessful based on the CARDFILE-STATUS. If the operation fails (when APPL-AOK is not true), it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program with a controlled abend. The paragraph implements standard error handling for file opening operations with appropriate status reporting."
          },
          {
            "name": "9000-CARDFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE CARDFILE-FILE                                                  \n           IF  CARDFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CARDFILE'                                 \n               MOVE CARDFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the CARDFILE-FILE and implements error handling for the operation. It first sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to zero, indicating normal processing. If the close operation fails, it sets APPL-RESULT to 12, indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program with a controlled abend. This ensures proper resource cleanup and provides diagnostic information when file closing operations fail."
          },
          {
            "name": "9999-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************",
            "description": "This paragraph handles program termination with a controlled abend. When called, it displays an \"ABENDING PROGRAM\" message, resets the TIMING variable to zero, sets the abend code to 999, and then invokes the Language Environment service 'CEE3ABD' to abnormally terminate the program. This is likely used as part of the error handling strategy when unrecoverable errors are encountered during file processing."
          },
          {
            "name": "9910-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *",
            "description": "This paragraph handles the formatting and display of file I/O status codes for error reporting. It performs special processing for extended file status codes (when the first byte is '9' or the status is non-numeric), converting the second byte to a proper display format. For standard status codes, it formats them with leading zeros. In both cases, it displays the formatted status code with a descriptive message. This standardized error handling routine ensures consistent reporting of file operation results throughout the program, which aids in troubleshooting file access issues."
          }
        ],
        "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBACT02C'.                    \n           PERFORM 0000-CARDFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-CARDFILE-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                       DISPLAY CARD-RECORD                                      \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-CARDFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT02C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-CARDFILE-GET-NEXT.                                                  \n           READ CARDFILE-FILE INTO CARD-RECORD.                                 \n           IF  CARDFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n      *        DISPLAY CARD-RECORD                                              \n           ELSE                                                                 \n               IF  CARDFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING CARDFILE'                             \n                   MOVE CARDFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-CARDFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT CARDFILE-FILE                                             \n           IF  CARDFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CARDFILE'                                 \n               MOVE CARDFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-CARDFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE CARDFILE-FILE                                                  \n           IF  CARDFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CARDFILE'                                 \n               MOVE CARDFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *"
      },
      "description": "This batch program reads card data from an indexed VSAM file and displays each record. It sequentially processes the CARDFILE, which contains credit card information, and prints the contents to standard output. The program includes comprehensive error handling for file operations (open, read, close) with detailed status code reporting. It incorporates standard file processing patterns with status checking after each operation and will terminate with a controlled abend if any errors occur. The program is part of the CardDemo application suite designed to showcase AWS mainframe migration capabilities.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBACT02C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                               \n      * Function    : Read and print card data file.                    \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.    CBACT02C.                                                 \n       AUTHOR.        AWS.                                                      \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n       FILE-CONTROL.                                                            \n           SELECT CARDFILE-FILE ASSIGN TO   CARDFILE                            \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-CARD-NUM                                   \n                  FILE STATUS  IS CARDFILE-STATUS.                              \n      *                                                                         \n       DATA DIVISION.                                                           \n       FILE SECTION.                                                            \n       FD  CARDFILE-FILE.                                                       \n       01  FD-CARDFILE-REC.                                                     \n           05 FD-CARD-NUM                       PIC X(16).                      \n           05 FD-CARD-DATA                      PIC X(134).                     \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVACT02Y.                                                           \n       01  CARDFILE-STATUS.                                                     \n           05  CARDFILE-STAT1      PIC X.                                       \n           05  CARDFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************         \n       PROCEDURE DIVISION.                                                      \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBACT02C'.                    \n           PERFORM 0000-CARDFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-CARDFILE-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                       DISPLAY CARD-RECORD                                      \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-CARDFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT02C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-CARDFILE-GET-NEXT.                                                  \n           READ CARDFILE-FILE INTO CARD-RECORD.                                 \n           IF  CARDFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n      *        DISPLAY CARD-RECORD                                              \n           ELSE                                                                 \n               IF  CARDFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING CARDFILE'                             \n                   MOVE CARDFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-CARDFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT CARDFILE-FILE                                             \n           IF  CARDFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CARDFILE'                                 \n               MOVE CARDFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-CARDFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE CARDFILE-FILE                                                  \n           IF  CARDFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CARDFILE'                                 \n               MOVE CARDFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVACT02Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as Main Program\n    participant Open as 0000-CARDFILE-OPEN\n    participant Read as 1000-CARDFILE-GET-NEXT\n    participant Close as 9000-CARDFILE-CLOSE\n    participant Status as 9910-DISPLAY-IO-STATUS\n    participant Abend as 9999-ABEND-PROGRAM\n    participant VSAM as CARDFILE-FILE (VSAM)\n\n    Main->>Open: Perform file open\n    Open->>VSAM: OPEN INPUT\n    VSAM-->>Open: Return status\n    \n    alt File open successful\n        Open-->>Main: Continue processing\n        \n        loop Until END-OF-FILE = 'Y'\n            Main->>Read: Perform read next record\n            Read->>VSAM: READ INTO CARD-RECORD\n            VSAM-->>Read: Return status\n            \n            alt Read successful (status '00')\n                Read-->>Main: APPL-RESULT = 0\n            else End of file (status '10')\n                Read->>Read: Set END-OF-FILE = 'Y'\n                Read-->>Main: APPL-RESULT = 16\n            else Read error\n                Read->>Status: PERFORM 9910-DISPLAY-IO-STATUS\n                Status->>Status: Format and display status code\n                Status-->>Read: Return\n                Read->>Abend: PERFORM 9999-ABEND-PROGRAM\n                Abend->>Abend: Display message\n                Abend->>Abend: Call CEE3ABD\n                Note over Abend: Program terminates\n            end\n        end\n        \n        Main->>Close: Perform file close\n        Close->>VSAM: CLOSE\n        VSAM-->>Close: Return status\n        \n        alt Close successful\n            Close-->>Main: Continue processing\n        else Close error\n            Close->>Status: PERFORM 9910-DISPLAY-IO-STATUS\n            Status->>Status: Format and display status code\n            Status-->>Close: Return\n            Close->>Abend: PERFORM 9999-ABEND-PROGRAM\n            Abend->>Abend: Display message\n            Abend->>Abend: Call CEE3ABD\n            Note over Abend: Program terminates\n        end\n        \n    else File open error\n        Open->>Status: PERFORM 9910-DISPLAY-IO-STATUS\n        Status->>Status: Format and display status code\n        Status-->>Open: Return\n        Open->>Abend: PERFORM 9999-ABEND-PROGRAM\n        Abend->>Abend: Display message\n        Abend->>Abend: Call CEE3ABD\n        Note over Abend: Program terminates\n    end"
    },
    {
      "id": "CORPT00C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration details for the CORPT00C program, including file assignments, special names, and system dependencies. In this CICS COBOL application, the Configuration Section would define resources needed for the transaction report generation functionality, such as the \"JOBS\" TDQ used for job submission to the internal reader, any file definitions required for processing, and possibly special names for date handling with the CSUTLDTC utility. However, the specific configuration details are not provided in the snippet."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'CORPT00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CR00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.\n           88 TRANSACT-EOF                       VALUE 'Y'.\n           88 TRANSACT-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n         05 WS-END-LOOP                PIC X(01) VALUE 'N'.\n           88 END-LOOP-YES                       VALUE 'Y'.\n           88 END-LOOP-NO                        VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-REPORT-NAME             PIC X(10) VALUE SPACES.\n\n         05 WS-START-DATE.\n            10 WS-START-DATE-YYYY      PIC X(04) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-START-DATE-MM        PIC X(02) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-START-DATE-DD        PIC X(02) VALUE SPACES.\n         05 WS-END-DATE.\n            10 WS-END-DATE-YYYY        PIC X(04) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-END-DATE-MM          PIC X(02) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-END-DATE-DD          PIC X(02) VALUE SPACES.\n         05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.\n\n         05 WS-NUM-99                  PIC 99   VALUE 0.\n         05 WS-NUM-9999                PIC 9999 VALUE 0.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 JCL-RECORD                 PIC X(80) VALUE ' '.\n\n       01 JOB-DATA.\n        02 JOB-DATA-1.\n         05 FILLER                     PIC X(80) VALUE\n         \"//TRNRPT00 JOB 'TRAN REPORT',CLASS=A,MSGCLASS=0,\".\n         05 FILLER                     PIC X(80) VALUE\n         \"// NOTIFY=&SYSUID\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP10 EXEC PROC=TRANREPT\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP05R.SYMNAMES DD *\".\n         05 FILLER                     PIC X(80) VALUE\n         \"TRAN-CARD-NUM,263,16,ZD\".\n         05 FILLER                     PIC X(80) VALUE\n         \"TRAN-PROC-DT,305,10,CH\".\n         05 FILLER-1.\n            10 FILLER                  PIC X(18) VALUE\n         \"PARM-START-DATE,C'\".\n            10 PARM-START-DATE-1       PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(52) VALUE \"'\".\n         05 FILLER-2.\n            10 FILLER                  PIC X(16) VALUE\n         \"PARM-END-DATE,C'\".\n            10 PARM-END-DATE-1         PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(54) VALUE \"'\".\n         05 FILLER                     PIC X(80) VALUE\n         \"/*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP10R.DATEPARM DD *\".\n         05 FILLER-3.\n            10 PARM-START-DATE-2       PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X VALUE SPACE.\n            10 PARM-END-DATE-2         PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(59) VALUE SPACES.\n         05 FILLER                     PIC X(80) VALUE\n         \"/*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"/*EOF\".\n        02 JOB-DATA-2 REDEFINES JOB-DATA-1.\n         05 JOB-LINES OCCURS 1000 TIMES PIC X(80).\n\n       01 CSUTLDTC-PARM.\n          05 CSUTLDTC-DATE                   PIC X(10).\n          05 CSUTLDTC-DATE-FORMAT            PIC X(10).\n          05 CSUTLDTC-RESULT.\n             10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).\n             10 FILLER                       PIC X(11).\n             10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).\n             10 CSUTLDTC-RESULT-MSG          PIC X(61).\n\n       COPY COCOM01Y.\n\n       COPY CORPT00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working Storage Section defines the data structures used in the CORPT00C program for transaction report generation. It includes variables for program control, error handling, and date processing. Key elements include flags for error handling and processing control, date fields structured in YYYY-MM-DD format for report date ranges, and an extensive JCL job template structure (JOB-DATA) that will be populated and submitted to the internal reader. The section also contains parameters for date validation using the CSUTLDTC utility. The program incorporates several copybooks for common functionality, including screen layouts (CORPT00), title components (COTTL01Y), date handling (CSDAT01Y), messaging (CSMSG01Y), transaction processing (CVTRA05Y), and standard CICS definitions (DFHAID, DFHBMSCA)."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the DFHCOMMAREA in the Linkage Section, which is used to receive and pass data between CICS transactions. It contains a single field, LK-COMMAREA, defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This structure allows the program to handle communication areas of different sizes when the program is invoked from other CICS programs or when control returns to this program after a transfer."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'CORPT00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CR00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.\n           88 TRANSACT-EOF                       VALUE 'Y'.\n           88 TRANSACT-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n         05 WS-END-LOOP                PIC X(01) VALUE 'N'.\n           88 END-LOOP-YES                       VALUE 'Y'.\n           88 END-LOOP-NO                        VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-REPORT-NAME             PIC X(10) VALUE SPACES.\n\n         05 WS-START-DATE.\n            10 WS-START-DATE-YYYY      PIC X(04) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-START-DATE-MM        PIC X(02) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-START-DATE-DD        PIC X(02) VALUE SPACES.\n         05 WS-END-DATE.\n            10 WS-END-DATE-YYYY        PIC X(04) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-END-DATE-MM          PIC X(02) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-END-DATE-DD          PIC X(02) VALUE SPACES.\n         05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.\n\n         05 WS-NUM-99                  PIC 99   VALUE 0.\n         05 WS-NUM-9999                PIC 9999 VALUE 0.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 JCL-RECORD                 PIC X(80) VALUE ' '.\n\n       01 JOB-DATA.\n        02 JOB-DATA-1.\n         05 FILLER                     PIC X(80) VALUE\n         \"//TRNRPT00 JOB 'TRAN REPORT',CLASS=A,MSGCLASS=0,\".\n         05 FILLER                     PIC X(80) VALUE\n         \"// NOTIFY=&SYSUID\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP10 EXEC PROC=TRANREPT\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP05R.SYMNAMES DD *\".\n         05 FILLER                     PIC X(80) VALUE\n         \"TRAN-CARD-NUM,263,16,ZD\".\n         05 FILLER                     PIC X(80) VALUE\n         \"TRAN-PROC-DT,305,10,CH\".\n         05 FILLER-1.\n            10 FILLER                  PIC X(18) VALUE\n         \"PARM-START-DATE,C'\".\n            10 PARM-START-DATE-1       PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(52) VALUE \"'\".\n         05 FILLER-2.\n            10 FILLER                  PIC X(16) VALUE\n         \"PARM-END-DATE,C'\".\n            10 PARM-END-DATE-1         PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(54) VALUE \"'\".\n         05 FILLER                     PIC X(80) VALUE\n         \"/*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP10R.DATEPARM DD *\".\n         05 FILLER-3.\n            10 PARM-START-DATE-2       PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X VALUE SPACE.\n            10 PARM-END-DATE-2         PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(59) VALUE SPACES.\n         05 FILLER                     PIC X(80) VALUE\n         \"/*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"/*EOF\".\n        02 JOB-DATA-2 REDEFINES JOB-DATA-1.\n         05 JOB-LINES OCCURS 1000 TIMES PIC X(80).\n\n       01 CSUTLDTC-PARM.\n          05 CSUTLDTC-DATE                   PIC X(10).\n          05 CSUTLDTC-DATE-FORMAT            PIC X(10).\n          05 CSUTLDTC-RESULT.\n             10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).\n             10 FILLER                       PIC X(11).\n             10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).\n             10 CSUTLDTC-RESULT-MSG          PIC X(61).\n\n       COPY COCOM01Y.\n\n       COPY CORPT00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF CORPT0AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO CORPT0AO\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNRPT-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO MONTHLYL OF CORPT0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNRPT-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the transaction report generation program. It initializes error flags, handles first-time entry versus re-entry to the program, and processes user interactions.\n\nWhen first entered, the code checks if a communication area exists. If not, it returns to the sign-on program (COSGN00C). For valid entries, it either displays the initial report selection screen or processes user input from a previously displayed screen.\n\nThe paragraph implements navigation logic through function key handling - specifically processing ENTER key actions through a separate paragraph and allowing users to return to the menu screen (COMEN01C) via PF3. Any other key inputs trigger an error message.\n\nThe code maintains program state between interactions by returning with the transaction ID and communication area, enabling the conversation to continue when the user responds."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "DISPLAY 'PROCESS ENTER KEY'\n\n           EVALUATE TRUE\n               WHEN MONTHLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Monthly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-START-DATE-MM\n                   MOVE '01'                TO WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n\n                   MOVE 1              TO WS-CURDATE-DAY\n                   ADD 1               TO WS-CURDATE-MONTH\n                   IF WS-CURDATE-MONTH > 12\n                       ADD 1           TO WS-CURDATE-YEAR\n                       MOVE 1          TO WS-CURDATE-MONTH\n                   END-IF\n                   COMPUTE WS-CURDATE-N = FUNCTION DATE-OF-INTEGER(\n                           FUNCTION INTEGER-OF-DATE(WS-CURDATE-N) - 1)\n\n                   MOVE WS-CURDATE-YEAR     TO WS-END-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-END-DATE-MM\n                   MOVE WS-CURDATE-DAY      TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN YEARLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Yearly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                                               WS-END-DATE-YYYY\n                   MOVE '01'                TO WS-START-DATE-MM\n                                               WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n\n                   MOVE '12'                TO WS-END-DATE-MM\n                   MOVE '31'                TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN CUSTOMI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n\n                   EVALUATE TRUE\n                       WHEN SDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN OTHER\n                           CONTINUE\n                   END-EVALUATE\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTMMI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTDDI OF CORPT0AI\n\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (SDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO SDTYYYYI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTMMI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTDDI OF CORPT0AI\n\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (EDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO EDTYYYYI OF CORPT0AI\n\n                   IF SDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTMMI OF CORPT0AI > '12'\n                       MOVE 'Start Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF SDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTDDI OF CORPT0AI > '31'\n                       MOVE 'Start Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF SDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'Start Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTMMI OF CORPT0AI > '12'\n                       MOVE 'End Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTDDI OF CORPT0AI > '31'\n                       MOVE 'End Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'End Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   MOVE SDTYYYYI OF CORPT0AI TO WS-START-DATE-YYYY\n                   MOVE SDTMMI   OF CORPT0AI TO WS-START-DATE-MM\n                   MOVE SDTDDI   OF CORPT0AI TO WS-START-DATE-DD\n                   MOVE EDTYYYYI OF CORPT0AI TO WS-END-DATE-YYYY\n                   MOVE EDTMMI   OF CORPT0AI TO WS-END-DATE-MM\n                   MOVE EDTDDI   OF CORPT0AI TO WS-END-DATE-DD\n\n                   MOVE WS-START-DATE        TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'Start Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n\n                   MOVE WS-END-DATE          TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'End Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n\n\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n                   MOVE 'Custom'   TO WS-REPORT-NAME\n                   IF NOT ERR-FLG-ON\n                       PERFORM SUBMIT-JOB-TO-INTRDR\n                   END-IF\n               WHEN OTHER\n                   MOVE 'Select a report type to print report...' TO\n                                   WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n\n               PERFORM INITIALIZE-ALL-FIELDS\n               MOVE DFHGREEN           TO ERRMSGC  OF CORPT0AO\n               STRING WS-REPORT-NAME   DELIMITED BY SPACE\n                 ' report submitted for printing ...'\n                                       DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE -1       TO MONTHLYL OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n\n           END-IF.\n\n\n      *----------------------------------------------------------------*\n      *                      SUBMIT-JOB-TO-INTRDR\n      *----------------------------------------------------------------*",
            "description": "This paragraph processes the Enter key action in the transaction report generation interface, handling three report types: monthly, yearly, and custom date range. For monthly and yearly reports, it automatically calculates appropriate date ranges (current month or current year respectively). For custom reports, it performs extensive validation of user-entered dates, checking for empty fields, numeric values, valid ranges (months 1-12, days 1-31), and valid calendar dates using the CSUTLDTC utility. After validation, it prepares the report parameters and calls the SUBMIT-JOB-TO-INTRDR paragraph to submit the batch job. The code includes comprehensive error handling with specific error messages for each validation failure, positioning the cursor at the problematic field. Upon successful submission, it displays a confirmation message indicating which report type was submitted."
          },
          {
            "name": "SUBMIT-JOB-TO-INTRDR",
            "code": "IF CONFIRMI OF CORPT0AI = SPACES OR LOW-VALUES\n               STRING\n                 'Please confirm to print the '\n                                   DELIMITED BY SIZE\n                 WS-REPORT-NAME    DELIMITED BY SPACE\n                 ' report...'      DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE -1       TO CONFIRML OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               EVALUATE TRUE\n                   WHEN CONFIRMI OF CORPT0AI = 'Y' OR 'y'\n                       CONTINUE\n                   WHEN CONFIRMI OF CORPT0AI = 'N' OR 'n'\n                       PERFORM INITIALIZE-ALL-FIELDS\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       PERFORM SEND-TRNRPT-SCREEN\n                   WHEN OTHER\n                       STRING\n                         '\"'               DELIMITED BY SIZE\n                         CONFIRMI OF CORPT0AI    DELIMITED BY SPACE\n                         '\" is not a valid value to confirm...'\n                                           DELIMITED BY SIZE\n                         INTO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO CONFIRML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n               END-EVALUATE\n\n               SET END-LOOP-NO TO TRUE\n\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 1000 OR\n                                      END-LOOP-YES  OR ERR-FLG-ON\n\n                   MOVE JOB-LINES(WS-IDX) TO JCL-RECORD\n                   IF JCL-RECORD = '/*EOF' OR\n                      JCL-RECORD = SPACES OR LOW-VALUES\n                       SET END-LOOP-YES TO TRUE\n                   END-IF\n\n                   PERFORM WIRTE-JOBSUB-TDQ\n               END-PERFORM\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      WIRTE-JOBSUB-TDQ\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the job submission confirmation process and writes the JCL to the transient data queue. It first checks if the user has provided confirmation input. If not, it prompts the user to confirm the report generation. When confirmation is provided, it validates the response ('Y' or 'N'), either continuing with job submission for 'Y' or reinitializing the screen for 'N'. For invalid confirmation values, it displays an error message. Once confirmed, the paragraph iterates through the pre-constructed JCL statements in the JOB-LINES array, writing each line to the JOBS transient data queue until it encounters an end marker ('/*EOF') or empty line. This effectively submits the batch job to the internal reader for execution."
          },
          {
            "name": "WIRTE-JOBSUB-TDQ",
            "code": "EXEC CICS WRITEQ TD\n             QUEUE ('JOBS')\n             FROM (JCL-RECORD)\n             LENGTH (LENGTH OF JCL-RECORD)\n             RESP(WS-RESP-CD)\n             RESP2(WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Write TDQ (JOBS)...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the submission of JCL job records to the \"JOBS\" transient data queue (TDQ) which serves as an interface to the internal reader. It writes the constructed JCL record to the queue and implements error handling logic. If the operation completes normally, processing continues. For any other response code, the paragraph displays diagnostic information (response and reason codes), sets an error flag, prepares an error message for the user, positions the cursor at the MONTHLY field on the input screen, and then calls the SEND-TRNRPT-SCREEN paragraph to display the error to the user. This is a critical component of the job submission process that ensures proper feedback when the TDQ write operation fails."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNRPT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the navigation back to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, and if not, defaults to 'COSGN00C' (likely the main menu or sign-on screen). It then sets up the communication area with the current transaction ID and program name as the source of the transfer, resets the program context to zeros, and uses the CICS XCTL command to transfer control to the target program while passing the communication area. This provides a consistent navigation mechanism throughout the application."
          },
          {
            "name": "SEND-TRNRPT-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF CORPT0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n           GO TO RETURN-TO-CICS.\n\n      *----------------------------------------------------------------*\n      *                         RETURN-TO-CICS\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the display of the transaction report screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up common header information, then displays any system messages stored in WS-MESSAGE to the user. The paragraph uses conditional logic to determine whether to send the screen with the ERASE option (which clears the screen before displaying) or without it, based on the SEND-ERASE-YES flag. In both cases, it sends the CORPT0A map from the CORPT00 mapset with cursor positioning. After sending the screen, it transfers control to the RETURN-TO-CICS paragraph to return control to CICS."
          },
          {
            "name": "RETURN-TO-CICS",
            "code": "EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNRPT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the return to CICS control after processing is complete. It executes a CICS RETURN command that specifies the transaction ID stored in WS-TRANID and passes the CARDDEMO-COMMAREA as the communication area for the next transaction. The LENGTH parameter is commented out, which means the system will use the default length of the COMMAREA. This is typically used at the end of processing to either terminate the transaction or to pass control back to CICS for the next transaction execution."
          },
          {
            "name": "RECEIVE-TRNRPT-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('CORPT0A')\n                     MAPSET('CORPT00')\n                     INTO(CORPT0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the transaction report selection screen (CORPT0A) into the input map area (CORPT0AI). It captures the user's report type selection and date parameters entered on the screen. The CICS RECEIVE command stores response codes in WS-RESP-CD and WS-REAS-CD variables for error handling. After receiving the screen data, control will flow to the POPULATE-HEADER-INFO paragraph which likely prepares common header information for the interface."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF CORPT0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF CORPT0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF CORPT0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF CORPT0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CORPT0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CORPT0AO.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the transaction report screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information on the screen. The paragraph sets the screen title fields from constants, displays the transaction ID and program name, and formats the current date in MM/DD/YY format and the current time in HH:MM:SS format for display. This ensures the user interface shows accurate identifying information and timestamps when generating transaction reports."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO MONTHLYL OF CORPT0AI\n           INITIALIZE              MONTHLYI OF CORPT0AI\n                                   YEARLYI  OF CORPT0AI\n                                   CUSTOMI  OF CORPT0AI\n                                   SDTMMI   OF CORPT0AI\n                                   SDTDDI   OF CORPT0AI\n                                   SDTYYYYI OF CORPT0AI\n                                   EDTMMI   OF CORPT0AI\n                                   EDTDDI   OF CORPT0AI\n                                   EDTYYYYI OF CORPT0AI\n                                   CONFIRMI OF CORPT0AI",
            "description": "This paragraph initializes the input fields on the transaction report generation screen. It first positions the cursor at the MONTHLY field by setting its length attribute to -1, then clears all input fields including report type selection options (MONTHLY, YEARLY, CUSTOM), start date components (month, day, year), end date components (month, day, year), and the confirmation field. This ensures the screen is reset to a clean state when the user first accesses the report generation interface or when fields need to be cleared during processing."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *",
            "description": "This paragraph contains version control information for the CORPT00C program, showing it's part of the CardDemo application version 1.0-15-g27d6c6f-68, with a timestamp of July 19, 2022, at 23:12:33 CDT. This helps track which version of the code is deployed and when it was last updated."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF CORPT0AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO CORPT0AO\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNRPT-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO MONTHLYL OF CORPT0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNRPT-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           DISPLAY 'PROCESS ENTER KEY'\n\n           EVALUATE TRUE\n               WHEN MONTHLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Monthly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-START-DATE-MM\n                   MOVE '01'                TO WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n\n                   MOVE 1              TO WS-CURDATE-DAY\n                   ADD 1               TO WS-CURDATE-MONTH\n                   IF WS-CURDATE-MONTH > 12\n                       ADD 1           TO WS-CURDATE-YEAR\n                       MOVE 1          TO WS-CURDATE-MONTH\n                   END-IF\n                   COMPUTE WS-CURDATE-N = FUNCTION DATE-OF-INTEGER(\n                           FUNCTION INTEGER-OF-DATE(WS-CURDATE-N) - 1)\n\n                   MOVE WS-CURDATE-YEAR     TO WS-END-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-END-DATE-MM\n                   MOVE WS-CURDATE-DAY      TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN YEARLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Yearly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                                               WS-END-DATE-YYYY\n                   MOVE '01'                TO WS-START-DATE-MM\n                                               WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n\n                   MOVE '12'                TO WS-END-DATE-MM\n                   MOVE '31'                TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN CUSTOMI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n\n                   EVALUATE TRUE\n                       WHEN SDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN OTHER\n                           CONTINUE\n                   END-EVALUATE\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTMMI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTDDI OF CORPT0AI\n\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (SDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO SDTYYYYI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTMMI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTDDI OF CORPT0AI\n\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (EDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO EDTYYYYI OF CORPT0AI\n\n                   IF SDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTMMI OF CORPT0AI > '12'\n                       MOVE 'Start Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF SDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTDDI OF CORPT0AI > '31'\n                       MOVE 'Start Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF SDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'Start Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTMMI OF CORPT0AI > '12'\n                       MOVE 'End Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTDDI OF CORPT0AI > '31'\n                       MOVE 'End Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'End Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   MOVE SDTYYYYI OF CORPT0AI TO WS-START-DATE-YYYY\n                   MOVE SDTMMI   OF CORPT0AI TO WS-START-DATE-MM\n                   MOVE SDTDDI   OF CORPT0AI TO WS-START-DATE-DD\n                   MOVE EDTYYYYI OF CORPT0AI TO WS-END-DATE-YYYY\n                   MOVE EDTMMI   OF CORPT0AI TO WS-END-DATE-MM\n                   MOVE EDTDDI   OF CORPT0AI TO WS-END-DATE-DD\n\n                   MOVE WS-START-DATE        TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'Start Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n\n                   MOVE WS-END-DATE          TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'End Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n\n\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n                   MOVE 'Custom'   TO WS-REPORT-NAME\n                   IF NOT ERR-FLG-ON\n                       PERFORM SUBMIT-JOB-TO-INTRDR\n                   END-IF\n               WHEN OTHER\n                   MOVE 'Select a report type to print report...' TO\n                                   WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n\n               PERFORM INITIALIZE-ALL-FIELDS\n               MOVE DFHGREEN           TO ERRMSGC  OF CORPT0AO\n               STRING WS-REPORT-NAME   DELIMITED BY SPACE\n                 ' report submitted for printing ...'\n                                       DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE -1       TO MONTHLYL OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n\n           END-IF.\n\n\n      *----------------------------------------------------------------*\n      *                      SUBMIT-JOB-TO-INTRDR\n      *----------------------------------------------------------------*\n       SUBMIT-JOB-TO-INTRDR.\n\n           IF CONFIRMI OF CORPT0AI = SPACES OR LOW-VALUES\n               STRING\n                 'Please confirm to print the '\n                                   DELIMITED BY SIZE\n                 WS-REPORT-NAME    DELIMITED BY SPACE\n                 ' report...'      DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE -1       TO CONFIRML OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               EVALUATE TRUE\n                   WHEN CONFIRMI OF CORPT0AI = 'Y' OR 'y'\n                       CONTINUE\n                   WHEN CONFIRMI OF CORPT0AI = 'N' OR 'n'\n                       PERFORM INITIALIZE-ALL-FIELDS\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       PERFORM SEND-TRNRPT-SCREEN\n                   WHEN OTHER\n                       STRING\n                         '\"'               DELIMITED BY SIZE\n                         CONFIRMI OF CORPT0AI    DELIMITED BY SPACE\n                         '\" is not a valid value to confirm...'\n                                           DELIMITED BY SIZE\n                         INTO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO CONFIRML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n               END-EVALUATE\n\n               SET END-LOOP-NO TO TRUE\n\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 1000 OR\n                                      END-LOOP-YES  OR ERR-FLG-ON\n\n                   MOVE JOB-LINES(WS-IDX) TO JCL-RECORD\n                   IF JCL-RECORD = '/*EOF' OR\n                      JCL-RECORD = SPACES OR LOW-VALUES\n                       SET END-LOOP-YES TO TRUE\n                   END-IF\n\n                   PERFORM WIRTE-JOBSUB-TDQ\n               END-PERFORM\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      WIRTE-JOBSUB-TDQ\n      *----------------------------------------------------------------*\n       WIRTE-JOBSUB-TDQ.\n\n           EXEC CICS WRITEQ TD\n             QUEUE ('JOBS')\n             FROM (JCL-RECORD)\n             LENGTH (LENGTH OF JCL-RECORD)\n             RESP(WS-RESP-CD)\n             RESP2(WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Write TDQ (JOBS)...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNRPT-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNRPT-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF CORPT0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n           GO TO RETURN-TO-CICS.\n\n      *----------------------------------------------------------------*\n      *                         RETURN-TO-CICS\n      *----------------------------------------------------------------*\n       RETURN-TO-CICS.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNRPT-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNRPT-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('CORPT0A')\n                     MAPSET('CORPT00')\n                     INTO(CORPT0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF CORPT0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF CORPT0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF CORPT0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF CORPT0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CORPT0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CORPT0AO.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO MONTHLYL OF CORPT0AI\n           INITIALIZE              MONTHLYI OF CORPT0AI\n                                   YEARLYI  OF CORPT0AI\n                                   CUSTOMI  OF CORPT0AI\n                                   SDTMMI   OF CORPT0AI\n                                   SDTDDI   OF CORPT0AI\n                                   SDTYYYYI OF CORPT0AI\n                                   EDTMMI   OF CORPT0AI\n                                   EDTDDI   OF CORPT0AI\n                                   EDTYYYYI OF CORPT0AI\n                                   CONFIRMI OF CORPT0AI\n                                   WS-MESSAGE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *"
      },
      "description": "This program (CORPT00C) is a CICS COBOL application that allows users to generate transaction reports by submitting batch jobs from an online interface using an extra partition transient data queue (TDQ). The program provides three report options: monthly, yearly, and custom date range reports. \n\nWhen executed, the program displays a screen where users can select a report type and specify date parameters for custom reports. After validation of user inputs (including date format validation using the CSUTLDTC utility), the program constructs a JCL job with the appropriate parameters and submits it to the internal reader via the \"JOBS\" TDQ. The batch job (TRNRPT00) will then execute the transaction report generation process based on the specified date range.\n\nThe program includes comprehensive error handling for input validation, ensuring dates are properly formatted and valid before job submission. It also requires user confirmation before submitting the report job. The interface provides navigation options, including the ability to return to a previous menu screen.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : CORPT00C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Print Transaction reports by submitting batch \n      *               job from online using extra partition TDQ.  \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. CORPT00C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'CORPT00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CR00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.\n           88 TRANSACT-EOF                       VALUE 'Y'.\n           88 TRANSACT-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n         05 WS-END-LOOP                PIC X(01) VALUE 'N'.\n           88 END-LOOP-YES                       VALUE 'Y'.\n           88 END-LOOP-NO                        VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-REPORT-NAME             PIC X(10) VALUE SPACES.\n\n         05 WS-START-DATE.\n            10 WS-START-DATE-YYYY      PIC X(04) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-START-DATE-MM        PIC X(02) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-START-DATE-DD        PIC X(02) VALUE SPACES.\n         05 WS-END-DATE.\n            10 WS-END-DATE-YYYY        PIC X(04) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-END-DATE-MM          PIC X(02) VALUE SPACES.\n            10 FILLER                  PIC X(01) VALUE '-'.\n            10 WS-END-DATE-DD          PIC X(02) VALUE SPACES.\n         05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.\n\n         05 WS-NUM-99                  PIC 99   VALUE 0.\n         05 WS-NUM-9999                PIC 9999 VALUE 0.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 JCL-RECORD                 PIC X(80) VALUE ' '.\n\n       01 JOB-DATA.\n        02 JOB-DATA-1.\n         05 FILLER                     PIC X(80) VALUE\n         \"//TRNRPT00 JOB 'TRAN REPORT',CLASS=A,MSGCLASS=0,\".\n         05 FILLER                     PIC X(80) VALUE\n         \"// NOTIFY=&SYSUID\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP10 EXEC PROC=TRANREPT\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP05R.SYMNAMES DD *\".\n         05 FILLER                     PIC X(80) VALUE\n         \"TRAN-CARD-NUM,263,16,ZD\".\n         05 FILLER                     PIC X(80) VALUE\n         \"TRAN-PROC-DT,305,10,CH\".\n         05 FILLER-1.\n            10 FILLER                  PIC X(18) VALUE\n         \"PARM-START-DATE,C'\".\n            10 PARM-START-DATE-1       PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(52) VALUE \"'\".\n         05 FILLER-2.\n            10 FILLER                  PIC X(16) VALUE\n         \"PARM-END-DATE,C'\".\n            10 PARM-END-DATE-1         PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(54) VALUE \"'\".\n         05 FILLER                     PIC X(80) VALUE\n         \"/*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"//STEP10R.DATEPARM DD *\".\n         05 FILLER-3.\n            10 PARM-START-DATE-2       PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X VALUE SPACE.\n            10 PARM-END-DATE-2         PIC X(10) VALUE SPACES.\n            10 FILLER                  PIC X(59) VALUE SPACES.\n         05 FILLER                     PIC X(80) VALUE\n         \"/*\".\n         05 FILLER                     PIC X(80) VALUE\n         \"/*EOF\".\n        02 JOB-DATA-2 REDEFINES JOB-DATA-1.\n         05 JOB-LINES OCCURS 1000 TIMES PIC X(80).\n\n       01 CSUTLDTC-PARM.\n          05 CSUTLDTC-DATE                   PIC X(10).\n          05 CSUTLDTC-DATE-FORMAT            PIC X(10).\n          05 CSUTLDTC-RESULT.\n             10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).\n             10 FILLER                       PIC X(11).\n             10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).\n             10 CSUTLDTC-RESULT-MSG          PIC X(61).\n\n       COPY COCOM01Y.\n\n       COPY CORPT00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF CORPT0AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO CORPT0AO\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNRPT-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO MONTHLYL OF CORPT0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNRPT-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           DISPLAY 'PROCESS ENTER KEY'\n\n           EVALUATE TRUE\n               WHEN MONTHLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Monthly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-START-DATE-MM\n                   MOVE '01'                TO WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n\n                   MOVE 1              TO WS-CURDATE-DAY\n                   ADD 1               TO WS-CURDATE-MONTH\n                   IF WS-CURDATE-MONTH > 12\n                       ADD 1           TO WS-CURDATE-YEAR\n                       MOVE 1          TO WS-CURDATE-MONTH\n                   END-IF\n                   COMPUTE WS-CURDATE-N = FUNCTION DATE-OF-INTEGER(\n                           FUNCTION INTEGER-OF-DATE(WS-CURDATE-N) - 1)\n\n                   MOVE WS-CURDATE-YEAR     TO WS-END-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-END-DATE-MM\n                   MOVE WS-CURDATE-DAY      TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN YEARLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Yearly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                                               WS-END-DATE-YYYY\n                   MOVE '01'                TO WS-START-DATE-MM\n                                               WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n\n                   MOVE '12'                TO WS-END-DATE-MM\n                   MOVE '31'                TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN CUSTOMI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n\n                   EVALUATE TRUE\n                       WHEN SDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN OTHER\n                           CONTINUE\n                   END-EVALUATE\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTMMI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTDDI OF CORPT0AI\n\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (SDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO SDTYYYYI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTMMI OF CORPT0AI\n\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTDDI OF CORPT0AI\n\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (EDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO EDTYYYYI OF CORPT0AI\n\n                   IF SDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTMMI OF CORPT0AI > '12'\n                       MOVE 'Start Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF SDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTDDI OF CORPT0AI > '31'\n                       MOVE 'Start Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF SDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'Start Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTMMI OF CORPT0AI > '12'\n                       MOVE 'End Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTDDI OF CORPT0AI > '31'\n                       MOVE 'End Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   IF EDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'End Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n\n                   MOVE SDTYYYYI OF CORPT0AI TO WS-START-DATE-YYYY\n                   MOVE SDTMMI   OF CORPT0AI TO WS-START-DATE-MM\n                   MOVE SDTDDI   OF CORPT0AI TO WS-START-DATE-DD\n                   MOVE EDTYYYYI OF CORPT0AI TO WS-END-DATE-YYYY\n                   MOVE EDTMMI   OF CORPT0AI TO WS-END-DATE-MM\n                   MOVE EDTDDI   OF CORPT0AI TO WS-END-DATE-DD\n\n                   MOVE WS-START-DATE        TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'Start Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n\n                   MOVE WS-END-DATE          TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'End Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n\n\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n                   MOVE 'Custom'   TO WS-REPORT-NAME\n                   IF NOT ERR-FLG-ON\n                       PERFORM SUBMIT-JOB-TO-INTRDR\n                   END-IF\n               WHEN OTHER\n                   MOVE 'Select a report type to print report...' TO\n                                   WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n\n               PERFORM INITIALIZE-ALL-FIELDS\n               MOVE DFHGREEN           TO ERRMSGC  OF CORPT0AO\n               STRING WS-REPORT-NAME   DELIMITED BY SPACE\n                 ' report submitted for printing ...'\n                                       DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE -1       TO MONTHLYL OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n\n           END-IF.\n\n\n      *----------------------------------------------------------------*\n      *                      SUBMIT-JOB-TO-INTRDR\n      *----------------------------------------------------------------*\n       SUBMIT-JOB-TO-INTRDR.\n\n           IF CONFIRMI OF CORPT0AI = SPACES OR LOW-VALUES\n               STRING\n                 'Please confirm to print the '\n                                   DELIMITED BY SIZE\n                 WS-REPORT-NAME    DELIMITED BY SPACE\n                 ' report...'      DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE -1       TO CONFIRML OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               EVALUATE TRUE\n                   WHEN CONFIRMI OF CORPT0AI = 'Y' OR 'y'\n                       CONTINUE\n                   WHEN CONFIRMI OF CORPT0AI = 'N' OR 'n'\n                       PERFORM INITIALIZE-ALL-FIELDS\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       PERFORM SEND-TRNRPT-SCREEN\n                   WHEN OTHER\n                       STRING\n                         '\"'               DELIMITED BY SIZE\n                         CONFIRMI OF CORPT0AI    DELIMITED BY SPACE\n                         '\" is not a valid value to confirm...'\n                                           DELIMITED BY SIZE\n                         INTO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO CONFIRML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n               END-EVALUATE\n\n               SET END-LOOP-NO TO TRUE\n\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 1000 OR\n                                      END-LOOP-YES  OR ERR-FLG-ON\n\n                   MOVE JOB-LINES(WS-IDX) TO JCL-RECORD\n                   IF JCL-RECORD = '/*EOF' OR\n                      JCL-RECORD = SPACES OR LOW-VALUES\n                       SET END-LOOP-YES TO TRUE\n                   END-IF\n\n                   PERFORM WIRTE-JOBSUB-TDQ\n               END-PERFORM\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      WIRTE-JOBSUB-TDQ\n      *----------------------------------------------------------------*\n       WIRTE-JOBSUB-TDQ.\n\n           EXEC CICS WRITEQ TD\n             QUEUE ('JOBS')\n             FROM (JCL-RECORD)\n             LENGTH (LENGTH OF JCL-RECORD)\n             RESP(WS-RESP-CD)\n             RESP2(WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Write TDQ (JOBS)...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNRPT-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNRPT-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF CORPT0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n           GO TO RETURN-TO-CICS.\n\n      *----------------------------------------------------------------*\n      *                         RETURN-TO-CICS\n      *----------------------------------------------------------------*\n       RETURN-TO-CICS.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNRPT-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNRPT-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('CORPT0A')\n                     MAPSET('CORPT00')\n                     INTO(CORPT0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF CORPT0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF CORPT0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF CORPT0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF CORPT0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CORPT0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CORPT0AO.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO MONTHLYL OF CORPT0AI\n           INITIALIZE              MONTHLYI OF CORPT0AI\n                                   YEARLYI  OF CORPT0AI\n                                   CUSTOMI  OF CORPT0AI\n                                   SDTMMI   OF CORPT0AI\n                                   SDTDDI   OF CORPT0AI\n                                   SDTYYYYI OF CORPT0AI\n                                   EDTMMI   OF CORPT0AI\n                                   EDTDDI   OF CORPT0AI\n                                   EDTYYYYI OF CORPT0AI\n                                   CONFIRMI OF CORPT0AI\n                                   WS-MESSAGE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "CORPT00",
        "COCOM01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVTRA05Y",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant CORPT00C as \"CORPT00C Program\"\n    participant CORPT0A as \"Report Screen\"\n    participant CSUTLDTC as \"Date Validation Utility\"\n    participant TDQ as \"JOBS TDQ\"\n    participant BatchJob as \"TRNRPT00 Batch Job\"\n    \n    User->>CORPT00C: Start Transaction\n    \n    CORPT00C->>CORPT00C: MAIN-PARA\n    \n    alt First Entry\n        CORPT00C->>CORPT0A: Display Initial Report Screen\n    else Re-entry\n        CORPT00C->>CORPT0A: RECEIVE-TRNRPT-SCREEN\n        CORPT0A-->>CORPT00C: User Input\n        \n        alt ENTER Key\n            CORPT00C->>CORPT00C: PROCESS-ENTER-KEY\n            \n            alt Monthly Report\n                CORPT00C->>CORPT00C: Calculate Current Month Date Range\n            else Yearly Report\n                CORPT00C->>CORPT00C: Calculate Current Year Date Range\n            else Custom Date Range\n                CORPT00C->>CORPT00C: Validate Input Fields\n                \n                alt Valid Input Fields\n                    CORPT00C->>CSUTLDTC: Validate Start Date\n                    CSUTLDTC-->>CORPT00C: Date Validation Result\n                    \n                    CORPT00C->>CSUTLDTC: Validate End Date\n                    CSUTLDTC-->>CORPT00C: Date Validation Result\n                else Invalid Input\n                    CORPT00C->>CORPT0A: Display Error Message\n                end\n            else No Report Type Selected\n                CORPT00C->>CORPT0A: Display Error Message\n            end\n            \n            alt No Errors & No Confirmation Yet\n                CORPT00C->>CORPT0A: Request Confirmation\n            else No Errors & Confirmed\n                CORPT00C->>CORPT00C: SUBMIT-JOB-TO-INTRDR\n                \n                loop For Each JCL Line\n                    CORPT00C->>CORPT00C: WIRTE-JOBSUB-TDQ\n                    CORPT00C->>TDQ: Write JCL Record\n                    TDQ-->>BatchJob: Submit Job\n                end\n                \n                CORPT00C->>CORPT0A: Display Submission Confirmation\n            end\n            \n        else PF3 Key\n            CORPT00C->>CORPT00C: RETURN-TO-PREV-SCREEN\n        else Other Key\n            CORPT00C->>CORPT0A: Display Invalid Key Message\n        end\n    end\n    \n    CORPT00C->>CORPT00C: RETURN-TO-CICS"
    },
    {
      "id": "COBIL00C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration details for the COBIL00C program, including file assignments, special names, and system dependencies. However, the provided snippet is empty, indicating that the CONFIGURATION SECTION in this program doesn't contain any explicit configuration entries. This suggests that the program likely relies on standard CICS environment settings and doesn't require special configuration parameters for its bill payment functionality."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COBIL00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CB00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE           PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ACCTDAT-FILE            PIC X(08) VALUE 'ACCTDAT '.\n         05 WS-CXACAIX-FILE            PIC X(08) VALUE 'CXACAIX '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n         05 WS-CONF-PAY-FLG            PIC X(01) VALUE 'N'.\n           88 CONF-PAY-YES                       VALUE 'Y'.\n           88 CONF-PAY-NO                        VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-CURR-BAL                PIC +9999999999.99.\n         05 WS-TRAN-ID-NUM             PIC 9(16) VALUE ZEROS.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 WS-ABS-TIME                PIC S9(15) COMP-3 VALUE 0.\n         05 WS-CUR-DATE-X10            PIC X(10) VALUE SPACES.\n         05 WS-CUR-TIME-X08            PIC X(08) VALUE SPACES.\n\n       COPY COCOM01Y.\n          05 CDEMO-CB00-INFO.\n             10 CDEMO-CB00-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CB00-TRNID-LAST      PIC X(16).\n             10 CDEMO-CB00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CB00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CB00-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CB00-TRN-SELECTED    PIC X(16).\n\n       COPY COBIL00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVACT01Y.\n       COPY CVACT03Y.\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working-Storage section defines the key variables and data structures used in the COBIL00C bill payment program. It includes program identifiers, file names for transaction and account data, status flags for error handling and payment confirmation, and financial fields for tracking transaction amounts and account balances. The section contains several important control flags that manage the program flow, including error flags and user modification indicators. It also defines fields for transaction identification, date/time processing, and balance management. The section incorporates multiple copybooks that likely contain screen layouts, message definitions, account and transaction record structures, and CICS interface definitions. These variables collectively support the program's core functionality of validating accounts, processing bill payments, recording transactions, and updating account balances."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the DFHCOMMAREA in the Linkage Section, which is the standard CICS communication area used to pass data between program calls. It contains a single field, LK-COMMAREA, defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length passed to the program (EIBCALEN). This structure allows the bill payment program to receive and maintain state information across multiple interactions with the user interface."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COBIL00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CB00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE           PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ACCTDAT-FILE            PIC X(08) VALUE 'ACCTDAT '.\n         05 WS-CXACAIX-FILE            PIC X(08) VALUE 'CXACAIX '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n         05 WS-CONF-PAY-FLG            PIC X(01) VALUE 'N'.\n           88 CONF-PAY-YES                       VALUE 'Y'.\n           88 CONF-PAY-NO                        VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-CURR-BAL                PIC +9999999999.99.\n         05 WS-TRAN-ID-NUM             PIC 9(16) VALUE ZEROS.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 WS-ABS-TIME                PIC S9(15) COMP-3 VALUE 0.\n         05 WS-CUR-DATE-X10            PIC X(10) VALUE SPACES.\n         05 WS-CUR-TIME-X08            PIC X(08) VALUE SPACES.\n\n       COPY COCOM01Y.\n          05 CDEMO-CB00-INFO.\n             10 CDEMO-CB00-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CB00-TRNID-LAST      PIC X(16).\n             10 CDEMO-CB00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CB00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CB00-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CB00-TRN-SELECTED    PIC X(16).\n\n       COPY COBIL00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVACT01Y.\n       COPY CVACT03Y.\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COBIL0AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COBIL0AO\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   IF CDEMO-CB00-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CB00-TRN-SELECTED TO\n                            ACTIDINI OF COBIL0AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-BILLPAY-SCREEN\n               ELSE\n                   PERFORM RECEIVE-BILLPAY-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-BILLPAY-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the bill payment screen in the CardDemo application. It handles initial screen setup, user navigation, and input processing. The paragraph first initializes error flags and message fields, then checks if the program is being entered for the first time (EIBCALEN = 0) or returning from another screen. \n\nFor first-time entry, it redirects to the sign-on screen. For re-entry, it either initializes the bill payment screen with any pre-selected account information or processes user input based on the function key pressed. The paragraph handles several navigation options: ENTER to process payment information, PF3 to return to the previous screen, and PF4 to clear the current screen. Invalid key presses trigger an error message. After processing, it returns control to CICS with the transaction ID and updated communication area to maintain program state between interactions."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "SET CONF-PAY-NO TO TRUE\n\n           EVALUATE TRUE\n               WHEN ACTIDINI OF COBIL0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Acct ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE ACTIDINI  OF COBIL0AI TO ACCT-ID\n                                             XREF-ACCT-ID\n\n               EVALUATE CONFIRMI OF COBIL0AI\n                   WHEN 'Y'\n                   WHEN 'y'\n                       SET CONF-PAY-YES TO TRUE\n                       PERFORM READ-ACCTDAT-FILE\n                   WHEN 'N'\n                   WHEN 'n'\n                       PERFORM CLEAR-CURRENT-SCREEN\n                       MOVE 'Y'     TO WS-ERR-FLG\n                   WHEN SPACES\n                   WHEN LOW-VALUES\n                       PERFORM READ-ACCTDAT-FILE\n                   WHEN OTHER\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Invalid value. Valid values are (Y/N)...'\n                                    TO WS-MESSAGE\n                       MOVE -1      TO CONFIRML OF COBIL0AI\n                       PERFORM SEND-BILLPAY-SCREEN\n               END-EVALUATE\n\n               MOVE ACCT-CURR-BAL TO WS-CURR-BAL\n               MOVE WS-CURR-BAL   TO CURBALI    OF COBIL0AI\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               IF ACCT-CURR-BAL <= ZEROS AND\n                  ACTIDINI OF COBIL0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'You have nothing to pay...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               END-IF\n           END-IF\n\n           IF NOT ERR-FLG-ON\n\n               IF CONF-PAY-YES\n                   PERFORM READ-CXACAIX-FILE\n                   MOVE HIGH-VALUES TO TRAN-ID\n                   PERFORM STARTBR-TRANSACT-FILE\n                   PERFORM READPREV-TRANSACT-FILE\n                   PERFORM ENDBR-TRANSACT-FILE\n                   MOVE TRAN-ID     TO WS-TRAN-ID-NUM\n                   ADD 1 TO WS-TRAN-ID-NUM\n                   INITIALIZE TRAN-RECORD\n                   MOVE WS-TRAN-ID-NUM       TO TRAN-ID\n                   MOVE '02'                 TO TRAN-TYPE-CD\n                   MOVE 2                    TO TRAN-CAT-CD\n                   MOVE 'POS TERM'           TO TRAN-SOURCE\n                   MOVE 'BILL PAYMENT - ONLINE' TO TRAN-DESC\n                   MOVE ACCT-CURR-BAL        TO TRAN-AMT\n                   MOVE XREF-CARD-NUM        TO TRAN-CARD-NUM\n                   MOVE 999999999            TO TRAN-MERCHANT-ID\n                   MOVE 'BILL PAYMENT'       TO TRAN-MERCHANT-NAME\n                   MOVE 'N/A'                TO TRAN-MERCHANT-CITY\n                   MOVE 'N/A'                TO TRAN-MERCHANT-ZIP\n                   PERFORM GET-CURRENT-TIMESTAMP\n                   MOVE WS-TIMESTAMP         TO TRAN-ORIG-TS\n                                                TRAN-PROC-TS\n                   PERFORM WRITE-TRANSACT-FILE\n                   COMPUTE ACCT-CURR-BAL = ACCT-CURR-BAL - TRAN-AMT\n                   PERFORM UPDATE-ACCTDAT-FILE\n               ELSE\n                   MOVE 'Confirm to make a bill payment...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CONFIRML OF COBIL0AI\n               END-IF\n\n               PERFORM SEND-BILLPAY-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      GET-CURRENT-TIMESTAMP\n      *----------------------------------------------------------------*",
            "description": "This paragraph processes the user's input when the Enter key is pressed on the bill payment screen. It validates the account ID, checks the confirmation flag, and executes the payment transaction if confirmed. The logic includes:\n\n1. Initial validation to ensure the account ID is not empty\n2. Processing of the confirmation field (Y/N) to determine if payment should proceed\n3. Verification that the account has a positive balance to pay\n4. For confirmed payments:\n   - Retrieving the account cross-reference information\n   - Generating a unique transaction ID by reading the last transaction record\n   - Creating a new transaction record with payment details\n   - Updating the account balance by subtracting the payment amount\n   - Recording the transaction with timestamp information\n\nIf validation fails at any point, appropriate error messages are displayed to the user. The paragraph includes comprehensive error handling and maintains the screen cursor position for user convenience."
          },
          {
            "name": "GET-CURRENT-TIMESTAMP",
            "code": "EXEC CICS ASKTIME\n             ABSTIME(WS-ABS-TIME)\n           END-EXEC\n\n           EXEC CICS FORMATTIME\n             ABSTIME(WS-ABS-TIME)\n             YYYYMMDD(WS-CUR-DATE-X10)\n             DATESEP('-')\n             TIME(WS-CUR-TIME-X08)\n             TIMESEP(':')\n           END-EXEC\n\n           INITIALIZE WS-TIMESTAMP\n           MOVE WS-CUR-DATE-X10 TO WS-TIMESTAMP(01:10)\n           MOVE WS-CUR-TIME-X08 TO WS-TIMESTAMP(12:08)\n           MOVE ZEROS           TO WS-TIMESTAMP-TM-MS6\n           .\n\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph retrieves and formats the current system timestamp for use in transaction processing. It uses CICS ASKTIME to get the absolute time, then FORMATTIME to convert it into a readable date (YYYY-MM-DD) and time (HH:MM:SS) format with appropriate separators. The formatted date and time values are then combined into a single timestamp field (WS-TIMESTAMP), with the millisecond portion initialized to zeros. This timestamp is likely used for recording when bill payment transactions occur in the system."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-BILLPAY-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the navigation back to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, and if not, defaults to the sign-on program 'COSGN00C'. It then sets up the communication area with the current transaction ID and program name before transferring control to the target program using the CICS XCTL command. This functionality provides a consistent way to return to previous screens while maintaining context information between program calls."
          },
          {
            "name": "SEND-BILLPAY-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COBIL0AO\n\n           EXEC CICS SEND\n                     MAP('COBIL0A')\n                     MAPSET('COBIL00')\n                     FROM(COBIL0AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-BILLPAY-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph displays the bill payment screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up common header information, then moves any system message to the error message field on the screen. It then uses the CICS SEND command to display the COBIL0A map from the COBIL00 mapset, clearing the screen (ERASE) and positioning the cursor. This is a standard screen display routine that presents the bill payment interface to the user."
          },
          {
            "name": "RECEIVE-BILLPAY-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COBIL0A')\n                     MAPSET('COBIL00')\n                     INTO(COBIL0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the bill payment screen using the CICS RECEIVE command. It captures data entered by the user from the 'COBIL0A' map within the 'COBIL00' mapset and stores it in the COBIL0AI structure. The response codes are captured in WS-RESP-CD and WS-REAS-CD variables for subsequent error handling. This is the initial step in the bill payment process where the program obtains the user's payment information before processing."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COBIL0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COBIL0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COBIL0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COBIL0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COBIL0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COBIL0AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-ACCTDAT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the bill payment screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information along with program identification details on the screen. The paragraph sets the title fields from constant data, displays the transaction ID and program name, and formats the current date (MM/DD/YY) and time (HH:MM:SS) for display. This creates a consistent header that provides context to users about which program they're using and when the transaction is taking place."
          },
          {
            "name": "READ-ACCTDAT-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-ACCTDAT-FILE)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RIDFLD    (ACCT-ID)\n                KEYLENGTH (LENGTH OF ACCT-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Account...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-ACCTDAT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph reads an account record from the ACCTDAT file using the account ID as the key. It performs the read with UPDATE intent, allowing the record to be modified later. The paragraph handles three possible outcomes: if the read is successful, processing continues; if the account is not found, an error message is displayed to the user and the bill payment screen is redisplayed with the cursor positioned at the account ID field; for any other errors, diagnostic information is displayed, an error message is shown to the user, and the bill payment screen is redisplayed. This validation ensures that bill payments can only be processed for existing accounts."
          },
          {
            "name": "UPDATE-ACCTDAT-FILE",
            "code": "EXEC CICS REWRITE\n                DATASET   (WS-ACCTDAT-FILE)\n                FROM      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update Account...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READ-CXACAIX-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph updates the account record in the ACCTDAT file after a bill payment has been processed. It uses a CICS REWRITE command to replace the existing account record with the updated version that reflects the new balance. The paragraph includes error handling logic that checks the response code from the CICS operation and takes appropriate action: continuing if successful, displaying an error message if the account is not found, or showing a generic update error message for other failures. If an error occurs, the paragraph sets an error flag and positions the cursor at the account ID field before redisplaying the bill payment screen to the user."
          },
          {
            "name": "READ-CXACAIX-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-CXACAIX-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-ACCT-ID)\n                KEYLENGTH (LENGTH OF XREF-ACCT-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup XREF AIX file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a read operation on the CXACAIX cross-reference file to validate the account ID entered by the user. It attempts to retrieve the card cross-reference record using the account ID as the key. The paragraph handles three possible outcomes: successful retrieval (processing continues), account not found (displays an error message and returns to the bill payment screen with cursor positioned at the account ID field), or other errors (displays technical response codes, shows a generic error message, and returns to the bill payment screen). This validation step is critical to ensure the bill payment operation is only attempted for valid accounts in the system."
          },
          {
            "name": "STARTBR-TRANSACT-FILE",
            "code": "EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph initiates a browse operation on the TRANSACT file to locate a specific transaction record using the transaction ID as the key. It evaluates the response code from the CICS STARTBR command and handles three possible outcomes: 1) if the operation is successful, processing continues normally; 2) if the transaction ID is not found, it sets an error flag, displays a \"Transaction ID NOT found\" message, and returns to the bill payment screen; 3) for any other response code, it displays the specific response and reason codes, sets an error flag, shows a generic error message, and returns to the bill payment screen. This paragraph is part of the transaction validation process in the bill payment workflow."
          },
          {
            "name": "READPREV-TRANSACT-FILE",
            "code": "EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   MOVE ZEROS TO TRAN-ID\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a \"read previous\" operation on the transaction file to retrieve the previous transaction record based on the current transaction ID. It reads the record into the TRAN-RECORD structure and handles three possible response scenarios: 1) successful read (continues processing), 2) end-of-file condition (sets the transaction ID to zeros), or 3) any other response (displays error information, sets an error flag, prepares an error message, positions the cursor at the account ID field, and displays the bill payment screen). This functionality is likely used to find the most recent transaction or to navigate backward through transaction history when processing bill payments."
          },
          {
            "name": "ENDBR-TRANSACT-FILE",
            "code": "EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      WRITE-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph terminates a browse operation on the TRANSACT file (referenced by the working storage variable WS-TRANSACT-FILE) using the CICS ENDBR command. It's executed after the program has finished browsing through transaction records, properly releasing the resources associated with the browse operation."
          },
          {
            "name": "WRITE-TRANSACT-FILE",
            "code": "EXEC CICS WRITE\n                DATASET   (WS-TRANSACT-FILE)\n                FROM      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COBIL0AO\n                   STRING 'Payment successful. '     DELIMITED BY SIZE\n                     ' Your Transaction ID is ' DELIMITED BY SIZE\n                          TRAN-ID  DELIMITED BY SPACE\n                          '.' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add Bill pay Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the writing of a transaction record to the TRANSACT file and processes the response. After attempting to write the transaction record, it evaluates the CICS response code and takes appropriate action. For successful transactions, it initializes fields, constructs a confirmation message including the transaction ID, and displays the bill payment screen with a green success message. If a duplicate key or record is detected, it sets an error flag and displays an appropriate error message. For any other response codes, it logs the response and reason codes, sets an error flag, and displays a generic error message. In all cases, the paragraph concludes by redisplaying the bill payment screen with the appropriate feedback to the user."
          },
          {
            "name": "CLEAR-CURRENT-SCREEN",
            "code": "PERFORM INITIALIZE-ALL-FIELDS\n           PERFORM SEND-BILLPAY-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the current bill payment screen by first initializing all fields to their default values and then redisplaying the bill payment screen to the user. It provides a way to reset the interface when needed, such as after an error or when starting a new payment process."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO ACTIDINL OF COBIL0AI\n           MOVE SPACES          TO ACTIDINI OF COBIL0AI\n                                   CURBALI  OF COBIL0AI\n                                   CONFIRMI OF COBIL0AI",
            "description": "This paragraph initializes the input fields on the bill payment screen. It sets the cursor position to the account ID field by setting its length to -1, and clears the account ID input field, current balance field, and confirmation field by filling them with spaces. This is typically executed when the screen is first displayed or needs to be reset."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *",
            "description": "This paragraph contains version control information for the COBIL00C program, indicating it is part of the CardDemo application version 1.0-15-g27d6c6f-68, with a timestamp of July 19, 2022, at 23:12:32 CDT. This helps track which version of the code is deployed and when it was last updated."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COBIL0AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COBIL0AO\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   IF CDEMO-CB00-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CB00-TRN-SELECTED TO\n                            ACTIDINI OF COBIL0AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-BILLPAY-SCREEN\n               ELSE\n                   PERFORM RECEIVE-BILLPAY-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-BILLPAY-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           SET CONF-PAY-NO TO TRUE\n\n           EVALUATE TRUE\n               WHEN ACTIDINI OF COBIL0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Acct ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE ACTIDINI  OF COBIL0AI TO ACCT-ID\n                                             XREF-ACCT-ID\n\n               EVALUATE CONFIRMI OF COBIL0AI\n                   WHEN 'Y'\n                   WHEN 'y'\n                       SET CONF-PAY-YES TO TRUE\n                       PERFORM READ-ACCTDAT-FILE\n                   WHEN 'N'\n                   WHEN 'n'\n                       PERFORM CLEAR-CURRENT-SCREEN\n                       MOVE 'Y'     TO WS-ERR-FLG\n                   WHEN SPACES\n                   WHEN LOW-VALUES\n                       PERFORM READ-ACCTDAT-FILE\n                   WHEN OTHER\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Invalid value. Valid values are (Y/N)...'\n                                    TO WS-MESSAGE\n                       MOVE -1      TO CONFIRML OF COBIL0AI\n                       PERFORM SEND-BILLPAY-SCREEN\n               END-EVALUATE\n\n               MOVE ACCT-CURR-BAL TO WS-CURR-BAL\n               MOVE WS-CURR-BAL   TO CURBALI    OF COBIL0AI\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               IF ACCT-CURR-BAL <= ZEROS AND\n                  ACTIDINI OF COBIL0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'You have nothing to pay...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               END-IF\n           END-IF\n\n           IF NOT ERR-FLG-ON\n\n               IF CONF-PAY-YES\n                   PERFORM READ-CXACAIX-FILE\n                   MOVE HIGH-VALUES TO TRAN-ID\n                   PERFORM STARTBR-TRANSACT-FILE\n                   PERFORM READPREV-TRANSACT-FILE\n                   PERFORM ENDBR-TRANSACT-FILE\n                   MOVE TRAN-ID     TO WS-TRAN-ID-NUM\n                   ADD 1 TO WS-TRAN-ID-NUM\n                   INITIALIZE TRAN-RECORD\n                   MOVE WS-TRAN-ID-NUM       TO TRAN-ID\n                   MOVE '02'                 TO TRAN-TYPE-CD\n                   MOVE 2                    TO TRAN-CAT-CD\n                   MOVE 'POS TERM'           TO TRAN-SOURCE\n                   MOVE 'BILL PAYMENT - ONLINE' TO TRAN-DESC\n                   MOVE ACCT-CURR-BAL        TO TRAN-AMT\n                   MOVE XREF-CARD-NUM        TO TRAN-CARD-NUM\n                   MOVE 999999999            TO TRAN-MERCHANT-ID\n                   MOVE 'BILL PAYMENT'       TO TRAN-MERCHANT-NAME\n                   MOVE 'N/A'                TO TRAN-MERCHANT-CITY\n                   MOVE 'N/A'                TO TRAN-MERCHANT-ZIP\n                   PERFORM GET-CURRENT-TIMESTAMP\n                   MOVE WS-TIMESTAMP         TO TRAN-ORIG-TS\n                                                TRAN-PROC-TS\n                   PERFORM WRITE-TRANSACT-FILE\n                   COMPUTE ACCT-CURR-BAL = ACCT-CURR-BAL - TRAN-AMT\n                   PERFORM UPDATE-ACCTDAT-FILE\n               ELSE\n                   MOVE 'Confirm to make a bill payment...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CONFIRML OF COBIL0AI\n               END-IF\n\n               PERFORM SEND-BILLPAY-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      GET-CURRENT-TIMESTAMP\n      *----------------------------------------------------------------*\n       GET-CURRENT-TIMESTAMP.\n\n           EXEC CICS ASKTIME\n             ABSTIME(WS-ABS-TIME)\n           END-EXEC\n\n           EXEC CICS FORMATTIME\n             ABSTIME(WS-ABS-TIME)\n             YYYYMMDD(WS-CUR-DATE-X10)\n             DATESEP('-')\n             TIME(WS-CUR-TIME-X08)\n             TIMESEP(':')\n           END-EXEC\n\n           INITIALIZE WS-TIMESTAMP\n           MOVE WS-CUR-DATE-X10 TO WS-TIMESTAMP(01:10)\n           MOVE WS-CUR-TIME-X08 TO WS-TIMESTAMP(12:08)\n           MOVE ZEROS           TO WS-TIMESTAMP-TM-MS6\n           .\n\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-BILLPAY-SCREEN\n      *----------------------------------------------------------------*\n       SEND-BILLPAY-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COBIL0AO\n\n           EXEC CICS SEND\n                     MAP('COBIL0A')\n                     MAPSET('COBIL00')\n                     FROM(COBIL0AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-BILLPAY-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-BILLPAY-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COBIL0A')\n                     MAPSET('COBIL00')\n                     INTO(COBIL0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COBIL0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COBIL0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COBIL0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COBIL0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COBIL0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COBIL0AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-ACCTDAT-FILE\n      *----------------------------------------------------------------*\n       READ-ACCTDAT-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-ACCTDAT-FILE)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RIDFLD    (ACCT-ID)\n                KEYLENGTH (LENGTH OF ACCT-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Account...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-ACCTDAT-FILE\n      *----------------------------------------------------------------*\n       UPDATE-ACCTDAT-FILE.\n\n           EXEC CICS REWRITE\n                DATASET   (WS-ACCTDAT-FILE)\n                FROM      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update Account...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READ-CXACAIX-FILE\n      *----------------------------------------------------------------*\n       READ-CXACAIX-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-CXACAIX-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-ACCT-ID)\n                KEYLENGTH (LENGTH OF XREF-ACCT-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup XREF AIX file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       STARTBR-TRANSACT-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READPREV-TRANSACT-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   MOVE ZEROS TO TRAN-ID\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       ENDBR-TRANSACT-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      WRITE-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       WRITE-TRANSACT-FILE.\n\n           EXEC CICS WRITE\n                DATASET   (WS-TRANSACT-FILE)\n                FROM      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COBIL0AO\n                   STRING 'Payment successful. '     DELIMITED BY SIZE\n                     ' Your Transaction ID is ' DELIMITED BY SIZE\n                          TRAN-ID  DELIMITED BY SPACE\n                          '.' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add Bill pay Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS\n           PERFORM SEND-BILLPAY-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO ACTIDINL OF COBIL0AI\n           MOVE SPACES          TO ACTIDINI OF COBIL0AI\n                                   CURBALI  OF COBIL0AI\n                                   CONFIRMI OF COBIL0AI\n                                   WS-MESSAGE.\n\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *"
      },
      "description": "This CICS COBOL program (COBIL00C) handles online bill payment functionality for the CardDemo application. It allows users to pay their credit card account balance in full and records the transaction. The program reads the account information, verifies the current balance, and if confirmed by the user, creates a payment transaction record and updates the account balance. Key features include:\n\n1. Account validation to ensure the account exists and has a balance to pay\n2. Confirmation process requiring user approval before processing payment\n3. Transaction recording with unique transaction ID generation\n4. Account balance update after successful payment\n5. Integration with multiple files: TRANSACT (transaction records), ACCTDAT (account data), and CXACAIX (account cross-reference)\n\nThe program includes comprehensive error handling for various scenarios such as account not found, invalid input values, and transaction processing failures. It also provides clear feedback messages to the user about the payment status, including the transaction ID upon successful completion.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COBIL00C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Bill Payment - Pay account balance in full and a\n      *               tractionsaction for the online bill payment.\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COBIL00C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COBIL00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CB00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE           PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ACCTDAT-FILE            PIC X(08) VALUE 'ACCTDAT '.\n         05 WS-CXACAIX-FILE            PIC X(08) VALUE 'CXACAIX '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n         05 WS-CONF-PAY-FLG            PIC X(01) VALUE 'N'.\n           88 CONF-PAY-YES                       VALUE 'Y'.\n           88 CONF-PAY-NO                        VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-CURR-BAL                PIC +9999999999.99.\n         05 WS-TRAN-ID-NUM             PIC 9(16) VALUE ZEROS.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 WS-ABS-TIME                PIC S9(15) COMP-3 VALUE 0.\n         05 WS-CUR-DATE-X10            PIC X(10) VALUE SPACES.\n         05 WS-CUR-TIME-X08            PIC X(08) VALUE SPACES.\n\n       COPY COCOM01Y.\n          05 CDEMO-CB00-INFO.\n             10 CDEMO-CB00-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CB00-TRNID-LAST      PIC X(16).\n             10 CDEMO-CB00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CB00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CB00-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CB00-TRN-SELECTED    PIC X(16).\n\n       COPY COBIL00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVACT01Y.\n       COPY CVACT03Y.\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COBIL0AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COBIL0AO\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   IF CDEMO-CB00-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CB00-TRN-SELECTED TO\n                            ACTIDINI OF COBIL0AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-BILLPAY-SCREEN\n               ELSE\n                   PERFORM RECEIVE-BILLPAY-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-BILLPAY-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           SET CONF-PAY-NO TO TRUE\n\n           EVALUATE TRUE\n               WHEN ACTIDINI OF COBIL0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Acct ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE ACTIDINI  OF COBIL0AI TO ACCT-ID\n                                             XREF-ACCT-ID\n\n               EVALUATE CONFIRMI OF COBIL0AI\n                   WHEN 'Y'\n                   WHEN 'y'\n                       SET CONF-PAY-YES TO TRUE\n                       PERFORM READ-ACCTDAT-FILE\n                   WHEN 'N'\n                   WHEN 'n'\n                       PERFORM CLEAR-CURRENT-SCREEN\n                       MOVE 'Y'     TO WS-ERR-FLG\n                   WHEN SPACES\n                   WHEN LOW-VALUES\n                       PERFORM READ-ACCTDAT-FILE\n                   WHEN OTHER\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Invalid value. Valid values are (Y/N)...'\n                                    TO WS-MESSAGE\n                       MOVE -1      TO CONFIRML OF COBIL0AI\n                       PERFORM SEND-BILLPAY-SCREEN\n               END-EVALUATE\n\n               MOVE ACCT-CURR-BAL TO WS-CURR-BAL\n               MOVE WS-CURR-BAL   TO CURBALI    OF COBIL0AI\n           END-IF\n\n           IF NOT ERR-FLG-ON\n               IF ACCT-CURR-BAL <= ZEROS AND\n                  ACTIDINI OF COBIL0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'You have nothing to pay...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               END-IF\n           END-IF\n\n           IF NOT ERR-FLG-ON\n\n               IF CONF-PAY-YES\n                   PERFORM READ-CXACAIX-FILE\n                   MOVE HIGH-VALUES TO TRAN-ID\n                   PERFORM STARTBR-TRANSACT-FILE\n                   PERFORM READPREV-TRANSACT-FILE\n                   PERFORM ENDBR-TRANSACT-FILE\n                   MOVE TRAN-ID     TO WS-TRAN-ID-NUM\n                   ADD 1 TO WS-TRAN-ID-NUM\n                   INITIALIZE TRAN-RECORD\n                   MOVE WS-TRAN-ID-NUM       TO TRAN-ID\n                   MOVE '02'                 TO TRAN-TYPE-CD\n                   MOVE 2                    TO TRAN-CAT-CD\n                   MOVE 'POS TERM'           TO TRAN-SOURCE\n                   MOVE 'BILL PAYMENT - ONLINE' TO TRAN-DESC\n                   MOVE ACCT-CURR-BAL        TO TRAN-AMT\n                   MOVE XREF-CARD-NUM        TO TRAN-CARD-NUM\n                   MOVE 999999999            TO TRAN-MERCHANT-ID\n                   MOVE 'BILL PAYMENT'       TO TRAN-MERCHANT-NAME\n                   MOVE 'N/A'                TO TRAN-MERCHANT-CITY\n                   MOVE 'N/A'                TO TRAN-MERCHANT-ZIP\n                   PERFORM GET-CURRENT-TIMESTAMP\n                   MOVE WS-TIMESTAMP         TO TRAN-ORIG-TS\n                                                TRAN-PROC-TS\n                   PERFORM WRITE-TRANSACT-FILE\n                   COMPUTE ACCT-CURR-BAL = ACCT-CURR-BAL - TRAN-AMT\n                   PERFORM UPDATE-ACCTDAT-FILE\n               ELSE\n                   MOVE 'Confirm to make a bill payment...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CONFIRML OF COBIL0AI\n               END-IF\n\n               PERFORM SEND-BILLPAY-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      GET-CURRENT-TIMESTAMP\n      *----------------------------------------------------------------*\n       GET-CURRENT-TIMESTAMP.\n\n           EXEC CICS ASKTIME\n             ABSTIME(WS-ABS-TIME)\n           END-EXEC\n\n           EXEC CICS FORMATTIME\n             ABSTIME(WS-ABS-TIME)\n             YYYYMMDD(WS-CUR-DATE-X10)\n             DATESEP('-')\n             TIME(WS-CUR-TIME-X08)\n             TIMESEP(':')\n           END-EXEC\n\n           INITIALIZE WS-TIMESTAMP\n           MOVE WS-CUR-DATE-X10 TO WS-TIMESTAMP(01:10)\n           MOVE WS-CUR-TIME-X08 TO WS-TIMESTAMP(12:08)\n           MOVE ZEROS           TO WS-TIMESTAMP-TM-MS6\n           .\n\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-BILLPAY-SCREEN\n      *----------------------------------------------------------------*\n       SEND-BILLPAY-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COBIL0AO\n\n           EXEC CICS SEND\n                     MAP('COBIL0A')\n                     MAPSET('COBIL00')\n                     FROM(COBIL0AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-BILLPAY-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-BILLPAY-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COBIL0A')\n                     MAPSET('COBIL00')\n                     INTO(COBIL0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COBIL0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COBIL0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COBIL0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COBIL0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COBIL0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COBIL0AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-ACCTDAT-FILE\n      *----------------------------------------------------------------*\n       READ-ACCTDAT-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-ACCTDAT-FILE)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RIDFLD    (ACCT-ID)\n                KEYLENGTH (LENGTH OF ACCT-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Account...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-ACCTDAT-FILE\n      *----------------------------------------------------------------*\n       UPDATE-ACCTDAT-FILE.\n\n           EXEC CICS REWRITE\n                DATASET   (WS-ACCTDAT-FILE)\n                FROM      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update Account...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READ-CXACAIX-FILE\n      *----------------------------------------------------------------*\n       READ-CXACAIX-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-CXACAIX-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-ACCT-ID)\n                KEYLENGTH (LENGTH OF XREF-ACCT-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup XREF AIX file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       STARTBR-TRANSACT-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READPREV-TRANSACT-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   MOVE ZEROS TO TRAN-ID\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       ENDBR-TRANSACT-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      WRITE-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       WRITE-TRANSACT-FILE.\n\n           EXEC CICS WRITE\n                DATASET   (WS-TRANSACT-FILE)\n                FROM      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COBIL0AO\n                   STRING 'Payment successful. '     DELIMITED BY SIZE\n                     ' Your Transaction ID is ' DELIMITED BY SIZE\n                          TRAN-ID  DELIMITED BY SPACE\n                          '.' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add Bill pay Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COBIL0AI\n                   PERFORM SEND-BILLPAY-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS\n           PERFORM SEND-BILLPAY-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO ACTIDINL OF COBIL0AI\n           MOVE SPACES          TO ACTIDINI OF COBIL0AI\n                                   CURBALI  OF COBIL0AI\n                                   CONFIRMI OF COBIL0AI\n                                   WS-MESSAGE.\n\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "COBIL00",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVTRA05Y",
        "COTTL01Y",
        "DFHAID",
        "CVACT03Y",
        "CVACT01Y"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant Screen as Bill Payment Screen\n    participant MAIN as MAIN-PARA\n    participant PROCESS as PROCESS-ENTER-KEY\n    participant ACCTDAT as ACCTDAT File\n    participant CXACAIX as CXACAIX File\n    participant TRANSACT as TRANSACT File\n    \n    User->>Screen: Access bill payment function\n    Screen->>MAIN: Initialize program\n    \n    alt First time entry\n        MAIN->>Screen: Redirect to sign-on screen\n    else Re-entry\n        MAIN->>Screen: Receive user input\n        \n        alt ENTER key pressed\n            Screen->>PROCESS: Process payment request\n            \n            PROCESS->>PROCESS: Validate account ID\n            \n            alt Account ID valid\n                PROCESS->>ACCTDAT: READ-ACCTDAT-FILE\n                ACCTDAT-->>PROCESS: Return account data\n                \n                alt Confirmation = 'Y'\n                    PROCESS->>CXACAIX: READ-CXACAIX-FILE\n                    CXACAIX-->>PROCESS: Return card cross-reference\n                    \n                    PROCESS->>TRANSACT: STARTBR-TRANSACT-FILE\n                    PROCESS->>TRANSACT: READPREV-TRANSACT-FILE\n                    TRANSACT-->>PROCESS: Return last transaction\n                    PROCESS->>TRANSACT: ENDBR-TRANSACT-FILE\n                    \n                    PROCESS->>PROCESS: GET-CURRENT-TIMESTAMP\n                    PROCESS->>PROCESS: Generate new transaction ID\n                    \n                    PROCESS->>TRANSACT: WRITE-TRANSACT-FILE\n                    TRANSACT-->>PROCESS: Confirm transaction written\n                    \n                    PROCESS->>ACCTDAT: UPDATE-ACCTDAT-FILE\n                    ACCTDAT-->>PROCESS: Confirm balance updated\n                    \n                    PROCESS->>Screen: Display success message\n                else Confirmation not 'Y'\n                    PROCESS->>Screen: Request confirmation\n                end\n            else Account ID invalid\n                PROCESS->>Screen: Display error message\n            end\n            \n        else PF3 key pressed\n            MAIN->>Screen: RETURN-TO-PREV-SCREEN\n        else PF4 key pressed\n            MAIN->>Screen: CLEAR-CURRENT-SCREEN\n        else Other key pressed\n            MAIN->>Screen: Display invalid key message\n        end\n    end\n    \n    Screen->>User: Display updated information"
    },
    {
      "id": "COTRN02C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration settings for the COTRN02C program, including file assignments, special names, and system dependencies. However, the provided snippet is empty, indicating that the Configuration Section in this program doesn't contain any explicit configuration settings. This suggests that the program likely relies on standard CICS environment configurations or that the configuration details are defined elsewhere in the system, possibly in the CICS Resource Definition Online (RDO) or in JCL that executes this program."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN02C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT02'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE           PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ACCTDAT-FILE            PIC X(08) VALUE 'ACCTDAT '.\n         05 WS-CCXREF-FILE             PIC X(08) VALUE 'CCXREF  '.\n         05 WS-CXACAIX-FILE            PIC X(08) VALUE 'CXACAIX '.\n\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 WS-ACCT-ID-N               PIC 9(11) VALUE 0.\n         05 WS-CARD-NUM-N              PIC 9(16) VALUE 0.\n         05 WS-TRAN-ID-N               PIC 9(16) VALUE ZEROS.\n         05 WS-TRAN-AMT-N              PIC S9(9)V99 VALUE ZERO.\n         05 WS-TRAN-AMT-E              PIC +99999999.99 VALUE ZEROS.\n         05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.\n\n       01 CSUTLDTC-PARM.\n          05 CSUTLDTC-DATE                   PIC X(10).\n          05 CSUTLDTC-DATE-FORMAT            PIC X(10).\n          05 CSUTLDTC-RESULT.\n             10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).\n             10 FILLER                       PIC X(11).\n             10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).\n             10 CSUTLDTC-RESULT-MSG          PIC X(61).\n\n       COPY COCOM01Y.\n          05 CDEMO-CT02-INFO.\n             10 CDEMO-CT02-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT02-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT02-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT02-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT02-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT02-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN02.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n       COPY CVACT01Y.\n       COPY CVACT03Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working Storage section defines the key variables and data structures used in the COTRN02C transaction processing program. It contains program identifiers, file names for transaction and account data, status flags for error handling and user modifications, and various numeric fields for processing transaction amounts and IDs. The section includes specialized fields for data conversion and validation, particularly for handling transaction amounts and dates. It incorporates several copybooks that likely contain screen layouts, common data structures, and message definitions needed for the transaction entry interface. The CSUTLDTC-PARM structure suggests integration with a date validation utility. The section also defines program control variables to track transaction navigation and selection, supporting the program's ability to manage transaction entry across multiple screens."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the linkage area used for communication between programs in the CICS environment. It contains a single field, LK-COMMAREA, which is defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive and process communication data of varying sizes from other programs in the CardDemo transaction processing system."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN02C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT02'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE           PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ACCTDAT-FILE            PIC X(08) VALUE 'ACCTDAT '.\n         05 WS-CCXREF-FILE             PIC X(08) VALUE 'CCXREF  '.\n         05 WS-CXACAIX-FILE            PIC X(08) VALUE 'CXACAIX '.\n\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 WS-ACCT-ID-N               PIC 9(11) VALUE 0.\n         05 WS-CARD-NUM-N              PIC 9(16) VALUE 0.\n         05 WS-TRAN-ID-N               PIC 9(16) VALUE ZEROS.\n         05 WS-TRAN-AMT-N              PIC S9(9)V99 VALUE ZERO.\n         05 WS-TRAN-AMT-E              PIC +99999999.99 VALUE ZEROS.\n         05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.\n\n       01 CSUTLDTC-PARM.\n          05 CSUTLDTC-DATE                   PIC X(10).\n          05 CSUTLDTC-DATE-FORMAT            PIC X(10).\n          05 CSUTLDTC-RESULT.\n             10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).\n             10 FILLER                       PIC X(11).\n             10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).\n             10 CSUTLDTC-RESULT-MSG          PIC X(61).\n\n       COPY COCOM01Y.\n          05 CDEMO-CT02-INFO.\n             10 CDEMO-CT02-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT02-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT02-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT02-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT02-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT02-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN02.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n       COPY CVACT01Y.\n       COPY CVACT03Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN2AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN2AO\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   IF CDEMO-CT02-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CT02-TRN-SELECTED TO\n                            CARDNINI OF COTRN2AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-TRNADD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNADD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM COPY-LAST-TRAN-DATA\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNADD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the transaction addition screen. It initializes error flags, handles first-time entry versus re-entry to the program, and processes user input based on function keys. When first entered, it sets up the screen and positions the cursor at the account ID field. On re-entry, it evaluates the user's action based on the function key pressed: ENTER processes the transaction data, PF3 returns to the previous screen, PF4 clears the current screen, and PF5 copies data from the last transaction. The paragraph includes special handling for when a transaction is pre-selected from another screen. It concludes by returning control to CICS with the transaction ID and communication area preserved for the next interaction."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "PERFORM VALIDATE-INPUT-KEY-FIELDS\n           PERFORM VALIDATE-INPUT-DATA-FIELDS.\n\n           EVALUATE CONFIRMI OF COTRN2AI\n               WHEN 'Y'\n               WHEN 'y'\n                   PERFORM ADD-TRANSACTION\n               WHEN 'N'\n               WHEN 'n'\n               WHEN SPACES\n               WHEN LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Confirm to add this transaction...'\n                                TO WS-MESSAGE\n                   MOVE -1      TO CONFIRML OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Invalid value. Valid values are (Y/N)...'\n                                TO WS-MESSAGE\n                   MOVE -1      TO CONFIRML OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      VALIDATE-INPUT-KEY-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph processes the user's action when the Enter key is pressed during transaction entry. It first validates both key fields and data fields by calling their respective validation routines. Then it evaluates the confirmation input field ('CONFIRMI') to determine the next action. If the user confirms with 'Y' or 'y', it proceeds to add the transaction to the database. If the confirmation field is blank, contains 'N', 'n', or low-values, it prompts the user to confirm the transaction by setting an error flag and displaying a message. For any other input value, it displays an error message indicating that only 'Y' or 'N' are valid responses. In both error cases, it positions the cursor at the confirmation field and redisplays the transaction entry screen."
          },
          {
            "name": "VALIDATE-INPUT-KEY-FIELDS",
            "code": "EVALUATE TRUE\n               WHEN ACTIDINI OF COTRN2AI NOT = SPACES AND LOW-VALUES\n                   IF ACTIDINI OF COTRN2AI IS NOT NUMERIC\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Account ID must be Numeric...' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO ACTIDINL OF COTRN2AI\n                       PERFORM SEND-TRNADD-SCREEN\n                   END-IF\n                   COMPUTE WS-ACCT-ID-N = FUNCTION NUMVAL(ACTIDINI OF\n                   COTRN2AI)\n                   MOVE WS-ACCT-ID-N            TO XREF-ACCT-ID\n                                                ACTIDINI OF COTRN2AI\n                   PERFORM READ-CXACAIX-FILE\n                   MOVE XREF-CARD-NUM         TO CARDNINI OF COTRN2AI\n               WHEN CARDNINI OF COTRN2AI NOT = SPACES AND LOW-VALUES\n                   IF CARDNINI OF COTRN2AI IS NOT NUMERIC\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Card Number must be Numeric...' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO CARDNINL OF COTRN2AI\n                       PERFORM SEND-TRNADD-SCREEN\n                   END-IF\n                   COMPUTE WS-CARD-NUM-N = FUNCTION NUMVAL(CARDNINI OF\n                   COTRN2AI)\n                   MOVE WS-CARD-NUM-N        TO XREF-CARD-NUM\n                                                CARDNINI OF COTRN2AI\n                   PERFORM READ-CCXREF-FILE\n                   MOVE XREF-ACCT-ID         TO ACTIDINI OF COTRN2AI\n               WHEN OTHER\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account or Card Number must be entered...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                 VALIDATE-INPUT-DATA-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph validates the key input fields (Account ID or Card Number) required for transaction creation. It uses an EVALUATE statement to handle three scenarios: when an Account ID is provided, when a Card Number is provided, or when neither is provided. For Account ID validation, it checks that the value is numeric, converts it to a numeric format, and then retrieves the corresponding Card Number by reading the CXACAIX cross-reference file. Similarly, for Card Number validation, it verifies the numeric format, converts it to a numeric value, and retrieves the associated Account ID from the CCXREF file. If neither field is provided, it displays an error message requiring one of these fields to be entered. The paragraph ensures data integrity by validating input format and establishing the relationship between account IDs and card numbers before proceeding with transaction creation."
          },
          {
            "name": "VALIDATE-INPUT-DATA-FIELDS",
            "code": "IF ERR-FLG-ON\n               MOVE SPACES      TO TTYPCDI  OF COTRN2AI\n                                   TCATCDI  OF COTRN2AI\n                                   TRNSRCI  OF COTRN2AI\n                                   TRNAMTI  OF COTRN2AI\n                                   TDESCI   OF COTRN2AI\n                                   TORIGDTI OF COTRN2AI\n                                   TPROCDTI OF COTRN2AI\n                                   MIDI     OF COTRN2AI\n                                   MNAMEI   OF COTRN2AI\n                                   MCITYI   OF COTRN2AI\n                                   MZIPI    OF COTRN2AI\n           END-IF.\n\n           EVALUATE TRUE\n               WHEN TTYPCDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Type CD can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TTYPCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TCATCDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Category CD can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TCATCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TRNSRCI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Source can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNSRCL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TDESCI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Description can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TDESCL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TRNAMTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Amount can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNAMTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TORIGDTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Orig Date can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TPROCDTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Proc Date can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MIDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MIDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MNAMEI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MNAMEL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MCITYI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant City can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MCITYL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MZIPI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant Zip can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MZIPL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n           EVALUATE TRUE\n               WHEN TTYPCDI OF COTRN2AI NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Type CD must be Numeric...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TTYPCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TCATCDI OF COTRN2AI NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Category CD must be Numeric...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TCATCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TRNAMTI OF COTRN2AI(1:1) NOT EQUAL '-' AND '+'\n               WHEN TRNAMTI OF COTRN2AI(2:8) NOT NUMERIC\n               WHEN TRNAMTI OF COTRN2AI(10:1) NOT = '.'\n               WHEN TRNAMTI OF COTRN2AI(11:2) IS NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Amount should be in format -99999999.99' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNAMTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TORIGDTI OF COTRN2AI(1:4) IS NOT NUMERIC\n               WHEN TORIGDTI OF COTRN2AI(5:1) NOT EQUAL '-'\n               WHEN TORIGDTI OF COTRN2AI(6:2) NOT NUMERIC\n               WHEN TORIGDTI OF COTRN2AI(8:1) NOT EQUAL '-'\n               WHEN TORIGDTI OF COTRN2AI(9:2) NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Orig Date should be in format YYYY-MM-DD' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TPROCDTI OF COTRN2AI(1:4) IS NOT NUMERIC\n               WHEN TPROCDTI OF COTRN2AI(5:1) NOT EQUAL '-'\n               WHEN TPROCDTI OF COTRN2AI(6:2) NOT NUMERIC\n               WHEN TPROCDTI OF COTRN2AI(8:1) NOT EQUAL '-'\n               WHEN TPROCDTI OF COTRN2AI(9:2) NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Proc Date should be in format YYYY-MM-DD' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           COMPUTE WS-TRAN-AMT-N = FUNCTION NUMVAL-C(TRNAMTI OF\n           COTRN2AI)\n           MOVE WS-TRAN-AMT-N TO WS-TRAN-AMT-E\n           MOVE WS-TRAN-AMT-E TO TRNAMTI OF COTRN2AI\n\n\n           MOVE TORIGDTI OF COTRN2AI TO CSUTLDTC-DATE\n           MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n           MOVE SPACES               TO CSUTLDTC-RESULT\n\n           CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                   CSUTLDTC-DATE-FORMAT\n                                   CSUTLDTC-RESULT\n\n           IF CSUTLDTC-RESULT-SEV-CD = '0000'\n               CONTINUE\n           ELSE\n               IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                   MOVE 'Orig Date - Not a valid date...'\n                     TO WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               END-IF\n           END-IF\n\n           MOVE TPROCDTI OF COTRN2AI TO CSUTLDTC-DATE\n           MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n           MOVE SPACES               TO CSUTLDTC-RESULT\n\n           CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                   CSUTLDTC-DATE-FORMAT\n                                   CSUTLDTC-RESULT\n\n           IF CSUTLDTC-RESULT-SEV-CD = '0000'\n               CONTINUE\n           ELSE\n               IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                   MOVE 'Proc Date - Not a valid date...'\n                     TO WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               END-IF\n           END-IF\n\n\n           IF MIDI OF COTRN2AI IS NOT NUMERIC\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Merchant ID must be Numeric...' TO\n                               WS-MESSAGE\n               MOVE -1       TO MIDL OF COTRN2AI\n               PERFORM SEND-TRNADD-SCREEN\n           END-IF\n           .\n\n      *----------------------------------------------------------------*\n      *                        ADD-TRANSACTION\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs comprehensive validation of transaction input data fields before allowing a new transaction to be added. It first checks if an error flag is set, in which case it clears all input fields. Then it systematically validates each required field, ensuring none are empty or contain invalid values. The validation includes checking that type and category codes are numeric, transaction amount follows the format \"-99999999.99\", and dates conform to \"YYYY-MM-DD\" format. The code also performs advanced date validation by calling the CSUTLDTC utility to verify that dates are valid calendar dates. For each validation failure, it sets an error flag, positions the cursor at the problematic field, displays an appropriate error message, and redisplays the transaction entry screen. The paragraph also formats the transaction amount using NUMVAL-C function to ensure proper numeric representation."
          },
          {
            "name": "ADD-TRANSACTION",
            "code": "MOVE HIGH-VALUES TO TRAN-ID\n           PERFORM STARTBR-TRANSACT-FILE\n           PERFORM READPREV-TRANSACT-FILE\n           PERFORM ENDBR-TRANSACT-FILE\n           MOVE TRAN-ID     TO WS-TRAN-ID-N\n           ADD 1 TO WS-TRAN-ID-N\n           INITIALIZE TRAN-RECORD\n           MOVE WS-TRAN-ID-N         TO TRAN-ID\n           MOVE TTYPCDI  OF COTRN2AI TO TRAN-TYPE-CD\n           MOVE TCATCDI  OF COTRN2AI TO TRAN-CAT-CD\n           MOVE TRNSRCI  OF COTRN2AI TO TRAN-SOURCE\n           MOVE TDESCI   OF COTRN2AI TO TRAN-DESC\n           COMPUTE WS-TRAN-AMT-N = FUNCTION NUMVAL-C(TRNAMTI OF\n           COTRN2AI)\n           MOVE WS-TRAN-AMT-N TO TRAN-AMT\n           MOVE CARDNINI OF COTRN2AI TO TRAN-CARD-NUM\n           MOVE MIDI     OF COTRN2AI TO TRAN-MERCHANT-ID\n           MOVE MNAMEI   OF COTRN2AI TO TRAN-MERCHANT-NAME\n           MOVE MCITYI   OF COTRN2AI TO TRAN-MERCHANT-CITY\n           MOVE MZIPI    OF COTRN2AI TO TRAN-MERCHANT-ZIP\n           MOVE TORIGDTI OF COTRN2AI TO TRAN-ORIG-TS\n           MOVE TPROCDTI OF COTRN2AI TO TRAN-PROC-TS\n           PERFORM WRITE-TRANSACT-FILE.\n\n      *----------------------------------------------------------------*\n      *                      COPY-LAST-TRAN-DATA\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the creation of a new transaction record in the system. It first determines the next available transaction ID by retrieving the highest existing ID from the TRANSACT file (using STARTBR, READPREV, and ENDBR operations), then incrementing it by one. The paragraph then initializes a new transaction record and populates it with data from the input screen (COTRN2AI), including transaction type, category, source, description, amount, card number, and merchant information. The transaction amount is converted from character format to numeric using the FUNCTION NUMVAL-C. After all fields are populated, the new transaction record is written to the TRANSACT file by calling the WRITE-TRANSACT-FILE paragraph."
          },
          {
            "name": "COPY-LAST-TRAN-DATA",
            "code": "PERFORM VALIDATE-INPUT-KEY-FIELDS\n\n           MOVE HIGH-VALUES TO TRAN-ID\n           PERFORM STARTBR-TRANSACT-FILE\n           PERFORM READPREV-TRANSACT-FILE\n           PERFORM ENDBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n               MOVE TRAN-AMT TO WS-TRAN-AMT-E\n               MOVE TRAN-TYPE-CD        TO TTYPCDI  OF COTRN2AI\n               MOVE TRAN-CAT-CD         TO TCATCDI  OF COTRN2AI\n               MOVE TRAN-SOURCE         TO TRNSRCI  OF COTRN2AI\n               MOVE WS-TRAN-AMT-E       TO TRNAMTI  OF COTRN2AI\n               MOVE TRAN-DESC           TO TDESCI   OF COTRN2AI\n               MOVE TRAN-ORIG-TS        TO TORIGDTI OF COTRN2AI\n               MOVE TRAN-PROC-TS        TO TPROCDTI OF COTRN2AI\n               MOVE TRAN-MERCHANT-ID    TO MIDI     OF COTRN2AI\n               MOVE TRAN-MERCHANT-NAME  TO MNAMEI   OF COTRN2AI\n               MOVE TRAN-MERCHANT-CITY  TO MCITYI   OF COTRN2AI\n               MOVE TRAN-MERCHANT-ZIP   TO MZIPI    OF COTRN2AI\n           END-IF\n\n           PERFORM PROCESS-ENTER-KEY.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph implements the \"copy last transaction\" feature, which retrieves the most recent transaction record and populates the input screen with its data. It first validates the key fields entered by the user, then retrieves the most recent transaction record by positioning to the end of the TRANSACT file (using HIGH-VALUES) and reading the previous record. If the retrieval is successful (no error flag), it transfers the transaction details from the retrieved record to the input screen fields, including transaction type, category, source, amount, description, dates, and merchant information. The paragraph concludes by processing the ENTER key, which likely refreshes the screen with the copied data. This functionality allows users to quickly create new transactions that share many details with previous ones, improving data entry efficiency."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNADD-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the navigation back to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, defaulting to 'COSGN00C' (likely the main menu or sign-on screen) if no value is provided. The paragraph then populates the communication area with the current transaction ID and program name as the \"from\" information, resets the program context to zeros, and uses the CICS XCTL command to transfer control to the target program while passing the communication area. This provides a standardized way to return to previous screens while maintaining navigation context throughout the application."
          },
          {
            "name": "SEND-TRNADD-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN2AO\n\n           EXEC CICS SEND\n                     MAP('COTRN2A')\n                     MAPSET('COTRN02')\n                     FROM(COTRN2AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNADD-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph displays the transaction addition screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up common header information, then moves any system message to the error message field on the screen. The paragraph uses CICS SEND to display the COTRN2A map from the COTRN02 mapset, erasing the previous screen content and positioning the cursor appropriately. After sending the screen, it executes a CICS RETURN with the current transaction ID and communication area, which effectively pauses the program and waits for user input. This implements the standard CICS pseudo-conversational programming pattern where the program displays a screen, then terminates until the user submits the screen data."
          },
          {
            "name": "RECEIVE-TRNADD-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COTRN2A')\n                     MAPSET('COTRN02')\n                     INTO(COTRN2AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the COTRN2A map within the COTRN02 mapset, storing the data in the COTRN2AI structure. It captures the response and reason codes from the CICS RECEIVE operation to enable error handling. This is a standard CICS data entry pattern that collects transaction details entered by the user before processing them for validation and database operations."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN2AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN2AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN2AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN2AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN2AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN2AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-CXACAIX-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information on the COTRN2A screen. It retrieves the current system date and time, then formats and displays this information along with program identification details. The routine first obtains the current date using the CURRENT-DATE function, then transfers title information and transaction/program identifiers to the screen. It then formats the current date into MM/DD/YY format and the current time into HH:MM:SS format before displaying them in their respective screen fields. This provides users with contextual information about when the transaction is being processed and which program they are currently using."
          },
          {
            "name": "READ-CXACAIX-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-CXACAIX-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-ACCT-ID)\n                KEYLENGTH (LENGTH OF XREF-ACCT-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Acct in XREF AIX file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READ-CCXREF-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a lookup in the CXACAIX file (Card Cross-Reference Alternate Index file) using the account ID as the key. It attempts to retrieve the corresponding card cross-reference record to validate that the entered account ID exists in the system. The paragraph handles three possible outcomes: successful retrieval (continues processing), record not found (displays an error message indicating the account ID is invalid), or a file access error (displays a technical error message). When validation fails, the cursor is positioned at the account ID field and the transaction entry screen is redisplayed with the appropriate error message to guide the user."
          },
          {
            "name": "READ-CCXREF-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-CCXREF-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-CARD-NUM)\n                KEYLENGTH (LENGTH OF XREF-CARD-NUM)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Card Number NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CARDNINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Card # in XREF file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CARDNINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a CICS READ operation on the card cross-reference file (CCXREF) using the card number as the key. It validates whether the provided card number exists in the system. If the read is successful, processing continues normally. If the card number is not found, the program sets an error flag, displays an appropriate message to the user, positions the cursor at the card number input field, and redisplays the transaction entry screen. For any other database errors, it displays the response and reason codes, sets an error flag with a technical message, and returns to the input screen. This validation ensures that transactions can only be created for valid card numbers that exist in the system."
          },
          {
            "name": "STARTBR-TRANSACT-FILE",
            "code": "EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph initiates a browse operation on the transaction file to locate records by transaction ID. It uses the CICS STARTBR command to position the file cursor at the specified transaction ID. The paragraph handles three possible outcomes: successful positioning (NORMAL response), transaction ID not found (NOTFND response), or other errors. For error conditions, it sets an error flag, displays an appropriate message to the user, positions the cursor at the account ID field, and redisplays the transaction entry screen. This functionality is part of the transaction lookup process that likely supports the \"copy last transaction\" feature mentioned in the program description."
          },
          {
            "name": "READPREV-TRANSACT-FILE",
            "code": "EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   MOVE ZEROS TO TRAN-ID\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a backward read operation on the TRANSACT file to retrieve the previous transaction record. It uses the CICS READPREV command with the current transaction ID as the key. The paragraph handles three possible outcomes: successful read (continues processing), reaching the beginning of the file (sets transaction ID to zeros), or encountering an error (displays error codes, sets error flag, displays a user message, and repositions the cursor to the account ID field before redisplaying the transaction entry screen). This functionality is likely part of the \"copy last transaction\" feature, allowing users to navigate backward through transaction records."
          },
          {
            "name": "ENDBR-TRANSACT-FILE",
            "code": "EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                    WRITE-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph terminates a browse operation on the TRANSACT file. It issues a CICS ENDBR (End Browse) command for the dataset identified by the working storage variable WS-TRANSACT-FILE. This is typically called after completing sequential processing of transaction records to release resources associated with the browse operation."
          },
          {
            "name": "WRITE-TRANSACT-FILE",
            "code": "EXEC CICS WRITE\n                DATASET   (WS-TRANSACT-FILE)\n                FROM      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COTRN2AO\n                   STRING 'Transaction added successfully. '\n                                               DELIMITED BY SIZE\n                     ' Your Tran ID is ' DELIMITED BY SIZE\n                          TRAN-ID  DELIMITED BY SPACE\n                          '.' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the writing of a new transaction record to the TRANSACT file and processes the response from the CICS operation. After attempting to write the record, it evaluates the response code and takes appropriate action: on successful completion, it initializes fields, displays a success message with the transaction ID in green text, and refreshes the screen; if a duplicate key/record is detected, it sets an error flag and displays an appropriate message; for any other response, it logs the error codes, sets an error flag, and displays a generic error message. In all cases, the paragraph maintains user interaction by sending the transaction addition screen back to the user with appropriate positioning of the cursor."
          },
          {
            "name": "CLEAR-CURRENT-SCREEN",
            "code": "PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-TRNADD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                    INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the current transaction entry screen by first initializing all fields to their default values and then redisplaying the transaction addition screen to the user. It provides a way to reset the form when users need to start a new transaction entry from scratch."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO ACTIDINL OF COTRN2AI\n           MOVE SPACES          TO ACTIDINI OF COTRN2AI\n                                   CARDNINI OF COTRN2AI\n                                   TTYPCDI  OF COTRN2AI\n                                   TCATCDI  OF COTRN2AI\n                                   TRNSRCI  OF COTRN2AI\n                                   TRNAMTI  OF COTRN2AI\n                                   TDESCI   OF COTRN2AI\n                                   TORIGDTI OF COTRN2AI\n                                   TPROCDTI OF COTRN2AI\n                                   MIDI     OF COTRN2AI\n                                   MNAMEI   OF COTRN2AI\n                                   MCITYI   OF COTRN2AI\n                                   MZIPI    OF COTRN2AI\n                                   CONFIRMI OF COTRN2AI",
            "description": "This paragraph initializes all input fields on the transaction entry screen (COTRN2AI) by setting them to spaces. It also positions the cursor at the ACTID field by setting its length field to -1, which is a standard CICS technique for cursor positioning. This initialization ensures the screen is cleared of any previous data when the program starts or when a reset operation is performed, providing users with a clean form for entering new transaction details."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *",
            "description": "This paragraph contains version control information for the CardDemo application. It indicates the specific version (CardDemo_v1.0-15-g27d6c6f-68) and the timestamp when this version was created or last modified (July 19, 2022, at 23:12:34 CDT). This information helps track which version of the code is being used and when it was implemented."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN2AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN2AO\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   IF CDEMO-CT02-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CT02-TRN-SELECTED TO\n                            CARDNINI OF COTRN2AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-TRNADD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNADD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM COPY-LAST-TRAN-DATA\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNADD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           PERFORM VALIDATE-INPUT-KEY-FIELDS\n           PERFORM VALIDATE-INPUT-DATA-FIELDS.\n\n           EVALUATE CONFIRMI OF COTRN2AI\n               WHEN 'Y'\n               WHEN 'y'\n                   PERFORM ADD-TRANSACTION\n               WHEN 'N'\n               WHEN 'n'\n               WHEN SPACES\n               WHEN LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Confirm to add this transaction...'\n                                TO WS-MESSAGE\n                   MOVE -1      TO CONFIRML OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Invalid value. Valid values are (Y/N)...'\n                                TO WS-MESSAGE\n                   MOVE -1      TO CONFIRML OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      VALIDATE-INPUT-KEY-FIELDS\n      *----------------------------------------------------------------*\n       VALIDATE-INPUT-KEY-FIELDS.\n\n           EVALUATE TRUE\n               WHEN ACTIDINI OF COTRN2AI NOT = SPACES AND LOW-VALUES\n                   IF ACTIDINI OF COTRN2AI IS NOT NUMERIC\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Account ID must be Numeric...' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO ACTIDINL OF COTRN2AI\n                       PERFORM SEND-TRNADD-SCREEN\n                   END-IF\n                   COMPUTE WS-ACCT-ID-N = FUNCTION NUMVAL(ACTIDINI OF\n                   COTRN2AI)\n                   MOVE WS-ACCT-ID-N            TO XREF-ACCT-ID\n                                                ACTIDINI OF COTRN2AI\n                   PERFORM READ-CXACAIX-FILE\n                   MOVE XREF-CARD-NUM         TO CARDNINI OF COTRN2AI\n               WHEN CARDNINI OF COTRN2AI NOT = SPACES AND LOW-VALUES\n                   IF CARDNINI OF COTRN2AI IS NOT NUMERIC\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Card Number must be Numeric...' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO CARDNINL OF COTRN2AI\n                       PERFORM SEND-TRNADD-SCREEN\n                   END-IF\n                   COMPUTE WS-CARD-NUM-N = FUNCTION NUMVAL(CARDNINI OF\n                   COTRN2AI)\n                   MOVE WS-CARD-NUM-N        TO XREF-CARD-NUM\n                                                CARDNINI OF COTRN2AI\n                   PERFORM READ-CCXREF-FILE\n                   MOVE XREF-ACCT-ID         TO ACTIDINI OF COTRN2AI\n               WHEN OTHER\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account or Card Number must be entered...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                 VALIDATE-INPUT-DATA-FIELDS\n      *----------------------------------------------------------------*\n       VALIDATE-INPUT-DATA-FIELDS.\n\n           IF ERR-FLG-ON\n               MOVE SPACES      TO TTYPCDI  OF COTRN2AI\n                                   TCATCDI  OF COTRN2AI\n                                   TRNSRCI  OF COTRN2AI\n                                   TRNAMTI  OF COTRN2AI\n                                   TDESCI   OF COTRN2AI\n                                   TORIGDTI OF COTRN2AI\n                                   TPROCDTI OF COTRN2AI\n                                   MIDI     OF COTRN2AI\n                                   MNAMEI   OF COTRN2AI\n                                   MCITYI   OF COTRN2AI\n                                   MZIPI    OF COTRN2AI\n           END-IF.\n\n           EVALUATE TRUE\n               WHEN TTYPCDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Type CD can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TTYPCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TCATCDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Category CD can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TCATCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TRNSRCI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Source can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNSRCL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TDESCI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Description can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TDESCL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TRNAMTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Amount can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNAMTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TORIGDTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Orig Date can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TPROCDTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Proc Date can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MIDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MIDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MNAMEI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MNAMEL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MCITYI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant City can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MCITYL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MZIPI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant Zip can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MZIPL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n           EVALUATE TRUE\n               WHEN TTYPCDI OF COTRN2AI NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Type CD must be Numeric...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TTYPCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TCATCDI OF COTRN2AI NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Category CD must be Numeric...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TCATCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TRNAMTI OF COTRN2AI(1:1) NOT EQUAL '-' AND '+'\n               WHEN TRNAMTI OF COTRN2AI(2:8) NOT NUMERIC\n               WHEN TRNAMTI OF COTRN2AI(10:1) NOT = '.'\n               WHEN TRNAMTI OF COTRN2AI(11:2) IS NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Amount should be in format -99999999.99' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNAMTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TORIGDTI OF COTRN2AI(1:4) IS NOT NUMERIC\n               WHEN TORIGDTI OF COTRN2AI(5:1) NOT EQUAL '-'\n               WHEN TORIGDTI OF COTRN2AI(6:2) NOT NUMERIC\n               WHEN TORIGDTI OF COTRN2AI(8:1) NOT EQUAL '-'\n               WHEN TORIGDTI OF COTRN2AI(9:2) NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Orig Date should be in format YYYY-MM-DD' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TPROCDTI OF COTRN2AI(1:4) IS NOT NUMERIC\n               WHEN TPROCDTI OF COTRN2AI(5:1) NOT EQUAL '-'\n               WHEN TPROCDTI OF COTRN2AI(6:2) NOT NUMERIC\n               WHEN TPROCDTI OF COTRN2AI(8:1) NOT EQUAL '-'\n               WHEN TPROCDTI OF COTRN2AI(9:2) NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Proc Date should be in format YYYY-MM-DD' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           COMPUTE WS-TRAN-AMT-N = FUNCTION NUMVAL-C(TRNAMTI OF\n           COTRN2AI)\n           MOVE WS-TRAN-AMT-N TO WS-TRAN-AMT-E\n           MOVE WS-TRAN-AMT-E TO TRNAMTI OF COTRN2AI\n\n\n           MOVE TORIGDTI OF COTRN2AI TO CSUTLDTC-DATE\n           MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n           MOVE SPACES               TO CSUTLDTC-RESULT\n\n           CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                   CSUTLDTC-DATE-FORMAT\n                                   CSUTLDTC-RESULT\n\n           IF CSUTLDTC-RESULT-SEV-CD = '0000'\n               CONTINUE\n           ELSE\n               IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                   MOVE 'Orig Date - Not a valid date...'\n                     TO WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               END-IF\n           END-IF\n\n           MOVE TPROCDTI OF COTRN2AI TO CSUTLDTC-DATE\n           MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n           MOVE SPACES               TO CSUTLDTC-RESULT\n\n           CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                   CSUTLDTC-DATE-FORMAT\n                                   CSUTLDTC-RESULT\n\n           IF CSUTLDTC-RESULT-SEV-CD = '0000'\n               CONTINUE\n           ELSE\n               IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                   MOVE 'Proc Date - Not a valid date...'\n                     TO WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               END-IF\n           END-IF\n\n\n           IF MIDI OF COTRN2AI IS NOT NUMERIC\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Merchant ID must be Numeric...' TO\n                               WS-MESSAGE\n               MOVE -1       TO MIDL OF COTRN2AI\n               PERFORM SEND-TRNADD-SCREEN\n           END-IF\n           .\n\n      *----------------------------------------------------------------*\n      *                        ADD-TRANSACTION\n      *----------------------------------------------------------------*\n       ADD-TRANSACTION.\n\n           MOVE HIGH-VALUES TO TRAN-ID\n           PERFORM STARTBR-TRANSACT-FILE\n           PERFORM READPREV-TRANSACT-FILE\n           PERFORM ENDBR-TRANSACT-FILE\n           MOVE TRAN-ID     TO WS-TRAN-ID-N\n           ADD 1 TO WS-TRAN-ID-N\n           INITIALIZE TRAN-RECORD\n           MOVE WS-TRAN-ID-N         TO TRAN-ID\n           MOVE TTYPCDI  OF COTRN2AI TO TRAN-TYPE-CD\n           MOVE TCATCDI  OF COTRN2AI TO TRAN-CAT-CD\n           MOVE TRNSRCI  OF COTRN2AI TO TRAN-SOURCE\n           MOVE TDESCI   OF COTRN2AI TO TRAN-DESC\n           COMPUTE WS-TRAN-AMT-N = FUNCTION NUMVAL-C(TRNAMTI OF\n           COTRN2AI)\n           MOVE WS-TRAN-AMT-N TO TRAN-AMT\n           MOVE CARDNINI OF COTRN2AI TO TRAN-CARD-NUM\n           MOVE MIDI     OF COTRN2AI TO TRAN-MERCHANT-ID\n           MOVE MNAMEI   OF COTRN2AI TO TRAN-MERCHANT-NAME\n           MOVE MCITYI   OF COTRN2AI TO TRAN-MERCHANT-CITY\n           MOVE MZIPI    OF COTRN2AI TO TRAN-MERCHANT-ZIP\n           MOVE TORIGDTI OF COTRN2AI TO TRAN-ORIG-TS\n           MOVE TPROCDTI OF COTRN2AI TO TRAN-PROC-TS\n           PERFORM WRITE-TRANSACT-FILE.\n\n      *----------------------------------------------------------------*\n      *                      COPY-LAST-TRAN-DATA\n      *----------------------------------------------------------------*\n       COPY-LAST-TRAN-DATA.\n\n           PERFORM VALIDATE-INPUT-KEY-FIELDS\n\n           MOVE HIGH-VALUES TO TRAN-ID\n           PERFORM STARTBR-TRANSACT-FILE\n           PERFORM READPREV-TRANSACT-FILE\n           PERFORM ENDBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n               MOVE TRAN-AMT TO WS-TRAN-AMT-E\n               MOVE TRAN-TYPE-CD        TO TTYPCDI  OF COTRN2AI\n               MOVE TRAN-CAT-CD         TO TCATCDI  OF COTRN2AI\n               MOVE TRAN-SOURCE         TO TRNSRCI  OF COTRN2AI\n               MOVE WS-TRAN-AMT-E       TO TRNAMTI  OF COTRN2AI\n               MOVE TRAN-DESC           TO TDESCI   OF COTRN2AI\n               MOVE TRAN-ORIG-TS        TO TORIGDTI OF COTRN2AI\n               MOVE TRAN-PROC-TS        TO TPROCDTI OF COTRN2AI\n               MOVE TRAN-MERCHANT-ID    TO MIDI     OF COTRN2AI\n               MOVE TRAN-MERCHANT-NAME  TO MNAMEI   OF COTRN2AI\n               MOVE TRAN-MERCHANT-CITY  TO MCITYI   OF COTRN2AI\n               MOVE TRAN-MERCHANT-ZIP   TO MZIPI    OF COTRN2AI\n           END-IF\n\n           PERFORM PROCESS-ENTER-KEY.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNADD-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNADD-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN2AO\n\n           EXEC CICS SEND\n                     MAP('COTRN2A')\n                     MAPSET('COTRN02')\n                     FROM(COTRN2AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNADD-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNADD-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COTRN2A')\n                     MAPSET('COTRN02')\n                     INTO(COTRN2AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN2AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN2AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN2AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN2AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN2AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN2AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-CXACAIX-FILE\n      *----------------------------------------------------------------*\n       READ-CXACAIX-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-CXACAIX-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-ACCT-ID)\n                KEYLENGTH (LENGTH OF XREF-ACCT-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Acct in XREF AIX file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READ-CCXREF-FILE\n      *----------------------------------------------------------------*\n       READ-CCXREF-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-CCXREF-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-CARD-NUM)\n                KEYLENGTH (LENGTH OF XREF-CARD-NUM)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Card Number NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CARDNINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Card # in XREF file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CARDNINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       STARTBR-TRANSACT-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READPREV-TRANSACT-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   MOVE ZEROS TO TRAN-ID\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       ENDBR-TRANSACT-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                    WRITE-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       WRITE-TRANSACT-FILE.\n\n           EXEC CICS WRITE\n                DATASET   (WS-TRANSACT-FILE)\n                FROM      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COTRN2AO\n                   STRING 'Transaction added successfully. '\n                                               DELIMITED BY SIZE\n                     ' Your Tran ID is ' DELIMITED BY SIZE\n                          TRAN-ID  DELIMITED BY SPACE\n                          '.' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-TRNADD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                    INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO ACTIDINL OF COTRN2AI\n           MOVE SPACES          TO ACTIDINI OF COTRN2AI\n                                   CARDNINI OF COTRN2AI\n                                   TTYPCDI  OF COTRN2AI\n                                   TCATCDI  OF COTRN2AI\n                                   TRNSRCI  OF COTRN2AI\n                                   TRNAMTI  OF COTRN2AI\n                                   TDESCI   OF COTRN2AI\n                                   TORIGDTI OF COTRN2AI\n                                   TPROCDTI OF COTRN2AI\n                                   MIDI     OF COTRN2AI\n                                   MNAMEI   OF COTRN2AI\n                                   MCITYI   OF COTRN2AI\n                                   MZIPI    OF COTRN2AI\n                                   CONFIRMI OF COTRN2AI\n                                   WS-MESSAGE.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *"
      },
      "description": "This program (COTRN02C) is a CICS COBOL application that adds new transactions to the TRANSACT file in the CardDemo system. It provides a user interface for entering transaction details and performs comprehensive validation before writing records to the database.\n\nThe program handles the creation of credit card transactions by allowing users to enter either an account ID or card number, along with transaction details such as type code, category code, amount, description, dates, and merchant information. It performs extensive validation on all input fields, ensuring data integrity before adding records to the transaction file.\n\nKey functionality includes:\n- Validating account IDs and card numbers against cross-reference files\n- Performing format validation on transaction amounts and dates\n- Auto-generating sequential transaction IDs\n- Providing a \"copy last transaction\" feature to streamline data entry\n- Supporting navigation between screens in the CardDemo application\n\nThe program incorporates error handling for database operations and provides clear error messages to guide users through the data entry process. It demonstrates typical mainframe transaction processing patterns with field validation, file I/O operations, and screen management.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COTRN02C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Add a new Transaction to TRANSACT file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COTRN02C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN02C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT02'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE           PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ACCTDAT-FILE            PIC X(08) VALUE 'ACCTDAT '.\n         05 WS-CCXREF-FILE             PIC X(08) VALUE 'CCXREF  '.\n         05 WS-CXACAIX-FILE            PIC X(08) VALUE 'CXACAIX '.\n\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n         05 WS-ACCT-ID-N               PIC 9(11) VALUE 0.\n         05 WS-CARD-NUM-N              PIC 9(16) VALUE 0.\n         05 WS-TRAN-ID-N               PIC 9(16) VALUE ZEROS.\n         05 WS-TRAN-AMT-N              PIC S9(9)V99 VALUE ZERO.\n         05 WS-TRAN-AMT-E              PIC +99999999.99 VALUE ZEROS.\n         05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.\n\n       01 CSUTLDTC-PARM.\n          05 CSUTLDTC-DATE                   PIC X(10).\n          05 CSUTLDTC-DATE-FORMAT            PIC X(10).\n          05 CSUTLDTC-RESULT.\n             10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).\n             10 FILLER                       PIC X(11).\n             10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).\n             10 CSUTLDTC-RESULT-MSG          PIC X(61).\n\n       COPY COCOM01Y.\n          05 CDEMO-CT02-INFO.\n             10 CDEMO-CT02-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT02-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT02-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT02-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT02-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT02-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN02.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n       COPY CVACT01Y.\n       COPY CVACT03Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN2AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN2AO\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   IF CDEMO-CT02-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CT02-TRN-SELECTED TO\n                            CARDNINI OF COTRN2AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-TRNADD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNADD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM COPY-LAST-TRAN-DATA\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNADD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           PERFORM VALIDATE-INPUT-KEY-FIELDS\n           PERFORM VALIDATE-INPUT-DATA-FIELDS.\n\n           EVALUATE CONFIRMI OF COTRN2AI\n               WHEN 'Y'\n               WHEN 'y'\n                   PERFORM ADD-TRANSACTION\n               WHEN 'N'\n               WHEN 'n'\n               WHEN SPACES\n               WHEN LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Confirm to add this transaction...'\n                                TO WS-MESSAGE\n                   MOVE -1      TO CONFIRML OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Invalid value. Valid values are (Y/N)...'\n                                TO WS-MESSAGE\n                   MOVE -1      TO CONFIRML OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      VALIDATE-INPUT-KEY-FIELDS\n      *----------------------------------------------------------------*\n       VALIDATE-INPUT-KEY-FIELDS.\n\n           EVALUATE TRUE\n               WHEN ACTIDINI OF COTRN2AI NOT = SPACES AND LOW-VALUES\n                   IF ACTIDINI OF COTRN2AI IS NOT NUMERIC\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Account ID must be Numeric...' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO ACTIDINL OF COTRN2AI\n                       PERFORM SEND-TRNADD-SCREEN\n                   END-IF\n                   COMPUTE WS-ACCT-ID-N = FUNCTION NUMVAL(ACTIDINI OF\n                   COTRN2AI)\n                   MOVE WS-ACCT-ID-N            TO XREF-ACCT-ID\n                                                ACTIDINI OF COTRN2AI\n                   PERFORM READ-CXACAIX-FILE\n                   MOVE XREF-CARD-NUM         TO CARDNINI OF COTRN2AI\n               WHEN CARDNINI OF COTRN2AI NOT = SPACES AND LOW-VALUES\n                   IF CARDNINI OF COTRN2AI IS NOT NUMERIC\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE 'Card Number must be Numeric...' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO CARDNINL OF COTRN2AI\n                       PERFORM SEND-TRNADD-SCREEN\n                   END-IF\n                   COMPUTE WS-CARD-NUM-N = FUNCTION NUMVAL(CARDNINI OF\n                   COTRN2AI)\n                   MOVE WS-CARD-NUM-N        TO XREF-CARD-NUM\n                                                CARDNINI OF COTRN2AI\n                   PERFORM READ-CCXREF-FILE\n                   MOVE XREF-ACCT-ID         TO ACTIDINI OF COTRN2AI\n               WHEN OTHER\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account or Card Number must be entered...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                 VALIDATE-INPUT-DATA-FIELDS\n      *----------------------------------------------------------------*\n       VALIDATE-INPUT-DATA-FIELDS.\n\n           IF ERR-FLG-ON\n               MOVE SPACES      TO TTYPCDI  OF COTRN2AI\n                                   TCATCDI  OF COTRN2AI\n                                   TRNSRCI  OF COTRN2AI\n                                   TRNAMTI  OF COTRN2AI\n                                   TDESCI   OF COTRN2AI\n                                   TORIGDTI OF COTRN2AI\n                                   TPROCDTI OF COTRN2AI\n                                   MIDI     OF COTRN2AI\n                                   MNAMEI   OF COTRN2AI\n                                   MCITYI   OF COTRN2AI\n                                   MZIPI    OF COTRN2AI\n           END-IF.\n\n           EVALUATE TRUE\n               WHEN TTYPCDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Type CD can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TTYPCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TCATCDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Category CD can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TCATCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TRNSRCI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Source can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNSRCL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TDESCI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Description can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TDESCL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TRNAMTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Amount can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNAMTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TORIGDTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Orig Date can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TPROCDTI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Proc Date can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MIDI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MIDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MNAMEI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MNAMEL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MCITYI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant City can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MCITYL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN MZIPI OF COTRN2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Merchant Zip can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MZIPL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n           EVALUATE TRUE\n               WHEN TTYPCDI OF COTRN2AI NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Type CD must be Numeric...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TTYPCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN TCATCDI OF COTRN2AI NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Category CD must be Numeric...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TCATCDL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TRNAMTI OF COTRN2AI(1:1) NOT EQUAL '-' AND '+'\n               WHEN TRNAMTI OF COTRN2AI(2:8) NOT NUMERIC\n               WHEN TRNAMTI OF COTRN2AI(10:1) NOT = '.'\n               WHEN TRNAMTI OF COTRN2AI(11:2) IS NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Amount should be in format -99999999.99' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNAMTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TORIGDTI OF COTRN2AI(1:4) IS NOT NUMERIC\n               WHEN TORIGDTI OF COTRN2AI(5:1) NOT EQUAL '-'\n               WHEN TORIGDTI OF COTRN2AI(6:2) NOT NUMERIC\n               WHEN TORIGDTI OF COTRN2AI(8:1) NOT EQUAL '-'\n               WHEN TORIGDTI OF COTRN2AI(9:2) NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Orig Date should be in format YYYY-MM-DD' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           EVALUATE TRUE\n               WHEN TPROCDTI OF COTRN2AI(1:4) IS NOT NUMERIC\n               WHEN TPROCDTI OF COTRN2AI(5:1) NOT EQUAL '-'\n               WHEN TPROCDTI OF COTRN2AI(6:2) NOT NUMERIC\n               WHEN TPROCDTI OF COTRN2AI(8:1) NOT EQUAL '-'\n               WHEN TPROCDTI OF COTRN2AI(9:2) NOT NUMERIC\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Proc Date should be in format YYYY-MM-DD' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE\n\n           COMPUTE WS-TRAN-AMT-N = FUNCTION NUMVAL-C(TRNAMTI OF\n           COTRN2AI)\n           MOVE WS-TRAN-AMT-N TO WS-TRAN-AMT-E\n           MOVE WS-TRAN-AMT-E TO TRNAMTI OF COTRN2AI\n\n\n           MOVE TORIGDTI OF COTRN2AI TO CSUTLDTC-DATE\n           MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n           MOVE SPACES               TO CSUTLDTC-RESULT\n\n           CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                   CSUTLDTC-DATE-FORMAT\n                                   CSUTLDTC-RESULT\n\n           IF CSUTLDTC-RESULT-SEV-CD = '0000'\n               CONTINUE\n           ELSE\n               IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                   MOVE 'Orig Date - Not a valid date...'\n                     TO WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO TORIGDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               END-IF\n           END-IF\n\n           MOVE TPROCDTI OF COTRN2AI TO CSUTLDTC-DATE\n           MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n           MOVE SPACES               TO CSUTLDTC-RESULT\n\n           CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                   CSUTLDTC-DATE-FORMAT\n                                   CSUTLDTC-RESULT\n\n           IF CSUTLDTC-RESULT-SEV-CD = '0000'\n               CONTINUE\n           ELSE\n               IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                   MOVE 'Proc Date - Not a valid date...'\n                     TO WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO TPROCDTL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               END-IF\n           END-IF\n\n\n           IF MIDI OF COTRN2AI IS NOT NUMERIC\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Merchant ID must be Numeric...' TO\n                               WS-MESSAGE\n               MOVE -1       TO MIDL OF COTRN2AI\n               PERFORM SEND-TRNADD-SCREEN\n           END-IF\n           .\n\n      *----------------------------------------------------------------*\n      *                        ADD-TRANSACTION\n      *----------------------------------------------------------------*\n       ADD-TRANSACTION.\n\n           MOVE HIGH-VALUES TO TRAN-ID\n           PERFORM STARTBR-TRANSACT-FILE\n           PERFORM READPREV-TRANSACT-FILE\n           PERFORM ENDBR-TRANSACT-FILE\n           MOVE TRAN-ID     TO WS-TRAN-ID-N\n           ADD 1 TO WS-TRAN-ID-N\n           INITIALIZE TRAN-RECORD\n           MOVE WS-TRAN-ID-N         TO TRAN-ID\n           MOVE TTYPCDI  OF COTRN2AI TO TRAN-TYPE-CD\n           MOVE TCATCDI  OF COTRN2AI TO TRAN-CAT-CD\n           MOVE TRNSRCI  OF COTRN2AI TO TRAN-SOURCE\n           MOVE TDESCI   OF COTRN2AI TO TRAN-DESC\n           COMPUTE WS-TRAN-AMT-N = FUNCTION NUMVAL-C(TRNAMTI OF\n           COTRN2AI)\n           MOVE WS-TRAN-AMT-N TO TRAN-AMT\n           MOVE CARDNINI OF COTRN2AI TO TRAN-CARD-NUM\n           MOVE MIDI     OF COTRN2AI TO TRAN-MERCHANT-ID\n           MOVE MNAMEI   OF COTRN2AI TO TRAN-MERCHANT-NAME\n           MOVE MCITYI   OF COTRN2AI TO TRAN-MERCHANT-CITY\n           MOVE MZIPI    OF COTRN2AI TO TRAN-MERCHANT-ZIP\n           MOVE TORIGDTI OF COTRN2AI TO TRAN-ORIG-TS\n           MOVE TPROCDTI OF COTRN2AI TO TRAN-PROC-TS\n           PERFORM WRITE-TRANSACT-FILE.\n\n      *----------------------------------------------------------------*\n      *                      COPY-LAST-TRAN-DATA\n      *----------------------------------------------------------------*\n       COPY-LAST-TRAN-DATA.\n\n           PERFORM VALIDATE-INPUT-KEY-FIELDS\n\n           MOVE HIGH-VALUES TO TRAN-ID\n           PERFORM STARTBR-TRANSACT-FILE\n           PERFORM READPREV-TRANSACT-FILE\n           PERFORM ENDBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n               MOVE TRAN-AMT TO WS-TRAN-AMT-E\n               MOVE TRAN-TYPE-CD        TO TTYPCDI  OF COTRN2AI\n               MOVE TRAN-CAT-CD         TO TCATCDI  OF COTRN2AI\n               MOVE TRAN-SOURCE         TO TRNSRCI  OF COTRN2AI\n               MOVE WS-TRAN-AMT-E       TO TRNAMTI  OF COTRN2AI\n               MOVE TRAN-DESC           TO TDESCI   OF COTRN2AI\n               MOVE TRAN-ORIG-TS        TO TORIGDTI OF COTRN2AI\n               MOVE TRAN-PROC-TS        TO TPROCDTI OF COTRN2AI\n               MOVE TRAN-MERCHANT-ID    TO MIDI     OF COTRN2AI\n               MOVE TRAN-MERCHANT-NAME  TO MNAMEI   OF COTRN2AI\n               MOVE TRAN-MERCHANT-CITY  TO MCITYI   OF COTRN2AI\n               MOVE TRAN-MERCHANT-ZIP   TO MZIPI    OF COTRN2AI\n           END-IF\n\n           PERFORM PROCESS-ENTER-KEY.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNADD-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNADD-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN2AO\n\n           EXEC CICS SEND\n                     MAP('COTRN2A')\n                     MAPSET('COTRN02')\n                     FROM(COTRN2AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n      *              LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNADD-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNADD-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COTRN2A')\n                     MAPSET('COTRN02')\n                     INTO(COTRN2AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN2AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN2AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN2AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN2AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN2AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN2AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-CXACAIX-FILE\n      *----------------------------------------------------------------*\n       READ-CXACAIX-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-CXACAIX-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-ACCT-ID)\n                KEYLENGTH (LENGTH OF XREF-ACCT-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Account ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Acct in XREF AIX file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READ-CCXREF-FILE\n      *----------------------------------------------------------------*\n       READ-CCXREF-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-CCXREF-FILE)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RIDFLD    (XREF-CARD-NUM)\n                KEYLENGTH (LENGTH OF XREF-CARD-NUM)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Card Number NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CARDNINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Card # in XREF file...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO CARDNINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       STARTBR-TRANSACT-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READPREV-TRANSACT-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   MOVE ZEROS TO TRAN-ID\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       ENDBR-TRANSACT-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                    WRITE-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       WRITE-TRANSACT-FILE.\n\n           EXEC CICS WRITE\n                DATASET   (WS-TRANSACT-FILE)\n                FROM      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COTRN2AO\n                   STRING 'Transaction added successfully. '\n                                               DELIMITED BY SIZE\n                     ' Your Tran ID is ' DELIMITED BY SIZE\n                          TRAN-ID  DELIMITED BY SPACE\n                          '.' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO ACTIDINL OF COTRN2AI\n                   PERFORM SEND-TRNADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                    CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-TRNADD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                    INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO ACTIDINL OF COTRN2AI\n           MOVE SPACES          TO ACTIDINI OF COTRN2AI\n                                   CARDNINI OF COTRN2AI\n                                   TTYPCDI  OF COTRN2AI\n                                   TCATCDI  OF COTRN2AI\n                                   TRNSRCI  OF COTRN2AI\n                                   TRNAMTI  OF COTRN2AI\n                                   TDESCI   OF COTRN2AI\n                                   TORIGDTI OF COTRN2AI\n                                   TPROCDTI OF COTRN2AI\n                                   MIDI     OF COTRN2AI\n                                   MNAMEI   OF COTRN2AI\n                                   MCITYI   OF COTRN2AI\n                                   MZIPI    OF COTRN2AI\n                                   CONFIRMI OF COTRN2AI\n                                   WS-MESSAGE.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "COTRN02",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVTRA05Y",
        "COTTL01Y",
        "DFHAID",
        "CVACT03Y",
        "CVACT01Y"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant MainPara as MAIN-PARA\n    participant ProcessEnter as PROCESS-ENTER-KEY\n    participant ValidateKey as VALIDATE-INPUT-KEY-FIELDS\n    participant ValidateData as VALIDATE-INPUT-DATA-FIELDS\n    participant AddTran as ADD-TRANSACTION\n    participant CopyLast as COPY-LAST-TRAN-DATA\n    participant Screen as SEND-TRNADD-SCREEN\n    participant Files as Database Files\n    \n    User->>MainPara: Start transaction\n    \n    alt First time entry\n        MainPara->>Screen: Initialize and display screen\n        Screen-->>User: Show transaction entry form\n    else Re-entry\n        MainPara->>MainPara: Receive screen data\n        \n        alt ENTER key pressed\n            MainPara->>ProcessEnter: Process entered data\n            ProcessEnter->>ValidateKey: Validate key fields\n            ValidateKey->>Files: Read CXACAIX/CCXREF files\n            Files-->>ValidateKey: Return account/card data\n            \n            ProcessEnter->>ValidateData: Validate data fields\n            \n            alt Confirmation = 'Y'\n                ProcessEnter->>AddTran: Add transaction\n                AddTran->>Files: STARTBR TRANSACT file\n                Files-->>AddTran: Position at end\n                AddTran->>Files: READPREV TRANSACT file\n                Files-->>AddTran: Return last transaction\n                AddTran->>AddTran: Generate new transaction ID\n                AddTran->>Files: WRITE TRANSACT file\n                Files-->>AddTran: Write confirmation\n                AddTran->>Screen: Display success message\n                Screen-->>User: Show confirmation\n            else Confirmation not 'Y'\n                ProcessEnter->>Screen: Request confirmation\n                Screen-->>User: Prompt for confirmation\n            end\n            \n        else PF3 key pressed\n            MainPara->>MainPara: Return to previous screen\n            \n        else PF4 key pressed\n            MainPara->>MainPara: Clear current screen\n            MainPara->>Screen: Display empty form\n            Screen-->>User: Show cleared form\n            \n        else PF5 key pressed\n            MainPara->>CopyLast: Copy last transaction\n            CopyLast->>ValidateKey: Validate key fields\n            CopyLast->>Files: STARTBR TRANSACT file\n            Files-->>CopyLast: Position at end\n            CopyLast->>Files: READPREV TRANSACT file\n            Files-->>CopyLast: Return last transaction\n            CopyLast->>ProcessEnter: Process with copied data\n            ProcessEnter->>Screen: Display form with copied data\n            Screen-->>User: Show form with copied data\n            \n        else Other key pressed\n            MainPara->>Screen: Display invalid key message\n            Screen-->>User: Show error message\n        end\n    end"
    },
    {
      "id": "CBTRN03C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.                                                            \n           SELECT TRANSACT-FILE ASSIGN TO TRANFILE                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  FILE STATUS  IS TRANFILE-STATUS.                              \n                                                                                \n           SELECT XREF-FILE ASSIGN TO CARDXREF                                  \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  FILE STATUS  IS CARDXREF-STATUS.                              \n                                                                                \n           SELECT TRANTYPE-FILE ASSIGN TO TRANTYPE                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRAN-TYPE                                  \n                  FILE STATUS  IS TRANTYPE-STATUS.                              \n                                                                                \n           SELECT TRANCATG-FILE ASSIGN TO TRANCATG                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRAN-CAT-KEY                               \n                  FILE STATUS  IS TRANCATG-STATUS.                              \n                                                                                \n           SELECT REPORT-FILE ASSIGN TO TRANREPT                                \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  FILE STATUS  IS TRANREPT-STATUS.                              \n                                                                                \n           SELECT DATE-PARMS-FILE ASSIGN TO DATEPARM                            \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  FILE STATUS  IS DATEPARM-STATUS.                              \n      *",
            "description": "This section defines the file control entries for the transaction report program. It specifies five files: a sequential transaction file (TRANSACT-FILE) that contains the source transaction data, three indexed files accessed randomly - a card cross-reference file (XREF-FILE) for account lookups, a transaction type file (TRANTYPE-FILE) for transaction descriptions, and a transaction category file (TRANCATG-FILE) for category information. It also defines a sequential report output file (REPORT-FILE) and a sequential date parameters file (DATE-PARMS-FILE) that likely contains the date range criteria for filtering transactions. Each file has an associated file status variable for error handling."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  TRANSACT-FILE.                                                       \n       01 FD-TRANFILE-REC.                                                      \n          05 FD-TRANS-DATA      PIC X(304).                                     \n          05 FD-TRAN-PROC-TS    PIC X(26).                                      \n          05 FD-FILLER          PIC X(20).                                      \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-CARDXREF-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       FD  TRANTYPE-FILE.                                                       \n       01 FD-TRANTYPE-REC.                                                      \n          05 FD-TRAN-TYPE       PIC X(02).                                      \n          05 FD-TRAN-DATA       PIC X(58).                                      \n                                                                                \n       FD  TRANCATG-FILE.                                                       \n       01 FD-TRAN-CAT-RECORD.                                                   \n           05  FD-TRAN-CAT-KEY.                                                 \n              10  FD-TRAN-TYPE-CD                         PIC X(02).            \n              10  FD-TRAN-CAT-CD                          PIC 9(04).            \n           05  FD-TRAN-CAT-DATA                           PIC X(54).            \n                                                                                \n       FD  REPORT-FILE.                                                         \n       01 FD-REPTFILE-REC       PIC X(133).                                     \n                                                                                \n       FD  DATE-PARMS-FILE.                                                     \n       01 FD-DATEPARM-REC       PIC X(80).",
            "description": "This File Section defines the file structures used in the CBTRN03C program for generating transaction reports. It includes six file definitions: TRANSACT-FILE for transaction records with a 350-byte structure containing transaction data and timestamp; XREF-FILE for card cross-reference records with card number and related data; TRANTYPE-FILE for transaction type lookup with type code and descriptive data; TRANCATG-FILE for transaction category information with composite keys (type code and category code); REPORT-FILE for the 133-byte output report records; and DATE-PARMS-FILE for reading the 80-byte date range parameters that control which transactions are included in the report."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************         \n       COPY CVTRA05Y.                                                           \n       01 TRANFILE-STATUS.                                                      \n          05 TRANFILE-STAT1     PIC X.                                          \n          05 TRANFILE-STAT2     PIC X.                                          \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  CARDXREF-STATUS.                                                     \n           05  CARDXREF-STAT1      PIC X.                                       \n           05  CARDXREF-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA03Y.                                                           \n       01  TRANTYPE-STATUS.                                                     \n           05  TRANTYPE-STAT1      PIC X.                                       \n           05  TRANTYPE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA04Y.                                                           \n       01  TRANCATG-STATUS.                                                     \n           05  TRANCATG-STAT1      PIC X.                                       \n           05  TRANCATG-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA07Y.                                                           \n       01 TRANREPT-STATUS.                                                      \n           05 REPTFILE-STAT1     PIC X.                                         \n           05 REPTFILE-STAT2     PIC X.                                         \n                                                                                \n       01 DATEPARM-STATUS.                                                      \n           05 DATEPARM-STAT1     PIC X.                                         \n           05 DATEPARM-STAT2     PIC X.                                         \n                                                                                \n       01 WS-DATEPARM-RECORD.                                                   \n           05 WS-START-DATE      PIC X(10).                                     \n           05 FILLER             PIC X(01).                                     \n           05 WS-END-DATE        PIC X(10).                                     \n                                                                                \n       01 WS-REPORT-VARS.                                                       \n           05 WS-FIRST-TIME      PIC X      VALUE 'Y'.                          \n           05 WS-LINE-COUNTER    PIC 9(09) COMP-3                               \n                                            VALUE 0.                            \n           05 WS-PAGE-SIZE       PIC 9(03) COMP-3                               \n                                            VALUE 20.                           \n           05 WS-BLANK-LINE      PIC X(133) VALUE SPACES.                       \n           05 WS-PAGE-TOTAL      PIC S9(09)V99 VALUE 0.                         \n           05 WS-ACCOUNT-TOTAL   PIC S9(09)V99 VALUE 0.                         \n           05 WS-GRAND-TOTAL     PIC S9(09)V99 VALUE 0.                         \n           05 WS-CURR-CARD-NUM   PIC X(16) VALUE SPACES.                        \n                                                                                \n       01 IO-STATUS.                                                            \n          05 IO-STAT1           PIC X.                                          \n          05 IO-STAT2           PIC X.                                          \n       01 TWO-BYTES-BINARY      PIC 9(4) BINARY.                                \n       01 TWO-BYTES-ALPHA REDEFINES TWO-BYTES-BINARY.                           \n          05 TWO-BYTES-LEFT     PIC X.                                          \n          05 TWO-BYTES-RIGHT    PIC X.                                          \n       01 IO-STATUS-04.                                                         \n          05 IO-STATUS-0401     PIC 9      VALUE 0.                             \n          05 IO-STATUS-0403     PIC 999    VALUE 0.                             \n                                                                                \n       01 APPL-RESULT           PIC S9(9) COMP.                                 \n          88 APPL-AOK                      VALUE 0.                             \n          88 APPL-EOF                      VALUE 16.                            \n                                                                                \n       01 END-OF-FILE           PIC X(01)  VALUE 'N'.                           \n       01 ABCODE                PIC S9(9) BINARY.                               \n       01 TIMING                PIC S9(9) BINARY.                               \n                                                                                \n      *****************************************************************",
            "description": "This Working-Storage section defines the data structures used by the CBTRN03C transaction report program. It includes file status variables for all input and output files (transaction file, card cross-reference file, transaction type file, transaction category file, report file, and date parameter file). The section incorporates several copybooks (CVTRA05Y, CVACT03Y, CVTRA03Y, CVTRA04Y, CVTRA07Y) that likely contain record layouts for these files. It defines a structure for the date parameter record that stores the start and end dates for filtering transactions. Report-specific variables track page formatting (line counter, page size), financial totals (page total, account total, grand total), and the current card number being processed. Additional utility fields are defined for I/O status handling, binary data manipulation, and program flow control, including end-of-file indicators and application result codes."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.                                                            \n       FD  TRANSACT-FILE.                                                       \n       01 FD-TRANFILE-REC.                                                      \n          05 FD-TRANS-DATA      PIC X(304).                                     \n          05 FD-TRAN-PROC-TS    PIC X(26).                                      \n          05 FD-FILLER          PIC X(20).                                      \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-CARDXREF-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       FD  TRANTYPE-FILE.                                                       \n       01 FD-TRANTYPE-REC.                                                      \n          05 FD-TRAN-TYPE       PIC X(02).                                      \n          05 FD-TRAN-DATA       PIC X(58).                                      \n                                                                                \n       FD  TRANCATG-FILE.                                                       \n       01 FD-TRAN-CAT-RECORD.                                                   \n           05  FD-TRAN-CAT-KEY.                                                 \n              10  FD-TRAN-TYPE-CD                         PIC X(02).            \n              10  FD-TRAN-CAT-CD                          PIC 9(04).            \n           05  FD-TRAN-CAT-DATA                           PIC X(54).            \n                                                                                \n       FD  REPORT-FILE.                                                         \n       01 FD-REPTFILE-REC       PIC X(133).                                     \n                                                                                \n       FD  DATE-PARMS-FILE.                                                     \n       01 FD-DATEPARM-REC       PIC X(80).                                      \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVTRA05Y.                                                           \n       01 TRANFILE-STATUS.                                                      \n          05 TRANFILE-STAT1     PIC X.                                          \n          05 TRANFILE-STAT2     PIC X.                                          \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  CARDXREF-STATUS.                                                     \n           05  CARDXREF-STAT1      PIC X.                                       \n           05  CARDXREF-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA03Y.                                                           \n       01  TRANTYPE-STATUS.                                                     \n           05  TRANTYPE-STAT1      PIC X.                                       \n           05  TRANTYPE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA04Y.                                                           \n       01  TRANCATG-STATUS.                                                     \n           05  TRANCATG-STAT1      PIC X.                                       \n           05  TRANCATG-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA07Y.                                                           \n       01 TRANREPT-STATUS.                                                      \n           05 REPTFILE-STAT1     PIC X.                                         \n           05 REPTFILE-STAT2     PIC X.                                         \n                                                                                \n       01 DATEPARM-STATUS.                                                      \n           05 DATEPARM-STAT1     PIC X.                                         \n           05 DATEPARM-STAT2     PIC X.                                         \n                                                                                \n       01 WS-DATEPARM-RECORD.                                                   \n           05 WS-START-DATE      PIC X(10).                                     \n           05 FILLER             PIC X(01).                                     \n           05 WS-END-DATE        PIC X(10).                                     \n                                                                                \n       01 WS-REPORT-VARS.                                                       \n           05 WS-FIRST-TIME      PIC X      VALUE 'Y'.                          \n           05 WS-LINE-COUNTER    PIC 9(09) COMP-3                               \n                                            VALUE 0.                            \n           05 WS-PAGE-SIZE       PIC 9(03) COMP-3                               \n                                            VALUE 20.                           \n           05 WS-BLANK-LINE      PIC X(133) VALUE SPACES.                       \n           05 WS-PAGE-TOTAL      PIC S9(09)V99 VALUE 0.                         \n           05 WS-ACCOUNT-TOTAL   PIC S9(09)V99 VALUE 0.                         \n           05 WS-GRAND-TOTAL     PIC S9(09)V99 VALUE 0.                         \n           05 WS-CURR-CARD-NUM   PIC X(16) VALUE SPACES.                        \n                                                                                \n       01 IO-STATUS.                                                            \n          05 IO-STAT1           PIC X.                                          \n          05 IO-STAT2           PIC X.                                          \n       01 TWO-BYTES-BINARY      PIC 9(4) BINARY.                                \n       01 TWO-BYTES-ALPHA REDEFINES TWO-BYTES-BINARY.                           \n          05 TWO-BYTES-LEFT     PIC X.                                          \n          05 TWO-BYTES-RIGHT    PIC X.                                          \n       01 IO-STATUS-04.                                                         \n          05 IO-STATUS-0401     PIC 9      VALUE 0.                             \n          05 IO-STATUS-0403     PIC 999    VALUE 0.                             \n                                                                                \n       01 APPL-RESULT           PIC S9(9) COMP.                                 \n          88 APPL-AOK                      VALUE 0.                             \n          88 APPL-EOF                      VALUE 16.                            \n                                                                                \n       01 END-OF-FILE           PIC X(01)  VALUE 'N'.                           \n       01 ABCODE                PIC S9(9) BINARY.                               \n       01 TIMING                PIC S9(9) BINARY.                               \n                                                                                \n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0550-DATEPARM-READ",
            "code": "READ DATE-PARMS-FILE INTO WS-DATEPARM-RECORD                         \n           EVALUATE DATEPARM-STATUS                                             \n             WHEN '00'                                                          \n                 MOVE 0 TO APPL-RESULT                                          \n             WHEN '10'                                                          \n                 MOVE 16 TO APPL-RESULT                                         \n             WHEN OTHER                                                         \n                 MOVE 12 TO APPL-RESULT                                         \n           END-EVALUATE                                                         \n                                                                                \n           IF APPL-AOK                                                          \n              DISPLAY 'Reporting from ' WS-START-DATE                           \n                 ' to ' WS-END-DATE                                             \n           ELSE                                                                 \n              IF APPL-EOF                                                       \n                 MOVE 'Y' TO END-OF-FILE                                        \n              ELSE                                                              \n                 DISPLAY 'ERROR READING DATEPARM FILE'                          \n                 MOVE DATEPARM-STATUS TO IO-STATUS                              \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n              END-IF                                                            \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************",
            "description": "This paragraph reads a date parameter record from the DATE-PARMS-FILE into the WS-DATEPARM-RECORD work area. It evaluates the file status after the read operation: setting APPL-RESULT to 0 for successful reads, 16 for end-of-file conditions, and 12 for other errors. When the read is successful (APPL-AOK), it displays the date range (from WS-START-DATE to WS-END-DATE) that will be used for transaction filtering. If an end-of-file condition occurs, it sets the END-OF-FILE flag to 'Y'. For any other file errors, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then abends the program. This paragraph is crucial for establishing the date parameters that control which transactions will be included in the report."
          },
          {
            "name": "1000-TRANFILE-GET-NEXT",
            "code": "READ TRANSACT-FILE INTO TRAN-RECORD.                                 \n                                                                                \n           EVALUATE TRANFILE-STATUS                                             \n             WHEN '00'                                                          \n                 MOVE 0 TO APPL-RESULT                                          \n             WHEN '10'                                                          \n                 MOVE 16 TO APPL-RESULT                                         \n             WHEN OTHER                                                         \n                 MOVE 12 TO APPL-RESULT                                         \n           END-EVALUATE                                                         \n                                                                                \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              IF APPL-EOF                                                       \n                 MOVE 'Y' TO END-OF-FILE                                        \n              ELSE                                                              \n                 DISPLAY 'ERROR READING TRANSACTION FILE'                       \n                 MOVE TRANFILE-STATUS TO IO-STATUS                              \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n              END-IF                                                            \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the reading of transaction records from the TRANSACT-FILE. It evaluates the file status after each read operation and sets appropriate result codes: 0 for successful reads, 16 for end-of-file conditions, and 12 for other file errors. When a successful read occurs, processing continues normally. When end-of-file is reached, it sets the END-OF-FILE flag to 'Y'. For any other file errors, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This paragraph implements standard file handling with proper error detection and handling to ensure data integrity during report generation."
          },
          {
            "name": "1100-WRITE-TRANSACTION-REPORT",
            "code": "IF WS-FIRST-TIME = 'Y'                                               \n              MOVE 'N' TO WS-FIRST-TIME                                         \n              MOVE WS-START-DATE TO REPT-START-DATE                             \n              MOVE WS-END-DATE TO REPT-END-DATE                                 \n              PERFORM 1120-WRITE-HEADERS                                        \n           END-IF                                                               \n                                                                                \n           IF FUNCTION MOD(WS-LINE-COUNTER, WS-PAGE-SIZE) = 0                   \n              PERFORM 1110-WRITE-PAGE-TOTALS                                    \n              PERFORM 1120-WRITE-HEADERS                                        \n           END-IF                                                               \n                                                                                \n           ADD TRAN-AMT TO WS-PAGE-TOTAL                                        \n                           WS-ACCOUNT-TOTAL                                     \n           PERFORM 1120-WRITE-DETAIL                                            \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the writing of transaction records to the report. It first checks if this is the initial execution (WS-FIRST-TIME = 'Y'), and if so, initializes the report by setting the date range headers and writing the report headers. It then manages pagination by checking if the current line count has reached the page size limit, and if so, writes page totals and new headers. For each transaction, it accumulates the transaction amount into both page and account total accumulators before writing the transaction detail line to the report. The paragraph maintains proper report formatting and running totals throughout the report generation process."
          },
          {
            "name": "1110-WRITE-PAGE-TOTALS",
            "code": "MOVE WS-PAGE-TOTAL TO REPT-PAGE-TOTAL                                \n           MOVE REPORT-PAGE-TOTALS TO FD-REPTFILE-REC                           \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD WS-PAGE-TOTAL TO WS-GRAND-TOTAL                                  \n           MOVE 0 TO WS-PAGE-TOTAL                                              \n           ADD 1 TO WS-LINE-COUNTER                                             \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the writing of page total information to the transaction detail report. It moves the accumulated page total to the report line, writes the page totals record to the report file, adds the page total to the running grand total, and then resets the page total to zero for the next page. After writing the page totals, it increments the line counter and writes a transaction header to start the next page of transaction details. The paragraph is part of the report formatting logic that maintains running totals at different levels of the report hierarchy."
          },
          {
            "name": "1120-WRITE-ACCOUNT-TOTALS",
            "code": "MOVE WS-ACCOUNT-TOTAL   TO REPT-ACCOUNT-TOTAL                        \n           MOVE REPORT-ACCOUNT-TOTALS TO FD-REPTFILE-REC                        \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           MOVE 0 TO WS-ACCOUNT-TOTAL                                           \n           ADD 1 TO WS-LINE-COUNTER                                             \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph writes account total information to the transaction detail report. It formats the current account total amount into the report line, writes it to the report file, and then resets the account total to zero for the next account. After writing the account total line, it increments the line counter and writes a secondary header line to the report to prepare for the next account's transactions. This ensures that each account's transactions are properly summarized and visually separated in the final report."
          },
          {
            "name": "1110-WRITE-GRAND-TOTALS",
            "code": "MOVE WS-GRAND-TOTAL TO REPT-GRAND-TOTAL                              \n           MOVE REPORT-GRAND-TOTALS TO FD-REPTFILE-REC                          \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph writes the grand total amount to the report. It moves the accumulated grand total from the working storage variable WS-GRAND-TOTAL to the report line field REPT-GRAND-TOTAL, then transfers the formatted grand totals line to the report file record area (FD-REPTFILE-REC). It then calls the 1111-WRITE-REPORT-REC paragraph to physically write the record to the report file before exiting."
          },
          {
            "name": "1120-WRITE-HEADERS",
            "code": "MOVE REPORT-NAME-HEADER TO FD-REPTFILE-REC                           \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE WS-BLANK-LINE TO FD-REPTFILE-REC                                \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE TRANSACTION-HEADER-1 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the writing of report headers to the transaction detail report. It sequentially writes four lines to the report file: the report name header, a blank line for spacing, and two transaction header lines that likely contain column titles or report metadata. After writing each line, it increments the line counter to track the current position on the page. The paragraph uses the 1111-WRITE-REPORT-REC paragraph to perform the actual writing operation for each line."
          },
          {
            "name": "1111-WRITE-REPORT-REC",
            "code": "WRITE FD-REPTFILE-REC                                                \n           IF TRANREPT-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR WRITING REPTFILE'                                  \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the writing of records to the report file and implements error handling for the operation. After attempting to write a record to FD-REPTFILE-REC, it checks the status code. If the write operation is successful (status '00'), it sets APPL-RESULT to 0 indicating success. Otherwise, it sets APPL-RESULT to 12 indicating an error. If the application status is not OK (APPL-AOK), it displays an error message, captures the file status code, displays the I/O status details by calling the 9910-DISPLAY-IO-STATUS paragraph, and then terminates the program by calling the 9999-ABEND-PROGRAM paragraph. This ensures that any file writing errors are properly handled and reported before abnormal termination."
          },
          {
            "name": "1120-WRITE-DETAIL",
            "code": "INITIALIZE TRANSACTION-DETAIL-REPORT                                 \n           MOVE TRAN-ID TO TRAN-REPORT-TRANS-ID                                 \n           MOVE XREF-ACCT-ID TO TRAN-REPORT-ACCOUNT-ID                          \n           MOVE TRAN-TYPE-CD OF TRAN-RECORD TO TRAN-REPORT-TYPE-CD              \n           MOVE TRAN-TYPE-DESC TO TRAN-REPORT-TYPE-DESC                         \n           MOVE TRAN-CAT-CD OF TRAN-RECORD  TO TRAN-REPORT-CAT-CD               \n           MOVE TRAN-CAT-TYPE-DESC TO TRAN-REPORT-CAT-DESC                      \n           MOVE TRAN-SOURCE TO TRAN-REPORT-SOURCE                               \n           MOVE TRAN-AMT TO TRAN-REPORT-AMT                                     \n           MOVE TRANSACTION-DETAIL-REPORT TO FD-REPTFILE-REC                    \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph formats and writes a single transaction detail line to the report. It initializes the report line structure, then populates it with transaction information including the transaction ID, account ID, type code and description, category code and description, source, and amount. The data is sourced from the transaction record and related lookup files (cross-reference, transaction type, and category files). After formatting the line, it calls the 1111-WRITE-REPORT-REC paragraph to physically write the record to the report file and increments the line counter to track pagination."
          },
          {
            "name": "0000-TRANFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANSACT-FILE                                             \n           IF TRANFILE-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR OPENING TRANFILE'                                  \n              MOVE TRANFILE-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the transaction input file (TRANSACT-FILE) and implements error handling for the operation. It initially sets APPL-RESULT to 8 (indicating a pending operation), then attempts to open the file in INPUT mode. If the operation succeeds (status code '00'), it sets APPL-RESULT to 0 indicating success; otherwise, it sets APPL-RESULT to 12 indicating failure. When the file opens successfully, processing continues. If the open operation fails, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details (9910-DISPLAY-IO-STATUS), and then terminates the program by calling the 9999-ABEND-PROGRAM paragraph. This ensures the program doesn't proceed with invalid file access."
          },
          {
            "name": "0100-REPTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT REPORT-FILE                                              \n           IF TRANREPT-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR OPENING REPTFILE'                                  \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the output report file. It initializes APPL-RESULT to 8, then attempts to open the REPORT-FILE for output. If the operation is successful (status code '00'), it sets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12. The code then checks if the operation was successful (APPL-AOK condition). If not, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper error handling if the report file cannot be opened, preventing the program from continuing execution with an invalid output file."
          },
          {
            "name": "0200-CARDXREF-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  CARDXREF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'                           \n               MOVE CARDXREF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the card cross-reference file (XREF-FILE) used to retrieve account information. It sets an initial result code of 8, attempts to open the file in INPUT mode, and then checks the operation's success. If the file opens successfully (status '00'), it sets APPL-RESULT to 0 indicating success. Otherwise, it sets APPL-RESULT to 12 indicating failure. When a failure occurs, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This error handling ensures the program doesn't proceed without access to the critical cross-reference data needed for the transaction report."
          },
          {
            "name": "0300-TRANTYPE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANTYPE-FILE                                             \n           IF  TRANTYPE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION TYPE FILE'                    \n               MOVE TRANTYPE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the transaction type reference file. It sets an initial result code of 8, then attempts to open the TRANTYPE-FILE in INPUT mode. If the file opens successfully (status '00'), it sets the result code to 0; otherwise, it sets it to 12. If the operation is successful (APPL-AOK condition), processing continues. If there's an error, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures the program terminates properly if it cannot access the transaction type reference data needed for report generation."
          },
          {
            "name": "0400-TRANCATG-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANCATG-FILE                                             \n           IF  TRANCATG-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION CATG FILE'                    \n               MOVE TRANCATG-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the Transaction Category file (TRANCATG-FILE) in input mode. It sets an initial result code of 8, then attempts to open the file. If the operation is successful (status '00'), it sets the result code to 0; otherwise, it sets it to 12. If the result indicates success (APPL-AOK), processing continues; otherwise, it displays an error message about failing to open the Transaction Category file, calls a routine to display the I/O status code, and then abends the program. This ensures the program terminates properly if it cannot access the critical Transaction Category reference data needed for the report."
          },
          {
            "name": "0500-DATEPARM-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DATE-PARMS-FILE                                           \n           IF  DATEPARM-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DATE PARM FILE'                           \n               MOVE DATEPARM-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the date parameters input file. It initializes the application result code to 8, then attempts to open the DATE-PARMS-FILE. If the file opens successfully (status '00'), it sets the result code to 0; otherwise, it sets it to 12. The paragraph then checks if the operation was successful (APPL-AOK condition). If not, it displays an error message about the date parameter file, calls a routine to display the I/O status code, and then executes the program termination routine. This ensures the program cannot proceed without successfully accessing the date parameters that define the transaction date range for the report."
          },
          {
            "name": "1500-A-LOOKUP-XREF",
            "code": "READ XREF-FILE INTO CARD-XREF-RECORD                                 \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID CARD NUMBER : '  FD-XREF-CARD-NUM             \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph performs a lookup operation in the card cross-reference file to retrieve account information based on a card number. It reads a record from the XREF-FILE into the CARD-XREF-RECORD structure. If the card number is not found (INVALID KEY condition), the paragraph displays an error message with the invalid card number, sets an error status code of 23, displays the I/O status details, and terminates the program abnormally. This validation ensures that only transactions with valid card numbers are processed in the report."
          },
          {
            "name": "1500-B-LOOKUP-TRANTYPE",
            "code": "READ TRANTYPE-FILE INTO TRAN-TYPE-RECORD                             \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID TRANSACTION TYPE : '  FD-TRAN-TYPE            \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph performs a lookup operation to retrieve transaction type information from the TRANTYPE-FILE using the transaction type code stored in FD-TRAN-TYPE. If the lookup fails (INVALID KEY condition), the program displays an error message showing the invalid transaction type, sets an error status code of 23, displays the I/O status details, and terminates the program through the abend routine. The paragraph is essential for obtaining descriptive information about transaction types to include in the transaction detail report."
          },
          {
            "name": "1500-C-LOOKUP-TRANCATG",
            "code": "READ TRANCATG-FILE INTO TRAN-CAT-RECORD                              \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID TRAN CATG KEY : '  FD-TRAN-CAT-KEY            \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph performs a lookup operation on the transaction category file (TRANCATG-FILE) using the current transaction category key (FD-TRAN-CAT-KEY). If the key is not found in the file, the program displays an error message with the invalid key value, sets an error status code of 23, displays the I/O status details, and then terminates the program through the abend routine. When successful, the transaction category record is read into the TRAN-CAT-RECORD structure for further processing."
          },
          {
            "name": "9000-TRANFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE TRANSACT-FILE                                                  \n           IF TRANFILE-STATUS = '00'                                            \n              SUBTRACT APPL-RESULT FROM APPL-RESULT                             \n           ELSE                                                                 \n              ADD 12 TO ZERO GIVING APPL-RESULT                                 \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR CLOSING POSTED TRANSACTION FILE'                   \n              MOVE TRANFILE-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the transaction file (TRANSACT-FILE) with error handling. It sets an initial result code of 8, then attempts to close the file. If the close operation is successful (status '00'), it resets the result code to 0. If unsuccessful, it sets the result code to 12. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This ensures proper resource cleanup and provides meaningful error information if the transaction file cannot be closed properly."
          },
          {
            "name": "9100-REPTFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE REPORT-FILE                                                    \n           IF TRANREPT-STATUS = '00'                                            \n              SUBTRACT APPL-RESULT FROM APPL-RESULT                             \n           ELSE                                                                 \n              ADD 12 TO ZERO GIVING APPL-RESULT                                 \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR CLOSING REPORT FILE'                               \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the report output file in the transaction detail report program. It sets an initial result code of 8, then attempts to close the REPORT-FILE. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets the result code to 12. If the operation completes successfully (APPL-AOK condition), processing continues normally. If an error occurs, the paragraph displays an error message, captures the file status code, displays the I/O status details by calling the 9910-DISPLAY-IO-STATUS paragraph, and then terminates the program abnormally by calling the 9999-ABEND-PROGRAM paragraph. This ensures proper resource cleanup and error handling when closing the report file."
          },
          {
            "name": "9200-CARDXREF-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  CARDXREF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE CARDXREF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the card cross-reference file (XREF-FILE) with appropriate error handling. It initially sets APPL-RESULT to 8 (indicating a potential error), then attempts to close the file. If the close operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 to indicate a more severe error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This ensures proper resource cleanup and provides diagnostic information when file closing operations fail."
          },
          {
            "name": "9300-TRANTYPE-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANTYPE-FILE                                                  \n           IF  TRANTYPE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION TYPE FILE'                    \n               MOVE TRANTYPE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the transaction type file (TRANTYPE-FILE) with appropriate error handling. It initially sets the application result code to 8, then attempts to close the file. If the close operation is successful (status code '00'), it resets the result code to 0; otherwise, it sets it to 12. When the operation fails, the paragraph displays an error message, retrieves the I/O status code, calls a routine to display the status details, and then terminates the program abnormally. This ensures proper resource cleanup and provides meaningful error information if the file cannot be closed properly."
          },
          {
            "name": "9400-TRANCATG-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANCATG-FILE                                                  \n           IF  TRANCATG-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION CATG FILE'                    \n               MOVE TRANCATG-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the Transaction Category file (TRANCATG-FILE) with appropriate error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls routines to display the I/O status details and abnormally terminate the program. This is part of the program's cleanup process that ensures proper file handling before program termination."
          },
          {
            "name": "9500-DATEPARM-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DATE-PARMS-FILE                                                \n           IF  DATEPARM-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DATE PARM FILE'                           \n               MOVE DATEPARM-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the date parameters file and performs error handling. It initially sets a result code of 8, then attempts to close the DATE-PARMS-FILE. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets the result code to 12. If the operation was not successful, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper resource cleanup and appropriate error handling when the program is finished with the date parameters file."
          },
          {
            "name": "9999-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************",
            "description": "This paragraph handles abnormal program termination by displaying an \"ABENDING PROGRAM\" message, resetting the TIMING variable to zero, setting an abort code (ABCODE) to 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program termination. This is likely used as a last resort error handling mechanism when the program encounters a critical error that prevents further processing."
          },
          {
            "name": "9910-DISPLAY-IO-STATUS",
            "code": "IF IO-STATUS NOT NUMERIC                                             \n              OR IO-STAT1 = '9'                                                 \n              MOVE IO-STAT1 TO IO-STATUS-04(1:1)                                \n              MOVE 0 TO TWO-BYTES-BINARY                                        \n              MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                  \n              MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                           \n              DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                       \n           ELSE                                                                 \n              MOVE '0000' TO IO-STATUS-04                                       \n              MOVE IO-STATUS TO IO-STATUS-04(3:2)                               \n              DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                       \n           END-IF                                                               \n           EXIT.                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *",
            "description": "This paragraph handles the display of file I/O status codes in a standardized format. When an I/O operation encounters an error, this routine formats the status code for consistent display. If the status code is non-numeric or indicates a serious error (first digit is '9'), it processes the two status bytes separately, converting the second byte to binary format before display. Otherwise, it formats standard status codes by padding with leading zeros. In both cases, it displays the formatted status code with a descriptive prefix. This error handling routine helps with debugging file operations by providing clear, consistent error reporting throughout the program."
          }
        ],
        "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN03C'.                    \n           PERFORM 0000-TRANFILE-OPEN.                                          \n           PERFORM 0100-REPTFILE-OPEN.                                          \n           PERFORM 0200-CARDXREF-OPEN.                                          \n           PERFORM 0300-TRANTYPE-OPEN.                                          \n           PERFORM 0400-TRANCATG-OPEN.                                          \n           PERFORM 0500-DATEPARM-OPEN.                                          \n                                                                                \n           PERFORM 0550-DATEPARM-READ.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n             IF END-OF-FILE = 'N'                                               \n                PERFORM 1000-TRANFILE-GET-NEXT                                  \n                IF TRAN-PROC-TS (1:10) >= WS-START-DATE                         \n                   AND TRAN-PROC-TS (1:10) <= WS-END-DATE                       \n                   CONTINUE                                                     \n                ELSE                                                            \n                   NEXT SENTENCE                                                \n                END-IF                                                          \n                IF END-OF-FILE = 'N'                                            \n                   DISPLAY TRAN-RECORD                                          \n                   IF WS-CURR-CARD-NUM NOT= TRAN-CARD-NUM                       \n                     IF WS-FIRST-TIME = 'N'                                     \n                       PERFORM 1120-WRITE-ACCOUNT-TOTALS                        \n                     END-IF                                                     \n                     MOVE TRAN-CARD-NUM TO WS-CURR-CARD-NUM                     \n                     MOVE TRAN-CARD-NUM TO FD-XREF-CARD-NUM                     \n                     PERFORM 1500-A-LOOKUP-XREF                                 \n                   END-IF                                                       \n                   MOVE TRAN-TYPE-CD OF TRAN-RECORD TO FD-TRAN-TYPE             \n                   PERFORM 1500-B-LOOKUP-TRANTYPE                               \n                   MOVE TRAN-TYPE-CD OF TRAN-RECORD                             \n                     TO FD-TRAN-TYPE-CD OF FD-TRAN-CAT-KEY                      \n                   MOVE TRAN-CAT-CD OF TRAN-RECORD                              \n                     TO FD-TRAN-CAT-CD OF FD-TRAN-CAT-KEY                       \n                   PERFORM 1500-C-LOOKUP-TRANCATG                               \n                   PERFORM 1100-WRITE-TRANSACTION-REPORT                        \n                ELSE                                                            \n                 DISPLAY 'TRAN-AMT ' TRAN-AMT                                   \n                 DISPLAY 'WS-PAGE-TOTAL'  WS-PAGE-TOTAL                         \n                 ADD TRAN-AMT TO WS-PAGE-TOTAL                                  \n                                 WS-ACCOUNT-TOTAL                               \n                 PERFORM 1110-WRITE-PAGE-TOTALS                                 \n                 PERFORM 1110-WRITE-GRAND-TOTALS                                \n                END-IF                                                          \n             END-IF                                                             \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-TRANFILE-CLOSE.                                         \n           PERFORM 9100-REPTFILE-CLOSE.                                         \n           PERFORM 9200-CARDXREF-CLOSE.                                         \n           PERFORM 9300-TRANTYPE-CLOSE.                                         \n           PERFORM 9400-TRANCATG-CLOSE.                                         \n           PERFORM 9500-DATEPARM-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN03C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      * Read the date parameter file.                                           \n       0550-DATEPARM-READ.                                                      \n           READ DATE-PARMS-FILE INTO WS-DATEPARM-RECORD                         \n           EVALUATE DATEPARM-STATUS                                             \n             WHEN '00'                                                          \n                 MOVE 0 TO APPL-RESULT                                          \n             WHEN '10'                                                          \n                 MOVE 16 TO APPL-RESULT                                         \n             WHEN OTHER                                                         \n                 MOVE 12 TO APPL-RESULT                                         \n           END-EVALUATE                                                         \n                                                                                \n           IF APPL-AOK                                                          \n              DISPLAY 'Reporting from ' WS-START-DATE                           \n                 ' to ' WS-END-DATE                                             \n           ELSE                                                                 \n              IF APPL-EOF                                                       \n                 MOVE 'Y' TO END-OF-FILE                                        \n              ELSE                                                              \n                 DISPLAY 'ERROR READING DATEPARM FILE'                          \n                 MOVE DATEPARM-STATUS TO IO-STATUS                              \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n              END-IF                                                            \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-TRANFILE-GET-NEXT.                                                  \n           READ TRANSACT-FILE INTO TRAN-RECORD.                                 \n                                                                                \n           EVALUATE TRANFILE-STATUS                                             \n             WHEN '00'                                                          \n                 MOVE 0 TO APPL-RESULT                                          \n             WHEN '10'                                                          \n                 MOVE 16 TO APPL-RESULT                                         \n             WHEN OTHER                                                         \n                 MOVE 12 TO APPL-RESULT                                         \n           END-EVALUATE                                                         \n                                                                                \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              IF APPL-EOF                                                       \n                 MOVE 'Y' TO END-OF-FILE                                        \n              ELSE                                                              \n                 DISPLAY 'ERROR READING TRANSACTION FILE'                       \n                 MOVE TRANFILE-STATUS TO IO-STATUS                              \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n              END-IF                                                            \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1100-WRITE-TRANSACTION-REPORT.                                           \n           IF WS-FIRST-TIME = 'Y'                                               \n              MOVE 'N' TO WS-FIRST-TIME                                         \n              MOVE WS-START-DATE TO REPT-START-DATE                             \n              MOVE WS-END-DATE TO REPT-END-DATE                                 \n              PERFORM 1120-WRITE-HEADERS                                        \n           END-IF                                                               \n                                                                                \n           IF FUNCTION MOD(WS-LINE-COUNTER, WS-PAGE-SIZE) = 0                   \n              PERFORM 1110-WRITE-PAGE-TOTALS                                    \n              PERFORM 1120-WRITE-HEADERS                                        \n           END-IF                                                               \n                                                                                \n           ADD TRAN-AMT TO WS-PAGE-TOTAL                                        \n                           WS-ACCOUNT-TOTAL                                     \n           PERFORM 1120-WRITE-DETAIL                                            \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1110-WRITE-PAGE-TOTALS.                                                  \n           MOVE WS-PAGE-TOTAL TO REPT-PAGE-TOTAL                                \n           MOVE REPORT-PAGE-TOTALS TO FD-REPTFILE-REC                           \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD WS-PAGE-TOTAL TO WS-GRAND-TOTAL                                  \n           MOVE 0 TO WS-PAGE-TOTAL                                              \n           ADD 1 TO WS-LINE-COUNTER                                             \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1120-WRITE-ACCOUNT-TOTALS.                                               \n           MOVE WS-ACCOUNT-TOTAL   TO REPT-ACCOUNT-TOTAL                        \n           MOVE REPORT-ACCOUNT-TOTALS TO FD-REPTFILE-REC                        \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           MOVE 0 TO WS-ACCOUNT-TOTAL                                           \n           ADD 1 TO WS-LINE-COUNTER                                             \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1110-WRITE-GRAND-TOTALS.                                                 \n           MOVE WS-GRAND-TOTAL TO REPT-GRAND-TOTAL                              \n           MOVE REPORT-GRAND-TOTALS TO FD-REPTFILE-REC                          \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1120-WRITE-HEADERS.                                                      \n           MOVE REPORT-NAME-HEADER TO FD-REPTFILE-REC                           \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE WS-BLANK-LINE TO FD-REPTFILE-REC                                \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE TRANSACTION-HEADER-1 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1111-WRITE-REPORT-REC.                                                   \n                                                                                \n           WRITE FD-REPTFILE-REC                                                \n           IF TRANREPT-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR WRITING REPTFILE'                                  \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       1120-WRITE-DETAIL.                                                       \n           INITIALIZE TRANSACTION-DETAIL-REPORT                                 \n           MOVE TRAN-ID TO TRAN-REPORT-TRANS-ID                                 \n           MOVE XREF-ACCT-ID TO TRAN-REPORT-ACCOUNT-ID                          \n           MOVE TRAN-TYPE-CD OF TRAN-RECORD TO TRAN-REPORT-TYPE-CD              \n           MOVE TRAN-TYPE-DESC TO TRAN-REPORT-TYPE-DESC                         \n           MOVE TRAN-CAT-CD OF TRAN-RECORD  TO TRAN-REPORT-CAT-CD               \n           MOVE TRAN-CAT-TYPE-DESC TO TRAN-REPORT-CAT-DESC                      \n           MOVE TRAN-SOURCE TO TRAN-REPORT-SOURCE                               \n           MOVE TRAN-AMT TO TRAN-REPORT-AMT                                     \n           MOVE TRANSACTION-DETAIL-REPORT TO FD-REPTFILE-REC                    \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-TRANFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANSACT-FILE                                             \n           IF TRANFILE-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR OPENING TRANFILE'                                  \n              MOVE TRANFILE-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0100-REPTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT REPORT-FILE                                              \n           IF TRANREPT-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR OPENING REPTFILE'                                  \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0200-CARDXREF-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  CARDXREF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'                           \n               MOVE CARDXREF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0300-TRANTYPE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANTYPE-FILE                                             \n           IF  TRANTYPE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION TYPE FILE'                    \n               MOVE TRANTYPE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0400-TRANCATG-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANCATG-FILE                                             \n           IF  TRANCATG-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION CATG FILE'                    \n               MOVE TRANCATG-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0500-DATEPARM-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DATE-PARMS-FILE                                           \n           IF  DATEPARM-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DATE PARM FILE'                           \n               MOVE DATEPARM-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1500-A-LOOKUP-XREF.                                                      \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID CARD NUMBER : '  FD-XREF-CARD-NUM             \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1500-B-LOOKUP-TRANTYPE.                                                  \n           READ TRANTYPE-FILE INTO TRAN-TYPE-RECORD                             \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID TRANSACTION TYPE : '  FD-TRAN-TYPE            \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1500-C-LOOKUP-TRANCATG.                                                  \n           READ TRANCATG-FILE INTO TRAN-CAT-RECORD                              \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID TRAN CATG KEY : '  FD-TRAN-CAT-KEY            \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-TRANFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE TRANSACT-FILE                                                  \n           IF TRANFILE-STATUS = '00'                                            \n              SUBTRACT APPL-RESULT FROM APPL-RESULT                             \n           ELSE                                                                 \n              ADD 12 TO ZERO GIVING APPL-RESULT                                 \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR CLOSING POSTED TRANSACTION FILE'                   \n              MOVE TRANFILE-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9100-REPTFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE REPORT-FILE                                                    \n           IF TRANREPT-STATUS = '00'                                            \n              SUBTRACT APPL-RESULT FROM APPL-RESULT                             \n           ELSE                                                                 \n              ADD 12 TO ZERO GIVING APPL-RESULT                                 \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR CLOSING REPORT FILE'                               \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9200-CARDXREF-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  CARDXREF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE CARDXREF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9300-TRANTYPE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANTYPE-FILE                                                  \n           IF  TRANTYPE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION TYPE FILE'                    \n               MOVE TRANTYPE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9400-TRANCATG-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANCATG-FILE                                                  \n           IF  TRANCATG-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION CATG FILE'                    \n               MOVE TRANCATG-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9500-DATEPARM-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DATE-PARMS-FILE                                                \n           IF  DATEPARM-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DATE PARM FILE'                           \n               MOVE DATEPARM-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF IO-STATUS NOT NUMERIC                                             \n              OR IO-STAT1 = '9'                                                 \n              MOVE IO-STAT1 TO IO-STATUS-04(1:1)                                \n              MOVE 0 TO TWO-BYTES-BINARY                                        \n              MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                  \n              MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                           \n              DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                       \n           ELSE                                                                 \n              MOVE '0000' TO IO-STATUS-04                                       \n              MOVE IO-STATUS TO IO-STATUS-04(3:2)                               \n              DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                       \n           END-IF                                                               \n           EXIT.                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *"
      },
      "description": "This batch COBOL program (CBTRN03C) generates a transaction detail report for the CardDemo application. The program reads transaction records from a sequential file and filters them based on a date range specified in a parameter file. For each transaction within the date range, it looks up additional information from three indexed files: a card cross-reference file to get account information, a transaction type file for transaction descriptions, and a transaction category file for category descriptions. The program organizes the report by card number, calculating and displaying page totals, account totals, and grand totals for transaction amounts. The report includes transaction details such as transaction ID, account ID, transaction type, category, source, and amount. Error handling is implemented throughout the program to manage file access issues and invalid data conditions.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBTRN03C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : Print the transaction detail report.     \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.    CBTRN03C.                                                 \n       AUTHOR.        AWS.                                                      \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n       FILE-CONTROL.                                                            \n           SELECT TRANSACT-FILE ASSIGN TO TRANFILE                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  FILE STATUS  IS TRANFILE-STATUS.                              \n                                                                                \n           SELECT XREF-FILE ASSIGN TO CARDXREF                                  \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  FILE STATUS  IS CARDXREF-STATUS.                              \n                                                                                \n           SELECT TRANTYPE-FILE ASSIGN TO TRANTYPE                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRAN-TYPE                                  \n                  FILE STATUS  IS TRANTYPE-STATUS.                              \n                                                                                \n           SELECT TRANCATG-FILE ASSIGN TO TRANCATG                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRAN-CAT-KEY                               \n                  FILE STATUS  IS TRANCATG-STATUS.                              \n                                                                                \n           SELECT REPORT-FILE ASSIGN TO TRANREPT                                \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  FILE STATUS  IS TRANREPT-STATUS.                              \n                                                                                \n           SELECT DATE-PARMS-FILE ASSIGN TO DATEPARM                            \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  FILE STATUS  IS DATEPARM-STATUS.                              \n      *                                                                         \n       DATA DIVISION.                                                           \n       FILE SECTION.                                                            \n       FD  TRANSACT-FILE.                                                       \n       01 FD-TRANFILE-REC.                                                      \n          05 FD-TRANS-DATA      PIC X(304).                                     \n          05 FD-TRAN-PROC-TS    PIC X(26).                                      \n          05 FD-FILLER          PIC X(20).                                      \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-CARDXREF-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       FD  TRANTYPE-FILE.                                                       \n       01 FD-TRANTYPE-REC.                                                      \n          05 FD-TRAN-TYPE       PIC X(02).                                      \n          05 FD-TRAN-DATA       PIC X(58).                                      \n                                                                                \n       FD  TRANCATG-FILE.                                                       \n       01 FD-TRAN-CAT-RECORD.                                                   \n           05  FD-TRAN-CAT-KEY.                                                 \n              10  FD-TRAN-TYPE-CD                         PIC X(02).            \n              10  FD-TRAN-CAT-CD                          PIC 9(04).            \n           05  FD-TRAN-CAT-DATA                           PIC X(54).            \n                                                                                \n       FD  REPORT-FILE.                                                         \n       01 FD-REPTFILE-REC       PIC X(133).                                     \n                                                                                \n       FD  DATE-PARMS-FILE.                                                     \n       01 FD-DATEPARM-REC       PIC X(80).                                      \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVTRA05Y.                                                           \n       01 TRANFILE-STATUS.                                                      \n          05 TRANFILE-STAT1     PIC X.                                          \n          05 TRANFILE-STAT2     PIC X.                                          \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  CARDXREF-STATUS.                                                     \n           05  CARDXREF-STAT1      PIC X.                                       \n           05  CARDXREF-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA03Y.                                                           \n       01  TRANTYPE-STATUS.                                                     \n           05  TRANTYPE-STAT1      PIC X.                                       \n           05  TRANTYPE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA04Y.                                                           \n       01  TRANCATG-STATUS.                                                     \n           05  TRANCATG-STAT1      PIC X.                                       \n           05  TRANCATG-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA07Y.                                                           \n       01 TRANREPT-STATUS.                                                      \n           05 REPTFILE-STAT1     PIC X.                                         \n           05 REPTFILE-STAT2     PIC X.                                         \n                                                                                \n       01 DATEPARM-STATUS.                                                      \n           05 DATEPARM-STAT1     PIC X.                                         \n           05 DATEPARM-STAT2     PIC X.                                         \n                                                                                \n       01 WS-DATEPARM-RECORD.                                                   \n           05 WS-START-DATE      PIC X(10).                                     \n           05 FILLER             PIC X(01).                                     \n           05 WS-END-DATE        PIC X(10).                                     \n                                                                                \n       01 WS-REPORT-VARS.                                                       \n           05 WS-FIRST-TIME      PIC X      VALUE 'Y'.                          \n           05 WS-LINE-COUNTER    PIC 9(09) COMP-3                               \n                                            VALUE 0.                            \n           05 WS-PAGE-SIZE       PIC 9(03) COMP-3                               \n                                            VALUE 20.                           \n           05 WS-BLANK-LINE      PIC X(133) VALUE SPACES.                       \n           05 WS-PAGE-TOTAL      PIC S9(09)V99 VALUE 0.                         \n           05 WS-ACCOUNT-TOTAL   PIC S9(09)V99 VALUE 0.                         \n           05 WS-GRAND-TOTAL     PIC S9(09)V99 VALUE 0.                         \n           05 WS-CURR-CARD-NUM   PIC X(16) VALUE SPACES.                        \n                                                                                \n       01 IO-STATUS.                                                            \n          05 IO-STAT1           PIC X.                                          \n          05 IO-STAT2           PIC X.                                          \n       01 TWO-BYTES-BINARY      PIC 9(4) BINARY.                                \n       01 TWO-BYTES-ALPHA REDEFINES TWO-BYTES-BINARY.                           \n          05 TWO-BYTES-LEFT     PIC X.                                          \n          05 TWO-BYTES-RIGHT    PIC X.                                          \n       01 IO-STATUS-04.                                                         \n          05 IO-STATUS-0401     PIC 9      VALUE 0.                             \n          05 IO-STATUS-0403     PIC 999    VALUE 0.                             \n                                                                                \n       01 APPL-RESULT           PIC S9(9) COMP.                                 \n          88 APPL-AOK                      VALUE 0.                             \n          88 APPL-EOF                      VALUE 16.                            \n                                                                                \n       01 END-OF-FILE           PIC X(01)  VALUE 'N'.                           \n       01 ABCODE                PIC S9(9) BINARY.                               \n       01 TIMING                PIC S9(9) BINARY.                               \n                                                                                \n      *****************************************************************         \n       PROCEDURE DIVISION.                                                      \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN03C'.                    \n           PERFORM 0000-TRANFILE-OPEN.                                          \n           PERFORM 0100-REPTFILE-OPEN.                                          \n           PERFORM 0200-CARDXREF-OPEN.                                          \n           PERFORM 0300-TRANTYPE-OPEN.                                          \n           PERFORM 0400-TRANCATG-OPEN.                                          \n           PERFORM 0500-DATEPARM-OPEN.                                          \n                                                                                \n           PERFORM 0550-DATEPARM-READ.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n             IF END-OF-FILE = 'N'                                               \n                PERFORM 1000-TRANFILE-GET-NEXT                                  \n                IF TRAN-PROC-TS (1:10) >= WS-START-DATE                         \n                   AND TRAN-PROC-TS (1:10) <= WS-END-DATE                       \n                   CONTINUE                                                     \n                ELSE                                                            \n                   NEXT SENTENCE                                                \n                END-IF                                                          \n                IF END-OF-FILE = 'N'                                            \n                   DISPLAY TRAN-RECORD                                          \n                   IF WS-CURR-CARD-NUM NOT= TRAN-CARD-NUM                       \n                     IF WS-FIRST-TIME = 'N'                                     \n                       PERFORM 1120-WRITE-ACCOUNT-TOTALS                        \n                     END-IF                                                     \n                     MOVE TRAN-CARD-NUM TO WS-CURR-CARD-NUM                     \n                     MOVE TRAN-CARD-NUM TO FD-XREF-CARD-NUM                     \n                     PERFORM 1500-A-LOOKUP-XREF                                 \n                   END-IF                                                       \n                   MOVE TRAN-TYPE-CD OF TRAN-RECORD TO FD-TRAN-TYPE             \n                   PERFORM 1500-B-LOOKUP-TRANTYPE                               \n                   MOVE TRAN-TYPE-CD OF TRAN-RECORD                             \n                     TO FD-TRAN-TYPE-CD OF FD-TRAN-CAT-KEY                      \n                   MOVE TRAN-CAT-CD OF TRAN-RECORD                              \n                     TO FD-TRAN-CAT-CD OF FD-TRAN-CAT-KEY                       \n                   PERFORM 1500-C-LOOKUP-TRANCATG                               \n                   PERFORM 1100-WRITE-TRANSACTION-REPORT                        \n                ELSE                                                            \n                 DISPLAY 'TRAN-AMT ' TRAN-AMT                                   \n                 DISPLAY 'WS-PAGE-TOTAL'  WS-PAGE-TOTAL                         \n                 ADD TRAN-AMT TO WS-PAGE-TOTAL                                  \n                                 WS-ACCOUNT-TOTAL                               \n                 PERFORM 1110-WRITE-PAGE-TOTALS                                 \n                 PERFORM 1110-WRITE-GRAND-TOTALS                                \n                END-IF                                                          \n             END-IF                                                             \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-TRANFILE-CLOSE.                                         \n           PERFORM 9100-REPTFILE-CLOSE.                                         \n           PERFORM 9200-CARDXREF-CLOSE.                                         \n           PERFORM 9300-TRANTYPE-CLOSE.                                         \n           PERFORM 9400-TRANCATG-CLOSE.                                         \n           PERFORM 9500-DATEPARM-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN03C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      * Read the date parameter file.                                           \n       0550-DATEPARM-READ.                                                      \n           READ DATE-PARMS-FILE INTO WS-DATEPARM-RECORD                         \n           EVALUATE DATEPARM-STATUS                                             \n             WHEN '00'                                                          \n                 MOVE 0 TO APPL-RESULT                                          \n             WHEN '10'                                                          \n                 MOVE 16 TO APPL-RESULT                                         \n             WHEN OTHER                                                         \n                 MOVE 12 TO APPL-RESULT                                         \n           END-EVALUATE                                                         \n                                                                                \n           IF APPL-AOK                                                          \n              DISPLAY 'Reporting from ' WS-START-DATE                           \n                 ' to ' WS-END-DATE                                             \n           ELSE                                                                 \n              IF APPL-EOF                                                       \n                 MOVE 'Y' TO END-OF-FILE                                        \n              ELSE                                                              \n                 DISPLAY 'ERROR READING DATEPARM FILE'                          \n                 MOVE DATEPARM-STATUS TO IO-STATUS                              \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n              END-IF                                                            \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-TRANFILE-GET-NEXT.                                                  \n           READ TRANSACT-FILE INTO TRAN-RECORD.                                 \n                                                                                \n           EVALUATE TRANFILE-STATUS                                             \n             WHEN '00'                                                          \n                 MOVE 0 TO APPL-RESULT                                          \n             WHEN '10'                                                          \n                 MOVE 16 TO APPL-RESULT                                         \n             WHEN OTHER                                                         \n                 MOVE 12 TO APPL-RESULT                                         \n           END-EVALUATE                                                         \n                                                                                \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              IF APPL-EOF                                                       \n                 MOVE 'Y' TO END-OF-FILE                                        \n              ELSE                                                              \n                 DISPLAY 'ERROR READING TRANSACTION FILE'                       \n                 MOVE TRANFILE-STATUS TO IO-STATUS                              \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n              END-IF                                                            \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1100-WRITE-TRANSACTION-REPORT.                                           \n           IF WS-FIRST-TIME = 'Y'                                               \n              MOVE 'N' TO WS-FIRST-TIME                                         \n              MOVE WS-START-DATE TO REPT-START-DATE                             \n              MOVE WS-END-DATE TO REPT-END-DATE                                 \n              PERFORM 1120-WRITE-HEADERS                                        \n           END-IF                                                               \n                                                                                \n           IF FUNCTION MOD(WS-LINE-COUNTER, WS-PAGE-SIZE) = 0                   \n              PERFORM 1110-WRITE-PAGE-TOTALS                                    \n              PERFORM 1120-WRITE-HEADERS                                        \n           END-IF                                                               \n                                                                                \n           ADD TRAN-AMT TO WS-PAGE-TOTAL                                        \n                           WS-ACCOUNT-TOTAL                                     \n           PERFORM 1120-WRITE-DETAIL                                            \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1110-WRITE-PAGE-TOTALS.                                                  \n           MOVE WS-PAGE-TOTAL TO REPT-PAGE-TOTAL                                \n           MOVE REPORT-PAGE-TOTALS TO FD-REPTFILE-REC                           \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD WS-PAGE-TOTAL TO WS-GRAND-TOTAL                                  \n           MOVE 0 TO WS-PAGE-TOTAL                                              \n           ADD 1 TO WS-LINE-COUNTER                                             \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1120-WRITE-ACCOUNT-TOTALS.                                               \n           MOVE WS-ACCOUNT-TOTAL   TO REPT-ACCOUNT-TOTAL                        \n           MOVE REPORT-ACCOUNT-TOTALS TO FD-REPTFILE-REC                        \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           MOVE 0 TO WS-ACCOUNT-TOTAL                                           \n           ADD 1 TO WS-LINE-COUNTER                                             \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1110-WRITE-GRAND-TOTALS.                                                 \n           MOVE WS-GRAND-TOTAL TO REPT-GRAND-TOTAL                              \n           MOVE REPORT-GRAND-TOTALS TO FD-REPTFILE-REC                          \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1120-WRITE-HEADERS.                                                      \n           MOVE REPORT-NAME-HEADER TO FD-REPTFILE-REC                           \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE WS-BLANK-LINE TO FD-REPTFILE-REC                                \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE TRANSACTION-HEADER-1 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           MOVE TRANSACTION-HEADER-2 TO FD-REPTFILE-REC                         \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1111-WRITE-REPORT-REC.                                                   \n                                                                                \n           WRITE FD-REPTFILE-REC                                                \n           IF TRANREPT-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR WRITING REPTFILE'                                  \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       1120-WRITE-DETAIL.                                                       \n           INITIALIZE TRANSACTION-DETAIL-REPORT                                 \n           MOVE TRAN-ID TO TRAN-REPORT-TRANS-ID                                 \n           MOVE XREF-ACCT-ID TO TRAN-REPORT-ACCOUNT-ID                          \n           MOVE TRAN-TYPE-CD OF TRAN-RECORD TO TRAN-REPORT-TYPE-CD              \n           MOVE TRAN-TYPE-DESC TO TRAN-REPORT-TYPE-DESC                         \n           MOVE TRAN-CAT-CD OF TRAN-RECORD  TO TRAN-REPORT-CAT-CD               \n           MOVE TRAN-CAT-TYPE-DESC TO TRAN-REPORT-CAT-DESC                      \n           MOVE TRAN-SOURCE TO TRAN-REPORT-SOURCE                               \n           MOVE TRAN-AMT TO TRAN-REPORT-AMT                                     \n           MOVE TRANSACTION-DETAIL-REPORT TO FD-REPTFILE-REC                    \n           PERFORM 1111-WRITE-REPORT-REC                                        \n           ADD 1 TO WS-LINE-COUNTER                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-TRANFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANSACT-FILE                                             \n           IF TRANFILE-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR OPENING TRANFILE'                                  \n              MOVE TRANFILE-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0100-REPTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT REPORT-FILE                                              \n           IF TRANREPT-STATUS = '00'                                            \n              MOVE 0 TO APPL-RESULT                                             \n           ELSE                                                                 \n              MOVE 12 TO APPL-RESULT                                            \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR OPENING REPTFILE'                                  \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0200-CARDXREF-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  CARDXREF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'                           \n               MOVE CARDXREF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0300-TRANTYPE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANTYPE-FILE                                             \n           IF  TRANTYPE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION TYPE FILE'                    \n               MOVE TRANTYPE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0400-TRANCATG-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TRANCATG-FILE                                             \n           IF  TRANCATG-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION CATG FILE'                    \n               MOVE TRANCATG-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0500-DATEPARM-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DATE-PARMS-FILE                                           \n           IF  DATEPARM-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DATE PARM FILE'                           \n               MOVE DATEPARM-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1500-A-LOOKUP-XREF.                                                      \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID CARD NUMBER : '  FD-XREF-CARD-NUM             \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1500-B-LOOKUP-TRANTYPE.                                                  \n           READ TRANTYPE-FILE INTO TRAN-TYPE-RECORD                             \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID TRANSACTION TYPE : '  FD-TRAN-TYPE            \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1500-C-LOOKUP-TRANCATG.                                                  \n           READ TRANCATG-FILE INTO TRAN-CAT-RECORD                              \n              INVALID KEY                                                       \n                 DISPLAY 'INVALID TRAN CATG KEY : '  FD-TRAN-CAT-KEY            \n                 MOVE 23 TO IO-STATUS                                           \n                 PERFORM 9910-DISPLAY-IO-STATUS                                 \n                 PERFORM 9999-ABEND-PROGRAM                                     \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-TRANFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE TRANSACT-FILE                                                  \n           IF TRANFILE-STATUS = '00'                                            \n              SUBTRACT APPL-RESULT FROM APPL-RESULT                             \n           ELSE                                                                 \n              ADD 12 TO ZERO GIVING APPL-RESULT                                 \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR CLOSING POSTED TRANSACTION FILE'                   \n              MOVE TRANFILE-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9100-REPTFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE REPORT-FILE                                                    \n           IF TRANREPT-STATUS = '00'                                            \n              SUBTRACT APPL-RESULT FROM APPL-RESULT                             \n           ELSE                                                                 \n              ADD 12 TO ZERO GIVING APPL-RESULT                                 \n           END-IF                                                               \n           IF APPL-AOK                                                          \n              CONTINUE                                                          \n           ELSE                                                                 \n              DISPLAY 'ERROR CLOSING REPORT FILE'                               \n              MOVE TRANREPT-STATUS TO IO-STATUS                                 \n              PERFORM 9910-DISPLAY-IO-STATUS                                    \n              PERFORM 9999-ABEND-PROGRAM                                        \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9200-CARDXREF-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  CARDXREF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE CARDXREF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9300-TRANTYPE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANTYPE-FILE                                                  \n           IF  TRANTYPE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION TYPE FILE'                    \n               MOVE TRANTYPE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9400-TRANCATG-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANCATG-FILE                                                  \n           IF  TRANCATG-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION CATG FILE'                    \n               MOVE TRANCATG-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9500-DATEPARM-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DATE-PARMS-FILE                                                \n           IF  DATEPARM-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DATE PARM FILE'                           \n               MOVE DATEPARM-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF IO-STATUS NOT NUMERIC                                             \n              OR IO-STAT1 = '9'                                                 \n              MOVE IO-STAT1 TO IO-STATUS-04(1:1)                                \n              MOVE 0 TO TWO-BYTES-BINARY                                        \n              MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                  \n              MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                           \n              DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                       \n           ELSE                                                                 \n              MOVE '0000' TO IO-STATUS-04                                       \n              MOVE IO-STATUS TO IO-STATUS-04(3:2)                               \n              DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                       \n           END-IF                                                               \n           EXIT.                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVTRA04Y",
        "CVTRA05Y",
        "CVACT03Y",
        "CVTRA03Y",
        "CVTRA07Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as Main Program\n    participant DateParm as Date Parameters File\n    participant TranFile as Transaction File\n    participant XrefFile as Card Cross-Reference File\n    participant TypeFile as Transaction Type File\n    participant CatgFile as Transaction Category File\n    participant ReptFile as Report File\n    \n    Main->>DateParm: 0500-DATEPARM-OPEN\n    Main->>TranFile: 0000-TRANFILE-OPEN\n    Main->>XrefFile: 0200-CARDXREF-OPEN\n    Main->>TypeFile: 0300-TRANTYPE-OPEN\n    Main->>CatgFile: 0400-TRANCATG-OPEN\n    Main->>ReptFile: 0100-REPTFILE-OPEN\n    \n    Main->>DateParm: 0550-DATEPARM-READ\n    DateParm-->>Main: Return date range parameters\n    \n    rect rgb(240, 240, 240)\n        Note over Main,ReptFile: Main Processing Loop\n        loop Until End-Of-File\n            Main->>TranFile: 1000-TRANFILE-GET-NEXT\n            TranFile-->>Main: Return transaction record\n            \n            alt Transaction date within range\n                Main->>XrefFile: 1500-A-LOOKUP-XREF\n                XrefFile-->>Main: Return account information\n                \n                Main->>TypeFile: 1500-B-LOOKUP-TRANTYPE\n                TypeFile-->>Main: Return transaction type description\n                \n                Main->>CatgFile: 1500-C-LOOKUP-TRANCATG\n                CatgFile-->>Main: Return category description\n                \n                alt First transaction or new card number\n                    Main->>ReptFile: 1120-WRITE-HEADERS\n                end\n                \n                alt Page limit reached\n                    Main->>ReptFile: 1110-WRITE-PAGE-TOTALS\n                    Main->>ReptFile: 1120-WRITE-HEADERS\n                end\n                \n                alt New account number\n                    Main->>ReptFile: 1120-WRITE-ACCOUNT-TOTALS\n                end\n                \n                Main->>ReptFile: 1120-WRITE-DETAIL\n            end\n        end\n    end\n    \n    Main->>ReptFile: 1110-WRITE-PAGE-TOTALS\n    Main->>ReptFile: 1110-WRITE-GRAND-TOTALS\n    \n    Main->>DateParm: 9500-DATEPARM-CLOSE\n    Main->>TranFile: 9000-TRANFILE-CLOSE\n    Main->>XrefFile: 9200-CARDXREF-CLOSE\n    Main->>TypeFile: 9300-TRANTYPE-CLOSE\n    Main->>CatgFile: 9400-TRANCATG-CLOSE\n    Main->>ReptFile: 9100-REPTFILE-CLOSE"
    },
    {
      "id": "COTRN00C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration details for the COTRN00C program, including file assignments, special names, and system dependencies. However, the provided snippet is empty, indicating that this program either doesn't require specific configuration settings in its CONFIGURATION SECTION or these settings might be defined elsewhere in the program structure. In CICS applications like this transaction management program, many configuration details are often handled through CICS resource definitions rather than within the COBOL code itself."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.\n           88 TRANSACT-EOF                       VALUE 'Y'.\n           88 TRANSACT-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-PAGE-NUM                PIC S9(04) COMP VALUE ZEROS.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n\n\n\n       COPY COCOM01Y.\n          05 CDEMO-CT00-INFO.\n             10 CDEMO-CT00-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT00-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT00-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT00-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working Storage Section defines the key variables and data structures used in the COTRN00C transaction listing program. It includes program identifiers, status flags for error handling and file processing, counters for pagination, and work fields for transaction data manipulation. The section incorporates several copybooks: COCOM01Y (containing communication area fields for maintaining state between screens, including transaction selection tracking and pagination information), COTRN00 (likely the screen map definition), and various utility copybooks for titles, dates, messages, and transaction record structure (CVTRA05Y). Standard CICS copybooks for AID keys and BMS attributes are also included. The structure supports the program's core functionality of browsing, displaying, and selecting transaction records with pagination capabilities."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the linkage area used for communication with other programs. It contains a DFHCOMMAREA with a single field LK-COMMAREA, which is defined as a variable-length array of characters. The array can hold between 1 and 32,767 characters, with the actual length determined by the EIBCALEN value (CICS Execute Interface Block Communication Area Length). This structure allows the program to receive and pass data of varying sizes when called by or calling other programs within the CICS environment."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.\n           88 TRANSACT-EOF                       VALUE 'Y'.\n           88 TRANSACT-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-PAGE-NUM                PIC S9(04) COMP VALUE ZEROS.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n\n\n\n       COPY COCOM01Y.\n          05 CDEMO-CT00-INFO.\n             10 CDEMO-CT00-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT00-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT00-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT00-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET NEXT-PAGE-NO TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN0AO\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN0AO\n                   PERFORM PROCESS-ENTER-KEY\n                   PERFORM SEND-TRNLST-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNLST-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF7\n                           PERFORM PROCESS-PF7-KEY\n                       WHEN DFHPF8\n                           PERFORM PROCESS-PF8-KEY\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO TRNIDINL OF COTRN0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNLST-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the COTRN00C transaction list program. It initializes key flags, handles the program's entry point logic, and processes user interactions. The paragraph first sets up error flags, pagination controls, and screen attributes before checking if the program was called with a communication area. If no communication area exists, it returns to the sign-on program (COSGN00C). \n\nFor normal operation, it either initializes the screen on first entry or processes user input on subsequent entries. The paragraph implements a command dispatcher pattern that evaluates function key inputs and routes to appropriate processing routines: ENTER key for standard processing, PF3 to return to the menu program (COMEN01C), PF7/PF8 for pagination, with error handling for invalid keys. After processing, it returns control to CICS while preserving the program state in the communication area for the next interaction. This paragraph effectively manages the program's event-driven workflow and maintains user session context."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EVALUATE TRUE\n               WHEN SEL0001I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0001I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID01I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0002I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0002I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID02I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0003I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0003I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID03I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0004I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0004I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID04I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0005I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0005I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID05I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0006I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0006I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID06I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0007I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0007I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID07I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0008I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0008I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID08I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0009I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0009I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID09I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0010I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0010I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID10I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN OTHER\n                   MOVE SPACES   TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE SPACES   TO CDEMO-CT00-TRN-SELECTED\n           END-EVALUATE\n           IF (CDEMO-CT00-TRN-SEL-FLG NOT = SPACES AND LOW-VALUES) AND\n              (CDEMO-CT00-TRN-SELECTED NOT = SPACES AND LOW-VALUES)\n               EVALUATE CDEMO-CT00-TRN-SEL-FLG\n                   WHEN 'S'\n                   WHEN 's'\n                        MOVE 'COTRN01C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN OTHER\n      *                SET TRANSACT-EOF TO TRUE\n                       MOVE\n                       'Invalid selection. Valid value is S' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO TRNIDINL OF COTRN0AI\n      *                PERFORM SEND-TRNLST-SCREEN\n               END-EVALUATE\n           END-IF\n\n           IF TRNIDINI OF COTRN0AI = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO TRAN-ID\n           ELSE\n               IF TRNIDINI  OF COTRN0AI IS NUMERIC\n                   MOVE TRNIDINI  OF COTRN0AI    TO TRAN-ID\n               ELSE\n                   MOVE 'Y'                       TO WS-ERR-FLG\n                   MOVE\n                   'Tran ID must be Numeric ...' TO\n                                   WS-MESSAGE\n                   MOVE -1                 TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               END-IF\n           END-IF\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n\n           MOVE 0       TO CDEMO-CT00-PAGE-NUM\n           PERFORM PROCESS-PAGE-FORWARD\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACE   TO TRNIDINO  OF COTRN0AO\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF7-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the processing of the Enter key in the transaction list screen. It evaluates which transaction row has been selected by checking each selection field (SEL0001I through SEL0010I) and captures both the selection flag and the corresponding transaction ID. When a valid selection is made with an 'S' or 's' flag, the program transfers control to COTRN01C for detailed transaction viewing, passing context through the communication area. For invalid selection values, it displays an error message. The paragraph also processes the transaction ID input field, validating that it contains numeric data when provided, and displays appropriate error messages for invalid input. After processing the input, it resets the page number to 0 and calls the PROCESS-PAGE-FORWARD paragraph to display the appropriate transaction records. The cursor is positioned at the transaction ID input field for the next user interaction."
          },
          {
            "name": "PROCESS-PF7-KEY",
            "code": "IF CDEMO-CT00-TRNID-FIRST = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO TRAN-ID\n           ELSE\n               MOVE CDEMO-CT00-TRNID-FIRST TO TRAN-ID\n           END-IF\n\n           SET NEXT-PAGE-YES TO TRUE\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF CDEMO-CT00-PAGE-NUM > 1\n               PERFORM PROCESS-PAGE-BACKWARD\n           ELSE\n               MOVE 'You are already at the top of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-TRNLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF8-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the Page Up (PF7) key functionality in the transaction list screen. It first determines the starting point for retrieving the previous page of transactions by checking if the first transaction ID is empty (in which case it uses LOW-VALUES) or using the stored first transaction ID. It sets a flag indicating a page navigation request and positions the cursor at the transaction ID input field. If the user is not already on the first page, it calls the PROCESS-PAGE-BACKWARD paragraph to retrieve and display the previous page of transactions. Otherwise, it displays a message informing the user they are already at the top of the page and redisplays the current screen without clearing it."
          },
          {
            "name": "PROCESS-PF8-KEY",
            "code": "IF CDEMO-CT00-TRNID-LAST = SPACES OR LOW-VALUES\n               MOVE HIGH-VALUES TO TRAN-ID\n           ELSE\n               MOVE CDEMO-CT00-TRNID-LAST TO TRAN-ID\n           END-IF\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF NEXT-PAGE-YES\n               PERFORM PROCESS-PAGE-FORWARD\n           ELSE\n               MOVE 'You are already at the bottom of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-TRNLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-FORWARD\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the Page Down (PF8) key functionality in the transaction list screen. It determines the starting point for retrieving the next set of transaction records by checking if the last transaction ID is empty (indicating first use) or using the last displayed transaction ID as the starting point. The cursor is positioned at the transaction ID input field. If there are more records available (NEXT-PAGE-YES is true), it calls the PROCESS-PAGE-FORWARD paragraph to retrieve and display the next page of transactions. If the user is already at the bottom of the available records, it displays an informative message and refreshes the screen without clearing it."
          },
          {
            "name": "PROCESS-PAGE-FORWARD",
            "code": "PERFORM STARTBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF7 AND DFHPF3\n                   PERFORM READNEXT-TRANSACT-FILE\n               END-IF\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                      PERFORM INITIALIZE-TRAN-DATA\n                  END-PERFORM\n               END-IF\n\n               MOVE 1             TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX >= 11 OR TRANSACT-EOF OR ERR-FLG-ON\n                   PERFORM READNEXT-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-TRAN-DATA\n                       COMPUTE WS-IDX = WS-IDX + 1\n                   END-IF\n               END-PERFORM\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                   COMPUTE CDEMO-CT00-PAGE-NUM =\n                           CDEMO-CT00-PAGE-NUM + 1\n                   PERFORM READNEXT-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       SET NEXT-PAGE-YES TO TRUE\n                   ELSE\n                       SET NEXT-PAGE-NO TO TRUE\n                   END-IF\n               ELSE\n                   SET NEXT-PAGE-NO TO TRUE\n                   IF WS-IDX > 1\n                       COMPUTE CDEMO-CT00-PAGE-NUM = CDEMO-CT00-PAGE-NUM\n                        + 1\n                   END-IF\n               END-IF\n\n               PERFORM ENDBR-TRANSACT-FILE\n\n               MOVE CDEMO-CT00-PAGE-NUM TO PAGENUMI  OF COTRN0AI\n               MOVE SPACE   TO TRNIDINO  OF COTRN0AO\n               PERFORM SEND-TRNLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-BACKWARD\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the forward pagination functionality for the transaction list display. It starts by positioning the file pointer at the beginning of the transaction file and then reads through records to populate the current page of data. The process initializes all transaction data fields before populating them with actual values from the file.\n\nThe code reads up to 10 transaction records, populating screen fields for each record found. After loading the current page, it checks if more records exist beyond the current page to determine if a \"next page\" option should be available. If additional records exist, the page counter is incremented and the \"next page\" indicator is set to true.\n\nThe paragraph manages pagination state by updating the page number and clearing the transaction ID input field before redisplaying the screen with the newly loaded transaction data. Error conditions are handled throughout the process to ensure the program responds appropriately if file access issues occur."
          },
          {
            "name": "PROCESS-PAGE-BACKWARD",
            "code": "PERFORM STARTBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF8\n                   PERFORM READPREV-TRANSACT-FILE\n               END-IF\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                     PERFORM INITIALIZE-TRAN-DATA\n                  END-PERFORM\n               END-IF\n\n               MOVE 10          TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX <= 0 OR TRANSACT-EOF OR ERR-FLG-ON\n                   PERFORM READPREV-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-TRAN-DATA\n                       COMPUTE WS-IDX = WS-IDX - 1\n                   END-IF\n               END-PERFORM\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM READPREV-TRANSACT-FILE\n                  IF NEXT-PAGE-YES\n                     IF TRANSACT-NOT-EOF AND ERR-FLG-OFF AND\n                        CDEMO-CT00-PAGE-NUM > 1\n                        SUBTRACT 1 FROM CDEMO-CT00-PAGE-NUM\n                     ELSE\n                        MOVE 1 TO CDEMO-CT00-PAGE-NUM\n                     END-IF\n                  END-IF\n               END-IF\n\n               PERFORM ENDBR-TRANSACT-FILE\n\n               MOVE CDEMO-CT00-PAGE-NUM TO PAGENUMI  OF COTRN0AI\n               PERFORM SEND-TRNLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-TRAN-DATA\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the backward pagination functionality when a user presses PF7 to view previous transaction records. It starts by establishing a browse session on the TRANSACT file, then initializes the display fields for up to 10 transaction records. The core logic reads transaction records in reverse order (using READPREV), populating the screen data fields until either 10 records are processed, the beginning of the file is reached, or an error occurs. After retrieving the records, it decrements the page number if appropriate and not already at page 1, ends the browse session, and displays the updated transaction list screen. The paragraph maintains proper pagination context while ensuring the user interface accurately reflects the available transaction data."
          },
          {
            "name": "POPULATE-TRAN-DATA",
            "code": "MOVE TRAN-AMT                  TO WS-TRAN-AMT\n           MOVE TRAN-ORIG-TS              TO WS-TIMESTAMP\n           MOVE WS-TIMESTAMP-DT-YYYY(3:2) TO WS-CURDATE-YY\n           MOVE WS-TIMESTAMP-DT-MM        TO WS-CURDATE-MM\n           MOVE WS-TIMESTAMP-DT-DD        TO WS-CURDATE-DD\n           MOVE WS-CURDATE-MM-DD-YY       TO WS-TRAN-DATE\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE TRAN-ID    TO TRNID01I OF COTRN0AI\n                                         CDEMO-CT00-TRNID-FIRST\n                   MOVE WS-TRAN-DATE TO TDATE01I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC01I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT001I OF COTRN0AI\n               WHEN 2\n                   MOVE TRAN-ID    TO TRNID02I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE02I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC02I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT002I OF COTRN0AI\n               WHEN 3\n                   MOVE TRAN-ID    TO TRNID03I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE03I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC03I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT003I OF COTRN0AI\n               WHEN 4\n                   MOVE TRAN-ID    TO TRNID04I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE04I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC04I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT004I OF COTRN0AI\n               WHEN 5\n                   MOVE TRAN-ID    TO TRNID05I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE05I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC05I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT005I OF COTRN0AI\n               WHEN 6\n                   MOVE TRAN-ID    TO TRNID06I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE06I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC06I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT006I OF COTRN0AI\n               WHEN 7\n                   MOVE TRAN-ID    TO TRNID07I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE07I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC07I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT007I OF COTRN0AI\n               WHEN 8\n                   MOVE TRAN-ID    TO TRNID08I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE08I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC08I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT008I OF COTRN0AI\n               WHEN 9\n                   MOVE TRAN-ID    TO TRNID09I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE09I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC09I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT009I OF COTRN0AI\n               WHEN 10\n                   MOVE TRAN-ID    TO TRNID10I OF COTRN0AI\n                                         CDEMO-CT00-TRNID-LAST\n                   MOVE WS-TRAN-DATE TO TDATE10I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC10I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT010I OF COTRN0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-TRAN-DATA\n      *----------------------------------------------------------------*",
            "description": "This paragraph formats and populates transaction data into the appropriate screen fields for display. It first processes the transaction amount and timestamp, extracting and reformatting the date components into a user-friendly format. Then, using an EVALUATE statement based on the current index (WS-IDX), it populates the corresponding row on the screen with transaction details including ID, date, description, and amount. For the first and last transactions displayed, it also stores the transaction IDs in communication area fields to track pagination boundaries. The paragraph handles up to 10 transactions, which corresponds to the maximum number of transactions displayed on a single page of the transaction list screen."
          },
          {
            "name": "INITIALIZE-TRAN-DATA",
            "code": "EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SPACES TO TRNID01I OF COTRN0AI\n                   MOVE SPACES TO TDATE01I OF COTRN0AI\n                   MOVE SPACES TO TDESC01I OF COTRN0AI\n                   MOVE SPACES TO TAMT001I OF COTRN0AI\n               WHEN 2\n                   MOVE SPACES TO TRNID02I OF COTRN0AI\n                   MOVE SPACES TO TDATE02I OF COTRN0AI\n                   MOVE SPACES TO TDESC02I OF COTRN0AI\n                   MOVE SPACES TO TAMT002I OF COTRN0AI\n               WHEN 3\n                   MOVE SPACES TO TRNID03I OF COTRN0AI\n                   MOVE SPACES TO TDATE03I OF COTRN0AI\n                   MOVE SPACES TO TDESC03I OF COTRN0AI\n                   MOVE SPACES TO TAMT003I OF COTRN0AI\n               WHEN 4\n                   MOVE SPACES TO TRNID04I OF COTRN0AI\n                   MOVE SPACES TO TDATE04I OF COTRN0AI\n                   MOVE SPACES TO TDESC04I OF COTRN0AI\n                   MOVE SPACES TO TAMT004I OF COTRN0AI\n               WHEN 5\n                   MOVE SPACES TO TRNID05I OF COTRN0AI\n                   MOVE SPACES TO TDATE05I OF COTRN0AI\n                   MOVE SPACES TO TDESC05I OF COTRN0AI\n                   MOVE SPACES TO TAMT005I OF COTRN0AI\n               WHEN 6\n                   MOVE SPACES TO TRNID06I OF COTRN0AI\n                   MOVE SPACES TO TDATE06I OF COTRN0AI\n                   MOVE SPACES TO TDESC06I OF COTRN0AI\n                   MOVE SPACES TO TAMT006I OF COTRN0AI\n               WHEN 7\n                   MOVE SPACES TO TRNID07I OF COTRN0AI\n                   MOVE SPACES TO TDATE07I OF COTRN0AI\n                   MOVE SPACES TO TDESC07I OF COTRN0AI\n                   MOVE SPACES TO TAMT007I OF COTRN0AI\n               WHEN 8\n                   MOVE SPACES TO TRNID08I OF COTRN0AI\n                   MOVE SPACES TO TDATE08I OF COTRN0AI\n                   MOVE SPACES TO TDESC08I OF COTRN0AI\n                   MOVE SPACES TO TAMT008I OF COTRN0AI\n               WHEN 9\n                   MOVE SPACES TO TRNID09I OF COTRN0AI\n                   MOVE SPACES TO TDATE09I OF COTRN0AI\n                   MOVE SPACES TO TDESC09I OF COTRN0AI\n                   MOVE SPACES TO TAMT009I OF COTRN0AI\n               WHEN 10\n                   MOVE SPACES TO TRNID10I OF COTRN0AI\n                   MOVE SPACES TO TDATE10I OF COTRN0AI\n                   MOVE SPACES TO TDESC10I OF COTRN0AI\n                   MOVE SPACES TO TAMT010I OF COTRN0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the transaction data fields on the screen based on a specific row index (WS-IDX). Using an EVALUATE statement, it systematically blanks out the transaction ID, date, description, and amount fields for a particular row position (1-10) on the COTRN0AI screen. Each WHEN clause handles a specific row number, clearing all four fields associated with that row. If the index value is outside the range of 1-10, the WHEN OTHER clause simply continues execution without any action. This routine is used to initialize or reset transaction display data for specific rows in the transaction listing screen."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNLST-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the return navigation to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, defaulting to 'COSGN00C' if not provided. It then updates the communication area with the current transaction ID and program name as the source of the transfer, and resets the program context to zeros. Finally, it executes a CICS XCTL command to transfer control to the target program, passing the updated communication area. This ensures proper navigation flow between screens while maintaining transaction context."
          },
          {
            "name": "SEND-TRNLST-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('COTRN0A')\n                         MAPSET('COTRN00')\n                         FROM(COTRN0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('COTRN0A')\n                         MAPSET('COTRN00')\n                         FROM(COTRN0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNLST-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the display of the transaction list screen (COTRN0A) to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up the screen header information, then displays any system messages stored in WS-MESSAGE to the error message field. The paragraph implements conditional screen sending logic based on the SEND-ERASE-YES flag - if set, it sends the screen with the ERASE option to clear the entire screen; otherwise, it sends the screen without erasing, which preserves background content. In both cases, the cursor is positioned according to previously set cursor positioning logic. This is a standard CICS screen output routine that forms part of the transaction list display functionality."
          },
          {
            "name": "RECEIVE-TRNLST-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COTRN0A')\n                     MAPSET('COTRN00')\n                     INTO(COTRN0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the transaction list screen (COTRN0A) into the input map area (COTRN0AI). It uses the CICS RECEIVE command to capture data entered by the user on the transaction listing screen, storing response codes in WS-RESP-CD and WS-REAS-CD for subsequent error handling. This is a standard CICS interaction pattern for capturing user input before processing it in the transaction listing functionality."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN0AO.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the transaction list screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information in the screen header. The paragraph sets the application title fields from the communication area (CCDA), displays the transaction ID and program name, and formats the current date as MM/DD/YY and time as HH:MM:SS for display. This creates a consistent header with identifying information and timestamp that appears at the top of the transaction list screen."
          },
          {
            "name": "STARTBR-TRANSACT-FILE",
            "code": "EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n      *         GTEQ\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You are at the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READNEXT-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph initiates a browse operation on the TRANSACT file using the CICS STARTBR command. It positions the browse cursor at the record matching the transaction ID specified in TRAN-ID. The paragraph handles three possible outcomes: successful positioning (NORMAL response), record not found (NOTFND), or other errors. When successful, processing continues to the next step. When the record is not found, it sets the end-of-file flag, displays a message indicating the user is at the top of the page, and redisplays the transaction list screen. For any other errors, it logs the response and reason codes, sets an error flag, displays an error message, and redisplays the screen. This paragraph is a key component of the pagination functionality, establishing the starting point for browsing transaction records."
          },
          {
            "name": "READNEXT-TRANSACT-FILE",
            "code": "EXEC CICS READNEXT\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You have reached the bottom of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a sequential read operation on the TRANSACT file to retrieve the next transaction record. It uses the CICS READNEXT command to fetch the next record based on the current key position stored in TRAN-ID. The paragraph handles three possible outcomes: successful read (NORMAL response), reaching the end of file, or encountering an error. When the end of file is reached, it sets the TRANSACT-EOF flag, displays a message informing the user they've reached the bottom of the page, and redisplays the transaction list screen. For other errors, it logs the response and reason codes, sets an error flag, displays an error message, and redisplays the screen. This paragraph is a key component of the pagination functionality, allowing users to navigate forward through the transaction records."
          },
          {
            "name": "READPREV-TRANSACT-FILE",
            "code": "EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You have reached the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles reading the previous record from the TRANSACT file during backward pagination. It uses the CICS READPREV command to retrieve the previous transaction record based on the current key position. The paragraph evaluates the response code from the operation and handles three scenarios: successful read (continues processing), reaching the beginning of the file (displays a message indicating the user is at the top of the page), or encountering an error (displays diagnostic information and an error message). When the beginning of the file is reached or an error occurs, the paragraph sets appropriate flags and messages before redisplaying the transaction list screen. This functionality supports the program's pagination capability, specifically the \"page up\" functionality."
          },
          {
            "name": "ENDBR-TRANSACT-FILE",
            "code": "EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *",
            "description": "This paragraph terminates a browse operation on the TRANSACT file using the CICS ENDBR command. It ends the sequential reading of transaction records that was previously initiated with a STARTBR command. The WS-TRANSACT-FILE variable contains the name of the dataset being accessed. This operation is necessary to properly release resources after completing pagination or search operations on the transaction list."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET NEXT-PAGE-NO TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN0AO\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN0AO\n                   PERFORM PROCESS-ENTER-KEY\n                   PERFORM SEND-TRNLST-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNLST-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF7\n                           PERFORM PROCESS-PF7-KEY\n                       WHEN DFHPF8\n                           PERFORM PROCESS-PF8-KEY\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO TRNIDINL OF COTRN0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNLST-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN SEL0001I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0001I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID01I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0002I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0002I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID02I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0003I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0003I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID03I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0004I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0004I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID04I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0005I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0005I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID05I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0006I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0006I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID06I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0007I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0007I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID07I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0008I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0008I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID08I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0009I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0009I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID09I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0010I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0010I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID10I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN OTHER\n                   MOVE SPACES   TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE SPACES   TO CDEMO-CT00-TRN-SELECTED\n           END-EVALUATE\n           IF (CDEMO-CT00-TRN-SEL-FLG NOT = SPACES AND LOW-VALUES) AND\n              (CDEMO-CT00-TRN-SELECTED NOT = SPACES AND LOW-VALUES)\n               EVALUATE CDEMO-CT00-TRN-SEL-FLG\n                   WHEN 'S'\n                   WHEN 's'\n                        MOVE 'COTRN01C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN OTHER\n      *                SET TRANSACT-EOF TO TRUE\n                       MOVE\n                       'Invalid selection. Valid value is S' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO TRNIDINL OF COTRN0AI\n      *                PERFORM SEND-TRNLST-SCREEN\n               END-EVALUATE\n           END-IF\n\n           IF TRNIDINI OF COTRN0AI = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO TRAN-ID\n           ELSE\n               IF TRNIDINI  OF COTRN0AI IS NUMERIC\n                   MOVE TRNIDINI  OF COTRN0AI    TO TRAN-ID\n               ELSE\n                   MOVE 'Y'                       TO WS-ERR-FLG\n                   MOVE\n                   'Tran ID must be Numeric ...' TO\n                                   WS-MESSAGE\n                   MOVE -1                 TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               END-IF\n           END-IF\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n\n           MOVE 0       TO CDEMO-CT00-PAGE-NUM\n           PERFORM PROCESS-PAGE-FORWARD\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACE   TO TRNIDINO  OF COTRN0AO\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF7-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF7-KEY.\n\n           IF CDEMO-CT00-TRNID-FIRST = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO TRAN-ID\n           ELSE\n               MOVE CDEMO-CT00-TRNID-FIRST TO TRAN-ID\n           END-IF\n\n           SET NEXT-PAGE-YES TO TRUE\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF CDEMO-CT00-PAGE-NUM > 1\n               PERFORM PROCESS-PAGE-BACKWARD\n           ELSE\n               MOVE 'You are already at the top of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-TRNLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF8-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF8-KEY.\n\n           IF CDEMO-CT00-TRNID-LAST = SPACES OR LOW-VALUES\n               MOVE HIGH-VALUES TO TRAN-ID\n           ELSE\n               MOVE CDEMO-CT00-TRNID-LAST TO TRAN-ID\n           END-IF\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF NEXT-PAGE-YES\n               PERFORM PROCESS-PAGE-FORWARD\n           ELSE\n               MOVE 'You are already at the bottom of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-TRNLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-FORWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-FORWARD.\n\n           PERFORM STARTBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF7 AND DFHPF3\n                   PERFORM READNEXT-TRANSACT-FILE\n               END-IF\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                      PERFORM INITIALIZE-TRAN-DATA\n                  END-PERFORM\n               END-IF\n\n               MOVE 1             TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX >= 11 OR TRANSACT-EOF OR ERR-FLG-ON\n                   PERFORM READNEXT-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-TRAN-DATA\n                       COMPUTE WS-IDX = WS-IDX + 1\n                   END-IF\n               END-PERFORM\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                   COMPUTE CDEMO-CT00-PAGE-NUM =\n                           CDEMO-CT00-PAGE-NUM + 1\n                   PERFORM READNEXT-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       SET NEXT-PAGE-YES TO TRUE\n                   ELSE\n                       SET NEXT-PAGE-NO TO TRUE\n                   END-IF\n               ELSE\n                   SET NEXT-PAGE-NO TO TRUE\n                   IF WS-IDX > 1\n                       COMPUTE CDEMO-CT00-PAGE-NUM = CDEMO-CT00-PAGE-NUM\n                        + 1\n                   END-IF\n               END-IF\n\n               PERFORM ENDBR-TRANSACT-FILE\n\n               MOVE CDEMO-CT00-PAGE-NUM TO PAGENUMI  OF COTRN0AI\n               MOVE SPACE   TO TRNIDINO  OF COTRN0AO\n               PERFORM SEND-TRNLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-BACKWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-BACKWARD.\n\n           PERFORM STARTBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF8\n                   PERFORM READPREV-TRANSACT-FILE\n               END-IF\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                     PERFORM INITIALIZE-TRAN-DATA\n                  END-PERFORM\n               END-IF\n\n               MOVE 10          TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX <= 0 OR TRANSACT-EOF OR ERR-FLG-ON\n                   PERFORM READPREV-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-TRAN-DATA\n                       COMPUTE WS-IDX = WS-IDX - 1\n                   END-IF\n               END-PERFORM\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM READPREV-TRANSACT-FILE\n                  IF NEXT-PAGE-YES\n                     IF TRANSACT-NOT-EOF AND ERR-FLG-OFF AND\n                        CDEMO-CT00-PAGE-NUM > 1\n                        SUBTRACT 1 FROM CDEMO-CT00-PAGE-NUM\n                     ELSE\n                        MOVE 1 TO CDEMO-CT00-PAGE-NUM\n                     END-IF\n                  END-IF\n               END-IF\n\n               PERFORM ENDBR-TRANSACT-FILE\n\n               MOVE CDEMO-CT00-PAGE-NUM TO PAGENUMI  OF COTRN0AI\n               PERFORM SEND-TRNLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-TRAN-DATA\n      *----------------------------------------------------------------*\n       POPULATE-TRAN-DATA.\n\n           MOVE TRAN-AMT                  TO WS-TRAN-AMT\n           MOVE TRAN-ORIG-TS              TO WS-TIMESTAMP\n           MOVE WS-TIMESTAMP-DT-YYYY(3:2) TO WS-CURDATE-YY\n           MOVE WS-TIMESTAMP-DT-MM        TO WS-CURDATE-MM\n           MOVE WS-TIMESTAMP-DT-DD        TO WS-CURDATE-DD\n           MOVE WS-CURDATE-MM-DD-YY       TO WS-TRAN-DATE\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE TRAN-ID    TO TRNID01I OF COTRN0AI\n                                         CDEMO-CT00-TRNID-FIRST\n                   MOVE WS-TRAN-DATE TO TDATE01I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC01I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT001I OF COTRN0AI\n               WHEN 2\n                   MOVE TRAN-ID    TO TRNID02I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE02I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC02I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT002I OF COTRN0AI\n               WHEN 3\n                   MOVE TRAN-ID    TO TRNID03I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE03I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC03I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT003I OF COTRN0AI\n               WHEN 4\n                   MOVE TRAN-ID    TO TRNID04I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE04I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC04I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT004I OF COTRN0AI\n               WHEN 5\n                   MOVE TRAN-ID    TO TRNID05I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE05I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC05I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT005I OF COTRN0AI\n               WHEN 6\n                   MOVE TRAN-ID    TO TRNID06I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE06I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC06I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT006I OF COTRN0AI\n               WHEN 7\n                   MOVE TRAN-ID    TO TRNID07I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE07I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC07I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT007I OF COTRN0AI\n               WHEN 8\n                   MOVE TRAN-ID    TO TRNID08I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE08I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC08I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT008I OF COTRN0AI\n               WHEN 9\n                   MOVE TRAN-ID    TO TRNID09I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE09I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC09I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT009I OF COTRN0AI\n               WHEN 10\n                   MOVE TRAN-ID    TO TRNID10I OF COTRN0AI\n                                         CDEMO-CT00-TRNID-LAST\n                   MOVE WS-TRAN-DATE TO TDATE10I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC10I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT010I OF COTRN0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-TRAN-DATA\n      *----------------------------------------------------------------*\n       INITIALIZE-TRAN-DATA.\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SPACES TO TRNID01I OF COTRN0AI\n                   MOVE SPACES TO TDATE01I OF COTRN0AI\n                   MOVE SPACES TO TDESC01I OF COTRN0AI\n                   MOVE SPACES TO TAMT001I OF COTRN0AI\n               WHEN 2\n                   MOVE SPACES TO TRNID02I OF COTRN0AI\n                   MOVE SPACES TO TDATE02I OF COTRN0AI\n                   MOVE SPACES TO TDESC02I OF COTRN0AI\n                   MOVE SPACES TO TAMT002I OF COTRN0AI\n               WHEN 3\n                   MOVE SPACES TO TRNID03I OF COTRN0AI\n                   MOVE SPACES TO TDATE03I OF COTRN0AI\n                   MOVE SPACES TO TDESC03I OF COTRN0AI\n                   MOVE SPACES TO TAMT003I OF COTRN0AI\n               WHEN 4\n                   MOVE SPACES TO TRNID04I OF COTRN0AI\n                   MOVE SPACES TO TDATE04I OF COTRN0AI\n                   MOVE SPACES TO TDESC04I OF COTRN0AI\n                   MOVE SPACES TO TAMT004I OF COTRN0AI\n               WHEN 5\n                   MOVE SPACES TO TRNID05I OF COTRN0AI\n                   MOVE SPACES TO TDATE05I OF COTRN0AI\n                   MOVE SPACES TO TDESC05I OF COTRN0AI\n                   MOVE SPACES TO TAMT005I OF COTRN0AI\n               WHEN 6\n                   MOVE SPACES TO TRNID06I OF COTRN0AI\n                   MOVE SPACES TO TDATE06I OF COTRN0AI\n                   MOVE SPACES TO TDESC06I OF COTRN0AI\n                   MOVE SPACES TO TAMT006I OF COTRN0AI\n               WHEN 7\n                   MOVE SPACES TO TRNID07I OF COTRN0AI\n                   MOVE SPACES TO TDATE07I OF COTRN0AI\n                   MOVE SPACES TO TDESC07I OF COTRN0AI\n                   MOVE SPACES TO TAMT007I OF COTRN0AI\n               WHEN 8\n                   MOVE SPACES TO TRNID08I OF COTRN0AI\n                   MOVE SPACES TO TDATE08I OF COTRN0AI\n                   MOVE SPACES TO TDESC08I OF COTRN0AI\n                   MOVE SPACES TO TAMT008I OF COTRN0AI\n               WHEN 9\n                   MOVE SPACES TO TRNID09I OF COTRN0AI\n                   MOVE SPACES TO TDATE09I OF COTRN0AI\n                   MOVE SPACES TO TDESC09I OF COTRN0AI\n                   MOVE SPACES TO TAMT009I OF COTRN0AI\n               WHEN 10\n                   MOVE SPACES TO TRNID10I OF COTRN0AI\n                   MOVE SPACES TO TDATE10I OF COTRN0AI\n                   MOVE SPACES TO TDESC10I OF COTRN0AI\n                   MOVE SPACES TO TAMT010I OF COTRN0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNLST-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNLST-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('COTRN0A')\n                         MAPSET('COTRN00')\n                         FROM(COTRN0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('COTRN0A')\n                         MAPSET('COTRN00')\n                         FROM(COTRN0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNLST-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNLST-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COTRN0A')\n                     MAPSET('COTRN00')\n                     INTO(COTRN0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN0AO.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       STARTBR-TRANSACT-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n      *         GTEQ\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You are at the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READNEXT-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READNEXT-TRANSACT-FILE.\n\n           EXEC CICS READNEXT\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You have reached the bottom of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READPREV-TRANSACT-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You have reached the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       ENDBR-TRANSACT-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *"
      },
      "description": "This program, COTRN00C, is a CICS COBOL application that displays and manages a paginated list of transactions from the TRANSACT file. It provides a user interface for viewing transaction records with functionality for pagination, searching, and selecting individual transactions for detailed viewing.\n\nThe program allows users to navigate through transaction records using PF7 (page up) and PF8 (page down) keys, displaying 10 transactions per page. Users can enter a transaction ID to start browsing from a specific point or select a transaction with an 'S' command to view its details. When a transaction is selected, the program transfers control to COTRN01C for detailed transaction information.\n\nThe application handles various user interactions including input validation, error handling, and navigation between screens. It maintains context between screens through a shared communication area and provides clear feedback messages to guide the user. The program is part of the CardDemo application suite, which demonstrates AWS mainframe migration capabilities.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COTRN00C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : List Transactions from TRANSACT file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COTRN00C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.\n           88 TRANSACT-EOF                       VALUE 'Y'.\n           88 TRANSACT-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-PAGE-NUM                PIC S9(04) COMP VALUE ZEROS.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n\n\n\n       COPY COCOM01Y.\n          05 CDEMO-CT00-INFO.\n             10 CDEMO-CT00-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT00-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT00-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT00-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET NEXT-PAGE-NO TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN0AO\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN0AO\n                   PERFORM PROCESS-ENTER-KEY\n                   PERFORM SEND-TRNLST-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNLST-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF7\n                           PERFORM PROCESS-PF7-KEY\n                       WHEN DFHPF8\n                           PERFORM PROCESS-PF8-KEY\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO TRNIDINL OF COTRN0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNLST-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN SEL0001I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0001I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID01I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0002I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0002I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID02I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0003I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0003I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID03I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0004I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0004I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID04I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0005I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0005I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID05I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0006I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0006I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID06I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0007I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0007I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID07I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0008I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0008I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID08I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0009I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0009I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID09I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN SEL0010I OF COTRN0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0010I OF COTRN0AI TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE TRNID10I OF COTRN0AI TO CDEMO-CT00-TRN-SELECTED\n               WHEN OTHER\n                   MOVE SPACES   TO CDEMO-CT00-TRN-SEL-FLG\n                   MOVE SPACES   TO CDEMO-CT00-TRN-SELECTED\n           END-EVALUATE\n           IF (CDEMO-CT00-TRN-SEL-FLG NOT = SPACES AND LOW-VALUES) AND\n              (CDEMO-CT00-TRN-SELECTED NOT = SPACES AND LOW-VALUES)\n               EVALUATE CDEMO-CT00-TRN-SEL-FLG\n                   WHEN 'S'\n                   WHEN 's'\n                        MOVE 'COTRN01C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN OTHER\n      *                SET TRANSACT-EOF TO TRUE\n                       MOVE\n                       'Invalid selection. Valid value is S' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO TRNIDINL OF COTRN0AI\n      *                PERFORM SEND-TRNLST-SCREEN\n               END-EVALUATE\n           END-IF\n\n           IF TRNIDINI OF COTRN0AI = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO TRAN-ID\n           ELSE\n               IF TRNIDINI  OF COTRN0AI IS NUMERIC\n                   MOVE TRNIDINI  OF COTRN0AI    TO TRAN-ID\n               ELSE\n                   MOVE 'Y'                       TO WS-ERR-FLG\n                   MOVE\n                   'Tran ID must be Numeric ...' TO\n                                   WS-MESSAGE\n                   MOVE -1                 TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               END-IF\n           END-IF\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n\n           MOVE 0       TO CDEMO-CT00-PAGE-NUM\n           PERFORM PROCESS-PAGE-FORWARD\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACE   TO TRNIDINO  OF COTRN0AO\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF7-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF7-KEY.\n\n           IF CDEMO-CT00-TRNID-FIRST = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO TRAN-ID\n           ELSE\n               MOVE CDEMO-CT00-TRNID-FIRST TO TRAN-ID\n           END-IF\n\n           SET NEXT-PAGE-YES TO TRUE\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF CDEMO-CT00-PAGE-NUM > 1\n               PERFORM PROCESS-PAGE-BACKWARD\n           ELSE\n               MOVE 'You are already at the top of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-TRNLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF8-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF8-KEY.\n\n           IF CDEMO-CT00-TRNID-LAST = SPACES OR LOW-VALUES\n               MOVE HIGH-VALUES TO TRAN-ID\n           ELSE\n               MOVE CDEMO-CT00-TRNID-LAST TO TRAN-ID\n           END-IF\n\n           MOVE -1       TO TRNIDINL OF COTRN0AI\n\n           IF NEXT-PAGE-YES\n               PERFORM PROCESS-PAGE-FORWARD\n           ELSE\n               MOVE 'You are already at the bottom of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-TRNLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-FORWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-FORWARD.\n\n           PERFORM STARTBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF7 AND DFHPF3\n                   PERFORM READNEXT-TRANSACT-FILE\n               END-IF\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                      PERFORM INITIALIZE-TRAN-DATA\n                  END-PERFORM\n               END-IF\n\n               MOVE 1             TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX >= 11 OR TRANSACT-EOF OR ERR-FLG-ON\n                   PERFORM READNEXT-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-TRAN-DATA\n                       COMPUTE WS-IDX = WS-IDX + 1\n                   END-IF\n               END-PERFORM\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                   COMPUTE CDEMO-CT00-PAGE-NUM =\n                           CDEMO-CT00-PAGE-NUM + 1\n                   PERFORM READNEXT-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       SET NEXT-PAGE-YES TO TRUE\n                   ELSE\n                       SET NEXT-PAGE-NO TO TRUE\n                   END-IF\n               ELSE\n                   SET NEXT-PAGE-NO TO TRUE\n                   IF WS-IDX > 1\n                       COMPUTE CDEMO-CT00-PAGE-NUM = CDEMO-CT00-PAGE-NUM\n                        + 1\n                   END-IF\n               END-IF\n\n               PERFORM ENDBR-TRANSACT-FILE\n\n               MOVE CDEMO-CT00-PAGE-NUM TO PAGENUMI  OF COTRN0AI\n               MOVE SPACE   TO TRNIDINO  OF COTRN0AO\n               PERFORM SEND-TRNLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-BACKWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-BACKWARD.\n\n           PERFORM STARTBR-TRANSACT-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF8\n                   PERFORM READPREV-TRANSACT-FILE\n               END-IF\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                     PERFORM INITIALIZE-TRAN-DATA\n                  END-PERFORM\n               END-IF\n\n               MOVE 10          TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX <= 0 OR TRANSACT-EOF OR ERR-FLG-ON\n                   PERFORM READPREV-TRANSACT-FILE\n                   IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-TRAN-DATA\n                       COMPUTE WS-IDX = WS-IDX - 1\n                   END-IF\n               END-PERFORM\n\n               IF TRANSACT-NOT-EOF AND ERR-FLG-OFF\n                  PERFORM READPREV-TRANSACT-FILE\n                  IF NEXT-PAGE-YES\n                     IF TRANSACT-NOT-EOF AND ERR-FLG-OFF AND\n                        CDEMO-CT00-PAGE-NUM > 1\n                        SUBTRACT 1 FROM CDEMO-CT00-PAGE-NUM\n                     ELSE\n                        MOVE 1 TO CDEMO-CT00-PAGE-NUM\n                     END-IF\n                  END-IF\n               END-IF\n\n               PERFORM ENDBR-TRANSACT-FILE\n\n               MOVE CDEMO-CT00-PAGE-NUM TO PAGENUMI  OF COTRN0AI\n               PERFORM SEND-TRNLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-TRAN-DATA\n      *----------------------------------------------------------------*\n       POPULATE-TRAN-DATA.\n\n           MOVE TRAN-AMT                  TO WS-TRAN-AMT\n           MOVE TRAN-ORIG-TS              TO WS-TIMESTAMP\n           MOVE WS-TIMESTAMP-DT-YYYY(3:2) TO WS-CURDATE-YY\n           MOVE WS-TIMESTAMP-DT-MM        TO WS-CURDATE-MM\n           MOVE WS-TIMESTAMP-DT-DD        TO WS-CURDATE-DD\n           MOVE WS-CURDATE-MM-DD-YY       TO WS-TRAN-DATE\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE TRAN-ID    TO TRNID01I OF COTRN0AI\n                                         CDEMO-CT00-TRNID-FIRST\n                   MOVE WS-TRAN-DATE TO TDATE01I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC01I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT001I OF COTRN0AI\n               WHEN 2\n                   MOVE TRAN-ID    TO TRNID02I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE02I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC02I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT002I OF COTRN0AI\n               WHEN 3\n                   MOVE TRAN-ID    TO TRNID03I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE03I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC03I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT003I OF COTRN0AI\n               WHEN 4\n                   MOVE TRAN-ID    TO TRNID04I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE04I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC04I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT004I OF COTRN0AI\n               WHEN 5\n                   MOVE TRAN-ID    TO TRNID05I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE05I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC05I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT005I OF COTRN0AI\n               WHEN 6\n                   MOVE TRAN-ID    TO TRNID06I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE06I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC06I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT006I OF COTRN0AI\n               WHEN 7\n                   MOVE TRAN-ID    TO TRNID07I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE07I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC07I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT007I OF COTRN0AI\n               WHEN 8\n                   MOVE TRAN-ID    TO TRNID08I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE08I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC08I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT008I OF COTRN0AI\n               WHEN 9\n                   MOVE TRAN-ID    TO TRNID09I OF COTRN0AI\n                   MOVE WS-TRAN-DATE TO TDATE09I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC09I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT009I OF COTRN0AI\n               WHEN 10\n                   MOVE TRAN-ID    TO TRNID10I OF COTRN0AI\n                                         CDEMO-CT00-TRNID-LAST\n                   MOVE WS-TRAN-DATE TO TDATE10I OF COTRN0AI\n                   MOVE TRAN-DESC TO TDESC10I OF COTRN0AI\n                   MOVE WS-TRAN-AMT  TO TAMT010I OF COTRN0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-TRAN-DATA\n      *----------------------------------------------------------------*\n       INITIALIZE-TRAN-DATA.\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SPACES TO TRNID01I OF COTRN0AI\n                   MOVE SPACES TO TDATE01I OF COTRN0AI\n                   MOVE SPACES TO TDESC01I OF COTRN0AI\n                   MOVE SPACES TO TAMT001I OF COTRN0AI\n               WHEN 2\n                   MOVE SPACES TO TRNID02I OF COTRN0AI\n                   MOVE SPACES TO TDATE02I OF COTRN0AI\n                   MOVE SPACES TO TDESC02I OF COTRN0AI\n                   MOVE SPACES TO TAMT002I OF COTRN0AI\n               WHEN 3\n                   MOVE SPACES TO TRNID03I OF COTRN0AI\n                   MOVE SPACES TO TDATE03I OF COTRN0AI\n                   MOVE SPACES TO TDESC03I OF COTRN0AI\n                   MOVE SPACES TO TAMT003I OF COTRN0AI\n               WHEN 4\n                   MOVE SPACES TO TRNID04I OF COTRN0AI\n                   MOVE SPACES TO TDATE04I OF COTRN0AI\n                   MOVE SPACES TO TDESC04I OF COTRN0AI\n                   MOVE SPACES TO TAMT004I OF COTRN0AI\n               WHEN 5\n                   MOVE SPACES TO TRNID05I OF COTRN0AI\n                   MOVE SPACES TO TDATE05I OF COTRN0AI\n                   MOVE SPACES TO TDESC05I OF COTRN0AI\n                   MOVE SPACES TO TAMT005I OF COTRN0AI\n               WHEN 6\n                   MOVE SPACES TO TRNID06I OF COTRN0AI\n                   MOVE SPACES TO TDATE06I OF COTRN0AI\n                   MOVE SPACES TO TDESC06I OF COTRN0AI\n                   MOVE SPACES TO TAMT006I OF COTRN0AI\n               WHEN 7\n                   MOVE SPACES TO TRNID07I OF COTRN0AI\n                   MOVE SPACES TO TDATE07I OF COTRN0AI\n                   MOVE SPACES TO TDESC07I OF COTRN0AI\n                   MOVE SPACES TO TAMT007I OF COTRN0AI\n               WHEN 8\n                   MOVE SPACES TO TRNID08I OF COTRN0AI\n                   MOVE SPACES TO TDATE08I OF COTRN0AI\n                   MOVE SPACES TO TDESC08I OF COTRN0AI\n                   MOVE SPACES TO TAMT008I OF COTRN0AI\n               WHEN 9\n                   MOVE SPACES TO TRNID09I OF COTRN0AI\n                   MOVE SPACES TO TDATE09I OF COTRN0AI\n                   MOVE SPACES TO TDESC09I OF COTRN0AI\n                   MOVE SPACES TO TAMT009I OF COTRN0AI\n               WHEN 10\n                   MOVE SPACES TO TRNID10I OF COTRN0AI\n                   MOVE SPACES TO TDATE10I OF COTRN0AI\n                   MOVE SPACES TO TDESC10I OF COTRN0AI\n                   MOVE SPACES TO TAMT010I OF COTRN0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNLST-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNLST-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('COTRN0A')\n                         MAPSET('COTRN00')\n                         FROM(COTRN0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('COTRN0A')\n                         MAPSET('COTRN00')\n                         FROM(COTRN0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNLST-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNLST-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COTRN0A')\n                     MAPSET('COTRN00')\n                     INTO(COTRN0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN0AO.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       STARTBR-TRANSACT-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-TRANSACT-FILE)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n      *         GTEQ\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You are at the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READNEXT-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READNEXT-TRANSACT-FILE.\n\n           EXEC CICS READNEXT\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You have reached the bottom of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READPREV-TRANSACT-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET TRANSACT-EOF TO TRUE\n                   MOVE 'You have reached the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN0AI\n                   PERFORM SEND-TRNLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       ENDBR-TRANSACT-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-TRANSACT-FILE)\n           END-EXEC.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "COTRN00",
        "CVTRA05Y",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant MAIN as MAIN-PARA\n    participant PROCESS_ENTER as PROCESS-ENTER-KEY\n    participant PROCESS_PF7 as PROCESS-PF7-KEY\n    participant PROCESS_PF8 as PROCESS-PF8-KEY\n    participant PAGE_FWD as PROCESS-PAGE-FORWARD\n    participant PAGE_BWD as PROCESS-PAGE-BACKWARD\n    participant POPULATE as POPULATE-TRAN-DATA\n    participant INIT_DATA as INITIALIZE-TRAN-DATA\n    participant SEND as SEND-TRNLST-SCREEN\n    participant RECEIVE as RECEIVE-TRNLST-SCREEN\n    participant HEADER as POPULATE-HEADER-INFO\n    participant RETURN as RETURN-TO-PREV-SCREEN\n    participant STARTBR as STARTBR-TRANSACT-FILE\n    participant READNEXT as READNEXT-TRANSACT-FILE\n    participant READPREV as READPREV-TRANSACT-FILE\n    participant ENDBR as ENDBR-TRANSACT-FILE\n    participant CICS\n    participant TRANSACT_FILE as TRANSACT File\n\n    User->>MAIN: Start transaction\n    \n    alt First entry (no COMMAREA)\n        MAIN->>RETURN: PERFORM RETURN-TO-PREV-SCREEN\n        RETURN->>CICS: XCTL to COSGN00C\n    else Has COMMAREA\n        alt First time in program\n            MAIN->>PROCESS_ENTER: PERFORM PROCESS-ENTER-KEY\n            PROCESS_ENTER->>PAGE_FWD: PERFORM PROCESS-PAGE-FORWARD\n            PAGE_FWD->>STARTBR: PERFORM STARTBR-TRANSACT-FILE\n            STARTBR->>TRANSACT_FILE: STARTBR\n            TRANSACT_FILE-->>STARTBR: Response\n            \n            loop For each record (up to 10)\n                PAGE_FWD->>INIT_DATA: PERFORM INITIALIZE-TRAN-DATA\n            end\n            \n            loop Until 10 records or EOF\n                PAGE_FWD->>READNEXT: PERFORM READNEXT-TRANSACT-FILE\n                READNEXT->>TRANSACT_FILE: READNEXT\n                TRANSACT_FILE-->>READNEXT: Record data\n                PAGE_FWD->>POPULATE: PERFORM POPULATE-TRAN-DATA\n            end\n            \n            PAGE_FWD->>ENDBR: PERFORM ENDBR-TRANSACT-FILE\n            ENDBR->>TRANSACT_FILE: ENDBR\n            \n            MAIN->>SEND: PERFORM SEND-TRNLST-SCREEN\n            SEND->>HEADER: PERFORM POPULATE-HEADER-INFO\n            SEND->>CICS: SEND MAP\n            CICS-->>User: Display transaction list\n        else Subsequent interaction\n            MAIN->>RECEIVE: PERFORM RECEIVE-TRNLST-SCREEN\n            RECEIVE->>CICS: RECEIVE MAP\n            CICS-->>RECEIVE: User input\n            \n            alt ENTER key pressed\n                MAIN->>PROCESS_ENTER: PERFORM PROCESS-ENTER-KEY\n                \n                alt Transaction selected with 'S'\n                    PROCESS_ENTER->>CICS: XCTL to COTRN01C\n                    CICS-->>User: Display transaction details\n                else No selection or invalid selection\n                    PROCESS_ENTER->>PAGE_FWD: PERFORM PROCESS-PAGE-FORWARD\n                    PAGE_FWD->>STARTBR: PERFORM STARTBR-TRANSACT-FILE\n                    STARTBR->>TRANSACT_FILE: STARTBR\n                    TRANSACT_FILE-->>STARTBR: Response\n                    \n                    loop For each record (up to 10)\n                        PAGE_FWD->>INIT_DATA: PERFORM INITIALIZE-TRAN-DATA\n                    end\n                    \n                    loop Until 10 records or EOF\n                        PAGE_FWD->>READNEXT: PERFORM READNEXT-TRANSACT-FILE\n                        READNEXT->>TRANSACT_FILE: READNEXT\n                        TRANSACT_FILE-->>READNEXT: Record data\n                        PAGE_FWD->>POPULATE: PERFORM POPULATE-TRAN-DATA\n                    end\n                    \n                    PAGE_FWD->>ENDBR: PERFORM ENDBR-TRANSACT-FILE\n                    ENDBR->>TRANSACT_FILE: ENDBR\n                    \n                    PAGE_FWD->>SEND: PERFORM SEND-TRNLST-SCREEN\n                    SEND->>HEADER: PERFORM POPULATE-HEADER-INFO\n                    SEND->>CICS: SEND MAP\n                    CICS-->>User: Display transaction list\n                end\n                \n            else PF3 key pressed\n                MAIN->>RETURN: PERFORM RETURN-TO-PREV-SCREEN\n                RETURN->>CICS: XCTL to COMEN01C\n                CICS-->>User: Return to menu\n                \n            else PF7 key pressed (Page Up)\n                MAIN->>PROCESS_PF7: PERFORM PROCESS-PF7-KEY\n                PROCESS_PF7->>PAGE_BWD: PERFORM PROCESS-PAGE-BACKWARD\n                PAGE_BWD->>STARTBR: PERFORM STARTBR-TRANSACT-FILE\n                STARTBR->>TRANSACT_FILE: STARTBR\n                TRANSACT_FILE-->>STARTBR: Response\n                \n                loop For each record (up to 10)\n                    PAGE_BWD->>INIT_DATA: PERFORM INITIALIZE-TRAN-DATA\n                end\n                \n                loop Until 10 records or BOF\n                    PAGE_BWD->>READPREV: PERFORM READPREV-TRANSACT-FILE\n                    READPREV->>TRANSACT_FILE: READPREV\n                    TRANSACT_FILE-->>READPREV: Record data\n                    PAGE_BWD->>POPULATE: PERFORM POPULATE-TRAN-DATA\n                end\n                \n                PAGE_BWD->>ENDBR: PERFORM ENDBR-TRANSACT-FILE\n                ENDBR->>TRANSACT_FILE: ENDBR\n                \n                PAGE_BWD->>SEND: PERFORM SEND-TRNLST-SCREEN\n                SEND->>HEADER: PERFORM POPULATE-HEADER-INFO\n                SEND->>CICS: SEND MAP\n                CICS-->>User: Display previous page\n                \n            else PF8 key pressed (Page Down)\n                MAIN->>PROCESS_PF8: PERFORM PROCESS-PF8-KEY\n                PROCESS_PF8->>PAGE_FWD: PERFORM PROCESS-PAGE-FORWARD\n                PAGE_FWD->>STARTBR: PERFORM STARTBR-TRANSACT-FILE\n                STARTBR->>TRANSACT_FILE: STARTBR\n                TRANSACT_FILE-->>STARTBR: Response\n                \n                loop For each record (up to 10)\n                    PAGE_FWD->>INIT_DATA: PERFORM INITIALIZE-TRAN-DATA\n                end\n                \n                loop Until 10 records or EOF\n                    PAGE_FWD->>READNEXT: PERFORM READNEXT-TRANSACT-FILE\n                    READNEXT->>TRANSACT_FILE: READNEXT\n                    TRANSACT_FILE-->>READNEXT: Record data\n                    PAGE_FWD->>POPULATE: PERFORM POPULATE-TRAN-DATA\n                end\n                \n                PAGE_FWD->>ENDBR: PERFORM ENDBR-TRANSACT-FILE\n                ENDBR->>TRANSACT_FILE: ENDBR\n                \n                PAGE_FWD->>SEND: PERFORM SEND-TRNLST-SCREEN\n                SEND->>HEADER: PERFORM POPULATE-HEADER-INFO\n                SEND->>CICS: SEND MAP\n                CICS-->>User: Display next page\n                \n            else Other key pressed\n                MAIN->>SEND: PERFORM SEND-TRNLST-SCREEN\n                SEND->>HEADER: PERFORM POPULATE-HEADER-INFO\n                SEND->>CICS: SEND MAP with error message\n                CICS-->>User: Display error message\n            end\n        end\n    end\n    \n    MAIN->>CICS: RETURN with COMMAREA"
    },
    {
      "id": "COACTVWC",
      "author": "",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "",
            "description": "This section would typically contain the file declarations and I/O configurations for the COACTVWC program, but appears to be empty in the provided snippet. In a complete program, this section would define the files used for retrieving account information, customer data, and card cross-references that the program needs to display account details. The absence of this section suggests that file access may be handled through CICS commands rather than traditional COBOL file handling."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CUST-FLAG                     PIC X(1).                    \n           88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CUSTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-CUSTFILTER-BLANK                VALUE ' '.                   \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n      *  05  EDIT-FIELD-9-2                PIC +ZZZ,ZZZ,ZZZ.99.                 \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-XREF-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-CUST-ID                 PIC 9(09).                   \n           10  WS-CARD-RID-CUST-ID-X REDEFINES                                  \n                  WS-CARD-RID-CUST-ID              PIC X(09).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-READ-FLAGS. \n           10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).\n              88 FOUND-ACCT-IN-MASTER              VALUE '1'.\n           10 WS-CUST-MASTER-READ-FLAG             PIC X(1).\n              88 FOUND-CUST-IN-MASTER              VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-PROMPT-FOR-INPUT                 VALUE                        \n               'Enter or update id of account to display'.\n           88  WS-INFORM-OUTPUT                    VALUE\n               'Displaying details of given Account'.                           \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in account card xref file'.           \n           88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE                        \n               'Did not find this account in account master file'.              \n           88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE                        \n               'Did not find associated customer in master file'.               \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading account card xref File'.                          \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      *****************************************************************         \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COACTVWC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CAVW'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COACTVW '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CACTVWA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CARDUPDATEPGM                           PIC X(8)               \n                                                   VALUE 'COCRDUPC'.            \n          05 LIT-CARDUDPATETRANID                        PIC X(4)               \n                                                   VALUE 'CCUP'.                \n          05 LIT-CARDUPDATEMAPSET                        PIC X(8)               \n                                                   VALUE 'COCRDUP '.            \n          05 LIT-CARDUPDATEMAP                           PIC X(7)               \n                                                   VALUE 'CCRDUPA'.             \n                                                                                \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05  LIT-CARDDTLPGM                       PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05  LIT-CARDDTLTRANID                    PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05  LIT-CARDDTLMAPSET                    PIC X(7)                     \n                                                   VALUE 'COCRDSL'.             \n          05  LIT-CARDDTLMAP                       PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-ACCTFILENAME                      PIC X(8)                     \n                                                   VALUE 'ACCTDAT '.            \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CUSTFILENAME                      PIC X(8)                     \n                                                   VALUE 'CUSTDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n          05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CXACAIX '.            \n          05 LIT-ALL-ALPHA-FROM                    PIC X(52)                    \n             VALUE                                                              \n             'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.            \n          05 LIT-ALL-SPACES-TO                     PIC X(52)                    \n                                                   VALUE SPACES.                \n          05 LIT-UPPER                             PIC X(26)                    \n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.            \n          05 LIT-LOWER                             PIC X(26)                    \n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.            \n                                                                                \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CA-CALL-CONTEXT.                                                   \n             10 CA-FROM-PROGRAM                    PIC X(08).                   \n             10 CA-FROM-TRANID                     PIC X(04).                   \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n                                                                                \n      *BMS Copybook                                                             \n       COPY COACTVW.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *ACCOUNT RECORD LAYOUT                                                    \n       COPY CVACT01Y.                                                           \n                                                                                \n                                                                                \n      *CUSTOMER RECORD LAYOUT                                                   \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n       COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.",
            "description": "This Working Storage Section defines the data structures used in the COACTVWC program for account view functionality in the CardDemo application. It contains several key components:\n\n1. CICS processing variables for handling response codes and transaction IDs\n2. Input validation flags for tracking the status of user inputs, particularly for account and customer filtering\n3. File handling structures including record identifiers for card cross-reference data and flags to track successful record retrieval from account and customer master files\n4. Comprehensive error handling structures for file operations with detailed message formatting\n5. Information and status message fields with predefined values for various user interactions and error conditions\n6. Program constants including transaction IDs, program names, mapsets, and file names for navigation between different components of the CardDemo system\n7. Character conversion tables for case manipulation\n\nThe section incorporates multiple copybooks for common structures including card data (CVCRD01Y), communication area (COCOM01Y), screen titles (COTTL01Y), BMS screen definition (COACTVW), date handling (CSDAT01Y), messaging (CSMSG01Y, CSMSG02Y), user data (CSUSR01Y), and various record layouts for accounts (CVACT01Y), customers (CVACT02Y, CVCUS01Y), and card cross-references (CVACT03Y).\n\nThis comprehensive data structure supports the program's main functions of account lookup, data validation, and information display while facilitating integration with other CardDemo components."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.",
            "description": "This section defines the DFHCOMMAREA structure in the Linkage Section, which serves as the communication area for data exchange between CICS programs. It contains a single field defined as a variable-length array of 1-byte elements that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive and process variable-sized data from calling programs within the CardDemo application."
          }
        ],
        "copybooks": [],
        "code": "WORKING-STORAGE SECTION.                                                 \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CUST-FLAG                     PIC X(1).                    \n           88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CUSTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-CUSTFILTER-BLANK                VALUE ' '.                   \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n      *  05  EDIT-FIELD-9-2                PIC +ZZZ,ZZZ,ZZZ.99.                 \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-XREF-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-CUST-ID                 PIC 9(09).                   \n           10  WS-CARD-RID-CUST-ID-X REDEFINES                                  \n                  WS-CARD-RID-CUST-ID              PIC X(09).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-READ-FLAGS. \n           10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).\n              88 FOUND-ACCT-IN-MASTER              VALUE '1'.\n           10 WS-CUST-MASTER-READ-FLAG             PIC X(1).\n              88 FOUND-CUST-IN-MASTER              VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-PROMPT-FOR-INPUT                 VALUE                        \n               'Enter or update id of account to display'.\n           88  WS-INFORM-OUTPUT                    VALUE\n               'Displaying details of given Account'.                           \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in account card xref file'.           \n           88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE                        \n               'Did not find this account in account master file'.              \n           88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE                        \n               'Did not find associated customer in master file'.               \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading account card xref File'.                          \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      *****************************************************************         \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COACTVWC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CAVW'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COACTVW '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CACTVWA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CARDUPDATEPGM                           PIC X(8)               \n                                                   VALUE 'COCRDUPC'.            \n          05 LIT-CARDUDPATETRANID                        PIC X(4)               \n                                                   VALUE 'CCUP'.                \n          05 LIT-CARDUPDATEMAPSET                        PIC X(8)               \n                                                   VALUE 'COCRDUP '.            \n          05 LIT-CARDUPDATEMAP                           PIC X(7)               \n                                                   VALUE 'CCRDUPA'.             \n                                                                                \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05  LIT-CARDDTLPGM                       PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05  LIT-CARDDTLTRANID                    PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05  LIT-CARDDTLMAPSET                    PIC X(7)                     \n                                                   VALUE 'COCRDSL'.             \n          05  LIT-CARDDTLMAP                       PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-ACCTFILENAME                      PIC X(8)                     \n                                                   VALUE 'ACCTDAT '.            \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CUSTFILENAME                      PIC X(8)                     \n                                                   VALUE 'CUSTDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n          05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CXACAIX '.            \n          05 LIT-ALL-ALPHA-FROM                    PIC X(52)                    \n             VALUE                                                              \n             'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.            \n          05 LIT-ALL-SPACES-TO                     PIC X(52)                    \n                                                   VALUE SPACES.                \n          05 LIT-UPPER                             PIC X(26)                    \n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.            \n          05 LIT-LOWER                             PIC X(26)                    \n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.            \n                                                                                \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CA-CALL-CONTEXT.                                                   \n             10 CA-FROM-PROGRAM                    PIC X(08).                   \n             10 CA-FROM-TRANID                     PIC X(04).                   \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n                                                                                \n      *BMS Copybook                                                             \n       COPY COACTVW.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *ACCOUNT RECORD LAYOUT                                                    \n       COPY CVACT01Y.                                                           \n                                                                                \n                                                                                \n      *CUSTOMER RECORD LAYOUT                                                   \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n       COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN."
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-MAIN",
            "code": "EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM                             \n               AND NOT CDEMO-PGM-REENTER)                                       \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03                                                   \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n      *****************************************************************         \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n              WHEN CCARD-AID-PFK03                                              \n      ******************************************************************        \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                             PROGRAM (CDEMO-TO-PROGRAM)                         \n                             COMMAREA(CARDDEMO-COMMAREA)                        \n                   END-EXEC                                                     \n              WHEN CDEMO-PGM-ENTER                                              \n      ******************************************************************        \n      *            COMING FROM SOME OTHER CONTEXT                               \n      *            SELECTION CRITERIA TO BE GATHERED                            \n      ******************************************************************        \n                   PERFORM 1000-SEND-MAP THRU                                   \n                           1000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-REENTER                                            \n                   PERFORM 2000-PROCESS-INPUTS                                  \n                      THRU 2000-PROCESS-INPUTS-EXIT                             \n                   IF INPUT-ERROR                                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   ELSE                                                         \n                      PERFORM 9000-READ-ACCT                                    \n                         THRU 9000-READ-ACCT-EXIT                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   END-IF                                                       \n             WHEN OTHER                                                         \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO WS-RETURN-MSG                         \n                   PERFORM SEND-PLAIN-TEXT                                      \n                      THRU SEND-PLAIN-TEXT-EXIT                                 \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message that slipped through             \n      * Display and return                                                      \n           IF INPUT-ERROR                                                       \n              MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                            \n              PERFORM 1000-SEND-MAP                                             \n                 THRU 1000-SEND-MAP-EXIT                                        \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n           .",
            "description": "This paragraph serves as the main control flow for the COACTVWC program, handling initialization, user input processing, and navigation. It begins by setting up error handling and initializing work areas, then processes the communication area to maintain context between program calls. The paragraph evaluates user actions based on PF keys pressed, with specific handling for PF3 (exit) and different program entry states. When a user enters the program initially, it displays the account search screen. Upon re-entry with user input, it validates the input, retrieves account information if valid, and redisplays the screen with results or error messages. The code includes thorough error handling throughout and maintains program context for proper navigation within the CardDemo application flow."
          },
          {
            "name": "COMMON-RETURN",
            "code": "MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the return logic for the COACTVWC program. It first transfers any error or status message to the communication area's error message field. Then it prepares the return communication area by combining the standard CardDemo communication area with this program's specific data. Finally, it executes a CICS RETURN command that maintains the same transaction ID and passes back the combined communication area to the calling program. This standardized return mechanism ensures proper state preservation and error reporting when control is returned to the caller."
          },
          {
            "name": "0000-MAIN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as the exit point for the program, marking the end of processing. It's a simple control structure that allows the program to return control to the calling module or terminate execution after completing its account view operations."
          },
          {
            "name": "0000-MAIN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as the exit point for the program, marking the end of processing. It's a simple control structure that allows the program to return control to the calling module or terminate execution after completing its account view operations."
          },
          {
            "name": "1000-SEND-MAP",
            "code": "PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SETUP-SCREEN-VARS                                       \n              THRU 1200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SEND-SCREEN                                             \n              THRU 1400-SEND-SCREEN-EXIT                                        \n           .",
            "description": "This paragraph orchestrates the preparation and display of the account view screen. It follows a sequential process by first initializing the screen (1100-SCREEN-INIT), then setting up the screen variables with appropriate values (1200-SETUP-SCREEN-VARS), configuring the screen attributes for proper display formatting (1300-SETUP-SCREEN-ATTRS), and finally sending the completed screen to the user terminal (1400-SEND-SCREEN). This structured approach separates the different aspects of screen handling into distinct steps, making the code more maintainable and easier to troubleshoot."
          },
          {
            "name": "1000-SEND-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as a simple exit point for the 1000-SEND-MAP routine in the COACTVWC program. It marks the end of the routine that handles displaying the account view screen to the user, providing a clean control flow structure within the program."
          },
          {
            "name": "1100-SCREEN-INIT",
            "code": "MOVE LOW-VALUES             TO CACTVWAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CACTVWAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CACTVWAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CACTVWAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CACTVWAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CACTVWAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CACTVWAO                  \n                                                                                \n           .",
            "description": "This paragraph initializes the account view screen by clearing the output area and populating standard header information. It retrieves the current system date and time using the FUNCTION CURRENT-DATE, formats these values into display format (MM/DD/YY and HH:MM:SS), and places them on the screen. The paragraph also sets up common screen elements including title information and program identification details. This initialization routine prepares the screen before any account-specific data is retrieved or displayed."
          },
          {
            "name": "1100-SCREEN-INIT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen initialization routine in the COACTVWC program. It marks the end of the screen initialization process, allowing the program to return control to the calling section after the account view screen has been properly set up for display to the user."
          },
          {
            "name": "1200-SETUP-SCREEN-VARS",
            "code": "*    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n              SET  WS-PROMPT-FOR-INPUT TO TRUE                                  \n           ELSE\n              IF FLG-ACCTFILTER-BLANK  \n                 MOVE LOW-VALUES   TO ACCTSIDO OF CACTVWAO                      \n              ELSE                                                              \n                 MOVE CC-ACCT-ID   TO ACCTSIDO OF CACTVWAO                      \n              END-IF                                                            \n                                                                                \n              IF FOUND-ACCT-IN-MASTER                                           \n              OR FOUND-CUST-IN-MASTER                                           \n                 MOVE ACCT-ACTIVE-STATUS  TO ACSTTUSO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-BAL       TO ACURBALO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CREDIT-LIMIT   TO ACRDLIMO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CASH-CREDIT-LIMIT\n                                          TO ACSHLIMO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-CYC-CREDIT          \n                                          TO ACRCYCRO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-CYC-DEBIT TO ACRCYDBO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-OPEN-DATE      TO ADTOPENO OF CACTVWAO               \n                 MOVE ACCT-EXPIRAION-DATE TO AEXPDTO  OF CACTVWAO               \n                 MOVE ACCT-REISSUE-DATE   TO AREISDTO OF CACTVWAO               \n                 MOVE ACCT-GROUP-ID       TO AADDGRPO OF CACTVWAO               \n              END-IF                                                            \n                                                                                \n              IF FOUND-CUST-IN-MASTER                                           \n                MOVE CUST-ID              TO ACSTNUMO OF CACTVWAO               \n      *         MOVE CUST-SSN             TO ACSTSSNO OF CACTVWAO       \n                STRING \n                    CUST-SSN(1:3)\n                    '-'                 \n                    CUST-SSN(4:2)\n                    '-'\n                    CUST-SSN(6:4)\n                    DELIMITED BY SIZE\n                    INTO ACSTSSNO OF CACTVWAO\n                END-STRING                                                      \n                MOVE CUST-FICO-CREDIT-SCORE                                     \n                                          TO ACSTFCOO OF CACTVWAO               \n                MOVE CUST-DOB-YYYY-MM-DD  TO ACSTDOBO OF CACTVWAO               \n                MOVE CUST-FIRST-NAME      TO ACSFNAMO OF CACTVWAO               \n                MOVE CUST-MIDDLE-NAME     TO ACSMNAMO OF CACTVWAO               \n                MOVE CUST-LAST-NAME       TO ACSLNAMO OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-1     TO ACSADL1O OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-2     TO ACSADL2O OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-3     TO ACSCITYO OF CACTVWAO               \n                MOVE CUST-ADDR-STATE-CD   TO ACSSTTEO OF CACTVWAO               \n                MOVE CUST-ADDR-ZIP        TO ACSZIPCO OF CACTVWAO               \n                MOVE CUST-ADDR-COUNTRY-CD TO ACSCTRYO OF CACTVWAO               \n                MOVE CUST-PHONE-NUM-1     TO ACSPHN1O OF CACTVWAO               \n                MOVE CUST-PHONE-NUM-2     TO ACSPHN2O OF CACTVWAO               \n                MOVE CUST-GOVT-ISSUED-ID  TO ACSGOVTO OF CACTVWAO               \n                MOVE CUST-EFT-ACCOUNT-ID  TO ACSEFTCO OF CACTVWAO               \n                MOVE CUST-PRI-CARD-HOLDER-IND                                   \n                                          TO ACSPFLGO OF CACTVWAO               \n              END-IF                                                            \n                                                                                \n            END-IF                                                              \n                                                                                \n      *    SETUP MESSAGE                                                        \n           IF WS-NO-INFO-MESSAGE                                                \n             SET WS-PROMPT-FOR-INPUT TO TRUE                                    \n           END-IF                                                               \n                                                                                \n           MOVE WS-RETURN-MSG          TO ERRMSGO OF CACTVWAO                   \n                                                                                \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CACTVWAO                  \n           .",
            "description": "This paragraph populates the account view screen with data based on the program's state. It first checks if this is an initial call (EIBCALEN = 0) or a subsequent interaction. For subsequent interactions, it handles the account ID field display based on whether a filter was provided. When account or customer records have been found, it populates numerous screen fields with account information (status, balance, credit limits, dates) and customer details (name, address, contact information, identification numbers). The paragraph formats the Social Security Number with hyphens for display purposes. It also manages informational and error messages to be displayed on the screen. This logic serves as the data preparation step before rendering the account view interface to the user."
          },
          {
            "name": "1200-SETUP-SCREEN-VARS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1200-SETUP-SCREEN-VARS routine. It provides a clean termination point for the screen variable setup process, allowing the program to return control to the calling routine after completing the initialization of screen display variables."
          },
          {
            "name": "1300-SETUP-SCREEN-ATTRS",
            "code": "*    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           MOVE DFHBMFSE               TO ACCTSIDA OF CACTVWAI                  \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CACTVWAI                  \n              WHEN OTHER                                                        \n                   MOVE -1             TO ACCTSIDL OF CACTVWAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           MOVE DFHDFCOL               TO ACCTSIDC OF CACTVWAO                  \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CACTVWAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CACTVWAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CACTVWAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGC OF CACTVWAO                  \n           ELSE                                                                 \n               MOVE DFHNEUTR           TO INFOMSGC OF CACTVWAO                  \n           END-IF                                                               \n           .",
            "description": "This paragraph configures the screen attributes for the account view interface. It sets up field protection, cursor positioning, and color coding based on the current state of the application. The paragraph first protects the account ID field using DFHBMFSE attribute, then positions the cursor at the account ID field regardless of the current condition. It applies color attributes to the account ID field, using red to highlight validation errors (when the account filter is invalid) or when a blank account ID is submitted on a re-entry. The paragraph also handles the display attributes for information messages, making them dark if no message is present or neutral color if a message needs to be displayed. These visual cues help guide the user through the account search process by clearly indicating input errors and required fields."
          },
          {
            "name": "1300-SETUP-SCREEN-ATTRS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen attributes setup routine in the COACTVWC program. It marks the end of the 1300-SETUP-SCREEN-ATTRS section, allowing the program to return control to the calling routine after screen attribute initialization has been completed."
          },
          {
            "name": "1400-SEND-SCREEN",
            "code": "MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n           SET  CDEMO-PGM-REENTER TO TRUE                                       \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CACTVWAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the screen display functionality for the account view component. It sets up the next map and mapset values in the common communication area, indicating that the program should be re-entered after the screen is displayed. The paragraph then executes a CICS SEND MAP command to display the account view screen (CACTVWAO) to the user, positioning the cursor appropriately. The ERASE option clears the screen before displaying the new content, while FREEKB unlocks the keyboard for user input. The response code from this operation is captured in WS-RESP-CD for error handling purposes."
          },
          {
            "name": "1400-SEND-SCREEN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen sending routine in the COACTVWC program. It marks the end of the 1400-SEND-SCREEN section, allowing the program to return control to the calling section after the account view screen has been sent to the user."
          },
          {
            "name": "2000-PROCESS-INPUTS",
            "code": "PERFORM 2100-RECEIVE-MAP                                             \n              THRU 2100-RECEIVE-MAP-EXIT                                        \n           PERFORM 2200-EDIT-MAP-INPUTS                                         \n              THRU 2200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .",
            "description": "This paragraph handles the initial processing of user inputs for the account view function. It first receives the map data from the user interface, then validates the input data through the edit map inputs routine. After processing, it sets up the error message (if any) and prepares for the next program flow by setting the program, mapset, and map names in the communication area. This establishes the foundation for subsequent processing by ensuring valid input before attempting to retrieve account information."
          },
          {
            "name": "2000-PROCESS-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2000-PROCESS-INPUTS section of the COACTVWC program. It provides a clean termination point for the input processing logic, allowing the program flow to return to the calling section after input validation and processing has been completed."
          },
          {
            "name": "2100-RECEIVE-MAP",
            "code": "EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CACTVWAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n           .",
            "description": "This paragraph receives user input from the screen map named in LIT-THISMAP within the mapset LIT-THISMAPSET. It stores the received data into the CACTVWAI structure, which likely contains the account search criteria entered by the user. The paragraph captures both response and reason codes in WS-RESP-CD and WS-REAS-CD variables, which will be used for error handling if the receive operation encounters any issues."
          },
          {
            "name": "2100-RECEIVE-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2100-RECEIVE-MAP routine in the COACTVWC program. It provides a clean termination point for the routine that handles receiving user input from the account view screen. The paragraph contains only the EXIT statement, marking the end of the logical processing block without performing any additional operations."
          },
          {
            "name": "2200-EDIT-MAP-INPUTS",
            "code": "SET INPUT-OK                  TO TRUE                                \n           SET FLG-ACCTFILTER-ISVALID    TO TRUE                                \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CACTVWAI = '*'                                       \n           OR  ACCTSIDI OF CACTVWAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CACTVWAI TO  CC-ACCT-ID                         \n           END-IF                                                               \n                                                                                \n      *    INDIVIDUAL FIELD EDITS                                               \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n      *    CROSS FIELD EDITS                                                    \n           IF  FLG-ACCTFILTER-BLANK                                             \n               SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                          \n           END-IF                                                               \n           .",
            "description": "This paragraph handles the validation and processing of user input from the account search screen. It first sets flags to indicate valid input status, then processes the account ID field by either converting asterisks or spaces to low-values (which likely indicates a wildcard search) or capturing the specific account ID entered by the user. The code then performs detailed validation of the account field through the 2210-EDIT-ACCOUNT paragraph and checks if no search criteria were provided (blank account filter). The processing results are tracked through status flags that will determine subsequent program flow and error handling."
          },
          {
            "name": "2200-EDIT-MAP-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2200-EDIT-MAP-INPUTS routine. It marks the end of the input validation logic for the account view screen, allowing the program flow to return to the calling section after input processing is complete."
          },
          {
            "name": "2210-EDIT-ACCOUNT",
            "code": "SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC \n           OR CC-ACCT-ID  EQUAL ZEROES                                          \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'Account Filter must  be a non-zero 11 digit number'      00\n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the account ID input provided by the user. It first checks if the account ID is empty (spaces or low-values) and sets appropriate error flags if so, prompting the user to enter an account number. Next, it verifies that the account ID is numeric, non-zero, and properly formatted. If validation fails, it sets error flags and provides a specific error message indicating that the account filter must be a non-zero 11-digit number. When validation succeeds, it moves the account ID to the demo account ID field and sets a flag indicating the account filter is valid. The paragraph includes conditional message handling based on the return message settings."
          },
          {
            "name": "2210-EDIT-ACCOUNT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the account editing process in the COACTVWC program. It provides a clean termination point for the 2210-EDIT-ACCOUNT routine, allowing the program flow to return to the calling section after account validation and processing is complete."
          },
          {
            "name": "9000-READ-ACCT",
            "code": "SET  WS-NO-INFO-MESSAGE  TO TRUE\n           \n           MOVE CDEMO-ACCT-ID TO WS-CARD-RID-ACCT-ID                            \n                                                                                \n           PERFORM 9200-GETCARDXREF-BYACCT                                      \n              THRU 9200-GETCARDXREF-BYACCT-EXIT                                 \n                                                                                \n      *    IF DID-NOT-FIND-ACCT-IN-CARDXREF                                     \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n           PERFORM 9300-GETACCTDATA-BYACCT                                      \n              THRU 9300-GETACCTDATA-BYACCT-EXIT                                 \n                                                                                \n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT                                      \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID                            \n                                                                                \n           PERFORM 9400-GETCUSTDATA-BYCUST                                      \n              THRU 9400-GETCUSTDATA-BYCUST-EXIT                                 \n                                                                                \n           IF DID-NOT-FIND-CUST-IN-CUSTDAT                                      \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n                                                                                \n           .",
            "description": "This paragraph retrieves and validates account information across multiple data sources. It first sets a flag indicating no information message is needed, then uses the provided account ID to search for related records. The process follows a sequential validation flow: first checking the card cross-reference file, then retrieving account data, and finally fetching customer information using the customer ID obtained from the account record. At each step, the paragraph verifies successful record retrieval and exits if any lookup fails. This ensures that complete and valid account information is available before proceeding with further processing in the main program flow."
          },
          {
            "name": "9000-READ-ACCT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the account reading process in the COACTVWC program. It provides a structured way to terminate the account reading routine and return control to the calling section. This simple exit point helps maintain the program's modular structure and control flow when processing account information."
          },
          {
            "name": "9200-GETCARDXREF-BYACCT",
            "code": "*    Read the Card file. Access via alternate index ACCTID                \n      *                                                                         \n           EXEC CICS READ                                                       \n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)                          \n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)                     \n                INTO      (CARD-XREF-RECORD)                                    \n                LENGTH    (LENGTH OF CARD-XREF-RECORD)                          \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID              \n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM             \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE                       \n                  IF WS-RETURN-MSG-OFF                                          \n                    MOVE WS-RESP-CD               TO ERROR-RESP                 \n                    MOVE WS-REAS-CD               TO ERROR-RESP2                \n                    STRING                                                      \n                    'Account:'                                                  \n                     WS-CARD-RID-ACCT-ID-X                                      \n                    ' not found in'                                             \n                    ' Cross ref file.  Resp:'                                   \n                    ERROR-RESP                                                  \n                    ' Reas:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *          PERFORM SEND-LONG-TEXT                                         \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph retrieves card cross-reference information by account ID from the card cross-reference file using an alternate index. It performs a CICS READ operation on the CARDXREF file using the account ID as the key. Upon successful retrieval, it extracts the customer ID and card number from the record and stores them in the communication area fields. The paragraph includes comprehensive error handling for different scenarios: when the record is found (normal case), when no matching record exists (generating a specific \"Account not found\" error message), and for other unexpected errors (generating a generic file error message). The error handling logic sets appropriate flags to indicate the failure condition and constructs detailed error messages that include the response codes for troubleshooting purposes."
          },
          {
            "name": "9200-GETCARDXREF-BYACCT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the GETCARDXREF-BYACCT routine, marking the end of the process that retrieves card cross-reference data by account number. It provides a clean termination point for the routine, allowing control to return to the calling section after the card cross-reference data has been successfully retrieved or after handling any error conditions."
          },
          {
            "name": "9300-GETACCTDATA-BYACCT",
            "code": "EXEC CICS READ                                                       \n                DATASET   (LIT-ACCTFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)                     \n                INTO      (ACCOUNT-RECORD)                                      \n                LENGTH    (LENGTH OF ACCOUNT-RECORD)                            \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-ACCT-IN-MASTER        TO TRUE                       \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE                       \n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE                      \n                  IF WS-RETURN-MSG-OFF                                          \n                    MOVE WS-RESP-CD               TO ERROR-RESP                 \n                    MOVE WS-REAS-CD               TO ERROR-RESP2                \n                    STRING                                                      \n                    'Account:'                                                  \n                     WS-CARD-RID-ACCT-ID-X                                      \n                    ' not found in'                                             \n                    ' Acct Master file.Resp:'                                   \n                    ERROR-RESP                                                  \n                    ' Reas:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n      *                                                                         \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *           PERFORM SEND-LONG-TEXT                                        \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph retrieves account data from the account master file using the provided account ID. It performs a CICS READ operation on the account file using the account ID as the key. The paragraph handles three possible outcomes: successful retrieval (setting the FOUND-ACCT-IN-MASTER flag), record not found (setting appropriate error flags and constructing a user-friendly error message indicating the account wasn't found), or other file access errors (setting error flags and generating a technical error message with response codes). The error handling includes detailed information about the nature of the failure, which helps with troubleshooting. This is a critical component of the account lookup functionality, as it performs the primary data retrieval that drives subsequent processing in the program."
          },
          {
            "name": "9300-GETACCTDATA-BYACCT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the GETACCTDATA-BYACCT routine. It marks the end of the account data retrieval process when searching by account number, allowing the program to return control to the calling section after completing the account lookup operation."
          },
          {
            "name": "9400-GETCUSTDATA-BYCUST",
            "code": "EXEC CICS READ                                                       \n                DATASET   (LIT-CUSTFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CUST-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)                     \n                INTO      (CUSTOMER-RECORD)                                     \n                LENGTH    (LENGTH OF CUSTOMER-RECORD)                           \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CUST-IN-MASTER        TO TRUE                       \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE                       \n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE                      \n                  MOVE WS-RESP-CD               TO ERROR-RESP                   \n                  MOVE WS-REAS-CD               TO ERROR-RESP2                  \n                  IF WS-RETURN-MSG-OFF                                          \n                    STRING                                                      \n                    'CustId:'                                                   \n                     WS-CARD-RID-CUST-ID-X                                      \n                    ' not found'                                                \n                    ' in customer master.Resp: '                                \n                    ERROR-RESP                                                  \n                    ' REAS:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *           PERFORM SEND-LONG-TEXT                                        \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph retrieves customer data from the customer master file using the customer ID as the key. It executes a CICS READ command against the customer file (LIT-CUSTFILENAME) using the customer ID stored in WS-CARD-RID-CUST-ID-X as the record key. The retrieved data is stored in the CUSTOMER-RECORD structure.\n\nThe paragraph includes comprehensive error handling through an EVALUATE statement that processes three possible outcomes:\n1. When the read is successful (DFHRESP(NORMAL)), it sets the FOUND-CUST-IN-MASTER flag to TRUE.\n2. When the customer record is not found (DFHRESP(NOTFND)), it sets error flags (INPUT-ERROR and FLG-CUSTFILTER-NOT-OK) and constructs a detailed error message indicating the customer ID was not found in the master file.\n3. For any other response code, it sets error flags, captures the file operation details (READ operation on the customer file), and prepares a general file error message.\n\nThis functionality is a critical part of the account view process, as it retrieves the customer information needed to display complete account details."
          },
          {
            "name": "9400-GETCUSTDATA-BYCUST-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************",
            "description": "This paragraph serves as an exit point for the GETCUSTDATA-BYCUST routine, which retrieves customer data based on customer identification. The comment warns that this is a plain text exit that should not be used in production environments, suggesting it may be a simplified or unsecured implementation intended only for development or testing purposes within the CardDemo application."
          },
          {
            "name": "SEND-PLAIN-TEXT",
            "code": "EXEC CICS SEND TEXT                                                  \n                     FROM(WS-RETURN-MSG)                                        \n                     LENGTH(LENGTH OF WS-RETURN-MSG)                            \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends a plain text message to the user's terminal in the CardDemo account view component. It uses the CICS SEND TEXT command to display the content stored in WS-RETURN-MSG, specifying the length dynamically. The ERASE option clears the screen before displaying the message, while FREEKB unlocks the keyboard for user input. After sending the message, the paragraph executes a CICS RETURN command to end the current task and return control to CICS. This functionality is typically used for displaying error messages or informational text when standard screen formatting isn't required."
          },
          {
            "name": "SEND-PLAIN-TEXT-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************",
            "description": "This paragraph serves as an exit point for displaying long text messages, primarily intended for debugging purposes. It's specifically designed not to be used during normal program operation, but rather as a diagnostic tool for developers when troubleshooting issues in the account view functionality."
          },
          {
            "name": "SEND-LONG-TEXT",
            "code": "EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends a long message to the user's terminal screen using CICS SEND TEXT command. It displays the contents of the WS-LONG-MSG field, clears the screen (ERASE), and unlocks the keyboard (FREEKB). After sending the message, it returns control to CICS, effectively ending the transaction. This is typically used for displaying error messages or informational text that requires the full screen."
          },
          {
            "name": "SEND-LONG-TEXT-EXIT",
            "code": "EXIT                                                                 \n           . \n      *****************************************************************         \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .",
            "description": "This paragraph serves as an exit point for the SEND-LONG-TEXT routine in the account view component. It includes a reference to the 'CSSTRPFY' copybook, which contains common code for storing and handling PF key information. This structure allows the program to maintain consistent PF key processing across different parts of the CardDemo application while providing a clean exit from the text display functionality."
          },
          {
            "name": "ABEND-ROUTINE",
            "code": "IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *",
            "description": "This paragraph handles abnormal termination (ABEND) processing in the COACTVWC program. When an error occurs that requires program termination, this routine ensures proper error messaging before ending execution. If no specific error message has been set (ABEND-MSG contains LOW-VALUES), it sets a default \"UNEXPECTED ABEND OCCURRED\" message. It identifies the current program as the source of the error by storing the program name in ABEND-CULPRIT. The routine then displays the error information to the user via a CICS SEND command, cancels any existing abend handlers to prevent recursive error handling, and finally terminates the program with abend code '9999'. This provides a controlled shutdown mechanism that communicates failure information to both users and system administrators."
          }
        ],
        "code": "0000-MAIN.                                                               \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM                             \n               AND NOT CDEMO-PGM-REENTER)                                       \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03                                                   \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n      *****************************************************************         \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n              WHEN CCARD-AID-PFK03                                              \n      ******************************************************************        \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                             PROGRAM (CDEMO-TO-PROGRAM)                         \n                             COMMAREA(CARDDEMO-COMMAREA)                        \n                   END-EXEC                                                     \n              WHEN CDEMO-PGM-ENTER                                              \n      ******************************************************************        \n      *            COMING FROM SOME OTHER CONTEXT                               \n      *            SELECTION CRITERIA TO BE GATHERED                            \n      ******************************************************************        \n                   PERFORM 1000-SEND-MAP THRU                                   \n                           1000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-REENTER                                            \n                   PERFORM 2000-PROCESS-INPUTS                                  \n                      THRU 2000-PROCESS-INPUTS-EXIT                             \n                   IF INPUT-ERROR                                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   ELSE                                                         \n                      PERFORM 9000-READ-ACCT                                    \n                         THRU 9000-READ-ACCT-EXIT                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   END-IF                                                       \n             WHEN OTHER                                                         \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO WS-RETURN-MSG                         \n                   PERFORM SEND-PLAIN-TEXT                                      \n                      THRU SEND-PLAIN-TEXT-EXIT                                 \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message that slipped through             \n      * Display and return                                                      \n           IF INPUT-ERROR                                                       \n              MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                            \n              PERFORM 1000-SEND-MAP                                             \n                 THRU 1000-SEND-MAP-EXIT                                        \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n           .                                                                    \n       COMMON-RETURN.                                                           \n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SETUP-SCREEN-VARS                                       \n              THRU 1200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SEND-SCREEN                                             \n              THRU 1400-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES             TO CACTVWAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CACTVWAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CACTVWAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CACTVWAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CACTVWAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CACTVWAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CACTVWAO                  \n                                                                                \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       1200-SETUP-SCREEN-VARS.                                                  \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n              SET  WS-PROMPT-FOR-INPUT TO TRUE                                  \n           ELSE\n              IF FLG-ACCTFILTER-BLANK  \n                 MOVE LOW-VALUES   TO ACCTSIDO OF CACTVWAO                      \n              ELSE                                                              \n                 MOVE CC-ACCT-ID   TO ACCTSIDO OF CACTVWAO                      \n              END-IF                                                            \n                                                                                \n              IF FOUND-ACCT-IN-MASTER                                           \n              OR FOUND-CUST-IN-MASTER                                           \n                 MOVE ACCT-ACTIVE-STATUS  TO ACSTTUSO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-BAL       TO ACURBALO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CREDIT-LIMIT   TO ACRDLIMO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CASH-CREDIT-LIMIT\n                                          TO ACSHLIMO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-CYC-CREDIT          \n                                          TO ACRCYCRO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-CYC-DEBIT TO ACRCYDBO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-OPEN-DATE      TO ADTOPENO OF CACTVWAO               \n                 MOVE ACCT-EXPIRAION-DATE TO AEXPDTO  OF CACTVWAO               \n                 MOVE ACCT-REISSUE-DATE   TO AREISDTO OF CACTVWAO               \n                 MOVE ACCT-GROUP-ID       TO AADDGRPO OF CACTVWAO               \n              END-IF                                                            \n                                                                                \n              IF FOUND-CUST-IN-MASTER                                           \n                MOVE CUST-ID              TO ACSTNUMO OF CACTVWAO               \n      *         MOVE CUST-SSN             TO ACSTSSNO OF CACTVWAO       \n                STRING \n                    CUST-SSN(1:3)\n                    '-'                 \n                    CUST-SSN(4:2)\n                    '-'\n                    CUST-SSN(6:4)\n                    DELIMITED BY SIZE\n                    INTO ACSTSSNO OF CACTVWAO\n                END-STRING                                                      \n                MOVE CUST-FICO-CREDIT-SCORE                                     \n                                          TO ACSTFCOO OF CACTVWAO               \n                MOVE CUST-DOB-YYYY-MM-DD  TO ACSTDOBO OF CACTVWAO               \n                MOVE CUST-FIRST-NAME      TO ACSFNAMO OF CACTVWAO               \n                MOVE CUST-MIDDLE-NAME     TO ACSMNAMO OF CACTVWAO               \n                MOVE CUST-LAST-NAME       TO ACSLNAMO OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-1     TO ACSADL1O OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-2     TO ACSADL2O OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-3     TO ACSCITYO OF CACTVWAO               \n                MOVE CUST-ADDR-STATE-CD   TO ACSSTTEO OF CACTVWAO               \n                MOVE CUST-ADDR-ZIP        TO ACSZIPCO OF CACTVWAO               \n                MOVE CUST-ADDR-COUNTRY-CD TO ACSCTRYO OF CACTVWAO               \n                MOVE CUST-PHONE-NUM-1     TO ACSPHN1O OF CACTVWAO               \n                MOVE CUST-PHONE-NUM-2     TO ACSPHN2O OF CACTVWAO               \n                MOVE CUST-GOVT-ISSUED-ID  TO ACSGOVTO OF CACTVWAO               \n                MOVE CUST-EFT-ACCOUNT-ID  TO ACSEFTCO OF CACTVWAO               \n                MOVE CUST-PRI-CARD-HOLDER-IND                                   \n                                          TO ACSPFLGO OF CACTVWAO               \n              END-IF                                                            \n                                                                                \n            END-IF                                                              \n                                                                                \n      *    SETUP MESSAGE                                                        \n           IF WS-NO-INFO-MESSAGE                                                \n             SET WS-PROMPT-FOR-INPUT TO TRUE                                    \n           END-IF                                                               \n                                                                                \n           MOVE WS-RETURN-MSG          TO ERRMSGO OF CACTVWAO                   \n                                                                                \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CACTVWAO                  \n           .                                                                    \n                                                                                \n       1200-SETUP-SCREEN-VARS-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1300-SETUP-SCREEN-ATTRS.                                                 \n      *    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           MOVE DFHBMFSE               TO ACCTSIDA OF CACTVWAI                  \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CACTVWAI                  \n              WHEN OTHER                                                        \n                   MOVE -1             TO ACCTSIDL OF CACTVWAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           MOVE DFHDFCOL               TO ACCTSIDC OF CACTVWAO                  \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CACTVWAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CACTVWAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CACTVWAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGC OF CACTVWAO                  \n           ELSE                                                                 \n               MOVE DFHNEUTR           TO INFOMSGC OF CACTVWAO                  \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n       1400-SEND-SCREEN.                                                        \n                                                                                \n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n           SET  CDEMO-PGM-REENTER TO TRUE                                       \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CACTVWAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .                                                                    \n       1400-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS.                                                     \n           PERFORM 2100-RECEIVE-MAP                                             \n              THRU 2100-RECEIVE-MAP-EXIT                                        \n           PERFORM 2200-EDIT-MAP-INPUTS                                         \n              THRU 2200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-MAP.                                                        \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CACTVWAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n       2100-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2200-EDIT-MAP-INPUTS.                                                    \n                                                                                \n           SET INPUT-OK                  TO TRUE                                \n           SET FLG-ACCTFILTER-ISVALID    TO TRUE                                \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CACTVWAI = '*'                                       \n           OR  ACCTSIDI OF CACTVWAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CACTVWAI TO  CC-ACCT-ID                         \n           END-IF                                                               \n                                                                                \n      *    INDIVIDUAL FIELD EDITS                                               \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n      *    CROSS FIELD EDITS                                                    \n           IF  FLG-ACCTFILTER-BLANK                                             \n               SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                          \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2200-EDIT-MAP-INPUTS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC \n           OR CC-ACCT-ID  EQUAL ZEROES                                          \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'Account Filter must  be a non-zero 11 digit number'      00\n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-ACCT.                                                          \n                                                                                \n           SET  WS-NO-INFO-MESSAGE  TO TRUE\n           \n           MOVE CDEMO-ACCT-ID TO WS-CARD-RID-ACCT-ID                            \n                                                                                \n           PERFORM 9200-GETCARDXREF-BYACCT                                      \n              THRU 9200-GETCARDXREF-BYACCT-EXIT                                 \n                                                                                \n      *    IF DID-NOT-FIND-ACCT-IN-CARDXREF                                     \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n           PERFORM 9300-GETACCTDATA-BYACCT                                      \n              THRU 9300-GETACCTDATA-BYACCT-EXIT                                 \n                                                                                \n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT                                      \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID                            \n                                                                                \n           PERFORM 9400-GETCUSTDATA-BYCUST                                      \n              THRU 9400-GETCUSTDATA-BYCUST-EXIT                                 \n                                                                                \n           IF DID-NOT-FIND-CUST-IN-CUSTDAT                                      \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n                                                                                \n           .                                                                    \n                                                                                \n       9000-READ-ACCT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n       9200-GETCARDXREF-BYACCT.                                                 \n                                                                                \n      *    Read the Card file. Access via alternate index ACCTID                \n      *                                                                         \n           EXEC CICS READ                                                       \n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)                          \n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)                     \n                INTO      (CARD-XREF-RECORD)                                    \n                LENGTH    (LENGTH OF CARD-XREF-RECORD)                          \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID              \n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM             \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE                       \n                  IF WS-RETURN-MSG-OFF                                          \n                    MOVE WS-RESP-CD               TO ERROR-RESP                 \n                    MOVE WS-REAS-CD               TO ERROR-RESP2                \n                    STRING                                                      \n                    'Account:'                                                  \n                     WS-CARD-RID-ACCT-ID-X                                      \n                    ' not found in'                                             \n                    ' Cross ref file.  Resp:'                                   \n                    ERROR-RESP                                                  \n                    ' Reas:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *          PERFORM SEND-LONG-TEXT                                         \n           END-EVALUATE                                                         \n           .                                                                    \n       9200-GETCARDXREF-BYACCT-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n       9300-GETACCTDATA-BYACCT.                                                 \n                                                                                \n           EXEC CICS READ                                                       \n                DATASET   (LIT-ACCTFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)                     \n                INTO      (ACCOUNT-RECORD)                                      \n                LENGTH    (LENGTH OF ACCOUNT-RECORD)                            \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-ACCT-IN-MASTER        TO TRUE                       \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE                       \n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE                      \n                  IF WS-RETURN-MSG-OFF                                          \n                    MOVE WS-RESP-CD               TO ERROR-RESP                 \n                    MOVE WS-REAS-CD               TO ERROR-RESP2                \n                    STRING                                                      \n                    'Account:'                                                  \n                     WS-CARD-RID-ACCT-ID-X                                      \n                    ' not found in'                                             \n                    ' Acct Master file.Resp:'                                   \n                    ERROR-RESP                                                  \n                    ' Reas:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n      *                                                                         \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *           PERFORM SEND-LONG-TEXT                                        \n           END-EVALUATE                                                         \n           .                                                                    \n       9300-GETACCTDATA-BYACCT-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9400-GETCUSTDATA-BYCUST.                                                 \n           EXEC CICS READ                                                       \n                DATASET   (LIT-CUSTFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CUST-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)                     \n                INTO      (CUSTOMER-RECORD)                                     \n                LENGTH    (LENGTH OF CUSTOMER-RECORD)                           \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CUST-IN-MASTER        TO TRUE                       \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE                       \n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE                      \n                  MOVE WS-RESP-CD               TO ERROR-RESP                   \n                  MOVE WS-REAS-CD               TO ERROR-RESP2                  \n                  IF WS-RETURN-MSG-OFF                                          \n                    STRING                                                      \n                    'CustId:'                                                   \n                     WS-CARD-RID-CUST-ID-X                                      \n                    ' not found'                                                \n                    ' in customer master.Resp: '                                \n                    ERROR-RESP                                                  \n                    ' REAS:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *           PERFORM SEND-LONG-TEXT                                        \n           END-EVALUATE                                                         \n           .                                                                    \n       9400-GETCUSTDATA-BYCUST-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-RETURN-MSG)                                        \n                     LENGTH(LENGTH OF WS-RETURN-MSG)                            \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           . \n      *****************************************************************         \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n       ABEND-ROUTINE.                                                           \n                                                                                \n           IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *"
      },
      "description": "This program, COACTVWC, is a CICS business logic component that handles account view requests in the CardDemo application. It allows users to search for and display detailed account information by entering an account number. The program retrieves account data from multiple files, including account master records, customer information, and card cross-reference data.\n\nWhen executed, the program displays a screen where users can enter an account ID. Upon submission, it validates the input, retrieves the corresponding account information from the database files, and displays comprehensive account details including balance, credit limits, customer information, and address data. The program performs thorough error handling for scenarios such as invalid account numbers, missing records, or file access errors.\n\nThe application follows a structured flow with clear separation between screen handling, input validation, and data retrieval functions. It integrates with other components of the CardDemo system through a common communication area and provides navigation capabilities to related functions through PF keys.",
      "error_handling": null,
      "code": "      *****************************************************************         \n      * Program:     COACTVWC.CBL                                     *         \n      * Layer:       Business logic                                   *         \n      * Function:    Accept and process Account View request          *         \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************        \n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.                                                              \n           COACTVWC.                                                            \n       DATE-WRITTEN.                                                            \n           May 2022.                                                            \n       DATE-COMPILED.                                                           \n           Today.                                                               \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n                                                                                \n       DATA DIVISION.                                                           \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CUST-FLAG                     PIC X(1).                    \n           88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CUSTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-CUSTFILTER-BLANK                VALUE ' '.                   \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n      *  05  EDIT-FIELD-9-2                PIC +ZZZ,ZZZ,ZZZ.99.                 \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-XREF-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-CUST-ID                 PIC 9(09).                   \n           10  WS-CARD-RID-CUST-ID-X REDEFINES                                  \n                  WS-CARD-RID-CUST-ID              PIC X(09).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-READ-FLAGS. \n           10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).\n              88 FOUND-ACCT-IN-MASTER              VALUE '1'.\n           10 WS-CUST-MASTER-READ-FLAG             PIC X(1).\n              88 FOUND-CUST-IN-MASTER              VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-PROMPT-FOR-INPUT                 VALUE                        \n               'Enter or update id of account to display'.\n           88  WS-INFORM-OUTPUT                    VALUE\n               'Displaying details of given Account'.                           \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in account card xref file'.           \n           88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE                        \n               'Did not find this account in account master file'.              \n           88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE                        \n               'Did not find associated customer in master file'.               \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading account card xref File'.                          \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      *****************************************************************         \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COACTVWC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CAVW'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COACTVW '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CACTVWA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CARDUPDATEPGM                           PIC X(8)               \n                                                   VALUE 'COCRDUPC'.            \n          05 LIT-CARDUDPATETRANID                        PIC X(4)               \n                                                   VALUE 'CCUP'.                \n          05 LIT-CARDUPDATEMAPSET                        PIC X(8)               \n                                                   VALUE 'COCRDUP '.            \n          05 LIT-CARDUPDATEMAP                           PIC X(7)               \n                                                   VALUE 'CCRDUPA'.             \n                                                                                \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05  LIT-CARDDTLPGM                       PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05  LIT-CARDDTLTRANID                    PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05  LIT-CARDDTLMAPSET                    PIC X(7)                     \n                                                   VALUE 'COCRDSL'.             \n          05  LIT-CARDDTLMAP                       PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-ACCTFILENAME                      PIC X(8)                     \n                                                   VALUE 'ACCTDAT '.            \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CUSTFILENAME                      PIC X(8)                     \n                                                   VALUE 'CUSTDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n          05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CXACAIX '.            \n          05 LIT-ALL-ALPHA-FROM                    PIC X(52)                    \n             VALUE                                                              \n             'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.            \n          05 LIT-ALL-SPACES-TO                     PIC X(52)                    \n                                                   VALUE SPACES.                \n          05 LIT-UPPER                             PIC X(26)                    \n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.            \n          05 LIT-LOWER                             PIC X(26)                    \n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.            \n                                                                                \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CA-CALL-CONTEXT.                                                   \n             10 CA-FROM-PROGRAM                    PIC X(08).                   \n             10 CA-FROM-TRANID                     PIC X(04).                   \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n                                                                                \n      *BMS Copybook                                                             \n       COPY COACTVW.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *ACCOUNT RECORD LAYOUT                                                    \n       COPY CVACT01Y.                                                           \n                                                                                \n                                                                                \n      *CUSTOMER RECORD LAYOUT                                                   \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n       COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.                     \n                                                                                \n       PROCEDURE DIVISION.                                                      \n       0000-MAIN.                                                               \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM                             \n               AND NOT CDEMO-PGM-REENTER)                                       \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03                                                   \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n      *****************************************************************         \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n              WHEN CCARD-AID-PFK03                                              \n      ******************************************************************        \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                             PROGRAM (CDEMO-TO-PROGRAM)                         \n                             COMMAREA(CARDDEMO-COMMAREA)                        \n                   END-EXEC                                                     \n              WHEN CDEMO-PGM-ENTER                                              \n      ******************************************************************        \n      *            COMING FROM SOME OTHER CONTEXT                               \n      *            SELECTION CRITERIA TO BE GATHERED                            \n      ******************************************************************        \n                   PERFORM 1000-SEND-MAP THRU                                   \n                           1000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-REENTER                                            \n                   PERFORM 2000-PROCESS-INPUTS                                  \n                      THRU 2000-PROCESS-INPUTS-EXIT                             \n                   IF INPUT-ERROR                                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   ELSE                                                         \n                      PERFORM 9000-READ-ACCT                                    \n                         THRU 9000-READ-ACCT-EXIT                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   END-IF                                                       \n             WHEN OTHER                                                         \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO WS-RETURN-MSG                         \n                   PERFORM SEND-PLAIN-TEXT                                      \n                      THRU SEND-PLAIN-TEXT-EXIT                                 \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message that slipped through             \n      * Display and return                                                      \n           IF INPUT-ERROR                                                       \n              MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                            \n              PERFORM 1000-SEND-MAP                                             \n                 THRU 1000-SEND-MAP-EXIT                                        \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n           .                                                                    \n       COMMON-RETURN.                                                           \n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SETUP-SCREEN-VARS                                       \n              THRU 1200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SEND-SCREEN                                             \n              THRU 1400-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES             TO CACTVWAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CACTVWAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CACTVWAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CACTVWAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CACTVWAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CACTVWAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CACTVWAO                  \n                                                                                \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       1200-SETUP-SCREEN-VARS.                                                  \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n              SET  WS-PROMPT-FOR-INPUT TO TRUE                                  \n           ELSE\n              IF FLG-ACCTFILTER-BLANK  \n                 MOVE LOW-VALUES   TO ACCTSIDO OF CACTVWAO                      \n              ELSE                                                              \n                 MOVE CC-ACCT-ID   TO ACCTSIDO OF CACTVWAO                      \n              END-IF                                                            \n                                                                                \n              IF FOUND-ACCT-IN-MASTER                                           \n              OR FOUND-CUST-IN-MASTER                                           \n                 MOVE ACCT-ACTIVE-STATUS  TO ACSTTUSO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-BAL       TO ACURBALO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CREDIT-LIMIT   TO ACRDLIMO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CASH-CREDIT-LIMIT\n                                          TO ACSHLIMO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-CYC-CREDIT          \n                                          TO ACRCYCRO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-CURR-CYC-DEBIT TO ACRCYDBO OF CACTVWAO               \n                                                                                \n                 MOVE ACCT-OPEN-DATE      TO ADTOPENO OF CACTVWAO               \n                 MOVE ACCT-EXPIRAION-DATE TO AEXPDTO  OF CACTVWAO               \n                 MOVE ACCT-REISSUE-DATE   TO AREISDTO OF CACTVWAO               \n                 MOVE ACCT-GROUP-ID       TO AADDGRPO OF CACTVWAO               \n              END-IF                                                            \n                                                                                \n              IF FOUND-CUST-IN-MASTER                                           \n                MOVE CUST-ID              TO ACSTNUMO OF CACTVWAO               \n      *         MOVE CUST-SSN             TO ACSTSSNO OF CACTVWAO       \n                STRING \n                    CUST-SSN(1:3)\n                    '-'                 \n                    CUST-SSN(4:2)\n                    '-'\n                    CUST-SSN(6:4)\n                    DELIMITED BY SIZE\n                    INTO ACSTSSNO OF CACTVWAO\n                END-STRING                                                      \n                MOVE CUST-FICO-CREDIT-SCORE                                     \n                                          TO ACSTFCOO OF CACTVWAO               \n                MOVE CUST-DOB-YYYY-MM-DD  TO ACSTDOBO OF CACTVWAO               \n                MOVE CUST-FIRST-NAME      TO ACSFNAMO OF CACTVWAO               \n                MOVE CUST-MIDDLE-NAME     TO ACSMNAMO OF CACTVWAO               \n                MOVE CUST-LAST-NAME       TO ACSLNAMO OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-1     TO ACSADL1O OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-2     TO ACSADL2O OF CACTVWAO               \n                MOVE CUST-ADDR-LINE-3     TO ACSCITYO OF CACTVWAO               \n                MOVE CUST-ADDR-STATE-CD   TO ACSSTTEO OF CACTVWAO               \n                MOVE CUST-ADDR-ZIP        TO ACSZIPCO OF CACTVWAO               \n                MOVE CUST-ADDR-COUNTRY-CD TO ACSCTRYO OF CACTVWAO               \n                MOVE CUST-PHONE-NUM-1     TO ACSPHN1O OF CACTVWAO               \n                MOVE CUST-PHONE-NUM-2     TO ACSPHN2O OF CACTVWAO               \n                MOVE CUST-GOVT-ISSUED-ID  TO ACSGOVTO OF CACTVWAO               \n                MOVE CUST-EFT-ACCOUNT-ID  TO ACSEFTCO OF CACTVWAO               \n                MOVE CUST-PRI-CARD-HOLDER-IND                                   \n                                          TO ACSPFLGO OF CACTVWAO               \n              END-IF                                                            \n                                                                                \n            END-IF                                                              \n                                                                                \n      *    SETUP MESSAGE                                                        \n           IF WS-NO-INFO-MESSAGE                                                \n             SET WS-PROMPT-FOR-INPUT TO TRUE                                    \n           END-IF                                                               \n                                                                                \n           MOVE WS-RETURN-MSG          TO ERRMSGO OF CACTVWAO                   \n                                                                                \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CACTVWAO                  \n           .                                                                    \n                                                                                \n       1200-SETUP-SCREEN-VARS-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1300-SETUP-SCREEN-ATTRS.                                                 \n      *    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           MOVE DFHBMFSE               TO ACCTSIDA OF CACTVWAI                  \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CACTVWAI                  \n              WHEN OTHER                                                        \n                   MOVE -1             TO ACCTSIDL OF CACTVWAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           MOVE DFHDFCOL               TO ACCTSIDC OF CACTVWAO                  \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CACTVWAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CACTVWAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CACTVWAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGC OF CACTVWAO                  \n           ELSE                                                                 \n               MOVE DFHNEUTR           TO INFOMSGC OF CACTVWAO                  \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n       1400-SEND-SCREEN.                                                        \n                                                                                \n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n           SET  CDEMO-PGM-REENTER TO TRUE                                       \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CACTVWAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .                                                                    \n       1400-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS.                                                     \n           PERFORM 2100-RECEIVE-MAP                                             \n              THRU 2100-RECEIVE-MAP-EXIT                                        \n           PERFORM 2200-EDIT-MAP-INPUTS                                         \n              THRU 2200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-MAP.                                                        \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CACTVWAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n       2100-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2200-EDIT-MAP-INPUTS.                                                    \n                                                                                \n           SET INPUT-OK                  TO TRUE                                \n           SET FLG-ACCTFILTER-ISVALID    TO TRUE                                \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CACTVWAI = '*'                                       \n           OR  ACCTSIDI OF CACTVWAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CACTVWAI TO  CC-ACCT-ID                         \n           END-IF                                                               \n                                                                                \n      *    INDIVIDUAL FIELD EDITS                                               \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n      *    CROSS FIELD EDITS                                                    \n           IF  FLG-ACCTFILTER-BLANK                                             \n               SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                          \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2200-EDIT-MAP-INPUTS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC \n           OR CC-ACCT-ID  EQUAL ZEROES                                          \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'Account Filter must  be a non-zero 11 digit number'      00\n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-ACCT.                                                          \n                                                                                \n           SET  WS-NO-INFO-MESSAGE  TO TRUE\n           \n           MOVE CDEMO-ACCT-ID TO WS-CARD-RID-ACCT-ID                            \n                                                                                \n           PERFORM 9200-GETCARDXREF-BYACCT                                      \n              THRU 9200-GETCARDXREF-BYACCT-EXIT                                 \n                                                                                \n      *    IF DID-NOT-FIND-ACCT-IN-CARDXREF                                     \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n           PERFORM 9300-GETACCTDATA-BYACCT                                      \n              THRU 9300-GETACCTDATA-BYACCT-EXIT                                 \n                                                                                \n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT                                      \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID                            \n                                                                                \n           PERFORM 9400-GETCUSTDATA-BYCUST                                      \n              THRU 9400-GETCUSTDATA-BYCUST-EXIT                                 \n                                                                                \n           IF DID-NOT-FIND-CUST-IN-CUSTDAT                                      \n              GO TO 9000-READ-ACCT-EXIT                                         \n           END-IF                                                               \n                                                                                \n                                                                                \n           .                                                                    \n                                                                                \n       9000-READ-ACCT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n       9200-GETCARDXREF-BYACCT.                                                 \n                                                                                \n      *    Read the Card file. Access via alternate index ACCTID                \n      *                                                                         \n           EXEC CICS READ                                                       \n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)                          \n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)                     \n                INTO      (CARD-XREF-RECORD)                                    \n                LENGTH    (LENGTH OF CARD-XREF-RECORD)                          \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID              \n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM             \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE                       \n                  IF WS-RETURN-MSG-OFF                                          \n                    MOVE WS-RESP-CD               TO ERROR-RESP                 \n                    MOVE WS-REAS-CD               TO ERROR-RESP2                \n                    STRING                                                      \n                    'Account:'                                                  \n                     WS-CARD-RID-ACCT-ID-X                                      \n                    ' not found in'                                             \n                    ' Cross ref file.  Resp:'                                   \n                    ERROR-RESP                                                  \n                    ' Reas:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *          PERFORM SEND-LONG-TEXT                                         \n           END-EVALUATE                                                         \n           .                                                                    \n       9200-GETCARDXREF-BYACCT-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n       9300-GETACCTDATA-BYACCT.                                                 \n                                                                                \n           EXEC CICS READ                                                       \n                DATASET   (LIT-ACCTFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)                     \n                INTO      (ACCOUNT-RECORD)                                      \n                LENGTH    (LENGTH OF ACCOUNT-RECORD)                            \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-ACCT-IN-MASTER        TO TRUE                       \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE                       \n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE                      \n                  IF WS-RETURN-MSG-OFF                                          \n                    MOVE WS-RESP-CD               TO ERROR-RESP                 \n                    MOVE WS-REAS-CD               TO ERROR-RESP2                \n                    STRING                                                      \n                    'Account:'                                                  \n                     WS-CARD-RID-ACCT-ID-X                                      \n                    ' not found in'                                             \n                    ' Acct Master file.Resp:'                                   \n                    ERROR-RESP                                                  \n                    ' Reas:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n      *                                                                         \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *           PERFORM SEND-LONG-TEXT                                        \n           END-EVALUATE                                                         \n           .                                                                    \n       9300-GETACCTDATA-BYACCT-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9400-GETCUSTDATA-BYCUST.                                                 \n           EXEC CICS READ                                                       \n                DATASET   (LIT-CUSTFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CUST-ID-X)                               \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)                     \n                INTO      (CUSTOMER-RECORD)                                     \n                LENGTH    (LENGTH OF CUSTOMER-RECORD)                           \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CUST-IN-MASTER        TO TRUE                       \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE                       \n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE                      \n                  MOVE WS-RESP-CD               TO ERROR-RESP                   \n                  MOVE WS-REAS-CD               TO ERROR-RESP2                  \n                  IF WS-RETURN-MSG-OFF                                          \n                    STRING                                                      \n                    'CustId:'                                                   \n                     WS-CARD-RID-CUST-ID-X                                      \n                    ' not found'                                                \n                    ' in customer master.Resp: '                                \n                    ERROR-RESP                                                  \n                    ' REAS:'                                                    \n                    ERROR-RESP2                                                 \n                    DELIMITED BY SIZE                                           \n                    INTO WS-RETURN-MSG                                          \n                    END-STRING                                                  \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n      *                                              WS-LONG-MSG                \n      *           PERFORM SEND-LONG-TEXT                                        \n           END-EVALUATE                                                         \n           .                                                                    \n       9400-GETCUSTDATA-BYCUST-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-RETURN-MSG)                                        \n                     LENGTH(LENGTH OF WS-RETURN-MSG)                            \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           . \n      *****************************************************************         \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n       ABEND-ROUTINE.                                                           \n                                                                                \n           IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CVACT02Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVCUS01Y",
        "COTTL01Y",
        "CSMSG02Y",
        "DFHAID",
        "CVACT03Y",
        "CSSTRPFY",
        "CVACT01Y",
        "CVCRD01Y",
        "COACTVW"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant Main as 0000-MAIN\n    participant SendMap as 1000-SEND-MAP\n    participant ProcessInputs as 2000-PROCESS-INPUTS\n    participant ReadAcct as 9000-READ-ACCT\n    participant CardXRef as 9200-GETCARDXREF-BYACCT\n    participant AcctData as 9300-GETACCTDATA-BYACCT\n    participant CustData as 9400-GETCUSTDATA-BYCUST\n    \n    User->>Main: Start transaction\n    \n    alt Initial Entry or From Menu\n        Main->>SendMap: 1000-SEND-MAP\n        SendMap->>User: Display account search screen\n    else Re-entry with User Input\n        Main->>ProcessInputs: 2000-PROCESS-INPUTS\n        ProcessInputs->>ProcessInputs: 2100-RECEIVE-MAP\n        ProcessInputs->>ProcessInputs: 2200-EDIT-MAP-INPUTS\n        \n        alt Input Error\n            ProcessInputs-->>Main: Return with error\n            Main->>SendMap: 1000-SEND-MAP\n            SendMap->>User: Display error message\n        else Valid Input\n            ProcessInputs-->>Main: Return with valid input\n            Main->>ReadAcct: 9000-READ-ACCT\n            \n            ReadAcct->>CardXRef: 9200-GETCARDXREF-BYACCT\n            alt Account Not Found in Cross Reference\n                CardXRef-->>ReadAcct: Return with error\n                ReadAcct-->>Main: Return with error\n            else Account Found\n                CardXRef-->>ReadAcct: Return with customer ID\n                \n                ReadAcct->>AcctData: 9300-GETACCTDATA-BYACCT\n                alt Account Not Found in Master\n                    AcctData-->>ReadAcct: Return with error\n                    ReadAcct-->>Main: Return with error\n                else Account Found\n                    AcctData-->>ReadAcct: Return with account data\n                    \n                    ReadAcct->>CustData: 9400-GETCUSTDATA-BYCUST\n                    alt Customer Not Found\n                        CustData-->>ReadAcct: Return with error\n                        ReadAcct-->>Main: Return with error\n                    else Customer Found\n                        CustData-->>ReadAcct: Return with customer data\n                        ReadAcct-->>Main: Return with all data\n                    end\n                end\n            end\n            \n            Main->>SendMap: 1000-SEND-MAP\n            SendMap->>User: Display account details\n        end\n    else PF3 Pressed\n        Main->>User: Return to calling program\n    end"
    },
    {
      "id": "COSGN00C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This environment section is empty, indicating that the COSGN00C program does not define any special configuration settings, file assignments, or system dependencies in its CONFIGURATION SECTION. The program likely relies on standard CICS environment settings or defines its configuration needs elsewhere in the program."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COSGN00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CC00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USER-ID                 PIC X(08).\n         05 WS-USER-PWD                PIC X(08).\n\n       COPY COCOM01Y.\n\n       COPY COSGN00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n      *COPY DFHATTR.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working-Storage Section defines the key variables and data structures used by the sign-on program COSGN00C. It includes program-specific variables for tracking the program name, transaction ID, error messages, and user credentials. The section defines the USRSEC file name for user authentication, error flags with condition names for easier status checking, and response/reason codes for error handling. Several copybooks are included to incorporate common data structures: COCOM01Y (likely communication area), COSGN00 (sign-on screen layout), COTTL01Y (title information), CSDAT01Y (date handling), CSMSG01Y (message handling), and CSUSR01Y (user information). Standard CICS copybooks DFHAID and DFHBMSCA are included for function key definitions and BMS screen control attributes. This section establishes the foundation for the program's user authentication and screen handling functionality."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the linkage area for communication with other programs. It contains a DFHCOMMAREA structure with a single field LK-COMMAREA, which is a variable-length array of characters that can hold between 1 and 32,767 bytes depending on the value of EIBCALEN (the CICS-provided length of the communication area). This structure allows the sign-on program to receive and pass data to other programs in the CardDemo application."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COSGN00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CC00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USER-ID                 PIC X(08).\n         05 WS-USER-PWD                PIC X(08).\n\n       COPY COCOM01Y.\n\n       COPY COSGN00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n      *COPY DFHATTR.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COSGN0AO\n\n           IF EIBCALEN = 0\n               MOVE LOW-VALUES TO COSGN0AO\n               MOVE -1       TO USERIDL OF COSGN0AI\n               PERFORM SEND-SIGNON-SCREEN\n           ELSE\n               EVALUATE EIBAID\n                   WHEN DFHENTER\n                       PERFORM PROCESS-ENTER-KEY\n                   WHEN DFHPF3\n                       MOVE CCDA-MSG-THANK-YOU        TO WS-MESSAGE\n                       PERFORM SEND-PLAIN-TEXT\n                   WHEN OTHER\n                       MOVE 'Y'                       TO WS-ERR-FLG\n                       MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                       PERFORM SEND-SIGNON-SCREEN\n               END-EVALUATE\n           END-IF.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n                     LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the sign-on screen handler. It first clears any error flags and message fields, then determines the appropriate action based on the program's execution context. If no communication area exists (EIBCALEN = 0), it initializes the screen with empty fields and positions the cursor at the user ID field. Otherwise, it processes user input based on the function key pressed: for Enter key, it calls the credential validation routine; for PF3, it displays a thank you message and exits; for any other key, it displays an invalid key error message. After processing, it returns control to CICS while preserving the transaction ID and communication area data for maintaining session state between interactions."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EXEC CICS RECEIVE\n                     MAP('COSGN0A')\n                     MAPSET('COSGN00')\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE TRUE\n               WHEN USERIDI OF COSGN0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Please enter User ID ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN PASSWDI OF COSGN0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Please enter Password ...' TO WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n           MOVE FUNCTION UPPER-CASE(USERIDI OF COSGN0AI) TO\n                           WS-USER-ID\n                           CDEMO-USER-ID\n           MOVE FUNCTION UPPER-CASE(PASSWDI OF COSGN0AI) TO\n                           WS-USER-PWD\n\n           IF NOT ERR-FLG-ON\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      SEND-SIGNON-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the processing of the Enter key in the sign-on screen. It first receives input from the COSGN0A map and then validates the user input. It checks if the User ID or Password fields are empty or contain low-values, displaying appropriate error messages and repositioning the cursor when validation fails. If both fields contain data, it converts the User ID and Password to uppercase and stores them in working storage variables. When no validation errors are detected, it proceeds to read the user security file to authenticate the credentials. This paragraph is a critical part of the application's authentication flow, ensuring that users provide the necessary credentials before proceeding."
          },
          {
            "name": "SEND-SIGNON-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COSGN0AO\n\n           EXEC CICS SEND\n                     MAP('COSGN0A')\n                     MAPSET('COSGN00')\n                     FROM(COSGN0AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-PLAIN-TEXT\n      *----------------------------------------------------------------*",
            "description": "This paragraph displays the sign-on screen for the CardDemo application. It first calls the POPULATE-HEADER-INFO paragraph to set up header information, then moves any system message to the error message field on the screen. It then uses a CICS SEND command to display the COSGN0A map from the COSGN00 mapset, clearing the screen (ERASE) and positioning the cursor at the default input field. This is a key user interface component that presents the authentication form to users attempting to access the system."
          },
          {
            "name": "SEND-PLAIN-TEXT",
            "code": "EXEC CICS SEND TEXT\n                     FROM(WS-MESSAGE)\n                     LENGTH(LENGTH OF WS-MESSAGE)\n                     ERASE\n                     FREEKB\n           END-EXEC.\n\n           EXEC CICS RETURN\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph sends a plain text message to the terminal screen, displaying the content stored in WS-MESSAGE field. It erases the current screen content, frees the keyboard for user input, and then terminates the program execution by returning control to CICS. This functionality is likely used for displaying error messages or notifications to users during the sign-on process."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COSGN0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COSGN0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COSGN0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COSGN0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COSGN0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COSGN0AO\n\n           EXEC CICS ASSIGN\n               APPLID(APPLIDO OF COSGN0AO)\n           END-EXEC\n\n           EXEC CICS ASSIGN\n               SYSID(SYSIDO OF COSGN0AO)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the sign-on screen. It retrieves the current date and time using the CURRENT-DATE function, formats them appropriately (MM/DD/YY for date and HH:MM:SS for time), and places them in the output screen fields. It also sets the application title fields from communication area values, displays the transaction ID and program name, and uses CICS ASSIGN commands to retrieve and display the APPLID (application identifier) and SYSID (system identifier) in the screen header. This provides users with contextual information about when and where they are accessing the system."
          },
          {
            "name": "READ-USER-SEC-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (WS-USER-ID)\n                KEYLENGTH (LENGTH OF WS-USER-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN 0\n                   IF SEC-USR-PWD = WS-USER-PWD\n                       MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                       MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                       MOVE WS-USER-ID   TO CDEMO-USER-ID\n                       MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n                       MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n\n                       IF CDEMO-USRTYP-ADMIN\n                            EXEC CICS XCTL\n                              PROGRAM ('COADM01C')\n                              COMMAREA(CARDDEMO-COMMAREA)\n                            END-EXEC\n                       ELSE\n                            EXEC CICS XCTL\n                              PROGRAM ('COMEN01C')\n                              COMMAREA(CARDDEMO-COMMAREA)\n                            END-EXEC\n                       END-IF\n                   ELSE\n                       MOVE 'Wrong Password. Try again ...' TO\n                                                          WS-MESSAGE\n                       MOVE -1       TO PASSWDL OF COSGN0AI\n                       PERFORM SEND-SIGNON-SCREEN\n                   END-IF\n               WHEN 13\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'User not found. Try again ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN OTHER\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Unable to verify the User ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n           END-EVALUATE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *",
            "description": "This paragraph handles user authentication by reading the user security file (USRSEC) using the entered user ID as the key. It validates the password against the stored credentials and processes the authentication result. On successful authentication, it populates the communication area with user context information (transaction ID, program name, user ID, and user type) and transfers control to either the admin menu (COADM01C) or general user menu (COMEN01C) based on the user's security profile. If the password is incorrect, it displays an error message and returns to the sign-on screen with the cursor positioned at the password field. If the user ID is not found (response code 13) or another error occurs, it sets an error flag, displays an appropriate message, and returns to the sign-on screen with the cursor positioned at the user ID field."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COSGN0AO\n\n           IF EIBCALEN = 0\n               MOVE LOW-VALUES TO COSGN0AO\n               MOVE -1       TO USERIDL OF COSGN0AI\n               PERFORM SEND-SIGNON-SCREEN\n           ELSE\n               EVALUATE EIBAID\n                   WHEN DFHENTER\n                       PERFORM PROCESS-ENTER-KEY\n                   WHEN DFHPF3\n                       MOVE CCDA-MSG-THANK-YOU        TO WS-MESSAGE\n                       PERFORM SEND-PLAIN-TEXT\n                   WHEN OTHER\n                       MOVE 'Y'                       TO WS-ERR-FLG\n                       MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                       PERFORM SEND-SIGNON-SCREEN\n               END-EVALUATE\n           END-IF.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n                     LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EXEC CICS RECEIVE\n                     MAP('COSGN0A')\n                     MAPSET('COSGN00')\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE TRUE\n               WHEN USERIDI OF COSGN0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Please enter User ID ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN PASSWDI OF COSGN0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Please enter Password ...' TO WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n           MOVE FUNCTION UPPER-CASE(USERIDI OF COSGN0AI) TO\n                           WS-USER-ID\n                           CDEMO-USER-ID\n           MOVE FUNCTION UPPER-CASE(PASSWDI OF COSGN0AI) TO\n                           WS-USER-PWD\n\n           IF NOT ERR-FLG-ON\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      SEND-SIGNON-SCREEN\n      *----------------------------------------------------------------*\n       SEND-SIGNON-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COSGN0AO\n\n           EXEC CICS SEND\n                     MAP('COSGN0A')\n                     MAPSET('COSGN00')\n                     FROM(COSGN0AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-PLAIN-TEXT\n      *----------------------------------------------------------------*\n       SEND-PLAIN-TEXT.\n\n           EXEC CICS SEND TEXT\n                     FROM(WS-MESSAGE)\n                     LENGTH(LENGTH OF WS-MESSAGE)\n                     ERASE\n                     FREEKB\n           END-EXEC.\n\n           EXEC CICS RETURN\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COSGN0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COSGN0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COSGN0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COSGN0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COSGN0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COSGN0AO\n\n           EXEC CICS ASSIGN\n               APPLID(APPLIDO OF COSGN0AO)\n           END-EXEC\n\n           EXEC CICS ASSIGN\n               SYSID(SYSIDO OF COSGN0AO)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READ-USER-SEC-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (WS-USER-ID)\n                KEYLENGTH (LENGTH OF WS-USER-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN 0\n                   IF SEC-USR-PWD = WS-USER-PWD\n                       MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                       MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                       MOVE WS-USER-ID   TO CDEMO-USER-ID\n                       MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n                       MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n\n                       IF CDEMO-USRTYP-ADMIN\n                            EXEC CICS XCTL\n                              PROGRAM ('COADM01C')\n                              COMMAREA(CARDDEMO-COMMAREA)\n                            END-EXEC\n                       ELSE\n                            EXEC CICS XCTL\n                              PROGRAM ('COMEN01C')\n                              COMMAREA(CARDDEMO-COMMAREA)\n                            END-EXEC\n                       END-IF\n                   ELSE\n                       MOVE 'Wrong Password. Try again ...' TO\n                                                          WS-MESSAGE\n                       MOVE -1       TO PASSWDL OF COSGN0AI\n                       PERFORM SEND-SIGNON-SCREEN\n                   END-IF\n               WHEN 13\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'User not found. Try again ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN OTHER\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Unable to verify the User ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n           END-EVALUATE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *"
      },
      "description": "This program serves as the sign-on screen handler for the CardDemo application in a CICS environment. It manages user authentication by displaying a login form, validating user credentials against a security file (USRSEC), and routing authenticated users to appropriate programs based on their user type. The program handles various function keys, performs input validation to ensure user ID and password fields are not empty, and displays appropriate error messages when validation fails. Upon successful authentication, it transfers control to either the admin menu (COADM01C) or the general user menu (COMEN01C) based on the user's security profile, passing user context information through a communication area.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COSGN00C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Signon Screen for the CardDemo Application\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COSGN00C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COSGN00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CC00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USER-ID                 PIC X(08).\n         05 WS-USER-PWD                PIC X(08).\n\n       COPY COCOM01Y.\n\n       COPY COSGN00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n      *COPY DFHATTR.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                      PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COSGN0AO\n\n           IF EIBCALEN = 0\n               MOVE LOW-VALUES TO COSGN0AO\n               MOVE -1       TO USERIDL OF COSGN0AI\n               PERFORM SEND-SIGNON-SCREEN\n           ELSE\n               EVALUATE EIBAID\n                   WHEN DFHENTER\n                       PERFORM PROCESS-ENTER-KEY\n                   WHEN DFHPF3\n                       MOVE CCDA-MSG-THANK-YOU        TO WS-MESSAGE\n                       PERFORM SEND-PLAIN-TEXT\n                   WHEN OTHER\n                       MOVE 'Y'                       TO WS-ERR-FLG\n                       MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                       PERFORM SEND-SIGNON-SCREEN\n               END-EVALUATE\n           END-IF.\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n                     LENGTH(LENGTH OF CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EXEC CICS RECEIVE\n                     MAP('COSGN0A')\n                     MAPSET('COSGN00')\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE TRUE\n               WHEN USERIDI OF COSGN0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Please enter User ID ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN PASSWDI OF COSGN0AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Please enter Password ...' TO WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n           MOVE FUNCTION UPPER-CASE(USERIDI OF COSGN0AI) TO\n                           WS-USER-ID\n                           CDEMO-USER-ID\n           MOVE FUNCTION UPPER-CASE(PASSWDI OF COSGN0AI) TO\n                           WS-USER-PWD\n\n           IF NOT ERR-FLG-ON\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      SEND-SIGNON-SCREEN\n      *----------------------------------------------------------------*\n       SEND-SIGNON-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COSGN0AO\n\n           EXEC CICS SEND\n                     MAP('COSGN0A')\n                     MAPSET('COSGN00')\n                     FROM(COSGN0AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-PLAIN-TEXT\n      *----------------------------------------------------------------*\n       SEND-PLAIN-TEXT.\n\n           EXEC CICS SEND TEXT\n                     FROM(WS-MESSAGE)\n                     LENGTH(LENGTH OF WS-MESSAGE)\n                     ERASE\n                     FREEKB\n           END-EXEC.\n\n           EXEC CICS RETURN\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COSGN0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COSGN0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COSGN0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COSGN0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COSGN0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COSGN0AO\n\n           EXEC CICS ASSIGN\n               APPLID(APPLIDO OF COSGN0AO)\n           END-EXEC\n\n           EXEC CICS ASSIGN\n               SYSID(SYSIDO OF COSGN0AO)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READ-USER-SEC-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (WS-USER-ID)\n                KEYLENGTH (LENGTH OF WS-USER-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN 0\n                   IF SEC-USR-PWD = WS-USER-PWD\n                       MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                       MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                       MOVE WS-USER-ID   TO CDEMO-USER-ID\n                       MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n                       MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n\n                       IF CDEMO-USRTYP-ADMIN\n                            EXEC CICS XCTL\n                              PROGRAM ('COADM01C')\n                              COMMAREA(CARDDEMO-COMMAREA)\n                            END-EXEC\n                       ELSE\n                            EXEC CICS XCTL\n                              PROGRAM ('COMEN01C')\n                              COMMAREA(CARDDEMO-COMMAREA)\n                            END-EXEC\n                       END-IF\n                   ELSE\n                       MOVE 'Wrong Password. Try again ...' TO\n                                                          WS-MESSAGE\n                       MOVE -1       TO PASSWDL OF COSGN0AI\n                       PERFORM SEND-SIGNON-SCREEN\n                   END-IF\n               WHEN 13\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'User not found. Try again ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n               WHEN OTHER\n                   MOVE 'Y'      TO WS-ERR-FLG\n                   MOVE 'Unable to verify the User ...' TO WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COSGN0AI\n                   PERFORM SEND-SIGNON-SCREEN\n           END-EVALUATE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COSGN00",
        "COCOM01Y",
        "CSUSR01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "DFHATTR",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant CICS\n    participant COSGN00C as \"Sign-on Program<br/>(COSGN00C)\"\n    participant USRSEC as \"User Security File<br/>(USRSEC)\"\n    participant COADM01C as \"Admin Menu<br/>(COADM01C)\"\n    participant COMEN01C as \"User Menu<br/>(COMEN01C)\"\n    \n    User->>CICS: Start transaction\n    CICS->>+COSGN00C: Execute MAIN-PARA\n    \n    alt First execution (EIBCALEN = 0)\n        COSGN00C->>COSGN00C: POPULATE-HEADER-INFO\n        COSGN00C-->>User: SEND-SIGNON-SCREEN\n    else Subsequent execution\n        alt EIBAID = ENTER\n            COSGN00C->>COSGN00C: PROCESS-ENTER-KEY\n            COSGN00C->>User: Receive map input\n            \n            alt Input validation\n                alt User ID empty\n                    COSGN00C-->>User: Display \"Please enter User ID\" message\n                else Password empty\n                    COSGN00C-->>User: Display \"Please enter Password\" message\n                else Valid input\n                    COSGN00C->>+USRSEC: READ-USER-SEC-FILE\n                    \n                    alt User found (RESP = 0)\n                        alt Password matches\n                            COSGN00C->>COSGN00C: Populate communication area\n                            alt User type = Admin\n                                COSGN00C->>COADM01C: Transfer control (XCTL)\n                            else User type = General\n                                COSGN00C->>COMEN01C: Transfer control (XCTL)\n                            end\n                        else Password incorrect\n                            COSGN00C-->>User: Display \"Wrong Password\" message\n                        end\n                    else User not found (RESP = 13)\n                        COSGN00C-->>User: Display \"User not found\" message\n                    else Other error\n                        COSGN00C-->>User: Display \"Unable to verify the User\" message\n                    end\n                    USRSEC->>-COSGN00C: Return\n                end\n            end\n            \n        else EIBAID = PF3\n            COSGN00C-->>User: SEND-PLAIN-TEXT \"Thank you\"\n            COSGN00C->>CICS: Return\n        else Other key\n            COSGN00C-->>User: Display \"Invalid key\" message\n        end\n    end\n    \n    COSGN00C->>-CICS: Return with COMMAREA"
    },
    {
      "id": "COUSR01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section is empty in the provided COBOL program COUSR01C. The Configuration Section would typically contain SOURCE-COMPUTER and OBJECT-COMPUTER entries, as well as any SPECIAL-NAMES clauses, but none are defined in this program. This suggests that the program relies on default configuration settings or that these configurations are defined elsewhere in the program structure."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU01'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n\n       COPY COCOM01Y.\n\n       COPY COUSR01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n      *COPY DFHATTR.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working-Storage section defines the key variables and data structures used by the COUSR01C program for managing user additions. It includes program identifiers (program name and transaction ID), a message field for user feedback, and file name reference for the user security file (USRSEC). Error handling is facilitated through a flag variable (WS-ERR-FLG) with condition names for on/off states, along with response and reason code fields for CICS operations. The section incorporates several copybooks that likely contain screen maps (COUSR01), common components (COCOM01Y), title elements (COTTL01Y), date utilities (CSDAT01Y), messaging structures (CSMSG01Y), and user-related data definitions (CSUSR01Y). Standard CICS copybooks for AID keys (DFHAID) and BMS screen attributes (DFHBMSCA) are also included to support the program's interactive functionality."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the DFHCOMMAREA structure in the Linkage Section, which is used to receive data passed to the program from the calling program. It contains a single field, LK-COMMAREA, defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length of data passed (EIBCALEN). This structure allows the user management program to receive and process communication data from other components of the CardDemo application."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU01'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n\n       COPY COCOM01Y.\n\n       COPY COUSR01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n      *COPY DFHATTR.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR1AO\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRADD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO FNAMEL OF COUSR1AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRADD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the COUSR01C program, handling initial entry, screen navigation, and function key processing. When first entered (EIBCALEN = 0), it redirects to the sign-on program (COSGN00C). On subsequent entries, it either initializes and displays the user addition screen or processes user input based on the function key pressed. The paragraph handles three specific actions: ENTER key (triggering form processing), PF3 (returning to the admin menu), and PF4 (clearing the current screen). Any other key inputs trigger an error message. The paragraph maintains program state through the CARDDEMO-COMMAREA and concludes with a CICS RETURN that preserves the transaction context for continued processing."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EVALUATE TRUE\n               WHEN FNAMEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'First Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN LNAMEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Last Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO LNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN USERIDI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN PASSWDI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Password can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN USRTYPEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User Type can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRTYPEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USERIDI  OF COUSR1AI TO SEC-USR-ID\n               MOVE FNAMEI   OF COUSR1AI TO SEC-USR-FNAME\n               MOVE LNAMEI   OF COUSR1AI TO SEC-USR-LNAME\n               MOVE PASSWDI  OF COUSR1AI TO SEC-USR-PWD\n               MOVE USRTYPEI OF COUSR1AI TO SEC-USR-TYPE\n               PERFORM WRITE-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph validates user input fields during the user creation process in the CardDemo security system. It checks that all required fields (first name, last name, user ID, password, and user type) are not empty, displaying appropriate error messages and positioning the cursor at the problematic field when validation fails. If all validations pass, it transfers the input data from the screen fields to the security record structure and calls the WRITE-USER-SEC-FILE paragraph to save the new user record. The validation follows a priority sequence, checking fields in a specific order and stopping at the first error encountered."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n      *    MOVE WS-USER-ID   TO CDEMO-USER-ID\n      *    MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRADD-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the navigation back to a previous screen in the CardDemo application. When triggered, it checks if the destination program is specified (CDEMO-TO-PROGRAM), and if not, defaults to the sign-on program 'COSGN00C'. It then prepares the communication area by setting the originating transaction ID and program name before transferring control to the destination program using CICS XCTL command. The commented-out lines suggest that user identification information was previously passed but may no longer be required. The paragraph ensures proper navigation flow within the application while maintaining context between program calls."
          },
          {
            "name": "SEND-USRADD-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR1AO\n\n           EXEC CICS SEND\n                     MAP('COUSR1A')\n                     MAPSET('COUSR01')\n                     FROM(COUSR1AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRADD-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph displays the user addition screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up standard header information, then moves any system message to the error message field on the screen. It then uses the CICS SEND command to display the COUSR1A map from the COUSR01 mapset, clearing the screen (ERASE) and positioning the cursor at the default position. This is the initial presentation of the form where administrators can enter new user details."
          },
          {
            "name": "RECEIVE-USRADD-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COUSR1A')\n                     MAPSET('COUSR01')\n                     INTO(COUSR1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the COUSR1A map within the COUSR01 mapset, storing the captured data in the COUSR1AI structure. It captures response codes in WS-RESP-CD and WS-REAS-CD variables to handle any potential errors during the receive operation. This is a key step in the user addition process, capturing the form data entered by administrators when creating new user accounts in the CardDemo security system."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR1AO.\n\n      *----------------------------------------------------------------*\n      *                      WRITE-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information on the user management screen (COUSR1A). It retrieves the current date and time using the CURRENT-DATE function, then formats and displays this information along with screen titles, transaction ID, and program name. The date is formatted as MM/DD/YY and the time as HH:MM:SS before being moved to their respective output fields on the screen. This provides users with contextual information about when they're accessing the system and which program they're currently using."
          },
          {
            "name": "WRITE-USER-SEC-FILE",
            "code": "EXEC CICS WRITE\n                DATASET   (WS-USRSEC-FILE)\n                FROM      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR1AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been added ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN OTHER\n      *            DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the writing of a new user record to the USRSEC security file and processes the response. It first attempts to write the user data using CICS WRITE command with the user ID as the key. The paragraph then evaluates the response code and takes appropriate action: if successful, it initializes fields, displays a green success message showing which user was added, and refreshes the screen; if a duplicate key/record is detected (indicating the user ID already exists), it sets an error flag, displays an appropriate error message, and positions the cursor at the user ID field; for any other errors, it sets an error flag, displays a generic error message, and positions the cursor at the first name field. In all cases, it calls the SEND-USRADD-SCREEN paragraph to display the appropriate feedback to the user."
          },
          {
            "name": "CLEAR-CURRENT-SCREEN",
            "code": "PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRADD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the current screen by first initializing all fields to their default values and then redisplaying the user addition screen. It provides a way to reset the form when users want to start over with data entry."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO FNAMEL OF COUSR1AI\n           MOVE SPACES          TO USERIDI  OF COUSR1AI\n                                   FNAMEI   OF COUSR1AI\n                                   LNAMEI   OF COUSR1AI\n                                   PASSWDI  OF COUSR1AI\n                                   USRTYPEI OF COUSR1AI",
            "description": "This paragraph initializes the input fields on the user registration screen. It sets the cursor position to the first name field by assigning -1 to FNAMEL, and clears all input fields (user ID, first name, last name, password, and user type) by filling them with spaces. This is typically executed when the screen is first displayed or when a reset operation is performed."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *",
            "description": "This paragraph contains version control information for the COUSR01C program, indicating it is part of the CardDemo application version 1.0-15-g27d6c6f-68, with a timestamp of July 19, 2022, at 23:12:34 CDT. This helps track which version of the code is deployed and when it was last updated."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR1AO\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRADD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO FNAMEL OF COUSR1AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRADD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN FNAMEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'First Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN LNAMEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Last Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO LNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN USERIDI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN PASSWDI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Password can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN USRTYPEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User Type can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRTYPEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USERIDI  OF COUSR1AI TO SEC-USR-ID\n               MOVE FNAMEI   OF COUSR1AI TO SEC-USR-FNAME\n               MOVE LNAMEI   OF COUSR1AI TO SEC-USR-LNAME\n               MOVE PASSWDI  OF COUSR1AI TO SEC-USR-PWD\n               MOVE USRTYPEI OF COUSR1AI TO SEC-USR-TYPE\n               PERFORM WRITE-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n      *    MOVE WS-USER-ID   TO CDEMO-USER-ID\n      *    MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRADD-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRADD-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR1AO\n\n           EXEC CICS SEND\n                     MAP('COUSR1A')\n                     MAPSET('COUSR01')\n                     FROM(COUSR1AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRADD-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRADD-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR1A')\n                     MAPSET('COUSR01')\n                     INTO(COUSR1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR1AO.\n\n      *----------------------------------------------------------------*\n      *                      WRITE-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       WRITE-USER-SEC-FILE.\n\n           EXEC CICS WRITE\n                DATASET   (WS-USRSEC-FILE)\n                FROM      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR1AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been added ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN OTHER\n      *            DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRADD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO FNAMEL OF COUSR1AI\n           MOVE SPACES          TO USERIDI  OF COUSR1AI\n                                   FNAMEI   OF COUSR1AI\n                                   LNAMEI   OF COUSR1AI\n                                   PASSWDI  OF COUSR1AI\n                                   USRTYPEI OF COUSR1AI\n                                   WS-MESSAGE.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *"
      },
      "description": "This CICS COBOL program (COUSR01C) manages the addition of new users to the CardDemo application's security system. It allows administrators to create both regular and admin user accounts by capturing user details through a screen interface and storing them in the USRSEC file. The program validates that all required fields (first name, last name, user ID, password, and user type) are completed before attempting to write the record. It handles various error conditions, including duplicate user IDs, and provides appropriate feedback messages. The program includes navigation capabilities to return to previous screens and supports function keys for cancellation (PF3) and screen clearing (PF4).",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COUSR01C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Add a new Regular/Admin user to USRSEC file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COUSR01C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU01'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n\n       COPY COCOM01Y.\n\n       COPY COUSR01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n      *COPY DFHATTR.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                      PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR1AO\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRADD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO FNAMEL OF COUSR1AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRADD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN FNAMEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'First Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN LNAMEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Last Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO LNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN USERIDI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN PASSWDI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Password can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN USRTYPEI OF COUSR1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User Type can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRTYPEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USERIDI  OF COUSR1AI TO SEC-USR-ID\n               MOVE FNAMEI   OF COUSR1AI TO SEC-USR-FNAME\n               MOVE LNAMEI   OF COUSR1AI TO SEC-USR-LNAME\n               MOVE PASSWDI  OF COUSR1AI TO SEC-USR-PWD\n               MOVE USRTYPEI OF COUSR1AI TO SEC-USR-TYPE\n               PERFORM WRITE-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n      *    MOVE WS-USER-ID   TO CDEMO-USER-ID\n      *    MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRADD-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRADD-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR1AO\n\n           EXEC CICS SEND\n                     MAP('COUSR1A')\n                     MAPSET('COUSR01')\n                     FROM(COUSR1AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRADD-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRADD-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR1A')\n                     MAPSET('COUSR01')\n                     INTO(COUSR1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR1AO.\n\n      *----------------------------------------------------------------*\n      *                      WRITE-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       WRITE-USER-SEC-FILE.\n\n           EXEC CICS WRITE\n                DATASET   (WS-USRSEC-FILE)\n                FROM      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR1AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been added ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN DFHRESP(DUPKEY)\n               WHEN DFHRESP(DUPREC)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID already exist...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USERIDL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n               WHEN OTHER\n      *            DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Add User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR1AI\n                   PERFORM SEND-USRADD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRADD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO FNAMEL OF COUSR1AI\n           MOVE SPACES          TO USERIDI  OF COUSR1AI\n                                   FNAMEI   OF COUSR1AI\n                                   LNAMEI   OF COUSR1AI\n                                   PASSWDI  OF COUSR1AI\n                                   USRTYPEI OF COUSR1AI\n                                   WS-MESSAGE.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "COUSR01",
        "CSMSG01Y",
        "DFHBMSCA",
        "DFHATTR",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor Admin\n    participant COUSR01C as \"COUSR01C Program\"\n    participant COUSR1A as \"User Addition Screen\"\n    participant USRSEC as \"User Security File\"\n    participant COSGN00C as \"Sign-on Program\"\n    participant COADM01C as \"Admin Menu Program\"\n\n    Admin->>COUSR01C: Start transaction\n    \n    alt First Entry (EIBCALEN = 0)\n        COUSR01C->>COSGN00C: Redirect to sign-on\n    else Subsequent Entry\n        alt Initial Screen Display\n            COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n            COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n            COUSR1A-->>Admin: Display empty form\n        else Process User Input\n            COUSR01C->>COUSR1A: RECEIVE-USRADD-SCREEN\n            COUSR1A-->>COUSR01C: Return form data\n            \n            alt ENTER Key Pressed\n                COUSR01C->>COUSR01C: PROCESS-ENTER-KEY\n                \n                alt Validation Failed\n                    COUSR01C->>COUSR01C: Set error flag & message\n                    COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n                    COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n                    COUSR1A-->>Admin: Display error message\n                else Validation Passed\n                    COUSR01C->>COUSR01C: Prepare user record\n                    COUSR01C->>COUSR01C: WRITE-USER-SEC-FILE\n                    COUSR01C->>USRSEC: Write user record\n                    \n                    alt Write Successful\n                        USRSEC-->>COUSR01C: Success response\n                        COUSR01C->>COUSR01C: INITIALIZE-ALL-FIELDS\n                        COUSR01C->>COUSR01C: Set success message\n                        COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n                        COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n                        COUSR1A-->>Admin: Display success message\n                    else Duplicate Key/Record\n                        USRSEC-->>COUSR01C: Duplicate key response\n                        COUSR01C->>COUSR01C: Set error message\n                        COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n                        COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n                        COUSR1A-->>Admin: Display duplicate error\n                    else Other Error\n                        USRSEC-->>COUSR01C: Error response\n                        COUSR01C->>COUSR01C: Set error message\n                        COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n                        COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n                        COUSR1A-->>Admin: Display general error\n                    end\n                end\n                \n            else PF3 Key Pressed\n                COUSR01C->>COUSR01C: RETURN-TO-PREV-SCREEN\n                COUSR01C->>COADM01C: Transfer to admin menu\n            else PF4 Key Pressed\n                COUSR01C->>COUSR01C: CLEAR-CURRENT-SCREEN\n                COUSR01C->>COUSR01C: INITIALIZE-ALL-FIELDS\n                COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n                COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n                COUSR1A-->>Admin: Display cleared form\n            else Other Key Pressed\n                COUSR01C->>COUSR01C: Set invalid key message\n                COUSR01C->>COUSR01C: POPULATE-HEADER-INFO\n                COUSR01C->>COUSR1A: SEND-USRADD-SCREEN\n                COUSR1A-->>Admin: Display invalid key message\n            end\n        end\n    end\n    \n    COUSR01C-->>COUSR01C: CICS RETURN (with COMMAREA)"
    },
    {
      "id": "COUSR03C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This environment section is empty, indicating that the program COUSR03C does not define any special configuration settings, file assignments, or system dependencies in its CONFIGURATION SECTION. The program likely relies on standard environment settings or configurations defined elsewhere in the CardDemo application."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR03C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU03'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n           \n       COPY COCOM01Y.\n          05 CDEMO-CU03-INFO.\n             10 CDEMO-CU03-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU03-USRID-LAST      PIC X(08).\n             10 CDEMO-CU03-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU03-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU03-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU03-USR-SELECTED    PIC X(08).\n\n       COPY COUSR03.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working Storage Section defines the key variables and data structures used in the COUSR03C program for user record deletion. It includes program identifiers, status flags, and error handling variables. The section contains a WS-VARIABLES group with fields for program name, transaction ID, message storage, file name reference to USRSEC, error flags with condition names, response codes, and a modification tracking flag. The section incorporates several copybooks: COCOM01Y (with a custom extension for CU03-specific information including user ID ranges and pagination controls), COUSR03 (likely containing the map definition for the user deletion screen), and various utility copybooks for titles (COTTL01Y), dates (CSDAT01Y), messages (CSMSG01Y), and user information (CSUSR01Y). Standard CICS copybooks DFHAID and DFHBMSCA are included for attention identifier and BMS attribute definitions. This structure supports the program's functionality of displaying, validating, and deleting user records."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the linkage area for CICS communication in the user deletion program. It declares a standard DFHCOMMAREA with a variable-length field (LK-COMMAREA) that can accommodate data of different sizes based on the actual length passed to the program (EIBCALEN). This flexible structure allows the program to receive and process communication data from calling programs within the CardDemo application."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR03C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU03'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n           \n       COPY COCOM01Y.\n          05 CDEMO-CU03-INFO.\n             10 CDEMO-CU03-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU03-USRID-LAST      PIC X(08).\n             10 CDEMO-CU03-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU03-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU03-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU03-USR-SELECTED    PIC X(08).\n\n       COPY COUSR03.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR3AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR3AO\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   IF CDEMO-CU03-USR-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CU03-USR-SELECTED TO\n                            USRIDINI OF COUSR3AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-USRDEL-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRDEL-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM DELETE-USER-INFO\n                       WHEN DFHPF12\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRDEL-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the COUSR03C program, handling user interface navigation and function key processing. It first initializes error flags and message fields, then checks if the program was called with a communication area. If not, it returns to the sign-on program. When processing a valid communication area, it either initializes the delete user screen (for first entry) or processes user input based on the function key pressed. The paragraph handles multiple navigation paths: Enter key to process input, PF3/PF12 to return to previous screens, PF4 to clear the screen, and PF5 to delete the user record. It maintains program state through the CARDDEMO-COMMAREA and provides appropriate error messages for invalid key presses. The paragraph concludes by returning control to CICS with the transaction ID and updated communication area."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EVALUATE TRUE\n               WHEN USRIDINI OF COUSR3AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO FNAMEI   OF COUSR3AI\n                                   LNAMEI   OF COUSR3AI\n                                   USRTYPEI OF COUSR3AI\n               MOVE USRIDINI  OF COUSR3AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE SEC-USR-FNAME      TO FNAMEI    OF COUSR3AI\n               MOVE SEC-USR-LNAME      TO LNAMEI    OF COUSR3AI\n               MOVE SEC-USR-TYPE       TO USRTYPEI  OF COUSR3AI\n               PERFORM SEND-USRDEL-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      DELETE-USER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph processes the Enter key action when a user is attempting to delete a user record. It first validates that the user ID field is not empty, displaying an error message and repositioning the cursor if it is. If the user ID is valid, it clears the name and user type fields on the screen, then attempts to read the corresponding user record from the USRSEC file by calling the READ-USER-SEC-FILE paragraph. If the record is found successfully (no error flag set), it populates the screen fields with the user's first name, last name, and user type from the retrieved record, then redisplays the screen with this information so the administrator can confirm the deletion. The paragraph implements a validation-retrieval-display workflow that prepares for the actual deletion operation that would follow."
          },
          {
            "name": "DELETE-USER-INFO",
            "code": "EVALUATE TRUE\n               WHEN USRIDINI OF COUSR3AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USRIDINI  OF COUSR3AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n               PERFORM DELETE-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the user deletion process by first validating that the user ID field is not empty. If the field is empty, it sets an error flag, displays an appropriate error message, positions the cursor at the user ID field, and redisplays the user deletion screen. If the user ID is provided, the paragraph positions the cursor at the user ID field and continues processing. When no validation errors are detected, it copies the entered user ID to the security file record key field (SEC-USR-ID), then performs two operations in sequence: first reading the user security file to verify the record exists, and then deleting the user record from the security file. This paragraph implements the core business logic for the user deletion functionality, ensuring proper validation before performing the deletion operation."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRDEL-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the navigation back to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, and if not, defaults to 'COSGN00C' (likely the main menu or sign-on screen). It then updates the communication area with the current transaction ID and program name as the source of the transfer, and resets the program context to zeros. Finally, it executes a CICS XCTL command to transfer control to the target program while passing the updated communication area. This provides a consistent navigation mechanism throughout the application while maintaining context between program calls."
          },
          {
            "name": "SEND-USRDEL-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR3AO\n\n           EXEC CICS SEND\n                     MAP('COUSR3A')\n                     MAPSET('COUSR03')\n                     FROM(COUSR3AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRDEL-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph displays the user deletion screen to the administrator. It first calls the POPULATE-HEADER-INFO paragraph to set up common header information, then transfers any system messages from the working storage to the output map's error message field. The paragraph then uses the CICS SEND command to display the COUSR3A map (from the COUSR03 mapset) to the user, clearing the screen (ERASE) and positioning the cursor appropriately for input. This is a key interaction point in the user deletion workflow, presenting the interface where administrators can view and confirm user deletion operations."
          },
          {
            "name": "RECEIVE-USRDEL-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COUSR3A')\n                     MAPSET('COUSR03')\n                     INTO(COUSR3AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives input data from the COUSR3A map within the COUSR03 mapset in a CICS environment. The received data is stored in the COUSR3AI structure, which likely contains user information for the deletion process. The response and reason codes are captured in WS-RESP-CD and WS-REAS-CD respectively for error handling. This is the initial step in processing the user deletion screen where administrator input is captured before validation and processing."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR3AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR3AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR3AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR3AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR3AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR3AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information on the COUSR3A screen. It retrieves the current date and time using the CURRENT-DATE function, then formats and displays this information along with application titles, transaction ID, and program name in the screen header fields. The date is formatted as MM/DD/YY and the time as HH:MM:SS before being moved to their respective output fields on the screen."
          },
          {
            "name": "READ-USER-SEC-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n                   MOVE 'Press PF5 key to delete this user ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHNEUTR       TO ERRMSGC  OF COUSR3AO\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      DELETE-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph reads a user record from the USRSEC file in preparation for deletion. It performs a CICS READ operation with UPDATE mode to lock the record for subsequent deletion. The paragraph handles three possible outcomes: 1) If the record is found (NORMAL response), it displays a message prompting the user to press PF5 to confirm deletion; 2) If the record is not found (NOTFND response), it sets an error flag, displays a \"User ID NOT found\" message, and positions the cursor at the user ID input field; 3) For any other response codes, it logs the error details, sets an error flag, displays a generic error message, and positions the cursor at the first name field. In all cases, it calls the SEND-USRDEL-SCREEN paragraph to display the appropriate screen with feedback to the user."
          },
          {
            "name": "DELETE-USER-SEC-FILE",
            "code": "EXEC CICS DELETE\n                DATASET   (WS-USRSEC-FILE)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR3AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been deleted ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the deletion of a user record from the USRSEC file and processes the response. It first executes a CICS DELETE command targeting the user security file. Based on the response code received, it takes one of three actions: 1) If successful, it initializes all fields, constructs a success message including the deleted user ID, and displays the updated screen with green text; 2) If the record is not found, it sets an error flag, displays an appropriate error message, and positions the cursor at the user ID input field; 3) For any other response, it logs the error codes to the console, sets an error flag, displays a generic error message, and positions the cursor at the first name field. In all cases, it calls the SEND-USRDEL-SCREEN paragraph to refresh the display with the appropriate feedback message."
          },
          {
            "name": "CLEAR-CURRENT-SCREEN",
            "code": "PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRDEL-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the current screen by first initializing all fields to their default values and then redisplaying the user deletion screen. It provides a way to reset the interface when needed, allowing the user to start fresh with a clean form."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO USRIDINL OF COUSR3AI\n           MOVE SPACES          TO USRIDINI OF COUSR3AI\n                                   FNAMEI   OF COUSR3AI\n                                   LNAMEI   OF COUSR3AI\n                                   USRTYPEI OF COUSR3AI",
            "description": "This paragraph initializes the input fields on the user deletion screen. It sets the cursor position to the user ID input field by moving -1 to USRIDINL, and clears all display fields by setting them to spaces, including the user ID input field, first name, last name, and user type fields. This ensures the screen is properly reset before displaying it to the user, providing a clean interface for the user deletion operation."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:35 CDT\n      *",
            "description": "This paragraph contains version control information for the COUSR03C program, showing the specific build version (CardDemo_v1.0-15-g27d6c6f-68) and the build timestamp (July 19, 2022 at 23:12:35 CDT). This information helps track which version of the code is deployed and when it was built."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR3AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR3AO\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   IF CDEMO-CU03-USR-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CU03-USR-SELECTED TO\n                            USRIDINI OF COUSR3AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-USRDEL-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRDEL-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM DELETE-USER-INFO\n                       WHEN DFHPF12\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRDEL-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR3AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO FNAMEI   OF COUSR3AI\n                                   LNAMEI   OF COUSR3AI\n                                   USRTYPEI OF COUSR3AI\n               MOVE USRIDINI  OF COUSR3AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE SEC-USR-FNAME      TO FNAMEI    OF COUSR3AI\n               MOVE SEC-USR-LNAME      TO LNAMEI    OF COUSR3AI\n               MOVE SEC-USR-TYPE       TO USRTYPEI  OF COUSR3AI\n               PERFORM SEND-USRDEL-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      DELETE-USER-INFO\n      *----------------------------------------------------------------*\n       DELETE-USER-INFO.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR3AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USRIDINI  OF COUSR3AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n               PERFORM DELETE-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRDEL-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRDEL-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR3AO\n\n           EXEC CICS SEND\n                     MAP('COUSR3A')\n                     MAPSET('COUSR03')\n                     FROM(COUSR3AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRDEL-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRDEL-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR3A')\n                     MAPSET('COUSR03')\n                     INTO(COUSR3AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR3AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR3AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR3AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR3AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR3AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR3AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READ-USER-SEC-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n                   MOVE 'Press PF5 key to delete this user ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHNEUTR       TO ERRMSGC  OF COUSR3AO\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      DELETE-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       DELETE-USER-SEC-FILE.\n\n           EXEC CICS DELETE\n                DATASET   (WS-USRSEC-FILE)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR3AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been deleted ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRDEL-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO USRIDINL OF COUSR3AI\n           MOVE SPACES          TO USRIDINI OF COUSR3AI\n                                   FNAMEI   OF COUSR3AI\n                                   LNAMEI   OF COUSR3AI\n                                   USRTYPEI OF COUSR3AI\n                                   WS-MESSAGE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:35 CDT\n      *"
      },
      "description": "This program (COUSR03C) is part of the CardDemo application and handles the deletion of user records from the USRSEC file in a CICS environment. The program displays a screen where administrators can enter a user ID, view the associated user details, and then delete the user record if desired. The program includes functionality to validate input, display user information before deletion, and provide appropriate feedback messages. It features navigation capabilities to return to previous screens and integrates with other modules in the CardDemo application through a common communication area. Error handling is implemented for various scenarios such as empty user ID fields, non-existent user records, and file access issues.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COUSR03C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Delete a user from USRSEC file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COUSR03C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR03C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU03'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n           \n       COPY COCOM01Y.\n          05 CDEMO-CU03-INFO.\n             10 CDEMO-CU03-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU03-USRID-LAST      PIC X(08).\n             10 CDEMO-CU03-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU03-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU03-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU03-USR-SELECTED    PIC X(08).\n\n       COPY COUSR03.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR3AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR3AO\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   IF CDEMO-CU03-USR-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CU03-USR-SELECTED TO\n                            USRIDINI OF COUSR3AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-USRDEL-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRDEL-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM DELETE-USER-INFO\n                       WHEN DFHPF12\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRDEL-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR3AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO FNAMEI   OF COUSR3AI\n                                   LNAMEI   OF COUSR3AI\n                                   USRTYPEI OF COUSR3AI\n               MOVE USRIDINI  OF COUSR3AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE SEC-USR-FNAME      TO FNAMEI    OF COUSR3AI\n               MOVE SEC-USR-LNAME      TO LNAMEI    OF COUSR3AI\n               MOVE SEC-USR-TYPE       TO USRTYPEI  OF COUSR3AI\n               PERFORM SEND-USRDEL-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      DELETE-USER-INFO\n      *----------------------------------------------------------------*\n       DELETE-USER-INFO.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR3AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USRIDINI  OF COUSR3AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n               PERFORM DELETE-USER-SEC-FILE\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRDEL-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRDEL-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR3AO\n\n           EXEC CICS SEND\n                     MAP('COUSR3A')\n                     MAPSET('COUSR03')\n                     FROM(COUSR3AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRDEL-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRDEL-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR3A')\n                     MAPSET('COUSR03')\n                     INTO(COUSR3AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR3AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR3AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR3AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR3AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR3AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR3AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READ-USER-SEC-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n                   MOVE 'Press PF5 key to delete this user ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHNEUTR       TO ERRMSGC  OF COUSR3AO\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      DELETE-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       DELETE-USER-SEC-FILE.\n\n           EXEC CICS DELETE\n                DATASET   (WS-USRSEC-FILE)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   PERFORM INITIALIZE-ALL-FIELDS\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR3AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been deleted ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR3AI\n                   PERFORM SEND-USRDEL-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRDEL-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO USRIDINL OF COUSR3AI\n           MOVE SPACES          TO USRIDINI OF COUSR3AI\n                                   FNAMEI   OF COUSR3AI\n                                   LNAMEI   OF COUSR3AI\n                                   USRTYPEI OF COUSR3AI\n                                   WS-MESSAGE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:35 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "COUSR03",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor Admin as Administrator\n    participant Screen as COUSR3A Screen\n    participant MAIN as MAIN-PARA\n    participant PROCESS as PROCESS-ENTER-KEY\n    participant DELETE as DELETE-USER-INFO\n    participant READ as READ-USER-SEC-FILE\n    participant DEL as DELETE-USER-SEC-FILE\n    participant USRSEC as USRSEC File\n    \n    Admin->>Screen: Access User Deletion Screen\n    Screen->>MAIN: Initialize program\n    \n    alt First Entry\n        MAIN->>Screen: Display empty deletion screen\n    else Subsequent Entry\n        MAIN->>Screen: Receive user input\n        \n        alt Enter Key Pressed\n            Screen->>PROCESS: Process user ID input\n            PROCESS->>READ: Validate and read user record\n            READ->>USRSEC: READ with UPDATE\n            USRSEC-->>READ: Return user record\n            READ->>Screen: Display user details for confirmation\n        else PF5 Key Pressed\n            Screen->>DELETE: Process deletion request\n            DELETE->>READ: Verify user exists\n            READ->>USRSEC: READ with UPDATE\n            USRSEC-->>READ: Return user record\n            DELETE->>DEL: Delete user record\n            DEL->>USRSEC: DELETE record\n            USRSEC-->>DEL: Confirm deletion\n            DEL->>Screen: Display success message\n        else PF4 Key Pressed\n            MAIN->>Screen: Clear current screen\n        else PF3/PF12 Key Pressed\n            MAIN->>Screen: Return to previous screen\n        else Invalid Key\n            MAIN->>Screen: Display error message\n        end\n    end\n    \n    Screen-->>Admin: Show appropriate screen/message"
    },
    {
      "id": "COCRDLIC",
      "author": "",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "",
            "description": "This section would typically contain the file definitions and I/O configurations for the COCRDLIC program, but appears to be empty in the provided snippet. In a complete program, the INPUT-OUTPUT SECTION would define the file control entries for files used by the program, such as the CARDDAT file mentioned in the program description. This section would specify file names, access methods, organization types, and record keys for the data files that the program reads from or writes to."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n                                                                                \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      * Input edits                                                             \n      ******************************************************************        \n         05 WS-INPUT-FLAG                          PIC X(1).                    \n           88  INPUT-OK                            VALUES '0'                   \n                                                          ' '                   \n                                                   LOW-VALUES.                  \n           88  INPUT-ERROR                         VALUE '1'.                   \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05 WS-EDIT-SELECT-COUNTER                PIC S9(04)                    \n                                                  USAGE COMP-3                  \n                                                  VALUE 0.                      \n         05 WS-EDIT-SELECT-FLAGS                  PIC X(7)                      \n                                                  VALUE LOW-VALUES.             \n         05 WS-EDIT-SELECT-ARRAY REDEFINES  WS-EDIT-SELECT-FLAGS.               \n            10 WS-EDIT-SELECT                      PIC X(1)                     \n                                                  OCCURS 7 TIMES.               \n               88 SELECT-OK                        VALUES 'S', 'U'.             \n               88 VIEW-REQUESTED-ON                VALUE 'S'.                   \n               88 UPDATE-REQUESTED-ON              VALUE 'U'.                   \n               88 SELECT-BLANK                     VALUES                       \n                                                   ' ',                         \n                                                   LOW-VALUES.                  \n         05 WS-EDIT-SELECT-ERROR-FLAGS             PIC X(7).                    \n         05 WS-EDIT-SELECT-ERROR-FLAGX     REDEFINES                            \n            WS-EDIT-SELECT-ERROR-FLAGS.                                         \n            10 WS-EDIT-SELECT-ERRORS OCCURS 7 TIMES.                            \n               20 WS-ROW-CRDSELECT-ERROR          PIC X(1).                     \n                  88 WS-ROW-SELECT-ERROR          VALUE '1'.                    \n         05 WS-SUBSCRIPT-VARS.                                                  \n            10 I                                  PIC S9(4) COMP                \n                                                  VALUE 0.                      \n            10 I-SELECTED                         PIC S9(4) COMP                \n                                                  VALUE 0.                      \n               88 DETAIL-WAS-REQUESTED            VALUES 1 THRU 7.              \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  FLG-PROTECT-SELECT-ROWS             PIC X(1).                    \n           88  FLG-PROTECT-SELECT-ROWS-NO          VALUE '0'.                   \n           88  FLG-PROTECT-SELECT-ROWS-YES         VALUE '1'.                   \n      ******************************************************************        \n      * Output Message Construction                                             \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(45).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-INFORM-REC-ACTIONS          VALUE                             \n               'TYPE S FOR DETAIL, U TO UPDATE ANY RECORD'.                     \n         05  WS-ERROR-MSG                         PIC X(75).                    \n           88  WS-ERROR-MSG-OFF                   VALUE SPACES.                 \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 PRESSED.EXITING'.                                          \n           88  WS-NO-RECORDS-FOUND                 VALUE                        \n               'NO RECORDS FOUND FOR THIS SEARCH CONDITION.'.                   \n           88  WS-MORE-THAN-1-ACTION              VALUE                         \n               'PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE'.               \n           88  WS-INVALID-ACTION-CODE              VALUE                        \n               'INVALID ACTION CODE'.                                           \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  WS-CONTEXT-FLAG                       PIC X(1).                    \n           88  WS-CONTEXT-FRESH-START              VALUE '0'.                   \n           88  WS-CONTEXT-FRESH-START-NO           VALUE '1'.                   \n      ******************************************************************        \n      * File and data Handling                                                  \n      ******************************************************************        \n         05 WS-FILE-HANDLING-VARS.                                              \n            10  WS-CARD-RID.                                                    \n                20  WS-CARD-RID-CARDNUM            PIC X(16).                   \n                20  WS-CARD-RID-ACCT-ID            PIC 9(11).                   \n                20  WS-CARD-RID-ACCT-ID-X          REDEFINES                    \n                    WS-CARD-RID-ACCT-ID            PIC X(11).                   \n                                                                                \n                                                                                \n                                                                                \n         05  WS-SCRN-COUNTER               PIC S9(4) COMP VALUE 0.              \n                                                                                \n         05  WS-FILTER-RECORD-FLAG                 PIC X(1).                    \n           88  WS-EXCLUDE-THIS-RECORD               VALUE '0'.                  \n           88  WS-DONOT-EXCLUDE-THIS-RECORD         VALUE '1'.                  \n         05  WS-RECORDS-TO-PROCESS-FLAG            PIC X(1).                    \n           88  READ-LOOP-EXIT                      VALUE '0'.                   \n           88  MORE-RECORDS-TO-READ                VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error:'.         \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5).                    \n                                                                                \n      ******************************************************************\n      * Literals and Constants                                                  \n      ******************************************************************        \n       01 WS-CONSTANTS.                                                         \n         05  WS-MAX-SCREEN-LINES                    PIC S9(4) COMP              \n                                                    VALUE 7.                    \n         05  LIT-THISPGM                            PIC X(8)                    \n             VALUE 'COCRDLIC'.                                                  \n         05  LIT-THISTRANID                         PIC X(4)                    \n             VALUE 'CCLI'.                                                      \n         05  LIT-THISMAPSET                         PIC X(7)                    \n             VALUE 'COCRDLI'.                                                   \n         05  LIT-THISMAP                            PIC X(7)                    \n             VALUE 'CCRDLIA'.                                                   \n         05  LIT-MENUPGM                            PIC X(8)                    \n             VALUE 'COMEN01C'.                                                  \n         05  LIT-MENUTRANID                         PIC X(4)                    \n             VALUE 'CM00'.                                                      \n         05  LIT-MENUMAPSET                         PIC X(7)                    \n             VALUE 'COMEN01'.                                                   \n         05  LIT-MENUMAP                            PIC X(7)                    \n             VALUE 'COMEN1A'.                                                   \n         05  LIT-CARDDTLPGM                         PIC X(8)                    \n             VALUE 'COCRDSLC'.                                                  \n         05  LIT-CARDDTLTRANID                      PIC X(4)                    \n             VALUE 'CCDL'.                                                      \n         05  LIT-CARDDTLMAPSET                      PIC X(7)                    \n             VALUE 'COCRDSL'.                                                   \n         05  LIT-CARDDTLMAP                         PIC X(7)                    \n             VALUE 'CCRDSLA'.                                                   \n         05  LIT-CARDUPDPGM                         PIC X(8)                    \n             VALUE 'COCRDUPC'.                                                  \n         05  LIT-CARDUPDTRANID                      PIC X(4)                    \n             VALUE 'CCUP'.                                                      \n         05  LIT-CARDUPDMAPSET                      PIC X(7)                    \n             VALUE 'COCRDUP'.                                                   \n         05  LIT-CARDUPDMAP                         PIC X(7)                    \n             VALUE 'CCRDUPA'.                                                   \n                                                                                \n                                                                                \n         05  LIT-CARD-FILE                          PIC X(8)                    \n                                                   VALUE 'CARDDAT '.            \n         05  LIT-CARD-FILE-ACCT-PATH                PIC X(8)                    \n                                                                                \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *  Commarea manipulations                                                 \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n            10 WS-CA-LAST-CARDKEY.                                              \n               15  WS-CA-LAST-CARD-NUM                PIC X(16).                \n               15  WS-CA-LAST-CARD-ACCT-ID            PIC 9(11).                \n            10 WS-CA-FIRST-CARDKEY.                                             \n               15  WS-CA-FIRST-CARD-NUM               PIC X(16).                \n               15  WS-CA-FIRST-CARD-ACCT-ID           PIC 9(11).                \n                                                                                \n            10 WS-CA-SCREEN-NUM                       PIC 9(1).                 \n               88 CA-FIRST-PAGE                          VALUE 1.               \n            10 WS-CA-LAST-PAGE-DISPLAYED              PIC 9(1).                 \n               88 CA-LAST-PAGE-SHOWN                     VALUE 0.               \n               88 CA-LAST-PAGE-NOT-SHOWN                 VALUE 9.               \n            10 WS-CA-NEXT-PAGE-IND                    PIC X(1).                 \n               88 CA-NEXT-PAGE-NOT-EXISTS             VALUE LOW-VALUES.         \n               88 CA-NEXT-PAGE-EXISTS                 VALUE 'Y'.                \n                                                                                \n            10 WS-RETURN-FLAG                        PIC X(1).                  \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n      ******************************************************************        \n      *  File Data Array         28 CHARS X 7 ROWS = 196                        \n      ******************************************************************        \n         05 WS-SCREEN-DATA.                                                     \n            10 WS-ALL-ROWS                         PIC X(196).                  \n            10 FILLER REDEFINES WS-ALL-ROWS.                                    \n               15 WS-SCREEN-ROWS OCCURS  7 TIMES.                               \n                  20 WS-EACH-ROW.                                               \n                     25 WS-EACH-CARD.                                           \n                        30 WS-ROW-ACCTNO           PIC X(11).                   \n                        30 WS-ROW-CARD-NUM         PIC X(16).                   \n                        30 WS-ROW-CARD-STATUS      PIC X(1).                    \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n                                                                                \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n      *COPY COCRDSL.                                                            \n      *Credit Card List Screen Layout                                           \n       COPY COCRDLI.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n      *Abend Variables                                                          \n      *COPY CSMSG02Y.                                                           \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.",
            "description": "This Working Storage Section defines the data structures used in the COCRDLIC program for managing credit card listings. It contains several key components:\n\n1. CICS processing variables for handling responses and transaction IDs\n2. Input validation flags and fields for filtering by account ID and card number\n3. Selection handling variables that track user selections on the card listing screen\n4. Output formatting and message construction fields for user feedback\n5. File handling variables for CARDDAT file access and record filtering\n6. Program constants including screen limits (7 lines per page) and program/transaction IDs for navigation\n7. A commarea structure that maintains state between program invocations, particularly for pagination\n8. Screen data arrays to store and display up to 7 card records per screen\n\nThe section includes flags for role-based access control, pagination tracking (first/last page indicators), and error handling. It incorporates several copybooks for common structures like card records (CVACT02Y), user information (CSUSR01Y), and screen layouts (COCRDLI). The structure supports the program's core functionality of displaying filtered card listings with pagination and allowing users to select records for detailed viewing or updates."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.",
            "description": "This section defines the DFHCOMMAREA structure in the Linkage Section, which serves as the communication area for passing data between CICS programs. It contains a single field defined as a variable-length array of 1-byte elements (PIC X(1)) that can occur from 1 to 32,767 times, with the actual length determined by the EIBCALEN special register. This flexible structure allows the program to receive and process communication data of varying lengths from calling programs within the CardDemo application."
          }
        ],
        "copybooks": [],
        "code": "WORKING-STORAGE SECTION.                                                 \n                                                                                \n                                                                                \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n                                                                                \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      * Input edits                                                             \n      ******************************************************************        \n         05 WS-INPUT-FLAG                          PIC X(1).                    \n           88  INPUT-OK                            VALUES '0'                   \n                                                          ' '                   \n                                                   LOW-VALUES.                  \n           88  INPUT-ERROR                         VALUE '1'.                   \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05 WS-EDIT-SELECT-COUNTER                PIC S9(04)                    \n                                                  USAGE COMP-3                  \n                                                  VALUE 0.                      \n         05 WS-EDIT-SELECT-FLAGS                  PIC X(7)                      \n                                                  VALUE LOW-VALUES.             \n         05 WS-EDIT-SELECT-ARRAY REDEFINES  WS-EDIT-SELECT-FLAGS.               \n            10 WS-EDIT-SELECT                      PIC X(1)                     \n                                                  OCCURS 7 TIMES.               \n               88 SELECT-OK                        VALUES 'S', 'U'.             \n               88 VIEW-REQUESTED-ON                VALUE 'S'.                   \n               88 UPDATE-REQUESTED-ON              VALUE 'U'.                   \n               88 SELECT-BLANK                     VALUES                       \n                                                   ' ',                         \n                                                   LOW-VALUES.                  \n         05 WS-EDIT-SELECT-ERROR-FLAGS             PIC X(7).                    \n         05 WS-EDIT-SELECT-ERROR-FLAGX     REDEFINES                            \n            WS-EDIT-SELECT-ERROR-FLAGS.                                         \n            10 WS-EDIT-SELECT-ERRORS OCCURS 7 TIMES.                            \n               20 WS-ROW-CRDSELECT-ERROR          PIC X(1).                     \n                  88 WS-ROW-SELECT-ERROR          VALUE '1'.                    \n         05 WS-SUBSCRIPT-VARS.                                                  \n            10 I                                  PIC S9(4) COMP                \n                                                  VALUE 0.                      \n            10 I-SELECTED                         PIC S9(4) COMP                \n                                                  VALUE 0.                      \n               88 DETAIL-WAS-REQUESTED            VALUES 1 THRU 7.              \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  FLG-PROTECT-SELECT-ROWS             PIC X(1).                    \n           88  FLG-PROTECT-SELECT-ROWS-NO          VALUE '0'.                   \n           88  FLG-PROTECT-SELECT-ROWS-YES         VALUE '1'.                   \n      ******************************************************************        \n      * Output Message Construction                                             \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(45).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-INFORM-REC-ACTIONS          VALUE                             \n               'TYPE S FOR DETAIL, U TO UPDATE ANY RECORD'.                     \n         05  WS-ERROR-MSG                         PIC X(75).                    \n           88  WS-ERROR-MSG-OFF                   VALUE SPACES.                 \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 PRESSED.EXITING'.                                          \n           88  WS-NO-RECORDS-FOUND                 VALUE                        \n               'NO RECORDS FOUND FOR THIS SEARCH CONDITION.'.                   \n           88  WS-MORE-THAN-1-ACTION              VALUE                         \n               'PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE'.               \n           88  WS-INVALID-ACTION-CODE              VALUE                        \n               'INVALID ACTION CODE'.                                           \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  WS-CONTEXT-FLAG                       PIC X(1).                    \n           88  WS-CONTEXT-FRESH-START              VALUE '0'.                   \n           88  WS-CONTEXT-FRESH-START-NO           VALUE '1'.                   \n      ******************************************************************        \n      * File and data Handling                                                  \n      ******************************************************************        \n         05 WS-FILE-HANDLING-VARS.                                              \n            10  WS-CARD-RID.                                                    \n                20  WS-CARD-RID-CARDNUM            PIC X(16).                   \n                20  WS-CARD-RID-ACCT-ID            PIC 9(11).                   \n                20  WS-CARD-RID-ACCT-ID-X          REDEFINES                    \n                    WS-CARD-RID-ACCT-ID            PIC X(11).                   \n                                                                                \n                                                                                \n                                                                                \n         05  WS-SCRN-COUNTER               PIC S9(4) COMP VALUE 0.              \n                                                                                \n         05  WS-FILTER-RECORD-FLAG                 PIC X(1).                    \n           88  WS-EXCLUDE-THIS-RECORD               VALUE '0'.                  \n           88  WS-DONOT-EXCLUDE-THIS-RECORD         VALUE '1'.                  \n         05  WS-RECORDS-TO-PROCESS-FLAG            PIC X(1).                    \n           88  READ-LOOP-EXIT                      VALUE '0'.                   \n           88  MORE-RECORDS-TO-READ                VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error:'.         \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5).                    \n                                                                                \n      ******************************************************************\n      * Literals and Constants                                                  \n      ******************************************************************        \n       01 WS-CONSTANTS.                                                         \n         05  WS-MAX-SCREEN-LINES                    PIC S9(4) COMP              \n                                                    VALUE 7.                    \n         05  LIT-THISPGM                            PIC X(8)                    \n             VALUE 'COCRDLIC'.                                                  \n         05  LIT-THISTRANID                         PIC X(4)                    \n             VALUE 'CCLI'.                                                      \n         05  LIT-THISMAPSET                         PIC X(7)                    \n             VALUE 'COCRDLI'.                                                   \n         05  LIT-THISMAP                            PIC X(7)                    \n             VALUE 'CCRDLIA'.                                                   \n         05  LIT-MENUPGM                            PIC X(8)                    \n             VALUE 'COMEN01C'.                                                  \n         05  LIT-MENUTRANID                         PIC X(4)                    \n             VALUE 'CM00'.                                                      \n         05  LIT-MENUMAPSET                         PIC X(7)                    \n             VALUE 'COMEN01'.                                                   \n         05  LIT-MENUMAP                            PIC X(7)                    \n             VALUE 'COMEN1A'.                                                   \n         05  LIT-CARDDTLPGM                         PIC X(8)                    \n             VALUE 'COCRDSLC'.                                                  \n         05  LIT-CARDDTLTRANID                      PIC X(4)                    \n             VALUE 'CCDL'.                                                      \n         05  LIT-CARDDTLMAPSET                      PIC X(7)                    \n             VALUE 'COCRDSL'.                                                   \n         05  LIT-CARDDTLMAP                         PIC X(7)                    \n             VALUE 'CCRDSLA'.                                                   \n         05  LIT-CARDUPDPGM                         PIC X(8)                    \n             VALUE 'COCRDUPC'.                                                  \n         05  LIT-CARDUPDTRANID                      PIC X(4)                    \n             VALUE 'CCUP'.                                                      \n         05  LIT-CARDUPDMAPSET                      PIC X(7)                    \n             VALUE 'COCRDUP'.                                                   \n         05  LIT-CARDUPDMAP                         PIC X(7)                    \n             VALUE 'CCRDUPA'.                                                   \n                                                                                \n                                                                                \n         05  LIT-CARD-FILE                          PIC X(8)                    \n                                                   VALUE 'CARDDAT '.            \n         05  LIT-CARD-FILE-ACCT-PATH                PIC X(8)                    \n                                                                                \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *  Commarea manipulations                                                 \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n            10 WS-CA-LAST-CARDKEY.                                              \n               15  WS-CA-LAST-CARD-NUM                PIC X(16).                \n               15  WS-CA-LAST-CARD-ACCT-ID            PIC 9(11).                \n            10 WS-CA-FIRST-CARDKEY.                                             \n               15  WS-CA-FIRST-CARD-NUM               PIC X(16).                \n               15  WS-CA-FIRST-CARD-ACCT-ID           PIC 9(11).                \n                                                                                \n            10 WS-CA-SCREEN-NUM                       PIC 9(1).                 \n               88 CA-FIRST-PAGE                          VALUE 1.               \n            10 WS-CA-LAST-PAGE-DISPLAYED              PIC 9(1).                 \n               88 CA-LAST-PAGE-SHOWN                     VALUE 0.               \n               88 CA-LAST-PAGE-NOT-SHOWN                 VALUE 9.               \n            10 WS-CA-NEXT-PAGE-IND                    PIC X(1).                 \n               88 CA-NEXT-PAGE-NOT-EXISTS             VALUE LOW-VALUES.         \n               88 CA-NEXT-PAGE-EXISTS                 VALUE 'Y'.                \n                                                                                \n            10 WS-RETURN-FLAG                        PIC X(1).                  \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n      ******************************************************************        \n      *  File Data Array         28 CHARS X 7 ROWS = 196                        \n      ******************************************************************        \n         05 WS-SCREEN-DATA.                                                     \n            10 WS-ALL-ROWS                         PIC X(196).                  \n            10 FILLER REDEFINES WS-ALL-ROWS.                                    \n               15 WS-SCREEN-ROWS OCCURS  7 TIMES.                               \n                  20 WS-EACH-ROW.                                               \n                     25 WS-EACH-CARD.                                           \n                        30 WS-ROW-ACCTNO           PIC X(11).                   \n                        30 WS-ROW-CARD-NUM         PIC X(16).                   \n                        30 WS-ROW-CARD-STATUS      PIC X(1).                    \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n                                                                                \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n      *COPY COCRDSL.                                                            \n      *Credit Card List Screen Layout                                           \n       COPY COCRDLI.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n      *Abend Variables                                                          \n      *COPY CSMSG02Y.                                                           \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN."
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-MAIN",
            "code": "INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n                                                                                \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-ERROR-MSG-OFF  TO TRUE                                        \n      *****************************************************************         \n      * Retrived passed data if  any. Initialize them if first run.             \n      *****************************************************************         \n           IF EIBCALEN = 0\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA \n              MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID                   \n              MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM                  \n              SET CDEMO-USRTYP-USER      TO TRUE                                \n              SET CDEMO-PGM-ENTER        TO TRUE                                \n              MOVE LIT-THISMAP           TO CDEMO-LAST-MAP                      \n              MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET                   \n              SET CA-FIRST-PAGE          TO TRUE                                \n              SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                                \n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO               \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA )TO               \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * If coming in from menu. Lets forget the past and start afresh *         \n      *****************************************************************         \n           IF (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)                        \n               INITIALIZE WS-THIS-PROGCOMMAREA\n               SET CDEMO-PGM-ENTER      TO TRUE                                 \n               MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                       \n               SET CA-FIRST-PAGE        TO TRUE                                 \n               SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                               \n           END-IF \n                                                                                \n      ******************************************************************        \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n                                                                                \n      ******************************************************************        \n      * If something is present in commarea                                     \n      * and the from program is this program itself,                            \n      * read and edit the inputs given                                          \n      *****************************************************************         \n           IF  EIBCALEN > 0                                                     \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                            \n               PERFORM 2000-RECEIVE-MAP                                         \n               THRU    2000-RECEIVE-MAP-EXIT                                    \n                                                                                \n           END-IF                                                               \n      *****************************************************************         \n      * Check the mapped key  to see if its valid at this point       *         \n      * F3    - Exit                                                            \n      * Enter - List of cards for current start key                             \n      * F8    - Page down                                                       \n      * F7    - Page up                                                         \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              CCARD-AID-PFK07 OR                                                \n              CCARD-AID-PFK08                                                   \n               SET PFK-VALID TO TRUE                                            \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n      *****************************************************************         \n      * If the user pressed PF3 go back to main menu                            \n      *****************************************************************         \n           IF  (CCARD-AID-PFK03                                                 \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)                           \n              MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID                        \n              MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM                       \n              SET  CDEMO-USRTYP-USER TO TRUE                                    \n              SET  CDEMO-PGM-ENTER  TO TRUE                                     \n              MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET                        \n              MOVE LIT-THISMAP      TO CDEMO-LAST-MAP                           \n              MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM                         \n                                                                                \n              MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET                        \n              MOVE LIT-THISMAP      TO CCARD-NEXT-MAP                           \n              SET WS-EXIT-MESSAGE            TO TRUE                            \n                                                                                \n      *       CALL MENU PROGRAM                                                 \n      *                                                                         \n              SET CDEMO-PGM-ENTER   TO TRUE                                     \n      *                                                                         \n              EXEC CICS XCTL                                                    \n                        PROGRAM (LIT-MENUPGM)                                   \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n              END-EXEC                                                          \n           END-IF                                                               \n      *****************************************************************         \n      * If the user did not press PF8, lets reset the last page flag            \n      *****************************************************************         \n           IF CCARD-AID-PFK08                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE                              \n           END-IF                                                               \n      *****************************************************************         \n      * Now we decide what to do                                                \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n               WHEN INPUT-ERROR                                                 \n      *****************************************************************         \n      *        ASK FOR CORRECTIONS TO INPUTS                                    \n      *****************************************************************         \n                    MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG                     \n                    MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                  \n                    MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                   \n                    MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                      \n                                                                                \n                    MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                     \n                    MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                   \n                    MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                      \n                    IF  NOT FLG-ACCTFILTER-NOT-OK                               \n                    AND NOT FLG-CARDFILTER-NOT-OK                               \n                       PERFORM 9000-READ-FORWARD                                \n                          THRU 9000-READ-FORWARD-EXIT                           \n                    END-IF                                                      \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n      *****************************************************************         \n      *        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM                    \n      *****************************************************************         \n               WHEN CCARD-AID-PFK03                                             \n               WHEN CDEMO-PGM-REENTER AND                                       \n                    CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM                    \n                                                                                \n                    INITIALIZE CARDDEMO-COMMAREA                                \n                               WS-THIS-PROGCOMMAREA                             \n                    MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID               \n                    MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM              \n                    SET CDEMO-USRTYP-USER    TO TRUE                            \n                    SET CDEMO-PGM-ENTER      TO TRUE                            \n                    MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                  \n                    MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET               \n                    SET CA-FIRST-PAGE        TO TRUE                            \n                    SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                          \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                                                                                \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE DOWN                                                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK08                                             \n                    AND CA-NEXT-PAGE-EXISTS                                     \n                    MOVE WS-CA-LAST-CARD-NUM                                    \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-LAST-CARD-ACCT-ID                                \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    ADD   +1       TO WS-CA-SCREEN-NUM                          \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE UP                                                          \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND NOT CA-FIRST-PAGE                                       \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    SUBTRACT 1    FROM WS-CA-SCREEN-NUM                         \n                    PERFORM 9100-READ-BACKWARDS                                 \n                       THRU 9100-READ-BACKWARDS-EXIT                            \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        TRANSFER TO CARD DETAIL VIEW                                     \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND VIEW-REQUESTED-ON(I-SELECTED)                               \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD DETAIL PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      *****************************************************************         \n      *        TRANSFER TO CARD UPDATED PROGRAM                                 \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND UPDATE-REQUESTED-ON(I-SELECTED)                             \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD UPDATE PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n                                                                                \n      *****************************************************************         \n               WHEN OTHER                                                       \n      *****************************************************************         \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message to display and return            \n           IF INPUT-ERROR                                                       \n              MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG                            \n              MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                        \n              MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                         \n              MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                            \n                                                                                \n              MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                           \n              MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                         \n              MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                            \n      *       PERFORM 1000-SEND-MAP                                             \n      *          THRU 1000-SEND-MAP                                             \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM        TO CCARD-NEXT-PROG                           \n           GO TO COMMON-RETURN                                                  \n           .",
            "description": "This paragraph serves as the main control flow for the COCRDLIC program, handling initialization, user input processing, and navigation between screens. It begins by initializing work areas and setting up the program context, then processes the communication area to determine if this is the first execution or a subsequent call.\n\nThe paragraph implements key navigation logic, handling various function keys (PF3 for exit, PF7 for page up, PF8 for page down) and the ENTER key. It contains extensive conditional logic to evaluate user actions and determine the appropriate response, including:\n\n1. Validating user input and displaying error messages when needed\n2. Implementing pagination through card records with first/last page boundary checks\n3. Processing user selections for viewing or updating specific card details\n4. Transferring control to other programs when a card is selected for detailed view or update\n\nThe code uses an EVALUATE statement to handle different scenarios based on user actions and program state, directing the flow to appropriate sections for reading records forward or backward, sending maps to display, or transferring to other programs in the application workflow. Throughout the paragraph, the program maintains context information in the communication area to support navigation between related screens."
          },
          {
            "name": "COMMON-RETURN",
            "code": "MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID                            \n           MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM                          \n           MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                           \n           MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP                              \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the program's return logic, preparing the communication area (COMMAREA) before returning control to CICS. It stores transaction context information including the current transaction ID, program name, mapset, and map in the common communication area. The paragraph then combines the standard CardDemo communication area with this program's specific communication area into a single working storage area (WS-COMMAREA). Finally, it executes a CICS RETURN command that specifies the transaction ID to maintain program control and passes the prepared communication area to preserve state information between transactions."
          },
          {
            "name": "0000-MAIN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as a standard exit point for the program, providing a clean termination point that can be called from various parts of the program when processing needs to end. It contains only the EXIT statement followed by a period, which marks the end of the paragraph. This is a common COBOL programming pattern used to centralize program termination logic."
          },
          {
            "name": "1000-SEND-MAP",
            "code": "PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SCREEN-ARRAY-INIT                                       \n              THRU 1200-SCREEN-ARRAY-INIT-EXIT                                  \n           PERFORM 1250-SETUP-ARRAY-ATTRIBS                                     \n              THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT                                \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SETUP-MESSAGE                                           \n              THRU 1400-SETUP-MESSAGE-EXIT                                      \n           PERFORM 1500-SEND-SCREEN                                             \n              THRU 1500-SEND-SCREEN-EXIT                                        \n           .",
            "description": "This paragraph orchestrates the initialization and display of the card listing screen. It follows a sequential process by first initializing the screen, setting up the array elements for displaying multiple card records, configuring the visual attributes for the array elements, establishing screen-level attributes, preparing any user messages, and finally sending the completed screen to the terminal. This structured approach ensures the screen is properly formatted with appropriate visual cues and populated with the correct data before being presented to the user."
          },
          {
            "name": "1000-SEND-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1000-SEND-MAP routine in the COCRDLIC program. It provides a clean termination point for the routine that handles displaying the credit card listing interface to users."
          },
          {
            "name": "1100-SCREEN-INIT",
            "code": "MOVE LOW-VALUES             TO CCRDLIAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO                  \n      *    PAGE NUMBER                                                          \n      *                                                                         \n           MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO                  \n                                                                                \n           SET WS-NO-INFO-MESSAGE      TO TRUE                                  \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO                  \n           MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO                  \n           .",
            "description": "This paragraph initializes the screen display for the credit card listing interface. It clears the output area, retrieves the current date and time, and populates standard header information including titles, transaction ID, program name, current date (in MM/DD/YY format), and current time (in HH:MM:SS format). It also sets the page number from a working storage variable and initializes the information message area with no message and highlighted display attributes. This setup creates a consistent user interface header before specific card listing data is displayed."
          },
          {
            "name": "1100-SCREEN-INIT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen initialization routine in the COCRDLIC program. It provides a clean termination point for the 1100-SCREEN-INIT section, allowing the program to return control to the calling routine after completing the screen initialization process."
          },
          {
            "name": "1200-SCREEN-ARRAY-INIT",
            "code": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n                                                                                \n           IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO              \n           END-IF                                                               \n           .",
            "description": "This paragraph populates the credit card listing display screen with data from working storage arrays. For each of the seven possible card entries on the screen, it checks if the corresponding array element contains data (not LOW-VALUES). When data exists, it transfers the selection field, account number, card number, and card status from working storage arrays to their corresponding screen output fields. The code follows a repetitive pattern for each of the seven possible display rows, with a comment at the top suggesting that this repetitive structure could be improved through the use of REDEFINES. This paragraph is responsible for formatting the paginated display of credit card information that users see when browsing cards in the system."
          },
          {
            "name": "1200-SCREEN-ARRAY-INIT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1200-SCREEN-ARRAY-INIT routine. It simply marks the end of the routine with no additional processing, allowing the program to return control to the calling section after the screen array initialization is complete."
          },
          {
            "name": "1250-SETUP-ARRAY-ATTRIBS",
            "code": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n                                                                                \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(1) = '1'                                \n                 MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO              \n                 IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES                     \n                    MOVE '*'               TO CRDSEL1O OF CCRDLIAO              \n                 END-IF                                                         \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(2) = '1'                                \n                 MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL2L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(3) = '1'                                \n                 MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL3L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI              \n              I                                                                 \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(4) = '1'                                \n                 MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL4L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(5) = '1'                                \n                 MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL5L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(6) = '1'                                \n                 MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL6L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(7) = '1'                                \n                 MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL7L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI              \n           END-IF                                                               \n           .",
            "description": "This paragraph configures the display attributes for the card selection fields in the card listing screen. For each of the seven possible card rows on the screen, it determines whether the selection field should be protected or unprotected based on data availability and application state. When a row contains card data and selection is allowed, the field is made input-capable (DFHBMFSE). Otherwise, it's protected (DFHBMPRO/DFHBMPRF). The paragraph also handles error highlighting by setting fields to red (DFHRED) when validation errors occur and positions the cursor at the first error field. The code includes a comment suggesting that this repetitive logic could be improved through the use of REDEFINES. There's also a stray \"I\" character in the fourth row's logic that appears to be a typo."
          },
          {
            "name": "1250-SETUP-ARRAY-ATTRIBS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1250-SETUP-ARRAY-ATTRIBS routine. It provides a clean termination point for the routine that sets up display attributes for the card listing array, allowing the program to return control to the calling routine after attribute setup is complete."
          },
          {
            "name": "1300-SETUP-SCREEN-ATTRS",
            "code": "*    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n           OR (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)                                \n              CONTINUE                                                          \n           ELSE                                                                 \n              EVALUATE TRUE                                                     \n                  WHEN FLG-ACCTFILTER-ISVALID                                   \n                  WHEN FLG-ACCTFILTER-NOT-OK                                    \n                     MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-ACCT-ID = 0                                        \n                     MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN FLG-CARDFILTER-ISVALID                                   \n                  WHEN FLG-CARDFILTER-NOT-OK                                    \n                     MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-CARD-NUM = 0                                       \n                     MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-CARD-NUM                                         \n                                       TO CARDSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO CARDSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n      *    IF NO ERRORS POSITION CURSOR AT ACCTID                               \n                                                                                \n           IF INPUT-OK                                                          \n             MOVE   -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           .",
            "description": "This paragraph initializes and configures the screen attributes for the credit card listing interface. It handles the setup of search criteria fields (account ID and card number) based on various conditions including previous user input, validation status, and navigation context. The paragraph performs three main functions:\n\n1. Initializes search criteria fields by evaluating the current state of filters and preserving valid user inputs. It determines whether to display previously entered values or clear the fields based on validation flags and program flow.\n\n2. Sets cursor positioning and highlighting for error conditions by applying red color attributes to invalid input fields (account ID or card number) that failed validation.\n\n3. Establishes default cursor positioning at the account ID field when no errors are present, improving user experience by placing the cursor at the logical starting point for new searches.\n\nThe code uses CICS screen attribute bytes (like DFHBMFSE for field selection and DFHRED for error highlighting) to control the visual presentation of the interface elements based on the current application state."
          },
          {
            "name": "1300-SETUP-SCREEN-ATTRS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1300-SETUP-SCREEN-ATTRS routine. It's a simple exit paragraph that marks the end of the screen attributes setup process, allowing the program to return control to the calling routine."
          },
          {
            "name": "1400-SETUP-MESSAGE",
            "code": "*    SETUP MESSAGE                                                        \n           EVALUATE TRUE                                                        \n                WHEN FLG-ACCTFILTER-NOT-OK                                      \n                WHEN FLG-CARDFILTER-NOT-OK                                      \n                  CONTINUE                                                      \n                WHEN CCARD-AID-PFK07                                            \n                    AND CA-FIRST-PAGE                                           \n                  MOVE 'NO PREVIOUS PAGES TO DISPLAY'                           \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                 AND CA-LAST-PAGE-SHOWN                                         \n                  MOVE 'NO MORE PAGES TO DISPLAY'                               \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                  IF  CA-LAST-PAGE-NOT-SHOWN                                    \n                  AND CA-NEXT-PAGE-NOT-EXISTS                                   \n                      SET CA-LAST-PAGE-SHOWN TO TRUE                            \n                  END-IF                                                        \n                WHEN WS-NO-INFO-MESSAGE                                         \n                WHEN CA-NEXT-PAGE-EXISTS                                        \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                WHEN OTHER                                                      \n                   SET WS-NO-INFO-MESSAGE TO TRUE                               \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO                    \n                                                                                \n           IF  NOT WS-NO-INFO-MESSAGE                                           \n           AND NOT WS-NO-RECORDS-FOUND                                          \n              MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO                   \n              MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO                   \n           END-IF                                                               \n                                                                                \n           .",
            "description": "This paragraph handles the setup and display of appropriate messages to the user based on various navigation and filtering conditions in the card listing screen. It evaluates multiple scenarios to determine what message should be displayed:\n\n1. When filter validation has failed (account or card number), it continues without changing the existing error message\n2. When the user presses PF7 (backward) but is already on the first page, it displays \"NO PREVIOUS PAGES TO DISPLAY\"\n3. When the user presses PF8 (forward) but there are no more pages and the last page is already shown, it displays \"NO MORE PAGES TO DISPLAY\"\n4. When the user presses PF8 and there are no more pages but the last page flag isn't set, it sets the last page indicator and displays record action information\n5. When there are more pages available, it displays information about record actions\n\nThe paragraph then moves the appropriate message to the screen fields, handling both error messages and informational messages with proper formatting. This logic ensures users receive clear feedback about pagination limits and available actions while browsing card records."
          },
          {
            "name": "1400-SETUP-MESSAGE-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the message setup routine in the COCRDLIC program. It provides a clean termination point for the message handling logic, allowing the program to return control to the calling routine after message processing has been completed."
          },
          {
            "name": "1500-SEND-SCREEN",
            "code": "EXEC CICS SEND MAP(LIT-THISMAP)                                      \n                          MAPSET(LIT-THISMAPSET)                                \n                          FROM(CCRDLIAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          RESP(WS-RESP-CD)                                      \n                          FREEKB                                                \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends the credit card listing screen to the terminal using CICS SEND MAP command. It displays the screen defined by LIT-THISMAP within the LIT-THISMAPSET mapset, populating it with data from the CCRDLIAO structure. The CURSOR parameter positions the cursor at a predefined location, while ERASE clears the screen before displaying the new content. The FREEKB option unlocks the keyboard for user input, and the operation's response code is captured in WS-RESP-CD for error handling."
          },
          {
            "name": "1500-SEND-SCREEN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1500-SEND-SCREEN routine in the COCRDLIC program. It provides a clean termination point for the screen sending process, allowing control to return to the calling routine after the card listing screen has been prepared and sent to the user interface."
          },
          {
            "name": "2000-RECEIVE-MAP",
            "code": "PERFORM 2100-RECEIVE-SCREEN                                          \n              THRU 2100-RECEIVE-SCREEN-EXIT                                     \n                                                                                \n           PERFORM 2200-EDIT-INPUTS                                             \n            THRU   2200-EDIT-INPUTS-EXIT                                        \n           .",
            "description": "This paragraph handles the initial processing of user input from the screen. It first calls the 2100-RECEIVE-SCREEN paragraph to capture the data entered by the user, then passes that data to the 2200-EDIT-INPUTS paragraph which validates the input values. This two-step process separates the concerns of data collection and data validation, ensuring all user inputs are properly received and checked before further processing occurs."
          },
          {
            "name": "2000-RECEIVE-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2000-RECEIVE-MAP section of the COCRDLIC program. It provides a clean termination point for the section that handles receiving user input from the screen map, allowing control to return to the calling routine after map processing is complete."
          },
          {
            "name": "2100-RECEIVE-SCREEN",
            "code": "EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                          MAPSET(LIT-THISMAPSET)                                \n                          INTO(CCRDLIAI)                                        \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n                                                                                \n           MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID                             \n           MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM                            \n                                                                                \n           MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)                      \n           MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)                      \n           MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)                      \n           MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)                      \n           MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)                      \n           MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)                      \n           MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)                      \n           .",
            "description": "This paragraph receives user input from the screen using CICS RECEIVE MAP command and processes the data entered by the user. It captures the account ID and card number filters entered by the user and stores them in the CC-ACCT-ID and CC-CARD-NUM fields respectively. Additionally, it retrieves the selection indicators (likely checkboxes or action codes) for up to 7 card records displayed on the screen, storing them in the WS-EDIT-SELECT array for subsequent processing. This paragraph is a key part of the program's user interaction handling, collecting the input that will determine which filtering or selection actions to perform."
          },
          {
            "name": "2100-RECEIVE-SCREEN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2100-RECEIVE-SCREEN routine in the COCRDLIC program. It provides a clean termination point for the screen receiving process, allowing control to return to the calling routine after the screen input has been processed."
          },
          {
            "name": "2200-EDIT-INPUTS",
            "code": "SET INPUT-OK                   TO TRUE                               \n           SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE                               \n                                                                                \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n           PERFORM 2250-EDIT-ARRAY                                              \n              THRU 2250-EDIT-ARRAY-EXIT                                         \n           .",
            "description": "This paragraph validates user inputs for the card listing screen. It first sets the input status to valid and allows row selection. Then it performs three validation routines in sequence: account number validation (2210), card number validation (2220), and validation of the array of selectable card records (2250). This ensures all user inputs are properly validated before processing continues, maintaining data integrity and preventing invalid operations."
          },
          {
            "name": "2200-EDIT-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the input validation routine in the COCRDLIC program. It marks the end of the 2200-EDIT-INPUTS section, which validates user inputs for account ID and card number filters before processing card listing requests."
          },
          {
            "name": "2210-EDIT-ACCOUNT",
            "code": "SET FLG-ACCTFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              MOVE                                                              \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the account ID filter input for the card listing screen. It first checks if the account ID is blank or empty, setting a flag to indicate no account filter is being applied. If an account ID is provided, it validates that the input is numeric and properly formatted (must be an 11-digit number). When validation fails, it sets error flags, displays an appropriate error message, and clears the account ID field. For valid account IDs, it moves the value to the CDEMO-ACCT-ID field and sets a flag indicating a valid account filter is in place. This validation ensures proper filtering of card records by account ID and prevents processing with invalid filter criteria."
          },
          {
            "name": "2210-EDIT-ACCOUNT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the account validation routine. It marks the end of the account number editing process, allowing the program to return control to the calling paragraph after account validation is complete."
          },
          {
            "name": "2220-EDIT-CARD",
            "code": "*    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              IF WS-ERROR-MSG-OFF                                               \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the card number filter input provided by the user. It first checks if the card number is blank, empty, or zero, in which case it sets a flag indicating no card filter is being applied and clears the card number field. If a card number is provided, it verifies that the input is numeric and 16 digits long. When the input fails validation, it sets error flags, displays an appropriate error message to the user, clears the card number field, and prevents row selection. If the card number passes validation, it stores the numeric value in the CDEMO-CARD-NUM field and sets a flag indicating the card filter is valid. This validation ensures that only properly formatted card numbers are used for filtering the displayed records."
          },
          {
            "name": "2220-EDIT-CARD-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the EDIT-CARD routine in the COCRDLIC program. It provides a clean termination point for the card editing process, allowing the program flow to return to the calling routine after card validation and processing has been completed."
          },
          {
            "name": "2250-EDIT-ARRAY",
            "code": "IF INPUT-ERROR                                                       \n              GO TO 2250-EDIT-ARRAY-EXIT                                        \n           END-IF                                                               \n                                                                                \n           INSPECT  WS-EDIT-SELECT-FLAGS                                        \n           TALLYING I                                                           \n           FOR ALL 'S'                                                          \n               ALL 'U'                                                          \n                                                                                \n           IF I > +1                                                            \n               SET INPUT-ERROR      TO TRUE                                     \n               SET WS-MORE-THAN-1-ACTION TO TRUE                                \n                                                                                \n               MOVE WS-EDIT-SELECT-FLAGS                                        \n                                   TO WS-EDIT-SELECT-ERROR-FLAGS                \n               INSPECT WS-EDIT-SELECT-ERROR-FLAGS                               \n                 REPLACING ALL 'S' BY '1'                                       \n                           ALL 'U' BY '1'                                       \n                 CHARACTERS        BY '0'                                       \n                                                                                \n           END-IF                                                               \n                                                                                \n           MOVE ZERO TO I-SELECTED                                              \n                                                                                \n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7                            \n               EVALUATE TRUE                                                    \n                 WHEN SELECT-OK(I)                                              \n                   MOVE I TO I-SELECTED                                         \n                   IF WS-MORE-THAN-1-ACTION                                     \n                      MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                     \n                   END-IF                                                       \n                 WHEN SELECT-BLANK(I)                                           \n                   CONTINUE                                                     \n                 WHEN OTHER                                                     \n                   SET INPUT-ERROR TO TRUE                                      \n                   MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                        \n                   IF WS-ERROR-MSG-OFF                                          \n                      SET WS-INVALID-ACTION-CODE TO TRUE                        \n                   END-IF                                                       \n              END-EVALUATE                                                      \n           END-PERFORM                                                          \n                                                                                \n           .",
            "description": "This paragraph validates user selections in the card listing screen. It first checks if there are any existing input errors before proceeding. It then counts how many cards have been selected with either 'S' (select) or 'U' (update) actions. If more than one card is selected, it flags this as an error and marks the selected rows in an error tracking array. The code then processes each of the 7 possible card rows on the screen, validating that any selection codes are valid ('S' or 'U' or blank) and tracking which row was selected. For any invalid selection codes, it sets appropriate error flags and error messages. This ensures users can only select one card at a time for further processing and that they use valid selection codes."
          },
          {
            "name": "2250-EDIT-ARRAY-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the EDIT-ARRAY routine in the COCRDLIC program. It marks the end of the array editing logic that likely handles the filtering and preparation of credit card records for display. The paragraph contains only the EXIT statement, which returns control to the calling routine after the array processing is complete."
          },
          {
            "name": "9000-READ-FORWARD",
            "code": "MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           MOVE ZEROES TO WS-SCRN-COUNTER                                       \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READNEXT                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                                                                                \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      ADD 1             TO WS-SCRN-COUNTER                      \n                                                                                \n                      MOVE CARD-NUM     TO WS-ROW-CARD-NUM(                     \n                      WS-SCRN-COUNTER)                                          \n                      MOVE CARD-ACCT-ID TO                                      \n                      WS-ROW-ACCTNO(WS-SCRN-COUNTER)                            \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                        TO WS-ROW-CARD-STATUS(                  \n                                        WS-SCRN-COUNTER)                        \n                                                                                \n                      IF WS-SCRN-COUNTER = 1                                    \n                         MOVE CARD-ACCT-ID                                      \n                                        TO WS-CA-FIRST-CARD-ACCT-ID             \n                         MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM                 \n                         IF   WS-CA-SCREEN-NUM = 0                              \n                           ADD   +1     TO WS-CA-SCREEN-NUM                     \n                         ELSE                                                   \n                           CONTINUE                                             \n                         END-IF                                                 \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n      ******************************************************************        \n      *            Max Screen size                                              \n      ******************************************************************        \n                   IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES                     \n                      SET READ-LOOP-EXIT  TO TRUE                               \n                                                                                \n                      MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID          \n                      MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM              \n                                                                                \n                      EXEC CICS READNEXT                                        \n                        DATASET(LIT-CARD-FILE)                                  \n                        INTO (CARD-RECORD)                                      \n                        LENGTH(LENGTH OF CARD-RECORD)                           \n                        RIDFLD(WS-CARD-RID-CARDNUM)                             \n                        KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                \n                        RESP(WS-RESP-CD)                                        \n                        RESP2(WS-REAS-CD)                                       \n                      END-EXEC                                                  \n                                                                                \n                      EVALUATE WS-RESP-CD                                       \n                         WHEN DFHRESP(NORMAL)                                   \n                         WHEN DFHRESP(DUPREC)                                   \n                              SET CA-NEXT-PAGE-EXISTS                           \n                                                TO TRUE                         \n                              MOVE CARD-ACCT-ID TO                              \n                                   WS-CA-LAST-CARD-ACCT-ID                      \n                              MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM          \n                        WHEN DFHRESP(ENDFILE)                                   \n                            SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE             \n                                                                                \n                            IF WS-ERROR-MSG-OFF                                 \n                                MOVE 'NO MORE RECORDS TO SHOW'                  \n                                                TO WS-ERROR-MSG                 \n                            END-IF                                              \n                            WHEN OTHER                                          \n      *                     This is some kind of error. Change to END BR        \n      *                     And exit                                            \n                            SET READ-LOOP-EXIT      TO TRUE                     \n                            MOVE 'READ'              TO ERROR-OPNAME            \n                            MOVE LIT-CARD-FILE       TO ERROR-FILE              \n                            MOVE WS-RESP-CD          TO ERROR-RESP              \n                            MOVE WS-REAS-CD          TO ERROR-RESP2             \n                          MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG            \n                      END-EVALUATE                                              \n                  END-IF                                                        \n               WHEN DFHRESP(ENDFILE)                                            \n                  SET READ-LOOP-EXIT              TO TRUE                       \n                  SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE                       \n                  MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID              \n                  MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM                  \n                  IF WS-ERROR-MSG-OFF                                           \n                     MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG            \n                  END-IF                                                        \n                  IF WS-CA-SCREEN-NUM = 1                                       \n                  AND WS-SCRN-COUNTER = 0                                       \n      *               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG                \n                      SET WS-NO-RECORDS-FOUND    TO TRUE                        \n                  END-IF                                                        \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n                                                                                \n           EXEC CICS ENDBR FILE(LIT-CARD-FILE)                                  \n           END-EXEC                                                             \n           .",
            "description": "This paragraph implements forward pagination through credit card records in the CardDemo application. It starts a browse operation on the card file using the current card number as a key, then reads records sequentially forward, populating a screen buffer with up to 7 card records (the maximum screen lines). \n\nThe routine filters records based on criteria defined elsewhere in the program, tracking the first and last card displayed on the current page. It also performs a look-ahead read after filling the screen to determine if more pages exist, setting appropriate flags for navigation controls.\n\nThe paragraph handles various response conditions including normal processing, end-of-file conditions, and error scenarios. When the end of file is reached, it sets appropriate status flags and displays a \"NO MORE RECORDS TO SHOW\" message. For empty result sets, it sets a special flag indicating no records were found. Any unexpected errors during file operations are captured with detailed information for error reporting."
          },
          {
            "name": "9000-READ-FORWARD-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the forward reading process in the card listing functionality. It's a simple exit paragraph that marks the end of the forward reading logic, allowing the program to return control to the calling section after completing the forward navigation through card records."
          },
          {
            "name": "9100-READ-BACKWARDS",
            "code": "MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n           MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY                      \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           COMPUTE WS-SCRN-COUNTER =                                            \n                                   WS-MAX-SCREEN-LINES + 1                      \n           END-COMPUTE                                                          \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n      *****************************************************************         \n      *    Now we show the records from previous set.                           \n      *****************************************************************         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   SUBTRACT 1          FROM WS-SCRN-COUNTER                     \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n                  GO TO 9100-READ-BACKWARDS-EXIT                                \n           END-EVALUATE                                                         \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      MOVE CARD-NUM                                             \n                                  TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)           \n                      MOVE CARD-ACCT-ID                                         \n                                  TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)             \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                  TO                                            \n                                  WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)           \n                                                                                \n                      SUBTRACT 1  FROM WS-SCRN-COUNTER                          \n                      IF WS-SCRN-COUNTER = 0                                    \n                         SET READ-LOOP-EXIT  TO TRUE                            \n                                                                                \n                         MOVE CARD-ACCT-ID                                      \n                                  TO WS-CA-FIRST-CARD-ACCT-ID                   \n                         MOVE CARD-NUM                                          \n                                  TO WS-CA-FIRST-CARD-NUM                       \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n                                                                                \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n           .",
            "description": "This paragraph implements backward pagination functionality for the card listing screen. It reads records in reverse order from the CARDDAT file to populate the previous page of card records. The process starts by initializing variables and beginning a browse operation at the current first record position. It then reads records in reverse sequence (using READPREV) to fill the screen from bottom to top, applying any active filters to determine which records to display. The paragraph maintains tracking of the first record on the new page for future navigation purposes. Error handling is implemented throughout the process to catch and report any file access issues. The maximum number of records displayed is controlled by WS-MAX-SCREEN-LINES, and the routine stops reading when this limit is reached or when no more records are available."
          },
          {
            "name": "9100-READ-BACKWARDS-EXIT",
            "code": "EXEC CICS                                                            \n                ENDBR FILE(LIT-CARD-FILE)                                       \n           END-EXEC                                                             \n                                                                                \n           EXIT                                                                 \n           .",
            "description": "This paragraph terminates a backward browsing operation on the card file. It issues an ENDBR (End Browse) CICS command to release resources associated with the browse operation on the LIT-CARD-FILE, then exits the paragraph. This is typically called after completing a backward navigation through card records to ensure proper cleanup of CICS resources."
          },
          {
            "name": "9500-FILTER-RECORDS",
            "code": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE                             \n                                                                                \n           IF FLG-ACCTFILTER-ISVALID                                            \n              IF  CARD-ACCT-ID = CC-ACCT-ID                                     \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD  TO TRUE                           \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-ISVALID                                            \n              IF  CARD-NUM = CC-CARD-NUM-N                                      \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD TO TRUE                            \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           .",
            "description": "This paragraph filters credit card records based on user-specified criteria. It first sets a flag indicating the record should be included by default. Then it performs two separate filter checks: first by account ID (if an account filter is active) and then by card number (if a card number filter is active). If either filter is active and the current record doesn't match the filter criteria, the record is marked for exclusion and processing exits the paragraph. If no filters are active or if the record matches all active filter criteria, the record remains included for display in the card listing."
          },
          {
            "name": "9500-FILTER-RECORDS-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************\n      *Common code to store PFKey                                      \n      *****************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************",
            "description": "This paragraph serves as an exit point for the record filtering process in the COCRDLIC program. It includes a copybook 'CSSTRPFY' which contains common code for storing PF key information when the user exits this section of the program. The comment at the end warns that this is a plain text exit that should not be used in production environments, suggesting it may lack proper security measures or error handling needed for production code."
          },
          {
            "name": "SEND-PLAIN-TEXT",
            "code": "EXEC CICS SEND TEXT                                                  \n                     FROM(WS-ERROR-MSG)                                         \n                     LENGTH(LENGTH OF WS-ERROR-MSG)                             \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends an error message to the user's terminal screen using CICS commands. It displays the contents of WS-ERROR-MSG field, erases the current screen content, frees the keyboard for user input, and then returns control to CICS. This is a standard error handling routine used to communicate issues to the user before terminating the current transaction."
          },
          {
            "name": "SEND-PLAIN-TEXT-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************",
            "description": "This paragraph serves as an exit point for displaying long text messages, primarily intended for debugging purposes. It is not meant to be used during normal program operation but rather as a diagnostic tool for developers. The comment block clearly indicates this is a specialized function that should be avoided in regular program execution."
          },
          {
            "name": "SEND-LONG-TEXT",
            "code": "EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends an error or information message to the user interface and terminates the transaction. It uses the CICS SEND TEXT command to display the contents of the WS-LONG-MSG field, clearing the screen (ERASE) and unlocking the keyboard (FREEKB). After displaying the message, it immediately returns control to CICS, effectively ending the current transaction. This is typically used for displaying error messages or important notifications that require the user to acknowledge before continuing with another operation."
          },
          {
            "name": "SEND-LONG-TEXT-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *",
            "description": "This paragraph serves as an exit point for the SEND-LONG-TEXT routine in the COCRDLIC program. It provides a clean termination point for the routine that handles displaying extended text information in the credit card listing interface. The paragraph includes version control information showing this code is part of CardDemo version 1.0-15-g27d6c6f-68, dated July 19, 2022."
          }
        ],
        "code": "0000-MAIN.                                                               \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n                                                                                \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-ERROR-MSG-OFF  TO TRUE                                        \n      *****************************************************************         \n      * Retrived passed data if  any. Initialize them if first run.             \n      *****************************************************************         \n           IF EIBCALEN = 0\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA \n              MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID                   \n              MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM                  \n              SET CDEMO-USRTYP-USER      TO TRUE                                \n              SET CDEMO-PGM-ENTER        TO TRUE                                \n              MOVE LIT-THISMAP           TO CDEMO-LAST-MAP                      \n              MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET                   \n              SET CA-FIRST-PAGE          TO TRUE                                \n              SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                                \n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO               \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA )TO               \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * If coming in from menu. Lets forget the past and start afresh *         \n      *****************************************************************         \n           IF (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)                        \n               INITIALIZE WS-THIS-PROGCOMMAREA\n               SET CDEMO-PGM-ENTER      TO TRUE                                 \n               MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                       \n               SET CA-FIRST-PAGE        TO TRUE                                 \n               SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                               \n           END-IF \n                                                                                \n      ******************************************************************        \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n                                                                                \n      ******************************************************************        \n      * If something is present in commarea                                     \n      * and the from program is this program itself,                            \n      * read and edit the inputs given                                          \n      *****************************************************************         \n           IF  EIBCALEN > 0                                                     \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                            \n               PERFORM 2000-RECEIVE-MAP                                         \n               THRU    2000-RECEIVE-MAP-EXIT                                    \n                                                                                \n           END-IF                                                               \n      *****************************************************************         \n      * Check the mapped key  to see if its valid at this point       *         \n      * F3    - Exit                                                            \n      * Enter - List of cards for current start key                             \n      * F8    - Page down                                                       \n      * F7    - Page up                                                         \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              CCARD-AID-PFK07 OR                                                \n              CCARD-AID-PFK08                                                   \n               SET PFK-VALID TO TRUE                                            \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n      *****************************************************************         \n      * If the user pressed PF3 go back to main menu                            \n      *****************************************************************         \n           IF  (CCARD-AID-PFK03                                                 \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)                           \n              MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID                        \n              MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM                       \n              SET  CDEMO-USRTYP-USER TO TRUE                                    \n              SET  CDEMO-PGM-ENTER  TO TRUE                                     \n              MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET                        \n              MOVE LIT-THISMAP      TO CDEMO-LAST-MAP                           \n              MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM                         \n                                                                                \n              MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET                        \n              MOVE LIT-THISMAP      TO CCARD-NEXT-MAP                           \n              SET WS-EXIT-MESSAGE            TO TRUE                            \n                                                                                \n      *       CALL MENU PROGRAM                                                 \n      *                                                                         \n              SET CDEMO-PGM-ENTER   TO TRUE                                     \n      *                                                                         \n              EXEC CICS XCTL                                                    \n                        PROGRAM (LIT-MENUPGM)                                   \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n              END-EXEC                                                          \n           END-IF                                                               \n      *****************************************************************         \n      * If the user did not press PF8, lets reset the last page flag            \n      *****************************************************************         \n           IF CCARD-AID-PFK08                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE                              \n           END-IF                                                               \n      *****************************************************************         \n      * Now we decide what to do                                                \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n               WHEN INPUT-ERROR                                                 \n      *****************************************************************         \n      *        ASK FOR CORRECTIONS TO INPUTS                                    \n      *****************************************************************         \n                    MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG                     \n                    MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                  \n                    MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                   \n                    MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                      \n                                                                                \n                    MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                     \n                    MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                   \n                    MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                      \n                    IF  NOT FLG-ACCTFILTER-NOT-OK                               \n                    AND NOT FLG-CARDFILTER-NOT-OK                               \n                       PERFORM 9000-READ-FORWARD                                \n                          THRU 9000-READ-FORWARD-EXIT                           \n                    END-IF                                                      \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n      *****************************************************************         \n      *        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM                    \n      *****************************************************************         \n               WHEN CCARD-AID-PFK03                                             \n               WHEN CDEMO-PGM-REENTER AND                                       \n                    CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM                    \n                                                                                \n                    INITIALIZE CARDDEMO-COMMAREA                                \n                               WS-THIS-PROGCOMMAREA                             \n                    MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID               \n                    MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM              \n                    SET CDEMO-USRTYP-USER    TO TRUE                            \n                    SET CDEMO-PGM-ENTER      TO TRUE                            \n                    MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                  \n                    MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET               \n                    SET CA-FIRST-PAGE        TO TRUE                            \n                    SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                          \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                                                                                \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE DOWN                                                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK08                                             \n                    AND CA-NEXT-PAGE-EXISTS                                     \n                    MOVE WS-CA-LAST-CARD-NUM                                    \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-LAST-CARD-ACCT-ID                                \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    ADD   +1       TO WS-CA-SCREEN-NUM                          \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE UP                                                          \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND NOT CA-FIRST-PAGE                                       \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    SUBTRACT 1    FROM WS-CA-SCREEN-NUM                         \n                    PERFORM 9100-READ-BACKWARDS                                 \n                       THRU 9100-READ-BACKWARDS-EXIT                            \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        TRANSFER TO CARD DETAIL VIEW                                     \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND VIEW-REQUESTED-ON(I-SELECTED)                               \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD DETAIL PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      *****************************************************************         \n      *        TRANSFER TO CARD UPDATED PROGRAM                                 \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND UPDATE-REQUESTED-ON(I-SELECTED)                             \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD UPDATE PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n                                                                                \n      *****************************************************************         \n               WHEN OTHER                                                       \n      *****************************************************************         \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message to display and return            \n           IF INPUT-ERROR                                                       \n              MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG                            \n              MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                        \n              MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                         \n              MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                            \n                                                                                \n              MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                           \n              MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                         \n              MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                            \n      *       PERFORM 1000-SEND-MAP                                             \n      *          THRU 1000-SEND-MAP                                             \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM        TO CCARD-NEXT-PROG                           \n           GO TO COMMON-RETURN                                                  \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID                            \n           MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM                          \n           MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                           \n           MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP                              \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SCREEN-ARRAY-INIT                                       \n              THRU 1200-SCREEN-ARRAY-INIT-EXIT                                  \n           PERFORM 1250-SETUP-ARRAY-ATTRIBS                                     \n              THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT                                \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SETUP-MESSAGE                                           \n              THRU 1400-SETUP-MESSAGE-EXIT                                      \n           PERFORM 1500-SEND-SCREEN                                             \n              THRU 1500-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES             TO CCRDLIAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO                  \n      *    PAGE NUMBER                                                          \n      *                                                                         \n           MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO                  \n                                                                                \n           SET WS-NO-INFO-MESSAGE      TO TRUE                                  \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO                  \n           MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO                  \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1200-SCREEN-ARRAY-INIT.                                                  \n      *    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n                                                                                \n           IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO              \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1200-SCREEN-ARRAY-INIT-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       1250-SETUP-ARRAY-ATTRIBS.                                                \n      *    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n                                                                                \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(1) = '1'                                \n                 MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO              \n                 IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES                     \n                    MOVE '*'               TO CRDSEL1O OF CCRDLIAO              \n                 END-IF                                                         \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(2) = '1'                                \n                 MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL2L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(3) = '1'                                \n                 MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL3L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI              \n              I                                                                 \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(4) = '1'                                \n                 MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL4L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(5) = '1'                                \n                 MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL5L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(6) = '1'                                \n                 MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL6L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(7) = '1'                                \n                 MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL7L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI              \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1250-SETUP-ARRAY-ATTRIBS-EXIT.                                           \n           EXIT                                                                 \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS.                                                 \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n           OR (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)                                \n              CONTINUE                                                          \n           ELSE                                                                 \n              EVALUATE TRUE                                                     \n                  WHEN FLG-ACCTFILTER-ISVALID                                   \n                  WHEN FLG-ACCTFILTER-NOT-OK                                    \n                     MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-ACCT-ID = 0                                        \n                     MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN FLG-CARDFILTER-ISVALID                                   \n                  WHEN FLG-CARDFILTER-NOT-OK                                    \n                     MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-CARD-NUM = 0                                       \n                     MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-CARD-NUM                                         \n                                       TO CARDSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO CARDSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n      *    IF NO ERRORS POSITION CURSOR AT ACCTID                               \n                                                                                \n           IF INPUT-OK                                                          \n             MOVE   -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1400-SETUP-MESSAGE.                                                      \n      *    SETUP MESSAGE                                                        \n           EVALUATE TRUE                                                        \n                WHEN FLG-ACCTFILTER-NOT-OK                                      \n                WHEN FLG-CARDFILTER-NOT-OK                                      \n                  CONTINUE                                                      \n                WHEN CCARD-AID-PFK07                                            \n                    AND CA-FIRST-PAGE                                           \n                  MOVE 'NO PREVIOUS PAGES TO DISPLAY'                           \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                 AND CA-LAST-PAGE-SHOWN                                         \n                  MOVE 'NO MORE PAGES TO DISPLAY'                               \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                  IF  CA-LAST-PAGE-NOT-SHOWN                                    \n                  AND CA-NEXT-PAGE-NOT-EXISTS                                   \n                      SET CA-LAST-PAGE-SHOWN TO TRUE                            \n                  END-IF                                                        \n                WHEN WS-NO-INFO-MESSAGE                                         \n                WHEN CA-NEXT-PAGE-EXISTS                                        \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                WHEN OTHER                                                      \n                   SET WS-NO-INFO-MESSAGE TO TRUE                               \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO                    \n                                                                                \n           IF  NOT WS-NO-INFO-MESSAGE                                           \n           AND NOT WS-NO-RECORDS-FOUND                                          \n              MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO                   \n              MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO                   \n           END-IF                                                               \n                                                                                \n           .                                                                    \n       1400-SETUP-MESSAGE-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1500-SEND-SCREEN.                                                        \n           EXEC CICS SEND MAP(LIT-THISMAP)                                      \n                          MAPSET(LIT-THISMAPSET)                                \n                          FROM(CCRDLIAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          RESP(WS-RESP-CD)                                      \n                          FREEKB                                                \n           END-EXEC                                                             \n           .                                                                    \n       1500-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2000-RECEIVE-MAP.                                                        \n           PERFORM 2100-RECEIVE-SCREEN                                          \n              THRU 2100-RECEIVE-SCREEN-EXIT                                     \n                                                                                \n           PERFORM 2200-EDIT-INPUTS                                             \n            THRU   2200-EDIT-INPUTS-EXIT                                        \n           .                                                                    \n                                                                                \n       2000-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-SCREEN.                                                     \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                          MAPSET(LIT-THISMAPSET)                                \n                          INTO(CCRDLIAI)                                        \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n                                                                                \n           MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID                             \n           MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM                            \n                                                                                \n           MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)                      \n           MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)                      \n           MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)                      \n           MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)                      \n           MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)                      \n           MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)                      \n           MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)                      \n           .                                                                    \n                                                                                \n       2100-RECEIVE-SCREEN-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2200-EDIT-INPUTS.                                                        \n           SET INPUT-OK                   TO TRUE                               \n           SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE                               \n                                                                                \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n           PERFORM 2250-EDIT-ARRAY                                              \n              THRU 2250-EDIT-ARRAY-EXIT                                         \n           .                                                                    \n                                                                                \n       2200-EDIT-INPUTS-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              MOVE                                                              \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              IF WS-ERROR-MSG-OFF                                               \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2250-EDIT-ARRAY.                                                         \n                                                                                \n           IF INPUT-ERROR                                                       \n              GO TO 2250-EDIT-ARRAY-EXIT                                        \n           END-IF                                                               \n                                                                                \n           INSPECT  WS-EDIT-SELECT-FLAGS                                        \n           TALLYING I                                                           \n           FOR ALL 'S'                                                          \n               ALL 'U'                                                          \n                                                                                \n           IF I > +1                                                            \n               SET INPUT-ERROR      TO TRUE                                     \n               SET WS-MORE-THAN-1-ACTION TO TRUE                                \n                                                                                \n               MOVE WS-EDIT-SELECT-FLAGS                                        \n                                   TO WS-EDIT-SELECT-ERROR-FLAGS                \n               INSPECT WS-EDIT-SELECT-ERROR-FLAGS                               \n                 REPLACING ALL 'S' BY '1'                                       \n                           ALL 'U' BY '1'                                       \n                 CHARACTERS        BY '0'                                       \n                                                                                \n           END-IF                                                               \n                                                                                \n           MOVE ZERO TO I-SELECTED                                              \n                                                                                \n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7                            \n               EVALUATE TRUE                                                    \n                 WHEN SELECT-OK(I)                                              \n                   MOVE I TO I-SELECTED                                         \n                   IF WS-MORE-THAN-1-ACTION                                     \n                      MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                     \n                   END-IF                                                       \n                 WHEN SELECT-BLANK(I)                                           \n                   CONTINUE                                                     \n                 WHEN OTHER                                                     \n                   SET INPUT-ERROR TO TRUE                                      \n                   MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                        \n                   IF WS-ERROR-MSG-OFF                                          \n                      SET WS-INVALID-ACTION-CODE TO TRUE                        \n                   END-IF                                                       \n              END-EVALUATE                                                      \n           END-PERFORM                                                          \n                                                                                \n           .                                                                    \n                                                                                \n       2250-EDIT-ARRAY-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-FORWARD.                                                       \n           MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           MOVE ZEROES TO WS-SCRN-COUNTER                                       \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READNEXT                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                                                                                \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      ADD 1             TO WS-SCRN-COUNTER                      \n                                                                                \n                      MOVE CARD-NUM     TO WS-ROW-CARD-NUM(                     \n                      WS-SCRN-COUNTER)                                          \n                      MOVE CARD-ACCT-ID TO                                      \n                      WS-ROW-ACCTNO(WS-SCRN-COUNTER)                            \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                        TO WS-ROW-CARD-STATUS(                  \n                                        WS-SCRN-COUNTER)                        \n                                                                                \n                      IF WS-SCRN-COUNTER = 1                                    \n                         MOVE CARD-ACCT-ID                                      \n                                        TO WS-CA-FIRST-CARD-ACCT-ID             \n                         MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM                 \n                         IF   WS-CA-SCREEN-NUM = 0                              \n                           ADD   +1     TO WS-CA-SCREEN-NUM                     \n                         ELSE                                                   \n                           CONTINUE                                             \n                         END-IF                                                 \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n      ******************************************************************        \n      *            Max Screen size                                              \n      ******************************************************************        \n                   IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES                     \n                      SET READ-LOOP-EXIT  TO TRUE                               \n                                                                                \n                      MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID          \n                      MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM              \n                                                                                \n                      EXEC CICS READNEXT                                        \n                        DATASET(LIT-CARD-FILE)                                  \n                        INTO (CARD-RECORD)                                      \n                        LENGTH(LENGTH OF CARD-RECORD)                           \n                        RIDFLD(WS-CARD-RID-CARDNUM)                             \n                        KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                \n                        RESP(WS-RESP-CD)                                        \n                        RESP2(WS-REAS-CD)                                       \n                      END-EXEC                                                  \n                                                                                \n                      EVALUATE WS-RESP-CD                                       \n                         WHEN DFHRESP(NORMAL)                                   \n                         WHEN DFHRESP(DUPREC)                                   \n                              SET CA-NEXT-PAGE-EXISTS                           \n                                                TO TRUE                         \n                              MOVE CARD-ACCT-ID TO                              \n                                   WS-CA-LAST-CARD-ACCT-ID                      \n                              MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM          \n                        WHEN DFHRESP(ENDFILE)                                   \n                            SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE             \n                                                                                \n                            IF WS-ERROR-MSG-OFF                                 \n                                MOVE 'NO MORE RECORDS TO SHOW'                  \n                                                TO WS-ERROR-MSG                 \n                            END-IF                                              \n                            WHEN OTHER                                          \n      *                     This is some kind of error. Change to END BR        \n      *                     And exit                                            \n                            SET READ-LOOP-EXIT      TO TRUE                     \n                            MOVE 'READ'              TO ERROR-OPNAME            \n                            MOVE LIT-CARD-FILE       TO ERROR-FILE              \n                            MOVE WS-RESP-CD          TO ERROR-RESP              \n                            MOVE WS-REAS-CD          TO ERROR-RESP2             \n                          MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG            \n                      END-EVALUATE                                              \n                  END-IF                                                        \n               WHEN DFHRESP(ENDFILE)                                            \n                  SET READ-LOOP-EXIT              TO TRUE                       \n                  SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE                       \n                  MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID              \n                  MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM                  \n                  IF WS-ERROR-MSG-OFF                                           \n                     MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG            \n                  END-IF                                                        \n                  IF WS-CA-SCREEN-NUM = 1                                       \n                  AND WS-SCRN-COUNTER = 0                                       \n      *               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG                \n                      SET WS-NO-RECORDS-FOUND    TO TRUE                        \n                  END-IF                                                        \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n                                                                                \n           EXEC CICS ENDBR FILE(LIT-CARD-FILE)                                  \n           END-EXEC                                                             \n           .                                                                    \n       9000-READ-FORWARD-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n       9100-READ-BACKWARDS.                                                     \n                                                                                \n           MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n           MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY                      \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           COMPUTE WS-SCRN-COUNTER =                                            \n                                   WS-MAX-SCREEN-LINES + 1                      \n           END-COMPUTE                                                          \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n      *****************************************************************         \n      *    Now we show the records from previous set.                           \n      *****************************************************************         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   SUBTRACT 1          FROM WS-SCRN-COUNTER                     \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n                  GO TO 9100-READ-BACKWARDS-EXIT                                \n           END-EVALUATE                                                         \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      MOVE CARD-NUM                                             \n                                  TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)           \n                      MOVE CARD-ACCT-ID                                         \n                                  TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)             \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                  TO                                            \n                                  WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)           \n                                                                                \n                      SUBTRACT 1  FROM WS-SCRN-COUNTER                          \n                      IF WS-SCRN-COUNTER = 0                                    \n                         SET READ-LOOP-EXIT  TO TRUE                            \n                                                                                \n                         MOVE CARD-ACCT-ID                                      \n                                  TO WS-CA-FIRST-CARD-ACCT-ID                   \n                         MOVE CARD-NUM                                          \n                                  TO WS-CA-FIRST-CARD-NUM                       \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n                                                                                \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n           .                                                                    \n                                                                                \n       9100-READ-BACKWARDS-EXIT.                                                \n           EXEC CICS                                                            \n                ENDBR FILE(LIT-CARD-FILE)                                       \n           END-EXEC                                                             \n                                                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9500-FILTER-RECORDS.                                                     \n           SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE                             \n                                                                                \n           IF FLG-ACCTFILTER-ISVALID                                            \n              IF  CARD-ACCT-ID = CC-ACCT-ID                                     \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD  TO TRUE                           \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-ISVALID                                            \n              IF  CARD-NUM = CC-CARD-NUM-N                                      \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD TO TRUE                            \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           .                                                                    \n                                                                                \n       9500-FILTER-RECORDS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************\n      *Common code to store PFKey                                      \n      *****************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-ERROR-MSG)                                         \n                     LENGTH(LENGTH OF WS-ERROR-MSG)                             \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *"
      },
      "description": "This program, COCRDLIC, is a business logic component of the CardDemo application that manages the display and navigation of credit card listings. It provides a user interface for viewing credit cards with filtering capabilities and access to detailed card information.\n\nThe program implements role-based access control, showing either all cards for admin users or only cards associated with a specific account for regular users. It supports pagination through card records with forward and backward navigation using PF7/PF8 keys.\n\nKey functionality includes:\n- Filtering card records by account ID and/or card number\n- Displaying up to 7 card records per screen with pagination\n- Allowing users to select individual cards for detailed view or update operations\n- Input validation for account and card number filters\n- Navigation between related screens in the application\n\nThe program interacts with the CARDDAT file to retrieve card information and handles various user actions including entering search criteria, selecting records for viewing or updating, and navigating between pages of results. Error handling is implemented throughout the program to provide appropriate feedback to users when invalid inputs are detected or when system errors occur.",
      "error_handling": null,
      "code": "      *****************************************************************         \n      * Program:     COCRDLIC.CBL                                     *         \n      * Layer:       Business logic                                   *         \n      * Function:    List Credit Cards                                          \n      *              a) All cards if no context passed and admin user           \n      *              b) Only the ones associated with ACCT in COMMAREA          \n      *                 if user is not admin                                    \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************        \n                                                                                \n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.                                                              \n           COCRDLIC.                                                            \n       DATE-WRITTEN.                                                            \n           April 2022.                                                          \n       DATE-COMPILED.                                                           \n           Today.                                                               \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n                                                                                \n       DATA DIVISION.                                                           \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n                                                                                \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n                                                                                \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      * Input edits                                                             \n      ******************************************************************        \n         05 WS-INPUT-FLAG                          PIC X(1).                    \n           88  INPUT-OK                            VALUES '0'                   \n                                                          ' '                   \n                                                   LOW-VALUES.                  \n           88  INPUT-ERROR                         VALUE '1'.                   \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05 WS-EDIT-SELECT-COUNTER                PIC S9(04)                    \n                                                  USAGE COMP-3                  \n                                                  VALUE 0.                      \n         05 WS-EDIT-SELECT-FLAGS                  PIC X(7)                      \n                                                  VALUE LOW-VALUES.             \n         05 WS-EDIT-SELECT-ARRAY REDEFINES  WS-EDIT-SELECT-FLAGS.               \n            10 WS-EDIT-SELECT                      PIC X(1)                     \n                                                  OCCURS 7 TIMES.               \n               88 SELECT-OK                        VALUES 'S', 'U'.             \n               88 VIEW-REQUESTED-ON                VALUE 'S'.                   \n               88 UPDATE-REQUESTED-ON              VALUE 'U'.                   \n               88 SELECT-BLANK                     VALUES                       \n                                                   ' ',                         \n                                                   LOW-VALUES.                  \n         05 WS-EDIT-SELECT-ERROR-FLAGS             PIC X(7).                    \n         05 WS-EDIT-SELECT-ERROR-FLAGX     REDEFINES                            \n            WS-EDIT-SELECT-ERROR-FLAGS.                                         \n            10 WS-EDIT-SELECT-ERRORS OCCURS 7 TIMES.                            \n               20 WS-ROW-CRDSELECT-ERROR          PIC X(1).                     \n                  88 WS-ROW-SELECT-ERROR          VALUE '1'.                    \n         05 WS-SUBSCRIPT-VARS.                                                  \n            10 I                                  PIC S9(4) COMP                \n                                                  VALUE 0.                      \n            10 I-SELECTED                         PIC S9(4) COMP                \n                                                  VALUE 0.                      \n               88 DETAIL-WAS-REQUESTED            VALUES 1 THRU 7.              \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  FLG-PROTECT-SELECT-ROWS             PIC X(1).                    \n           88  FLG-PROTECT-SELECT-ROWS-NO          VALUE '0'.                   \n           88  FLG-PROTECT-SELECT-ROWS-YES         VALUE '1'.                   \n      ******************************************************************        \n      * Output Message Construction                                             \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(45).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-INFORM-REC-ACTIONS          VALUE                             \n               'TYPE S FOR DETAIL, U TO UPDATE ANY RECORD'.                     \n         05  WS-ERROR-MSG                         PIC X(75).                    \n           88  WS-ERROR-MSG-OFF                   VALUE SPACES.                 \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 PRESSED.EXITING'.                                          \n           88  WS-NO-RECORDS-FOUND                 VALUE                        \n               'NO RECORDS FOUND FOR THIS SEARCH CONDITION.'.                   \n           88  WS-MORE-THAN-1-ACTION              VALUE                         \n               'PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE'.               \n           88  WS-INVALID-ACTION-CODE              VALUE                        \n               'INVALID ACTION CODE'.                                           \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  WS-CONTEXT-FLAG                       PIC X(1).                    \n           88  WS-CONTEXT-FRESH-START              VALUE '0'.                   \n           88  WS-CONTEXT-FRESH-START-NO           VALUE '1'.                   \n      ******************************************************************        \n      * File and data Handling                                                  \n      ******************************************************************        \n         05 WS-FILE-HANDLING-VARS.                                              \n            10  WS-CARD-RID.                                                    \n                20  WS-CARD-RID-CARDNUM            PIC X(16).                   \n                20  WS-CARD-RID-ACCT-ID            PIC 9(11).                   \n                20  WS-CARD-RID-ACCT-ID-X          REDEFINES                    \n                    WS-CARD-RID-ACCT-ID            PIC X(11).                   \n                                                                                \n                                                                                \n                                                                                \n         05  WS-SCRN-COUNTER               PIC S9(4) COMP VALUE 0.              \n                                                                                \n         05  WS-FILTER-RECORD-FLAG                 PIC X(1).                    \n           88  WS-EXCLUDE-THIS-RECORD               VALUE '0'.                  \n           88  WS-DONOT-EXCLUDE-THIS-RECORD         VALUE '1'.                  \n         05  WS-RECORDS-TO-PROCESS-FLAG            PIC X(1).                    \n           88  READ-LOOP-EXIT                      VALUE '0'.                   \n           88  MORE-RECORDS-TO-READ                VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error:'.         \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5).                    \n                                                                                \n      ******************************************************************\n      * Literals and Constants                                                  \n      ******************************************************************        \n       01 WS-CONSTANTS.                                                         \n         05  WS-MAX-SCREEN-LINES                    PIC S9(4) COMP              \n                                                    VALUE 7.                    \n         05  LIT-THISPGM                            PIC X(8)                    \n             VALUE 'COCRDLIC'.                                                  \n         05  LIT-THISTRANID                         PIC X(4)                    \n             VALUE 'CCLI'.                                                      \n         05  LIT-THISMAPSET                         PIC X(7)                    \n             VALUE 'COCRDLI'.                                                   \n         05  LIT-THISMAP                            PIC X(7)                    \n             VALUE 'CCRDLIA'.                                                   \n         05  LIT-MENUPGM                            PIC X(8)                    \n             VALUE 'COMEN01C'.                                                  \n         05  LIT-MENUTRANID                         PIC X(4)                    \n             VALUE 'CM00'.                                                      \n         05  LIT-MENUMAPSET                         PIC X(7)                    \n             VALUE 'COMEN01'.                                                   \n         05  LIT-MENUMAP                            PIC X(7)                    \n             VALUE 'COMEN1A'.                                                   \n         05  LIT-CARDDTLPGM                         PIC X(8)                    \n             VALUE 'COCRDSLC'.                                                  \n         05  LIT-CARDDTLTRANID                      PIC X(4)                    \n             VALUE 'CCDL'.                                                      \n         05  LIT-CARDDTLMAPSET                      PIC X(7)                    \n             VALUE 'COCRDSL'.                                                   \n         05  LIT-CARDDTLMAP                         PIC X(7)                    \n             VALUE 'CCRDSLA'.                                                   \n         05  LIT-CARDUPDPGM                         PIC X(8)                    \n             VALUE 'COCRDUPC'.                                                  \n         05  LIT-CARDUPDTRANID                      PIC X(4)                    \n             VALUE 'CCUP'.                                                      \n         05  LIT-CARDUPDMAPSET                      PIC X(7)                    \n             VALUE 'COCRDUP'.                                                   \n         05  LIT-CARDUPDMAP                         PIC X(7)                    \n             VALUE 'CCRDUPA'.                                                   \n                                                                                \n                                                                                \n         05  LIT-CARD-FILE                          PIC X(8)                    \n                                                   VALUE 'CARDDAT '.            \n         05  LIT-CARD-FILE-ACCT-PATH                PIC X(8)                    \n                                                                                \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *  Commarea manipulations                                                 \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n            10 WS-CA-LAST-CARDKEY.                                              \n               15  WS-CA-LAST-CARD-NUM                PIC X(16).                \n               15  WS-CA-LAST-CARD-ACCT-ID            PIC 9(11).                \n            10 WS-CA-FIRST-CARDKEY.                                             \n               15  WS-CA-FIRST-CARD-NUM               PIC X(16).                \n               15  WS-CA-FIRST-CARD-ACCT-ID           PIC 9(11).                \n                                                                                \n            10 WS-CA-SCREEN-NUM                       PIC 9(1).                 \n               88 CA-FIRST-PAGE                          VALUE 1.               \n            10 WS-CA-LAST-PAGE-DISPLAYED              PIC 9(1).                 \n               88 CA-LAST-PAGE-SHOWN                     VALUE 0.               \n               88 CA-LAST-PAGE-NOT-SHOWN                 VALUE 9.               \n            10 WS-CA-NEXT-PAGE-IND                    PIC X(1).                 \n               88 CA-NEXT-PAGE-NOT-EXISTS             VALUE LOW-VALUES.         \n               88 CA-NEXT-PAGE-EXISTS                 VALUE 'Y'.                \n                                                                                \n            10 WS-RETURN-FLAG                        PIC X(1).                  \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n      ******************************************************************        \n      *  File Data Array         28 CHARS X 7 ROWS = 196                        \n      ******************************************************************        \n         05 WS-SCREEN-DATA.                                                     \n            10 WS-ALL-ROWS                         PIC X(196).                  \n            10 FILLER REDEFINES WS-ALL-ROWS.                                    \n               15 WS-SCREEN-ROWS OCCURS  7 TIMES.                               \n                  20 WS-EACH-ROW.                                               \n                     25 WS-EACH-CARD.                                           \n                        30 WS-ROW-ACCTNO           PIC X(11).                   \n                        30 WS-ROW-CARD-NUM         PIC X(16).                   \n                        30 WS-ROW-CARD-STATUS      PIC X(1).                    \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n                                                                                \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n      *COPY COCRDSL.                                                            \n      *Credit Card List Screen Layout                                           \n       COPY COCRDLI.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n      *Abend Variables                                                          \n      *COPY CSMSG02Y.                                                           \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.                     \n                                                                                \n       PROCEDURE DIVISION.                                                      \n       0000-MAIN.                                                               \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n                                                                                \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-ERROR-MSG-OFF  TO TRUE                                        \n      *****************************************************************         \n      * Retrived passed data if  any. Initialize them if first run.             \n      *****************************************************************         \n           IF EIBCALEN = 0\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA \n              MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID                   \n              MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM                  \n              SET CDEMO-USRTYP-USER      TO TRUE                                \n              SET CDEMO-PGM-ENTER        TO TRUE                                \n              MOVE LIT-THISMAP           TO CDEMO-LAST-MAP                      \n              MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET                   \n              SET CA-FIRST-PAGE          TO TRUE                                \n              SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                                \n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO               \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA )TO               \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * If coming in from menu. Lets forget the past and start afresh *         \n      *****************************************************************         \n           IF (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)                        \n               INITIALIZE WS-THIS-PROGCOMMAREA\n               SET CDEMO-PGM-ENTER      TO TRUE                                 \n               MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                       \n               SET CA-FIRST-PAGE        TO TRUE                                 \n               SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                               \n           END-IF \n                                                                                \n      ******************************************************************        \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n                                                                                \n      ******************************************************************        \n      * If something is present in commarea                                     \n      * and the from program is this program itself,                            \n      * read and edit the inputs given                                          \n      *****************************************************************         \n           IF  EIBCALEN > 0                                                     \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                            \n               PERFORM 2000-RECEIVE-MAP                                         \n               THRU    2000-RECEIVE-MAP-EXIT                                    \n                                                                                \n           END-IF                                                               \n      *****************************************************************         \n      * Check the mapped key  to see if its valid at this point       *         \n      * F3    - Exit                                                            \n      * Enter - List of cards for current start key                             \n      * F8    - Page down                                                       \n      * F7    - Page up                                                         \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              CCARD-AID-PFK07 OR                                                \n              CCARD-AID-PFK08                                                   \n               SET PFK-VALID TO TRUE                                            \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n      *****************************************************************         \n      * If the user pressed PF3 go back to main menu                            \n      *****************************************************************         \n           IF  (CCARD-AID-PFK03                                                 \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)                           \n              MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID                        \n              MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM                       \n              SET  CDEMO-USRTYP-USER TO TRUE                                    \n              SET  CDEMO-PGM-ENTER  TO TRUE                                     \n              MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET                        \n              MOVE LIT-THISMAP      TO CDEMO-LAST-MAP                           \n              MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM                         \n                                                                                \n              MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET                        \n              MOVE LIT-THISMAP      TO CCARD-NEXT-MAP                           \n              SET WS-EXIT-MESSAGE            TO TRUE                            \n                                                                                \n      *       CALL MENU PROGRAM                                                 \n      *                                                                         \n              SET CDEMO-PGM-ENTER   TO TRUE                                     \n      *                                                                         \n              EXEC CICS XCTL                                                    \n                        PROGRAM (LIT-MENUPGM)                                   \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n              END-EXEC                                                          \n           END-IF                                                               \n      *****************************************************************         \n      * If the user did not press PF8, lets reset the last page flag            \n      *****************************************************************         \n           IF CCARD-AID-PFK08                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE                              \n           END-IF                                                               \n      *****************************************************************         \n      * Now we decide what to do                                                \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n               WHEN INPUT-ERROR                                                 \n      *****************************************************************         \n      *        ASK FOR CORRECTIONS TO INPUTS                                    \n      *****************************************************************         \n                    MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG                     \n                    MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                  \n                    MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                   \n                    MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                      \n                                                                                \n                    MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                     \n                    MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                   \n                    MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                      \n                    IF  NOT FLG-ACCTFILTER-NOT-OK                               \n                    AND NOT FLG-CARDFILTER-NOT-OK                               \n                       PERFORM 9000-READ-FORWARD                                \n                          THRU 9000-READ-FORWARD-EXIT                           \n                    END-IF                                                      \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n      *****************************************************************         \n      *        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM                    \n      *****************************************************************         \n               WHEN CCARD-AID-PFK03                                             \n               WHEN CDEMO-PGM-REENTER AND                                       \n                    CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM                    \n                                                                                \n                    INITIALIZE CARDDEMO-COMMAREA                                \n                               WS-THIS-PROGCOMMAREA                             \n                    MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID               \n                    MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM              \n                    SET CDEMO-USRTYP-USER    TO TRUE                            \n                    SET CDEMO-PGM-ENTER      TO TRUE                            \n                    MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                  \n                    MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET               \n                    SET CA-FIRST-PAGE        TO TRUE                            \n                    SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                          \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                                                                                \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE DOWN                                                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK08                                             \n                    AND CA-NEXT-PAGE-EXISTS                                     \n                    MOVE WS-CA-LAST-CARD-NUM                                    \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-LAST-CARD-ACCT-ID                                \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    ADD   +1       TO WS-CA-SCREEN-NUM                          \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE UP                                                          \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND NOT CA-FIRST-PAGE                                       \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    SUBTRACT 1    FROM WS-CA-SCREEN-NUM                         \n                    PERFORM 9100-READ-BACKWARDS                                 \n                       THRU 9100-READ-BACKWARDS-EXIT                            \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        TRANSFER TO CARD DETAIL VIEW                                     \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND VIEW-REQUESTED-ON(I-SELECTED)                               \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD DETAIL PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      *****************************************************************         \n      *        TRANSFER TO CARD UPDATED PROGRAM                                 \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND UPDATE-REQUESTED-ON(I-SELECTED)                             \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD UPDATE PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n                                                                                \n      *****************************************************************         \n               WHEN OTHER                                                       \n      *****************************************************************         \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message to display and return            \n           IF INPUT-ERROR                                                       \n              MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG                            \n              MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                        \n              MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                         \n              MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                            \n                                                                                \n              MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                           \n              MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                         \n              MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                            \n      *       PERFORM 1000-SEND-MAP                                             \n      *          THRU 1000-SEND-MAP                                             \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM        TO CCARD-NEXT-PROG                           \n           GO TO COMMON-RETURN                                                  \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID                            \n           MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM                          \n           MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                           \n           MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP                              \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SCREEN-ARRAY-INIT                                       \n              THRU 1200-SCREEN-ARRAY-INIT-EXIT                                  \n           PERFORM 1250-SETUP-ARRAY-ATTRIBS                                     \n              THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT                                \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SETUP-MESSAGE                                           \n              THRU 1400-SETUP-MESSAGE-EXIT                                      \n           PERFORM 1500-SEND-SCREEN                                             \n              THRU 1500-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES             TO CCRDLIAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO                  \n      *    PAGE NUMBER                                                          \n      *                                                                         \n           MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO                  \n                                                                                \n           SET WS-NO-INFO-MESSAGE      TO TRUE                                  \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO                  \n           MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO                  \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1200-SCREEN-ARRAY-INIT.                                                  \n      *    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n                                                                                \n           IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO              \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1200-SCREEN-ARRAY-INIT-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       1250-SETUP-ARRAY-ATTRIBS.                                                \n      *    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n                                                                                \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(1) = '1'                                \n                 MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO              \n                 IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES                     \n                    MOVE '*'               TO CRDSEL1O OF CCRDLIAO              \n                 END-IF                                                         \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(2) = '1'                                \n                 MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL2L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(3) = '1'                                \n                 MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL3L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI              \n              I                                                                 \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(4) = '1'                                \n                 MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL4L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(5) = '1'                                \n                 MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL5L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(6) = '1'                                \n                 MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL6L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(7) = '1'                                \n                 MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL7L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI              \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1250-SETUP-ARRAY-ATTRIBS-EXIT.                                           \n           EXIT                                                                 \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS.                                                 \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n           OR (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)                                \n              CONTINUE                                                          \n           ELSE                                                                 \n              EVALUATE TRUE                                                     \n                  WHEN FLG-ACCTFILTER-ISVALID                                   \n                  WHEN FLG-ACCTFILTER-NOT-OK                                    \n                     MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-ACCT-ID = 0                                        \n                     MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN FLG-CARDFILTER-ISVALID                                   \n                  WHEN FLG-CARDFILTER-NOT-OK                                    \n                     MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-CARD-NUM = 0                                       \n                     MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-CARD-NUM                                         \n                                       TO CARDSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO CARDSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n      *    IF NO ERRORS POSITION CURSOR AT ACCTID                               \n                                                                                \n           IF INPUT-OK                                                          \n             MOVE   -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1400-SETUP-MESSAGE.                                                      \n      *    SETUP MESSAGE                                                        \n           EVALUATE TRUE                                                        \n                WHEN FLG-ACCTFILTER-NOT-OK                                      \n                WHEN FLG-CARDFILTER-NOT-OK                                      \n                  CONTINUE                                                      \n                WHEN CCARD-AID-PFK07                                            \n                    AND CA-FIRST-PAGE                                           \n                  MOVE 'NO PREVIOUS PAGES TO DISPLAY'                           \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                 AND CA-LAST-PAGE-SHOWN                                         \n                  MOVE 'NO MORE PAGES TO DISPLAY'                               \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                  IF  CA-LAST-PAGE-NOT-SHOWN                                    \n                  AND CA-NEXT-PAGE-NOT-EXISTS                                   \n                      SET CA-LAST-PAGE-SHOWN TO TRUE                            \n                  END-IF                                                        \n                WHEN WS-NO-INFO-MESSAGE                                         \n                WHEN CA-NEXT-PAGE-EXISTS                                        \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                WHEN OTHER                                                      \n                   SET WS-NO-INFO-MESSAGE TO TRUE                               \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO                    \n                                                                                \n           IF  NOT WS-NO-INFO-MESSAGE                                           \n           AND NOT WS-NO-RECORDS-FOUND                                          \n              MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO                   \n              MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO                   \n           END-IF                                                               \n                                                                                \n           .                                                                    \n       1400-SETUP-MESSAGE-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1500-SEND-SCREEN.                                                        \n           EXEC CICS SEND MAP(LIT-THISMAP)                                      \n                          MAPSET(LIT-THISMAPSET)                                \n                          FROM(CCRDLIAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          RESP(WS-RESP-CD)                                      \n                          FREEKB                                                \n           END-EXEC                                                             \n           .                                                                    \n       1500-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2000-RECEIVE-MAP.                                                        \n           PERFORM 2100-RECEIVE-SCREEN                                          \n              THRU 2100-RECEIVE-SCREEN-EXIT                                     \n                                                                                \n           PERFORM 2200-EDIT-INPUTS                                             \n            THRU   2200-EDIT-INPUTS-EXIT                                        \n           .                                                                    \n                                                                                \n       2000-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-SCREEN.                                                     \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                          MAPSET(LIT-THISMAPSET)                                \n                          INTO(CCRDLIAI)                                        \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n                                                                                \n           MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID                             \n           MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM                            \n                                                                                \n           MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)                      \n           MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)                      \n           MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)                      \n           MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)                      \n           MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)                      \n           MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)                      \n           MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)                      \n           .                                                                    \n                                                                                \n       2100-RECEIVE-SCREEN-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2200-EDIT-INPUTS.                                                        \n           SET INPUT-OK                   TO TRUE                               \n           SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE                               \n                                                                                \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n           PERFORM 2250-EDIT-ARRAY                                              \n              THRU 2250-EDIT-ARRAY-EXIT                                         \n           .                                                                    \n                                                                                \n       2200-EDIT-INPUTS-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              MOVE                                                              \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              IF WS-ERROR-MSG-OFF                                               \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2250-EDIT-ARRAY.                                                         \n                                                                                \n           IF INPUT-ERROR                                                       \n              GO TO 2250-EDIT-ARRAY-EXIT                                        \n           END-IF                                                               \n                                                                                \n           INSPECT  WS-EDIT-SELECT-FLAGS                                        \n           TALLYING I                                                           \n           FOR ALL 'S'                                                          \n               ALL 'U'                                                          \n                                                                                \n           IF I > +1                                                            \n               SET INPUT-ERROR      TO TRUE                                     \n               SET WS-MORE-THAN-1-ACTION TO TRUE                                \n                                                                                \n               MOVE WS-EDIT-SELECT-FLAGS                                        \n                                   TO WS-EDIT-SELECT-ERROR-FLAGS                \n               INSPECT WS-EDIT-SELECT-ERROR-FLAGS                               \n                 REPLACING ALL 'S' BY '1'                                       \n                           ALL 'U' BY '1'                                       \n                 CHARACTERS        BY '0'                                       \n                                                                                \n           END-IF                                                               \n                                                                                \n           MOVE ZERO TO I-SELECTED                                              \n                                                                                \n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7                            \n               EVALUATE TRUE                                                    \n                 WHEN SELECT-OK(I)                                              \n                   MOVE I TO I-SELECTED                                         \n                   IF WS-MORE-THAN-1-ACTION                                     \n                      MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                     \n                   END-IF                                                       \n                 WHEN SELECT-BLANK(I)                                           \n                   CONTINUE                                                     \n                 WHEN OTHER                                                     \n                   SET INPUT-ERROR TO TRUE                                      \n                   MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                        \n                   IF WS-ERROR-MSG-OFF                                          \n                      SET WS-INVALID-ACTION-CODE TO TRUE                        \n                   END-IF                                                       \n              END-EVALUATE                                                      \n           END-PERFORM                                                          \n                                                                                \n           .                                                                    \n                                                                                \n       2250-EDIT-ARRAY-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-FORWARD.                                                       \n           MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           MOVE ZEROES TO WS-SCRN-COUNTER                                       \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READNEXT                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                                                                                \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      ADD 1             TO WS-SCRN-COUNTER                      \n                                                                                \n                      MOVE CARD-NUM     TO WS-ROW-CARD-NUM(                     \n                      WS-SCRN-COUNTER)                                          \n                      MOVE CARD-ACCT-ID TO                                      \n                      WS-ROW-ACCTNO(WS-SCRN-COUNTER)                            \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                        TO WS-ROW-CARD-STATUS(                  \n                                        WS-SCRN-COUNTER)                        \n                                                                                \n                      IF WS-SCRN-COUNTER = 1                                    \n                         MOVE CARD-ACCT-ID                                      \n                                        TO WS-CA-FIRST-CARD-ACCT-ID             \n                         MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM                 \n                         IF   WS-CA-SCREEN-NUM = 0                              \n                           ADD   +1     TO WS-CA-SCREEN-NUM                     \n                         ELSE                                                   \n                           CONTINUE                                             \n                         END-IF                                                 \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n      ******************************************************************        \n      *            Max Screen size                                              \n      ******************************************************************        \n                   IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES                     \n                      SET READ-LOOP-EXIT  TO TRUE                               \n                                                                                \n                      MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID          \n                      MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM              \n                                                                                \n                      EXEC CICS READNEXT                                        \n                        DATASET(LIT-CARD-FILE)                                  \n                        INTO (CARD-RECORD)                                      \n                        LENGTH(LENGTH OF CARD-RECORD)                           \n                        RIDFLD(WS-CARD-RID-CARDNUM)                             \n                        KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                \n                        RESP(WS-RESP-CD)                                        \n                        RESP2(WS-REAS-CD)                                       \n                      END-EXEC                                                  \n                                                                                \n                      EVALUATE WS-RESP-CD                                       \n                         WHEN DFHRESP(NORMAL)                                   \n                         WHEN DFHRESP(DUPREC)                                   \n                              SET CA-NEXT-PAGE-EXISTS                           \n                                                TO TRUE                         \n                              MOVE CARD-ACCT-ID TO                              \n                                   WS-CA-LAST-CARD-ACCT-ID                      \n                              MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM          \n                        WHEN DFHRESP(ENDFILE)                                   \n                            SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE             \n                                                                                \n                            IF WS-ERROR-MSG-OFF                                 \n                                MOVE 'NO MORE RECORDS TO SHOW'                  \n                                                TO WS-ERROR-MSG                 \n                            END-IF                                              \n                            WHEN OTHER                                          \n      *                     This is some kind of error. Change to END BR        \n      *                     And exit                                            \n                            SET READ-LOOP-EXIT      TO TRUE                     \n                            MOVE 'READ'              TO ERROR-OPNAME            \n                            MOVE LIT-CARD-FILE       TO ERROR-FILE              \n                            MOVE WS-RESP-CD          TO ERROR-RESP              \n                            MOVE WS-REAS-CD          TO ERROR-RESP2             \n                          MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG            \n                      END-EVALUATE                                              \n                  END-IF                                                        \n               WHEN DFHRESP(ENDFILE)                                            \n                  SET READ-LOOP-EXIT              TO TRUE                       \n                  SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE                       \n                  MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID              \n                  MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM                  \n                  IF WS-ERROR-MSG-OFF                                           \n                     MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG            \n                  END-IF                                                        \n                  IF WS-CA-SCREEN-NUM = 1                                       \n                  AND WS-SCRN-COUNTER = 0                                       \n      *               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG                \n                      SET WS-NO-RECORDS-FOUND    TO TRUE                        \n                  END-IF                                                        \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n                                                                                \n           EXEC CICS ENDBR FILE(LIT-CARD-FILE)                                  \n           END-EXEC                                                             \n           .                                                                    \n       9000-READ-FORWARD-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n       9100-READ-BACKWARDS.                                                     \n                                                                                \n           MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n           MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY                      \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           COMPUTE WS-SCRN-COUNTER =                                            \n                                   WS-MAX-SCREEN-LINES + 1                      \n           END-COMPUTE                                                          \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n      *****************************************************************         \n      *    Now we show the records from previous set.                           \n      *****************************************************************         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   SUBTRACT 1          FROM WS-SCRN-COUNTER                     \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n                  GO TO 9100-READ-BACKWARDS-EXIT                                \n           END-EVALUATE                                                         \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      MOVE CARD-NUM                                             \n                                  TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)           \n                      MOVE CARD-ACCT-ID                                         \n                                  TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)             \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                  TO                                            \n                                  WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)           \n                                                                                \n                      SUBTRACT 1  FROM WS-SCRN-COUNTER                          \n                      IF WS-SCRN-COUNTER = 0                                    \n                         SET READ-LOOP-EXIT  TO TRUE                            \n                                                                                \n                         MOVE CARD-ACCT-ID                                      \n                                  TO WS-CA-FIRST-CARD-ACCT-ID                   \n                         MOVE CARD-NUM                                          \n                                  TO WS-CA-FIRST-CARD-NUM                       \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n                                                                                \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n           .                                                                    \n                                                                                \n       9100-READ-BACKWARDS-EXIT.                                                \n           EXEC CICS                                                            \n                ENDBR FILE(LIT-CARD-FILE)                                       \n           END-EXEC                                                             \n                                                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9500-FILTER-RECORDS.                                                     \n           SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE                             \n                                                                                \n           IF FLG-ACCTFILTER-ISVALID                                            \n              IF  CARD-ACCT-ID = CC-ACCT-ID                                     \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD  TO TRUE                           \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-ISVALID                                            \n              IF  CARD-NUM = CC-CARD-NUM-N                                      \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD TO TRUE                            \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           .                                                                    \n                                                                                \n       9500-FILTER-RECORDS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************\n      *Common code to store PFKey                                      \n      *****************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-ERROR-MSG)                                         \n                     LENGTH(LENGTH OF WS-ERROR-MSG)                             \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "COCRDSL",
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CVACT02Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "COTTL01Y",
        "CSMSG02Y",
        "DFHAID",
        "CSSTRPFY",
        "CVCRD01Y",
        "COCRDLI"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant Main as 0000-MAIN\n    participant SendMap as 1000-SEND-MAP\n    participant ReceiveMap as 2000-RECEIVE-MAP\n    participant ReadForward as 9000-READ-FORWARD\n    participant ReadBackwards as 9100-READ-BACKWARDS\n    participant FilterRecords as 9500-FILTER-RECORDS\n    participant CICS\n    participant CardFile as CARDDAT File\n\n    User->>Main: Start transaction\n    \n    Main->>Main: Initialize work areas\n    Main->>Main: Check COMMAREA\n    \n    alt First execution\n        Main->>Main: Initialize COMMAREA\n    else Subsequent call\n        Main->>Main: Retrieve COMMAREA data\n    end\n    \n    Main->>Main: Store PF key\n    \n    alt User pressed PF3 (Exit)\n        Main->>CICS: XCTL to menu program\n    else User pressed PF7 (Page Up)\n        alt First page\n            Main->>ReadForward: Read current page\n            ReadForward->>CardFile: STARTBR\n            ReadForward->>CardFile: READNEXT (multiple)\n            CardFile-->>ReadForward: Card records\n            ReadForward->>FilterRecords: Filter records\n            ReadForward->>CardFile: ENDBR\n            ReadForward-->>Main: Return filtered records\n        else Not first page\n            Main->>ReadBackwards: Read previous page\n            ReadBackwards->>CardFile: STARTBR\n            ReadBackwards->>CardFile: READPREV (multiple)\n            CardFile-->>ReadBackwards: Card records\n            ReadBackwards->>FilterRecords: Filter records\n            ReadBackwards->>CardFile: ENDBR\n            ReadBackwards-->>Main: Return filtered records\n        end\n    else User pressed PF8 (Page Down)\n        alt More pages exist\n            Main->>ReadForward: Read next page\n            ReadForward->>CardFile: STARTBR\n            ReadForward->>CardFile: READNEXT (multiple)\n            CardFile-->>ReadForward: Card records\n            ReadForward->>FilterRecords: Filter records\n            ReadForward->>CardFile: ENDBR\n            ReadForward-->>Main: Return filtered records\n        else Last page\n            Main->>SendMap: Display current page\n        end\n    else User pressed ENTER\n        alt View card details selected\n            Main->>CICS: XCTL to card detail program\n        else Update card selected\n            Main->>CICS: XCTL to card update program\n        else Filter/search entered\n            Main->>ReceiveMap: Process input\n            ReceiveMap->>ReceiveMap: Validate account ID\n            ReceiveMap->>ReceiveMap: Validate card number\n            ReceiveMap->>ReceiveMap: Validate selections\n            \n            alt Input valid\n                Main->>ReadForward: Read filtered records\n                ReadForward->>CardFile: STARTBR\n                ReadForward->>CardFile: READNEXT (multiple)\n                CardFile-->>ReadForward: Card records\n                ReadForward->>FilterRecords: Filter records\n                ReadForward->>CardFile: ENDBR\n                ReadForward-->>Main: Return filtered records\n            else Input error\n                Main->>SendMap: Display error message\n            end\n        end\n    end\n    \n    Main->>SendMap: Prepare screen\n    SendMap->>SendMap: Initialize screen\n    SendMap->>SendMap: Setup array data\n    SendMap->>SendMap: Setup array attributes\n    SendMap->>SendMap: Setup screen attributes\n    SendMap->>SendMap: Setup messages\n    SendMap->>CICS: SEND MAP\n    \n    Main->>CICS: RETURN with COMMAREA\n    CICS-->>User: Display screen"
    },
    {
      "id": "CBTRN01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.\n           SELECT DALYTRAN-FILE ASSIGN TO DALYTRAN\n                  ORGANIZATION IS SEQUENTIAL\n                  ACCESS MODE  IS SEQUENTIAL\n                  FILE STATUS  IS DALYTRAN-STATUS.\n\n           SELECT CUSTOMER-FILE ASSIGN TO   CUSTFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-CUST-ID\n                  FILE STATUS  IS CUSTFILE-STATUS.\n\n           SELECT XREF-FILE ASSIGN TO   XREFFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-XREF-CARD-NUM\n                  FILE STATUS  IS XREFFILE-STATUS.\n\n           SELECT CARD-FILE ASSIGN TO   CARDFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-CARD-NUM\n                  FILE STATUS  IS CARDFILE-STATUS.\n\n           SELECT ACCOUNT-FILE ASSIGN TO   ACCTFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-ACCT-ID\n                  FILE STATUS  IS ACCTFILE-STATUS.\n\n           SELECT TRANSACT-FILE ASSIGN TO   TRANFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-TRANS-ID\n                  FILE STATUS  IS TRANFILE-STATUS.\n      *",
            "description": "This INPUT-OUTPUT SECTION defines six files used by the CBTRN01C program for processing credit card transactions. It includes a sequential DALYTRAN-FILE for daily transactions, and five indexed files accessed in random mode: CUSTOMER-FILE (keyed by customer ID), XREF-FILE (keyed by card number), CARD-FILE (keyed by card number), ACCOUNT-FILE (keyed by account ID), and TRANSACT-FILE (keyed by transaction ID). Each file has an associated file status variable for error handling. The configuration supports the program's core functionality of reading transaction records and validating them against various reference files."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  DALYTRAN-FILE.\n       01  FD-TRAN-RECORD.\n           05 FD-TRAN-ID                        PIC X(16).\n           05 FD-CUST-DATA                      PIC X(334).\n\n       FD  CUSTOMER-FILE.\n       01  FD-CUSTFILE-REC.\n           05 FD-CUST-ID                        PIC 9(09).\n           05 FD-CUST-DATA                      PIC X(491).\n\n       FD  XREF-FILE.\n       01  FD-XREFFILE-REC.\n           05 FD-XREF-CARD-NUM                  PIC X(16).\n           05 FD-XREF-DATA                      PIC X(34).\n\n       FD  CARD-FILE.\n       01  FD-CARDFILE-REC.\n           05 FD-CARD-NUM                       PIC X(16).\n           05 FD-CARD-DATA                      PIC X(134).\n\n       FD  ACCOUNT-FILE.\n       01  FD-ACCTFILE-REC.\n           05 FD-ACCT-ID                        PIC 9(11).\n           05 FD-ACCT-DATA                      PIC X(289).\n\n       FD  TRANSACT-FILE.\n       01  FD-TRANFILE-REC.\n           05 FD-TRANS-ID                       PIC X(16).\n           05 FD-ACCT-DATA                      PIC X(334).",
            "description": "This File Section defines the file structures used in the CBTRN01C program for processing credit card transactions. It includes six file descriptors (FD) for the various files the program interacts with: DALYTRAN-FILE (daily transaction file), CUSTOMER-FILE (customer records), XREF-FILE (card number cross-reference), CARD-FILE (card details), ACCOUNT-FILE (account information), and TRANSACT-FILE (transaction records). Each file has a defined record structure with key identifier fields (such as card numbers, customer IDs, account IDs, or transaction IDs) followed by data fields that contain the remaining record information. The structure allows the program to read transaction records, validate them against reference data, and process them accordingly."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************\n       COPY CVTRA06Y.\n       01  DALYTRAN-STATUS.\n           05  DALYTRAN-STAT1      PIC X.\n           05  DALYTRAN-STAT2      PIC X.\n\n       COPY CVCUS01Y.\n       01  CUSTFILE-STATUS.\n           05  CUSTFILE-STAT1      PIC X.\n           05  CUSTFILE-STAT2      PIC X.\n\n       COPY CVACT03Y.\n       01  XREFFILE-STATUS.\n           05  XREFFILE-STAT1      PIC X.\n           05  XREFFILE-STAT2      PIC X.\n\n       COPY CVACT02Y.\n       01  CARDFILE-STATUS.\n           05  CARDFILE-STAT1      PIC X.\n           05  CARDFILE-STAT2      PIC X.\n\n       COPY CVACT01Y.\n       01  ACCTFILE-STATUS.\n           05  ACCTFILE-STAT1      PIC X.\n           05  ACCTFILE-STAT2      PIC X.\n\n       COPY CVTRA05Y.\n       01  TRANFILE-STATUS.\n           05  TRANFILE-STAT1      PIC X.\n           05  TRANFILE-STAT2      PIC X.\n\n       01  IO-STATUS.\n           05  IO-STAT1            PIC X.\n           05  IO-STAT2            PIC X.\n\n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.\n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.\n           05  TWO-BYTES-LEFT      PIC X.\n           05  TWO-BYTES-RIGHT     PIC X.\n\n       01  IO-STATUS-04.\n           05  IO-STATUS-0401      PIC 9   VALUE 0.\n           05  IO-STATUS-0403      PIC 999 VALUE 0.\n\n       01  APPL-RESULT             PIC S9(9)   COMP.\n           88  APPL-AOK            VALUE 0.\n           88  APPL-EOF            VALUE 16.\n\n       01  END-OF-DAILY-TRANS-FILE             PIC X(01)    VALUE 'N'.\n       01  ABCODE                  PIC S9(9) BINARY.\n       01  TIMING                  PIC S9(9) BINARY.\n       01  WS-MISC-VARIABLES.\n           05 WS-XREF-READ-STATUS  PIC 9(04).\n           05 WS-ACCT-READ-STATUS  PIC 9(04).\n\n      *****************************************************************",
            "description": "This Working Storage Section defines the data structures used by the CBTRN01C program for processing credit card transactions. It includes status fields for six different files: daily transaction (DALYTRAN), customer (CUSTFILE), cross-reference (XREFFILE), card (CARDFILE), account (ACCTFILE), and transaction (TRANFILE) files. Each file has a status field divided into two parts (STAT1 and STAT2) for detailed error reporting. The section also includes several utility fields for I/O operations, binary data handling, and application control. Key control variables include APPL-RESULT with condition names for normal processing (APPL-AOK) and end-of-file conditions (APPL-EOF), as well as END-OF-DAILY-TRANS-FILE to track file processing status. The section incorporates six copybooks (CVTRA06Y, CVCUS01Y, CVACT03Y, CVACT02Y, CVACT01Y, and CVTRA05Y) which likely contain the record layouts for the various files being processed."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.\n       FD  DALYTRAN-FILE.\n       01  FD-TRAN-RECORD.\n           05 FD-TRAN-ID                        PIC X(16).\n           05 FD-CUST-DATA                      PIC X(334).\n\n       FD  CUSTOMER-FILE.\n       01  FD-CUSTFILE-REC.\n           05 FD-CUST-ID                        PIC 9(09).\n           05 FD-CUST-DATA                      PIC X(491).\n\n       FD  XREF-FILE.\n       01  FD-XREFFILE-REC.\n           05 FD-XREF-CARD-NUM                  PIC X(16).\n           05 FD-XREF-DATA                      PIC X(34).\n\n       FD  CARD-FILE.\n       01  FD-CARDFILE-REC.\n           05 FD-CARD-NUM                       PIC X(16).\n           05 FD-CARD-DATA                      PIC X(134).\n\n       FD  ACCOUNT-FILE.\n       01  FD-ACCTFILE-REC.\n           05 FD-ACCT-ID                        PIC 9(11).\n           05 FD-ACCT-DATA                      PIC X(289).\n\n       FD  TRANSACT-FILE.\n       01  FD-TRANFILE-REC.\n           05 FD-TRANS-ID                       PIC X(16).\n           05 FD-ACCT-DATA                      PIC X(334).\n\n       WORKING-STORAGE SECTION.\n\n      *****************************************************************\n       COPY CVTRA06Y.\n       01  DALYTRAN-STATUS.\n           05  DALYTRAN-STAT1      PIC X.\n           05  DALYTRAN-STAT2      PIC X.\n\n       COPY CVCUS01Y.\n       01  CUSTFILE-STATUS.\n           05  CUSTFILE-STAT1      PIC X.\n           05  CUSTFILE-STAT2      PIC X.\n\n       COPY CVACT03Y.\n       01  XREFFILE-STATUS.\n           05  XREFFILE-STAT1      PIC X.\n           05  XREFFILE-STAT2      PIC X.\n\n       COPY CVACT02Y.\n       01  CARDFILE-STATUS.\n           05  CARDFILE-STAT1      PIC X.\n           05  CARDFILE-STAT2      PIC X.\n\n       COPY CVACT01Y.\n       01  ACCTFILE-STATUS.\n           05  ACCTFILE-STAT1      PIC X.\n           05  ACCTFILE-STAT2      PIC X.\n\n       COPY CVTRA05Y.\n       01  TRANFILE-STATUS.\n           05  TRANFILE-STAT1      PIC X.\n           05  TRANFILE-STAT2      PIC X.\n\n       01  IO-STATUS.\n           05  IO-STAT1            PIC X.\n           05  IO-STAT2            PIC X.\n\n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.\n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.\n           05  TWO-BYTES-LEFT      PIC X.\n           05  TWO-BYTES-RIGHT     PIC X.\n\n       01  IO-STATUS-04.\n           05  IO-STATUS-0401      PIC 9   VALUE 0.\n           05  IO-STATUS-0403      PIC 999 VALUE 0.\n\n       01  APPL-RESULT             PIC S9(9)   COMP.\n           88  APPL-AOK            VALUE 0.\n           88  APPL-EOF            VALUE 16.\n\n       01  END-OF-DAILY-TRANS-FILE             PIC X(01)    VALUE 'N'.\n       01  ABCODE                  PIC S9(9) BINARY.\n       01  TIMING                  PIC S9(9) BINARY.\n       01  WS-MISC-VARIABLES.\n           05 WS-XREF-READ-STATUS  PIC 9(04).\n           05 WS-ACCT-READ-STATUS  PIC 9(04).\n\n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN01C'.\n           PERFORM 0000-DALYTRAN-OPEN.\n           PERFORM 0100-CUSTFILE-OPEN.\n           PERFORM 0200-XREFFILE-OPEN.\n           PERFORM 0300-CARDFILE-OPEN.\n           PERFORM 0400-ACCTFILE-OPEN.\n           PERFORM 0500-TRANFILE-OPEN.\n\n           PERFORM UNTIL END-OF-DAILY-TRANS-FILE = 'Y'\n               IF  END-OF-DAILY-TRANS-FILE = 'N'\n                   PERFORM 1000-DALYTRAN-GET-NEXT\n                   IF  END-OF-DAILY-TRANS-FILE = 'N'\n                       DISPLAY DALYTRAN-RECORD\n                   END-IF\n                   MOVE 0                 TO WS-XREF-READ-STATUS\n                   MOVE DALYTRAN-CARD-NUM TO XREF-CARD-NUM\n                   PERFORM 2000-LOOKUP-XREF\n                   IF WS-XREF-READ-STATUS = 0\n                     MOVE 0            TO WS-ACCT-READ-STATUS\n                     MOVE XREF-ACCT-ID TO ACCT-ID\n                     PERFORM 3000-READ-ACCOUNT\n                     IF WS-ACCT-READ-STATUS NOT = 0\n                         DISPLAY 'ACCOUNT ' ACCT-ID ' NOT FOUND'\n                     END-IF\n                   ELSE\n                     DISPLAY 'CARD NUMBER ' DALYTRAN-CARD-NUM\n                     ' COULD NOT BE VERIFIED. SKIPPING TRANSACTION ID-'\n                     DALYTRAN-ID\n                   END-IF\n               END-IF\n           END-PERFORM.\n\n           PERFORM 9000-DALYTRAN-CLOSE.\n           PERFORM 9100-CUSTFILE-CLOSE.\n           PERFORM 9200-XREFFILE-CLOSE.\n           PERFORM 9300-CARDFILE-CLOSE.\n           PERFORM 9400-ACCTFILE-CLOSE.\n           PERFORM 9500-TRANFILE-CLOSE.\n\n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN01C'.\n\n           GOBACK.\n\n      *****************************************************************\n      * READS FILE                                                    *\n      *****************************************************************",
            "description": "This paragraph serves as the main control flow for the CBTRN01C program. It begins by opening all required files (daily transaction, customer, cross-reference, card, account, and transaction files) through separate procedures. The core processing occurs in a loop that continues until the end of the daily transaction file is reached. For each transaction record, the program displays the record, looks up the card number in the cross-reference file, and if found, attempts to read the corresponding account record. Error messages are displayed when a card number cannot be verified or when an account is not found. After processing all transactions, the program methodically closes all files in reverse order of opening and terminates execution. The paragraph effectively orchestrates the transaction validation workflow by coordinating the various file operations and lookup procedures."
          },
          {
            "name": "1000-DALYTRAN-GET-NEXT",
            "code": "READ DALYTRAN-FILE INTO DALYTRAN-RECORD.\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               IF  DALYTRAN-STATUS = '10'\n                   MOVE 16 TO APPL-RESULT\n               ELSE\n                   MOVE 12 TO APPL-RESULT\n               END-IF\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               IF  APPL-EOF\n                   MOVE 'Y' TO END-OF-DAILY-TRANS-FILE\n               ELSE\n                   DISPLAY 'ERROR READING DAILY TRANSACTION FILE'\n                   MOVE DALYTRAN-STATUS TO IO-STATUS\n                   PERFORM Z-DISPLAY-IO-STATUS\n                   PERFORM Z-ABEND-PROGRAM\n               END-IF\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the reading of records from the daily transaction file. It reads the next record into the DALYTRAN-RECORD structure and processes the file status. If the read is successful (status '00'), it sets APPL-RESULT to 0 indicating success. If end-of-file is reached (status '10'), it sets APPL-RESULT to 16. For any other status, it sets APPL-RESULT to 12 indicating an error. When successful, processing continues. When end-of-file is encountered, it sets the END-OF-DAILY-TRANS-FILE flag to 'Y'. For any other error, it displays an error message, captures the file status, displays the status details, and abends the program."
          },
          {
            "name": "2000-LOOKUP-XREF",
            "code": "MOVE XREF-CARD-NUM TO FD-XREF-CARD-NUM\n           READ XREF-FILE  RECORD INTO CARD-XREF-RECORD\n           KEY IS FD-XREF-CARD-NUM\n                INVALID KEY\n                  DISPLAY 'INVALID CARD NUMBER FOR XREF'\n                  MOVE 4 TO WS-XREF-READ-STATUS\n                NOT INVALID KEY\n                  DISPLAY 'SUCCESSFUL READ OF XREF'\n                  DISPLAY 'CARD NUMBER: ' XREF-CARD-NUM\n                  DISPLAY 'ACCOUNT ID : ' XREF-ACCT-ID\n                  DISPLAY 'CUSTOMER ID: ' XREF-CUST-ID\n           END-READ.\n      *---------------------------------------------------------------*",
            "description": "This paragraph performs a lookup operation in the cross-reference file (XREF-FILE) using the card number as the key. It first moves the card number from XREF-CARD-NUM to the file descriptor field FD-XREF-CARD-NUM, then attempts to read the corresponding record into CARD-XREF-RECORD. If the card number is not found (INVALID KEY condition), it displays an error message and sets the status code to 4. If the card number is valid, it displays a success message along with the retrieved card number, account ID, and customer ID from the cross-reference record. This lookup is a critical validation step that determines whether a transaction has a valid card number and retrieves the associated account and customer information needed for further processing."
          },
          {
            "name": "3000-READ-ACCOUNT",
            "code": "MOVE ACCT-ID TO FD-ACCT-ID\n           READ ACCOUNT-FILE RECORD INTO ACCOUNT-RECORD\n           KEY IS FD-ACCT-ID\n                INVALID KEY\n                  DISPLAY 'INVALID ACCOUNT NUMBER FOUND'\n                  MOVE 4 TO WS-ACCT-READ-STATUS\n                NOT INVALID KEY\n                  DISPLAY 'SUCCESSFUL READ OF ACCOUNT FILE'\n           END-READ.\n      *---------------------------------------------------------------*",
            "description": "This paragraph reads an account record from the ACCOUNT-FILE using the ACCT-ID as the key. It attempts to retrieve the account information into the ACCOUNT-RECORD structure. If the account number is not found (INVALID KEY condition), it displays an error message and sets WS-ACCT-READ-STATUS to 4 to indicate a failed lookup. If the account is successfully found, it displays a confirmation message. This validation step is part of the transaction processing workflow to ensure that transactions are associated with valid accounts."
          },
          {
            "name": "0000-DALYTRAN-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT DALYTRAN-FILE\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING DAILY TRANSACTION FILE'\n               MOVE DALYTRAN-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the DALYTRAN-FILE (Daily Transaction File) with error handling. It initializes APPL-RESULT to 8, attempts to open the file in INPUT mode, and sets APPL-RESULT to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, retrieves the file status code, calls procedures to display the I/O status and abnormally terminate the program. This ensures the program doesn't proceed with processing if the critical transaction input file cannot be accessed."
          },
          {
            "name": "0100-CUSTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CUSTOMER-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the CUSTOMER-FILE for input processing. It initializes the APPL-RESULT to 8, attempts to open the file, and then checks the operation's success by examining the CUSTFILE-STATUS. If the file opens successfully (status '00'), it sets APPL-RESULT to 0 indicating success. Otherwise, it sets APPL-RESULT to 12 indicating failure. When a failure occurs, the paragraph displays an error message, captures the file status code, calls Z-DISPLAY-IO-STATUS to show detailed error information, and then calls Z-ABEND-PROGRAM to terminate execution. This represents standard file handling with proper error detection and reporting for a critical reference file in the transaction processing workflow."
          },
          {
            "name": "0200-XREFFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT XREF-FILE\n           IF  XREFFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CROSS REF FILE'\n               MOVE XREFFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the cross-reference file (XREF-FILE) that maps card numbers to account and customer IDs. It initializes the application result code to 8, attempts to open the file in input mode, and sets the result code to 0 if successful or 12 if unsuccessful. If the file opens successfully (APPL-AOK condition), processing continues. Otherwise, it displays an error message, calls a routine to display the I/O status code, and then abends the program. This is part of the program's initialization process that ensures all required files are available before transaction processing begins."
          },
          {
            "name": "0300-CARDFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CARD-FILE\n           IF  CARDFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CARD FILE'\n               MOVE CARDFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the CARD-FILE for input processing. It initializes APPL-RESULT to 8, attempts to open the file, and then checks the operation's success by examining CARDFILE-STATUS. If the file opens successfully (status '00'), APPL-RESULT is set to 0; otherwise, it's set to 12. When an error occurs, the paragraph displays an error message, captures the file status code, calls Z-DISPLAY-IO-STATUS to show detailed error information, and then calls Z-ABEND-PROGRAM to terminate execution. This represents standard file handling with comprehensive error management for a critical reference file in the transaction processing workflow."
          },
          {
            "name": "0400-ACCTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT ACCOUNT-FILE\n           IF  ACCTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING ACCOUNT FILE'\n               MOVE ACCTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the Account File for input processing. It sets an initial result code of 8, then attempts to open the file. If the operation is successful (status '00'), it resets the result code to 0; otherwise, it sets a more severe error code of 12. When an error occurs, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. This robust error handling ensures that account data is available before proceeding with transaction processing."
          },
          {
            "name": "0500-TRANFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.\n           OPEN INPUT TRANSACT-FILE\n           IF  TRANFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING TRANSACTION FILE'\n               MOVE TRANFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the transaction input file (TRANSACT-FILE) with error handling. It sets an initial result code of 8, attempts to open the file, and then checks the status. If the file opens successfully (status '00'), it sets the result to 0 (success). If the open operation fails, it sets the result to 12 (error). When an error occurs, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally by calling the Z-ABEND-PROGRAM paragraph. This robust error handling ensures that file access issues are properly detected and reported before transaction processing begins."
          },
          {
            "name": "9000-DALYTRAN-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE DALYTRAN-FILE\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the daily transaction file (DALYTRAN-FILE) with error handling. It initializes APPL-RESULT to 8, attempts to close the file, and then checks the status code. If the close operation is successful (status '00'), it sets APPL-RESULT to 0; otherwise, it sets it to 12. If the operation was not successful (APPL-AOK is false), it displays an error message, retrieves the file status code, calls routines to display the I/O status and abnormally terminate the program. The paragraph contains an inconsistency where it references CUSTOMER FILE in the error message despite closing the DALYTRAN-FILE, and similarly references CUSTFILE-STATUS instead of DALYTRAN-STATUS."
          },
          {
            "name": "9100-CUSTFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CUSTOMER-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the CUSTOMER-FILE with error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets it to 12. When an error occurs, the paragraph displays an error message, captures the file status code, calls Z-DISPLAY-IO-STATUS to show detailed error information, and then terminates the program abnormally via Z-ABEND-PROGRAM. This ensures proper resource cleanup and error reporting when closing the customer reference file."
          },
          {
            "name": "9200-XREFFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE XREF-FILE\n           IF  XREFFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CROSS REF FILE'\n               MOVE XREFFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the cross-reference file (XREF-FILE) with error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the close operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls routines to display the I/O status and abnormally terminate the program. This ensures proper resource cleanup and provides meaningful error information if the cross-reference file cannot be closed properly."
          },
          {
            "name": "9300-CARDFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CARD-FILE\n           IF  CARDFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CARD FILE'\n               MOVE CARDFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the CARD-FILE with comprehensive error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets it to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls Z-DISPLAY-IO-STATUS to show detailed error information, and then terminates the program abnormally via Z-ABEND-PROGRAM. This ensures that any issues with closing the card reference file are properly detected and handled, maintaining data integrity."
          },
          {
            "name": "9400-ACCTFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE ACCOUNT-FILE\n           IF  ACCTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'\n               MOVE ACCTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the ACCOUNT-FILE with comprehensive error handling. It initially sets APPL-RESULT to 8, then attempts to close the account file. If the operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally through the Z-ABEND-PROGRAM paragraph. This ensures that any file closure issues are properly detected and handled, preventing the program from continuing with potentially corrupted file states."
          },
          {
            "name": "9500-TRANFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE TRANSACT-FILE\n           IF  TRANFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'\n               MOVE TRANFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.",
            "description": "This paragraph handles the closing of the transaction file with error handling. It first sets APPL-RESULT to 8, then attempts to close the TRANSACT-FILE. If the operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets it to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls routines to display the I/O status details and abnormally terminate the program. The paragraph is part of the program's comprehensive file operation error handling mechanism."
          },
          {
            "name": "Z-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'\n           MOVE 0 TO TIMING\n           MOVE 999 TO ABCODE\n           CALL 'CEE3ABD'.\n\n      *****************************************************************",
            "description": "This paragraph handles abnormal program termination by displaying an \"ABENDING PROGRAM\" message, resetting the TIMING variable to zero, setting an abort code (ABCODE) to 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program termination. This is used as a last resort error handling mechanism when the program encounters a critical error that prevents further processing."
          },
          {
            "name": "Z-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC\n           OR  IO-STAT1 = '9'\n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)\n               MOVE 0        TO TWO-BYTES-BINARY\n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT\n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04\n           ELSE\n               MOVE '0000' TO IO-STATUS-04\n               MOVE IO-STATUS TO IO-STATUS-04(3:2)\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04\n           END-IF\n           EXIT.",
            "description": "This paragraph handles the display of file I/O status codes in a standardized format. It processes the IO-STATUS field differently based on whether it contains a numeric value or if the first byte indicates a severe error (IO-STAT1 = '9'). For non-numeric status codes or severe errors, it formats the first byte directly and converts the second byte through binary manipulation to create a four-character display format. For standard numeric status codes, it creates a four-character display with leading zeros. The formatted status code is then displayed with a descriptive message. This provides consistent error reporting for file operations throughout the program, helping with debugging and error identification."
          }
        ],
        "code": "MAIN-PARA.\n           DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN01C'.\n           PERFORM 0000-DALYTRAN-OPEN.\n           PERFORM 0100-CUSTFILE-OPEN.\n           PERFORM 0200-XREFFILE-OPEN.\n           PERFORM 0300-CARDFILE-OPEN.\n           PERFORM 0400-ACCTFILE-OPEN.\n           PERFORM 0500-TRANFILE-OPEN.\n\n           PERFORM UNTIL END-OF-DAILY-TRANS-FILE = 'Y'\n               IF  END-OF-DAILY-TRANS-FILE = 'N'\n                   PERFORM 1000-DALYTRAN-GET-NEXT\n                   IF  END-OF-DAILY-TRANS-FILE = 'N'\n                       DISPLAY DALYTRAN-RECORD\n                   END-IF\n                   MOVE 0                 TO WS-XREF-READ-STATUS\n                   MOVE DALYTRAN-CARD-NUM TO XREF-CARD-NUM\n                   PERFORM 2000-LOOKUP-XREF\n                   IF WS-XREF-READ-STATUS = 0\n                     MOVE 0            TO WS-ACCT-READ-STATUS\n                     MOVE XREF-ACCT-ID TO ACCT-ID\n                     PERFORM 3000-READ-ACCOUNT\n                     IF WS-ACCT-READ-STATUS NOT = 0\n                         DISPLAY 'ACCOUNT ' ACCT-ID ' NOT FOUND'\n                     END-IF\n                   ELSE\n                     DISPLAY 'CARD NUMBER ' DALYTRAN-CARD-NUM\n                     ' COULD NOT BE VERIFIED. SKIPPING TRANSACTION ID-'\n                     DALYTRAN-ID\n                   END-IF\n               END-IF\n           END-PERFORM.\n\n           PERFORM 9000-DALYTRAN-CLOSE.\n           PERFORM 9100-CUSTFILE-CLOSE.\n           PERFORM 9200-XREFFILE-CLOSE.\n           PERFORM 9300-CARDFILE-CLOSE.\n           PERFORM 9400-ACCTFILE-CLOSE.\n           PERFORM 9500-TRANFILE-CLOSE.\n\n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN01C'.\n\n           GOBACK.\n\n      *****************************************************************\n      * READS FILE                                                    *\n      *****************************************************************\n       1000-DALYTRAN-GET-NEXT.\n           READ DALYTRAN-FILE INTO DALYTRAN-RECORD.\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               IF  DALYTRAN-STATUS = '10'\n                   MOVE 16 TO APPL-RESULT\n               ELSE\n                   MOVE 12 TO APPL-RESULT\n               END-IF\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               IF  APPL-EOF\n                   MOVE 'Y' TO END-OF-DAILY-TRANS-FILE\n               ELSE\n                   DISPLAY 'ERROR READING DAILY TRANSACTION FILE'\n                   MOVE DALYTRAN-STATUS TO IO-STATUS\n                   PERFORM Z-DISPLAY-IO-STATUS\n                   PERFORM Z-ABEND-PROGRAM\n               END-IF\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       2000-LOOKUP-XREF.\n           MOVE XREF-CARD-NUM TO FD-XREF-CARD-NUM\n           READ XREF-FILE  RECORD INTO CARD-XREF-RECORD\n           KEY IS FD-XREF-CARD-NUM\n                INVALID KEY\n                  DISPLAY 'INVALID CARD NUMBER FOR XREF'\n                  MOVE 4 TO WS-XREF-READ-STATUS\n                NOT INVALID KEY\n                  DISPLAY 'SUCCESSFUL READ OF XREF'\n                  DISPLAY 'CARD NUMBER: ' XREF-CARD-NUM\n                  DISPLAY 'ACCOUNT ID : ' XREF-ACCT-ID\n                  DISPLAY 'CUSTOMER ID: ' XREF-CUST-ID\n           END-READ.\n      *---------------------------------------------------------------*\n       3000-READ-ACCOUNT.\n           MOVE ACCT-ID TO FD-ACCT-ID\n           READ ACCOUNT-FILE RECORD INTO ACCOUNT-RECORD\n           KEY IS FD-ACCT-ID\n                INVALID KEY\n                  DISPLAY 'INVALID ACCOUNT NUMBER FOUND'\n                  MOVE 4 TO WS-ACCT-READ-STATUS\n                NOT INVALID KEY\n                  DISPLAY 'SUCCESSFUL READ OF ACCOUNT FILE'\n           END-READ.\n      *---------------------------------------------------------------*\n       0000-DALYTRAN-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT DALYTRAN-FILE\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING DAILY TRANSACTION FILE'\n               MOVE DALYTRAN-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n      *---------------------------------------------------------------*\n       0100-CUSTFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CUSTOMER-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0200-XREFFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT XREF-FILE\n           IF  XREFFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CROSS REF FILE'\n               MOVE XREFFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0300-CARDFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CARD-FILE\n           IF  CARDFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CARD FILE'\n               MOVE CARDFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0400-ACCTFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT ACCOUNT-FILE\n           IF  ACCTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING ACCOUNT FILE'\n               MOVE ACCTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0500-TRANFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT TRANSACT-FILE\n           IF  TRANFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING TRANSACTION FILE'\n               MOVE TRANFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9000-DALYTRAN-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE DALYTRAN-FILE\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9100-CUSTFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CUSTOMER-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9200-XREFFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE XREF-FILE\n           IF  XREFFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CROSS REF FILE'\n               MOVE XREFFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9300-CARDFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CARD-FILE\n           IF  CARDFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CARD FILE'\n               MOVE CARDFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9400-ACCTFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE ACCOUNT-FILE\n           IF  ACCTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'\n               MOVE ACCTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9500-TRANFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE TRANSACT-FILE\n           IF  TRANFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'\n               MOVE TRANFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n       Z-ABEND-PROGRAM.\n           DISPLAY 'ABENDING PROGRAM'\n           MOVE 0 TO TIMING\n           MOVE 999 TO ABCODE\n           CALL 'CEE3ABD'.\n\n      *****************************************************************\n       Z-DISPLAY-IO-STATUS.\n           IF  IO-STATUS NOT NUMERIC\n           OR  IO-STAT1 = '9'\n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)\n               MOVE 0        TO TWO-BYTES-BINARY\n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT\n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04\n           ELSE\n               MOVE '0000' TO IO-STATUS-04\n               MOVE IO-STATUS TO IO-STATUS-04(3:2)\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04\n           END-IF\n           EXIT."
      },
      "description": "This batch COBOL program (CBTRN01C) processes daily credit card transactions by reading records from a daily transaction file and validating them against various reference files. The program verifies card numbers by looking them up in a cross-reference file, which maps card numbers to account IDs and customer IDs. It then attempts to read the corresponding account record to further validate the transaction. The program handles file operations for six different files (daily transaction, customer, cross-reference, card, account, and transaction files), with comprehensive error handling for file operations. Each transaction record is displayed along with validation information, and any validation failures (such as invalid card numbers or missing accounts) are reported. The program is part of the CardDemo application, which showcases AWS and partner technology for mainframe migration and modernization use-cases.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBTRN01C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : Post the records from daily transaction file.     \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.\n       PROGRAM-ID.    CBTRN01C.\n       AUTHOR.        AWS.\n\n       ENVIRONMENT DIVISION.\n       INPUT-OUTPUT SECTION.\n       FILE-CONTROL.\n           SELECT DALYTRAN-FILE ASSIGN TO DALYTRAN\n                  ORGANIZATION IS SEQUENTIAL\n                  ACCESS MODE  IS SEQUENTIAL\n                  FILE STATUS  IS DALYTRAN-STATUS.\n\n           SELECT CUSTOMER-FILE ASSIGN TO   CUSTFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-CUST-ID\n                  FILE STATUS  IS CUSTFILE-STATUS.\n\n           SELECT XREF-FILE ASSIGN TO   XREFFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-XREF-CARD-NUM\n                  FILE STATUS  IS XREFFILE-STATUS.\n\n           SELECT CARD-FILE ASSIGN TO   CARDFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-CARD-NUM\n                  FILE STATUS  IS CARDFILE-STATUS.\n\n           SELECT ACCOUNT-FILE ASSIGN TO   ACCTFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-ACCT-ID\n                  FILE STATUS  IS ACCTFILE-STATUS.\n\n           SELECT TRANSACT-FILE ASSIGN TO   TRANFILE\n                  ORGANIZATION IS INDEXED\n                  ACCESS MODE  IS RANDOM\n                  RECORD KEY   IS FD-TRANS-ID\n                  FILE STATUS  IS TRANFILE-STATUS.\n      *\n       DATA DIVISION.\n       FILE SECTION.\n       FD  DALYTRAN-FILE.\n       01  FD-TRAN-RECORD.\n           05 FD-TRAN-ID                        PIC X(16).\n           05 FD-CUST-DATA                      PIC X(334).\n\n       FD  CUSTOMER-FILE.\n       01  FD-CUSTFILE-REC.\n           05 FD-CUST-ID                        PIC 9(09).\n           05 FD-CUST-DATA                      PIC X(491).\n\n       FD  XREF-FILE.\n       01  FD-XREFFILE-REC.\n           05 FD-XREF-CARD-NUM                  PIC X(16).\n           05 FD-XREF-DATA                      PIC X(34).\n\n       FD  CARD-FILE.\n       01  FD-CARDFILE-REC.\n           05 FD-CARD-NUM                       PIC X(16).\n           05 FD-CARD-DATA                      PIC X(134).\n\n       FD  ACCOUNT-FILE.\n       01  FD-ACCTFILE-REC.\n           05 FD-ACCT-ID                        PIC 9(11).\n           05 FD-ACCT-DATA                      PIC X(289).\n\n       FD  TRANSACT-FILE.\n       01  FD-TRANFILE-REC.\n           05 FD-TRANS-ID                       PIC X(16).\n           05 FD-ACCT-DATA                      PIC X(334).\n\n       WORKING-STORAGE SECTION.\n\n      *****************************************************************\n       COPY CVTRA06Y.\n       01  DALYTRAN-STATUS.\n           05  DALYTRAN-STAT1      PIC X.\n           05  DALYTRAN-STAT2      PIC X.\n\n       COPY CVCUS01Y.\n       01  CUSTFILE-STATUS.\n           05  CUSTFILE-STAT1      PIC X.\n           05  CUSTFILE-STAT2      PIC X.\n\n       COPY CVACT03Y.\n       01  XREFFILE-STATUS.\n           05  XREFFILE-STAT1      PIC X.\n           05  XREFFILE-STAT2      PIC X.\n\n       COPY CVACT02Y.\n       01  CARDFILE-STATUS.\n           05  CARDFILE-STAT1      PIC X.\n           05  CARDFILE-STAT2      PIC X.\n\n       COPY CVACT01Y.\n       01  ACCTFILE-STATUS.\n           05  ACCTFILE-STAT1      PIC X.\n           05  ACCTFILE-STAT2      PIC X.\n\n       COPY CVTRA05Y.\n       01  TRANFILE-STATUS.\n           05  TRANFILE-STAT1      PIC X.\n           05  TRANFILE-STAT2      PIC X.\n\n       01  IO-STATUS.\n           05  IO-STAT1            PIC X.\n           05  IO-STAT2            PIC X.\n\n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.\n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.\n           05  TWO-BYTES-LEFT      PIC X.\n           05  TWO-BYTES-RIGHT     PIC X.\n\n       01  IO-STATUS-04.\n           05  IO-STATUS-0401      PIC 9   VALUE 0.\n           05  IO-STATUS-0403      PIC 999 VALUE 0.\n\n       01  APPL-RESULT             PIC S9(9)   COMP.\n           88  APPL-AOK            VALUE 0.\n           88  APPL-EOF            VALUE 16.\n\n       01  END-OF-DAILY-TRANS-FILE             PIC X(01)    VALUE 'N'.\n       01  ABCODE                  PIC S9(9) BINARY.\n       01  TIMING                  PIC S9(9) BINARY.\n       01  WS-MISC-VARIABLES.\n           05 WS-XREF-READ-STATUS  PIC 9(04).\n           05 WS-ACCT-READ-STATUS  PIC 9(04).\n\n      *****************************************************************\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n           DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN01C'.\n           PERFORM 0000-DALYTRAN-OPEN.\n           PERFORM 0100-CUSTFILE-OPEN.\n           PERFORM 0200-XREFFILE-OPEN.\n           PERFORM 0300-CARDFILE-OPEN.\n           PERFORM 0400-ACCTFILE-OPEN.\n           PERFORM 0500-TRANFILE-OPEN.\n\n           PERFORM UNTIL END-OF-DAILY-TRANS-FILE = 'Y'\n               IF  END-OF-DAILY-TRANS-FILE = 'N'\n                   PERFORM 1000-DALYTRAN-GET-NEXT\n                   IF  END-OF-DAILY-TRANS-FILE = 'N'\n                       DISPLAY DALYTRAN-RECORD\n                   END-IF\n                   MOVE 0                 TO WS-XREF-READ-STATUS\n                   MOVE DALYTRAN-CARD-NUM TO XREF-CARD-NUM\n                   PERFORM 2000-LOOKUP-XREF\n                   IF WS-XREF-READ-STATUS = 0\n                     MOVE 0            TO WS-ACCT-READ-STATUS\n                     MOVE XREF-ACCT-ID TO ACCT-ID\n                     PERFORM 3000-READ-ACCOUNT\n                     IF WS-ACCT-READ-STATUS NOT = 0\n                         DISPLAY 'ACCOUNT ' ACCT-ID ' NOT FOUND'\n                     END-IF\n                   ELSE\n                     DISPLAY 'CARD NUMBER ' DALYTRAN-CARD-NUM\n                     ' COULD NOT BE VERIFIED. SKIPPING TRANSACTION ID-'\n                     DALYTRAN-ID\n                   END-IF\n               END-IF\n           END-PERFORM.\n\n           PERFORM 9000-DALYTRAN-CLOSE.\n           PERFORM 9100-CUSTFILE-CLOSE.\n           PERFORM 9200-XREFFILE-CLOSE.\n           PERFORM 9300-CARDFILE-CLOSE.\n           PERFORM 9400-ACCTFILE-CLOSE.\n           PERFORM 9500-TRANFILE-CLOSE.\n\n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN01C'.\n\n           GOBACK.\n\n      *****************************************************************\n      * READS FILE                                                    *\n      *****************************************************************\n       1000-DALYTRAN-GET-NEXT.\n           READ DALYTRAN-FILE INTO DALYTRAN-RECORD.\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               IF  DALYTRAN-STATUS = '10'\n                   MOVE 16 TO APPL-RESULT\n               ELSE\n                   MOVE 12 TO APPL-RESULT\n               END-IF\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               IF  APPL-EOF\n                   MOVE 'Y' TO END-OF-DAILY-TRANS-FILE\n               ELSE\n                   DISPLAY 'ERROR READING DAILY TRANSACTION FILE'\n                   MOVE DALYTRAN-STATUS TO IO-STATUS\n                   PERFORM Z-DISPLAY-IO-STATUS\n                   PERFORM Z-ABEND-PROGRAM\n               END-IF\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       2000-LOOKUP-XREF.\n           MOVE XREF-CARD-NUM TO FD-XREF-CARD-NUM\n           READ XREF-FILE  RECORD INTO CARD-XREF-RECORD\n           KEY IS FD-XREF-CARD-NUM\n                INVALID KEY\n                  DISPLAY 'INVALID CARD NUMBER FOR XREF'\n                  MOVE 4 TO WS-XREF-READ-STATUS\n                NOT INVALID KEY\n                  DISPLAY 'SUCCESSFUL READ OF XREF'\n                  DISPLAY 'CARD NUMBER: ' XREF-CARD-NUM\n                  DISPLAY 'ACCOUNT ID : ' XREF-ACCT-ID\n                  DISPLAY 'CUSTOMER ID: ' XREF-CUST-ID\n           END-READ.\n      *---------------------------------------------------------------*\n       3000-READ-ACCOUNT.\n           MOVE ACCT-ID TO FD-ACCT-ID\n           READ ACCOUNT-FILE RECORD INTO ACCOUNT-RECORD\n           KEY IS FD-ACCT-ID\n                INVALID KEY\n                  DISPLAY 'INVALID ACCOUNT NUMBER FOUND'\n                  MOVE 4 TO WS-ACCT-READ-STATUS\n                NOT INVALID KEY\n                  DISPLAY 'SUCCESSFUL READ OF ACCOUNT FILE'\n           END-READ.\n      *---------------------------------------------------------------*\n       0000-DALYTRAN-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT DALYTRAN-FILE\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING DAILY TRANSACTION FILE'\n               MOVE DALYTRAN-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n      *---------------------------------------------------------------*\n       0100-CUSTFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CUSTOMER-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0200-XREFFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT XREF-FILE\n           IF  XREFFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CROSS REF FILE'\n               MOVE XREFFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0300-CARDFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT CARD-FILE\n           IF  CARDFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING CARD FILE'\n               MOVE CARDFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0400-ACCTFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT ACCOUNT-FILE\n           IF  ACCTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING ACCOUNT FILE'\n               MOVE ACCTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       0500-TRANFILE-OPEN.\n           MOVE 8 TO APPL-RESULT.\n           OPEN INPUT TRANSACT-FILE\n           IF  TRANFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR OPENING TRANSACTION FILE'\n               MOVE TRANFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9000-DALYTRAN-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE DALYTRAN-FILE\n           IF  DALYTRAN-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9100-CUSTFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CUSTOMER-FILE\n           IF  CUSTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CUSTOMER FILE'\n               MOVE CUSTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9200-XREFFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE XREF-FILE\n           IF  XREFFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CROSS REF FILE'\n               MOVE XREFFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9300-CARDFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE CARD-FILE\n           IF  CARDFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING CARD FILE'\n               MOVE CARDFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9400-ACCTFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE ACCOUNT-FILE\n           IF  ACCTFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'\n               MOVE ACCTFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n      *---------------------------------------------------------------*\n       9500-TRANFILE-CLOSE.\n           ADD 8 TO ZERO GIVING APPL-RESULT.\n           CLOSE TRANSACT-FILE\n           IF  TRANFILE-STATUS = '00'\n               MOVE 0 TO APPL-RESULT\n           ELSE\n               MOVE 12 TO APPL-RESULT\n           END-IF\n           IF  APPL-AOK\n               CONTINUE\n           ELSE\n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'\n               MOVE TRANFILE-STATUS TO IO-STATUS\n               PERFORM Z-DISPLAY-IO-STATUS\n               PERFORM Z-ABEND-PROGRAM\n           END-IF\n           EXIT.\n\n       Z-ABEND-PROGRAM.\n           DISPLAY 'ABENDING PROGRAM'\n           MOVE 0 TO TIMING\n           MOVE 999 TO ABCODE\n           CALL 'CEE3ABD'.\n\n      *****************************************************************\n       Z-DISPLAY-IO-STATUS.\n           IF  IO-STATUS NOT NUMERIC\n           OR  IO-STAT1 = '9'\n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)\n               MOVE 0        TO TWO-BYTES-BINARY\n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT\n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04\n           ELSE\n               MOVE '0000' TO IO-STATUS-04\n               MOVE IO-STATUS TO IO-STATUS-04(3:2)\n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04\n           END-IF\n           EXIT.\n\n\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVTRA06Y",
        "CVACT02Y",
        "CVCUS01Y",
        "CVTRA05Y",
        "CVACT01Y",
        "CVACT03Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as MAIN-PARA\n    participant DailyTran as Daily Transaction File\n    participant XRef as Cross-Reference File\n    participant Acct as Account File\n    participant Cust as Customer File\n    participant Card as Card File\n    participant Tran as Transaction File\n    \n    Main->>DailyTran: 0000-DALYTRAN-OPEN\n    Main->>Cust: 0100-CUSTFILE-OPEN\n    Main->>XRef: 0200-XREFFILE-OPEN\n    Main->>Card: 0300-CARDFILE-OPEN\n    Main->>Acct: 0400-ACCTFILE-OPEN\n    Main->>Tran: 0500-TRANFILE-OPEN\n    \n    rect rgb(240, 240, 240)\n        Note over Main,Acct: Process transactions until end of file\n        loop Until END-OF-DAILY-TRANS-FILE = 'Y'\n            Main->>DailyTran: 1000-DALYTRAN-GET-NEXT\n            alt Record read successfully\n                DailyTran-->>Main: Return transaction record\n                Main->>Main: Display transaction record\n                \n                Main->>XRef: 2000-LOOKUP-XREF (using card number)\n                alt Card number found\n                    XRef-->>Main: Return XREF record (account ID, customer ID)\n                    Main->>Acct: 3000-READ-ACCOUNT (using account ID)\n                    alt Account found\n                        Acct-->>Main: Return account record\n                    else Account not found\n                        Main->>Main: Display \"ACCOUNT NOT FOUND\"\n                    end\n                else Card number not found\n                    Main->>Main: Display \"CARD NUMBER COULD NOT BE VERIFIED\"\n                end\n            else End of file reached\n                DailyTran-->>Main: EOF signal\n                Main->>Main: Set END-OF-DAILY-TRANS-FILE = 'Y'\n            else Error reading file\n                Main->>Main: Z-DISPLAY-IO-STATUS\n                Main->>Main: Z-ABEND-PROGRAM\n            end\n        end\n    end\n    \n    Main->>DailyTran: 9000-DALYTRAN-CLOSE\n    Main->>Cust: 9100-CUSTFILE-CLOSE\n    Main->>XRef: 9200-XREFFILE-CLOSE\n    Main->>Card: 9300-CARDFILE-CLOSE\n    Main->>Acct: 9400-ACCTFILE-CLOSE\n    Main->>Tran: 9500-TRANFILE-CLOSE"
    },
    {
      "id": "COTRN01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration settings for the COTRN01C transaction viewer program, including file assignments, special names, and system dependencies. In the CardDemo application context, it would define how the program interfaces with the TRANSACT file and CICS environment resources. The configuration section would establish the necessary parameters for the program to properly access and display transaction records within the AWS-showcased mainframe environment."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT01'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n\n       COPY COCOM01Y.\n          05 CDEMO-CT01-INFO.\n             10 CDEMO-CT01-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT01-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT01-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT01-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT01-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT01-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working Storage Section defines the key variables and data structures used in the transaction viewer program. It includes program identifiers, error handling flags, and transaction-specific fields like amount and date. The section incorporates several copybooks that likely contain shared data definitions for transaction records (COTRN01), common application data (COCOM01Y), screen layouts (CVTRA05Y), and utility functions for titles (COTTL01Y), dates (CSDAT01Y), and messages (CSMSG01Y). Notable elements include transaction tracking variables in CDEMO-CT01-INFO for managing navigation between multiple transaction records, and standard CICS copybooks (DFHAID, DFHBMSCA) for handling attention identifiers and BMS screen attributes. The structure supports the program's core functionality of retrieving and displaying transaction details in the CICS environment."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the DFHCOMMAREA structure in the Linkage Section, which is used to receive and pass data between CICS programs. It contains a single field LK-COMMAREA that is defined as a variable-length array of characters with a size that depends on the EIBCALEN value (the length of the passed communication area). This flexible structure allows the program to handle communication areas of different sizes when called by other programs in the CardDemo transaction viewing system."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT01'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n\n       COPY COCOM01Y.\n          05 CDEMO-CT01-INFO.\n             10 CDEMO-CT01-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT01-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT01-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT01-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT01-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT01-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN1AO\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   IF CDEMO-CT01-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CT01-TRN-SELECTED TO\n                            TRNIDINI OF COTRN1AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-TRNVIEW-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNVIEW-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           MOVE 'COTRN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNVIEW-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the transaction viewer screen. It initializes error flags, processes the COMMAREA data, and handles different user interactions. When first entered, it prepares the screen for display, potentially pre-populating the transaction ID field if one was selected from a previous screen. For subsequent interactions, it evaluates function key inputs to either process an entered transaction ID (Enter key), return to the previous screen (PF3), clear the current screen (PF4), or navigate to the transaction list screen (PF5). The paragraph includes error handling for invalid key presses and ensures proper screen navigation within the application flow. After processing, it returns control to CICS while preserving the application state in the COMMAREA."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EVALUATE TRUE\n               WHEN TRNIDINI OF COTRN1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO TRNIDI   OF COTRN1AI\n                                   CARDNUMI OF COTRN1AI\n                                   TTYPCDI  OF COTRN1AI\n                                   TCATCDI  OF COTRN1AI\n                                   TRNSRCI  OF COTRN1AI\n                                   TRNAMTI  OF COTRN1AI\n                                   TDESCI   OF COTRN1AI\n                                   TORIGDTI OF COTRN1AI\n                                   TPROCDTI OF COTRN1AI\n                                   MIDI     OF COTRN1AI\n                                   MNAMEI   OF COTRN1AI\n                                   MCITYI   OF COTRN1AI\n                                   MZIPI    OF COTRN1AI\n               MOVE TRNIDINI  OF COTRN1AI TO TRAN-ID\n               PERFORM READ-TRANSACT-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE TRAN-AMT TO WS-TRAN-AMT\n               MOVE TRAN-ID      TO TRNIDI    OF COTRN1AI\n               MOVE TRAN-CARD-NUM      TO CARDNUMI    OF COTRN1AI\n               MOVE TRAN-TYPE-CD        TO TTYPCDI   OF COTRN1AI\n               MOVE TRAN-CAT-CD        TO TCATCDI   OF COTRN1AI\n               MOVE TRAN-SOURCE       TO TRNSRCI  OF COTRN1AI\n               MOVE WS-TRAN-AMT      TO TRNAMTI    OF COTRN1AI\n               MOVE TRAN-DESC      TO TDESCI    OF COTRN1AI\n               MOVE TRAN-ORIG-TS        TO TORIGDTI   OF COTRN1AI\n               MOVE TRAN-PROC-TS       TO TPROCDTI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-ID       TO MIDI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-NAME       TO MNAMEI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-CITY       TO MCITYI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-ZIP       TO MZIPI  OF COTRN1AI\n               PERFORM SEND-TRNVIEW-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the processing logic when a user presses the Enter key in the transaction viewer screen. It first validates if the transaction ID input field is empty, displaying an error message if so. If the input is valid, it clears all display fields, reads the transaction record using the entered ID, and then populates the screen with the retrieved transaction details including card number, transaction type, category, amount, description, timestamps, and merchant information. The paragraph formats the transaction amount for display and ensures the updated screen is sent back to the user. If any errors occur during processing (such as record not found), the error flag would prevent the display fields from being populated."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNVIEW-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the return navigation functionality when a user wants to exit the current transaction viewer screen. It first checks if the target program is specified in the communication area, and if not, defaults to 'COSGN00C' (likely the main menu or sign-on screen). It then prepares the communication area by setting the originating transaction ID and program name, and resets the program context to zeros. Finally, it transfers control to the target program using the CICS XCTL command, passing the communication area to maintain session context. This ensures proper navigation flow within the CardDemo application."
          },
          {
            "name": "SEND-TRNVIEW-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN1AO\n\n           EXEC CICS SEND\n                     MAP('COTRN1A')\n                     MAPSET('COTRN01')\n                     FROM(COTRN1AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNVIEW-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the display of the transaction viewer screen. It first calls the POPULATE-HEADER-INFO paragraph to set up the header information, then moves any system message to the error message field on the screen. It then uses the CICS SEND command to display the COTRN1A map from the COTRN01 mapset, clearing the screen (ERASE) and positioning the cursor. This is a standard screen display routine that presents the transaction details to the user after the data has been retrieved and formatted."
          },
          {
            "name": "RECEIVE-TRNVIEW-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COTRN1A')\n                     MAPSET('COTRN01')\n                     INTO(COTRN1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the reception of user input from the COTRN1A map within the COTRN01 mapset in the transaction viewer. It uses the CICS RECEIVE command to capture data entered by the user on the transaction view screen, storing the input in the COTRN1AI structure. The paragraph also captures response codes in WS-RESP-CD and WS-REAS-CD variables for subsequent error handling. This is a standard CICS input processing step that occurs before the application processes the user's transaction viewing request."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN1AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-TRANSACT-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the transaction viewer screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information along with application titles, transaction ID, and program name on the screen. The date is formatted as MM/DD/YY and the time as HH:MM:SS before being moved to their respective output fields on the COTRN1AO screen."
          },
          {
            "name": "READ-TRANSACT-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a CICS READ operation to retrieve a transaction record from the TRANSACT file using the transaction ID as the key. It handles three possible response scenarios: 1) When the read is successful (NORMAL), processing continues to the next step; 2) When the transaction ID is not found (NOTFND), it sets an error flag, displays a \"Transaction ID NOT found\" message, positions the cursor at the transaction ID input field, and redisplays the transaction view screen; 3) For any other response code, it logs the response and reason codes, sets an error flag, displays an \"Unable to lookup Transaction\" message, positions the cursor at the transaction ID input field, and redisplays the screen. The paragraph is essential for retrieving transaction details requested by the user in the CardDemo transaction viewer application."
          },
          {
            "name": "CLEAR-CURRENT-SCREEN",
            "code": "PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-TRNVIEW-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the current screen by first initializing all fields to their default values and then redisplaying the transaction viewer screen. It provides a way for users to reset the form when they press the designated clear key (PF4)."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO TRNIDINL OF COTRN1AI\n           MOVE SPACES          TO TRNIDINI OF COTRN1AI\n                                   TRNIDI   OF COTRN1AI\n                                   CARDNUMI OF COTRN1AI\n                                   TTYPCDI  OF COTRN1AI\n                                   TCATCDI  OF COTRN1AI\n                                   TRNSRCI  OF COTRN1AI\n                                   TRNAMTI  OF COTRN1AI\n                                   TDESCI   OF COTRN1AI\n                                   TORIGDTI OF COTRN1AI\n                                   TPROCDTI OF COTRN1AI\n                                   MIDI     OF COTRN1AI\n                                   MNAMEI   OF COTRN1AI\n                                   MCITYI   OF COTRN1AI\n                                   MZIPI    OF COTRN1AI",
            "description": "This paragraph initializes all fields in the transaction viewer screen. It sets the cursor position to the transaction ID input field by setting its length attribute to -1, and then clears all display fields by moving spaces to them. The fields being cleared include transaction details (ID, card number, type code, category code, source, amount, description, original date, processing date) and merchant information (ID, name, city, ZIP code). This initialization is typically performed when the screen is first displayed or when preparing for new input."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *",
            "description": "This paragraph contains version control information for the CardDemo application, showing the specific version (v1.0-15-g27d6c6f-68) and the timestamp when this code was last updated (July 19, 2022 at 23:12:34 CDT). This information helps track which version of the code is deployed and when changes were made."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN1AO\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   IF CDEMO-CT01-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CT01-TRN-SELECTED TO\n                            TRNIDINI OF COTRN1AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-TRNVIEW-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNVIEW-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           MOVE 'COTRN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNVIEW-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN TRNIDINI OF COTRN1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO TRNIDI   OF COTRN1AI\n                                   CARDNUMI OF COTRN1AI\n                                   TTYPCDI  OF COTRN1AI\n                                   TCATCDI  OF COTRN1AI\n                                   TRNSRCI  OF COTRN1AI\n                                   TRNAMTI  OF COTRN1AI\n                                   TDESCI   OF COTRN1AI\n                                   TORIGDTI OF COTRN1AI\n                                   TPROCDTI OF COTRN1AI\n                                   MIDI     OF COTRN1AI\n                                   MNAMEI   OF COTRN1AI\n                                   MCITYI   OF COTRN1AI\n                                   MZIPI    OF COTRN1AI\n               MOVE TRNIDINI  OF COTRN1AI TO TRAN-ID\n               PERFORM READ-TRANSACT-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE TRAN-AMT TO WS-TRAN-AMT\n               MOVE TRAN-ID      TO TRNIDI    OF COTRN1AI\n               MOVE TRAN-CARD-NUM      TO CARDNUMI    OF COTRN1AI\n               MOVE TRAN-TYPE-CD        TO TTYPCDI   OF COTRN1AI\n               MOVE TRAN-CAT-CD        TO TCATCDI   OF COTRN1AI\n               MOVE TRAN-SOURCE       TO TRNSRCI  OF COTRN1AI\n               MOVE WS-TRAN-AMT      TO TRNAMTI    OF COTRN1AI\n               MOVE TRAN-DESC      TO TDESCI    OF COTRN1AI\n               MOVE TRAN-ORIG-TS        TO TORIGDTI   OF COTRN1AI\n               MOVE TRAN-PROC-TS       TO TPROCDTI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-ID       TO MIDI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-NAME       TO MNAMEI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-CITY       TO MCITYI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-ZIP       TO MZIPI  OF COTRN1AI\n               PERFORM SEND-TRNVIEW-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNVIEW-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNVIEW-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN1AO\n\n           EXEC CICS SEND\n                     MAP('COTRN1A')\n                     MAPSET('COTRN01')\n                     FROM(COTRN1AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNVIEW-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNVIEW-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COTRN1A')\n                     MAPSET('COTRN01')\n                     INTO(COTRN1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN1AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READ-TRANSACT-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-TRNVIEW-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO TRNIDINL OF COTRN1AI\n           MOVE SPACES          TO TRNIDINI OF COTRN1AI\n                                   TRNIDI   OF COTRN1AI\n                                   CARDNUMI OF COTRN1AI\n                                   TTYPCDI  OF COTRN1AI\n                                   TCATCDI  OF COTRN1AI\n                                   TRNSRCI  OF COTRN1AI\n                                   TRNAMTI  OF COTRN1AI\n                                   TDESCI   OF COTRN1AI\n                                   TORIGDTI OF COTRN1AI\n                                   TPROCDTI OF COTRN1AI\n                                   MIDI     OF COTRN1AI\n                                   MNAMEI   OF COTRN1AI\n                                   MCITYI   OF COTRN1AI\n                                   MZIPI    OF COTRN1AI\n                                   WS-MESSAGE.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *"
      },
      "description": "This program is part of the CardDemo application and serves as a transaction viewer for the TRANSACT file in a CICS environment. It allows users to view detailed transaction information by entering a transaction ID. The program retrieves the corresponding transaction record from the TRANSACT file and displays various transaction details including card number, transaction type, category, amount, description, timestamps, and merchant information. The interface provides navigation options to return to previous screens (PF3), clear the current screen (PF4), or access the transaction list screen (PF5). Error handling is implemented for cases such as empty transaction ID input or when a transaction record cannot be found.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COTRN01C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : View a Transaction from TRANSACT file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COTRN01C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COTRN01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CT01'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n         05 WS-TRAN-AMT                PIC +99999999.99.\n         05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.\n\n       COPY COCOM01Y.\n          05 CDEMO-CT01-INFO.\n             10 CDEMO-CT01-TRNID-FIRST     PIC X(16).\n             10 CDEMO-CT01-TRNID-LAST      PIC X(16).\n             10 CDEMO-CT01-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CT01-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CT01-TRN-SEL-FLG     PIC X(01).\n             10 CDEMO-CT01-TRN-SELECTED    PIC X(16).\n\n       COPY COTRN01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n\n       COPY CVTRA05Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COTRN1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COTRN1AO\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   IF CDEMO-CT01-TRN-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CT01-TRN-SELECTED TO\n                            TRNIDINI OF COTRN1AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-TRNVIEW-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNVIEW-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           MOVE 'COTRN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNVIEW-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN TRNIDINI OF COTRN1AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Tran ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO TRNIDI   OF COTRN1AI\n                                   CARDNUMI OF COTRN1AI\n                                   TTYPCDI  OF COTRN1AI\n                                   TCATCDI  OF COTRN1AI\n                                   TRNSRCI  OF COTRN1AI\n                                   TRNAMTI  OF COTRN1AI\n                                   TDESCI   OF COTRN1AI\n                                   TORIGDTI OF COTRN1AI\n                                   TPROCDTI OF COTRN1AI\n                                   MIDI     OF COTRN1AI\n                                   MNAMEI   OF COTRN1AI\n                                   MCITYI   OF COTRN1AI\n                                   MZIPI    OF COTRN1AI\n               MOVE TRNIDINI  OF COTRN1AI TO TRAN-ID\n               PERFORM READ-TRANSACT-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE TRAN-AMT TO WS-TRAN-AMT\n               MOVE TRAN-ID      TO TRNIDI    OF COTRN1AI\n               MOVE TRAN-CARD-NUM      TO CARDNUMI    OF COTRN1AI\n               MOVE TRAN-TYPE-CD        TO TTYPCDI   OF COTRN1AI\n               MOVE TRAN-CAT-CD        TO TCATCDI   OF COTRN1AI\n               MOVE TRAN-SOURCE       TO TRNSRCI  OF COTRN1AI\n               MOVE WS-TRAN-AMT      TO TRNAMTI    OF COTRN1AI\n               MOVE TRAN-DESC      TO TDESCI    OF COTRN1AI\n               MOVE TRAN-ORIG-TS        TO TORIGDTI   OF COTRN1AI\n               MOVE TRAN-PROC-TS       TO TPROCDTI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-ID       TO MIDI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-NAME       TO MNAMEI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-CITY       TO MCITYI  OF COTRN1AI\n               MOVE TRAN-MERCHANT-ZIP       TO MZIPI  OF COTRN1AI\n               PERFORM SEND-TRNVIEW-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-TRNVIEW-SCREEN\n      *----------------------------------------------------------------*\n       SEND-TRNVIEW-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COTRN1AO\n\n           EXEC CICS SEND\n                     MAP('COTRN1A')\n                     MAPSET('COTRN01')\n                     FROM(COTRN1AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-TRNVIEW-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-TRNVIEW-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COTRN1A')\n                     MAPSET('COTRN01')\n                     INTO(COTRN1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COTRN1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COTRN1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COTRN1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COTRN1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COTRN1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COTRN1AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-TRANSACT-FILE\n      *----------------------------------------------------------------*\n       READ-TRANSACT-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-TRANSACT-FILE)\n                INTO      (TRAN-RECORD)\n                LENGTH    (LENGTH OF TRAN-RECORD)\n                RIDFLD    (TRAN-ID)\n                KEYLENGTH (LENGTH OF TRAN-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Transaction ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup Transaction...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO TRNIDINL OF COTRN1AI\n                   PERFORM SEND-TRNVIEW-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-TRNVIEW-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO TRNIDINL OF COTRN1AI\n           MOVE SPACES          TO TRNIDINI OF COTRN1AI\n                                   TRNIDI   OF COTRN1AI\n                                   CARDNUMI OF COTRN1AI\n                                   TTYPCDI  OF COTRN1AI\n                                   TCATCDI  OF COTRN1AI\n                                   TRNSRCI  OF COTRN1AI\n                                   TRNAMTI  OF COTRN1AI\n                                   TDESCI   OF COTRN1AI\n                                   TORIGDTI OF COTRN1AI\n                                   TPROCDTI OF COTRN1AI\n                                   MIDI     OF COTRN1AI\n                                   MNAMEI   OF COTRN1AI\n                                   MCITYI   OF COTRN1AI\n                                   MZIPI    OF COTRN1AI\n                                   WS-MESSAGE.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVTRA05Y",
        "COTTL01Y",
        "DFHAID",
        "COTRN01"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant CICS\n    participant MAIN_PARA as MAIN-PARA\n    participant PROCESS_ENTER as PROCESS-ENTER-KEY\n    participant READ_TRANSACT as READ-TRANSACT-FILE\n    participant SEND_SCREEN as SEND-TRNVIEW-SCREEN\n    participant RECEIVE_SCREEN as RECEIVE-TRNVIEW-SCREEN\n    participant RETURN_SCREEN as RETURN-TO-PREV-SCREEN\n    participant CLEAR_SCREEN as CLEAR-CURRENT-SCREEN\n    participant INIT_FIELDS as INITIALIZE-ALL-FIELDS\n    participant HEADER_INFO as POPULATE-HEADER-INFO\n    participant TRANSACT_FILE as \"TRANSACT File\"\n\n    User->>CICS: Start COTRN01C transaction\n    CICS->>MAIN_PARA: Execute program\n    \n    alt First time entry (EIBCALEN = 0)\n        MAIN_PARA->>RETURN_SCREEN: Return to sign-on screen\n        RETURN_SCREEN->>CICS: XCTL to COSGN00C\n    else Program has COMMAREA\n        alt Not program re-entry\n            MAIN_PARA->>MAIN_PARA: Initialize screen\n            \n            opt Transaction ID provided from previous screen\n                MAIN_PARA->>PROCESS_ENTER: Process transaction ID\n                PROCESS_ENTER->>READ_TRANSACT: Read transaction record\n                READ_TRANSACT->>TRANSACT_FILE: READ using TRAN-ID\n                \n                alt Record found\n                    TRANSACT_FILE-->>READ_TRANSACT: Return transaction data\n                    READ_TRANSACT-->>PROCESS_ENTER: Continue processing\n                    PROCESS_ENTER->>PROCESS_ENTER: Format transaction data\n                else Record not found\n                    TRANSACT_FILE-->>READ_TRANSACT: NOTFND response\n                    READ_TRANSACT->>READ_TRANSACT: Set error message\n                else Other error\n                    TRANSACT_FILE-->>READ_TRANSACT: Error response\n                    READ_TRANSACT->>READ_TRANSACT: Set error message\n                end\n            end\n            \n            MAIN_PARA->>SEND_SCREEN: Display transaction view screen\n            SEND_SCREEN->>HEADER_INFO: Populate header information\n            HEADER_INFO-->>SEND_SCREEN: Return with header populated\n            SEND_SCREEN->>CICS: SEND MAP COTRN1A\n            CICS-->>User: Display transaction view screen\n        else Program re-entry\n            MAIN_PARA->>RECEIVE_SCREEN: Get user input\n            RECEIVE_SCREEN->>CICS: RECEIVE MAP COTRN1A\n            CICS-->>RECEIVE_SCREEN: Return user input\n            \n            alt User pressed ENTER\n                MAIN_PARA->>PROCESS_ENTER: Process transaction ID\n                \n                alt Transaction ID is empty\n                    PROCESS_ENTER->>PROCESS_ENTER: Set error message\n                    PROCESS_ENTER->>SEND_SCREEN: Redisplay screen with error\n                else Transaction ID provided\n                    PROCESS_ENTER->>READ_TRANSACT: Read transaction record\n                    READ_TRANSACT->>TRANSACT_FILE: READ using TRAN-ID\n                    \n                    alt Record found\n                        TRANSACT_FILE-->>READ_TRANSACT: Return transaction data\n                        READ_TRANSACT-->>PROCESS_ENTER: Continue processing\n                        PROCESS_ENTER->>PROCESS_ENTER: Format transaction data\n                    else Record not found\n                        TRANSACT_FILE-->>READ_TRANSACT: NOTFND response\n                        READ_TRANSACT->>READ_TRANSACT: Set error message\n                    else Other error\n                        TRANSACT_FILE-->>READ_TRANSACT: Error response\n                        READ_TRANSACT->>READ_TRANSACT: Set error message\n                    end\n                    \n                    PROCESS_ENTER->>SEND_SCREEN: Display transaction details\n                end\n                \n            else User pressed PF3\n                MAIN_PARA->>RETURN_SCREEN: Return to previous screen\n                RETURN_SCREEN->>CICS: XCTL to previous program\n                CICS-->>User: Display previous screen\n            else User pressed PF4\n                MAIN_PARA->>CLEAR_SCREEN: Clear current screen\n                CLEAR_SCREEN->>INIT_FIELDS: Initialize all fields\n                INIT_FIELDS-->>CLEAR_SCREEN: Fields initialized\n                CLEAR_SCREEN->>SEND_SCREEN: Redisplay empty screen\n                SEND_SCREEN->>CICS: SEND MAP COTRN1A\n                CICS-->>User: Display empty transaction view screen\n            else User pressed PF5\n                MAIN_PARA->>RETURN_SCREEN: Go to transaction list screen\n                RETURN_SCREEN->>CICS: XCTL to COTRN00C\n                CICS-->>User: Display transaction list screen\n            else Invalid key\n                MAIN_PARA->>MAIN_PARA: Set invalid key message\n                MAIN_PARA->>SEND_SCREEN: Redisplay screen with error\n                SEND_SCREEN->>CICS: SEND MAP COTRN1A\n                CICS-->>User: Display screen with error message\n            end\n        end\n    end\n    \n    MAIN_PARA->>CICS: RETURN with COMMAREA"
    },
    {
      "id": "COUSR02C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration details for the COUSR02C program, including file assignments, special names, and system dependencies. However, the provided snippet is empty, indicating that either the Configuration Section is not used in this program or the configuration details are defined elsewhere, possibly in a separate copybook or through CICS resource definitions. For a user profile management program like COUSR02C, configuration would normally include specifications for the USRSEC file and any other resources needed for user data processing."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR02C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU02'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n       COPY COCOM01Y.\n          05 CDEMO-CU02-INFO.\n             10 CDEMO-CU02-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU02-USRID-LAST      PIC X(08).\n             10 CDEMO-CU02-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU02-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU02-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU02-USR-SELECTED    PIC X(08).\n\n       COPY COUSR02.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working-Storage section defines the key variables and data structures used in the COUSR02C user profile update program. It includes program identifiers, status flags for error handling and modification tracking, and response codes. The section incorporates several copybooks that likely contain screen layouts, common data structures, and message definitions. Notable elements include the user modification flag (WS-USR-MODIFIED) to track when changes have been made to user records, error handling flags (WS-ERR-FLG), and program control information. The CDEMO-CU02-INFO structure appears to store user selection and pagination data for navigating through user records. Standard CICS copybooks (DFHAID and DFHBMSCA) are included to support the program's CICS interface functionality."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This linkage section defines the communication area (DFHCOMMAREA) used for passing data between CICS programs. It contains a single field, LK-COMMAREA, which is defined as a variable-length array of single-character elements that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive and process communication data of varying sizes from calling programs within the CardDemo application's user profile management functionality."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR02C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU02'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n       COPY COCOM01Y.\n          05 CDEMO-CU02-INFO.\n             10 CDEMO-CU02-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU02-USRID-LAST      PIC X(08).\n             10 CDEMO-CU02-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU02-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU02-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU02-USR-SELECTED    PIC X(08).\n\n       COPY COUSR02.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR2AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR2AO\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   IF CDEMO-CU02-USR-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CU02-USR-SELECTED TO\n                            USRIDINI OF COUSR2AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-USRUPD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRUPD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           PERFORM UPDATE-USER-INFO\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM UPDATE-USER-INFO\n                       WHEN DFHPF12\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRUPD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the user profile update functionality. It initializes error flags, handles first-time entry versus re-entry to the program, and processes different function key inputs. When first entering, it prepares the update screen and can pre-populate the user ID field if a selection was made from a previous screen. On subsequent interactions, it evaluates the user's action based on the function key pressed: Enter to process input, PF3 to update and return to the previous screen, PF4 to clear the current screen, PF5 to update user information, and PF12 to return to the admin menu. The paragraph includes error handling for invalid key presses and manages the program flow through the CICS transaction system using the commarea for data persistence between screen interactions."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EVALUATE TRUE\n               WHEN USRIDINI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO FNAMEI   OF COUSR2AI\n                                   LNAMEI   OF COUSR2AI\n                                   PASSWDI  OF COUSR2AI\n                                   USRTYPEI OF COUSR2AI\n               MOVE USRIDINI  OF COUSR2AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE SEC-USR-FNAME      TO FNAMEI    OF COUSR2AI\n               MOVE SEC-USR-LNAME      TO LNAMEI    OF COUSR2AI\n               MOVE SEC-USR-PWD        TO PASSWDI   OF COUSR2AI\n               MOVE SEC-USR-TYPE       TO USRTYPEI  OF COUSR2AI\n               PERFORM SEND-USRUPD-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-USER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the processing when the ENTER key is pressed during user profile updates. It first validates that the User ID field is not empty, displaying an error message and repositioning the cursor if validation fails. If the User ID is valid, it clears the other input fields (first name, last name, password, and user type) and attempts to read the corresponding user record from the security file using the provided User ID. When the record is successfully retrieved, the paragraph populates the screen fields with the existing user information and redisplays the screen for editing. This enables administrators to see the current user data before making modifications."
          },
          {
            "name": "UPDATE-USER-INFO",
            "code": "EVALUATE TRUE\n               WHEN USRIDINI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN FNAMEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'First Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN LNAMEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Last Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO LNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN PASSWDI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Password can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN USRTYPEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User Type can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRTYPEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USRIDINI  OF COUSR2AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n\n               IF FNAMEI  OF COUSR2AI NOT = SEC-USR-FNAME\n                   MOVE FNAMEI   OF COUSR2AI TO SEC-USR-FNAME\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF LNAMEI  OF COUSR2AI NOT = SEC-USR-LNAME\n                   MOVE LNAMEI   OF COUSR2AI TO SEC-USR-LNAME\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF PASSWDI  OF COUSR2AI NOT = SEC-USR-PWD\n                   MOVE PASSWDI  OF COUSR2AI TO SEC-USR-PWD\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF USRTYPEI  OF COUSR2AI NOT = SEC-USR-TYPE\n                   MOVE USRTYPEI OF COUSR2AI TO SEC-USR-TYPE\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n\n               IF USR-MODIFIED-YES\n                   PERFORM UPDATE-USER-SEC-FILE\n               ELSE\n                   MOVE 'Please modify to update ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHRED       TO ERRMSGC  OF COUSR2AO\n                   PERFORM SEND-USRUPD-SCREEN\n               END-IF\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph validates and processes user profile updates in the CardDemo application. It first performs a series of validation checks to ensure all required fields (User ID, First Name, Last Name, Password, and User Type) are not empty, displaying appropriate error messages and repositioning the cursor when validation fails. If all validations pass, it reads the existing user record from the security file and compares each field with the input values to identify changes. The code tracks modifications by setting a flag (USR-MODIFIED-YES) whenever a field value differs from the stored record. If any changes are detected, it calls the UPDATE-USER-SEC-FILE paragraph to save the modifications; otherwise, it prompts the user to make changes before updating. The paragraph includes error handling through the WS-ERR-FLG variable and provides clear feedback messages to guide the administrator through the update process."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRUPD-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the navigation logic for returning to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, defaulting to 'COSGN00C' (likely the sign-on screen) if no value is provided. It then populates the communication area with the current transaction ID and program name as the source of the transfer, resets the program context to zeros, and executes a CICS XCTL command to transfer control to the target program while passing the communication area. This provides a consistent navigation mechanism throughout the application."
          },
          {
            "name": "SEND-USRUPD-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR2AO\n\n           EXEC CICS SEND\n                     MAP('COUSR2A')\n                     MAPSET('COUSR02')\n                     FROM(COUSR2AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRUPD-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph displays the user profile update screen to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up standard header information, then transfers any system messages from the working storage variable WS-MESSAGE to the error message field on the screen. It then uses the CICS SEND command to display the COUSR2A map from the COUSR02 mapset, clearing the screen (ERASE) and positioning the cursor appropriately. This is a standard screen display routine that presents the user interface for updating user profile information."
          },
          {
            "name": "RECEIVE-USRUPD-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COUSR2A')\n                     MAPSET('COUSR02')\n                     INTO(COUSR2AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the COUSR2A map within the COUSR02 mapset, storing the captured data in the COUSR2AI structure. It captures response codes in WS-RESP-CD and WS-REAS-CD variables for error handling. This is a standard CICS RECEIVE operation that collects the data entered by administrators when updating user profile information in the CardDemo application."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR2AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR2AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR2AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR2AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR2AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR2AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information on the COUSR2A screen. It retrieves the current date and time using the CURRENT-DATE function, then formats and displays this information along with application titles, transaction ID, and program name in the screen header. The date is formatted as MM/DD/YY and the time as HH:MM:SS for display purposes. This standard header provides users with context about which program they're using and when the transaction is occurring."
          },
          {
            "name": "READ-USER-SEC-FILE",
            "code": "EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n                   MOVE 'Press PF5 key to save your updates ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHNEUTR       TO ERRMSGC  OF COUSR2AO\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph retrieves a user record from the USRSEC file for update purposes. It performs a CICS READ operation with UPDATE option using the user ID as the key. The paragraph handles three possible outcomes: 1) successful retrieval, which displays a prompt to press PF5 to save updates and shows the user data on screen, 2) record not found, which displays an error message and positions the cursor at the user ID field, or 3) other errors, which logs the response/reason codes and displays a generic error message. This is a critical component of the user profile update functionality, as it retrieves the existing user record that will be modified by the administrator."
          },
          {
            "name": "UPDATE-USER-SEC-FILE",
            "code": "EXEC CICS REWRITE\n                DATASET   (WS-USRSEC-FILE)\n                FROM      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR2AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been updated ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the update operation for user security records in the USRSEC file. It attempts to rewrite the modified user record and processes the response from CICS. When successful, it displays a confirmation message with the user ID that was updated. If the user record is not found, it sets an error flag, positions the cursor at the user ID field, and displays an appropriate error message. For any other errors, it logs the response and reason codes, sets an error flag, positions the cursor at the first name field, and displays a generic error message. In all cases, it calls the SEND-USRUPD-SCREEN paragraph to redisplay the screen with the appropriate message."
          },
          {
            "name": "CLEAR-CURRENT-SCREEN",
            "code": "PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRUPD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the current user update screen by first initializing all input fields to their default values through the INITIALIZE-ALL-FIELDS paragraph, and then redisplaying the empty user update screen via the SEND-USRUPD-SCREEN paragraph. This functionality allows users to reset the form when editing user profile information."
          },
          {
            "name": "INITIALIZE-ALL-FIELDS",
            "code": "MOVE -1              TO USRIDINL OF COUSR2AI\n           MOVE SPACES          TO USRIDINI OF COUSR2AI\n                                   FNAMEI   OF COUSR2AI\n                                   LNAMEI   OF COUSR2AI\n                                   PASSWDI  OF COUSR2AI\n                                   USRTYPEI OF COUSR2AI",
            "description": "This paragraph initializes the input fields on the user profile update screen. It sets the cursor position to the user ID field by assigning -1 to USRIDINL, and clears all data entry fields (user ID, first name, last name, password, and user type) by setting them to spaces. This is typically executed when the screen is first displayed or when the clear function is activated, ensuring the form starts in a clean state for user input."
          },
          {
            "name": "WS-MESSAGE",
            "code": "*\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *",
            "description": "This paragraph contains version control information for the COUSR02C program, indicating it is part of the CardDemo application version 1.0-15-g27d6c6f-68, with a timestamp of July 19, 2022, at 23:12:34 CDT. This information helps track which version of the code is deployed and when it was last updated."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR2AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR2AO\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   IF CDEMO-CU02-USR-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CU02-USR-SELECTED TO\n                            USRIDINI OF COUSR2AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-USRUPD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRUPD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           PERFORM UPDATE-USER-INFO\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM UPDATE-USER-INFO\n                       WHEN DFHPF12\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRUPD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO FNAMEI   OF COUSR2AI\n                                   LNAMEI   OF COUSR2AI\n                                   PASSWDI  OF COUSR2AI\n                                   USRTYPEI OF COUSR2AI\n               MOVE USRIDINI  OF COUSR2AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE SEC-USR-FNAME      TO FNAMEI    OF COUSR2AI\n               MOVE SEC-USR-LNAME      TO LNAMEI    OF COUSR2AI\n               MOVE SEC-USR-PWD        TO PASSWDI   OF COUSR2AI\n               MOVE SEC-USR-TYPE       TO USRTYPEI  OF COUSR2AI\n               PERFORM SEND-USRUPD-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-USER-INFO\n      *----------------------------------------------------------------*\n       UPDATE-USER-INFO.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN FNAMEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'First Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN LNAMEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Last Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO LNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN PASSWDI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Password can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN USRTYPEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User Type can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRTYPEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USRIDINI  OF COUSR2AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n\n               IF FNAMEI  OF COUSR2AI NOT = SEC-USR-FNAME\n                   MOVE FNAMEI   OF COUSR2AI TO SEC-USR-FNAME\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF LNAMEI  OF COUSR2AI NOT = SEC-USR-LNAME\n                   MOVE LNAMEI   OF COUSR2AI TO SEC-USR-LNAME\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF PASSWDI  OF COUSR2AI NOT = SEC-USR-PWD\n                   MOVE PASSWDI  OF COUSR2AI TO SEC-USR-PWD\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF USRTYPEI  OF COUSR2AI NOT = SEC-USR-TYPE\n                   MOVE USRTYPEI OF COUSR2AI TO SEC-USR-TYPE\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n\n               IF USR-MODIFIED-YES\n                   PERFORM UPDATE-USER-SEC-FILE\n               ELSE\n                   MOVE 'Please modify to update ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHRED       TO ERRMSGC  OF COUSR2AO\n                   PERFORM SEND-USRUPD-SCREEN\n               END-IF\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRUPD-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRUPD-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR2AO\n\n           EXEC CICS SEND\n                     MAP('COUSR2A')\n                     MAPSET('COUSR02')\n                     FROM(COUSR2AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRUPD-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRUPD-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR2A')\n                     MAPSET('COUSR02')\n                     INTO(COUSR2AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR2AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR2AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR2AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR2AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR2AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR2AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READ-USER-SEC-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n                   MOVE 'Press PF5 key to save your updates ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHNEUTR       TO ERRMSGC  OF COUSR2AO\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       UPDATE-USER-SEC-FILE.\n\n           EXEC CICS REWRITE\n                DATASET   (WS-USRSEC-FILE)\n                FROM      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR2AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been updated ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRUPD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO USRIDINL OF COUSR2AI\n           MOVE SPACES          TO USRIDINI OF COUSR2AI\n                                   FNAMEI   OF COUSR2AI\n                                   LNAMEI   OF COUSR2AI\n                                   PASSWDI  OF COUSR2AI\n                                   USRTYPEI OF COUSR2AI\n                                   WS-MESSAGE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *"
      },
      "description": "This CICS COBOL program (COUSR02C) manages user profile updates in the CardDemo application. It allows administrators to modify existing user information in the USRSEC file. The program retrieves user records based on user ID input, displays the current information for editing, validates the modified data, and updates the user record when changes are made. The program includes field validation to ensure required information (user ID, first name, last name, password, and user type) is provided before updates are processed. It features navigation capabilities to return to previous screens and clear functionality to reset input fields. Error handling is implemented for various scenarios including record not found conditions and update failures.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COUSR02C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Update a user in USRSEC file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COUSR02C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR02C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU02'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-USR-MODIFIED            PIC X(01) VALUE 'N'.\n           88 USR-MODIFIED-YES                   VALUE 'Y'.\n           88 USR-MODIFIED-NO                    VALUE 'N'.\n\n       COPY COCOM01Y.\n          05 CDEMO-CU02-INFO.\n             10 CDEMO-CU02-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU02-USRID-LAST      PIC X(08).\n             10 CDEMO-CU02-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU02-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU02-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU02-USR-SELECTED    PIC X(08).\n\n       COPY COUSR02.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF     TO TRUE\n           SET USR-MODIFIED-NO TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR2AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR2AO\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   IF CDEMO-CU02-USR-SELECTED NOT =\n                                              SPACES AND LOW-VALUES\n                       MOVE CDEMO-CU02-USR-SELECTED TO\n                            USRIDINI OF COUSR2AI\n                       PERFORM PROCESS-ENTER-KEY\n                   END-IF\n                   PERFORM SEND-USRUPD-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRUPD-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           PERFORM UPDATE-USER-INFO\n                           IF CDEMO-FROM-PROGRAM = SPACES OR LOW-VALUES\n                               MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           ELSE\n                               MOVE CDEMO-FROM-PROGRAM TO\n                               CDEMO-TO-PROGRAM\n                           END-IF\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF4\n                           PERFORM CLEAR-CURRENT-SCREEN\n                       WHEN DFHPF5\n                           PERFORM UPDATE-USER-INFO\n                       WHEN DFHPF12\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRUPD-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACES      TO FNAMEI   OF COUSR2AI\n                                   LNAMEI   OF COUSR2AI\n                                   PASSWDI  OF COUSR2AI\n                                   USRTYPEI OF COUSR2AI\n               MOVE USRIDINI  OF COUSR2AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n           END-IF.\n\n           IF NOT ERR-FLG-ON\n               MOVE SEC-USR-FNAME      TO FNAMEI    OF COUSR2AI\n               MOVE SEC-USR-LNAME      TO LNAMEI    OF COUSR2AI\n               MOVE SEC-USR-PWD        TO PASSWDI   OF COUSR2AI\n               MOVE SEC-USR-TYPE       TO USRTYPEI  OF COUSR2AI\n               PERFORM SEND-USRUPD-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-USER-INFO\n      *----------------------------------------------------------------*\n       UPDATE-USER-INFO.\n\n           EVALUATE TRUE\n               WHEN USRIDINI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN FNAMEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'First Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN LNAMEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Last Name can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO LNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN PASSWDI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Password can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO PASSWDL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN USRTYPEI OF COUSR2AI = SPACES OR LOW-VALUES\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User Type can NOT be empty...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRTYPEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   CONTINUE\n           END-EVALUATE\n\n           IF NOT ERR-FLG-ON\n               MOVE USRIDINI  OF COUSR2AI TO SEC-USR-ID\n               PERFORM READ-USER-SEC-FILE\n\n               IF FNAMEI  OF COUSR2AI NOT = SEC-USR-FNAME\n                   MOVE FNAMEI   OF COUSR2AI TO SEC-USR-FNAME\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF LNAMEI  OF COUSR2AI NOT = SEC-USR-LNAME\n                   MOVE LNAMEI   OF COUSR2AI TO SEC-USR-LNAME\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF PASSWDI  OF COUSR2AI NOT = SEC-USR-PWD\n                   MOVE PASSWDI  OF COUSR2AI TO SEC-USR-PWD\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n               IF USRTYPEI  OF COUSR2AI NOT = SEC-USR-TYPE\n                   MOVE USRTYPEI OF COUSR2AI TO SEC-USR-TYPE\n                   SET USR-MODIFIED-YES TO TRUE\n               END-IF\n\n               IF USR-MODIFIED-YES\n                   PERFORM UPDATE-USER-SEC-FILE\n               ELSE\n                   MOVE 'Please modify to update ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHRED       TO ERRMSGC  OF COUSR2AO\n                   PERFORM SEND-USRUPD-SCREEN\n               END-IF\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRUPD-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRUPD-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR2AO\n\n           EXEC CICS SEND\n                     MAP('COUSR2A')\n                     MAPSET('COUSR02')\n                     FROM(COUSR2AO)\n                     ERASE\n                     CURSOR\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRUPD-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRUPD-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR2A')\n                     MAPSET('COUSR02')\n                     INTO(COUSR2AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR2AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR2AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR2AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR2AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR2AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR2AO.\n\n      *----------------------------------------------------------------*\n      *                      READ-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READ-USER-SEC-FILE.\n\n           EXEC CICS READ\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                UPDATE\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n                   MOVE 'Press PF5 key to save your updates ...' TO\n                                   WS-MESSAGE\n                   MOVE DFHNEUTR       TO ERRMSGC  OF COUSR2AO\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      UPDATE-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       UPDATE-USER-SEC-FILE.\n\n           EXEC CICS REWRITE\n                DATASET   (WS-USRSEC-FILE)\n                FROM      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   MOVE SPACES             TO WS-MESSAGE\n                   MOVE DFHGREEN           TO ERRMSGC  OF COUSR2AO\n                   STRING 'User '     DELIMITED BY SIZE\n                          SEC-USR-ID  DELIMITED BY SPACE\n                          ' has been updated ...' DELIMITED BY SIZE\n                     INTO WS-MESSAGE\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN DFHRESP(NOTFND)\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'User ID NOT found...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Update User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO FNAMEL OF COUSR2AI\n                   PERFORM SEND-USRUPD-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      CLEAR-CURRENT-SCREEN\n      *----------------------------------------------------------------*\n       CLEAR-CURRENT-SCREEN.\n\n           PERFORM INITIALIZE-ALL-FIELDS.\n           PERFORM SEND-USRUPD-SCREEN.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-ALL-FIELDS\n      *----------------------------------------------------------------*\n       INITIALIZE-ALL-FIELDS.\n\n           MOVE -1              TO USRIDINL OF COUSR2AI\n           MOVE SPACES          TO USRIDINI OF COUSR2AI\n                                   FNAMEI   OF COUSR2AI\n                                   LNAMEI   OF COUSR2AI\n                                   PASSWDI  OF COUSR2AI\n                                   USRTYPEI OF COUSR2AI\n                                   WS-MESSAGE.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "COUSR02",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant COUSR02C as \"COUSR02C Program\"\n    participant USRSEC as \"USRSEC File\"\n    participant CICS as \"CICS System\"\n    \n    User->>COUSR02C: Start transaction\n    \n    COUSR02C->>COUSR02C: MAIN-PARA\n    \n    alt First time entry\n        COUSR02C->>COUSR02C: Initialize screen\n        COUSR02C->>COUSR02C: POPULATE-HEADER-INFO\n        \n        alt User ID pre-populated\n            COUSR02C->>COUSR02C: PROCESS-ENTER-KEY\n        end\n        \n        COUSR02C->>CICS: SEND-USRUPD-SCREEN\n        COUSR02C-->>User: Display update screen\n    else Re-entry\n        COUSR02C->>CICS: RECEIVE-USRUPD-SCREEN\n        CICS-->>COUSR02C: User input\n        \n        alt ENTER key pressed\n            COUSR02C->>COUSR02C: PROCESS-ENTER-KEY\n            \n            alt Valid User ID\n                COUSR02C->>USRSEC: READ-USER-SEC-FILE\n                USRSEC-->>COUSR02C: User record\n                COUSR02C->>CICS: SEND-USRUPD-SCREEN\n                COUSR02C-->>User: Display user data\n            else Invalid User ID\n                COUSR02C->>CICS: SEND-USRUPD-SCREEN\n                COUSR02C-->>User: Display error message\n            end\n            \n        else PF3 key pressed\n            COUSR02C->>COUSR02C: UPDATE-USER-INFO\n            COUSR02C->>COUSR02C: RETURN-TO-PREV-SCREEN\n            COUSR02C->>CICS: XCTL to previous program\n            \n        else PF4 key pressed\n            COUSR02C->>COUSR02C: CLEAR-CURRENT-SCREEN\n            COUSR02C->>COUSR02C: INITIALIZE-ALL-FIELDS\n            COUSR02C->>CICS: SEND-USRUPD-SCREEN\n            COUSR02C-->>User: Display cleared screen\n            \n        else PF5 key pressed\n            COUSR02C->>COUSR02C: UPDATE-USER-INFO\n            \n            alt Valid input\n                COUSR02C->>USRSEC: READ-USER-SEC-FILE\n                USRSEC-->>COUSR02C: User record\n                \n                alt Changes detected\n                    COUSR02C->>USRSEC: UPDATE-USER-SEC-FILE\n                    \n                    alt Update successful\n                        COUSR02C->>CICS: SEND-USRUPD-SCREEN\n                        COUSR02C-->>User: Display success message\n                    else Update failed\n                        COUSR02C->>CICS: SEND-USRUPD-SCREEN\n                        COUSR02C-->>User: Display error message\n                    end\n                    \n                else No changes\n                    COUSR02C->>CICS: SEND-USRUPD-SCREEN\n                    COUSR02C-->>User: Display \"Please modify\" message\n                end\n                \n            else Invalid input\n                COUSR02C->>CICS: SEND-USRUPD-SCREEN\n                COUSR02C-->>User: Display validation error\n            end\n            \n        else PF12 key pressed\n            COUSR02C->>COUSR02C: RETURN-TO-PREV-SCREEN\n            COUSR02C->>CICS: XCTL to admin menu\n            \n        else Invalid key\n            COUSR02C->>CICS: SEND-USRUPD-SCREEN\n            COUSR02C-->>User: Display invalid key message\n        end\n    end\n    \n    COUSR02C->>CICS: RETURN with commarea"
    },
    {
      "id": "CBACT03C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.                                                            \n           SELECT XREFFILE-FILE ASSIGN TO   XREFFILE                            \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  FILE STATUS  IS XREFFILE-STATUS.                              \n      *",
            "description": "This section defines the file control parameters for the XREFFILE-FILE, which is an indexed VSAM file containing account cross-reference data. The file is configured for sequential access mode with FD-XREF-CARD-NUM as the record key. The program tracks file operation status through the XREFFILE-STATUS field, which is used for error handling during file operations."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  XREFFILE-FILE.                                                       \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).",
            "description": "This section defines the file structure for the XREFFILE, which contains account cross-reference data. The record layout consists of two fields: a 16-character card number field (FD-XREF-CARD-NUM) and a 34-character data field (FD-XREF-DATA). This structure is used by the program to read and process account cross-reference information from the indexed VSAM file."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************         \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************",
            "description": "This Working Storage Section defines the data structures used for file status tracking and error handling in the CBACT03C program. It includes the CVACT03Y copybook, file status fields for the XREFFILE (XREFFILE-STATUS), general I/O status tracking variables, and binary-to-character conversion fields. The section also contains program control variables including APPL-RESULT with condition names for normal processing (APPL-AOK) and end-of-file conditions (APPL-EOF), an END-OF-FILE flag, an ABCODE field for abnormal termination, and a TIMING field. These structures support the program's primary function of reading and displaying account cross-reference data with robust error handling."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.                                                            \n       FD  XREFFILE-FILE.                                                       \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "1000-XREFFILE-GET-NEXT",
            "code": "READ XREFFILE-FILE INTO CARD-XREF-RECORD.                            \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n               DISPLAY CARD-XREF-RECORD                                         \n           ELSE                                                                 \n               IF  XREFFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING XREFFILE'                             \n                   MOVE XREFFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the sequential reading of records from the XREFFILE. It reads a record into CARD-XREF-RECORD and processes the result based on the file status. When a record is successfully read (status '00'), it sets APPL-RESULT to 0 and displays the record. For end-of-file condition (status '10'), it sets APPL-RESULT to 16. Any other status is treated as an error with APPL-RESULT set to 12. The paragraph then evaluates APPL-RESULT: if processing was successful, it continues; if end-of-file was reached, it sets END-OF-FILE flag to 'Y'; for any other error, it displays an error message, captures the file status, calls routines to display the status details and abnormally terminate the program."
          },
          {
            "name": "0000-XREFFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREFFILE-FILE                                             \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING XREFFILE'                                 \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the XREFFILE-FILE for input processing. It initializes APPL-RESULT to 8, attempts to open the file, and then sets APPL-RESULT to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, captures the file status code, calls procedures to display the I/O status details (9910-DISPLAY-IO-STATUS) and then terminates the program abnormally (9999-ABEND-PROGRAM). This represents standard error handling for file opening operations in the CardDemo application."
          },
          {
            "name": "9000-XREFFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE XREFFILE-FILE                                                  \n           IF  XREFFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING XREFFILE'                                 \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the XREFFILE-FILE and implements error handling for this operation. It initially sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to zero; otherwise, it sets APPL-RESULT to 12 to indicate an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program abnormally. The EXIT statement marks the end of the paragraph."
          },
          {
            "name": "9999-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************",
            "description": "This paragraph handles abnormal program termination by displaying an \"ABENDING PROGRAM\" message, resetting the TIMING variable to zero, setting the abend code to 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program termination. This is part of the error handling mechanism that ensures the program terminates in a controlled manner when critical errors are encountered."
          },
          {
            "name": "9910-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *",
            "description": "This paragraph formats and displays file status codes for error reporting. It handles two types of status codes: extended file status codes (when the first byte is '9' or non-numeric) and standard file status codes. For extended status codes, it preserves the first byte and converts the second byte to a binary value for proper display. For standard codes, it formats them with leading zeros. The formatted status code is then displayed with the prefix \"FILE STATUS IS: NNNN\" where NNNN is the actual status code. This provides consistent error reporting throughout the program, helping with debugging file operation issues."
          }
        ],
        "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBACT03C'.                    \n           PERFORM 0000-XREFFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-XREFFILE-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                       DISPLAY CARD-XREF-RECORD                                 \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-XREFFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT03C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-XREFFILE-GET-NEXT.                                                  \n           READ XREFFILE-FILE INTO CARD-XREF-RECORD.                            \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n               DISPLAY CARD-XREF-RECORD                                         \n           ELSE                                                                 \n               IF  XREFFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING XREFFILE'                             \n                   MOVE XREFFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-XREFFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREFFILE-FILE                                             \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING XREFFILE'                                 \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-XREFFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE XREFFILE-FILE                                                  \n           IF  XREFFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING XREFFILE'                                 \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *"
      },
      "description": "This batch COBOL program (CBACT03C) reads and displays account cross-reference data from an indexed VSAM file. It sequentially processes records from the XREFFILE, displaying each record's content until the end of file is reached. The program includes comprehensive error handling for file operations (open, read, close) with detailed status code reporting and program termination via CEE3ABD in case of errors. It's part of the CardDemo application, which demonstrates AWS and partner technologies for mainframe migration and modernization use cases.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBACT03C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : Read and print account cross reference data file.     \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.    CBACT03C.                                                 \n       AUTHOR.        AWS.                                                      \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n       FILE-CONTROL.                                                            \n           SELECT XREFFILE-FILE ASSIGN TO   XREFFILE                            \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  FILE STATUS  IS XREFFILE-STATUS.                              \n      *                                                                         \n       DATA DIVISION.                                                           \n       FILE SECTION.                                                            \n       FD  XREFFILE-FILE.                                                       \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************         \n       PROCEDURE DIVISION.                                                      \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBACT03C'.                    \n           PERFORM 0000-XREFFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-XREFFILE-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                       DISPLAY CARD-XREF-RECORD                                 \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-XREFFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT03C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-XREFFILE-GET-NEXT.                                                  \n           READ XREFFILE-FILE INTO CARD-XREF-RECORD.                            \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n               DISPLAY CARD-XREF-RECORD                                         \n           ELSE                                                                 \n               IF  XREFFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING XREFFILE'                             \n                   MOVE XREFFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-XREFFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREFFILE-FILE                                             \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING XREFFILE'                                 \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-XREFFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE XREFFILE-FILE                                                  \n           IF  XREFFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING XREFFILE'                                 \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVACT03Y"
      ],
      "diagram": null
    },
    {
      "id": "COCRDUPC",
      "author": "",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "",
            "description": "This section would typically contain the INPUT-OUTPUT SECTION of the COCRDUPC program, which would define file assignments and external resources used by the program. However, the provided snippet is empty, suggesting that this program likely doesn't directly interact with physical files but instead relies on CICS commands for data access and manipulation. This is consistent with the program's role as a CICS transaction interface for credit card updates, where data access would be handled through CICS services rather than direct file operations."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n            07 WS-UCTRANS                          PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDNAME-FLAG                 PIC X(1).                    \n           88  FLG-CARDNAME-NOT-OK                 VALUE '0'.                   \n           88  FLG-CARDNAME-ISVALID                VALUE '1'.                   \n           88  FLG-CARDNAME-BLANK                  VALUE ' '.                   \n         05  WS-EDIT-CARDSTATUS-FLAG              PIC X(1).                     \n           88  FLG-CARDSTATUS-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDSTATUS-ISVALID              VALUE '1'.                   \n           88  FLG-CARDSTATUS-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDEXPMON-FLAG              PIC X(1).                     \n           88  FLG-CARDEXPMON-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDEXPMON-ISVALID              VALUE '1'.                   \n           88  FLG-CARDEXPMON-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDEXPYEAR-FLAG             PIC X(1).                     \n           88  FLG-CARDEXPYEAR-NOT-OK              VALUE '0'.                   \n           88  FLG-CARDEXPYEAR-ISVALID             VALUE '1'.                   \n           88  FLG-CARDEXPYEAR-BLANK               VALUE ' '.                   \n         05  WS-RETURN-FLAG                        PIC X(1).                    \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  CARD-NAME-CHECK                       PIC X(50)                    \n                                                   VALUE LOW-VALUES.            \n         05  FLG-YES-NO-CHECK                      PIC X(1)                     \n                                                   VALUE 'N'.                   \n           88 FLG-YES-NO-VALID                     VALUES 'Y', 'N'.             \n         05  CARD-MONTH-CHECK                      PIC X(2).                    \n         05  CARD-MONTH-CHECK-N REDEFINES                                       \n             CARD-MONTH-CHECK                      PIC 9(2).                    \n             88 VALID-MONTH                        VALUES 1 THRU 12.            \n         05  CARD-YEAR-CHECK                      PIC X(4).                     \n         05  CARD-YEAR-CHECK-N REDEFINES                                        \n             CARD-YEAR-CHECK                      PIC 9(4).                     \n             88 VALID-YEAR                        VALUES 1950 THRU 2099.        \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  CARD-CARD-NUM-X                     PIC X(16).                   \n           10  CARD-CARD-NUM-N REDEFINES  CARD-CARD-NUM-X                       \n                                                   PIC 9(16).                   \n           10  CARD-NAME-EMBOSSED-X                PIC X(50).                   \n           10  CARD-STATUS-X                       PIC X.                       \n           10  CARD-EXPIRAION-DATE-X               PIC X(10).                   \n           10  FILLER REDEFINES CARD-EXPIRAION-DATE-X.                          \n               20 CARD-EXPIRY-YEAR                 PIC X(4).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-MONTH                PIC X(2).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-DAY                  PIC X(2).                    \n           10  CARD-EXPIRAION-DATE-N REDEFINES                                  \n               CARD-EXPIRAION-DATE-X               PIC 9(10).                   \n                                                                                \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-CARD-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  FOUND-CARDS-FOR-ACCOUNT             VALUE                        \n               'Details of selected card shown above'.                          \n           88  PROMPT-FOR-SEARCH-KEYS              VALUE                        \n               'Please enter Account and Card Number'.                          \n           88  PROMPT-FOR-CHANGES                  VALUE                        \n               'Update card details presented above.'.                          \n           88  PROMPT-FOR-CONFIRMATION             VALUE                        \n               'Changes validated.Press F5 to save'.                            \n           88  CONFIRM-UPDATE-SUCCESS              VALUE                        \n               'Changes committed to database'.                                 \n           88  INFORM-FAILURE                      VALUE                        \n               'Changes unsuccessful. Please try again'.                        \n                                                                                \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  WS-PROMPT-FOR-CARD                  VALUE                        \n               'Card number not provided'.                                      \n           88  WS-PROMPT-FOR-NAME                  VALUE                        \n               'Card name not provided'.                                        \n           88  WS-NAME-MUST-BE-ALPHA               VALUE                        \n               'Card name can only contain alphabets and spaces'.               \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  NO-CHANGES-DETECTED                 VALUE                        \n               'No change detected with respect to values fetched.'.            \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-CARD-NOT-NUMERIC           VALUE                        \n               'Card number if supplied must be a 16 digit number'.             \n           88  CARD-STATUS-MUST-BE-YES-NO          VALUE                        \n               'Card Active Status must be Y or N'.                             \n           88  CARD-EXPIRY-MONTH-NOT-VALID          VALUE                       \n               'Card expiry month must be between 1 and 12'.                    \n           88  CARD-EXPIRY-YEAR-NOT-VALID          VALUE                        \n               'Invalid card expiry year'.                                      \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in cards database'.                   \n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE                        \n               'Did not find cards for this search condition'.                  \n           88  COULD-NOT-LOCK-FOR-UPDATE           VALUE                        \n               'Could not lock record for update'.                              \n           88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE                        \n               'Record changed by some one else. Please review'.                \n           88  LOCKED-BUT-UPDATE-FAILED            VALUE                        \n               'Update of record failed'.                                       \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading Card Data File'.                                  \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      ******************************************************************        \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COCRDUPC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CCUP'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COCRDUP '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CCRDUPA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05  LIT-CARDDTLPGM                       PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05  LIT-CARDDTLTRANID                    PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05  LIT-CARDDTLMAPSET                    PIC X(7)                     \n                                                   VALUE 'COCRDSL'.             \n          05  LIT-CARDDTLMAP                       PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n          05 LIT-ALL-ALPHA-FROM                    PIC X(52)                    \n             VALUE                                                              \n             'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.            \n          05 LIT-ALL-SPACES-TO                     PIC X(52)                    \n                                                   VALUE SPACES.                \n          05 LIT-UPPER                             PIC X(26)                    \n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.            \n          05 LIT-LOWER                             PIC X(26)                    \n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.            \n                                                                                \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CARD-UPDATE-SCREEN-DATA.                                           \n             10 CCUP-CHANGE-ACTION                 PIC X(1)                     \n                                                   VALUE LOW-VALUES.            \n                88 CCUP-DETAILS-NOT-FETCHED        VALUES                       \n                                                   LOW-VALUES,                  \n                                                   SPACES.                      \n                88 CCUP-SHOW-DETAILS               VALUE 'S'.                   \n                88 CCUP-CHANGES-MADE               VALUES 'E', 'N'              \n                                                        , 'C', 'L'              \n                                                        , 'F'.                  \n                88 CCUP-CHANGES-NOT-OK             VALUE 'E'.                   \n                88 CCUP-CHANGES-OK-NOT-CONFIRMED   VALUE 'N'.                   \n                88 CCUP-CHANGES-OKAYED-AND-DONE    VALUE 'C'.                   \n                88 CCUP-CHANGES-FAILED             VALUES 'L', 'F'.             \n                88 CCUP-CHANGES-OKAYED-LOCK-ERROR  VALUE 'L'.                   \n                88 CCUP-CHANGES-OKAYED-BUT-FAILED  VALUE 'F'.                   \n          05 CCUP-OLD-DETAILS.                                                  \n             10 CCUP-OLD-ACCTID                    PIC X(11).                   \n             10 CCUP-OLD-CARDID                    PIC X(16).                   \n             10 CCUP-OLD-CVV-CD                    PIC X(3).                    \n             10 CCUP-OLD-CARDDATA.                                              \n                20 CCUP-OLD-CRDNAME                PIC X(50).                   \n                20 CCUP-OLD-EXPIRAION-DATE.                                     \n                   25 CCUP-OLD-EXPYEAR             PIC X(4).                    \n                   25 CCUP-OLD-EXPMON              PIC X(2).                    \n                   25 CCUP-OLD-EXPDAY              PIC X(2).                    \n                20 CCUP-OLD-CRDSTCD                PIC X(1).                    \n                                                                                \n          05 CCUP-NEW-DETAILS.                                                  \n             10 CCUP-NEW-ACCTID                    PIC X(11).                   \n             10 CCUP-NEW-CARDID                    PIC X(16).                   \n             10 CCUP-NEW-CVV-CD                    PIC X(3).                    \n             10 CCUP-NEW-CARDDATA.                                              \n                20 CCUP-NEW-CRDNAME                PIC X(50).                   \n                20 CCUP-NEW-EXPIRAION-DATE.                                     \n                   25 CCUP-NEW-EXPYEAR             PIC X(4).                    \n                   25 CCUP-NEW-EXPMON              PIC X(2).                    \n                   25 CCUP-NEW-EXPDAY              PIC X(2).                    \n                20 CCUP-NEW-CRDSTCD                PIC X(1).                    \n          05 CARD-UPDATE-RECORD.                                                \n             10 CARD-UPDATE-NUM                   PIC X(16).                    \n             10 CARD-UPDATE-ACCT-ID               PIC 9(11).                    \n             10 CARD-UPDATE-CVV-CD                PIC 9(03).                    \n             10 CARD-UPDATE-EMBOSSED-NAME         PIC X(50).                    \n             10 CARD-UPDATE-EXPIRAION-DATE        PIC X(10).                    \n             10 CARD-UPDATE-ACTIVE-STATUS         PIC X(01).                    \n             10 FILLER                            PIC X(59).                    \n                                                                                \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Update Screen Layout                                         \n       COPY COCRDUP.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n      *ACCOUNT RECORD LAYOUT                                                    \n      *COPY CVACT01Y.                                                           \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n      *COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.",
            "description": "This working storage section defines the data structures used in the COCRDUPC program for credit card detail updates. It contains several key components:\n\n1. CICS processing variables for handling responses and transaction IDs\n2. Extensive input validation flags and fields for each card attribute (account number, card number, embossed name, status, expiration date)\n3. Data conversion fields for numeric/alphanumeric transformations\n4. File handling structures including record identifiers and error message formatting\n5. Message construction areas for user feedback, including predefined status messages for various scenarios (success, validation errors, record locking)\n6. Program constants and literals defining transaction IDs, program names, mapsets, and valid character sets\n7. A program-specific communication area (WS-THIS-PROGCOMMAREA) that maintains both old and new card details to track changes\n8. References to numerous copybooks for common structures including card record layouts, screen definitions, date handling, and user information\n\nThe section is particularly focused on supporting the validation and update workflow, with comprehensive error handling for all possible input conditions and database operations."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.",
            "description": "This linkage section defines the DFHCOMMAREA structure used for communication between CICS programs. It contains a single field defined as a variable-length array of 1-byte elements that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive and process communication areas of different sizes from calling programs within the CardDemo credit card update functionality."
          }
        ],
        "copybooks": [],
        "code": "WORKING-STORAGE SECTION.                                                 \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n            07 WS-UCTRANS                          PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDNAME-FLAG                 PIC X(1).                    \n           88  FLG-CARDNAME-NOT-OK                 VALUE '0'.                   \n           88  FLG-CARDNAME-ISVALID                VALUE '1'.                   \n           88  FLG-CARDNAME-BLANK                  VALUE ' '.                   \n         05  WS-EDIT-CARDSTATUS-FLAG              PIC X(1).                     \n           88  FLG-CARDSTATUS-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDSTATUS-ISVALID              VALUE '1'.                   \n           88  FLG-CARDSTATUS-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDEXPMON-FLAG              PIC X(1).                     \n           88  FLG-CARDEXPMON-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDEXPMON-ISVALID              VALUE '1'.                   \n           88  FLG-CARDEXPMON-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDEXPYEAR-FLAG             PIC X(1).                     \n           88  FLG-CARDEXPYEAR-NOT-OK              VALUE '0'.                   \n           88  FLG-CARDEXPYEAR-ISVALID             VALUE '1'.                   \n           88  FLG-CARDEXPYEAR-BLANK               VALUE ' '.                   \n         05  WS-RETURN-FLAG                        PIC X(1).                    \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  CARD-NAME-CHECK                       PIC X(50)                    \n                                                   VALUE LOW-VALUES.            \n         05  FLG-YES-NO-CHECK                      PIC X(1)                     \n                                                   VALUE 'N'.                   \n           88 FLG-YES-NO-VALID                     VALUES 'Y', 'N'.             \n         05  CARD-MONTH-CHECK                      PIC X(2).                    \n         05  CARD-MONTH-CHECK-N REDEFINES                                       \n             CARD-MONTH-CHECK                      PIC 9(2).                    \n             88 VALID-MONTH                        VALUES 1 THRU 12.            \n         05  CARD-YEAR-CHECK                      PIC X(4).                     \n         05  CARD-YEAR-CHECK-N REDEFINES                                        \n             CARD-YEAR-CHECK                      PIC 9(4).                     \n             88 VALID-YEAR                        VALUES 1950 THRU 2099.        \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  CARD-CARD-NUM-X                     PIC X(16).                   \n           10  CARD-CARD-NUM-N REDEFINES  CARD-CARD-NUM-X                       \n                                                   PIC 9(16).                   \n           10  CARD-NAME-EMBOSSED-X                PIC X(50).                   \n           10  CARD-STATUS-X                       PIC X.                       \n           10  CARD-EXPIRAION-DATE-X               PIC X(10).                   \n           10  FILLER REDEFINES CARD-EXPIRAION-DATE-X.                          \n               20 CARD-EXPIRY-YEAR                 PIC X(4).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-MONTH                PIC X(2).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-DAY                  PIC X(2).                    \n           10  CARD-EXPIRAION-DATE-N REDEFINES                                  \n               CARD-EXPIRAION-DATE-X               PIC 9(10).                   \n                                                                                \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-CARD-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  FOUND-CARDS-FOR-ACCOUNT             VALUE                        \n               'Details of selected card shown above'.                          \n           88  PROMPT-FOR-SEARCH-KEYS              VALUE                        \n               'Please enter Account and Card Number'.                          \n           88  PROMPT-FOR-CHANGES                  VALUE                        \n               'Update card details presented above.'.                          \n           88  PROMPT-FOR-CONFIRMATION             VALUE                        \n               'Changes validated.Press F5 to save'.                            \n           88  CONFIRM-UPDATE-SUCCESS              VALUE                        \n               'Changes committed to database'.                                 \n           88  INFORM-FAILURE                      VALUE                        \n               'Changes unsuccessful. Please try again'.                        \n                                                                                \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  WS-PROMPT-FOR-CARD                  VALUE                        \n               'Card number not provided'.                                      \n           88  WS-PROMPT-FOR-NAME                  VALUE                        \n               'Card name not provided'.                                        \n           88  WS-NAME-MUST-BE-ALPHA               VALUE                        \n               'Card name can only contain alphabets and spaces'.               \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  NO-CHANGES-DETECTED                 VALUE                        \n               'No change detected with respect to values fetched.'.            \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-CARD-NOT-NUMERIC           VALUE                        \n               'Card number if supplied must be a 16 digit number'.             \n           88  CARD-STATUS-MUST-BE-YES-NO          VALUE                        \n               'Card Active Status must be Y or N'.                             \n           88  CARD-EXPIRY-MONTH-NOT-VALID          VALUE                       \n               'Card expiry month must be between 1 and 12'.                    \n           88  CARD-EXPIRY-YEAR-NOT-VALID          VALUE                        \n               'Invalid card expiry year'.                                      \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in cards database'.                   \n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE                        \n               'Did not find cards for this search condition'.                  \n           88  COULD-NOT-LOCK-FOR-UPDATE           VALUE                        \n               'Could not lock record for update'.                              \n           88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE                        \n               'Record changed by some one else. Please review'.                \n           88  LOCKED-BUT-UPDATE-FAILED            VALUE                        \n               'Update of record failed'.                                       \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading Card Data File'.                                  \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      ******************************************************************        \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COCRDUPC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CCUP'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COCRDUP '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CCRDUPA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05  LIT-CARDDTLPGM                       PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05  LIT-CARDDTLTRANID                    PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05  LIT-CARDDTLMAPSET                    PIC X(7)                     \n                                                   VALUE 'COCRDSL'.             \n          05  LIT-CARDDTLMAP                       PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n          05 LIT-ALL-ALPHA-FROM                    PIC X(52)                    \n             VALUE                                                              \n             'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.            \n          05 LIT-ALL-SPACES-TO                     PIC X(52)                    \n                                                   VALUE SPACES.                \n          05 LIT-UPPER                             PIC X(26)                    \n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.            \n          05 LIT-LOWER                             PIC X(26)                    \n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.            \n                                                                                \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CARD-UPDATE-SCREEN-DATA.                                           \n             10 CCUP-CHANGE-ACTION                 PIC X(1)                     \n                                                   VALUE LOW-VALUES.            \n                88 CCUP-DETAILS-NOT-FETCHED        VALUES                       \n                                                   LOW-VALUES,                  \n                                                   SPACES.                      \n                88 CCUP-SHOW-DETAILS               VALUE 'S'.                   \n                88 CCUP-CHANGES-MADE               VALUES 'E', 'N'              \n                                                        , 'C', 'L'              \n                                                        , 'F'.                  \n                88 CCUP-CHANGES-NOT-OK             VALUE 'E'.                   \n                88 CCUP-CHANGES-OK-NOT-CONFIRMED   VALUE 'N'.                   \n                88 CCUP-CHANGES-OKAYED-AND-DONE    VALUE 'C'.                   \n                88 CCUP-CHANGES-FAILED             VALUES 'L', 'F'.             \n                88 CCUP-CHANGES-OKAYED-LOCK-ERROR  VALUE 'L'.                   \n                88 CCUP-CHANGES-OKAYED-BUT-FAILED  VALUE 'F'.                   \n          05 CCUP-OLD-DETAILS.                                                  \n             10 CCUP-OLD-ACCTID                    PIC X(11).                   \n             10 CCUP-OLD-CARDID                    PIC X(16).                   \n             10 CCUP-OLD-CVV-CD                    PIC X(3).                    \n             10 CCUP-OLD-CARDDATA.                                              \n                20 CCUP-OLD-CRDNAME                PIC X(50).                   \n                20 CCUP-OLD-EXPIRAION-DATE.                                     \n                   25 CCUP-OLD-EXPYEAR             PIC X(4).                    \n                   25 CCUP-OLD-EXPMON              PIC X(2).                    \n                   25 CCUP-OLD-EXPDAY              PIC X(2).                    \n                20 CCUP-OLD-CRDSTCD                PIC X(1).                    \n                                                                                \n          05 CCUP-NEW-DETAILS.                                                  \n             10 CCUP-NEW-ACCTID                    PIC X(11).                   \n             10 CCUP-NEW-CARDID                    PIC X(16).                   \n             10 CCUP-NEW-CVV-CD                    PIC X(3).                    \n             10 CCUP-NEW-CARDDATA.                                              \n                20 CCUP-NEW-CRDNAME                PIC X(50).                   \n                20 CCUP-NEW-EXPIRAION-DATE.                                     \n                   25 CCUP-NEW-EXPYEAR             PIC X(4).                    \n                   25 CCUP-NEW-EXPMON              PIC X(2).                    \n                   25 CCUP-NEW-EXPDAY              PIC X(2).                    \n                20 CCUP-NEW-CRDSTCD                PIC X(1).                    \n          05 CARD-UPDATE-RECORD.                                                \n             10 CARD-UPDATE-NUM                   PIC X(16).                    \n             10 CARD-UPDATE-ACCT-ID               PIC 9(11).                    \n             10 CARD-UPDATE-CVV-CD                PIC 9(03).                    \n             10 CARD-UPDATE-EMBOSSED-NAME         PIC X(50).                    \n             10 CARD-UPDATE-EXPIRAION-DATE        PIC X(10).                    \n             10 CARD-UPDATE-ACTIVE-STATUS         PIC X(01).                    \n             10 FILLER                            PIC X(59).                    \n                                                                                \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Update Screen Layout                                         \n       COPY COCRDUP.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n      *ACCOUNT RECORD LAYOUT                                                    \n      *COPY CVACT01Y.                                                           \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n      *COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN."
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-MAIN",
            "code": "EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM                             \n               AND NOT CDEMO-PGM-REENTER)                                       \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n              SET CDEMO-PGM-ENTER TO TRUE                                       \n              SET CCUP-DETAILS-NOT-FETCHED TO TRUE                              \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              (CCARD-AID-PFK05 AND CCUP-CHANGES-OK-NOT-CONFIRMED)               \n                              OR                                                \n              (CCARD-AID-PFK12 AND NOT CCUP-DETAILS-NOT-FETCHED)                \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n      ******************************************************************        \n      *       USER PRESSES PF03 TO EXIT                                         \n      *  OR   USER IS DONE WITH UPDATE                                          \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n              WHEN CCARD-AID-PFK03                                              \n              WHEN (CCUP-CHANGES-OKAYED-AND-DONE                                \n               AND  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET)                 \n              WHEN (CCUP-CHANGES-FAILED                                         \n               AND  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET)                 \n                   SET CCARD-AID-PFK03     TO TRUE                              \n                                                                                \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                                                                                \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   IF CDEMO-LAST-MAPSET    EQUAL LIT-CCLISTMAPSET               \n                       MOVE ZEROS          TO CDEMO-ACCT-ID                     \n                                              CDEMO-CARD-NUM                    \n                   END-IF                                                       \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n                                                                                \n                   EXEC CICS                                                    \n                        SYNCPOINT                                               \n                   END-EXEC                                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CDEMO-TO-PROGRAM)                              \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      ******************************************************************        \n      *       USER CAME FROM CREDIT CARD LIST SCREEN                            \n      *            SO WE ALREADY HAVE THE FILTER KEYS                           \n      *            FETCH THE ASSSOCIATED CARD DETAILS FOR UPDATE                \n      ******************************************************************        \n              WHEN CDEMO-PGM-ENTER                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n              WHEN CCARD-AID-PFK12                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n                   SET CDEMO-PGM-REENTER    TO TRUE                             \n                   SET INPUT-OK             TO TRUE                             \n                   SET FLG-ACCTFILTER-ISVALID  TO TRUE                          \n                   SET FLG-CARDFILTER-ISVALID  TO TRUE                          \n                   MOVE CDEMO-ACCT-ID       TO CC-ACCT-ID-N                     \n                   MOVE CDEMO-CARD-NUM      TO CC-CARD-NUM-N                    \n                   PERFORM 9000-READ-DATA                                       \n                      THRU 9000-READ-DATA-EXIT                                  \n                   SET CCUP-SHOW-DETAILS TO TRUE                                \n                   PERFORM 3000-SEND-MAP                                        \n                      THRU 3000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *       FRESH ENTRY INTO PROGRAM                                          \n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED        \n      ******************************************************************        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n               AND CDEMO-PGM-ENTER                                              \n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM                       \n               AND NOT CDEMO-PGM-REENTER                                        \n                   INITIALIZE WS-THIS-PROGCOMMAREA                              \n                   PERFORM 3000-SEND-MAP THRU                                   \n                           3000-SEND-MAP-EXIT                                   \n                   SET CDEMO-PGM-REENTER        TO TRUE                         \n                   SET CCUP-DETAILS-NOT-FETCHED TO TRUE                         \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *       CARD DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY           \n      *            RESET THE SEARCH KEYS                                        \n      *            ASK THE USER FOR FRESH SEARCH CRITERIA                       \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n              WHEN CCUP-CHANGES-FAILED                                          \n                   INITIALIZE WS-THIS-PROGCOMMAREA                              \n                              WS-MISC-STORAGE                                   \n                              CDEMO-ACCT-ID                                     \n                              CDEMO-CARD-NUM                                    \n                   SET CDEMO-PGM-ENTER            TO TRUE                       \n                   PERFORM 3000-SEND-MAP THRU                                   \n                           3000-SEND-MAP-EXIT                                   \n                   SET CDEMO-PGM-REENTER          TO TRUE                       \n                   SET CCUP-DETAILS-NOT-FETCHED   TO TRUE                       \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *      CARD DATA HAS BEEN PRESENTED TO USER                               \n      *            CHECK THE USER INPUTS                                        \n      *            DECIDE WHAT TO DO                                            \n      *            PRESENT NEXT STEPS TO USER                                   \n      ******************************************************************        \n              WHEN OTHER                                                        \n                   PERFORM 1000-PROCESS-INPUTS                                  \n                      THRU 1000-PROCESS-INPUTS-EXIT                             \n                   PERFORM 2000-DECIDE-ACTION                                   \n                      THRU 2000-DECIDE-ACTION-EXIT                              \n                   PERFORM 3000-SEND-MAP                                        \n                      THRU 3000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph serves as the main control flow for the COCRDUPC program, handling the credit card update functionality. It initializes working storage, establishes error handling, and manages program state through a commarea. The paragraph processes user navigation through various program states by evaluating PF keys and program conditions. Key functions include: handling program exit (PF03), retrieving card details when coming from the card list screen (PF12), presenting initial entry screens, processing user inputs after card details are displayed, and managing the workflow between data entry, validation, and confirmation states. The code maintains context between screens by preserving program state in the commarea and handles transaction integrity with CICS SYNCPOINT commands when exiting to other programs."
          },
          {
            "name": "COMMON-RETURN",
            "code": "MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the program's return logic by first copying the return message to the error message field in the communication area. It then preserves both the common CardDemo communication area and this program's specific communication area by concatenating them together into a combined working storage area. Finally, it executes a CICS RETURN command that maintains the same transaction ID and passes back the combined communication area, ensuring that both shared and program-specific data are preserved for the next program invocation."
          },
          {
            "name": "0000-MAIN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as the exit point for the program. It's a simple termination point that marks the end of a processing section, allowing control to return to the calling routine. This is a standard COBOL structural element used to properly end program flow in the credit card update process."
          },
          {
            "name": "1000-PROCESS-INPUTS",
            "code": "PERFORM 1100-RECEIVE-MAP                                             \n              THRU 1100-RECEIVE-MAP-EXIT                                        \n           PERFORM 1200-EDIT-MAP-INPUTS                                         \n              THRU 1200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .",
            "description": "This paragraph orchestrates the initial input processing workflow for the credit card update transaction. It first calls the 1100-RECEIVE-MAP paragraph to retrieve user input from the screen, then performs validation of the input data through the 1200-EDIT-MAP-INPUTS paragraph. After validation, it captures any error messages in the communication area and sets up the program flow to return to the same screen by configuring the next program, mapset, and map names to the current ones. This ensures proper handling of input errors by returning the user to the same screen with appropriate feedback."
          },
          {
            "name": "1000-PROCESS-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1000-PROCESS-INPUTS section of the COCRDUPC program. It marks the end of the input processing logic for credit card detail updates, allowing the program flow to return to the calling section after input validation and processing has been completed."
          },
          {
            "name": "1100-RECEIVE-MAP",
            "code": "EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CCRDUPAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CCUP-NEW-DETAILS                                          \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CCRDUPAI = '*'                                       \n           OR  ACCTSIDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n                                             CCUP-NEW-ACCTID                    \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CCRDUPAI TO  CC-ACCT-ID                         \n                                             CCUP-NEW-ACCTID                    \n           END-IF                                                               \n                                                                                \n           IF  CARDSIDI OF CCRDUPAI = '*'                                       \n           OR  CARDSIDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-CARD-NUM                        \n                                             CCUP-NEW-CARDID                    \n           ELSE                                                                 \n               MOVE CARDSIDI OF CCRDUPAI TO  CC-CARD-NUM                        \n                                             CCUP-NEW-CARDID                    \n           END-IF                                                               \n                                                                                \n           IF  CRDNAMEI OF CCRDUPAI = '*'                                       \n           OR  CRDNAMEI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-CRDNAME                   \n           ELSE                                                                 \n               MOVE CRDNAMEI OF CCRDUPAI TO  CCUP-NEW-CRDNAME                   \n           END-IF                                                               \n                                                                                \n           IF  CRDSTCDI OF CCRDUPAI = '*'                                       \n           OR  CRDSTCDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-CRDSTCD                   \n           ELSE                                                                 \n               MOVE CRDSTCDI OF CCRDUPAI TO  CCUP-NEW-CRDSTCD                   \n           END-IF                                                               \n                                                                                \n           MOVE EXPDAYI     OF CCRDUPAI  TO  CCUP-NEW-EXPDAY                    \n                                                                                \n           IF  EXPMONI OF CCRDUPAI = '*'                                        \n           OR  EXPMONI OF CCRDUPAI = SPACES                                     \n               MOVE LOW-VALUES           TO  CCUP-NEW-EXPMON                    \n           ELSE                                                                 \n               MOVE EXPMONI OF CCRDUPAI  TO  CCUP-NEW-EXPMON                    \n           END-IF                                                               \n                                                                                \n           IF  EXPYEARI OF CCRDUPAI = '*'                                       \n           OR  EXPYEARI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-EXPYEAR                   \n           ELSE                                                                 \n               MOVE EXPYEARI OF CCRDUPAI TO  CCUP-NEW-EXPYEAR                   \n           END-IF                                                               \n           .",
            "description": "This paragraph receives user input from a CICS map and processes it for credit card updates. It first executes a CICS RECEIVE command to capture the data entered by the user into the CCRDUPAI structure. The paragraph then initializes the CCUP-NEW-DETAILS structure and processes each input field from the map. For each field (account ID, card number, card name, status code, and expiration date components), it applies consistent validation logic - if the field contains an asterisk or spaces, it's replaced with LOW-VALUES; otherwise, the entered value is stored. The paragraph handles both identification fields (account and card numbers) by storing them in both the CC fields (likely for record lookup) and the CCUP-NEW fields (for update processing). This ensures proper handling of user inputs before validation and database update operations occur in subsequent paragraphs."
          },
          {
            "name": "1100-RECEIVE-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1100-RECEIVE-MAP section of the COCRDUPC program. It marks the end of the map receiving process where user input from the CICS screen is captured for credit card update operations. The paragraph contains only the EXIT statement followed by a period, indicating a clean termination point for this processing section before control is passed to the next logical section in the program flow."
          },
          {
            "name": "1200-EDIT-MAP-INPUTS",
            "code": "SET INPUT-OK                  TO TRUE                                \n                                                                                \n           IF  CCUP-DETAILS-NOT-FETCHED                                         \n      *        VALIDATE THE SEARCH KEYS                                         \n               PERFORM 1210-EDIT-ACCOUNT                                        \n                  THRU 1210-EDIT-ACCOUNT-EXIT                                   \n                                                                                \n               PERFORM 1220-EDIT-CARD                                           \n                  THRU 1220-EDIT-CARD-EXIT                                      \n                                                                                \n               MOVE LOW-VALUES                 TO CCUP-NEW-CARDDATA             \n                                                                                \n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS SKIP OTHER EDITS           \n               IF  FLG-ACCTFILTER-BLANK                                         \n               AND FLG-CARDFILTER-BLANK                                         \n                   SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                      \n               END-IF                                                           \n                                                                                \n               GO TO 1200-EDIT-MAP-INPUTS-EXIT                                  \n                                                                                \n           ELSE                                                                 \n               CONTINUE                                                         \n           END-IF                                                               \n                                                                                \n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED                       \n           SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                                  \n           SET FLG-ACCTFILTER-ISVALID  TO TRUE                                  \n           SET FLG-CARDFILTER-ISVALID  TO TRUE                                  \n           MOVE CCUP-OLD-ACCTID     TO CDEMO-ACCT-ID                            \n           MOVE CCUP-OLD-CARDID     TO CDEMO-CARD-NUM                           \n           MOVE CCUP-OLD-CRDNAME    TO CARD-EMBOSSED-NAME                       \n           MOVE CCUP-OLD-CRDSTCD    TO CARD-ACTIVE-STATUS                       \n           MOVE CCUP-OLD-EXPDAY     TO CARD-EXPIRY-DAY                          \n           MOVE CCUP-OLD-EXPMON     TO CARD-EXPIRY-MONTH                        \n           MOVE CCUP-OLD-EXPYEAR    TO CARD-EXPIRY-YEAR                         \n                                                                                \n      *    NEW DATA IS SAME AS OLD DATA                                         \n           IF  (FUNCTION UPPER-CASE(CCUP-NEW-CARDDATA) EQUAL                    \n                FUNCTION UPPER-CASE(CCUP-OLD-CARDDATA))                         \n               SET NO-CHANGES-DETECTED TO TRUE                                  \n           END-IF                                                               \n                                                                                \n           IF  NO-CHANGES-DETECTED                                              \n           OR  CCUP-CHANGES-OK-NOT-CONFIRMED                                    \n           OR  CCUP-CHANGES-OKAYED-AND-DONE                                     \n               SET FLG-CARDNAME-ISVALID    TO TRUE                              \n               SET FLG-CARDSTATUS-ISVALID  TO TRUE                              \n               SET FLG-CARDEXPMON-ISVALID  TO TRUE                              \n               SET FLG-CARDEXPYEAR-ISVALID TO TRUE                              \n               GO TO 1200-EDIT-MAP-INPUTS-EXIT                                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           SET CCUP-CHANGES-NOT-OK    TO TRUE                                   \n                                                                                \n           PERFORM 1230-EDIT-NAME                                               \n              THRU 1230-EDIT-NAME-EXIT                                          \n                                                                                \n           PERFORM 1240-EDIT-CARDSTATUS                                         \n              THRU 1240-EDIT-CARDSTATUS-EXIT                                    \n                                                                                \n           PERFORM 1250-EDIT-EXPIRY-MON                                         \n              THRU 1250-EDIT-EXPIRY-MON-EXIT                                    \n                                                                                \n           PERFORM 1260-EDIT-EXPIRY-YEAR                                        \n              THRU 1260-EDIT-EXPIRY-YEAR-EXIT                                   \n                                                                                \n           IF INPUT-ERROR                                                       \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CCUP-CHANGES-OK-NOT-CONFIRMED TO TRUE                         \n           END-IF                                                               \n           .",
            "description": "This paragraph handles the validation of user inputs when updating credit card details. It first checks if card details have been fetched yet. If not, it validates only the search criteria (account and card numbers) and exits. If card details have already been fetched, it copies the existing card data to working fields and checks if any changes were made by comparing the new data with the original data. When changes are detected and not yet confirmed or processed, it performs validation on each editable field: embossed name, card status, expiration month, and expiration year through separate validation routines. Based on validation results, it either marks the input as having errors or sets a flag indicating changes are valid but not yet confirmed. The paragraph maintains the state of the update process through various status flags to ensure proper workflow progression."
          },
          {
            "name": "1200-EDIT-MAP-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1200-EDIT-MAP-INPUTS routine. It provides a clean termination point for the input validation logic, allowing the program to return control to the calling section after completing the validation of user inputs from the map."
          },
          {
            "name": "1210-EDIT-ACCOUNT",
            "code": "SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              MOVE LOW-VALUES   TO CCUP-NEW-ACCTID                              \n              GO TO  1210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              MOVE LOW-VALUES TO CCUP-NEW-ACCTID                                \n              GO TO 1210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n                                 CCUP-NEW-ACCTID                                \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the account ID input field for credit card updates. It first checks if the account ID is empty (spaces, low-values, or zeros) and sets appropriate error flags while prompting the user for an account if necessary. If an account ID is provided, it verifies that the value is numeric and 11 digits long. When validation fails, it clears the account ID fields and sets error indicators. Upon successful validation, it copies the account ID to the required program variables and marks the account filter as valid. The paragraph maintains error status flags and conditional messaging to guide the user through proper account ID entry."
          },
          {
            "name": "1210-EDIT-ACCOUNT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the account editing process. It's a simple paragraph marker that allows the program to return control to the calling routine after completing the account validation logic."
          },
          {
            "name": "1220-EDIT-CARD",
            "code": "*    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-CARD TO TRUE                                 \n              END-IF                                                            \n                                                                                \n              MOVE ZEROES        TO CDEMO-CARD-NUM                              \n                                   CCUP-NEW-CARDID                              \n              GO TO  1220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                                 TO WS-RETURN-MSG                               \n              END-IF                                                            \n              MOVE ZERO          TO CDEMO-CARD-NUM                              \n              MOVE LOW-VALUES    TO CCUP-NEW-CARDID                             \n              GO TO 1220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              MOVE CC-CARD-NUM   TO CCUP-NEW-CARDID                             \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the credit card number input during the card update process. It performs several checks: first, it verifies if the card number was provided at all (checking for spaces, low-values, or zeros). If the card number is missing, it sets appropriate error flags, clears the card number fields, and prompts the user for input if messaging is enabled. If a card number is provided, it validates that the input is numeric and 16 digits long. When validation fails, it sets error flags, displays an error message if messaging is enabled, and clears the card number fields. When validation succeeds, it moves the card number to the appropriate program variables and sets a flag indicating the card number is valid. The paragraph is part of the input validation workflow that ensures data integrity before proceeding with card updates."
          },
          {
            "name": "1220-EDIT-CARD-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the card editing process in the COCRDUPC program. It marks the end of the card validation and editing logic, allowing the program flow to return to the calling section after completing the validation of credit card details."
          },
          {
            "name": "1230-EDIT-NAME",
            "code": "*    Not BLANK                                                            \n           SET FLG-CARDNAME-NOT-OK      TO TRUE                                 \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-CRDNAME   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-CRDNAME   EQUAL SPACES                                   \n           OR CCUP-NEW-CRDNAME   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDNAME-BLANK  TO TRUE                                   \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-NAME TO TRUE                                 \n              END-IF                                                            \n              GO TO  1230-EDIT-NAME-EXIT                                        \n           END-IF                                                               \n                                                                                \n      *    Only Alphabets and space allowed                                     \n           MOVE CCUP-NEW-CRDNAME        TO CARD-NAME-CHECK                      \n           INSPECT CARD-NAME-CHECK                                              \n             CONVERTING LIT-ALL-ALPHA-FROM                                      \n                     TO LIT-ALL-SPACES-TO                                       \n                                                                                \n           IF FUNCTION LENGTH(FUNCTION TRIM(CARD-NAME-CHECK)) = 0               \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDNAME-NOT-OK   TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-NAME-MUST-BE-ALPHA  TO TRUE                             \n              END-IF                                                            \n              GO TO  1230-EDIT-NAME-EXIT                                        \n           END-IF                                                               \n                                                                                \n           SET FLG-CARDNAME-ISVALID     TO TRUE                                 \n           .",
            "description": "This paragraph validates the credit card embossed name input. It first checks if the name field is empty (blank, zeros, or low-values), setting appropriate error flags and prompting the user to enter a name if needed. Then it performs character validation by converting all alphabetic characters to spaces and checking if anything remains - ensuring only alphabetic characters and spaces are allowed in the name field. If non-alphabetic characters are found, it sets error flags and provides a specific error message. When validation passes, it sets a flag indicating the card name is valid. The paragraph includes conditional error message handling based on the current message display settings."
          },
          {
            "name": "1230-EDIT-NAME-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the name editing routine in the credit card update process. It marks the end of the name validation logic, allowing the program to continue with the next step in the card update workflow after name field processing is complete."
          },
          {
            "name": "1240-EDIT-CARDSTATUS",
            "code": "*    Must be Y or N                                                       \n           SET FLG-CARDSTATUS-NOT-OK      TO TRUE                               \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-CRDSTCD   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-CRDSTCD   EQUAL SPACES                                   \n           OR CCUP-NEW-CRDSTCD   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDSTATUS-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-STATUS-MUST-BE-YES-NO TO TRUE                         \n              END-IF                                                            \n              GO TO  1240-EDIT-CARDSTATUS-EXIT                                  \n           END-IF                                                               \n                                                                                \n           MOVE CCUP-NEW-CRDSTCD          TO FLG-YES-NO-CHECK                   \n                                                                                \n           IF FLG-YES-NO-VALID                                                  \n              SET FLG-CARDSTATUS-ISVALID  TO TRUE                               \n           ELSE                                                                 \n              SET INPUT-ERROR             TO TRUE                               \n              SET FLG-CARDSTATUS-NOT-OK   TO TRUE                               \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-STATUS-MUST-BE-YES-NO  TO TRUE                        \n              END-IF                                                            \n              GO TO  1240-EDIT-CARDSTATUS-EXIT                                  \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the card status input field in the credit card update process. It first checks if the card status value is provided, setting an error flag and appropriate message if the field is blank, spaces, or zeros. If a value is provided, it validates that the input is either 'Y' or 'N' by moving the input to a flag field and checking if it's valid. When validation fails, it sets error flags and a message indicating that card status must be either Yes or No. The paragraph includes conditional message handling based on the WS-RETURN-MSG-OFF flag, which controls whether error messages are displayed to the user. Valid inputs result in setting the FLG-CARDSTATUS-ISVALID flag before exiting the paragraph."
          },
          {
            "name": "1240-EDIT-CARDSTATUS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the CARDSTATUS field validation routine. It marks the end of the validation logic for the card status field, allowing the program flow to return to the calling section after the validation checks have been completed."
          },
          {
            "name": "1250-EDIT-EXPIRY-MON",
            "code": "SET FLG-CARDEXPMON-NOT-OK      TO TRUE                               \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-EXPMON   EQUAL LOW-VALUES                                \n           OR CCUP-NEW-EXPMON   EQUAL SPACES                                    \n           OR CCUP-NEW-EXPMON   EQUAL ZEROS                                     \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDEXPMON-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-MONTH-NOT-VALID TO TRUE                        \n              END-IF                                                            \n              GO TO  1250-EDIT-EXPIRY-MON-EXIT                                  \n           END-IF                                                               \n                                                                                \n      *    Must be numeric                                                      \n      *    Must be 1 to 12                                                      \n           MOVE CCUP-NEW-EXPMON           TO CARD-MONTH-CHECK                   \n                                                                                \n           IF VALID-MONTH                                                       \n              SET FLG-CARDEXPMON-ISVALID  TO TRUE                               \n           ELSE                                                                 \n              SET INPUT-ERROR             TO TRUE                               \n              SET FLG-CARDEXPMON-NOT-OK   TO TRUE                               \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-MONTH-NOT-VALID  TO TRUE                       \n              END-IF                                                            \n              GO TO  1250-EDIT-EXPIRY-MON-EXIT                                  \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the credit card expiration month entered by the user. It first sets a flag indicating the month is invalid by default. The validation checks if the month is blank or not supplied (spaces, zeros, or low-values), in which case it sets appropriate error flags and exits. If a value is provided, it moves the input to a check field and verifies it's a valid month (1-12) using a predefined condition. When validation fails, it sets error flags and, if message display is enabled, sets a specific error message flag for invalid expiration month. The paragraph maintains validation state through multiple flags that can be used by the calling routine to determine appropriate action."
          },
          {
            "name": "1250-EDIT-EXPIRY-MON-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the expiration month validation routine. It marks the end of the validation logic for the credit card expiration month field, allowing the program to continue with the next processing step after validation is complete."
          },
          {
            "name": "1260-EDIT-EXPIRY-YEAR",
            "code": "*    Not supplied                                                         \n           IF CCUP-NEW-EXPYEAR   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-EXPYEAR   EQUAL SPACES                                   \n           OR CCUP-NEW-EXPYEAR   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDEXPYEAR-BLANK  TO TRUE                                \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-YEAR-NOT-VALID TO TRUE                         \n              END-IF                                                            \n              GO TO  1260-EDIT-EXPIRY-YEAR-EXIT                                 \n           END-IF                                                               \n                                                                                \n      *    Must be numeric                                                      \n      *    Must be 1 to 12                                                      \n                                                                                \n           SET FLG-CARDEXPYEAR-NOT-OK      TO TRUE                              \n                                                                                \n           MOVE CCUP-NEW-EXPYEAR           TO CARD-YEAR-CHECK                   \n                                                                                \n           IF VALID-YEAR                                                        \n              SET FLG-CARDEXPYEAR-ISVALID  TO TRUE                              \n           ELSE                                                                 \n              SET INPUT-ERROR              TO TRUE                              \n              SET FLG-CARDEXPYEAR-NOT-OK   TO TRUE                              \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-YEAR-NOT-VALID  TO TRUE                        \n              END-IF                                                            \n              GO TO  1260-EDIT-EXPIRY-YEAR-EXIT                                 \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the expiration year field during credit card updates. It performs two key validation checks: first ensuring the field is not empty (not spaces, zeros, or low-values), and then verifying the year is numeric and within a valid range. If validation fails, it sets appropriate error flags (INPUT-ERROR and specific field error flags) and conditionally sets a user-friendly error message (CARD-EXPIRY-YEAR-NOT-VALID) if message display is enabled. The validation logic uses a VALID-YEAR condition, likely defined elsewhere, to determine if the supplied year meets business requirements. The paragraph exits immediately upon detecting any validation error, preventing further processing with invalid data."
          },
          {
            "name": "1260-EDIT-EXPIRY-YEAR-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the expiration year validation routine. It marks the end of the validation logic for the credit card expiration year field, allowing the program to return control to the calling section after completing the validation checks."
          },
          {
            "name": "2000-DECIDE-ACTION",
            "code": "EVALUATE TRUE                                                        \n      ******************************************************************        \n      *       NO DETAILS SHOWN.                                                 \n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN                          \n      ******************************************************************        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n      ******************************************************************        \n      *       CHANGES MADE. BUT USER CANCELS                                    \n      ******************************************************************        \n              WHEN CCARD-AID-PFK12                                              \n                 IF  FLG-ACCTFILTER-ISVALID                                     \n                 AND FLG-CARDFILTER-ISVALID                                     \n                     PERFORM 9000-READ-DATA                                     \n                        THRU 9000-READ-DATA-EXIT                                \n                     IF FOUND-CARDS-FOR-ACCOUNT                                 \n                        SET CCUP-SHOW-DETAILS    TO TRUE                        \n                     END-IF                                                     \n                 END-IF                                                         \n      ******************************************************************        \n      *       DETAILS SHOWN                                                     \n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD                        \n      ******************************************************************        \n              WHEN CCUP-SHOW-DETAILS                                            \n                 IF INPUT-ERROR                                                 \n                 OR NO-CHANGES-DETECTED                                         \n                    CONTINUE                                                    \n                 ELSE                                                           \n                    SET CCUP-CHANGES-OK-NOT-CONFIRMED TO TRUE                   \n                 END-IF                                                         \n      ******************************************************************        \n      *       DETAILS SHOWN                                                     \n      *       BUT INPUT EDIT ERRORS FOUND                                       \n      ******************************************************************        \n              WHEN CCUP-CHANGES-NOT-OK                                          \n                  CONTINUE                                                      \n      ******************************************************************        \n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 \n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES                            \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n               AND CCARD-AID-PFK05                                              \n                 PERFORM 9200-WRITE-PROCESSING                                  \n                    THRU 9200-WRITE-PROCESSING-EXIT                             \n                 EVALUATE TRUE                                                  \n                    WHEN COULD-NOT-LOCK-FOR-UPDATE                              \n                         SET CCUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE             \n                    WHEN LOCKED-BUT-UPDATE-FAILED                               \n                       SET CCUP-CHANGES-OKAYED-BUT-FAILED TO TRUE               \n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE                         \n                        SET CCUP-SHOW-DETAILS            TO TRUE                \n                    WHEN OTHER                                                  \n                       SET CCUP-CHANGES-OKAYED-AND-DONE   TO TRUE               \n                 END-EVALUATE                                                   \n      ******************************************************************        \n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 \n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN                     \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n                  CONTINUE                                                      \n      ******************************************************************        \n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1                            \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n                  SET CCUP-SHOW-DETAILS TO TRUE                                 \n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                      \n                  OR CDEMO-FROM-TRANID    EQUAL SPACES                          \n                     MOVE ZEROES       TO CDEMO-ACCT-ID                         \n                                          CDEMO-CARD-NUM                        \n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS                     \n                  END-IF                                                        \n              WHEN OTHER                                                        \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO ABEND-MSG                             \n                   PERFORM ABEND-ROUTINE                                        \n                      THRU ABEND-ROUTINE-EXIT                                   \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph implements the core decision logic for the credit card update process based on the current state of the transaction and user actions. It uses an EVALUATE statement to handle multiple workflow scenarios: initial data retrieval, handling user cancellations, validating changes, confirming updates, processing update confirmations, and handling update outcomes (including lock errors, update failures, and concurrent update conflicts). When updates are successfully completed, it resets account information if not called from another transaction. The paragraph maintains transaction state through status flags and includes error handling that will trigger an abend routine if an unexpected scenario is encountered. This logic ensures the update process follows a controlled path with appropriate validation and confirmation steps before committing changes to the database."
          },
          {
            "name": "2000-DECIDE-ACTION-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2000-DECIDE-ACTION section of the COCRDUPC program. It provides a clean termination point for the logic that determines what action to take based on user input when updating credit card details."
          },
          {
            "name": "3000-SEND-MAP",
            "code": "PERFORM 3100-SCREEN-INIT                                             \n              THRU 3100-SCREEN-INIT-EXIT                                        \n           PERFORM 3200-SETUP-SCREEN-VARS                                       \n              THRU 3200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 3250-SETUP-INFOMSG                                           \n              THRU 3250-SETUP-INFOMSG-EXIT                                      \n           PERFORM 3300-SETUP-SCREEN-ATTRS                                      \n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 3400-SEND-SCREEN                                             \n              THRU 3400-SEND-SCREEN-EXIT                                        \n           .",
            "description": "This paragraph orchestrates the preparation and display of the user interface for the credit card update transaction. It follows a structured sequence by first initializing the screen (3100-SCREEN-INIT), then setting up the screen variables with appropriate data values (3200-SETUP-SCREEN-VARS), preparing any informational messages for the user (3250-SETUP-INFOMSG), configuring the screen attributes for proper field display and interaction (3300-SETUP-SCREEN-ATTRS), and finally sending the completed screen to the terminal (3400-SEND-SCREEN). This modular approach separates the different aspects of screen preparation and display, making the code more maintainable and easier to troubleshoot."
          },
          {
            "name": "3000-SEND-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the SEND-MAP routine in the credit card update program. It provides a clean termination point for the routine that handles displaying information to the user interface, allowing the program to return control to its calling section after map display operations are complete."
          },
          {
            "name": "3100-SCREEN-INIT",
            "code": "MOVE LOW-VALUES TO CCRDUPAO                                          \n                                                                                \n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA                    \n                                                                                \n           MOVE CCDA-TITLE01              TO TITLE01O OF CCRDUPAO               \n           MOVE CCDA-TITLE02              TO TITLE02O OF CCRDUPAO               \n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CCRDUPAO               \n           MOVE LIT-THISPGM               TO PGMNAMEO OF CCRDUPAO               \n                                                                                \n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA                    \n                                                                                \n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM                      \n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD                      \n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY                      \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CCRDUPAO               \n                                                                                \n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH                      \n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM                      \n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS                      \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CCRDUPAO               \n                                                                                \n           .",
            "description": "This paragraph initializes the screen display for the credit card update transaction. It clears the output area (CCRDUPAO) by setting it to LOW-VALUES, then retrieves the current system date and time. The paragraph populates the screen header with application titles from the communication area, transaction ID, and program name. It formats the current date as MM/DD/YY and the current time as HH:MM:SS, then places these values in their respective screen fields. This initialization ensures the screen displays up-to-date information and proper identification headers before presenting card data to the user."
          },
          {
            "name": "3100-SCREEN-INIT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen initialization process in the COCRDUPC program. It provides a clean termination point for the 3100-SCREEN-INIT section, allowing the program flow to return to the calling routine after screen initialization tasks are completed."
          },
          {
            "name": "3200-SETUP-SCREEN-VARS",
            "code": "*    INITIALIZE SEARCH CRITERIA                                           \n           IF CDEMO-PGM-ENTER                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              IF CC-ACCT-ID-N = 0                                               \n                 MOVE LOW-VALUES          TO ACCTSIDO OF CCRDUPAO               \n              ELSE                                                              \n                 MOVE CC-ACCT-ID          TO ACCTSIDO OF CCRDUPAO               \n              END-IF                                                            \n                                                                                \n              IF CC-CARD-NUM-N = 0                                              \n                MOVE LOW-VALUES           TO CARDSIDO OF CCRDUPAO               \n              ELSE                                                              \n                MOVE CC-CARD-NUM          TO CARDSIDO OF CCRDUPAO               \n              END-IF                                                            \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN CCUP-DETAILS-NOT-FETCHED                                 \n                       MOVE LOW-VALUES         TO CRDNAMEO OF CCRDUPAO          \n                                                  CRDNAMEO OF CCRDUPAO          \n                                                  CRDSTCDO OF CCRDUPAO          \n                                                  EXPDAYO  OF CCRDUPAO          \n                                                  EXPMONO  OF CCRDUPAO          \n                                                  EXPYEARO OF CCRDUPAO          \n                  WHEN CCUP-SHOW-DETAILS                                        \n                      MOVE CCUP-OLD-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-OLD-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n                  WHEN CCUP-CHANGES-MADE                                        \n                      MOVE CCUP-NEW-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-NEW-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-NEW-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-NEW-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n      ******************************************************************        \n      *               MOVE OLD VALUES TO NON-DISPLAY FIELDS                     \n      *               THAT WE ARE NOT ALLOWING USER TO CHANGE(FOR NOW)          \n      *****************************************************************         \n      *               MOVE CCUP-NEW-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                  WHEN OTHER                                                    \n                      MOVE CCUP-OLD-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-OLD-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n              END-EVALUATE                                                      \n                                                                                \n                                                                                \n            END-IF                                                              \n           .",
            "description": "This paragraph initializes the screen variables for the credit card update interface based on the current program state. If the program is being entered for the first time, it continues without initialization. Otherwise, it populates the account ID and card number fields with either existing values or LOW-VALUES if they haven't been provided. The paragraph then uses an EVALUATE statement to handle different display scenarios: when card details haven't been fetched yet (clearing all fields), when showing existing details (displaying the original card information), when changes have been made (showing the updated values), or other cases (reverting to original values). Notably, there's a commented section indicating that the expiration day field is not editable by users, so the original value is always used regardless of any changes made to other fields."
          },
          {
            "name": "3200-SETUP-SCREEN-VARS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 3200-SETUP-SCREEN-VARS routine. It provides a clean termination point for the screen variable setup process, allowing the program to return control to the calling routine after completing the screen preparation tasks."
          },
          {
            "name": "3250-SETUP-INFOMSG",
            "code": "*    SETUP INFORMATION MESSAGE                                            \n           EVALUATE TRUE                                                        \n               WHEN CDEMO-PGM-ENTER                                             \n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE                         \n               WHEN CCUP-DETAILS-NOT-FETCHED                                    \n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE                      \n               WHEN CCUP-SHOW-DETAILS                                           \n                    SET FOUND-CARDS-FOR-ACCOUNT    TO TRUE                      \n               WHEN CCUP-CHANGES-NOT-OK                                         \n                    SET PROMPT-FOR-CHANGES         TO TRUE                      \n               WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                               \n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-AND-DONE                                \n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-LOCK-ERROR                              \n                    SET INFORM-FAILURE             TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-BUT-FAILED                              \n                    SET INFORM-FAILURE             TO TRUE                      \n               WHEN WS-NO-INFO-MESSAGE                                          \n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE                      \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CCRDUPAO          \n                                                                                \n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CCRDUPAO           \n           .",
            "description": "This paragraph handles the setup of information messages for the user interface based on the current state of the credit card update process. It evaluates various program states (such as initial entry, search results display, validation failures, confirmation requests, or update outcomes) and sets the appropriate message flag. Based on the program state, it determines what guidance or feedback should be displayed to the user - whether prompting for search criteria, requesting confirmation of changes, or reporting success/failure of update operations. The paragraph concludes by moving the selected information message and any error message to the output screen fields. This provides contextual feedback to users as they navigate through the card update workflow."
          },
          {
            "name": "3250-SETUP-INFOMSG-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the SETUP-INFOMSG routine at line 3250. It provides a simple termination point for the routine without performing any additional processing, allowing the program to return control to the calling section after information messages have been configured."
          },
          {
            "name": "3300-SETUP-SCREEN-ATTRS",
            "code": "*    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           EVALUATE TRUE                                                        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n                   MOVE DFHBMFSE      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                   MOVE DFHBMPRF      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN  CCUP-SHOW-DETAILS                                           \n              WHEN  CCUP-CHANGES-NOT-OK                                         \n                   MOVE DFHBMPRF      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                   MOVE DFHBMFSE      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n                                                                                \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n                   MOVE DFHBMPRF      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                                         CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN OTHER                                                        \n                   MOVE DFHBMFSE      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                   MOVE DFHBMPRF      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n           END-EVALUATE                                                         \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FOUND-CARDS-FOR-ACCOUNT                                      \n              WHEN NO-CHANGES-DETECTED                                          \n                  MOVE -1              TO CRDNAMEL OF CCRDUPAI                  \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CCRDUPAI                  \n              WHEN FLG-CARDFILTER-NOT-OK                                        \n              WHEN FLG-CARDFILTER-BLANK                                         \n                   MOVE -1             TO CARDSIDL OF CCRDUPAI                  \n              WHEN FLG-CARDNAME-NOT-OK                                          \n              WHEN FLG-CARDNAME-BLANK                                           \n                  MOVE -1              TO CRDNAMEL OF  CCRDUPAI                 \n              WHEN FLG-CARDSTATUS-NOT-OK                                        \n              WHEN FLG-CARDSTATUS-BLANK                                         \n                  MOVE -1              TO CRDSTCDL OF  CCRDUPAI                 \n              WHEN FLG-CARDEXPMON-NOT-OK                                        \n              WHEN FLG-CARDEXPMON-BLANK                                         \n                  MOVE -1              TO EXPMONL  OF  CCRDUPAI                 \n              WHEN FLG-CARDEXPYEAR-NOT-OK                                       \n              WHEN FLG-CARDEXPYEAR-BLANK                                        \n                  MOVE -1              TO EXPYEARL OF  CCRDUPAI                 \n              WHEN OTHER                                                        \n                  MOVE -1              TO ACCTSIDL OF CCRDUPAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET                        \n              MOVE DFHDFCOL            TO ACCTSIDC OF CCRDUPAO                  \n              MOVE DFHDFCOL            TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CCRDUPAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE DFHRED              TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO CARDSIDO OF CCRDUPAO                  \n               MOVE DFHRED             TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDNAME-NOT-OK                                               \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO CRDNAMEC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDNAME-BLANK                                               \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO CRDNAMEO OF CCRDUPAO                  \n               MOVE DFHRED             TO CRDNAMEC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDSTATUS-NOT-OK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO CRDSTCDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDSTATUS-BLANK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO CRDSTCDO OF CCRDUPAO                  \n               MOVE DFHRED             TO CRDSTCDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           MOVE DFHBMDAR               TO EXPDAYC  OF CCRDUPAO                  \n                                                                                \n           IF FLG-CARDEXPMON-NOT-OK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO EXPMONC  OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPMON-BLANK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO EXPMONO  OF CCRDUPAO                  \n               MOVE DFHRED             TO EXPMONC  OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPYEAR-NOT-OK                                           \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO EXPYEARC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPYEAR-BLANK                                            \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO EXPYEARO OF CCRDUPAO                  \n               MOVE DFHRED             TO EXPYEARC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGA OF CCRDUPAI                  \n           ELSE                                                                 \n               MOVE DFHBMBRY           TO INFOMSGA OF CCRDUPAI                  \n           END-IF                                                               \n                                                                                \n           IF PROMPT-FOR-CONFIRMATION                                           \n              MOVE DFHBMBRY            TO FKEYSCA  OF CCRDUPAI                  \n           END-IF                                                               \n           .",
            "description": "This paragraph manages the screen attributes for the credit card update interface based on the current processing state. It dynamically controls field protection status (protected or unprotected), cursor positioning, and visual formatting (colors and highlighting) to guide user interaction. The code uses EVALUATE statements to determine appropriate field attributes based on the transaction's current state - whether initial data entry, displaying fetched details, showing validation errors, or confirming changes. It positions the cursor intelligently on fields requiring attention, particularly on error fields when validation fails. The paragraph implements visual feedback by highlighting error fields in red and marking missing required fields with asterisks. It also handles special display conditions like darkening unavailable fields and brightening information messages when present. This logic ensures the user interface remains context-appropriate throughout the card update workflow."
          },
          {
            "name": "3300-SETUP-SCREEN-ATTRS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen attributes setup routine in the credit card update program. It marks the end of the process that configures display attributes for the user interface elements, allowing the program to return control to the calling section after screen formatting is complete."
          },
          {
            "name": "3400-SEND-SCREEN",
            "code": "MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CCRDUPAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the display of the credit card update screen to the user. It first sets the next map and mapset values in the communication area, then uses a CICS SEND MAP command to display the screen. The command sends the map defined in CCARD-NEXT-MAP from the CCRDUPAO data structure, positions the cursor appropriately, clears the screen (ERASE), and enables keyboard input (FREEKB). The response code from this operation is captured in WS-RESP-CD for error handling purposes."
          },
          {
            "name": "3400-SEND-SCREEN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen sending process in the credit card update program. It marks the end of the screen display routine, allowing the program to return control to the calling section after the user interface has been presented. This is a simple control flow marker that helps maintain the structured programming approach used throughout the COCRDUPC program."
          },
          {
            "name": "9000-READ-DATA",
            "code": "INITIALIZE CCUP-OLD-DETAILS                                          \n           MOVE CC-ACCT-ID              TO CCUP-OLD-ACCTID                      \n           MOVE CC-CARD-NUM             TO CCUP-OLD-CARDID                      \n                                                                                \n           PERFORM 9100-GETCARD-BYACCTCARD                                      \n              THRU 9100-GETCARD-BYACCTCARD-EXIT                                 \n                                                                                \n           IF FOUND-CARDS-FOR-ACCOUNT                                           \n                                                                                \n              MOVE CARD-CVV-CD          TO CCUP-OLD-CVV-CD                      \n                                                                                \n              INSPECT CARD-EMBOSSED-NAME                                        \n              CONVERTING LIT-LOWER                                              \n                      TO LIT-UPPER                                              \n                                                                                \n              MOVE CARD-EMBOSSED-NAME   TO CCUP-OLD-CRDNAME                     \n              MOVE CARD-EXPIRAION-DATE(1:4)                                     \n                                        TO CCUP-OLD-EXPYEAR                     \n              MOVE CARD-EXPIRAION-DATE(6:2)                                     \n                                        TO CCUP-OLD-EXPMON                      \n              MOVE CARD-EXPIRAION-DATE(9:2)                                     \n                                        TO CCUP-OLD-EXPDAY                      \n              MOVE CARD-ACTIVE-STATUS   TO CCUP-OLD-CRDSTCD                     \n                                                                                \n           END-IF                                                               \n           .",
            "description": "This paragraph initializes and populates the CCUP-OLD-DETAILS structure with credit card information retrieved from the database. It first clears the structure, then sets the account ID and card number from the communication area. The paragraph calls the 9100-GETCARD-BYACCTCARD routine to fetch the card record, and if found, extracts key card details including the CVV code, embossed name (converting lowercase to uppercase), expiration date (parsed into separate year, month, and day components), and active status. These values are stored in the \"OLD\" fields, establishing a baseline of the current card data before any updates are made, which will likely be used later for comparison or display purposes."
          },
          {
            "name": "9000-READ-DATA-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the data reading process in the credit card update program. It marks the end of the read operation logic, allowing the program to return control to the calling section after retrieving card details from the database."
          },
          {
            "name": "9100-GETCARD-BYACCTCARD",
            "code": "*    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  \n           MOVE CC-CARD-NUM             TO WS-CARD-RID-CARDNUM                  \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                    TO TRUE                    \n                  SET FLG-ACCTFILTER-NOT-OK          TO TRUE                    \n                  SET FLG-CARDFILTER-NOT-OK          TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                     SET DID-NOT-FIND-ACCTCARD-COMBO TO TRUE                    \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                    TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET FLG-ACCTFILTER-NOT-OK      TO TRUE                    \n                  END-IF                                                        \n                  MOVE 'READ'                        TO ERROR-OPNAME            \n                  MOVE LIT-CARDFILENAME              TO ERROR-FILE              \n                  MOVE WS-RESP-CD                    TO ERROR-RESP              \n                  MOVE WS-REAS-CD                    TO ERROR-RESP2             \n                  MOVE WS-FILE-ERROR-MESSAGE         TO WS-RETURN-MSG           \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph retrieves a credit card record from the card file using the card number as the key. It performs a CICS READ operation on the CARDFILENAME file using the card number stored in WS-CARD-RID-CARDNUM. The paragraph handles three possible outcomes: if the read is successful, it sets a flag indicating the card was found; if the record is not found, it sets error flags for both account and card filters and potentially sets a message indicating the account/card combination doesn't exist; for any other response code, it sets an input error flag, captures the error details (operation, file name, response codes), and prepares an error message. This paragraph is a critical validation step in the card update process, ensuring the requested card exists before allowing modifications."
          },
          {
            "name": "9100-GETCARD-BYACCTCARD-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the GETCARD-BYACCTCARD routine. It provides a clean termination point for the process that retrieves card details using account and card number as search criteria. The paragraph contains only the EXIT statement followed by a period, indicating the end of the logical processing block with no additional actions performed."
          },
          {
            "name": "9200-WRITE-PROCESSING",
            "code": "*    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  \n           MOVE CC-CARD-NUM             TO WS-CARD-RID-CARDNUM                  \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                UPDATE                                                          \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n      *****************************************************************         \n      *    Could we lock the record ?                                           \n      *****************************************************************         \n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)                               \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET INPUT-ERROR                    TO TRUE                        \n              IF  WS-RETURN-MSG-OFF                                             \n                  SET COULD-NOT-LOCK-FOR-UPDATE  TO TRUE                        \n              END-IF                                                            \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF                                                               \n      *****************************************************************         \n      *    Did someone change the record while we were out ?                    \n      *****************************************************************         \n           PERFORM 9300-CHECK-CHANGE-IN-REC                                     \n              THRU 9300-CHECK-CHANGE-IN-REC-EXIT                                \n           IF DATA-WAS-CHANGED-BEFORE-UPDATE                                    \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF                                                               \n      *****************************************************************         \n      * Prepare the update                                                      \n      *****************************************************************         \n           INITIALIZE CARD-UPDATE-RECORD                                        \n           MOVE CCUP-NEW-CARDID             TO CARD-UPDATE-NUM                  \n           MOVE CC-ACCT-ID-N                TO CARD-UPDATE-ACCT-ID              \n           MOVE CCUP-NEW-CVV-CD             TO CARD-CVV-CD-X                    \n           MOVE CARD-CVV-CD-N               TO CARD-UPDATE-CVV-CD               \n           MOVE CCUP-NEW-CRDNAME            TO CARD-UPDATE-EMBOSSED-NAME        \n           STRING  CCUP-NEW-EXPYEAR                                             \n                   '-'                                                          \n                   CCUP-NEW-EXPMON                                              \n                   '-'                                                          \n                   CCUP-NEW-EXPDAY                                              \n                   DELIMITED BY SIZE                                            \n              INTO CARD-UPDATE-EXPIRAION-DATE                                   \n           END-STRING                                                           \n           MOVE CCUP-NEW-CRDSTCD            TO CARD-UPDATE-ACTIVE-STATUS        \n                                                                                \n           EXEC CICS                                                            \n                REWRITE FILE(LIT-CARDFILENAME)                                  \n                        FROM(CARD-UPDATE-RECORD)                                \n                        LENGTH(LENGTH OF CARD-UPDATE-RECORD)                    \n                        RESP      (WS-RESP-CD)                                  \n                        RESP2     (WS-REAS-CD)                                  \n           END-EXEC.                                                            \n                                                                                \n      *****************************************************************         \n      * Did the update succeed ?  *                                             \n      *****************************************************************         \n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)                               \n             CONTINUE                                                           \n           ELSE                                                                 \n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE                            \n           END-IF                                                               \n           .",
            "description": "This paragraph handles the critical update process for credit card records. It first attempts to read and lock the card record using the card number as the key. If the lock is successful, it checks if the record has been modified by another user since it was initially retrieved (via the 9300-CHECK-CHANGE-IN-REC paragraph). If no concurrent modification is detected, it prepares the update by initializing a CARD-UPDATE-RECORD structure and populating it with the new values from the user input, including card ID, CVV code, embossed name, expiration date, and active status. The paragraph then attempts to rewrite the record to the card file and checks if the update was successful. Error handling is implemented for lock failures and update failures, with appropriate status flags set to communicate the outcome back to the calling process."
          },
          {
            "name": "9200-WRITE-PROCESSING-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the write processing routine in the COCRDUPC program. It provides a clean termination point for the write processing logic, allowing the program flow to return to the calling section after database update operations are completed."
          },
          {
            "name": "9300-CHECK-CHANGE-IN-REC",
            "code": "INSPECT CARD-EMBOSSED-NAME                                           \n           CONVERTING LIT-LOWER                                                 \n                   TO LIT-UPPER                                                 \n                                                                                \n           IF  CARD-CVV-CD              EQUAL  TO CCUP-OLD-CVV-CD               \n           AND CARD-EMBOSSED-NAME       EQUAL  TO CCUP-OLD-CRDNAME              \n           AND CARD-EXPIRAION-DATE(1:4) EQUAL  TO CCUP-OLD-EXPYEAR              \n           AND CARD-EXPIRAION-DATE(6:2) EQUAL  TO CCUP-OLD-EXPMON               \n           AND CARD-EXPIRAION-DATE(9:2) EQUAL  TO CCUP-OLD-EXPDAY               \n           AND CARD-ACTIVE-STATUS       EQUAL  TO CCUP-OLD-CRDSTCD              \n               CONTINUE                                                         \n           ELSE                                                                 \n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE                        \n              MOVE CARD-CVV-CD                 TO CCUP-OLD-CVV-CD               \n              MOVE CARD-EMBOSSED-NAME          TO CCUP-OLD-CRDNAME              \n              MOVE CARD-EXPIRAION-DATE(1:4)    TO CCUP-OLD-EXPYEAR              \n              MOVE CARD-EXPIRAION-DATE(6:2)    TO CCUP-OLD-EXPMON               \n              MOVE CARD-EXPIRAION-DATE(9:2)    TO CCUP-OLD-EXPDAY               \n              MOVE CARD-ACTIVE-STATUS          TO CCUP-OLD-CRDSTCD              \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF EXIT                                                          \n           .",
            "description": "This paragraph checks if the card record has been modified by another user since it was initially retrieved. It first converts the embossed name to uppercase for consistent comparison. Then it compares all current card details (CVV code, embossed name, expiration date components, and active status) with the values that were originally read. If all fields match, processing continues normally. If any field has changed, indicating concurrent modification by another user, it sets a flag indicating data was changed before update, updates the stored \"old\" values with the current values from the database, and exits the current processing flow by branching to the write processing exit paragraph. This prevents overwriting changes made by other users and maintains data integrity in a multi-user environment."
          },
          {
            "name": "9300-CHECK-CHANGE-IN-REC-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n      ******************************************************************        \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .                                                           \n                                                                        340000",
            "description": "This paragraph serves as an exit point for the record change verification process in the credit card update functionality. It includes a call to the 'CSSTRPFY' copybook, which contains common code for storing PF key information. This structure helps maintain consistent handling of function key inputs across the application while properly terminating the current processing logic."
          },
          {
            "name": "ABEND-ROUTINE",
            "code": "IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n                            ERASE                                               \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles abnormal termination (abend) processing in the credit card update program. It first checks if an error message has been set, and if not, assigns a default \"unexpected abend\" message. It then identifies the current program as the source of the error, displays the abend information to the user with a screen clear, cancels any existing abend handlers to prevent recursive error handling, and finally forces a controlled termination with abend code '9999'. This ensures that when unexpected errors occur during card update operations, the system fails gracefully with appropriate user notification rather than continuing with potentially corrupted data."
          },
          {
            "name": "ABEND-ROUTINE-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *",
            "description": "This paragraph serves as the exit point for the ABEND-ROUTINE section in the COCRDUPC program. It marks the end of the abend handling logic with a simple EXIT statement. The paragraph includes version control information showing this code is part of CardDemo version 1.0-15-g27d6c6f-68, dated July 19, 2022."
          }
        ],
        "code": "0000-MAIN.                                                               \n                                                                                \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM                             \n               AND NOT CDEMO-PGM-REENTER)                                       \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n              SET CDEMO-PGM-ENTER TO TRUE                                       \n              SET CCUP-DETAILS-NOT-FETCHED TO TRUE                              \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              (CCARD-AID-PFK05 AND CCUP-CHANGES-OK-NOT-CONFIRMED)               \n                              OR                                                \n              (CCARD-AID-PFK12 AND NOT CCUP-DETAILS-NOT-FETCHED)                \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n      ******************************************************************        \n      *       USER PRESSES PF03 TO EXIT                                         \n      *  OR   USER IS DONE WITH UPDATE                                          \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n              WHEN CCARD-AID-PFK03                                              \n              WHEN (CCUP-CHANGES-OKAYED-AND-DONE                                \n               AND  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET)                 \n              WHEN (CCUP-CHANGES-FAILED                                         \n               AND  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET)                 \n                   SET CCARD-AID-PFK03     TO TRUE                              \n                                                                                \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                                                                                \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   IF CDEMO-LAST-MAPSET    EQUAL LIT-CCLISTMAPSET               \n                       MOVE ZEROS          TO CDEMO-ACCT-ID                     \n                                              CDEMO-CARD-NUM                    \n                   END-IF                                                       \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n                                                                                \n                   EXEC CICS                                                    \n                        SYNCPOINT                                               \n                   END-EXEC                                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CDEMO-TO-PROGRAM)                              \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      ******************************************************************        \n      *       USER CAME FROM CREDIT CARD LIST SCREEN                            \n      *            SO WE ALREADY HAVE THE FILTER KEYS                           \n      *            FETCH THE ASSSOCIATED CARD DETAILS FOR UPDATE                \n      ******************************************************************        \n              WHEN CDEMO-PGM-ENTER                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n              WHEN CCARD-AID-PFK12                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n                   SET CDEMO-PGM-REENTER    TO TRUE                             \n                   SET INPUT-OK             TO TRUE                             \n                   SET FLG-ACCTFILTER-ISVALID  TO TRUE                          \n                   SET FLG-CARDFILTER-ISVALID  TO TRUE                          \n                   MOVE CDEMO-ACCT-ID       TO CC-ACCT-ID-N                     \n                   MOVE CDEMO-CARD-NUM      TO CC-CARD-NUM-N                    \n                   PERFORM 9000-READ-DATA                                       \n                      THRU 9000-READ-DATA-EXIT                                  \n                   SET CCUP-SHOW-DETAILS TO TRUE                                \n                   PERFORM 3000-SEND-MAP                                        \n                      THRU 3000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *       FRESH ENTRY INTO PROGRAM                                          \n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED        \n      ******************************************************************        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n               AND CDEMO-PGM-ENTER                                              \n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM                       \n               AND NOT CDEMO-PGM-REENTER                                        \n                   INITIALIZE WS-THIS-PROGCOMMAREA                              \n                   PERFORM 3000-SEND-MAP THRU                                   \n                           3000-SEND-MAP-EXIT                                   \n                   SET CDEMO-PGM-REENTER        TO TRUE                         \n                   SET CCUP-DETAILS-NOT-FETCHED TO TRUE                         \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *       CARD DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY           \n      *            RESET THE SEARCH KEYS                                        \n      *            ASK THE USER FOR FRESH SEARCH CRITERIA                       \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n              WHEN CCUP-CHANGES-FAILED                                          \n                   INITIALIZE WS-THIS-PROGCOMMAREA                              \n                              WS-MISC-STORAGE                                   \n                              CDEMO-ACCT-ID                                     \n                              CDEMO-CARD-NUM                                    \n                   SET CDEMO-PGM-ENTER            TO TRUE                       \n                   PERFORM 3000-SEND-MAP THRU                                   \n                           3000-SEND-MAP-EXIT                                   \n                   SET CDEMO-PGM-REENTER          TO TRUE                       \n                   SET CCUP-DETAILS-NOT-FETCHED   TO TRUE                       \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *      CARD DATA HAS BEEN PRESENTED TO USER                               \n      *            CHECK THE USER INPUTS                                        \n      *            DECIDE WHAT TO DO                                            \n      *            PRESENT NEXT STEPS TO USER                                   \n      ******************************************************************        \n              WHEN OTHER                                                        \n                   PERFORM 1000-PROCESS-INPUTS                                  \n                      THRU 1000-PROCESS-INPUTS-EXIT                             \n                   PERFORM 2000-DECIDE-ACTION                                   \n                      THRU 2000-DECIDE-ACTION-EXIT                              \n                   PERFORM 3000-SEND-MAP                                        \n                      THRU 3000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n           END-EVALUATE                                                         \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1000-PROCESS-INPUTS.                                                     \n           PERFORM 1100-RECEIVE-MAP                                             \n              THRU 1100-RECEIVE-MAP-EXIT                                        \n           PERFORM 1200-EDIT-MAP-INPUTS                                         \n              THRU 1200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .                                                                    \n                                                                                \n       1000-PROCESS-INPUTS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n       1100-RECEIVE-MAP.                                                        \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CCRDUPAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CCUP-NEW-DETAILS                                          \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CCRDUPAI = '*'                                       \n           OR  ACCTSIDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n                                             CCUP-NEW-ACCTID                    \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CCRDUPAI TO  CC-ACCT-ID                         \n                                             CCUP-NEW-ACCTID                    \n           END-IF                                                               \n                                                                                \n           IF  CARDSIDI OF CCRDUPAI = '*'                                       \n           OR  CARDSIDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-CARD-NUM                        \n                                             CCUP-NEW-CARDID                    \n           ELSE                                                                 \n               MOVE CARDSIDI OF CCRDUPAI TO  CC-CARD-NUM                        \n                                             CCUP-NEW-CARDID                    \n           END-IF                                                               \n                                                                                \n           IF  CRDNAMEI OF CCRDUPAI = '*'                                       \n           OR  CRDNAMEI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-CRDNAME                   \n           ELSE                                                                 \n               MOVE CRDNAMEI OF CCRDUPAI TO  CCUP-NEW-CRDNAME                   \n           END-IF                                                               \n                                                                                \n           IF  CRDSTCDI OF CCRDUPAI = '*'                                       \n           OR  CRDSTCDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-CRDSTCD                   \n           ELSE                                                                 \n               MOVE CRDSTCDI OF CCRDUPAI TO  CCUP-NEW-CRDSTCD                   \n           END-IF                                                               \n                                                                                \n           MOVE EXPDAYI     OF CCRDUPAI  TO  CCUP-NEW-EXPDAY                    \n                                                                                \n           IF  EXPMONI OF CCRDUPAI = '*'                                        \n           OR  EXPMONI OF CCRDUPAI = SPACES                                     \n               MOVE LOW-VALUES           TO  CCUP-NEW-EXPMON                    \n           ELSE                                                                 \n               MOVE EXPMONI OF CCRDUPAI  TO  CCUP-NEW-EXPMON                    \n           END-IF                                                               \n                                                                                \n           IF  EXPYEARI OF CCRDUPAI = '*'                                       \n           OR  EXPYEARI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-EXPYEAR                   \n           ELSE                                                                 \n               MOVE EXPYEARI OF CCRDUPAI TO  CCUP-NEW-EXPYEAR                   \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1100-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       1200-EDIT-MAP-INPUTS.                                                    \n                                                                                \n           SET INPUT-OK                  TO TRUE                                \n                                                                                \n           IF  CCUP-DETAILS-NOT-FETCHED                                         \n      *        VALIDATE THE SEARCH KEYS                                         \n               PERFORM 1210-EDIT-ACCOUNT                                        \n                  THRU 1210-EDIT-ACCOUNT-EXIT                                   \n                                                                                \n               PERFORM 1220-EDIT-CARD                                           \n                  THRU 1220-EDIT-CARD-EXIT                                      \n                                                                                \n               MOVE LOW-VALUES                 TO CCUP-NEW-CARDDATA             \n                                                                                \n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS SKIP OTHER EDITS           \n               IF  FLG-ACCTFILTER-BLANK                                         \n               AND FLG-CARDFILTER-BLANK                                         \n                   SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                      \n               END-IF                                                           \n                                                                                \n               GO TO 1200-EDIT-MAP-INPUTS-EXIT                                  \n                                                                                \n           ELSE                                                                 \n               CONTINUE                                                         \n           END-IF                                                               \n                                                                                \n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED                       \n           SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                                  \n           SET FLG-ACCTFILTER-ISVALID  TO TRUE                                  \n           SET FLG-CARDFILTER-ISVALID  TO TRUE                                  \n           MOVE CCUP-OLD-ACCTID     TO CDEMO-ACCT-ID                            \n           MOVE CCUP-OLD-CARDID     TO CDEMO-CARD-NUM                           \n           MOVE CCUP-OLD-CRDNAME    TO CARD-EMBOSSED-NAME                       \n           MOVE CCUP-OLD-CRDSTCD    TO CARD-ACTIVE-STATUS                       \n           MOVE CCUP-OLD-EXPDAY     TO CARD-EXPIRY-DAY                          \n           MOVE CCUP-OLD-EXPMON     TO CARD-EXPIRY-MONTH                        \n           MOVE CCUP-OLD-EXPYEAR    TO CARD-EXPIRY-YEAR                         \n                                                                                \n      *    NEW DATA IS SAME AS OLD DATA                                         \n           IF  (FUNCTION UPPER-CASE(CCUP-NEW-CARDDATA) EQUAL                    \n                FUNCTION UPPER-CASE(CCUP-OLD-CARDDATA))                         \n               SET NO-CHANGES-DETECTED TO TRUE                                  \n           END-IF                                                               \n                                                                                \n           IF  NO-CHANGES-DETECTED                                              \n           OR  CCUP-CHANGES-OK-NOT-CONFIRMED                                    \n           OR  CCUP-CHANGES-OKAYED-AND-DONE                                     \n               SET FLG-CARDNAME-ISVALID    TO TRUE                              \n               SET FLG-CARDSTATUS-ISVALID  TO TRUE                              \n               SET FLG-CARDEXPMON-ISVALID  TO TRUE                              \n               SET FLG-CARDEXPYEAR-ISVALID TO TRUE                              \n               GO TO 1200-EDIT-MAP-INPUTS-EXIT                                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           SET CCUP-CHANGES-NOT-OK    TO TRUE                                   \n                                                                                \n           PERFORM 1230-EDIT-NAME                                               \n              THRU 1230-EDIT-NAME-EXIT                                          \n                                                                                \n           PERFORM 1240-EDIT-CARDSTATUS                                         \n              THRU 1240-EDIT-CARDSTATUS-EXIT                                    \n                                                                                \n           PERFORM 1250-EDIT-EXPIRY-MON                                         \n              THRU 1250-EDIT-EXPIRY-MON-EXIT                                    \n                                                                                \n           PERFORM 1260-EDIT-EXPIRY-YEAR                                        \n              THRU 1260-EDIT-EXPIRY-YEAR-EXIT                                   \n                                                                                \n           IF INPUT-ERROR                                                       \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CCUP-CHANGES-OK-NOT-CONFIRMED TO TRUE                         \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1200-EDIT-MAP-INPUTS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              MOVE LOW-VALUES   TO CCUP-NEW-ACCTID                              \n              GO TO  1210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              MOVE LOW-VALUES TO CCUP-NEW-ACCTID                                \n              GO TO 1210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n                                 CCUP-NEW-ACCTID                                \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-CARD TO TRUE                                 \n              END-IF                                                            \n                                                                                \n              MOVE ZEROES        TO CDEMO-CARD-NUM                              \n                                   CCUP-NEW-CARDID                              \n              GO TO  1220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                                 TO WS-RETURN-MSG                               \n              END-IF                                                            \n              MOVE ZERO          TO CDEMO-CARD-NUM                              \n              MOVE LOW-VALUES    TO CCUP-NEW-CARDID                             \n              GO TO 1220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              MOVE CC-CARD-NUM   TO CCUP-NEW-CARDID                             \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1230-EDIT-NAME.                                                          \n      *    Not BLANK                                                            \n           SET FLG-CARDNAME-NOT-OK      TO TRUE                                 \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-CRDNAME   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-CRDNAME   EQUAL SPACES                                   \n           OR CCUP-NEW-CRDNAME   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDNAME-BLANK  TO TRUE                                   \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-NAME TO TRUE                                 \n              END-IF                                                            \n              GO TO  1230-EDIT-NAME-EXIT                                        \n           END-IF                                                               \n                                                                                \n      *    Only Alphabets and space allowed                                     \n           MOVE CCUP-NEW-CRDNAME        TO CARD-NAME-CHECK                      \n           INSPECT CARD-NAME-CHECK                                              \n             CONVERTING LIT-ALL-ALPHA-FROM                                      \n                     TO LIT-ALL-SPACES-TO                                       \n                                                                                \n           IF FUNCTION LENGTH(FUNCTION TRIM(CARD-NAME-CHECK)) = 0               \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDNAME-NOT-OK   TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-NAME-MUST-BE-ALPHA  TO TRUE                             \n              END-IF                                                            \n              GO TO  1230-EDIT-NAME-EXIT                                        \n           END-IF                                                               \n                                                                                \n           SET FLG-CARDNAME-ISVALID     TO TRUE                                 \n           .                                                                    \n       1230-EDIT-NAME-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1240-EDIT-CARDSTATUS.                                                    \n      *    Must be Y or N                                                       \n           SET FLG-CARDSTATUS-NOT-OK      TO TRUE                               \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-CRDSTCD   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-CRDSTCD   EQUAL SPACES                                   \n           OR CCUP-NEW-CRDSTCD   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDSTATUS-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-STATUS-MUST-BE-YES-NO TO TRUE                         \n              END-IF                                                            \n              GO TO  1240-EDIT-CARDSTATUS-EXIT                                  \n           END-IF                                                               \n                                                                                \n           MOVE CCUP-NEW-CRDSTCD          TO FLG-YES-NO-CHECK                   \n                                                                                \n           IF FLG-YES-NO-VALID                                                  \n              SET FLG-CARDSTATUS-ISVALID  TO TRUE                               \n           ELSE                                                                 \n              SET INPUT-ERROR             TO TRUE                               \n              SET FLG-CARDSTATUS-NOT-OK   TO TRUE                               \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-STATUS-MUST-BE-YES-NO  TO TRUE                        \n              END-IF                                                            \n              GO TO  1240-EDIT-CARDSTATUS-EXIT                                  \n           END-IF                                                               \n           .                                                                    \n       1240-EDIT-CARDSTATUS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n       1250-EDIT-EXPIRY-MON.                                                    \n                                                                                \n                                                                                \n           SET FLG-CARDEXPMON-NOT-OK      TO TRUE                               \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-EXPMON   EQUAL LOW-VALUES                                \n           OR CCUP-NEW-EXPMON   EQUAL SPACES                                    \n           OR CCUP-NEW-EXPMON   EQUAL ZEROS                                     \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDEXPMON-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-MONTH-NOT-VALID TO TRUE                        \n              END-IF                                                            \n              GO TO  1250-EDIT-EXPIRY-MON-EXIT                                  \n           END-IF                                                               \n                                                                                \n      *    Must be numeric                                                      \n      *    Must be 1 to 12                                                      \n           MOVE CCUP-NEW-EXPMON           TO CARD-MONTH-CHECK                   \n                                                                                \n           IF VALID-MONTH                                                       \n              SET FLG-CARDEXPMON-ISVALID  TO TRUE                               \n           ELSE                                                                 \n              SET INPUT-ERROR             TO TRUE                               \n              SET FLG-CARDEXPMON-NOT-OK   TO TRUE                               \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-MONTH-NOT-VALID  TO TRUE                       \n              END-IF                                                            \n              GO TO  1250-EDIT-EXPIRY-MON-EXIT                                  \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1250-EDIT-EXPIRY-MON-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n       1260-EDIT-EXPIRY-YEAR.                                                   \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-EXPYEAR   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-EXPYEAR   EQUAL SPACES                                   \n           OR CCUP-NEW-EXPYEAR   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDEXPYEAR-BLANK  TO TRUE                                \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-YEAR-NOT-VALID TO TRUE                         \n              END-IF                                                            \n              GO TO  1260-EDIT-EXPIRY-YEAR-EXIT                                 \n           END-IF                                                               \n                                                                                \n      *    Must be numeric                                                      \n      *    Must be 1 to 12                                                      \n                                                                                \n           SET FLG-CARDEXPYEAR-NOT-OK      TO TRUE                              \n                                                                                \n           MOVE CCUP-NEW-EXPYEAR           TO CARD-YEAR-CHECK                   \n                                                                                \n           IF VALID-YEAR                                                        \n              SET FLG-CARDEXPYEAR-ISVALID  TO TRUE                              \n           ELSE                                                                 \n              SET INPUT-ERROR              TO TRUE                              \n              SET FLG-CARDEXPYEAR-NOT-OK   TO TRUE                              \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-YEAR-NOT-VALID  TO TRUE                        \n              END-IF                                                            \n              GO TO  1260-EDIT-EXPIRY-YEAR-EXIT                                 \n           END-IF                                                               \n           .                                                                    \n       1260-EDIT-EXPIRY-YEAR-EXIT.                                              \n           EXIT                                                                 \n           .                                                                    \n       2000-DECIDE-ACTION.                                                      \n           EVALUATE TRUE                                                        \n      ******************************************************************        \n      *       NO DETAILS SHOWN.                                                 \n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN                          \n      ******************************************************************        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n      ******************************************************************        \n      *       CHANGES MADE. BUT USER CANCELS                                    \n      ******************************************************************        \n              WHEN CCARD-AID-PFK12                                              \n                 IF  FLG-ACCTFILTER-ISVALID                                     \n                 AND FLG-CARDFILTER-ISVALID                                     \n                     PERFORM 9000-READ-DATA                                     \n                        THRU 9000-READ-DATA-EXIT                                \n                     IF FOUND-CARDS-FOR-ACCOUNT                                 \n                        SET CCUP-SHOW-DETAILS    TO TRUE                        \n                     END-IF                                                     \n                 END-IF                                                         \n      ******************************************************************        \n      *       DETAILS SHOWN                                                     \n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD                        \n      ******************************************************************        \n              WHEN CCUP-SHOW-DETAILS                                            \n                 IF INPUT-ERROR                                                 \n                 OR NO-CHANGES-DETECTED                                         \n                    CONTINUE                                                    \n                 ELSE                                                           \n                    SET CCUP-CHANGES-OK-NOT-CONFIRMED TO TRUE                   \n                 END-IF                                                         \n      ******************************************************************        \n      *       DETAILS SHOWN                                                     \n      *       BUT INPUT EDIT ERRORS FOUND                                       \n      ******************************************************************        \n              WHEN CCUP-CHANGES-NOT-OK                                          \n                  CONTINUE                                                      \n      ******************************************************************        \n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 \n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES                            \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n               AND CCARD-AID-PFK05                                              \n                 PERFORM 9200-WRITE-PROCESSING                                  \n                    THRU 9200-WRITE-PROCESSING-EXIT                             \n                 EVALUATE TRUE                                                  \n                    WHEN COULD-NOT-LOCK-FOR-UPDATE                              \n                         SET CCUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE             \n                    WHEN LOCKED-BUT-UPDATE-FAILED                               \n                       SET CCUP-CHANGES-OKAYED-BUT-FAILED TO TRUE               \n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE                         \n                        SET CCUP-SHOW-DETAILS            TO TRUE                \n                    WHEN OTHER                                                  \n                       SET CCUP-CHANGES-OKAYED-AND-DONE   TO TRUE               \n                 END-EVALUATE                                                   \n      ******************************************************************        \n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 \n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN                     \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n                  CONTINUE                                                      \n      ******************************************************************        \n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1                            \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n                  SET CCUP-SHOW-DETAILS TO TRUE                                 \n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                      \n                  OR CDEMO-FROM-TRANID    EQUAL SPACES                          \n                     MOVE ZEROES       TO CDEMO-ACCT-ID                         \n                                          CDEMO-CARD-NUM                        \n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS                     \n                  END-IF                                                        \n              WHEN OTHER                                                        \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO ABEND-MSG                             \n                   PERFORM ABEND-ROUTINE                                        \n                      THRU ABEND-ROUTINE-EXIT                                   \n           END-EVALUATE                                                         \n           .                                                                    \n       2000-DECIDE-ACTION-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n                                                                                \n       3000-SEND-MAP.                                                           \n           PERFORM 3100-SCREEN-INIT                                             \n              THRU 3100-SCREEN-INIT-EXIT                                        \n           PERFORM 3200-SETUP-SCREEN-VARS                                       \n              THRU 3200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 3250-SETUP-INFOMSG                                           \n              THRU 3250-SETUP-INFOMSG-EXIT                                      \n           PERFORM 3300-SETUP-SCREEN-ATTRS                                      \n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 3400-SEND-SCREEN                                             \n              THRU 3400-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       3000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       3100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES TO CCRDUPAO                                          \n                                                                                \n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA                    \n                                                                                \n           MOVE CCDA-TITLE01              TO TITLE01O OF CCRDUPAO               \n           MOVE CCDA-TITLE02              TO TITLE02O OF CCRDUPAO               \n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CCRDUPAO               \n           MOVE LIT-THISPGM               TO PGMNAMEO OF CCRDUPAO               \n                                                                                \n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA                    \n                                                                                \n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM                      \n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD                      \n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY                      \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CCRDUPAO               \n                                                                                \n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH                      \n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM                      \n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS                      \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CCRDUPAO               \n                                                                                \n           .                                                                    \n                                                                                \n       3100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       3200-SETUP-SCREEN-VARS.                                                  \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF CDEMO-PGM-ENTER                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              IF CC-ACCT-ID-N = 0                                               \n                 MOVE LOW-VALUES          TO ACCTSIDO OF CCRDUPAO               \n              ELSE                                                              \n                 MOVE CC-ACCT-ID          TO ACCTSIDO OF CCRDUPAO               \n              END-IF                                                            \n                                                                                \n              IF CC-CARD-NUM-N = 0                                              \n                MOVE LOW-VALUES           TO CARDSIDO OF CCRDUPAO               \n              ELSE                                                              \n                MOVE CC-CARD-NUM          TO CARDSIDO OF CCRDUPAO               \n              END-IF                                                            \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN CCUP-DETAILS-NOT-FETCHED                                 \n                       MOVE LOW-VALUES         TO CRDNAMEO OF CCRDUPAO          \n                                                  CRDNAMEO OF CCRDUPAO          \n                                                  CRDSTCDO OF CCRDUPAO          \n                                                  EXPDAYO  OF CCRDUPAO          \n                                                  EXPMONO  OF CCRDUPAO          \n                                                  EXPYEARO OF CCRDUPAO          \n                  WHEN CCUP-SHOW-DETAILS                                        \n                      MOVE CCUP-OLD-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-OLD-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n                  WHEN CCUP-CHANGES-MADE                                        \n                      MOVE CCUP-NEW-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-NEW-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-NEW-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-NEW-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n      ******************************************************************        \n      *               MOVE OLD VALUES TO NON-DISPLAY FIELDS                     \n      *               THAT WE ARE NOT ALLOWING USER TO CHANGE(FOR NOW)          \n      *****************************************************************         \n      *               MOVE CCUP-NEW-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                  WHEN OTHER                                                    \n                      MOVE CCUP-OLD-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-OLD-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n              END-EVALUATE                                                      \n                                                                                \n                                                                                \n            END-IF                                                              \n           .                                                                    \n       3200-SETUP-SCREEN-VARS-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       3250-SETUP-INFOMSG.                                                      \n      *    SETUP INFORMATION MESSAGE                                            \n           EVALUATE TRUE                                                        \n               WHEN CDEMO-PGM-ENTER                                             \n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE                         \n               WHEN CCUP-DETAILS-NOT-FETCHED                                    \n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE                      \n               WHEN CCUP-SHOW-DETAILS                                           \n                    SET FOUND-CARDS-FOR-ACCOUNT    TO TRUE                      \n               WHEN CCUP-CHANGES-NOT-OK                                         \n                    SET PROMPT-FOR-CHANGES         TO TRUE                      \n               WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                               \n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-AND-DONE                                \n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-LOCK-ERROR                              \n                    SET INFORM-FAILURE             TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-BUT-FAILED                              \n                    SET INFORM-FAILURE             TO TRUE                      \n               WHEN WS-NO-INFO-MESSAGE                                          \n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE                      \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CCRDUPAO          \n                                                                                \n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CCRDUPAO           \n           .                                                                    \n       3250-SETUP-INFOMSG-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n       3300-SETUP-SCREEN-ATTRS.                                                 \n                                                                                \n                                                                                \n      *    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           EVALUATE TRUE                                                        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n                   MOVE DFHBMFSE      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                   MOVE DFHBMPRF      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN  CCUP-SHOW-DETAILS                                           \n              WHEN  CCUP-CHANGES-NOT-OK                                         \n                   MOVE DFHBMPRF      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                   MOVE DFHBMFSE      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n                                                                                \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n                   MOVE DFHBMPRF      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                                         CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN OTHER                                                        \n                   MOVE DFHBMFSE      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                   MOVE DFHBMPRF      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n           END-EVALUATE                                                         \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FOUND-CARDS-FOR-ACCOUNT                                      \n              WHEN NO-CHANGES-DETECTED                                          \n                  MOVE -1              TO CRDNAMEL OF CCRDUPAI                  \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CCRDUPAI                  \n              WHEN FLG-CARDFILTER-NOT-OK                                        \n              WHEN FLG-CARDFILTER-BLANK                                         \n                   MOVE -1             TO CARDSIDL OF CCRDUPAI                  \n              WHEN FLG-CARDNAME-NOT-OK                                          \n              WHEN FLG-CARDNAME-BLANK                                           \n                  MOVE -1              TO CRDNAMEL OF  CCRDUPAI                 \n              WHEN FLG-CARDSTATUS-NOT-OK                                        \n              WHEN FLG-CARDSTATUS-BLANK                                         \n                  MOVE -1              TO CRDSTCDL OF  CCRDUPAI                 \n              WHEN FLG-CARDEXPMON-NOT-OK                                        \n              WHEN FLG-CARDEXPMON-BLANK                                         \n                  MOVE -1              TO EXPMONL  OF  CCRDUPAI                 \n              WHEN FLG-CARDEXPYEAR-NOT-OK                                       \n              WHEN FLG-CARDEXPYEAR-BLANK                                        \n                  MOVE -1              TO EXPYEARL OF  CCRDUPAI                 \n              WHEN OTHER                                                        \n                  MOVE -1              TO ACCTSIDL OF CCRDUPAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET                        \n              MOVE DFHDFCOL            TO ACCTSIDC OF CCRDUPAO                  \n              MOVE DFHDFCOL            TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CCRDUPAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE DFHRED              TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO CARDSIDO OF CCRDUPAO                  \n               MOVE DFHRED             TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDNAME-NOT-OK                                               \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO CRDNAMEC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDNAME-BLANK                                               \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO CRDNAMEO OF CCRDUPAO                  \n               MOVE DFHRED             TO CRDNAMEC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDSTATUS-NOT-OK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO CRDSTCDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDSTATUS-BLANK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO CRDSTCDO OF CCRDUPAO                  \n               MOVE DFHRED             TO CRDSTCDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           MOVE DFHBMDAR               TO EXPDAYC  OF CCRDUPAO                  \n                                                                                \n           IF FLG-CARDEXPMON-NOT-OK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO EXPMONC  OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPMON-BLANK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO EXPMONO  OF CCRDUPAO                  \n               MOVE DFHRED             TO EXPMONC  OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPYEAR-NOT-OK                                           \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO EXPYEARC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPYEAR-BLANK                                            \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO EXPYEARO OF CCRDUPAO                  \n               MOVE DFHRED             TO EXPYEARC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGA OF CCRDUPAI                  \n           ELSE                                                                 \n               MOVE DFHBMBRY           TO INFOMSGA OF CCRDUPAI                  \n           END-IF                                                               \n                                                                                \n           IF PROMPT-FOR-CONFIRMATION                                           \n              MOVE DFHBMBRY            TO FKEYSCA  OF CCRDUPAI                  \n           END-IF                                                               \n           .                                                                    \n       3300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       3400-SEND-SCREEN.                                                        \n                                                                                \n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CCRDUPAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .                                                                    \n       3400-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       9000-READ-DATA.                                                          \n                                                                                \n           INITIALIZE CCUP-OLD-DETAILS                                          \n           MOVE CC-ACCT-ID              TO CCUP-OLD-ACCTID                      \n           MOVE CC-CARD-NUM             TO CCUP-OLD-CARDID                      \n                                                                                \n           PERFORM 9100-GETCARD-BYACCTCARD                                      \n              THRU 9100-GETCARD-BYACCTCARD-EXIT                                 \n                                                                                \n           IF FOUND-CARDS-FOR-ACCOUNT                                           \n                                                                                \n              MOVE CARD-CVV-CD          TO CCUP-OLD-CVV-CD                      \n                                                                                \n              INSPECT CARD-EMBOSSED-NAME                                        \n              CONVERTING LIT-LOWER                                              \n                      TO LIT-UPPER                                              \n                                                                                \n              MOVE CARD-EMBOSSED-NAME   TO CCUP-OLD-CRDNAME                     \n              MOVE CARD-EXPIRAION-DATE(1:4)                                     \n                                        TO CCUP-OLD-EXPYEAR                     \n              MOVE CARD-EXPIRAION-DATE(6:2)                                     \n                                        TO CCUP-OLD-EXPMON                      \n              MOVE CARD-EXPIRAION-DATE(9:2)                                     \n                                        TO CCUP-OLD-EXPDAY                      \n              MOVE CARD-ACTIVE-STATUS   TO CCUP-OLD-CRDSTCD                     \n                                                                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       9000-READ-DATA-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD.                                                 \n      *    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  \n           MOVE CC-CARD-NUM             TO WS-CARD-RID-CARDNUM                  \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                    TO TRUE                    \n                  SET FLG-ACCTFILTER-NOT-OK          TO TRUE                    \n                  SET FLG-CARDFILTER-NOT-OK          TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                     SET DID-NOT-FIND-ACCTCARD-COMBO TO TRUE                    \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                    TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET FLG-ACCTFILTER-NOT-OK      TO TRUE                    \n                  END-IF                                                        \n                  MOVE 'READ'                        TO ERROR-OPNAME            \n                  MOVE LIT-CARDFILENAME              TO ERROR-FILE              \n                  MOVE WS-RESP-CD                    TO ERROR-RESP              \n                  MOVE WS-REAS-CD                    TO ERROR-RESP2             \n                  MOVE WS-FILE-ERROR-MESSAGE         TO WS-RETURN-MSG           \n           END-EVALUATE                                                         \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       9200-WRITE-PROCESSING.                                                   \n                                                                                \n      *    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  \n           MOVE CC-CARD-NUM             TO WS-CARD-RID-CARDNUM                  \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                UPDATE                                                          \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n      *****************************************************************         \n      *    Could we lock the record ?                                           \n      *****************************************************************         \n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)                               \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET INPUT-ERROR                    TO TRUE                        \n              IF  WS-RETURN-MSG-OFF                                             \n                  SET COULD-NOT-LOCK-FOR-UPDATE  TO TRUE                        \n              END-IF                                                            \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF                                                               \n      *****************************************************************         \n      *    Did someone change the record while we were out ?                    \n      *****************************************************************         \n           PERFORM 9300-CHECK-CHANGE-IN-REC                                     \n              THRU 9300-CHECK-CHANGE-IN-REC-EXIT                                \n           IF DATA-WAS-CHANGED-BEFORE-UPDATE                                    \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF                                                               \n      *****************************************************************         \n      * Prepare the update                                                      \n      *****************************************************************         \n           INITIALIZE CARD-UPDATE-RECORD                                        \n           MOVE CCUP-NEW-CARDID             TO CARD-UPDATE-NUM                  \n           MOVE CC-ACCT-ID-N                TO CARD-UPDATE-ACCT-ID              \n           MOVE CCUP-NEW-CVV-CD             TO CARD-CVV-CD-X                    \n           MOVE CARD-CVV-CD-N               TO CARD-UPDATE-CVV-CD               \n           MOVE CCUP-NEW-CRDNAME            TO CARD-UPDATE-EMBOSSED-NAME        \n           STRING  CCUP-NEW-EXPYEAR                                             \n                   '-'                                                          \n                   CCUP-NEW-EXPMON                                              \n                   '-'                                                          \n                   CCUP-NEW-EXPDAY                                              \n                   DELIMITED BY SIZE                                            \n              INTO CARD-UPDATE-EXPIRAION-DATE                                   \n           END-STRING                                                           \n           MOVE CCUP-NEW-CRDSTCD            TO CARD-UPDATE-ACTIVE-STATUS        \n                                                                                \n           EXEC CICS                                                            \n                REWRITE FILE(LIT-CARDFILENAME)                                  \n                        FROM(CARD-UPDATE-RECORD)                                \n                        LENGTH(LENGTH OF CARD-UPDATE-RECORD)                    \n                        RESP      (WS-RESP-CD)                                  \n                        RESP2     (WS-REAS-CD)                                  \n           END-EXEC.                                                            \n                                                                                \n      *****************************************************************         \n      * Did the update succeed ?  *                                             \n      *****************************************************************         \n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)                               \n             CONTINUE                                                           \n           ELSE                                                                 \n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE                            \n           END-IF                                                               \n           .                                                                    \n       9200-WRITE-PROCESSING-EXIT.                                              \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9300-CHECK-CHANGE-IN-REC.                                                \n           INSPECT CARD-EMBOSSED-NAME                                           \n           CONVERTING LIT-LOWER                                                 \n                   TO LIT-UPPER                                                 \n                                                                                \n           IF  CARD-CVV-CD              EQUAL  TO CCUP-OLD-CVV-CD               \n           AND CARD-EMBOSSED-NAME       EQUAL  TO CCUP-OLD-CRDNAME              \n           AND CARD-EXPIRAION-DATE(1:4) EQUAL  TO CCUP-OLD-EXPYEAR              \n           AND CARD-EXPIRAION-DATE(6:2) EQUAL  TO CCUP-OLD-EXPMON               \n           AND CARD-EXPIRAION-DATE(9:2) EQUAL  TO CCUP-OLD-EXPDAY               \n           AND CARD-ACTIVE-STATUS       EQUAL  TO CCUP-OLD-CRDSTCD              \n               CONTINUE                                                         \n           ELSE                                                                 \n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE                        \n              MOVE CARD-CVV-CD                 TO CCUP-OLD-CVV-CD               \n              MOVE CARD-EMBOSSED-NAME          TO CCUP-OLD-CRDNAME              \n              MOVE CARD-EXPIRAION-DATE(1:4)    TO CCUP-OLD-EXPYEAR              \n              MOVE CARD-EXPIRAION-DATE(6:2)    TO CCUP-OLD-EXPMON               \n              MOVE CARD-EXPIRAION-DATE(9:2)    TO CCUP-OLD-EXPDAY               \n              MOVE CARD-ACTIVE-STATUS          TO CCUP-OLD-CRDSTCD              \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF EXIT                                                          \n           .                                                                    \n       9300-CHECK-CHANGE-IN-REC-EXIT.                                           \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      ******************************************************************        \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .                                                           \n                                                                        340000\n       ABEND-ROUTINE.                                                           \n                                                                                \n           IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n                            ERASE                                               \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n       ABEND-ROUTINE-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *"
      },
      "description": "This program, COCRDUPC, is a business logic component of the CardDemo application that handles credit card detail updates. It provides a CICS transaction interface for users to modify credit card information such as the embossed name, expiration date, and active status. The program follows a structured workflow where it first retrieves card details based on account and card number inputs, displays them to the user, validates any changes made, and then updates the card record in the database after confirmation. It includes comprehensive input validation for all fields, handles various error conditions (such as record locking issues or concurrent updates), and provides appropriate user feedback through status messages. The program integrates with other components of the CardDemo system through a shared communication area and maintains proper transaction integrity using CICS commands for reading, updating, and synchronizing data operations.",
      "error_handling": null,
      "code": "      *****************************************************************         \n      * Program:     COCRDUPC.CBL                                     *         \n      * Layer:       Business logic                                   *         \n      * Function:    Accept and process credit card detail request    *         \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************        \n                                                                                \n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.                                                              \n           COCRDUPC.                                                            \n       DATE-WRITTEN.                                                            \n           April 2022.                                                          \n       DATE-COMPILED.                                                           \n           Today.                                                               \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n                                                                                \n       DATA DIVISION.                                                           \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n            07 WS-UCTRANS                          PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDNAME-FLAG                 PIC X(1).                    \n           88  FLG-CARDNAME-NOT-OK                 VALUE '0'.                   \n           88  FLG-CARDNAME-ISVALID                VALUE '1'.                   \n           88  FLG-CARDNAME-BLANK                  VALUE ' '.                   \n         05  WS-EDIT-CARDSTATUS-FLAG              PIC X(1).                     \n           88  FLG-CARDSTATUS-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDSTATUS-ISVALID              VALUE '1'.                   \n           88  FLG-CARDSTATUS-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDEXPMON-FLAG              PIC X(1).                     \n           88  FLG-CARDEXPMON-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDEXPMON-ISVALID              VALUE '1'.                   \n           88  FLG-CARDEXPMON-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARDEXPYEAR-FLAG             PIC X(1).                     \n           88  FLG-CARDEXPYEAR-NOT-OK              VALUE '0'.                   \n           88  FLG-CARDEXPYEAR-ISVALID             VALUE '1'.                   \n           88  FLG-CARDEXPYEAR-BLANK               VALUE ' '.                   \n         05  WS-RETURN-FLAG                        PIC X(1).                    \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  CARD-NAME-CHECK                       PIC X(50)                    \n                                                   VALUE LOW-VALUES.            \n         05  FLG-YES-NO-CHECK                      PIC X(1)                     \n                                                   VALUE 'N'.                   \n           88 FLG-YES-NO-VALID                     VALUES 'Y', 'N'.             \n         05  CARD-MONTH-CHECK                      PIC X(2).                    \n         05  CARD-MONTH-CHECK-N REDEFINES                                       \n             CARD-MONTH-CHECK                      PIC 9(2).                    \n             88 VALID-MONTH                        VALUES 1 THRU 12.            \n         05  CARD-YEAR-CHECK                      PIC X(4).                     \n         05  CARD-YEAR-CHECK-N REDEFINES                                        \n             CARD-YEAR-CHECK                      PIC 9(4).                     \n             88 VALID-YEAR                        VALUES 1950 THRU 2099.        \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  CARD-CARD-NUM-X                     PIC X(16).                   \n           10  CARD-CARD-NUM-N REDEFINES  CARD-CARD-NUM-X                       \n                                                   PIC 9(16).                   \n           10  CARD-NAME-EMBOSSED-X                PIC X(50).                   \n           10  CARD-STATUS-X                       PIC X.                       \n           10  CARD-EXPIRAION-DATE-X               PIC X(10).                   \n           10  FILLER REDEFINES CARD-EXPIRAION-DATE-X.                          \n               20 CARD-EXPIRY-YEAR                 PIC X(4).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-MONTH                PIC X(2).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-DAY                  PIC X(2).                    \n           10  CARD-EXPIRAION-DATE-N REDEFINES                                  \n               CARD-EXPIRAION-DATE-X               PIC 9(10).                   \n                                                                                \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-CARD-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  FOUND-CARDS-FOR-ACCOUNT             VALUE                        \n               'Details of selected card shown above'.                          \n           88  PROMPT-FOR-SEARCH-KEYS              VALUE                        \n               'Please enter Account and Card Number'.                          \n           88  PROMPT-FOR-CHANGES                  VALUE                        \n               'Update card details presented above.'.                          \n           88  PROMPT-FOR-CONFIRMATION             VALUE                        \n               'Changes validated.Press F5 to save'.                            \n           88  CONFIRM-UPDATE-SUCCESS              VALUE                        \n               'Changes committed to database'.                                 \n           88  INFORM-FAILURE                      VALUE                        \n               'Changes unsuccessful. Please try again'.                        \n                                                                                \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  WS-PROMPT-FOR-CARD                  VALUE                        \n               'Card number not provided'.                                      \n           88  WS-PROMPT-FOR-NAME                  VALUE                        \n               'Card name not provided'.                                        \n           88  WS-NAME-MUST-BE-ALPHA               VALUE                        \n               'Card name can only contain alphabets and spaces'.               \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  NO-CHANGES-DETECTED                 VALUE                        \n               'No change detected with respect to values fetched.'.            \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-CARD-NOT-NUMERIC           VALUE                        \n               'Card number if supplied must be a 16 digit number'.             \n           88  CARD-STATUS-MUST-BE-YES-NO          VALUE                        \n               'Card Active Status must be Y or N'.                             \n           88  CARD-EXPIRY-MONTH-NOT-VALID          VALUE                       \n               'Card expiry month must be between 1 and 12'.                    \n           88  CARD-EXPIRY-YEAR-NOT-VALID          VALUE                        \n               'Invalid card expiry year'.                                      \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in cards database'.                   \n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE                        \n               'Did not find cards for this search condition'.                  \n           88  COULD-NOT-LOCK-FOR-UPDATE           VALUE                        \n               'Could not lock record for update'.                              \n           88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE                        \n               'Record changed by some one else. Please review'.                \n           88  LOCKED-BUT-UPDATE-FAILED            VALUE                        \n               'Update of record failed'.                                       \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading Card Data File'.                                  \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      ******************************************************************        \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COCRDUPC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CCUP'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COCRDUP '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CCRDUPA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05  LIT-CARDDTLPGM                       PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05  LIT-CARDDTLTRANID                    PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05  LIT-CARDDTLMAPSET                    PIC X(7)                     \n                                                   VALUE 'COCRDSL'.             \n          05  LIT-CARDDTLMAP                       PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n          05 LIT-ALL-ALPHA-FROM                    PIC X(52)                    \n             VALUE                                                              \n             'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.            \n          05 LIT-ALL-SPACES-TO                     PIC X(52)                    \n                                                   VALUE SPACES.                \n          05 LIT-UPPER                             PIC X(26)                    \n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.            \n          05 LIT-LOWER                             PIC X(26)                    \n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.            \n                                                                                \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CARD-UPDATE-SCREEN-DATA.                                           \n             10 CCUP-CHANGE-ACTION                 PIC X(1)                     \n                                                   VALUE LOW-VALUES.            \n                88 CCUP-DETAILS-NOT-FETCHED        VALUES                       \n                                                   LOW-VALUES,                  \n                                                   SPACES.                      \n                88 CCUP-SHOW-DETAILS               VALUE 'S'.                   \n                88 CCUP-CHANGES-MADE               VALUES 'E', 'N'              \n                                                        , 'C', 'L'              \n                                                        , 'F'.                  \n                88 CCUP-CHANGES-NOT-OK             VALUE 'E'.                   \n                88 CCUP-CHANGES-OK-NOT-CONFIRMED   VALUE 'N'.                   \n                88 CCUP-CHANGES-OKAYED-AND-DONE    VALUE 'C'.                   \n                88 CCUP-CHANGES-FAILED             VALUES 'L', 'F'.             \n                88 CCUP-CHANGES-OKAYED-LOCK-ERROR  VALUE 'L'.                   \n                88 CCUP-CHANGES-OKAYED-BUT-FAILED  VALUE 'F'.                   \n          05 CCUP-OLD-DETAILS.                                                  \n             10 CCUP-OLD-ACCTID                    PIC X(11).                   \n             10 CCUP-OLD-CARDID                    PIC X(16).                   \n             10 CCUP-OLD-CVV-CD                    PIC X(3).                    \n             10 CCUP-OLD-CARDDATA.                                              \n                20 CCUP-OLD-CRDNAME                PIC X(50).                   \n                20 CCUP-OLD-EXPIRAION-DATE.                                     \n                   25 CCUP-OLD-EXPYEAR             PIC X(4).                    \n                   25 CCUP-OLD-EXPMON              PIC X(2).                    \n                   25 CCUP-OLD-EXPDAY              PIC X(2).                    \n                20 CCUP-OLD-CRDSTCD                PIC X(1).                    \n                                                                                \n          05 CCUP-NEW-DETAILS.                                                  \n             10 CCUP-NEW-ACCTID                    PIC X(11).                   \n             10 CCUP-NEW-CARDID                    PIC X(16).                   \n             10 CCUP-NEW-CVV-CD                    PIC X(3).                    \n             10 CCUP-NEW-CARDDATA.                                              \n                20 CCUP-NEW-CRDNAME                PIC X(50).                   \n                20 CCUP-NEW-EXPIRAION-DATE.                                     \n                   25 CCUP-NEW-EXPYEAR             PIC X(4).                    \n                   25 CCUP-NEW-EXPMON              PIC X(2).                    \n                   25 CCUP-NEW-EXPDAY              PIC X(2).                    \n                20 CCUP-NEW-CRDSTCD                PIC X(1).                    \n          05 CARD-UPDATE-RECORD.                                                \n             10 CARD-UPDATE-NUM                   PIC X(16).                    \n             10 CARD-UPDATE-ACCT-ID               PIC 9(11).                    \n             10 CARD-UPDATE-CVV-CD                PIC 9(03).                    \n             10 CARD-UPDATE-EMBOSSED-NAME         PIC X(50).                    \n             10 CARD-UPDATE-EXPIRAION-DATE        PIC X(10).                    \n             10 CARD-UPDATE-ACTIVE-STATUS         PIC X(01).                    \n             10 FILLER                            PIC X(59).                    \n                                                                                \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Update Screen Layout                                         \n       COPY COCRDUP.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n      *ACCOUNT RECORD LAYOUT                                                    \n      *COPY CVACT01Y.                                                           \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n      *COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.                     \n                                                                                \n       PROCEDURE DIVISION.                                                      \n       0000-MAIN.                                                               \n                                                                                \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM                             \n               AND NOT CDEMO-PGM-REENTER)                                       \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n              SET CDEMO-PGM-ENTER TO TRUE                                       \n              SET CCUP-DETAILS-NOT-FETCHED TO TRUE                              \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              (CCARD-AID-PFK05 AND CCUP-CHANGES-OK-NOT-CONFIRMED)               \n                              OR                                                \n              (CCARD-AID-PFK12 AND NOT CCUP-DETAILS-NOT-FETCHED)                \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n      ******************************************************************        \n      *       USER PRESSES PF03 TO EXIT                                         \n      *  OR   USER IS DONE WITH UPDATE                                          \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n              WHEN CCARD-AID-PFK03                                              \n              WHEN (CCUP-CHANGES-OKAYED-AND-DONE                                \n               AND  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET)                 \n              WHEN (CCUP-CHANGES-FAILED                                         \n               AND  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET)                 \n                   SET CCARD-AID-PFK03     TO TRUE                              \n                                                                                \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                                                                                \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   IF CDEMO-LAST-MAPSET    EQUAL LIT-CCLISTMAPSET               \n                       MOVE ZEROS          TO CDEMO-ACCT-ID                     \n                                              CDEMO-CARD-NUM                    \n                   END-IF                                                       \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n                                                                                \n                   EXEC CICS                                                    \n                        SYNCPOINT                                               \n                   END-EXEC                                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CDEMO-TO-PROGRAM)                              \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      ******************************************************************        \n      *       USER CAME FROM CREDIT CARD LIST SCREEN                            \n      *            SO WE ALREADY HAVE THE FILTER KEYS                           \n      *            FETCH THE ASSSOCIATED CARD DETAILS FOR UPDATE                \n      ******************************************************************        \n              WHEN CDEMO-PGM-ENTER                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n              WHEN CCARD-AID-PFK12                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n                   SET CDEMO-PGM-REENTER    TO TRUE                             \n                   SET INPUT-OK             TO TRUE                             \n                   SET FLG-ACCTFILTER-ISVALID  TO TRUE                          \n                   SET FLG-CARDFILTER-ISVALID  TO TRUE                          \n                   MOVE CDEMO-ACCT-ID       TO CC-ACCT-ID-N                     \n                   MOVE CDEMO-CARD-NUM      TO CC-CARD-NUM-N                    \n                   PERFORM 9000-READ-DATA                                       \n                      THRU 9000-READ-DATA-EXIT                                  \n                   SET CCUP-SHOW-DETAILS TO TRUE                                \n                   PERFORM 3000-SEND-MAP                                        \n                      THRU 3000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *       FRESH ENTRY INTO PROGRAM                                          \n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED        \n      ******************************************************************        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n               AND CDEMO-PGM-ENTER                                              \n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM                       \n               AND NOT CDEMO-PGM-REENTER                                        \n                   INITIALIZE WS-THIS-PROGCOMMAREA                              \n                   PERFORM 3000-SEND-MAP THRU                                   \n                           3000-SEND-MAP-EXIT                                   \n                   SET CDEMO-PGM-REENTER        TO TRUE                         \n                   SET CCUP-DETAILS-NOT-FETCHED TO TRUE                         \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *       CARD DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY           \n      *            RESET THE SEARCH KEYS                                        \n      *            ASK THE USER FOR FRESH SEARCH CRITERIA                       \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n              WHEN CCUP-CHANGES-FAILED                                          \n                   INITIALIZE WS-THIS-PROGCOMMAREA                              \n                              WS-MISC-STORAGE                                   \n                              CDEMO-ACCT-ID                                     \n                              CDEMO-CARD-NUM                                    \n                   SET CDEMO-PGM-ENTER            TO TRUE                       \n                   PERFORM 3000-SEND-MAP THRU                                   \n                           3000-SEND-MAP-EXIT                                   \n                   SET CDEMO-PGM-REENTER          TO TRUE                       \n                   SET CCUP-DETAILS-NOT-FETCHED   TO TRUE                       \n                   GO TO COMMON-RETURN                                          \n      ******************************************************************        \n      *      CARD DATA HAS BEEN PRESENTED TO USER                               \n      *            CHECK THE USER INPUTS                                        \n      *            DECIDE WHAT TO DO                                            \n      *            PRESENT NEXT STEPS TO USER                                   \n      ******************************************************************        \n              WHEN OTHER                                                        \n                   PERFORM 1000-PROCESS-INPUTS                                  \n                      THRU 1000-PROCESS-INPUTS-EXIT                             \n                   PERFORM 2000-DECIDE-ACTION                                   \n                      THRU 2000-DECIDE-ACTION-EXIT                              \n                   PERFORM 3000-SEND-MAP                                        \n                      THRU 3000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n           END-EVALUATE                                                         \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1000-PROCESS-INPUTS.                                                     \n           PERFORM 1100-RECEIVE-MAP                                             \n              THRU 1100-RECEIVE-MAP-EXIT                                        \n           PERFORM 1200-EDIT-MAP-INPUTS                                         \n              THRU 1200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .                                                                    \n                                                                                \n       1000-PROCESS-INPUTS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n       1100-RECEIVE-MAP.                                                        \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CCRDUPAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CCUP-NEW-DETAILS                                          \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CCRDUPAI = '*'                                       \n           OR  ACCTSIDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n                                             CCUP-NEW-ACCTID                    \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CCRDUPAI TO  CC-ACCT-ID                         \n                                             CCUP-NEW-ACCTID                    \n           END-IF                                                               \n                                                                                \n           IF  CARDSIDI OF CCRDUPAI = '*'                                       \n           OR  CARDSIDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-CARD-NUM                        \n                                             CCUP-NEW-CARDID                    \n           ELSE                                                                 \n               MOVE CARDSIDI OF CCRDUPAI TO  CC-CARD-NUM                        \n                                             CCUP-NEW-CARDID                    \n           END-IF                                                               \n                                                                                \n           IF  CRDNAMEI OF CCRDUPAI = '*'                                       \n           OR  CRDNAMEI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-CRDNAME                   \n           ELSE                                                                 \n               MOVE CRDNAMEI OF CCRDUPAI TO  CCUP-NEW-CRDNAME                   \n           END-IF                                                               \n                                                                                \n           IF  CRDSTCDI OF CCRDUPAI = '*'                                       \n           OR  CRDSTCDI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-CRDSTCD                   \n           ELSE                                                                 \n               MOVE CRDSTCDI OF CCRDUPAI TO  CCUP-NEW-CRDSTCD                   \n           END-IF                                                               \n                                                                                \n           MOVE EXPDAYI     OF CCRDUPAI  TO  CCUP-NEW-EXPDAY                    \n                                                                                \n           IF  EXPMONI OF CCRDUPAI = '*'                                        \n           OR  EXPMONI OF CCRDUPAI = SPACES                                     \n               MOVE LOW-VALUES           TO  CCUP-NEW-EXPMON                    \n           ELSE                                                                 \n               MOVE EXPMONI OF CCRDUPAI  TO  CCUP-NEW-EXPMON                    \n           END-IF                                                               \n                                                                                \n           IF  EXPYEARI OF CCRDUPAI = '*'                                       \n           OR  EXPYEARI OF CCRDUPAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CCUP-NEW-EXPYEAR                   \n           ELSE                                                                 \n               MOVE EXPYEARI OF CCRDUPAI TO  CCUP-NEW-EXPYEAR                   \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1100-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       1200-EDIT-MAP-INPUTS.                                                    \n                                                                                \n           SET INPUT-OK                  TO TRUE                                \n                                                                                \n           IF  CCUP-DETAILS-NOT-FETCHED                                         \n      *        VALIDATE THE SEARCH KEYS                                         \n               PERFORM 1210-EDIT-ACCOUNT                                        \n                  THRU 1210-EDIT-ACCOUNT-EXIT                                   \n                                                                                \n               PERFORM 1220-EDIT-CARD                                           \n                  THRU 1220-EDIT-CARD-EXIT                                      \n                                                                                \n               MOVE LOW-VALUES                 TO CCUP-NEW-CARDDATA             \n                                                                                \n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS SKIP OTHER EDITS           \n               IF  FLG-ACCTFILTER-BLANK                                         \n               AND FLG-CARDFILTER-BLANK                                         \n                   SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                      \n               END-IF                                                           \n                                                                                \n               GO TO 1200-EDIT-MAP-INPUTS-EXIT                                  \n                                                                                \n           ELSE                                                                 \n               CONTINUE                                                         \n           END-IF                                                               \n                                                                                \n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED                       \n           SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                                  \n           SET FLG-ACCTFILTER-ISVALID  TO TRUE                                  \n           SET FLG-CARDFILTER-ISVALID  TO TRUE                                  \n           MOVE CCUP-OLD-ACCTID     TO CDEMO-ACCT-ID                            \n           MOVE CCUP-OLD-CARDID     TO CDEMO-CARD-NUM                           \n           MOVE CCUP-OLD-CRDNAME    TO CARD-EMBOSSED-NAME                       \n           MOVE CCUP-OLD-CRDSTCD    TO CARD-ACTIVE-STATUS                       \n           MOVE CCUP-OLD-EXPDAY     TO CARD-EXPIRY-DAY                          \n           MOVE CCUP-OLD-EXPMON     TO CARD-EXPIRY-MONTH                        \n           MOVE CCUP-OLD-EXPYEAR    TO CARD-EXPIRY-YEAR                         \n                                                                                \n      *    NEW DATA IS SAME AS OLD DATA                                         \n           IF  (FUNCTION UPPER-CASE(CCUP-NEW-CARDDATA) EQUAL                    \n                FUNCTION UPPER-CASE(CCUP-OLD-CARDDATA))                         \n               SET NO-CHANGES-DETECTED TO TRUE                                  \n           END-IF                                                               \n                                                                                \n           IF  NO-CHANGES-DETECTED                                              \n           OR  CCUP-CHANGES-OK-NOT-CONFIRMED                                    \n           OR  CCUP-CHANGES-OKAYED-AND-DONE                                     \n               SET FLG-CARDNAME-ISVALID    TO TRUE                              \n               SET FLG-CARDSTATUS-ISVALID  TO TRUE                              \n               SET FLG-CARDEXPMON-ISVALID  TO TRUE                              \n               SET FLG-CARDEXPYEAR-ISVALID TO TRUE                              \n               GO TO 1200-EDIT-MAP-INPUTS-EXIT                                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           SET CCUP-CHANGES-NOT-OK    TO TRUE                                   \n                                                                                \n           PERFORM 1230-EDIT-NAME                                               \n              THRU 1230-EDIT-NAME-EXIT                                          \n                                                                                \n           PERFORM 1240-EDIT-CARDSTATUS                                         \n              THRU 1240-EDIT-CARDSTATUS-EXIT                                    \n                                                                                \n           PERFORM 1250-EDIT-EXPIRY-MON                                         \n              THRU 1250-EDIT-EXPIRY-MON-EXIT                                    \n                                                                                \n           PERFORM 1260-EDIT-EXPIRY-YEAR                                        \n              THRU 1260-EDIT-EXPIRY-YEAR-EXIT                                   \n                                                                                \n           IF INPUT-ERROR                                                       \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CCUP-CHANGES-OK-NOT-CONFIRMED TO TRUE                         \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1200-EDIT-MAP-INPUTS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              MOVE LOW-VALUES   TO CCUP-NEW-ACCTID                              \n              GO TO  1210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              MOVE LOW-VALUES TO CCUP-NEW-ACCTID                                \n              GO TO 1210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n                                 CCUP-NEW-ACCTID                                \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-CARD TO TRUE                                 \n              END-IF                                                            \n                                                                                \n              MOVE ZEROES        TO CDEMO-CARD-NUM                              \n                                   CCUP-NEW-CARDID                              \n              GO TO  1220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                                 TO WS-RETURN-MSG                               \n              END-IF                                                            \n              MOVE ZERO          TO CDEMO-CARD-NUM                              \n              MOVE LOW-VALUES    TO CCUP-NEW-CARDID                             \n              GO TO 1220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              MOVE CC-CARD-NUM   TO CCUP-NEW-CARDID                             \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1230-EDIT-NAME.                                                          \n      *    Not BLANK                                                            \n           SET FLG-CARDNAME-NOT-OK      TO TRUE                                 \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-CRDNAME   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-CRDNAME   EQUAL SPACES                                   \n           OR CCUP-NEW-CRDNAME   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDNAME-BLANK  TO TRUE                                   \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-NAME TO TRUE                                 \n              END-IF                                                            \n              GO TO  1230-EDIT-NAME-EXIT                                        \n           END-IF                                                               \n                                                                                \n      *    Only Alphabets and space allowed                                     \n           MOVE CCUP-NEW-CRDNAME        TO CARD-NAME-CHECK                      \n           INSPECT CARD-NAME-CHECK                                              \n             CONVERTING LIT-ALL-ALPHA-FROM                                      \n                     TO LIT-ALL-SPACES-TO                                       \n                                                                                \n           IF FUNCTION LENGTH(FUNCTION TRIM(CARD-NAME-CHECK)) = 0               \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDNAME-NOT-OK   TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-NAME-MUST-BE-ALPHA  TO TRUE                             \n              END-IF                                                            \n              GO TO  1230-EDIT-NAME-EXIT                                        \n           END-IF                                                               \n                                                                                \n           SET FLG-CARDNAME-ISVALID     TO TRUE                                 \n           .                                                                    \n       1230-EDIT-NAME-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1240-EDIT-CARDSTATUS.                                                    \n      *    Must be Y or N                                                       \n           SET FLG-CARDSTATUS-NOT-OK      TO TRUE                               \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-CRDSTCD   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-CRDSTCD   EQUAL SPACES                                   \n           OR CCUP-NEW-CRDSTCD   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDSTATUS-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-STATUS-MUST-BE-YES-NO TO TRUE                         \n              END-IF                                                            \n              GO TO  1240-EDIT-CARDSTATUS-EXIT                                  \n           END-IF                                                               \n                                                                                \n           MOVE CCUP-NEW-CRDSTCD          TO FLG-YES-NO-CHECK                   \n                                                                                \n           IF FLG-YES-NO-VALID                                                  \n              SET FLG-CARDSTATUS-ISVALID  TO TRUE                               \n           ELSE                                                                 \n              SET INPUT-ERROR             TO TRUE                               \n              SET FLG-CARDSTATUS-NOT-OK   TO TRUE                               \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-STATUS-MUST-BE-YES-NO  TO TRUE                        \n              END-IF                                                            \n              GO TO  1240-EDIT-CARDSTATUS-EXIT                                  \n           END-IF                                                               \n           .                                                                    \n       1240-EDIT-CARDSTATUS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n       1250-EDIT-EXPIRY-MON.                                                    \n                                                                                \n                                                                                \n           SET FLG-CARDEXPMON-NOT-OK      TO TRUE                               \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-EXPMON   EQUAL LOW-VALUES                                \n           OR CCUP-NEW-EXPMON   EQUAL SPACES                                    \n           OR CCUP-NEW-EXPMON   EQUAL ZEROS                                     \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDEXPMON-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-MONTH-NOT-VALID TO TRUE                        \n              END-IF                                                            \n              GO TO  1250-EDIT-EXPIRY-MON-EXIT                                  \n           END-IF                                                               \n                                                                                \n      *    Must be numeric                                                      \n      *    Must be 1 to 12                                                      \n           MOVE CCUP-NEW-EXPMON           TO CARD-MONTH-CHECK                   \n                                                                                \n           IF VALID-MONTH                                                       \n              SET FLG-CARDEXPMON-ISVALID  TO TRUE                               \n           ELSE                                                                 \n              SET INPUT-ERROR             TO TRUE                               \n              SET FLG-CARDEXPMON-NOT-OK   TO TRUE                               \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-MONTH-NOT-VALID  TO TRUE                       \n              END-IF                                                            \n              GO TO  1250-EDIT-EXPIRY-MON-EXIT                                  \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1250-EDIT-EXPIRY-MON-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n       1260-EDIT-EXPIRY-YEAR.                                                   \n                                                                                \n      *    Not supplied                                                         \n           IF CCUP-NEW-EXPYEAR   EQUAL LOW-VALUES                               \n           OR CCUP-NEW-EXPYEAR   EQUAL SPACES                                   \n           OR CCUP-NEW-EXPYEAR   EQUAL ZEROS                                    \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDEXPYEAR-BLANK  TO TRUE                                \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-YEAR-NOT-VALID TO TRUE                         \n              END-IF                                                            \n              GO TO  1260-EDIT-EXPIRY-YEAR-EXIT                                 \n           END-IF                                                               \n                                                                                \n      *    Must be numeric                                                      \n      *    Must be 1 to 12                                                      \n                                                                                \n           SET FLG-CARDEXPYEAR-NOT-OK      TO TRUE                              \n                                                                                \n           MOVE CCUP-NEW-EXPYEAR           TO CARD-YEAR-CHECK                   \n                                                                                \n           IF VALID-YEAR                                                        \n              SET FLG-CARDEXPYEAR-ISVALID  TO TRUE                              \n           ELSE                                                                 \n              SET INPUT-ERROR              TO TRUE                              \n              SET FLG-CARDEXPYEAR-NOT-OK   TO TRUE                              \n              IF WS-RETURN-MSG-OFF                                              \n                 SET CARD-EXPIRY-YEAR-NOT-VALID  TO TRUE                        \n              END-IF                                                            \n              GO TO  1260-EDIT-EXPIRY-YEAR-EXIT                                 \n           END-IF                                                               \n           .                                                                    \n       1260-EDIT-EXPIRY-YEAR-EXIT.                                              \n           EXIT                                                                 \n           .                                                                    \n       2000-DECIDE-ACTION.                                                      \n           EVALUATE TRUE                                                        \n      ******************************************************************        \n      *       NO DETAILS SHOWN.                                                 \n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN                          \n      ******************************************************************        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n      ******************************************************************        \n      *       CHANGES MADE. BUT USER CANCELS                                    \n      ******************************************************************        \n              WHEN CCARD-AID-PFK12                                              \n                 IF  FLG-ACCTFILTER-ISVALID                                     \n                 AND FLG-CARDFILTER-ISVALID                                     \n                     PERFORM 9000-READ-DATA                                     \n                        THRU 9000-READ-DATA-EXIT                                \n                     IF FOUND-CARDS-FOR-ACCOUNT                                 \n                        SET CCUP-SHOW-DETAILS    TO TRUE                        \n                     END-IF                                                     \n                 END-IF                                                         \n      ******************************************************************        \n      *       DETAILS SHOWN                                                     \n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD                        \n      ******************************************************************        \n              WHEN CCUP-SHOW-DETAILS                                            \n                 IF INPUT-ERROR                                                 \n                 OR NO-CHANGES-DETECTED                                         \n                    CONTINUE                                                    \n                 ELSE                                                           \n                    SET CCUP-CHANGES-OK-NOT-CONFIRMED TO TRUE                   \n                 END-IF                                                         \n      ******************************************************************        \n      *       DETAILS SHOWN                                                     \n      *       BUT INPUT EDIT ERRORS FOUND                                       \n      ******************************************************************        \n              WHEN CCUP-CHANGES-NOT-OK                                          \n                  CONTINUE                                                      \n      ******************************************************************        \n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 \n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES                            \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n               AND CCARD-AID-PFK05                                              \n                 PERFORM 9200-WRITE-PROCESSING                                  \n                    THRU 9200-WRITE-PROCESSING-EXIT                             \n                 EVALUATE TRUE                                                  \n                    WHEN COULD-NOT-LOCK-FOR-UPDATE                              \n                         SET CCUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE             \n                    WHEN LOCKED-BUT-UPDATE-FAILED                               \n                       SET CCUP-CHANGES-OKAYED-BUT-FAILED TO TRUE               \n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE                         \n                        SET CCUP-SHOW-DETAILS            TO TRUE                \n                    WHEN OTHER                                                  \n                       SET CCUP-CHANGES-OKAYED-AND-DONE   TO TRUE               \n                 END-EVALUATE                                                   \n      ******************************************************************        \n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED                 \n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN                     \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n                  CONTINUE                                                      \n      ******************************************************************        \n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1                            \n      ******************************************************************        \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n                  SET CCUP-SHOW-DETAILS TO TRUE                                 \n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                      \n                  OR CDEMO-FROM-TRANID    EQUAL SPACES                          \n                     MOVE ZEROES       TO CDEMO-ACCT-ID                         \n                                          CDEMO-CARD-NUM                        \n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS                     \n                  END-IF                                                        \n              WHEN OTHER                                                        \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO ABEND-MSG                             \n                   PERFORM ABEND-ROUTINE                                        \n                      THRU ABEND-ROUTINE-EXIT                                   \n           END-EVALUATE                                                         \n           .                                                                    \n       2000-DECIDE-ACTION-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n                                                                                \n       3000-SEND-MAP.                                                           \n           PERFORM 3100-SCREEN-INIT                                             \n              THRU 3100-SCREEN-INIT-EXIT                                        \n           PERFORM 3200-SETUP-SCREEN-VARS                                       \n              THRU 3200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 3250-SETUP-INFOMSG                                           \n              THRU 3250-SETUP-INFOMSG-EXIT                                      \n           PERFORM 3300-SETUP-SCREEN-ATTRS                                      \n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 3400-SEND-SCREEN                                             \n              THRU 3400-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       3000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       3100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES TO CCRDUPAO                                          \n                                                                                \n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA                    \n                                                                                \n           MOVE CCDA-TITLE01              TO TITLE01O OF CCRDUPAO               \n           MOVE CCDA-TITLE02              TO TITLE02O OF CCRDUPAO               \n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CCRDUPAO               \n           MOVE LIT-THISPGM               TO PGMNAMEO OF CCRDUPAO               \n                                                                                \n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA                    \n                                                                                \n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM                      \n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD                      \n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY                      \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CCRDUPAO               \n                                                                                \n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH                      \n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM                      \n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS                      \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CCRDUPAO               \n                                                                                \n           .                                                                    \n                                                                                \n       3100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       3200-SETUP-SCREEN-VARS.                                                  \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF CDEMO-PGM-ENTER                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              IF CC-ACCT-ID-N = 0                                               \n                 MOVE LOW-VALUES          TO ACCTSIDO OF CCRDUPAO               \n              ELSE                                                              \n                 MOVE CC-ACCT-ID          TO ACCTSIDO OF CCRDUPAO               \n              END-IF                                                            \n                                                                                \n              IF CC-CARD-NUM-N = 0                                              \n                MOVE LOW-VALUES           TO CARDSIDO OF CCRDUPAO               \n              ELSE                                                              \n                MOVE CC-CARD-NUM          TO CARDSIDO OF CCRDUPAO               \n              END-IF                                                            \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN CCUP-DETAILS-NOT-FETCHED                                 \n                       MOVE LOW-VALUES         TO CRDNAMEO OF CCRDUPAO          \n                                                  CRDNAMEO OF CCRDUPAO          \n                                                  CRDSTCDO OF CCRDUPAO          \n                                                  EXPDAYO  OF CCRDUPAO          \n                                                  EXPMONO  OF CCRDUPAO          \n                                                  EXPYEARO OF CCRDUPAO          \n                  WHEN CCUP-SHOW-DETAILS                                        \n                      MOVE CCUP-OLD-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-OLD-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n                  WHEN CCUP-CHANGES-MADE                                        \n                      MOVE CCUP-NEW-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-NEW-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-NEW-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-NEW-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n      ******************************************************************        \n      *               MOVE OLD VALUES TO NON-DISPLAY FIELDS                     \n      *               THAT WE ARE NOT ALLOWING USER TO CHANGE(FOR NOW)          \n      *****************************************************************         \n      *               MOVE CCUP-NEW-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                  WHEN OTHER                                                    \n                      MOVE CCUP-OLD-CRDNAME    TO CRDNAMEO OF CCRDUPAO          \n                      MOVE CCUP-OLD-CRDSTCD    TO CRDSTCDO OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPDAY     TO EXPDAYO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPMON     TO EXPMONO  OF CCRDUPAO          \n                      MOVE CCUP-OLD-EXPYEAR    TO EXPYEARO OF CCRDUPAO          \n              END-EVALUATE                                                      \n                                                                                \n                                                                                \n            END-IF                                                              \n           .                                                                    \n       3200-SETUP-SCREEN-VARS-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       3250-SETUP-INFOMSG.                                                      \n      *    SETUP INFORMATION MESSAGE                                            \n           EVALUATE TRUE                                                        \n               WHEN CDEMO-PGM-ENTER                                             \n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE                         \n               WHEN CCUP-DETAILS-NOT-FETCHED                                    \n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE                      \n               WHEN CCUP-SHOW-DETAILS                                           \n                    SET FOUND-CARDS-FOR-ACCOUNT    TO TRUE                      \n               WHEN CCUP-CHANGES-NOT-OK                                         \n                    SET PROMPT-FOR-CHANGES         TO TRUE                      \n               WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                               \n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-AND-DONE                                \n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-LOCK-ERROR                              \n                    SET INFORM-FAILURE             TO TRUE                      \n               WHEN CCUP-CHANGES-OKAYED-BUT-FAILED                              \n                    SET INFORM-FAILURE             TO TRUE                      \n               WHEN WS-NO-INFO-MESSAGE                                          \n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE                      \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CCRDUPAO          \n                                                                                \n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CCRDUPAO           \n           .                                                                    \n       3250-SETUP-INFOMSG-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n       3300-SETUP-SCREEN-ATTRS.                                                 \n                                                                                \n                                                                                \n      *    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           EVALUATE TRUE                                                        \n              WHEN CCUP-DETAILS-NOT-FETCHED                                     \n                   MOVE DFHBMFSE      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                   MOVE DFHBMPRF      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN  CCUP-SHOW-DETAILS                                           \n              WHEN  CCUP-CHANGES-NOT-OK                                         \n                   MOVE DFHBMPRF      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                   MOVE DFHBMFSE      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n                                                                                \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN CCUP-CHANGES-OK-NOT-CONFIRMED                                \n              WHEN CCUP-CHANGES-OKAYED-AND-DONE                                 \n                   MOVE DFHBMPRF      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                                         CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n              WHEN OTHER                                                        \n                   MOVE DFHBMFSE      TO ACCTSIDA OF CCRDUPAI                   \n                                         CARDSIDA OF CCRDUPAI                   \n                   MOVE DFHBMPRF      TO CRDNAMEA OF CCRDUPAI                   \n                                         CRDSTCDA OF CCRDUPAI                   \n      *                                  EXPDAYA  OF CCRDUPAI                   \n                                         EXPMONA  OF CCRDUPAI                   \n                                         EXPYEARA OF CCRDUPAI                   \n           END-EVALUATE                                                         \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FOUND-CARDS-FOR-ACCOUNT                                      \n              WHEN NO-CHANGES-DETECTED                                          \n                  MOVE -1              TO CRDNAMEL OF CCRDUPAI                  \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CCRDUPAI                  \n              WHEN FLG-CARDFILTER-NOT-OK                                        \n              WHEN FLG-CARDFILTER-BLANK                                         \n                   MOVE -1             TO CARDSIDL OF CCRDUPAI                  \n              WHEN FLG-CARDNAME-NOT-OK                                          \n              WHEN FLG-CARDNAME-BLANK                                           \n                  MOVE -1              TO CRDNAMEL OF  CCRDUPAI                 \n              WHEN FLG-CARDSTATUS-NOT-OK                                        \n              WHEN FLG-CARDSTATUS-BLANK                                         \n                  MOVE -1              TO CRDSTCDL OF  CCRDUPAI                 \n              WHEN FLG-CARDEXPMON-NOT-OK                                        \n              WHEN FLG-CARDEXPMON-BLANK                                         \n                  MOVE -1              TO EXPMONL  OF  CCRDUPAI                 \n              WHEN FLG-CARDEXPYEAR-NOT-OK                                       \n              WHEN FLG-CARDEXPYEAR-BLANK                                        \n                  MOVE -1              TO EXPYEARL OF  CCRDUPAI                 \n              WHEN OTHER                                                        \n                  MOVE -1              TO ACCTSIDL OF CCRDUPAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET                        \n              MOVE DFHDFCOL            TO ACCTSIDC OF CCRDUPAO                  \n              MOVE DFHDFCOL            TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CCRDUPAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE DFHRED              TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO CARDSIDO OF CCRDUPAO                  \n               MOVE DFHRED             TO CARDSIDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDNAME-NOT-OK                                               \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO CRDNAMEC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDNAME-BLANK                                               \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO CRDNAMEO OF CCRDUPAO                  \n               MOVE DFHRED             TO CRDNAMEC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDSTATUS-NOT-OK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO CRDSTCDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDSTATUS-BLANK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO CRDSTCDO OF CCRDUPAO                  \n               MOVE DFHRED             TO CRDSTCDC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           MOVE DFHBMDAR               TO EXPDAYC  OF CCRDUPAO                  \n                                                                                \n           IF FLG-CARDEXPMON-NOT-OK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO EXPMONC  OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPMON-BLANK                                             \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO EXPMONO  OF CCRDUPAO                  \n               MOVE DFHRED             TO EXPMONC  OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPYEAR-NOT-OK                                           \n           AND CCUP-CHANGES-NOT-OK                                              \n              MOVE DFHRED              TO EXPYEARC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDEXPYEAR-BLANK                                            \n           AND CCUP-CHANGES-NOT-OK                                              \n               MOVE '*'                TO EXPYEARO OF CCRDUPAO                  \n               MOVE DFHRED             TO EXPYEARC OF CCRDUPAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGA OF CCRDUPAI                  \n           ELSE                                                                 \n               MOVE DFHBMBRY           TO INFOMSGA OF CCRDUPAI                  \n           END-IF                                                               \n                                                                                \n           IF PROMPT-FOR-CONFIRMATION                                           \n              MOVE DFHBMBRY            TO FKEYSCA  OF CCRDUPAI                  \n           END-IF                                                               \n           .                                                                    \n       3300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       3400-SEND-SCREEN.                                                        \n                                                                                \n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CCRDUPAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .                                                                    \n       3400-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       9000-READ-DATA.                                                          \n                                                                                \n           INITIALIZE CCUP-OLD-DETAILS                                          \n           MOVE CC-ACCT-ID              TO CCUP-OLD-ACCTID                      \n           MOVE CC-CARD-NUM             TO CCUP-OLD-CARDID                      \n                                                                                \n           PERFORM 9100-GETCARD-BYACCTCARD                                      \n              THRU 9100-GETCARD-BYACCTCARD-EXIT                                 \n                                                                                \n           IF FOUND-CARDS-FOR-ACCOUNT                                           \n                                                                                \n              MOVE CARD-CVV-CD          TO CCUP-OLD-CVV-CD                      \n                                                                                \n              INSPECT CARD-EMBOSSED-NAME                                        \n              CONVERTING LIT-LOWER                                              \n                      TO LIT-UPPER                                              \n                                                                                \n              MOVE CARD-EMBOSSED-NAME   TO CCUP-OLD-CRDNAME                     \n              MOVE CARD-EXPIRAION-DATE(1:4)                                     \n                                        TO CCUP-OLD-EXPYEAR                     \n              MOVE CARD-EXPIRAION-DATE(6:2)                                     \n                                        TO CCUP-OLD-EXPMON                      \n              MOVE CARD-EXPIRAION-DATE(9:2)                                     \n                                        TO CCUP-OLD-EXPDAY                      \n              MOVE CARD-ACTIVE-STATUS   TO CCUP-OLD-CRDSTCD                     \n                                                                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       9000-READ-DATA-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD.                                                 \n      *    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  \n           MOVE CC-CARD-NUM             TO WS-CARD-RID-CARDNUM                  \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                    TO TRUE                    \n                  SET FLG-ACCTFILTER-NOT-OK          TO TRUE                    \n                  SET FLG-CARDFILTER-NOT-OK          TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                     SET DID-NOT-FIND-ACCTCARD-COMBO TO TRUE                    \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                    TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET FLG-ACCTFILTER-NOT-OK      TO TRUE                    \n                  END-IF                                                        \n                  MOVE 'READ'                        TO ERROR-OPNAME            \n                  MOVE LIT-CARDFILENAME              TO ERROR-FILE              \n                  MOVE WS-RESP-CD                    TO ERROR-RESP              \n                  MOVE WS-REAS-CD                    TO ERROR-RESP2             \n                  MOVE WS-FILE-ERROR-MESSAGE         TO WS-RETURN-MSG           \n           END-EVALUATE                                                         \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       9200-WRITE-PROCESSING.                                                   \n                                                                                \n      *    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N            TO WS-CARD-RID-ACCT-ID                  \n           MOVE CC-CARD-NUM             TO WS-CARD-RID-CARDNUM                  \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                UPDATE                                                          \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n      *****************************************************************         \n      *    Could we lock the record ?                                           \n      *****************************************************************         \n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)                               \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET INPUT-ERROR                    TO TRUE                        \n              IF  WS-RETURN-MSG-OFF                                             \n                  SET COULD-NOT-LOCK-FOR-UPDATE  TO TRUE                        \n              END-IF                                                            \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF                                                               \n      *****************************************************************         \n      *    Did someone change the record while we were out ?                    \n      *****************************************************************         \n           PERFORM 9300-CHECK-CHANGE-IN-REC                                     \n              THRU 9300-CHECK-CHANGE-IN-REC-EXIT                                \n           IF DATA-WAS-CHANGED-BEFORE-UPDATE                                    \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF                                                               \n      *****************************************************************         \n      * Prepare the update                                                      \n      *****************************************************************         \n           INITIALIZE CARD-UPDATE-RECORD                                        \n           MOVE CCUP-NEW-CARDID             TO CARD-UPDATE-NUM                  \n           MOVE CC-ACCT-ID-N                TO CARD-UPDATE-ACCT-ID              \n           MOVE CCUP-NEW-CVV-CD             TO CARD-CVV-CD-X                    \n           MOVE CARD-CVV-CD-N               TO CARD-UPDATE-CVV-CD               \n           MOVE CCUP-NEW-CRDNAME            TO CARD-UPDATE-EMBOSSED-NAME        \n           STRING  CCUP-NEW-EXPYEAR                                             \n                   '-'                                                          \n                   CCUP-NEW-EXPMON                                              \n                   '-'                                                          \n                   CCUP-NEW-EXPDAY                                              \n                   DELIMITED BY SIZE                                            \n              INTO CARD-UPDATE-EXPIRAION-DATE                                   \n           END-STRING                                                           \n           MOVE CCUP-NEW-CRDSTCD            TO CARD-UPDATE-ACTIVE-STATUS        \n                                                                                \n           EXEC CICS                                                            \n                REWRITE FILE(LIT-CARDFILENAME)                                  \n                        FROM(CARD-UPDATE-RECORD)                                \n                        LENGTH(LENGTH OF CARD-UPDATE-RECORD)                    \n                        RESP      (WS-RESP-CD)                                  \n                        RESP2     (WS-REAS-CD)                                  \n           END-EXEC.                                                            \n                                                                                \n      *****************************************************************         \n      * Did the update succeed ?  *                                             \n      *****************************************************************         \n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)                               \n             CONTINUE                                                           \n           ELSE                                                                 \n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE                            \n           END-IF                                                               \n           .                                                                    \n       9200-WRITE-PROCESSING-EXIT.                                              \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9300-CHECK-CHANGE-IN-REC.                                                \n           INSPECT CARD-EMBOSSED-NAME                                           \n           CONVERTING LIT-LOWER                                                 \n                   TO LIT-UPPER                                                 \n                                                                                \n           IF  CARD-CVV-CD              EQUAL  TO CCUP-OLD-CVV-CD               \n           AND CARD-EMBOSSED-NAME       EQUAL  TO CCUP-OLD-CRDNAME              \n           AND CARD-EXPIRAION-DATE(1:4) EQUAL  TO CCUP-OLD-EXPYEAR              \n           AND CARD-EXPIRAION-DATE(6:2) EQUAL  TO CCUP-OLD-EXPMON               \n           AND CARD-EXPIRAION-DATE(9:2) EQUAL  TO CCUP-OLD-EXPDAY               \n           AND CARD-ACTIVE-STATUS       EQUAL  TO CCUP-OLD-CRDSTCD              \n               CONTINUE                                                         \n           ELSE                                                                 \n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE                        \n              MOVE CARD-CVV-CD                 TO CCUP-OLD-CVV-CD               \n              MOVE CARD-EMBOSSED-NAME          TO CCUP-OLD-CRDNAME              \n              MOVE CARD-EXPIRAION-DATE(1:4)    TO CCUP-OLD-EXPYEAR              \n              MOVE CARD-EXPIRAION-DATE(6:2)    TO CCUP-OLD-EXPMON               \n              MOVE CARD-EXPIRAION-DATE(9:2)    TO CCUP-OLD-EXPDAY               \n              MOVE CARD-ACTIVE-STATUS          TO CCUP-OLD-CRDSTCD              \n              GO TO 9200-WRITE-PROCESSING-EXIT                                  \n           END-IF EXIT                                                          \n           .                                                                    \n       9300-CHECK-CHANGE-IN-REC-EXIT.                                           \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      ******************************************************************        \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .                                                           \n                                                                        340000\n       ABEND-ROUTINE.                                                           \n                                                                                \n           IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n                            ERASE                                               \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n       ABEND-ROUTINE-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CVACT02Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVCUS01Y",
        "COTTL01Y",
        "COCRDUP",
        "CSMSG02Y",
        "DFHAID",
        "CVACT03Y",
        "CSSTRPFY",
        "CVACT01Y",
        "CVCRD01Y"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant Main as 0000-MAIN\n    participant ProcessInputs as 1000-PROCESS-INPUTS\n    participant DecideAction as 2000-DECIDE-ACTION\n    participant SendMap as 3000-SEND-MAP\n    participant ReadData as 9000-READ-DATA\n    participant WriteProcessing as 9200-WRITE-PROCESSING\n    participant CICS as CICS System\n    \n    User->>Main: Start transaction\n    activate Main\n    \n    Main->>CICS: HANDLE ABEND\n    Main->>Main: Initialize working storage\n    \n    alt First time entry or from menu\n        Main->>Main: Initialize commarea\n        Main->>SendMap: Display initial screen\n        SendMap-->>User: Show search screen\n    else Coming from card list screen\n        Main->>ReadData: Fetch card details\n        ReadData->>CICS: READ card file\n        CICS-->>ReadData: Return card data\n        Main->>SendMap: Display card details\n        SendMap-->>User: Show card details\n    else Processing user input\n        Main->>ProcessInputs: Process map inputs\n        activate ProcessInputs\n        ProcessInputs->>CICS: RECEIVE MAP\n        CICS-->>ProcessInputs: Return user input\n        ProcessInputs->>ProcessInputs: Validate inputs\n        deactivate ProcessInputs\n        \n        Main->>DecideAction: Determine next action\n        activate DecideAction\n        \n        alt No details fetched yet\n            DecideAction->>ReadData: Retrieve card data\n            ReadData->>CICS: READ card file\n            CICS-->>ReadData: Return card data\n        else Changes made and confirmed\n            DecideAction->>WriteProcessing: Update card record\n            activate WriteProcessing\n            WriteProcessing->>CICS: READ with UPDATE\n            CICS-->>WriteProcessing: Return locked record\n            WriteProcessing->>WriteProcessing: Check for concurrent changes\n            WriteProcessing->>CICS: REWRITE record\n            CICS-->>WriteProcessing: Update confirmation\n            deactivate WriteProcessing\n        end\n        \n        deactivate DecideAction\n        \n        Main->>SendMap: Display appropriate screen\n        SendMap-->>User: Show updated screen\n    end\n    \n    alt User pressed PF03 or finished\n        Main->>CICS: SYNCPOINT\n        Main->>CICS: XCTL to next program\n    else Continue processing\n        Main->>CICS: RETURN with commarea\n    end\n    \n    deactivate Main"
    },
    {
      "id": "CBACT01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.                                                            \n           SELECT ACCTFILE-FILE ASSIGN TO ACCTFILE                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-ACCT-ID                                    \n                  FILE STATUS  IS ACCTFILE-STATUS.                              \n      *",
            "description": "This environment section defines the file control parameters for ACCTFILE-FILE, which is the indexed VSAM file containing account records. The file is configured for sequential access mode, using FD-ACCT-ID as the record key. File operations status will be tracked through the ACCTFILE-STATUS field, allowing the program to implement error handling for file operations. The file is externally assigned to the ACCTFILE DD name, which would be defined in the JCL that executes this program."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  ACCTFILE-FILE.                                                       \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).",
            "description": "This section defines the file structure for ACCTFILE-FILE, which contains account records being processed by the program. Each record consists of two fields: an 11-digit numeric account identifier (FD-ACCT-ID) and a 289-character data portion (FD-ACCT-DATA) that holds the remaining account information. This structure allows the program to access the account ID separately from the rest of the account data when reading records from the VSAM file."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************         \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************",
            "description": "This Working Storage Section defines the data structures used for file status tracking and error handling in the CBACT01C program. It includes the CVACT01Y copybook, file status fields for the ACCTFILE (ACCTFILE-STATUS), and general I/O status tracking variables. The section contains binary fields for status code conversion, application result codes with condition names for success (APPL-AOK) and end-of-file (APPL-EOF) states, an END-OF-FILE flag, and fields for storing abend codes and timing information. These variables support the program's file operations and error handling capabilities when processing account records."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.                                                            \n       FD  ACCTFILE-FILE.                                                       \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "1000-ACCTFILE-GET-NEXT",
            "code": "READ ACCTFILE-FILE INTO ACCOUNT-RECORD.                              \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n               PERFORM 1100-DISPLAY-ACCT-RECORD                                 \n           ELSE                                                                 \n               IF  ACCTFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING ACCOUNT FILE'                         \n                   MOVE ACCTFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the sequential reading of account records from the ACCTFILE. It reads the next record into the ACCOUNT-RECORD structure and processes the result based on the file status. If the read is successful (status '00'), it sets APPL-RESULT to 0 and displays the account record by calling the 1100-DISPLAY-ACCT-RECORD paragraph. If the end of file is reached (status '10'), it sets APPL-RESULT to 16. For any other file status, it sets APPL-RESULT to 12, indicating an error. The paragraph then evaluates APPL-RESULT: if processing is successful, it continues; if end-of-file is detected, it sets the END-OF-FILE flag to 'Y'; for any other error, it displays an error message, shows the file status via 9910-DISPLAY-IO-STATUS, and terminates the program by calling 9999-ABEND-PROGRAM."
          },
          {
            "name": "1100-DISPLAY-ACCT-RECORD",
            "code": "DISPLAY 'ACCT-ID                 :'   ACCT-ID                        \n           DISPLAY 'ACCT-ACTIVE-STATUS      :'   ACCT-ACTIVE-STATUS             \n           DISPLAY 'ACCT-CURR-BAL           :'   ACCT-CURR-BAL                  \n           DISPLAY 'ACCT-CREDIT-LIMIT       :'   ACCT-CREDIT-LIMIT              \n           DISPLAY 'ACCT-CASH-CREDIT-LIMIT  :'   ACCT-CASH-CREDIT-LIMIT         \n           DISPLAY 'ACCT-OPEN-DATE          :'   ACCT-OPEN-DATE                 \n           DISPLAY 'ACCT-EXPIRAION-DATE     :'   ACCT-EXPIRAION-DATE            \n           DISPLAY 'ACCT-REISSUE-DATE       :'   ACCT-REISSUE-DATE              \n           DISPLAY 'ACCT-CURR-CYC-CREDIT    :'   ACCT-CURR-CYC-CREDIT           \n           DISPLAY 'ACCT-CURR-CYC-DEBIT     :'   ACCT-CURR-CYC-DEBIT            \n           DISPLAY 'ACCT-GROUP-ID           :'   ACCT-GROUP-ID                  \n           DISPLAY '-------------------------------------------------'          \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph displays the details of an account record to the console output. It formats and prints all key account information including the account ID, active status, current balance, credit limits (both regular and cash), important dates (open date, expiration date, reissue date), current cycle credit and debit amounts, and the account group ID. After displaying all fields, it prints a separator line of dashes and exits the paragraph. This routine is used for data verification and debugging purposes when processing account records."
          },
          {
            "name": "0000-ACCTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT ACCTFILE-FILE                                             \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCTFILE'                                 \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the ACCTFILE-FILE for input processing. It initializes APPL-RESULT to 8, attempts to open the file, and then sets APPL-RESULT to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is not true), it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program with an abend. The paragraph includes proper error handling to ensure file access issues are clearly reported before program termination."
          },
          {
            "name": "9000-ACCTFILE-CLOSE",
            "code": "ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE ACCTFILE-FILE                                                  \n           IF  ACCTFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the ACCTFILE-FILE and includes error handling logic. It first sets APPL-RESULT to 8, then attempts to close the file. If the operation is successful (status code '00'), it resets APPL-RESULT to zero; otherwise, it sets APPL-RESULT to 12 to indicate an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display the I/O status details, and then terminates the program with an abend. This ensures proper resource cleanup and provides meaningful error information when file closing operations fail."
          },
          {
            "name": "9999-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************",
            "description": "This paragraph handles program termination when a critical error occurs. It displays an \"ABENDING PROGRAM\" message, resets the TIMING variable to zero, sets the abend code to 999, and then calls the Language Environment service 'CEE3ABD' to abnormally terminate the program. This provides a controlled way to end execution when unrecoverable errors are encountered, ensuring the program doesn't continue processing with invalid data or states."
          },
          {
            "name": "9910-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *",
            "description": "This paragraph handles the formatting and display of file I/O status codes for error reporting. When an I/O error occurs, it processes the status code differently based on whether it's numeric or if the first digit is '9' (indicating a serious error). For these special cases, it preserves the first digit and converts the second digit to a 4-digit display format. For standard numeric status codes, it formats them as a 4-digit code with leading zeros. The formatted status code is then displayed with a descriptive message to help with troubleshooting file operations. This standardized error reporting ensures consistent and clear communication of file operation issues."
          }
        ],
        "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBACT01C'.                    \n           PERFORM 0000-ACCTFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-ACCTFILE-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                       DISPLAY ACCOUNT-RECORD                                   \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-ACCTFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT01C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-ACCTFILE-GET-NEXT.                                                  \n           READ ACCTFILE-FILE INTO ACCOUNT-RECORD.                              \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n               PERFORM 1100-DISPLAY-ACCT-RECORD                                 \n           ELSE                                                                 \n               IF  ACCTFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING ACCOUNT FILE'                         \n                   MOVE ACCTFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1100-DISPLAY-ACCT-RECORD.                                                \n           DISPLAY 'ACCT-ID                 :'   ACCT-ID                        \n           DISPLAY 'ACCT-ACTIVE-STATUS      :'   ACCT-ACTIVE-STATUS             \n           DISPLAY 'ACCT-CURR-BAL           :'   ACCT-CURR-BAL                  \n           DISPLAY 'ACCT-CREDIT-LIMIT       :'   ACCT-CREDIT-LIMIT              \n           DISPLAY 'ACCT-CASH-CREDIT-LIMIT  :'   ACCT-CASH-CREDIT-LIMIT         \n           DISPLAY 'ACCT-OPEN-DATE          :'   ACCT-OPEN-DATE                 \n           DISPLAY 'ACCT-EXPIRAION-DATE     :'   ACCT-EXPIRAION-DATE            \n           DISPLAY 'ACCT-REISSUE-DATE       :'   ACCT-REISSUE-DATE              \n           DISPLAY 'ACCT-CURR-CYC-CREDIT    :'   ACCT-CURR-CYC-CREDIT           \n           DISPLAY 'ACCT-CURR-CYC-DEBIT     :'   ACCT-CURR-CYC-DEBIT            \n           DISPLAY 'ACCT-GROUP-ID           :'   ACCT-GROUP-ID                  \n           DISPLAY '-------------------------------------------------'          \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-ACCTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT ACCTFILE-FILE                                             \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCTFILE'                                 \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-ACCTFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE ACCTFILE-FILE                                                  \n           IF  ACCTFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *"
      },
      "description": "This batch COBOL program (CBACT01C) reads and displays account data from an indexed VSAM file. It sequentially processes account records from the ACCTFILE, displaying detailed account information for each record including account ID, status, balance, credit limits, and dates. The program includes comprehensive error handling for file operations, with specific routines for opening, reading, and closing the file. If any file operation errors occur, the program displays the error status and terminates with an abend. The program is part of the CardDemo application, which demonstrates AWS and partner technologies for mainframe migration and modernization scenarios.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBACT01C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : Read and print account data file.                 \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.    CBACT01C.                                                 \n       AUTHOR.        AWS.                                                      \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n       FILE-CONTROL.                                                            \n           SELECT ACCTFILE-FILE ASSIGN TO ACCTFILE                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-ACCT-ID                                    \n                  FILE STATUS  IS ACCTFILE-STATUS.                              \n      *                                                                         \n       DATA DIVISION.                                                           \n       FILE SECTION.                                                            \n       FD  ACCTFILE-FILE.                                                       \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n                                                                                \n      *****************************************************************         \n       PROCEDURE DIVISION.                                                      \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBACT01C'.                    \n           PERFORM 0000-ACCTFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-ACCTFILE-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                       DISPLAY ACCOUNT-RECORD                                   \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-ACCTFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT01C'.                      \n                                                                                \n           GOBACK.                                                              \n                                                                                \n      *****************************************************************         \n      * I/O ROUTINES TO ACCESS A KSDS, VSAM DATA SET...               *         \n      *****************************************************************         \n       1000-ACCTFILE-GET-NEXT.                                                  \n           READ ACCTFILE-FILE INTO ACCOUNT-RECORD.                              \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n               PERFORM 1100-DISPLAY-ACCT-RECORD                                 \n           ELSE                                                                 \n               IF  ACCTFILE-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING ACCOUNT FILE'                         \n                   MOVE ACCTFILE-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1100-DISPLAY-ACCT-RECORD.                                                \n           DISPLAY 'ACCT-ID                 :'   ACCT-ID                        \n           DISPLAY 'ACCT-ACTIVE-STATUS      :'   ACCT-ACTIVE-STATUS             \n           DISPLAY 'ACCT-CURR-BAL           :'   ACCT-CURR-BAL                  \n           DISPLAY 'ACCT-CREDIT-LIMIT       :'   ACCT-CREDIT-LIMIT              \n           DISPLAY 'ACCT-CASH-CREDIT-LIMIT  :'   ACCT-CASH-CREDIT-LIMIT         \n           DISPLAY 'ACCT-OPEN-DATE          :'   ACCT-OPEN-DATE                 \n           DISPLAY 'ACCT-EXPIRAION-DATE     :'   ACCT-EXPIRAION-DATE            \n           DISPLAY 'ACCT-REISSUE-DATE       :'   ACCT-REISSUE-DATE              \n           DISPLAY 'ACCT-CURR-CYC-CREDIT    :'   ACCT-CURR-CYC-CREDIT           \n           DISPLAY 'ACCT-CURR-CYC-DEBIT     :'   ACCT-CURR-CYC-DEBIT            \n           DISPLAY 'ACCT-GROUP-ID           :'   ACCT-GROUP-ID                  \n           DISPLAY '-------------------------------------------------'          \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0000-ACCTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT ACCTFILE-FILE                                             \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCTFILE'                                 \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-ACCTFILE-CLOSE.                                                     \n           ADD 8 TO ZERO GIVING APPL-RESULT.                                    \n           CLOSE ACCTFILE-FILE                                                  \n           IF  ACCTFILE-STATUS = '00'                                           \n               SUBTRACT APPL-RESULT FROM APPL-RESULT                            \n           ELSE                                                                 \n               ADD 12 TO ZERO GIVING APPL-RESULT                                \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVACT01Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as Main Program\n    participant OpenFile as 0000-ACCTFILE-OPEN\n    participant GetNext as 1000-ACCTFILE-GET-NEXT\n    participant Display as 1100-DISPLAY-ACCT-RECORD\n    participant CloseFile as 9000-ACCTFILE-CLOSE\n    participant IOStatus as 9910-DISPLAY-IO-STATUS\n    participant Abend as 9999-ABEND-PROGRAM\n    participant VSAM as ACCTFILE (VSAM File)\n    \n    Main->>OpenFile: Call to open file\n    activate OpenFile\n    OpenFile->>VSAM: OPEN INPUT ACCTFILE-FILE\n    alt File opened successfully\n        VSAM-->>OpenFile: Status = '00'\n        OpenFile-->>Main: Return (APPL-RESULT = 0)\n    else File open error\n        VSAM-->>OpenFile: Error status\n        OpenFile->>IOStatus: PERFORM 9910-DISPLAY-IO-STATUS\n        OpenFile->>Abend: PERFORM 9999-ABEND-PROGRAM\n        Abend-->>Main: Program terminates\n    end\n    deactivate OpenFile\n    \n    loop Until END-OF-FILE = 'Y'\n        Main->>GetNext: Call to read next record\n        activate GetNext\n        GetNext->>VSAM: READ ACCTFILE-FILE\n        alt Read successful\n            VSAM-->>GetNext: Status = '00'\n            GetNext->>Display: PERFORM 1100-DISPLAY-ACCT-RECORD\n            activate Display\n            Display-->>GetNext: Return after displaying record\n            deactivate Display\n            GetNext-->>Main: Continue processing\n        else End of file\n            VSAM-->>GetNext: Status = '10'\n            GetNext-->>Main: Set END-OF-FILE = 'Y'\n        else Read error\n            VSAM-->>GetNext: Error status\n            GetNext->>IOStatus: PERFORM 9910-DISPLAY-IO-STATUS\n            GetNext->>Abend: PERFORM 9999-ABEND-PROGRAM\n            Abend-->>Main: Program terminates\n        end\n        deactivate GetNext\n    end\n    \n    Main->>CloseFile: Call to close file\n    activate CloseFile\n    CloseFile->>VSAM: CLOSE ACCTFILE-FILE\n    alt File closed successfully\n        VSAM-->>CloseFile: Status = '00'\n        CloseFile-->>Main: Return (APPL-RESULT = 0)\n    else File close error\n        VSAM-->>CloseFile: Error status\n        CloseFile->>IOStatus: PERFORM 9910-DISPLAY-IO-STATUS\n        CloseFile->>Abend: PERFORM 9999-ABEND-PROGRAM\n        Abend-->>Main: Program terminates\n    end\n    deactivate CloseFile"
    },
    {
      "id": "CBACT04C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.                                                            \n           SELECT TCATBAL-FILE ASSIGN TO TCATBALF                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-TRAN-CAT-KEY                               \n                  FILE STATUS  IS TCATBALF-STATUS.                              \n                                                                                \n           SELECT XREF-FILE ASSIGN TO   XREFFILE                                \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  ALTERNATE RECORD KEY IS FD-XREF-ACCT-ID                       \n                  FILE STATUS  IS XREFFILE-STATUS.                              \n                                                                                \n           SELECT ACCOUNT-FILE ASSIGN TO ACCTFILE                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-ACCT-ID                                    \n                  FILE STATUS  IS ACCTFILE-STATUS.                              \n                                                                                \n           SELECT DISCGRP-FILE ASSIGN TO DISCGRP                                \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-DISCGRP-KEY                                \n                  FILE STATUS  IS DISCGRP-STATUS.                               \n                                                                                \n           SELECT TRANSACT-FILE ASSIGN TO TRANSACT                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  FILE STATUS  IS TRANFILE-STATUS.                              \n                                                                                \n      *",
            "description": "This INPUT-OUTPUT SECTION defines the five key files used by the interest calculation program. It includes: 1) TCATBAL-FILE, an indexed file accessed sequentially that contains transaction category balances; 2) XREF-FILE, an indexed file accessed randomly by card number or account ID to cross-reference cards to accounts; 3) ACCOUNT-FILE, an indexed file accessed randomly by account ID to retrieve account information; 4) DISCGRP-FILE, an indexed file accessed randomly to retrieve disclosure group information containing interest rates; and 5) TRANSACT-FILE, a sequential output file where interest transaction records are written. Each file definition includes its organization, access mode, key fields, and associated file status variables for error handling."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  TCATBAL-FILE.                                                        \n       01  FD-TRAN-CAT-BAL-RECORD.                                              \n           05 FD-TRAN-CAT-KEY.                                                  \n              10 FD-TRANCAT-ACCT-ID             PIC 9(11).                      \n              10 FD-TRANCAT-TYPE-CD             PIC X(02).                      \n              10 FD-TRANCAT-CD                  PIC 9(04).                      \n           05 FD-FD-TRAN-CAT-DATA               PIC X(33).                      \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-CUST-NUM                  PIC 9(09).                      \n           05 FD-XREF-ACCT-ID                   PIC 9(11).                      \n           05 FD-XREF-FILLER                    PIC X(14).                      \n                                                                                \n       FD  DISCGRP-FILE.                                                        \n       01  FD-DISCGRP-REC.                                                      \n           05 FD-DISCGRP-KEY.                                                   \n              10 FD-DIS-ACCT-GROUP-ID           PIC X(10).                      \n              10 FD-DIS-TRAN-TYPE-CD            PIC X(02).                      \n              10 FD-DIS-TRAN-CAT-CD             PIC 9(04).                      \n           05 FD-DISCGRP-DATA                   PIC X(34).                      \n                                                                                \n       FD  ACCOUNT-FILE.                                                        \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       FD  TRANSACT-FILE.                                                       \n       01  FD-TRANFILE-REC.                                                     \n           05 FD-TRANS-ID                       PIC X(16).                      \n           05 FD-ACCT-DATA                      PIC X(334).",
            "description": "This File Section defines the file structures used by the CBACT04C program for interest calculation processing. It includes five key files:\n\n1. TCATBAL-FILE: Contains transaction category balance records with a composite key consisting of account ID, transaction type code, and transaction category code, followed by transaction category data.\n\n2. XREF-FILE: A cross-reference file that maps credit card numbers to customer numbers and account IDs, allowing the program to link transactions to the appropriate accounts.\n\n3. DISCGRP-FILE: Stores disclosure group information with interest rates, keyed by account group ID, transaction type code, and transaction category code. This file provides the interest rates used in calculations.\n\n4. ACCOUNT-FILE: Contains account master records identified by account ID, storing account details and balances that will be updated with calculated interest.\n\n5. TRANSACT-FILE: Used to write interest transaction records generated by the program, with each record containing a transaction ID and associated account data.\n\nThese file structures support the program's core functionality of retrieving account balances, looking up applicable interest rates, calculating interest, and recording the resulting transactions."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************         \n       COPY CVTRA01Y.                                                           \n       01  TCATBALF-STATUS.                                                     \n           05  TCATBALF-STAT1      PIC X.                                       \n           05  TCATBALF-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA02Y.                                                           \n       01  DISCGRP-STATUS.                                                      \n           05 DISCGRP-STAT1        PIC X.                                       \n           05 DISCGRP-STAT2        PIC X.                                       \n                                                                                \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA05Y.                                                           \n       01  TRANFILE-STATUS.                                                     \n           05  TRANFILE-STAT1      PIC X.                                       \n           05  TRANFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         \n       01  COBOL-TS.                                                            \n           05 COB-YYYY                  PIC X(04).                              \n           05 COB-MM                    PIC X(02).                              \n           05 COB-DD                    PIC X(02).                              \n           05 COB-HH                    PIC X(02).                              \n           05 COB-MIN                   PIC X(02).                              \n           05 COB-SS                    PIC X(02).                              \n           05 COB-MIL                   PIC X(02).                              \n           05 COB-REST                  PIC X(05).                              \n       01  DB2-FORMAT-TS                PIC X(26).                              \n       01  FILLER REDEFINES DB2-FORMAT-TS.                                      \n           06 DB2-YYYY                  PIC X(004).                      E      \n           06 DB2-STREEP-1              PIC X.                           -      \n           06 DB2-MM                    PIC X(002).                      M      \n           06 DB2-STREEP-2              PIC X.                           -      \n           06 DB2-DD                    PIC X(002).                      D      \n           06 DB2-STREEP-3              PIC X.                           -      \n           06 DB2-HH                    PIC X(002).                      U      \n           06 DB2-DOT-1                 PIC X.                                  \n           06 DB2-MIN                   PIC X(002).                             \n           06 DB2-DOT-2                 PIC X.                                  \n           06 DB2-SS                    PIC X(002).                             \n           06 DB2-DOT-3                 PIC X.                                  \n           06 DB2-MIL                   PIC 9(002).                             \n           06 DB2-REST                  PIC X(04).                              \n       01 WS-MISC-VARS.                                                         \n           05 WS-LAST-ACCT-NUM          PIC X(11) VALUE SPACES.                 \n           05 WS-MONTHLY-INT            PIC S9(09)V99.                          \n           05 WS-TOTAL-INT              PIC S9(09)V99.                          \n           05 WS-FIRST-TIME             PIC X(01) VALUE 'Y'.                    \n       01 WS-COUNTERS.                                                          \n           05 WS-RECORD-COUNT           PIC 9(09) VALUE 0.                      \n           05 WS-TRANID-SUFFIX          PIC 9(06) VALUE 0.",
            "description": "This Working Storage Section defines the data structures used by the CBACT04C program for interest calculation processing. It includes file status variables for all input/output files (transaction category balances, cross-reference, disclosure group, account master, and transaction files), each with two-byte status fields for error handling. The section incorporates several copybooks (CVTRA01Y, CVACT03Y, CVTRA02Y, CVACT01Y, CVTRA05Y) that likely contain record layouts for the various files processed.\n\nThe section also defines utility fields for binary-decimal conversion, application result codes with condition names for normal and end-of-file conditions, timestamp handling structures (with both COBOL and DB2 format representations), and program-specific working variables. These working variables include fields to track the last account number processed, monthly and total interest amounts, a first-time processing indicator, record counters, and a transaction ID suffix generator. These elements support the program's core functionality of calculating and recording interest charges for credit card accounts."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  EXTERNAL-PARMS.                                                      \n           05  PARM-LENGTH         PIC S9(04) COMP.                             \n           05  PARM-DATE           PIC X(10).                                   \n      *****************************************************************",
            "description": "This linkage section defines the external parameters passed to the program. It contains a structure named EXTERNAL-PARMS with two fields: PARM-LENGTH, a 4-digit signed computational field that stores the length of the parameter data, and PARM-DATE, a 10-character field that likely contains the processing date for interest calculations. These parameters allow the calling program to specify the date for which interest should be calculated."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.                                                            \n       FD  TCATBAL-FILE.                                                        \n       01  FD-TRAN-CAT-BAL-RECORD.                                              \n           05 FD-TRAN-CAT-KEY.                                                  \n              10 FD-TRANCAT-ACCT-ID             PIC 9(11).                      \n              10 FD-TRANCAT-TYPE-CD             PIC X(02).                      \n              10 FD-TRANCAT-CD                  PIC 9(04).                      \n           05 FD-FD-TRAN-CAT-DATA               PIC X(33).                      \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-CUST-NUM                  PIC 9(09).                      \n           05 FD-XREF-ACCT-ID                   PIC 9(11).                      \n           05 FD-XREF-FILLER                    PIC X(14).                      \n                                                                                \n       FD  DISCGRP-FILE.                                                        \n       01  FD-DISCGRP-REC.                                                      \n           05 FD-DISCGRP-KEY.                                                   \n              10 FD-DIS-ACCT-GROUP-ID           PIC X(10).                      \n              10 FD-DIS-TRAN-TYPE-CD            PIC X(02).                      \n              10 FD-DIS-TRAN-CAT-CD             PIC 9(04).                      \n           05 FD-DISCGRP-DATA                   PIC X(34).                      \n                                                                                \n       FD  ACCOUNT-FILE.                                                        \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       FD  TRANSACT-FILE.                                                       \n       01  FD-TRANFILE-REC.                                                     \n           05 FD-TRANS-ID                       PIC X(16).                      \n           05 FD-ACCT-DATA                      PIC X(334).                     \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVTRA01Y.                                                           \n       01  TCATBALF-STATUS.                                                     \n           05  TCATBALF-STAT1      PIC X.                                       \n           05  TCATBALF-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA02Y.                                                           \n       01  DISCGRP-STATUS.                                                      \n           05 DISCGRP-STAT1        PIC X.                                       \n           05 DISCGRP-STAT2        PIC X.                                       \n                                                                                \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA05Y.                                                           \n       01  TRANFILE-STATUS.                                                     \n           05  TRANFILE-STAT1      PIC X.                                       \n           05  TRANFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         \n       01  COBOL-TS.                                                            \n           05 COB-YYYY                  PIC X(04).                              \n           05 COB-MM                    PIC X(02).                              \n           05 COB-DD                    PIC X(02).                              \n           05 COB-HH                    PIC X(02).                              \n           05 COB-MIN                   PIC X(02).                              \n           05 COB-SS                    PIC X(02).                              \n           05 COB-MIL                   PIC X(02).                              \n           05 COB-REST                  PIC X(05).                              \n       01  DB2-FORMAT-TS                PIC X(26).                              \n       01  FILLER REDEFINES DB2-FORMAT-TS.                                      \n           06 DB2-YYYY                  PIC X(004).                      E      \n           06 DB2-STREEP-1              PIC X.                           -      \n           06 DB2-MM                    PIC X(002).                      M      \n           06 DB2-STREEP-2              PIC X.                           -      \n           06 DB2-DD                    PIC X(002).                      D      \n           06 DB2-STREEP-3              PIC X.                           -      \n           06 DB2-HH                    PIC X(002).                      U      \n           06 DB2-DOT-1                 PIC X.                                  \n           06 DB2-MIN                   PIC X(002).                             \n           06 DB2-DOT-2                 PIC X.                                  \n           06 DB2-SS                    PIC X(002).                             \n           06 DB2-DOT-3                 PIC X.                                  \n           06 DB2-MIL                   PIC 9(002).                             \n           06 DB2-REST                  PIC X(04).                              \n       01 WS-MISC-VARS.                                                         \n           05 WS-LAST-ACCT-NUM          PIC X(11) VALUE SPACES.                 \n           05 WS-MONTHLY-INT            PIC S9(09)V99.                          \n           05 WS-TOTAL-INT              PIC S9(09)V99.                          \n           05 WS-FIRST-TIME             PIC X(01) VALUE 'Y'.                    \n       01 WS-COUNTERS.                                                          \n           05 WS-RECORD-COUNT           PIC 9(09) VALUE 0.                      \n           05 WS-TRANID-SUFFIX          PIC 9(06) VALUE 0.                      \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  EXTERNAL-PARMS.                                                      \n           05  PARM-LENGTH         PIC S9(04) COMP.                             \n           05  PARM-DATE           PIC X(10).                                   \n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-TCATBALF-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TCATBAL-FILE                                              \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION CATEGORY BALANCE'             \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the Transaction Category Balance file for input processing. It sets an initial result code of 8, attempts to open the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the file opens successfully (APPL-AOK condition), processing continues. Otherwise, the paragraph displays an error message about the failed file open operation, calls a routine to display the specific I/O status code, and then aborts the program execution by calling the program termination routine. This ensures proper error handling when the critical transaction category balance file cannot be accessed."
          },
          {
            "name": "0100-XREFFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'   XREFFILE-STATUS         \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the cross-reference file (XREF-FILE) used in the interest calculation process. It initializes the application result code to 8, attempts to open the file in input mode, and then sets the result code to 0 if successful or 12 if unsuccessful. If the file fails to open (indicated by APPL-AOK being false), the paragraph displays an error message showing the file status, calls a routine to display detailed I/O status information, and then aborts the program execution. This ensures that the program cannot proceed without proper access to the cross-reference data needed for interest calculations."
          },
          {
            "name": "0200-DISCGRP-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DISCGRP-FILE                                              \n           IF  DISCGRP-STATUS = '00'                                            \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALY REJECTS FILE'                        \n               MOVE DISCGRP-STATUS TO IO-STATUS                                 \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the disclosure group file (DISCGRP-FILE) which contains interest rate information. It initializes the application result code to 8, attempts to open the file in INPUT mode, and then sets the result code to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message (though incorrectly referencing \"DALY REJECTS FILE\" instead of the disclosure group file), logs the file status code, and abends the program. This is a critical initialization step as the disclosure group file provides the interest rates needed for the program's core interest calculation functionality."
          },
          {
            "name": "0300-ACCTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O ACCOUNT-FILE                                                \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCOUNT MASTER FILE'                      \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the Account Master File in I-O (input-output) mode. It sets an initial result code of 8, attempts to open the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, calls a routine to display the specific I/O status code, and then abends the program. This is a critical error-handling routine since the Account Master File is essential for the interest calculation process."
          },
          {
            "name": "0400-TRANFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT TRANSACT-FILE                                            \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the transaction output file. It initializes the application result code to 8, attempts to open the transaction file in output mode, and then sets the result code to 0 if successful or 12 if unsuccessful. If the operation fails (APPL-AOK is false), it displays an error message, retrieves the file status code, calls procedures to display the I/O status details and abnormally terminate the program. This is part of the program's initialization process and includes error handling to ensure the transaction file is properly available before proceeding with interest calculations."
          },
          {
            "name": "1000-TCATBALF-GET-NEXT",
            "code": "READ TCATBAL-FILE INTO TRAN-CAT-BAL-RECORD.                          \n           IF  TCATBALF-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               IF  TCATBALF-STATUS  = '10'                                      \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING TRANSACTION CATEGORY FILE'            \n                   MOVE TCATBALF-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph reads the next record from the Transaction Category Balance file (TCATBAL-FILE) into the TRAN-CAT-BAL-RECORD structure. It handles three possible outcomes: successful read (status '00'), end-of-file condition (status '10'), or a read error (any other status). For successful reads, processing continues normally. When end-of-file is reached, it sets the END-OF-FILE flag to 'Y'. For any other file status, it displays an error message, calls routines to display the I/O status details, and abends the program. This paragraph is a critical part of the main processing loop that retrieves transaction category balances for interest calculation."
          },
          {
            "name": "1050-UPDATE-ACCOUNT",
            "code": "* Update the balances in account record to reflect posted trans.          \n           ADD WS-TOTAL-INT  TO ACCT-CURR-BAL                                   \n           MOVE 0 TO ACCT-CURR-CYC-CREDIT                                       \n           MOVE 0 TO ACCT-CURR-CYC-DEBIT                                        \n                                                                                \n           REWRITE FD-ACCTFILE-REC FROM  ACCOUNT-RECORD                         \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR RE-WRITING ACCOUNT FILE'                          \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph updates the account record with the calculated interest charges. It adds the total interest amount (WS-TOTAL-INT) to the current account balance (ACCT-CURR-BAL) and resets the current cycle credit and debit amounts to zero. The updated account record is then rewritten to the account file. If the rewrite operation is successful (status '00'), processing continues normally. Otherwise, the program displays an error message, shows the I/O status code, and terminates abnormally. This paragraph is crucial for maintaining accurate account balances after interest calculations have been applied."
          },
          {
            "name": "1100-GET-ACCT-DATA",
            "code": "READ ACCOUNT-FILE INTO ACCOUNT-RECORD                                \n               INVALID KEY                                                      \n                  DISPLAY 'ACCOUNT NOT FOUND: ' FD-ACCT-ID                      \n           END-READ                                                             \n                                                                                \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph retrieves account data from the ACCOUNT-FILE using the account ID stored in FD-ACCT-ID. It performs error handling by checking the file status after the read operation. If the account is successfully read (status '00'), processing continues normally. If the account is not found or another error occurs, the paragraph displays an error message, logs the file status, and terminates the program through the 9999-ABEND-PROGRAM routine. This is a critical data retrieval step that ensures the program has valid account information before proceeding with interest calculations."
          },
          {
            "name": "1110-GET-XREF-DATA",
            "code": "READ XREF-FILE INTO CARD-XREF-RECORD                                 \n            KEY IS FD-XREF-ACCT-ID                                              \n               INVALID KEY                                                      \n                  DISPLAY 'ACCOUNT NOT FOUND: ' FD-XREF-ACCT-ID                 \n           END-READ                                                             \n                                                                                \n           IF  XREFFILE-STATUS   = '00'                                         \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING XREF FILE'                                \n               MOVE XREFFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph retrieves cross-reference data for a credit card account from the XREF-FILE using the account ID as the key. It reads a record into CARD-XREF-RECORD and handles the case when an account is not found by displaying an error message. The paragraph sets APPL-RESULT to 0 for successful reads or 12 for failures. If the read operation fails, it displays an error message, captures the file status code, calls a routine to display the I/O status details, and then aborts the program execution. This cross-reference data is essential for linking account information with the appropriate card details during the interest calculation process."
          },
          {
            "name": "1200-GET-INTEREST-RATE",
            "code": "READ DISCGRP-FILE INTO DIS-GROUP-RECORD                              \n                INVALID KEY                                                     \n                   DISPLAY 'DISCLOSURE GROUP RECORD MISSING'                    \n                   DISPLAY 'TRY WITH DEFAULT GROUP CODE'                        \n           END-READ.                                                            \n                                                                                \n           IF  DISCGRP-STATUS  = '00'  OR '23'                                  \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING DISCLOSURE GROUP FILE'                    \n               MOVE DISCGRP-STATUS  TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           IF  DISCGRP-STATUS  = '23'                                           \n               MOVE 'DEFAULT' TO FD-DIS-ACCT-GROUP-ID                           \n               PERFORM 1200-A-GET-DEFAULT-INT-RATE                              \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph retrieves the interest rate from the disclosure group file based on the account group ID. It first attempts to read the record from the DISCGRP-FILE. If the record is found (status '00') or not found (status '23'), it sets APPL-RESULT to 0 indicating normal processing. For any other file status, it sets APPL-RESULT to 12, displays an error message, and abends the program after showing the I/O status. When a specific disclosure group record is not found (status '23'), the paragraph switches to using a default group code by setting FD-DIS-ACCT-GROUP-ID to 'DEFAULT' and calling the 1200-A-GET-DEFAULT-INT-RATE paragraph to retrieve the default interest rate. This ensures the program can continue processing even when specific interest rate information is unavailable."
          },
          {
            "name": "1200-A-GET-DEFAULT-INT-RATE",
            "code": "READ DISCGRP-FILE INTO DIS-GROUP-RECORD                              \n                                                                                \n           IF  DISCGRP-STATUS  = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING DEFAULT DISCLOSURE GROUP'                 \n               MOVE DISCGRP-STATUS  TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph retrieves the default interest rate from the disclosure group file. It attempts to read a record from the DISCGRP-FILE into the DIS-GROUP-RECORD structure. If the read operation is successful (status '00'), it sets APPL-RESULT to 0 indicating success. If the read fails, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message about failing to read the default disclosure group, calls a routine to display the I/O status code, and then abends the program. This functionality serves as a fallback mechanism when specific interest rates cannot be found for an account."
          },
          {
            "name": "1300-COMPUTE-INTEREST",
            "code": "COMPUTE WS-MONTHLY-INT                                               \n            = ( TRAN-CAT-BAL * DIS-INT-RATE) / 1200                             \n                                                                                \n           ADD WS-MONTHLY-INT  TO WS-TOTAL-INT                                  \n           PERFORM 1300-B-WRITE-TX.                                             \n                                                                                \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph calculates the monthly interest for a credit card account based on the transaction category balance and the applicable interest rate. It divides the interest rate by 1200 (converting the annual percentage rate to a monthly decimal rate) and multiplies it by the balance to determine the interest amount. The calculated interest is then added to a running total (WS-TOTAL-INT) to track the cumulative interest across all processed transactions. After calculation, it calls the 1300-B-WRITE-TX paragraph to generate a transaction record for the interest charge."
          },
          {
            "name": "1300-B-WRITE-TX",
            "code": "ADD 1 TO WS-TRANID-SUFFIX                                            \n                                                                                \n           STRING PARM-DATE,                                                    \n                  WS-TRANID-SUFFIX                                              \n             DELIMITED BY SIZE                                                  \n             INTO TRAN-ID                                                       \n           END-STRING.                                                          \n                                                                                \n           MOVE '01'                 TO TRAN-TYPE-CD                            \n           MOVE '05'                 TO TRAN-CAT-CD                             \n           MOVE 'System'             TO TRAN-SOURCE                             \n           STRING 'Int. for a/c ' ,                                             \n                  ACCT-ID                                                       \n                  DELIMITED BY SIZE                                             \n            INTO TRAN-DESC                                                      \n           END-STRING                                                           \n           MOVE WS-MONTHLY-INT       TO TRAN-AMT                                \n           MOVE 0                    TO TRAN-MERCHANT-ID                        \n           MOVE SPACES               TO TRAN-MERCHANT-NAME                      \n           MOVE SPACES               TO TRAN-MERCHANT-CITY                      \n           MOVE SPACES               TO TRAN-MERCHANT-ZIP                       \n           MOVE XREF-CARD-NUM        TO TRAN-CARD-NUM                           \n           PERFORM Z-GET-DB2-FORMAT-TIMESTAMP                                   \n           MOVE DB2-FORMAT-TS        TO TRAN-ORIG-TS                            \n           MOVE DB2-FORMAT-TS        TO TRAN-PROC-TS                            \n                                                                                \n           WRITE FD-TRANFILE-REC FROM TRAN-RECORD                               \n           IF  TRANFILE-STATUS   = '00'                                         \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TRANSACTION RECORD'                       \n               MOVE TRANFILE-STATUS   TO IO-STATUS                              \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph generates and writes interest transaction records to the transaction file. It first creates a unique transaction ID by concatenating the parameter date with an incremented suffix counter. The paragraph then populates the transaction record with specific values for an interest charge, including setting the transaction type code to '01', category code to '05', and source to 'System'. It constructs a description that includes the account ID, assigns the calculated monthly interest amount, sets the card number from cross-reference data, and obtains a timestamp for both the original and processing timestamps. After writing the record to the transaction file, it performs error handling to verify the write operation was successful, displaying an error message and aborting the program if the write fails. This ensures each interest calculation is properly recorded as a transaction in the system with appropriate audit information."
          },
          {
            "name": "1400-COMPUTE-FEES",
            "code": "* To be implemented                                                       \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph is a placeholder for future functionality related to fee computation. It currently contains only an EXIT statement with a comment indicating that the fee calculation logic is yet to be implemented. This suggests that while the program currently handles interest calculations, the capability to compute additional fees has been identified as a requirement but not yet developed."
          },
          {
            "name": "9000-TCATBALF-CLOSE",
            "code": "MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE TCATBAL-FILE                                                   \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the Transaction Category Balance file (TCATBAL-FILE). It sets an initial result code of 8, attempts to close the file, and then checks the status. If the file closes successfully (status '00'), it sets the result code to 0. If the close operation fails, it sets the result code to 12. When an error occurs, the paragraph displays an error message, captures the file status code, displays the I/O status details, and aborts the program execution. This is part of the program's cleanup and error handling mechanism to ensure proper file closure before program termination."
          },
          {
            "name": "9100-XREFFILE-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the cross-reference file (XREF-FILE) with error handling. It sets an initial result code of 8, attempts to close the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the close operation fails, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then aborts the program execution. This ensures proper file closure and appropriate error handling for maintaining data integrity."
          },
          {
            "name": "9200-DISCGRP-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DISCGRP-FILE                                                   \n           IF  DISCGRP-STATUS = '00'                                            \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DISCLOSURE GROUP FILE'                    \n               MOVE DISCGRP-STATUS TO IO-STATUS                                 \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the Disclosure Group file, which contains interest rate information used in the credit card interest calculation process. It sets an initial result code of 8, attempts to close the file, and then updates the result code based on the operation's success (0) or failure (12). If the file closes successfully, processing continues; otherwise, the paragraph displays an error message about the Disclosure Group file closure failure, calls a routine to display the specific I/O status code, and then aborts the program execution by calling the program termination routine. This error handling ensures that any file closure issues are properly identified and logged before program termination."
          },
          {
            "name": "9300-ACCTFILE-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE ACCOUNT-FILE                                                   \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the Account File with error handling. It initially sets a result code of 8, attempts to close the file, and then sets the result to 0 if successful or 12 if unsuccessful. If the close operation fails, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper file closure and provides meaningful error information if the operation fails."
          },
          {
            "name": "9400-TRANFILE-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANSACT-FILE                                                  \n           IF  TRANFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the transaction file and performs error handling. It sets an initial result code of 8, attempts to close the TRANSACT-FILE, and then sets the result code to 0 if successful or 12 if unsuccessful. If the close operation fails (APPL-AOK is false), it displays an error message, captures the file status code, displays the I/O status details, and aborts the program execution. The paragraph ensures proper file closure and appropriate error handling for transaction file operations."
          },
          {
            "name": "Z-GET-DB2-FORMAT-TIMESTAMP",
            "code": "MOVE FUNCTION CURRENT-DATE TO COBOL-TS                               \n           MOVE COB-YYYY TO DB2-YYYY                                            \n           MOVE COB-MM   TO DB2-MM                                              \n           MOVE COB-DD   TO DB2-DD                                              \n           MOVE COB-HH   TO DB2-HH                                              \n           MOVE COB-MIN  TO DB2-MIN                                             \n           MOVE COB-SS   TO DB2-SS                                              \n           MOVE COB-MIL  TO DB2-MIL                                             \n           MOVE '0000'   TO DB2-REST                                            \n           MOVE '-' TO DB2-STREEP-1 DB2-STREEP-2 DB2-STREEP-3                   \n           MOVE '.' TO DB2-DOT-1 DB2-DOT-2 DB2-DOT-3                            \n      *    DISPLAY 'DB2-TIMESTAMP = ' DB2-FORMAT-TS                             \n           EXIT.",
            "description": "This paragraph retrieves the current system date and time and formats it into a DB2-compatible timestamp format. It first obtains the current date using the FUNCTION CURRENT-DATE intrinsic function, then maps individual components (year, month, day, hour, minute, second, millisecond) from the COBOL timestamp structure to the corresponding DB2 timestamp fields. The paragraph adds necessary formatting characters like hyphens and decimal points to create a properly formatted DB2 timestamp, and sets the microsecond portion to zeros. This formatted timestamp is likely used for transaction logging or database operations within the credit card interest calculation process."
          },
          {
            "name": "9999-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************",
            "description": "This paragraph handles abnormal program termination by displaying an \"ABENDING PROGRAM\" message, resetting the timing variable to zero, setting an abend code of 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program abort. This is likely used as a last resort error handling mechanism when the program encounters a critical error that prevents further processing."
          },
          {
            "name": "9910-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *",
            "description": "This paragraph handles the formatting and display of file I/O status codes for error reporting. When an I/O operation encounters an issue, this routine formats the status code for consistent display. It has special handling for extended file status codes (where the first digit is '9'), converting the second byte to a binary value for proper representation. For standard file status codes, it formats them within a 4-character field. In both cases, the formatted status code is displayed with a descriptive prefix. This routine helps with troubleshooting by providing standardized error reporting for file operations throughout the program."
          }
        ],
        "code": "USING EXTERNAL-PARMS.                                 \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBACT04C'.                    \n           PERFORM 0000-TCATBALF-OPEN.                                          \n           PERFORM 0100-XREFFILE-OPEN.                                          \n           PERFORM 0200-DISCGRP-OPEN.                                           \n           PERFORM 0300-ACCTFILE-OPEN.                                          \n           PERFORM 0400-TRANFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-TCATBALF-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                     ADD 1 TO WS-RECORD-COUNT                                   \n                     DISPLAY TRAN-CAT-BAL-RECORD                                \n                     IF TRANCAT-ACCT-ID NOT= WS-LAST-ACCT-NUM                   \n                       IF WS-FIRST-TIME NOT = 'Y'                               \n                          PERFORM 1050-UPDATE-ACCOUNT                           \n                       ELSE                                                     \n                          MOVE 'N' TO WS-FIRST-TIME                             \n                       END-IF                                                   \n                       MOVE 0 TO WS-TOTAL-INT                                   \n                       MOVE TRANCAT-ACCT-ID TO WS-LAST-ACCT-NUM                 \n                       MOVE TRANCAT-ACCT-ID TO FD-ACCT-ID                       \n                       PERFORM 1100-GET-ACCT-DATA                               \n                       MOVE TRANCAT-ACCT-ID TO FD-XREF-ACCT-ID                  \n                       PERFORM 1110-GET-XREF-DATA                               \n                     END-IF                                                     \n      *              DISPLAY 'ACCT-GROUP-ID: ' ACCT-GROUP-ID                    \n      *              DISPLAY 'TRANCAT-CD: ' TRANCAT-CD                          \n      *              DISPLAY 'TRANCAT-TYPE-CD: ' TRANCAT-TYPE-CD                \n                     MOVE ACCT-GROUP-ID TO FD-DIS-ACCT-GROUP-ID                 \n                     MOVE TRANCAT-CD TO FD-DIS-TRAN-CAT-CD                      \n                     MOVE TRANCAT-TYPE-CD TO FD-DIS-TRAN-TYPE-CD                \n                     PERFORM 1200-GET-INTEREST-RATE                             \n                     IF DIS-INT-RATE NOT = 0                                    \n                       PERFORM 1300-COMPUTE-INTEREST                            \n                       PERFORM 1400-COMPUTE-FEES                                \n                     END-IF                                                     \n                   END-IF                                                       \n               ELSE                                                             \n                    PERFORM 1050-UPDATE-ACCOUNT                                 \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-TCATBALF-CLOSE.                                         \n           PERFORM 9100-XREFFILE-CLOSE.                                         \n           PERFORM 9200-DISCGRP-CLOSE.                                          \n           PERFORM 9300-ACCTFILE-CLOSE.                                         \n           PERFORM 9400-TRANFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT04C'.                      \n                                                                                \n           GOBACK.                                                              \n      *---------------------------------------------------------------*         \n       0000-TCATBALF-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TCATBAL-FILE                                              \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION CATEGORY BALANCE'             \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0100-XREFFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'   XREFFILE-STATUS         \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0200-DISCGRP-OPEN.                                                       \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DISCGRP-FILE                                              \n           IF  DISCGRP-STATUS = '00'                                            \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALY REJECTS FILE'                        \n               MOVE DISCGRP-STATUS TO IO-STATUS                                 \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       0300-ACCTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O ACCOUNT-FILE                                                \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCOUNT MASTER FILE'                      \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0400-TRANFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT TRANSACT-FILE                                            \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1000-TCATBALF-GET-NEXT.                                                  \n           READ TCATBAL-FILE INTO TRAN-CAT-BAL-RECORD.                          \n           IF  TCATBALF-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               IF  TCATBALF-STATUS  = '10'                                      \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING TRANSACTION CATEGORY FILE'            \n                   MOVE TCATBALF-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1050-UPDATE-ACCOUNT.                                                     \n      * Update the balances in account record to reflect posted trans.          \n           ADD WS-TOTAL-INT  TO ACCT-CURR-BAL                                   \n           MOVE 0 TO ACCT-CURR-CYC-CREDIT                                       \n           MOVE 0 TO ACCT-CURR-CYC-DEBIT                                        \n                                                                                \n           REWRITE FD-ACCTFILE-REC FROM  ACCOUNT-RECORD                         \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR RE-WRITING ACCOUNT FILE'                          \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1100-GET-ACCT-DATA.                                                      \n           READ ACCOUNT-FILE INTO ACCOUNT-RECORD                                \n               INVALID KEY                                                      \n                  DISPLAY 'ACCOUNT NOT FOUND: ' FD-ACCT-ID                      \n           END-READ                                                             \n                                                                                \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1110-GET-XREF-DATA.                                                      \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n            KEY IS FD-XREF-ACCT-ID                                              \n               INVALID KEY                                                      \n                  DISPLAY 'ACCOUNT NOT FOUND: ' FD-XREF-ACCT-ID                 \n           END-READ                                                             \n                                                                                \n           IF  XREFFILE-STATUS   = '00'                                         \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING XREF FILE'                                \n               MOVE XREFFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1200-GET-INTEREST-RATE.                                                  \n           READ DISCGRP-FILE INTO DIS-GROUP-RECORD                              \n                INVALID KEY                                                     \n                   DISPLAY 'DISCLOSURE GROUP RECORD MISSING'                    \n                   DISPLAY 'TRY WITH DEFAULT GROUP CODE'                        \n           END-READ.                                                            \n                                                                                \n           IF  DISCGRP-STATUS  = '00'  OR '23'                                  \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING DISCLOSURE GROUP FILE'                    \n               MOVE DISCGRP-STATUS  TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           IF  DISCGRP-STATUS  = '23'                                           \n               MOVE 'DEFAULT' TO FD-DIS-ACCT-GROUP-ID                           \n               PERFORM 1200-A-GET-DEFAULT-INT-RATE                              \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1200-A-GET-DEFAULT-INT-RATE.                                             \n           READ DISCGRP-FILE INTO DIS-GROUP-RECORD                              \n                                                                                \n           IF  DISCGRP-STATUS  = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING DEFAULT DISCLOSURE GROUP'                 \n               MOVE DISCGRP-STATUS  TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1300-COMPUTE-INTEREST.                                                   \n                                                                                \n           COMPUTE WS-MONTHLY-INT                                               \n            = ( TRAN-CAT-BAL * DIS-INT-RATE) / 1200                             \n                                                                                \n           ADD WS-MONTHLY-INT  TO WS-TOTAL-INT                                  \n           PERFORM 1300-B-WRITE-TX.                                             \n                                                                                \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1300-B-WRITE-TX.                                                         \n           ADD 1 TO WS-TRANID-SUFFIX                                            \n                                                                                \n           STRING PARM-DATE,                                                    \n                  WS-TRANID-SUFFIX                                              \n             DELIMITED BY SIZE                                                  \n             INTO TRAN-ID                                                       \n           END-STRING.                                                          \n                                                                                \n           MOVE '01'                 TO TRAN-TYPE-CD                            \n           MOVE '05'                 TO TRAN-CAT-CD                             \n           MOVE 'System'             TO TRAN-SOURCE                             \n           STRING 'Int. for a/c ' ,                                             \n                  ACCT-ID                                                       \n                  DELIMITED BY SIZE                                             \n            INTO TRAN-DESC                                                      \n           END-STRING                                                           \n           MOVE WS-MONTHLY-INT       TO TRAN-AMT                                \n           MOVE 0                    TO TRAN-MERCHANT-ID                        \n           MOVE SPACES               TO TRAN-MERCHANT-NAME                      \n           MOVE SPACES               TO TRAN-MERCHANT-CITY                      \n           MOVE SPACES               TO TRAN-MERCHANT-ZIP                       \n           MOVE XREF-CARD-NUM        TO TRAN-CARD-NUM                           \n           PERFORM Z-GET-DB2-FORMAT-TIMESTAMP                                   \n           MOVE DB2-FORMAT-TS        TO TRAN-ORIG-TS                            \n           MOVE DB2-FORMAT-TS        TO TRAN-PROC-TS                            \n                                                                                \n           WRITE FD-TRANFILE-REC FROM TRAN-RECORD                               \n           IF  TRANFILE-STATUS   = '00'                                         \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TRANSACTION RECORD'                       \n               MOVE TRANFILE-STATUS   TO IO-STATUS                              \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1400-COMPUTE-FEES.                                                       \n      * To be implemented                                                       \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-TCATBALF-CLOSE.                                                     \n           MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE TCATBAL-FILE                                                   \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9100-XREFFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9200-DISCGRP-CLOSE.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DISCGRP-FILE                                                   \n           IF  DISCGRP-STATUS = '00'                                            \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DISCLOSURE GROUP FILE'                    \n               MOVE DISCGRP-STATUS TO IO-STATUS                                 \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9300-ACCTFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE ACCOUNT-FILE                                                   \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9400-TRANFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANSACT-FILE                                                  \n           IF  TRANFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       Z-GET-DB2-FORMAT-TIMESTAMP.                                              \n           MOVE FUNCTION CURRENT-DATE TO COBOL-TS                               \n           MOVE COB-YYYY TO DB2-YYYY                                            \n           MOVE COB-MM   TO DB2-MM                                              \n           MOVE COB-DD   TO DB2-DD                                              \n           MOVE COB-HH   TO DB2-HH                                              \n           MOVE COB-MIN  TO DB2-MIN                                             \n           MOVE COB-SS   TO DB2-SS                                              \n           MOVE COB-MIL  TO DB2-MIL                                             \n           MOVE '0000'   TO DB2-REST                                            \n           MOVE '-' TO DB2-STREEP-1 DB2-STREEP-2 DB2-STREEP-3                   \n           MOVE '.' TO DB2-DOT-1 DB2-DOT-2 DB2-DOT-3                            \n      *    DISPLAY 'DB2-TIMESTAMP = ' DB2-FORMAT-TS                             \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *"
      },
      "description": "This program, CBACT04C, is a batch COBOL application that calculates interest for credit card accounts. It processes transaction category balances and applies appropriate interest rates based on account groups and transaction types. The program reads account balances from an indexed file, retrieves interest rates from a disclosure group file, calculates monthly interest, updates account balances, and generates interest transaction records.\n\nThe program works by sequentially reading transaction category balance records, looking up the associated account and card information, determining the applicable interest rate from a disclosure group file, calculating interest based on that rate, and then writing transaction records for the interest charges. It also updates the account master records with the new balances that include the calculated interest.\n\nKey features include the ability to fall back to default interest rates when specific rates aren't found, handling of multiple transaction categories per account, and proper maintenance of running totals for interest calculations. The program includes comprehensive error handling for file operations and maintains transaction audit trails by generating detailed transaction records for all interest charges.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBACT04C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : This is a interest calculator program.\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.    CBACT04C.                                                 \n       AUTHOR.        AWS.                                                      \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n       FILE-CONTROL.                                                            \n           SELECT TCATBAL-FILE ASSIGN TO TCATBALF                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  RECORD KEY   IS FD-TRAN-CAT-KEY                               \n                  FILE STATUS  IS TCATBALF-STATUS.                              \n                                                                                \n           SELECT XREF-FILE ASSIGN TO   XREFFILE                                \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  ALTERNATE RECORD KEY IS FD-XREF-ACCT-ID                       \n                  FILE STATUS  IS XREFFILE-STATUS.                              \n                                                                                \n           SELECT ACCOUNT-FILE ASSIGN TO ACCTFILE                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-ACCT-ID                                    \n                  FILE STATUS  IS ACCTFILE-STATUS.                              \n                                                                                \n           SELECT DISCGRP-FILE ASSIGN TO DISCGRP                                \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-DISCGRP-KEY                                \n                  FILE STATUS  IS DISCGRP-STATUS.                               \n                                                                                \n           SELECT TRANSACT-FILE ASSIGN TO TRANSACT                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  FILE STATUS  IS TRANFILE-STATUS.                              \n                                                                                \n      *                                                                         \n       DATA DIVISION.                                                           \n       FILE SECTION.                                                            \n       FD  TCATBAL-FILE.                                                        \n       01  FD-TRAN-CAT-BAL-RECORD.                                              \n           05 FD-TRAN-CAT-KEY.                                                  \n              10 FD-TRANCAT-ACCT-ID             PIC 9(11).                      \n              10 FD-TRANCAT-TYPE-CD             PIC X(02).                      \n              10 FD-TRANCAT-CD                  PIC 9(04).                      \n           05 FD-FD-TRAN-CAT-DATA               PIC X(33).                      \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-CUST-NUM                  PIC 9(09).                      \n           05 FD-XREF-ACCT-ID                   PIC 9(11).                      \n           05 FD-XREF-FILLER                    PIC X(14).                      \n                                                                                \n       FD  DISCGRP-FILE.                                                        \n       01  FD-DISCGRP-REC.                                                      \n           05 FD-DISCGRP-KEY.                                                   \n              10 FD-DIS-ACCT-GROUP-ID           PIC X(10).                      \n              10 FD-DIS-TRAN-TYPE-CD            PIC X(02).                      \n              10 FD-DIS-TRAN-CAT-CD             PIC 9(04).                      \n           05 FD-DISCGRP-DATA                   PIC X(34).                      \n                                                                                \n       FD  ACCOUNT-FILE.                                                        \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       FD  TRANSACT-FILE.                                                       \n       01  FD-TRANFILE-REC.                                                     \n           05 FD-TRANS-ID                       PIC X(16).                      \n           05 FD-ACCT-DATA                      PIC X(334).                     \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVTRA01Y.                                                           \n       01  TCATBALF-STATUS.                                                     \n           05  TCATBALF-STAT1      PIC X.                                       \n           05  TCATBALF-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA02Y.                                                           \n       01  DISCGRP-STATUS.                                                      \n           05 DISCGRP-STAT1        PIC X.                                       \n           05 DISCGRP-STAT2        PIC X.                                       \n                                                                                \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA05Y.                                                           \n       01  TRANFILE-STATUS.                                                     \n           05  TRANFILE-STAT1      PIC X.                                       \n           05  TRANFILE-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         \n       01  COBOL-TS.                                                            \n           05 COB-YYYY                  PIC X(04).                              \n           05 COB-MM                    PIC X(02).                              \n           05 COB-DD                    PIC X(02).                              \n           05 COB-HH                    PIC X(02).                              \n           05 COB-MIN                   PIC X(02).                              \n           05 COB-SS                    PIC X(02).                              \n           05 COB-MIL                   PIC X(02).                              \n           05 COB-REST                  PIC X(05).                              \n       01  DB2-FORMAT-TS                PIC X(26).                              \n       01  FILLER REDEFINES DB2-FORMAT-TS.                                      \n           06 DB2-YYYY                  PIC X(004).                      E      \n           06 DB2-STREEP-1              PIC X.                           -      \n           06 DB2-MM                    PIC X(002).                      M      \n           06 DB2-STREEP-2              PIC X.                           -      \n           06 DB2-DD                    PIC X(002).                      D      \n           06 DB2-STREEP-3              PIC X.                           -      \n           06 DB2-HH                    PIC X(002).                      U      \n           06 DB2-DOT-1                 PIC X.                                  \n           06 DB2-MIN                   PIC X(002).                             \n           06 DB2-DOT-2                 PIC X.                                  \n           06 DB2-SS                    PIC X(002).                             \n           06 DB2-DOT-3                 PIC X.                                  \n           06 DB2-MIL                   PIC 9(002).                             \n           06 DB2-REST                  PIC X(04).                              \n       01 WS-MISC-VARS.                                                         \n           05 WS-LAST-ACCT-NUM          PIC X(11) VALUE SPACES.                 \n           05 WS-MONTHLY-INT            PIC S9(09)V99.                          \n           05 WS-TOTAL-INT              PIC S9(09)V99.                          \n           05 WS-FIRST-TIME             PIC X(01) VALUE 'Y'.                    \n       01 WS-COUNTERS.                                                          \n           05 WS-RECORD-COUNT           PIC 9(09) VALUE 0.                      \n           05 WS-TRANID-SUFFIX          PIC 9(06) VALUE 0.                      \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  EXTERNAL-PARMS.                                                      \n           05  PARM-LENGTH         PIC S9(04) COMP.                             \n           05  PARM-DATE           PIC X(10).                                   \n      *****************************************************************         \n       PROCEDURE DIVISION USING EXTERNAL-PARMS.                                 \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBACT04C'.                    \n           PERFORM 0000-TCATBALF-OPEN.                                          \n           PERFORM 0100-XREFFILE-OPEN.                                          \n           PERFORM 0200-DISCGRP-OPEN.                                           \n           PERFORM 0300-ACCTFILE-OPEN.                                          \n           PERFORM 0400-TRANFILE-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-TCATBALF-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                     ADD 1 TO WS-RECORD-COUNT                                   \n                     DISPLAY TRAN-CAT-BAL-RECORD                                \n                     IF TRANCAT-ACCT-ID NOT= WS-LAST-ACCT-NUM                   \n                       IF WS-FIRST-TIME NOT = 'Y'                               \n                          PERFORM 1050-UPDATE-ACCOUNT                           \n                       ELSE                                                     \n                          MOVE 'N' TO WS-FIRST-TIME                             \n                       END-IF                                                   \n                       MOVE 0 TO WS-TOTAL-INT                                   \n                       MOVE TRANCAT-ACCT-ID TO WS-LAST-ACCT-NUM                 \n                       MOVE TRANCAT-ACCT-ID TO FD-ACCT-ID                       \n                       PERFORM 1100-GET-ACCT-DATA                               \n                       MOVE TRANCAT-ACCT-ID TO FD-XREF-ACCT-ID                  \n                       PERFORM 1110-GET-XREF-DATA                               \n                     END-IF                                                     \n      *              DISPLAY 'ACCT-GROUP-ID: ' ACCT-GROUP-ID                    \n      *              DISPLAY 'TRANCAT-CD: ' TRANCAT-CD                          \n      *              DISPLAY 'TRANCAT-TYPE-CD: ' TRANCAT-TYPE-CD                \n                     MOVE ACCT-GROUP-ID TO FD-DIS-ACCT-GROUP-ID                 \n                     MOVE TRANCAT-CD TO FD-DIS-TRAN-CAT-CD                      \n                     MOVE TRANCAT-TYPE-CD TO FD-DIS-TRAN-TYPE-CD                \n                     PERFORM 1200-GET-INTEREST-RATE                             \n                     IF DIS-INT-RATE NOT = 0                                    \n                       PERFORM 1300-COMPUTE-INTEREST                            \n                       PERFORM 1400-COMPUTE-FEES                                \n                     END-IF                                                     \n                   END-IF                                                       \n               ELSE                                                             \n                    PERFORM 1050-UPDATE-ACCOUNT                                 \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-TCATBALF-CLOSE.                                         \n           PERFORM 9100-XREFFILE-CLOSE.                                         \n           PERFORM 9200-DISCGRP-CLOSE.                                          \n           PERFORM 9300-ACCTFILE-CLOSE.                                         \n           PERFORM 9400-TRANFILE-CLOSE.                                         \n                                                                                \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBACT04C'.                      \n                                                                                \n           GOBACK.                                                              \n      *---------------------------------------------------------------*         \n       0000-TCATBALF-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT TCATBAL-FILE                                              \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION CATEGORY BALANCE'             \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0100-XREFFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'   XREFFILE-STATUS         \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0200-DISCGRP-OPEN.                                                       \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DISCGRP-FILE                                              \n           IF  DISCGRP-STATUS = '00'                                            \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALY REJECTS FILE'                        \n               MOVE DISCGRP-STATUS TO IO-STATUS                                 \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       0300-ACCTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O ACCOUNT-FILE                                                \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCOUNT MASTER FILE'                      \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0400-TRANFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT TRANSACT-FILE                                            \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1000-TCATBALF-GET-NEXT.                                                  \n           READ TCATBAL-FILE INTO TRAN-CAT-BAL-RECORD.                          \n           IF  TCATBALF-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               IF  TCATBALF-STATUS  = '10'                                      \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING TRANSACTION CATEGORY FILE'            \n                   MOVE TCATBALF-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1050-UPDATE-ACCOUNT.                                                     \n      * Update the balances in account record to reflect posted trans.          \n           ADD WS-TOTAL-INT  TO ACCT-CURR-BAL                                   \n           MOVE 0 TO ACCT-CURR-CYC-CREDIT                                       \n           MOVE 0 TO ACCT-CURR-CYC-DEBIT                                        \n                                                                                \n           REWRITE FD-ACCTFILE-REC FROM  ACCOUNT-RECORD                         \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR RE-WRITING ACCOUNT FILE'                          \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1100-GET-ACCT-DATA.                                                      \n           READ ACCOUNT-FILE INTO ACCOUNT-RECORD                                \n               INVALID KEY                                                      \n                  DISPLAY 'ACCOUNT NOT FOUND: ' FD-ACCT-ID                      \n           END-READ                                                             \n                                                                                \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1110-GET-XREF-DATA.                                                      \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n            KEY IS FD-XREF-ACCT-ID                                              \n               INVALID KEY                                                      \n                  DISPLAY 'ACCOUNT NOT FOUND: ' FD-XREF-ACCT-ID                 \n           END-READ                                                             \n                                                                                \n           IF  XREFFILE-STATUS   = '00'                                         \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING XREF FILE'                                \n               MOVE XREFFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1200-GET-INTEREST-RATE.                                                  \n           READ DISCGRP-FILE INTO DIS-GROUP-RECORD                              \n                INVALID KEY                                                     \n                   DISPLAY 'DISCLOSURE GROUP RECORD MISSING'                    \n                   DISPLAY 'TRY WITH DEFAULT GROUP CODE'                        \n           END-READ.                                                            \n                                                                                \n           IF  DISCGRP-STATUS  = '00'  OR '23'                                  \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING DISCLOSURE GROUP FILE'                    \n               MOVE DISCGRP-STATUS  TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           IF  DISCGRP-STATUS  = '23'                                           \n               MOVE 'DEFAULT' TO FD-DIS-ACCT-GROUP-ID                           \n               PERFORM 1200-A-GET-DEFAULT-INT-RATE                              \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1200-A-GET-DEFAULT-INT-RATE.                                             \n           READ DISCGRP-FILE INTO DIS-GROUP-RECORD                              \n                                                                                \n           IF  DISCGRP-STATUS  = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING DEFAULT DISCLOSURE GROUP'                 \n               MOVE DISCGRP-STATUS  TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1300-COMPUTE-INTEREST.                                                   \n                                                                                \n           COMPUTE WS-MONTHLY-INT                                               \n            = ( TRAN-CAT-BAL * DIS-INT-RATE) / 1200                             \n                                                                                \n           ADD WS-MONTHLY-INT  TO WS-TOTAL-INT                                  \n           PERFORM 1300-B-WRITE-TX.                                             \n                                                                                \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1300-B-WRITE-TX.                                                         \n           ADD 1 TO WS-TRANID-SUFFIX                                            \n                                                                                \n           STRING PARM-DATE,                                                    \n                  WS-TRANID-SUFFIX                                              \n             DELIMITED BY SIZE                                                  \n             INTO TRAN-ID                                                       \n           END-STRING.                                                          \n                                                                                \n           MOVE '01'                 TO TRAN-TYPE-CD                            \n           MOVE '05'                 TO TRAN-CAT-CD                             \n           MOVE 'System'             TO TRAN-SOURCE                             \n           STRING 'Int. for a/c ' ,                                             \n                  ACCT-ID                                                       \n                  DELIMITED BY SIZE                                             \n            INTO TRAN-DESC                                                      \n           END-STRING                                                           \n           MOVE WS-MONTHLY-INT       TO TRAN-AMT                                \n           MOVE 0                    TO TRAN-MERCHANT-ID                        \n           MOVE SPACES               TO TRAN-MERCHANT-NAME                      \n           MOVE SPACES               TO TRAN-MERCHANT-CITY                      \n           MOVE SPACES               TO TRAN-MERCHANT-ZIP                       \n           MOVE XREF-CARD-NUM        TO TRAN-CARD-NUM                           \n           PERFORM Z-GET-DB2-FORMAT-TIMESTAMP                                   \n           MOVE DB2-FORMAT-TS        TO TRAN-ORIG-TS                            \n           MOVE DB2-FORMAT-TS        TO TRAN-PROC-TS                            \n                                                                                \n           WRITE FD-TRANFILE-REC FROM TRAN-RECORD                               \n           IF  TRANFILE-STATUS   = '00'                                         \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n                                                                                \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TRANSACTION RECORD'                       \n               MOVE TRANFILE-STATUS   TO IO-STATUS                              \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       1400-COMPUTE-FEES.                                                       \n      * To be implemented                                                       \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9000-TCATBALF-CLOSE.                                                     \n           MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE TCATBAL-FILE                                                   \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9100-XREFFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9200-DISCGRP-CLOSE.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DISCGRP-FILE                                                   \n           IF  DISCGRP-STATUS = '00'                                            \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DISCLOSURE GROUP FILE'                    \n               MOVE DISCGRP-STATUS TO IO-STATUS                                 \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9300-ACCTFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE ACCOUNT-FILE                                                   \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       9400-TRANFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TRANSACT-FILE                                                  \n           IF  TRANFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       Z-GET-DB2-FORMAT-TIMESTAMP.                                              \n           MOVE FUNCTION CURRENT-DATE TO COBOL-TS                               \n           MOVE COB-YYYY TO DB2-YYYY                                            \n           MOVE COB-MM   TO DB2-MM                                              \n           MOVE COB-DD   TO DB2-DD                                              \n           MOVE COB-HH   TO DB2-HH                                              \n           MOVE COB-MIN  TO DB2-MIN                                             \n           MOVE COB-SS   TO DB2-SS                                              \n           MOVE COB-MIL  TO DB2-MIL                                             \n           MOVE '0000'   TO DB2-REST                                            \n           MOVE '-' TO DB2-STREEP-1 DB2-STREEP-2 DB2-STREEP-3                   \n           MOVE '.' TO DB2-DOT-1 DB2-DOT-2 DB2-DOT-3                            \n      *    DISPLAY 'DB2-TIMESTAMP = ' DB2-FORMAT-TS                             \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:31 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVTRA01Y",
        "CVTRA05Y",
        "CVACT01Y",
        "CVACT03Y",
        "CVTRA02Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as Main Program\n    participant TCatBal as Transaction Category Balance File\n    participant XRef as Cross Reference File\n    participant DiscGrp as Disclosure Group File\n    participant Acct as Account File\n    participant Trans as Transaction File\n    \n    Main->>TCatBal: 0000-TCATBALF-OPEN\n    Main->>XRef: 0100-XREFFILE-OPEN\n    Main->>DiscGrp: 0200-DISCGRP-OPEN\n    Main->>Acct: 0300-ACCTFILE-OPEN\n    Main->>Trans: 0400-TRANFILE-OPEN\n    \n    loop Until END-OF-FILE = 'Y'\n        Main->>TCatBal: 1000-TCATBALF-GET-NEXT\n        alt Not EOF\n            Main->>Acct: 1100-GET-ACCT-DATA (using FD-ACCT-ID)\n            Main->>XRef: 1110-GET-XREF-DATA (using FD-XREF-ACCT-ID)\n            Main->>DiscGrp: 1200-GET-INTEREST-RATE\n            \n            alt Disclosure Group Not Found\n                Main->>DiscGrp: 1200-A-GET-DEFAULT-INT-RATE\n            end\n            \n            Main->>Main: 1300-COMPUTE-INTEREST\n            Main->>Trans: 1300-B-WRITE-TX\n            Main->>Acct: 1050-UPDATE-ACCOUNT\n        end\n    end\n    \n    Main->>TCatBal: 9000-TCATBALF-CLOSE\n    Main->>XRef: 9100-XREFFILE-CLOSE\n    Main->>DiscGrp: 9200-DISCGRP-CLOSE\n    Main->>Acct: 9300-ACCTFILE-CLOSE\n    Main->>Trans: 9400-TRANFILE-CLOSE"
    },
    {
      "id": "COADM01C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This environment section appears to be empty or not provided in the snippet. In a complete COBOL program, the CONFIGURATION SECTION would typically contain specifications for special names, file assignments, and other environmental settings needed for the CardDemo administrative menu interface program (COADM01C). This section would normally define how the program interacts with the system environment, including any special device assignments or system-specific configurations required for the administrative functions."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COADM01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CA00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-OPTION-X                PIC X(02) JUST RIGHT.\n         05 WS-OPTION                  PIC 9(02) VALUE 0.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-ADMIN-OPT-TXT           PIC X(40) VALUE SPACES.\n\n       COPY COCOM01Y.\n       COPY COADM02Y.\n\n       COPY COADM01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This data section defines the working storage variables for the administrative menu program COADM01C. It includes program identification variables (program name and transaction ID), message handling fields, file references for user security, error flags with condition names, response codes, and menu option processing variables. The section incorporates several copybooks that likely contain common data structures, screen layouts, date/time formatting, message handling, user information, and standard CICS definitions. These variables support the program's function as an administrative interface, providing storage for menu selection processing, error handling, and display formatting needed to present and navigate the administrative console."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the linkage area for communication with other programs. It uses the standard DFHCOMMAREA structure with a variable-length field (LK-COMMAREA) that can expand from 1 to 32,767 bytes depending on the actual communication area length (EIBCALEN). This flexible structure allows the program to receive and pass data of different sizes when interacting with other components of the CardDemo administrative system."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COADM01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CA00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-OPTION-X                PIC X(02) JUST RIGHT.\n         05 WS-OPTION                  PIC 9(02) VALUE 0.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-ADMIN-OPT-TXT           PIC X(40) VALUE SPACES.\n\n       COPY COCOM01Y.\n       COPY COADM02Y.\n\n       COPY COADM01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COADM1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM\n               PERFORM RETURN-TO-SIGNON-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COADM1AO\n                   PERFORM SEND-MENU-SCREEN\n               ELSE\n                   PERFORM RECEIVE-MENU-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-SIGNON-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-MENU-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the administrative menu interface. It first clears any error flags and message fields, then checks if the program was called with a communication area. If not, it returns to the sign-on screen. Otherwise, it processes the existing communication area and either displays the menu for first-time entry or handles user input for subsequent interactions. The paragraph evaluates function key inputs, specifically processing ENTER key actions, returning to the sign-on screen when PF3 is pressed, or displaying an error message for invalid keys. After processing, it returns control to CICS with the transaction ID and updated communication area, maintaining the program's state between interactions."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "PERFORM VARYING WS-IDX\n                   FROM LENGTH OF OPTIONI OF COADM1AI BY -1 UNTIL\n                   OPTIONI OF COADM1AI(WS-IDX:1) NOT = SPACES OR\n                   WS-IDX = 1\n           END-PERFORM\n           MOVE OPTIONI OF COADM1AI(1:WS-IDX) TO WS-OPTION-X\n           INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'\n           MOVE WS-OPTION-X              TO WS-OPTION\n           MOVE WS-OPTION                TO OPTIONO OF COADM1AO\n\n           IF WS-OPTION IS NOT NUMERIC OR\n              WS-OPTION > CDEMO-ADMIN-OPT-COUNT OR\n              WS-OPTION = ZEROS\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Please enter a valid option number...' TO\n                                       WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n\n           IF NOT ERR-FLG-ON\n               IF CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'\n                   MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                   MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                   MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n                   EXEC CICS\n                       XCTL PROGRAM(CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION))\n                       COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n               END-IF\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE DFHGREEN           TO ERRMSGC  OF COADM1AO\n               STRING 'This option '       DELIMITED BY SIZE\n      *                CDEMO-ADMIN-OPT-NAME(WS-OPTION)\n      *                                DELIMITED BY SIZE\n                       'is coming soon ...'   DELIMITED BY SIZE\n                  INTO WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-SIGNON-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph processes the user's menu selection when the Enter key is pressed in the CardDemo administrative interface. It first trims trailing spaces from the input option and converts it to a numeric value, handling any blank input by replacing spaces with zeros. The code validates that the option is numeric, within the valid range of menu options, and not zero. If validation fails, it sets an error flag and displays an appropriate message. For valid selections, the code checks if the target program is available (not marked as \"DUMMY\") and if so, transfers control to that program while passing the commarea to maintain session context. If the selected option is not yet implemented (has a \"DUMMY\" program name), it displays a \"coming soon\" message to the user. The paragraph maintains user interface consistency by redisplaying the menu screen with appropriate status messages after processing."
          },
          {
            "name": "RETURN-TO-SIGNON-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-MENU-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the return navigation to the sign-on screen from the administrative menu. It first checks if the target program variable (CDEMO-TO-PROGRAM) is empty or contains spaces, and if so, sets it to the sign-on program 'COSGN00C' as the default destination. It then executes a CICS XCTL command to transfer control to the specified program, effectively ending the current program's execution and transferring control to the sign-on screen or another designated program. This ensures users can properly exit the administrative functions and return to the application's entry point."
          },
          {
            "name": "SEND-MENU-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n           PERFORM BUILD-MENU-OPTIONS\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COADM1AO\n\n           EXEC CICS SEND\n                     MAP('COADM1A')\n                     MAPSET('COADM01')\n                     FROM(COADM1AO)\n                     ERASE\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-MENU-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the display of the administrative menu screen. It first calls two supporting paragraphs to populate the header information and build the menu options. It then transfers any system messages to the output map's error message field. Finally, it uses the CICS SEND command to display the COADM1A map from the COADM01 mapset, using the COADM1AO data structure as the source of the display data, and clears the screen before displaying the new content."
          },
          {
            "name": "RECEIVE-MENU-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COADM1A')\n                     MAPSET('COADM01')\n                     INTO(COADM1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the reception of user input from the administrative menu screen. It uses the CICS RECEIVE command to capture data entered by the user on the 'COADM1A' map within the 'COADM01' mapset, storing the input in the COADM1AI structure. The operation's response codes are captured in WS-RESP-CD and WS-REAS-CD variables for subsequent error handling. This is a standard input processing step that occurs after displaying the menu and before processing the user's selection."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COADM1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COADM1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COADM1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COADM1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COADM1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COADM1AO.\n\n      *----------------------------------------------------------------*\n      *                      BUILD-MENU-OPTIONS\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the administrative menu screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information on the screen. The paragraph sets the title fields, transaction ID, and program name in the output map (COADM1AO). It also formats the current date into MM/DD/YY format and the current time into HH:MM:SS format before placing these values in their respective output fields. This creates a consistent header that provides context to the user about when they're accessing the system and which program they're currently using."
          },
          {
            "name": "BUILD-MENU-OPTIONS",
            "code": "PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL\n                           WS-IDX > CDEMO-ADMIN-OPT-COUNT\n\n               MOVE SPACES             TO WS-ADMIN-OPT-TXT\n\n               STRING CDEMO-ADMIN-OPT-NUM(WS-IDX)  DELIMITED BY SIZE\n                      '. '                         DELIMITED BY SIZE\n                      CDEMO-ADMIN-OPT-NAME(WS-IDX) DELIMITED BY SIZE\n                 INTO WS-ADMIN-OPT-TXT\n\n               EVALUATE WS-IDX\n                   WHEN 1\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN001O\n                   WHEN 2\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN002O\n                   WHEN 3\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN003O\n                   WHEN 4\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN004O\n                   WHEN 5\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN005O\n                   WHEN 6\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN006O\n                   WHEN 7\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN007O\n                   WHEN 8\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN008O\n                   WHEN 9\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN009O\n                   WHEN 10\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN010O\n                   WHEN OTHER\n                       CONTINUE\n               END-EVALUATE\n\n           END-PERFORM.\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *",
            "description": "This paragraph constructs and populates the administrative menu options displayed to users. It iterates through available admin options (up to the count stored in CDEMO-ADMIN-OPT-COUNT), formatting each option by combining its number and name into a formatted string with proper delimiters. The formatted text for each option is then assigned to the appropriate screen field (OPTN001O through OPTN010O) based on its position in the menu. The paragraph supports up to 10 menu options, with any additional options being ignored. This dynamic menu construction allows the administrative interface to display a variable number of options without requiring code changes when menu items are added or removed."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COADM1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM\n               PERFORM RETURN-TO-SIGNON-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COADM1AO\n                   PERFORM SEND-MENU-SCREEN\n               ELSE\n                   PERFORM RECEIVE-MENU-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-SIGNON-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-MENU-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           PERFORM VARYING WS-IDX\n                   FROM LENGTH OF OPTIONI OF COADM1AI BY -1 UNTIL\n                   OPTIONI OF COADM1AI(WS-IDX:1) NOT = SPACES OR\n                   WS-IDX = 1\n           END-PERFORM\n           MOVE OPTIONI OF COADM1AI(1:WS-IDX) TO WS-OPTION-X\n           INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'\n           MOVE WS-OPTION-X              TO WS-OPTION\n           MOVE WS-OPTION                TO OPTIONO OF COADM1AO\n\n           IF WS-OPTION IS NOT NUMERIC OR\n              WS-OPTION > CDEMO-ADMIN-OPT-COUNT OR\n              WS-OPTION = ZEROS\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Please enter a valid option number...' TO\n                                       WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n\n           IF NOT ERR-FLG-ON\n               IF CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'\n                   MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                   MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                   MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n                   EXEC CICS\n                       XCTL PROGRAM(CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION))\n                       COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n               END-IF\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE DFHGREEN           TO ERRMSGC  OF COADM1AO\n               STRING 'This option '       DELIMITED BY SIZE\n      *                CDEMO-ADMIN-OPT-NAME(WS-OPTION)\n      *                                DELIMITED BY SIZE\n                       'is coming soon ...'   DELIMITED BY SIZE\n                  INTO WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-SIGNON-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-SIGNON-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-MENU-SCREEN\n      *----------------------------------------------------------------*\n       SEND-MENU-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n           PERFORM BUILD-MENU-OPTIONS\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COADM1AO\n\n           EXEC CICS SEND\n                     MAP('COADM1A')\n                     MAPSET('COADM01')\n                     FROM(COADM1AO)\n                     ERASE\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-MENU-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-MENU-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COADM1A')\n                     MAPSET('COADM01')\n                     INTO(COADM1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COADM1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COADM1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COADM1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COADM1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COADM1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COADM1AO.\n\n      *----------------------------------------------------------------*\n      *                      BUILD-MENU-OPTIONS\n      *----------------------------------------------------------------*\n       BUILD-MENU-OPTIONS.\n\n           PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL\n                           WS-IDX > CDEMO-ADMIN-OPT-COUNT\n\n               MOVE SPACES             TO WS-ADMIN-OPT-TXT\n\n               STRING CDEMO-ADMIN-OPT-NUM(WS-IDX)  DELIMITED BY SIZE\n                      '. '                         DELIMITED BY SIZE\n                      CDEMO-ADMIN-OPT-NAME(WS-IDX) DELIMITED BY SIZE\n                 INTO WS-ADMIN-OPT-TXT\n\n               EVALUATE WS-IDX\n                   WHEN 1\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN001O\n                   WHEN 2\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN002O\n                   WHEN 3\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN003O\n                   WHEN 4\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN004O\n                   WHEN 5\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN005O\n                   WHEN 6\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN006O\n                   WHEN 7\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN007O\n                   WHEN 8\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN008O\n                   WHEN 9\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN009O\n                   WHEN 10\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN010O\n                   WHEN OTHER\n                       CONTINUE\n               END-EVALUATE\n\n           END-PERFORM.\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *"
      },
      "description": "This program serves as the administrative menu interface for the CardDemo application, providing a centralized access point for administrative functions. It displays a menu of options available to admin users and handles navigation to the selected administrative functions. The program manages user input validation, ensuring only valid menu options are processed, and provides appropriate error messages for invalid selections. It maintains session context through a commarea and includes navigation capabilities to return to the sign-on screen. The interface displays current date and time information in the header along with program and transaction identifiers, creating a complete administrative console experience for authorized users.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COADM01C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : Admin Menu for Admin users\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COADM01C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COADM01C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CA00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-OPTION-X                PIC X(02) JUST RIGHT.\n         05 WS-OPTION                  PIC 9(02) VALUE 0.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-ADMIN-OPT-TXT           PIC X(40) VALUE SPACES.\n\n       COPY COCOM01Y.\n       COPY COADM02Y.\n\n       COPY COADM01.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COADM1AO\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM\n               PERFORM RETURN-TO-SIGNON-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COADM1AO\n                   PERFORM SEND-MENU-SCREEN\n               ELSE\n                   PERFORM RECEIVE-MENU-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-SIGNON-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-MENU-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           PERFORM VARYING WS-IDX\n                   FROM LENGTH OF OPTIONI OF COADM1AI BY -1 UNTIL\n                   OPTIONI OF COADM1AI(WS-IDX:1) NOT = SPACES OR\n                   WS-IDX = 1\n           END-PERFORM\n           MOVE OPTIONI OF COADM1AI(1:WS-IDX) TO WS-OPTION-X\n           INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'\n           MOVE WS-OPTION-X              TO WS-OPTION\n           MOVE WS-OPTION                TO OPTIONO OF COADM1AO\n\n           IF WS-OPTION IS NOT NUMERIC OR\n              WS-OPTION > CDEMO-ADMIN-OPT-COUNT OR\n              WS-OPTION = ZEROS\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE 'Please enter a valid option number...' TO\n                                       WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF\n\n\n           IF NOT ERR-FLG-ON\n               IF CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'\n                   MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                   MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                   MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n                   EXEC CICS\n                       XCTL PROGRAM(CDEMO-ADMIN-OPT-PGMNAME(WS-OPTION))\n                       COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n               END-IF\n               MOVE SPACES             TO WS-MESSAGE\n               MOVE DFHGREEN           TO ERRMSGC  OF COADM1AO\n               STRING 'This option '       DELIMITED BY SIZE\n      *                CDEMO-ADMIN-OPT-NAME(WS-OPTION)\n      *                                DELIMITED BY SIZE\n                       'is coming soon ...'   DELIMITED BY SIZE\n                  INTO WS-MESSAGE\n               PERFORM SEND-MENU-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-SIGNON-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-SIGNON-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-MENU-SCREEN\n      *----------------------------------------------------------------*\n       SEND-MENU-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n           PERFORM BUILD-MENU-OPTIONS\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COADM1AO\n\n           EXEC CICS SEND\n                     MAP('COADM1A')\n                     MAPSET('COADM01')\n                     FROM(COADM1AO)\n                     ERASE\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-MENU-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-MENU-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COADM1A')\n                     MAPSET('COADM01')\n                     INTO(COADM1AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COADM1AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COADM1AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COADM1AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COADM1AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COADM1AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COADM1AO.\n\n      *----------------------------------------------------------------*\n      *                      BUILD-MENU-OPTIONS\n      *----------------------------------------------------------------*\n       BUILD-MENU-OPTIONS.\n\n           PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL\n                           WS-IDX > CDEMO-ADMIN-OPT-COUNT\n\n               MOVE SPACES             TO WS-ADMIN-OPT-TXT\n\n               STRING CDEMO-ADMIN-OPT-NUM(WS-IDX)  DELIMITED BY SIZE\n                      '. '                         DELIMITED BY SIZE\n                      CDEMO-ADMIN-OPT-NAME(WS-IDX) DELIMITED BY SIZE\n                 INTO WS-ADMIN-OPT-TXT\n\n               EVALUATE WS-IDX\n                   WHEN 1\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN001O\n                   WHEN 2\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN002O\n                   WHEN 3\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN003O\n                   WHEN 4\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN004O\n                   WHEN 5\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN005O\n                   WHEN 6\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN006O\n                   WHEN 7\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN007O\n                   WHEN 8\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN008O\n                   WHEN 9\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN009O\n                   WHEN 10\n                       MOVE WS-ADMIN-OPT-TXT TO OPTN010O\n                   WHEN OTHER\n                       CONTINUE\n               END-EVALUATE\n\n           END-PERFORM.\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "COADM02Y",
        "COADM01",
        "CSMSG01Y",
        "DFHBMSCA",
        "CSUSR01Y",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant CICS as CICS System\n    participant COADM01C as Admin Menu Program\n    participant SignOn as Sign-on Program\n    participant AdminOpt as Admin Option Program\n    \n    User->>CICS: Start transaction\n    CICS->>COADM01C: Execute COADM01C\n    \n    Note over COADM01C: MAIN-PARA\n    \n    alt No COMMAREA (First Entry)\n        COADM01C->>SignOn: Return to sign-on screen\n    else Has COMMAREA\n        alt First time entry\n            COADM01C->>COADM01C: POPULATE-HEADER-INFO\n            COADM01C->>COADM01C: BUILD-MENU-OPTIONS\n            COADM01C->>User: SEND-MENU-SCREEN\n        else Subsequent interaction\n            COADM01C->>User: RECEIVE-MENU-SCREEN\n            \n            alt ENTER key pressed\n                COADM01C->>COADM01C: PROCESS-ENTER-KEY\n                \n                alt Invalid option\n                    COADM01C->>User: Display error message\n                else Valid option\n                    alt Option implemented\n                        COADM01C->>AdminOpt: Transfer control (XCTL)\n                    else Option not implemented\n                        COADM01C->>User: Display \"coming soon\" message\n                    end\n                end\n                \n            else PF3 key pressed\n                COADM01C->>SignOn: RETURN-TO-SIGNON-SCREEN\n            else Other key pressed\n                COADM01C->>User: Display invalid key message\n            end\n        end\n    end\n    \n    COADM01C->>CICS: Return with COMMAREA"
    },
    {
      "id": "COUSR00C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "CONFIGURATION SECTION",
            "code": "",
            "description": "This section would typically contain configuration details for the COUSR00C program, including file assignments, special names, and system dependencies. In this CICS COBOL application, the Configuration Section would define how the program interacts with external resources like the USRSEC file that stores user information. It would also specify any special environment settings needed for the program to function properly within the CardDemo system's user administration module."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-USER-SEC-EOF            PIC X(01) VALUE 'N'.\n           88 USER-SEC-EOF                       VALUE 'Y'.\n           88 USER-SEC-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-PAGE-NUM                PIC S9(04) COMP VALUE ZEROS.\n\n       01 WS-USER-DATA.\n         02 USER-REC OCCURS 10 TIMES.\n           05 USER-SEL                   PIC X(01).\n           05 FILLER                     PIC X(02).\n           05 USER-ID                    PIC X(08).\n           05 FILLER                     PIC X(02).\n           05 USER-NAME                  PIC X(25).\n           05 FILLER                     PIC X(02).\n           05 USER-TYPE                  PIC X(08).\n\n       COPY COCOM01Y.\n          05 CDEMO-CU00-INFO.\n             10 CDEMO-CU00-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU00-USRID-LAST      PIC X(08).\n             10 CDEMO-CU00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU00-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU00-USR-SELECTED    PIC X(08).\n       COPY COUSR00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*",
            "description": "This Working Storage section defines the data structures used in the COUSR00C program for managing user listings. It includes program identification variables, status flags for error handling and pagination control, and counters for record processing. The WS-USER-DATA structure provides storage for up to 10 user records displayed on each page, with fields for selection markers, user IDs, names, and types. The section includes several copybooks: COCOM01Y (containing pagination control fields and user selection information), COUSR00 (likely the screen map definition), and various utility copybooks for titles, dates, messages, and user data. Standard CICS copybooks for AID keys and attributes are also included. This data structure supports the program's core functionality of displaying paginated user lists and handling user selection for update or delete operations."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *",
            "description": "This section defines the linkage area for communication with other programs. It contains a DFHCOMMAREA with a single field LK-COMMAREA, which is defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the value in EIBCALEN (the CICS-provided length of the communication area). This structure allows the program to receive and pass data of varying sizes when called by or transferring control to other programs in the CardDemo system."
          }
        ],
        "copybooks": [],
        "code": "*----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-USER-SEC-EOF            PIC X(01) VALUE 'N'.\n           88 USER-SEC-EOF                       VALUE 'Y'.\n           88 USER-SEC-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-PAGE-NUM                PIC S9(04) COMP VALUE ZEROS.\n\n       01 WS-USER-DATA.\n         02 USER-REC OCCURS 10 TIMES.\n           05 USER-SEL                   PIC X(01).\n           05 FILLER                     PIC X(02).\n           05 USER-ID                    PIC X(08).\n           05 FILLER                     PIC X(02).\n           05 USER-NAME                  PIC X(25).\n           05 FILLER                     PIC X(02).\n           05 USER-TYPE                  PIC X(08).\n\n       COPY COCOM01Y.\n          05 CDEMO-CU00-INFO.\n             10 CDEMO-CU00-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU00-USRID-LAST      PIC X(08).\n             10 CDEMO-CU00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU00-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU00-USR-SELECTED    PIC X(08).\n       COPY COUSR00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "MAIN-PARA",
            "code": "SET ERR-FLG-OFF TO TRUE\n           SET USER-SEC-NOT-EOF TO TRUE\n           SET NEXT-PAGE-NO TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR0AO\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR0AO\n                   PERFORM PROCESS-ENTER-KEY\n                   PERFORM SEND-USRLST-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRLST-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF7\n                           PERFORM PROCESS-PF7-KEY\n                       WHEN DFHPF8\n                           PERFORM PROCESS-PF8-KEY\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO USRIDINL OF COUSR0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRLST-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph serves as the main control flow for the COUSR00C program, handling initial setup and subsequent user interactions. It initializes error flags, pagination settings, and screen display parameters. The paragraph first checks if the program is being called directly (EIBCALEN = 0) and redirects to COSGN00C if so. For normal operation, it processes the communication area and either initializes the screen for first-time entry or handles user input based on the function key pressed. The paragraph supports navigation through PF3 (return to admin menu), PF7 (page up), PF8 (page down), and ENTER keys, with appropriate error handling for invalid key presses. After processing the user's request, it returns control to CICS while preserving the program state in the communication area for subsequent interactions."
          },
          {
            "name": "PROCESS-ENTER-KEY",
            "code": "EVALUATE TRUE\n               WHEN SEL0001I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0001I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID01I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0002I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0002I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID02I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0003I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0003I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID03I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0004I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0004I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID04I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0005I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0005I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID05I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0006I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0006I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID06I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0007I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0007I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID07I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0008I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0008I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID08I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0009I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0009I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID09I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0010I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0010I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID10I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN OTHER\n                   MOVE SPACES   TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE SPACES   TO CDEMO-CU00-USR-SELECTED\n           END-EVALUATE\n\n           IF (CDEMO-CU00-USR-SEL-FLG NOT = SPACES AND LOW-VALUES) AND\n              (CDEMO-CU00-USR-SELECTED NOT = SPACES AND LOW-VALUES)\n               EVALUATE CDEMO-CU00-USR-SEL-FLG\n                   WHEN 'U'\n                   WHEN 'u'\n                        MOVE 'COUSR02C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN 'D'\n                   WHEN 'd'\n                        MOVE 'COUSR03C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN OTHER\n                       MOVE\n                       'Invalid selection. Valid values are U and D' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO USRIDINL OF COUSR0AI\n               END-EVALUATE\n           END-IF\n\n           IF USRIDINI OF COUSR0AI = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE USRIDINI  OF COUSR0AI TO SEC-USR-ID\n           END-IF\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n\n           MOVE 0       TO CDEMO-CU00-PAGE-NUM\n           PERFORM PROCESS-PAGE-FORWARD\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACE   TO USRIDINO  OF COUSR0AO\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF7-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the processing of the Enter key in the user listing screen. It first evaluates which user row was selected by checking the selection fields (SEL0001I through SEL0010I) and captures both the selection flag (U for update or D for delete) and the corresponding user ID. If a valid selection is made, the program transfers control to either COUSR02C for user updates or COUSR03C for user deletions, passing control information in the CARDDEMO-COMMAREA. If an invalid selection character is entered, it displays an error message. The paragraph also handles any user ID filter entered by the user, resets the page number to 0, and performs a forward page operation to refresh the user list. The cursor is positioned at the user ID input field for the next interaction."
          },
          {
            "name": "PROCESS-PF7-KEY",
            "code": "IF CDEMO-CU00-USRID-FIRST = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE CDEMO-CU00-USRID-FIRST TO SEC-USR-ID\n           END-IF\n\n           SET NEXT-PAGE-YES TO TRUE\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF CDEMO-CU00-PAGE-NUM > 1\n               PERFORM PROCESS-PAGE-BACKWARD\n           ELSE\n               MOVE 'You are already at the top of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-USRLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF8-KEY\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the Page Up (PF7) key functionality in the user listing screen. It determines the starting user ID for pagination by checking if the first user ID on the current screen is empty (indicating the beginning of the list) and sets the appropriate search key. The code sets a flag to indicate a page navigation is occurring and positions the cursor at the user ID input field. If the user is not already on the first page, it calls the PROCESS-PAGE-BACKWARD paragraph to display the previous page of users. Otherwise, it displays a message informing the user they are already at the top of the list and refreshes the screen without clearing it."
          },
          {
            "name": "PROCESS-PF8-KEY",
            "code": "IF CDEMO-CU00-USRID-LAST = SPACES OR LOW-VALUES\n               MOVE HIGH-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE CDEMO-CU00-USRID-LAST TO SEC-USR-ID\n           END-IF\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF NEXT-PAGE-YES\n               PERFORM PROCESS-PAGE-FORWARD\n           ELSE\n               MOVE 'You are already at the bottom of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-USRLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-FORWARD\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the Page Down (PF8) key functionality in the user listing screen. It first determines the starting point for the next page of results by checking if the last displayed user ID is empty. If empty, it sets the search key to HIGH-VALUES to retrieve all records; otherwise, it uses the last displayed user ID as the starting point for the next page. The cursor is positioned at the user ID input field. If there are more pages available (NEXT-PAGE-YES flag is set), it calls the PROCESS-PAGE-FORWARD paragraph to load the next page of users. If there are no more pages to display, it shows a message informing the user they've reached the bottom of the list and redisplays the current screen without clearing it."
          },
          {
            "name": "PROCESS-PAGE-FORWARD",
            "code": "PERFORM STARTBR-USER-SEC-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF7 AND DFHPF3\n                   PERFORM READNEXT-USER-SEC-FILE\n               END-IF\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                   PERFORM INITIALIZE-USER-DATA\n               END-PERFORM\n               END-IF\n\n               MOVE 1             TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX >= 11 OR USER-SEC-EOF OR ERR-FLG-ON\n                   PERFORM READNEXT-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-USER-DATA\n                       COMPUTE WS-IDX = WS-IDX + 1\n                   END-IF\n               END-PERFORM\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                   COMPUTE CDEMO-CU00-PAGE-NUM =\n                           CDEMO-CU00-PAGE-NUM + 1\n                   PERFORM READNEXT-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       SET NEXT-PAGE-YES TO TRUE\n                   ELSE\n                       SET NEXT-PAGE-NO TO TRUE\n                   END-IF\n               ELSE\n                   SET NEXT-PAGE-NO TO TRUE\n                   IF WS-IDX > 1\n                       COMPUTE CDEMO-CU00-PAGE-NUM = CDEMO-CU00-PAGE-NUM\n                        + 1\n                   END-IF\n               END-IF\n\n               PERFORM ENDBR-USER-SEC-FILE\n\n               MOVE CDEMO-CU00-PAGE-NUM TO PAGENUMI  OF COUSR0AI\n               MOVE SPACE   TO USRIDINO  OF COUSR0AO\n               PERFORM SEND-USRLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-BACKWARD\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the forward pagination functionality in the user listing screen. It starts by browsing the user security file and then reads through records to populate the next page of user data. The process skips records if necessary when not using the ENTER, PF7, or PF3 keys. It populates up to 10 user records on the screen, incrementing the index for each record processed. After loading the current page, it checks if more records exist to determine if a \"next page\" option should be available. The page number is incremented accordingly, and the browse operation is ended before sending the updated screen to the user. The paragraph maintains pagination state and ensures proper display of user records when moving forward through the list."
          },
          {
            "name": "PROCESS-PAGE-BACKWARD",
            "code": "PERFORM STARTBR-USER-SEC-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER  AND DFHPF8\n                   PERFORM READPREV-USER-SEC-FILE\n               END-IF\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                   PERFORM INITIALIZE-USER-DATA\n               END-PERFORM\n               END-IF\n\n               MOVE 10          TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX <= 0 OR USER-SEC-EOF OR ERR-FLG-ON\n                   PERFORM READPREV-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-USER-DATA\n                       COMPUTE WS-IDX = WS-IDX - 1\n                   END-IF\n               END-PERFORM\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM READPREV-USER-SEC-FILE\n               IF NEXT-PAGE-YES\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF AND\n                       CDEMO-CU00-PAGE-NUM > 1\n                       SUBTRACT 1 FROM CDEMO-CU00-PAGE-NUM\n                   ELSE\n                       MOVE 1 TO CDEMO-CU00-PAGE-NUM\n                   END-IF\n               END-IF\n               END-IF\n\n               PERFORM ENDBR-USER-SEC-FILE\n\n               MOVE CDEMO-CU00-PAGE-NUM TO PAGENUMI  OF COUSR0AI\n               PERFORM SEND-USRLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-USER-DATA\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the page backward functionality in the user listing screen. When a user presses the page up key (PF7), it starts browsing the user security file, then reads records in reverse order to populate the previous page of user data. The process first initializes all user data fields, then reads up to 10 previous user records to display them on screen. It maintains pagination by decrementing the page number when appropriate, but ensures it never goes below 1. After populating the user data, it ends the browse operation, updates the page number on the screen, and sends the updated user list screen back to the user. The paragraph includes error handling to prevent processing if any errors occur during file operations."
          },
          {
            "name": "POPULATE-USER-DATA",
            "code": "EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SEC-USR-ID    TO USRID01I OF COUSR0AI\n                                         CDEMO-CU00-USRID-FIRST\n                   MOVE SEC-USR-FNAME TO FNAME01I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME01I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE01I OF COUSR0AI\n               WHEN 2\n                   MOVE SEC-USR-ID    TO USRID02I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME02I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME02I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE02I OF COUSR0AI\n               WHEN 3\n                   MOVE SEC-USR-ID    TO USRID03I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME03I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME03I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE03I OF COUSR0AI\n               WHEN 4\n                   MOVE SEC-USR-ID    TO USRID04I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME04I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME04I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE04I OF COUSR0AI\n               WHEN 5\n                   MOVE SEC-USR-ID    TO USRID05I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME05I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME05I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE05I OF COUSR0AI\n               WHEN 6\n                   MOVE SEC-USR-ID    TO USRID06I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME06I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME06I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE06I OF COUSR0AI\n               WHEN 7\n                   MOVE SEC-USR-ID    TO USRID07I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME07I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME07I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE07I OF COUSR0AI\n               WHEN 8\n                   MOVE SEC-USR-ID    TO USRID08I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME08I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME08I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE08I OF COUSR0AI\n               WHEN 9\n                   MOVE SEC-USR-ID    TO USRID09I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME09I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME09I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE09I OF COUSR0AI\n               WHEN 10\n                   MOVE SEC-USR-ID    TO USRID10I OF COUSR0AI\n                                         CDEMO-CU00-USRID-LAST\n                   MOVE SEC-USR-FNAME TO FNAME10I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME10I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE10I OF COUSR0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-USER-DATA\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the user interface screen with user data for display in the paginated user list. Based on the current index value (WS-IDX), it maps user information from the security record (SEC-USR fields) to the corresponding screen fields in the COUSR0AI map. For each of the 10 possible positions on the screen, it copies the user ID, first name, last name, and user type to the appropriate display fields. When populating the first and last positions (index 1 and 10), it also stores the user IDs in special fields (CDEMO-CU00-USRID-FIRST and CDEMO-CU00-USRID-LAST) which are likely used for pagination tracking. This paragraph is essential for rendering the user data in the proper format for the administrator to view and select users for further actions."
          },
          {
            "name": "INITIALIZE-USER-DATA",
            "code": "EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SPACES TO USRID01I OF COUSR0AI\n                   MOVE SPACES TO FNAME01I OF COUSR0AI\n                   MOVE SPACES TO LNAME01I OF COUSR0AI\n                   MOVE SPACES TO UTYPE01I OF COUSR0AI\n               WHEN 2\n                   MOVE SPACES TO USRID02I OF COUSR0AI\n                   MOVE SPACES TO FNAME02I OF COUSR0AI\n                   MOVE SPACES TO LNAME02I OF COUSR0AI\n                   MOVE SPACES TO UTYPE02I OF COUSR0AI\n               WHEN 3\n                   MOVE SPACES TO USRID03I OF COUSR0AI\n                   MOVE SPACES TO FNAME03I OF COUSR0AI\n                   MOVE SPACES TO LNAME03I OF COUSR0AI\n                   MOVE SPACES TO UTYPE03I OF COUSR0AI\n               WHEN 4\n                   MOVE SPACES TO USRID04I OF COUSR0AI\n                   MOVE SPACES TO FNAME04I OF COUSR0AI\n                   MOVE SPACES TO LNAME04I OF COUSR0AI\n                   MOVE SPACES TO UTYPE04I OF COUSR0AI\n               WHEN 5\n                   MOVE SPACES TO USRID05I OF COUSR0AI\n                   MOVE SPACES TO FNAME05I OF COUSR0AI\n                   MOVE SPACES TO LNAME05I OF COUSR0AI\n                   MOVE SPACES TO UTYPE05I OF COUSR0AI\n               WHEN 6\n                   MOVE SPACES TO USRID06I OF COUSR0AI\n                   MOVE SPACES TO FNAME06I OF COUSR0AI\n                   MOVE SPACES TO LNAME06I OF COUSR0AI\n                   MOVE SPACES TO UTYPE06I OF COUSR0AI\n               WHEN 7\n                   MOVE SPACES TO USRID07I OF COUSR0AI\n                   MOVE SPACES TO FNAME07I OF COUSR0AI\n                   MOVE SPACES TO LNAME07I OF COUSR0AI\n                   MOVE SPACES TO UTYPE07I OF COUSR0AI\n               WHEN 8\n                   MOVE SPACES TO USRID08I OF COUSR0AI\n                   MOVE SPACES TO FNAME08I OF COUSR0AI\n                   MOVE SPACES TO LNAME08I OF COUSR0AI\n                   MOVE SPACES TO UTYPE08I OF COUSR0AI\n               WHEN 9\n                   MOVE SPACES TO USRID09I OF COUSR0AI\n                   MOVE SPACES TO FNAME09I OF COUSR0AI\n                   MOVE SPACES TO LNAME09I OF COUSR0AI\n                   MOVE SPACES TO UTYPE09I OF COUSR0AI\n               WHEN 10\n                   MOVE SPACES TO USRID10I OF COUSR0AI\n                   MOVE SPACES TO FNAME10I OF COUSR0AI\n                   MOVE SPACES TO LNAME10I OF COUSR0AI\n                   MOVE SPACES TO UTYPE10I OF COUSR0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph clears the user data fields on the display screen based on the current index value (WS-IDX). It uses an EVALUATE statement to determine which of the 10 possible user entry rows to clear. For each row position (1-10), it sets the user ID, first name, last name, and user type fields to spaces. This routine is likely called when initializing the screen for a new display or when removing user entries that should no longer be displayed, such as when navigating between pages of user records or after a deletion operation."
          },
          {
            "name": "RETURN-TO-PREV-SCREEN",
            "code": "IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRLST-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the return navigation to a previous screen in the CardDemo application. It first checks if the target program is specified in the communication area, defaulting to 'COSGN00C' (likely the sign-on or main menu program) if no specific program is set. It then populates the communication area with the current transaction ID and program name as the source of the transfer, resets the program context to zeros, and executes a CICS XCTL command to transfer control to the target program while passing the CARDDEMO-COMMAREA. This provides a standardized way to navigate back from the user listing screen to the previous screen in the application flow."
          },
          {
            "name": "SEND-USRLST-SCREEN",
            "code": "PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('COUSR0A')\n                         MAPSET('COUSR00')\n                         FROM(COUSR0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('COUSR0A')\n                         MAPSET('COUSR00')\n                         FROM(COUSR0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRLST-SCREEN\n      *----------------------------------------------------------------*",
            "description": "This paragraph handles the display of the user list screen (COUSR0A) to the user. It first calls the POPULATE-HEADER-INFO paragraph to set up the screen header information, then displays any system messages stored in WS-MESSAGE to the error message field. The paragraph implements conditional screen rendering logic based on the SEND-ERASE-YES flag - if set, it sends the screen with the ERASE option to clear the entire screen; otherwise, it sends the screen without erasing, which preserves background content. In both cases, it positions the cursor at the default location. This paragraph is part of the user interface management functionality that presents the paginated user list to administrators."
          },
          {
            "name": "RECEIVE-USRLST-SCREEN",
            "code": "EXEC CICS RECEIVE\n                     MAP('COUSR0A')\n                     MAPSET('COUSR00')\n                     INTO(COUSR0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*",
            "description": "This paragraph receives user input from the COUSR0A map within the COUSR00 mapset, storing the data in the COUSR0AI structure. It captures response codes in WS-RESP-CD and WS-REAS-CD variables to handle any communication errors that might occur during the receive operation. This is a standard CICS interaction that retrieves the screen data after a user has entered information or pressed a function key on the user listing screen."
          },
          {
            "name": "POPULATE-HEADER-INFO",
            "code": "MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR0AO.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph populates the header information for the user listing screen. It retrieves the current system date and time using the CURRENT-DATE function, then formats and displays this information on the screen. The paragraph sets the application title fields, transaction ID, and program name in the output map. It also formats the current date into MM/DD/YY format and the current time into HH:MM:SS format before moving these values to their respective output fields. This header information provides context to the user about which program they're using and when the screen was generated."
          },
          {
            "name": "STARTBR-USER-SEC-FILE",
            "code": "EXEC CICS STARTBR\n                DATASET   (WS-USRSEC-FILE)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n      *         GTEQ\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You are at the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READNEXT-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph initiates a browse operation on the USRSEC file to retrieve user records. It uses the CICS STARTBR command with the user ID as the key field. The paragraph handles three possible outcomes: successful browse initiation (continues processing), no records found (sets end-of-file flag and displays a message that the user is at the top of the page), or an error condition (displays response and reason codes, sets an error flag, and shows an error message). In all error cases, the paragraph positions the cursor at the user ID input field and redisplays the user list screen. This is a key part of the pagination functionality that allows administrators to browse through the system's user records."
          },
          {
            "name": "READNEXT-USER-SEC-FILE",
            "code": "EXEC CICS READNEXT\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You have reached the bottom of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a sequential read operation on the USRSEC file to retrieve the next user record. It uses the CICS READNEXT command to fetch the next record based on the current key position stored in SEC-USR-ID. The paragraph handles three possible outcomes: successful read (NORMAL), end of file condition (ENDFILE), and errors. When the end of file is reached, it sets a flag, displays a message indicating the user has reached the bottom of the page, and redisplays the user list screen. For other errors, it logs the response and reason codes, sets an error flag, displays an error message, and redisplays the screen. This functionality supports the pagination feature of the user listing interface, allowing administrators to navigate through multiple pages of user records."
          },
          {
            "name": "READPREV-USER-SEC-FILE",
            "code": "EXEC CICS READPREV\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You have reached the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-USER-SEC-FILE\n      *----------------------------------------------------------------*",
            "description": "This paragraph performs a backward read operation on the USRSEC file to support pagination when users navigate to previous records. It reads the previous record based on the current key position and handles three possible outcomes: successful read (continues processing), reaching the beginning of the file (displays a message indicating the user has reached the top of the page), or encountering an error (displays an error message). In all cases except a normal read, the paragraph sends the user list screen back to the user with appropriate positioning and messaging. This functionality supports the PF7 (page up) navigation in the user administration interface."
          },
          {
            "name": "ENDBR-USER-SEC-FILE",
            "code": "EXEC CICS ENDBR\n                DATASET   (WS-USRSEC-FILE)\n           END-EXEC.\n      \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *",
            "description": "This paragraph terminates a browse operation on the USRSEC file (user security file) using the CICS ENDBR command. It marks the end of sequential record retrieval that was previously initiated with a STARTBR command. The paragraph is called when the program has finished reading through user records during the pagination process. The WS-USRSEC-FILE variable contains the name of the dataset being accessed."
          }
        ],
        "code": "*----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n           SET USER-SEC-NOT-EOF TO TRUE\n           SET NEXT-PAGE-NO TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR0AO\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR0AO\n                   PERFORM PROCESS-ENTER-KEY\n                   PERFORM SEND-USRLST-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRLST-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF7\n                           PERFORM PROCESS-PF7-KEY\n                       WHEN DFHPF8\n                           PERFORM PROCESS-PF8-KEY\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO USRIDINL OF COUSR0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRLST-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN SEL0001I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0001I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID01I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0002I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0002I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID02I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0003I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0003I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID03I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0004I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0004I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID04I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0005I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0005I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID05I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0006I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0006I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID06I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0007I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0007I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID07I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0008I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0008I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID08I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0009I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0009I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID09I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0010I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0010I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID10I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN OTHER\n                   MOVE SPACES   TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE SPACES   TO CDEMO-CU00-USR-SELECTED\n           END-EVALUATE\n\n           IF (CDEMO-CU00-USR-SEL-FLG NOT = SPACES AND LOW-VALUES) AND\n              (CDEMO-CU00-USR-SELECTED NOT = SPACES AND LOW-VALUES)\n               EVALUATE CDEMO-CU00-USR-SEL-FLG\n                   WHEN 'U'\n                   WHEN 'u'\n                        MOVE 'COUSR02C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN 'D'\n                   WHEN 'd'\n                        MOVE 'COUSR03C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN OTHER\n                       MOVE\n                       'Invalid selection. Valid values are U and D' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO USRIDINL OF COUSR0AI\n               END-EVALUATE\n           END-IF\n\n           IF USRIDINI OF COUSR0AI = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE USRIDINI  OF COUSR0AI TO SEC-USR-ID\n           END-IF\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n\n           MOVE 0       TO CDEMO-CU00-PAGE-NUM\n           PERFORM PROCESS-PAGE-FORWARD\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACE   TO USRIDINO  OF COUSR0AO\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF7-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF7-KEY.\n\n           IF CDEMO-CU00-USRID-FIRST = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE CDEMO-CU00-USRID-FIRST TO SEC-USR-ID\n           END-IF\n\n           SET NEXT-PAGE-YES TO TRUE\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF CDEMO-CU00-PAGE-NUM > 1\n               PERFORM PROCESS-PAGE-BACKWARD\n           ELSE\n               MOVE 'You are already at the top of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-USRLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF8-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF8-KEY.\n\n           IF CDEMO-CU00-USRID-LAST = SPACES OR LOW-VALUES\n               MOVE HIGH-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE CDEMO-CU00-USRID-LAST TO SEC-USR-ID\n           END-IF\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF NEXT-PAGE-YES\n               PERFORM PROCESS-PAGE-FORWARD\n           ELSE\n               MOVE 'You are already at the bottom of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-USRLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-FORWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-FORWARD.\n\n           PERFORM STARTBR-USER-SEC-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF7 AND DFHPF3\n                   PERFORM READNEXT-USER-SEC-FILE\n               END-IF\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                   PERFORM INITIALIZE-USER-DATA\n               END-PERFORM\n               END-IF\n\n               MOVE 1             TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX >= 11 OR USER-SEC-EOF OR ERR-FLG-ON\n                   PERFORM READNEXT-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-USER-DATA\n                       COMPUTE WS-IDX = WS-IDX + 1\n                   END-IF\n               END-PERFORM\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                   COMPUTE CDEMO-CU00-PAGE-NUM =\n                           CDEMO-CU00-PAGE-NUM + 1\n                   PERFORM READNEXT-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       SET NEXT-PAGE-YES TO TRUE\n                   ELSE\n                       SET NEXT-PAGE-NO TO TRUE\n                   END-IF\n               ELSE\n                   SET NEXT-PAGE-NO TO TRUE\n                   IF WS-IDX > 1\n                       COMPUTE CDEMO-CU00-PAGE-NUM = CDEMO-CU00-PAGE-NUM\n                        + 1\n                   END-IF\n               END-IF\n\n               PERFORM ENDBR-USER-SEC-FILE\n\n               MOVE CDEMO-CU00-PAGE-NUM TO PAGENUMI  OF COUSR0AI\n               MOVE SPACE   TO USRIDINO  OF COUSR0AO\n               PERFORM SEND-USRLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-BACKWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-BACKWARD.\n\n           PERFORM STARTBR-USER-SEC-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER  AND DFHPF8\n                   PERFORM READPREV-USER-SEC-FILE\n               END-IF\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                   PERFORM INITIALIZE-USER-DATA\n               END-PERFORM\n               END-IF\n\n               MOVE 10          TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX <= 0 OR USER-SEC-EOF OR ERR-FLG-ON\n                   PERFORM READPREV-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-USER-DATA\n                       COMPUTE WS-IDX = WS-IDX - 1\n                   END-IF\n               END-PERFORM\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM READPREV-USER-SEC-FILE\n               IF NEXT-PAGE-YES\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF AND\n                       CDEMO-CU00-PAGE-NUM > 1\n                       SUBTRACT 1 FROM CDEMO-CU00-PAGE-NUM\n                   ELSE\n                       MOVE 1 TO CDEMO-CU00-PAGE-NUM\n                   END-IF\n               END-IF\n               END-IF\n\n               PERFORM ENDBR-USER-SEC-FILE\n\n               MOVE CDEMO-CU00-PAGE-NUM TO PAGENUMI  OF COUSR0AI\n               PERFORM SEND-USRLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-USER-DATA\n      *----------------------------------------------------------------*\n       POPULATE-USER-DATA.\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SEC-USR-ID    TO USRID01I OF COUSR0AI\n                                         CDEMO-CU00-USRID-FIRST\n                   MOVE SEC-USR-FNAME TO FNAME01I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME01I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE01I OF COUSR0AI\n               WHEN 2\n                   MOVE SEC-USR-ID    TO USRID02I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME02I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME02I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE02I OF COUSR0AI\n               WHEN 3\n                   MOVE SEC-USR-ID    TO USRID03I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME03I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME03I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE03I OF COUSR0AI\n               WHEN 4\n                   MOVE SEC-USR-ID    TO USRID04I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME04I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME04I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE04I OF COUSR0AI\n               WHEN 5\n                   MOVE SEC-USR-ID    TO USRID05I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME05I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME05I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE05I OF COUSR0AI\n               WHEN 6\n                   MOVE SEC-USR-ID    TO USRID06I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME06I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME06I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE06I OF COUSR0AI\n               WHEN 7\n                   MOVE SEC-USR-ID    TO USRID07I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME07I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME07I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE07I OF COUSR0AI\n               WHEN 8\n                   MOVE SEC-USR-ID    TO USRID08I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME08I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME08I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE08I OF COUSR0AI\n               WHEN 9\n                   MOVE SEC-USR-ID    TO USRID09I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME09I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME09I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE09I OF COUSR0AI\n               WHEN 10\n                   MOVE SEC-USR-ID    TO USRID10I OF COUSR0AI\n                                         CDEMO-CU00-USRID-LAST\n                   MOVE SEC-USR-FNAME TO FNAME10I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME10I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE10I OF COUSR0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-USER-DATA\n      *----------------------------------------------------------------*\n       INITIALIZE-USER-DATA.\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SPACES TO USRID01I OF COUSR0AI\n                   MOVE SPACES TO FNAME01I OF COUSR0AI\n                   MOVE SPACES TO LNAME01I OF COUSR0AI\n                   MOVE SPACES TO UTYPE01I OF COUSR0AI\n               WHEN 2\n                   MOVE SPACES TO USRID02I OF COUSR0AI\n                   MOVE SPACES TO FNAME02I OF COUSR0AI\n                   MOVE SPACES TO LNAME02I OF COUSR0AI\n                   MOVE SPACES TO UTYPE02I OF COUSR0AI\n               WHEN 3\n                   MOVE SPACES TO USRID03I OF COUSR0AI\n                   MOVE SPACES TO FNAME03I OF COUSR0AI\n                   MOVE SPACES TO LNAME03I OF COUSR0AI\n                   MOVE SPACES TO UTYPE03I OF COUSR0AI\n               WHEN 4\n                   MOVE SPACES TO USRID04I OF COUSR0AI\n                   MOVE SPACES TO FNAME04I OF COUSR0AI\n                   MOVE SPACES TO LNAME04I OF COUSR0AI\n                   MOVE SPACES TO UTYPE04I OF COUSR0AI\n               WHEN 5\n                   MOVE SPACES TO USRID05I OF COUSR0AI\n                   MOVE SPACES TO FNAME05I OF COUSR0AI\n                   MOVE SPACES TO LNAME05I OF COUSR0AI\n                   MOVE SPACES TO UTYPE05I OF COUSR0AI\n               WHEN 6\n                   MOVE SPACES TO USRID06I OF COUSR0AI\n                   MOVE SPACES TO FNAME06I OF COUSR0AI\n                   MOVE SPACES TO LNAME06I OF COUSR0AI\n                   MOVE SPACES TO UTYPE06I OF COUSR0AI\n               WHEN 7\n                   MOVE SPACES TO USRID07I OF COUSR0AI\n                   MOVE SPACES TO FNAME07I OF COUSR0AI\n                   MOVE SPACES TO LNAME07I OF COUSR0AI\n                   MOVE SPACES TO UTYPE07I OF COUSR0AI\n               WHEN 8\n                   MOVE SPACES TO USRID08I OF COUSR0AI\n                   MOVE SPACES TO FNAME08I OF COUSR0AI\n                   MOVE SPACES TO LNAME08I OF COUSR0AI\n                   MOVE SPACES TO UTYPE08I OF COUSR0AI\n               WHEN 9\n                   MOVE SPACES TO USRID09I OF COUSR0AI\n                   MOVE SPACES TO FNAME09I OF COUSR0AI\n                   MOVE SPACES TO LNAME09I OF COUSR0AI\n                   MOVE SPACES TO UTYPE09I OF COUSR0AI\n               WHEN 10\n                   MOVE SPACES TO USRID10I OF COUSR0AI\n                   MOVE SPACES TO FNAME10I OF COUSR0AI\n                   MOVE SPACES TO LNAME10I OF COUSR0AI\n                   MOVE SPACES TO UTYPE10I OF COUSR0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRLST-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRLST-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('COUSR0A')\n                         MAPSET('COUSR00')\n                         FROM(COUSR0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('COUSR0A')\n                         MAPSET('COUSR00')\n                         FROM(COUSR0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRLST-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRLST-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR0A')\n                     MAPSET('COUSR00')\n                     INTO(COUSR0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR0AO.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       STARTBR-USER-SEC-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-USRSEC-FILE)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n      *         GTEQ\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You are at the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READNEXT-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READNEXT-USER-SEC-FILE.\n\n           EXEC CICS READNEXT\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You have reached the bottom of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READPREV-USER-SEC-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You have reached the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       ENDBR-USER-SEC-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-USRSEC-FILE)\n           END-EXEC.\n      \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *"
      },
      "description": "This program (COUSR00C) is a CICS COBOL application that lists all users from the USRSEC file in the CardDemo system. It provides a paginated user interface that displays up to 10 users per page with their IDs, names, and user types. The program allows administrators to navigate through the user list using PF7 (page up) and PF8 (page down) keys, and supports user selection for update (U) or delete (D) operations. When a user is selected, the program transfers control to either COUSR02C (for updates) or COUSR03C (for deletions). The program handles various error conditions, maintains pagination state between screens, and provides appropriate feedback messages to the user. It's part of the CardDemo application's user administration functionality, allowing system administrators to manage user accounts.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      * Program     : COUSR00C.CBL\n      * Application : CardDemo\n      * Type        : CICS COBOL Program\n      * Function    : List all users from USRSEC file\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. COUSR00C.\n       AUTHOR.     AWS.\n\n       ENVIRONMENT DIVISION.\n       CONFIGURATION SECTION.\n\n       DATA DIVISION.\n      *----------------------------------------------------------------*\n      *                     WORKING STORAGE SECTION\n      *----------------------------------------------------------------*\n       WORKING-STORAGE SECTION.\n\n       01 WS-VARIABLES.\n         05 WS-PGMNAME                 PIC X(08) VALUE 'COUSR00C'.\n         05 WS-TRANID                  PIC X(04) VALUE 'CU00'.\n         05 WS-MESSAGE                 PIC X(80) VALUE SPACES.\n         05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.\n         05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.\n           88 ERR-FLG-ON                         VALUE 'Y'.\n           88 ERR-FLG-OFF                        VALUE 'N'.\n         05 WS-USER-SEC-EOF            PIC X(01) VALUE 'N'.\n           88 USER-SEC-EOF                       VALUE 'Y'.\n           88 USER-SEC-NOT-EOF                   VALUE 'N'.\n         05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.\n           88 SEND-ERASE-YES                     VALUE 'Y'.\n           88 SEND-ERASE-NO                      VALUE 'N'.\n\n         05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.\n         05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.\n         05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.\n         05 WS-PAGE-NUM                PIC S9(04) COMP VALUE ZEROS.\n\n       01 WS-USER-DATA.\n         02 USER-REC OCCURS 10 TIMES.\n           05 USER-SEL                   PIC X(01).\n           05 FILLER                     PIC X(02).\n           05 USER-ID                    PIC X(08).\n           05 FILLER                     PIC X(02).\n           05 USER-NAME                  PIC X(25).\n           05 FILLER                     PIC X(02).\n           05 USER-TYPE                  PIC X(08).\n\n       COPY COCOM01Y.\n          05 CDEMO-CU00-INFO.\n             10 CDEMO-CU00-USRID-FIRST     PIC X(08).\n             10 CDEMO-CU00-USRID-LAST      PIC X(08).\n             10 CDEMO-CU00-PAGE-NUM        PIC 9(08).\n             10 CDEMO-CU00-NEXT-PAGE-FLG   PIC X(01) VALUE 'N'.\n                88 NEXT-PAGE-YES                     VALUE 'Y'.\n                88 NEXT-PAGE-NO                      VALUE 'N'.\n             10 CDEMO-CU00-USR-SEL-FLG     PIC X(01).\n             10 CDEMO-CU00-USR-SELECTED    PIC X(08).\n       COPY COUSR00.\n\n       COPY COTTL01Y.\n       COPY CSDAT01Y.\n       COPY CSMSG01Y.\n       COPY CSUSR01Y.\n\n       COPY DFHAID.\n       COPY DFHBMSCA.\n\n      *----------------------------------------------------------------*\n      *                        LINKAGE SECTION\n      *----------------------------------------------------------------*\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  LK-COMMAREA                           PIC X(01)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n      *----------------------------------------------------------------*\n      *                       PROCEDURE DIVISION\n      *----------------------------------------------------------------*\n       PROCEDURE DIVISION.\n       MAIN-PARA.\n\n           SET ERR-FLG-OFF TO TRUE\n           SET USER-SEC-NOT-EOF TO TRUE\n           SET NEXT-PAGE-NO TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF COUSR0AO\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO COUSR0AO\n                   PERFORM PROCESS-ENTER-KEY\n                   PERFORM SEND-USRLST-SCREEN\n               ELSE\n                   PERFORM RECEIVE-USRLST-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COADM01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN DFHPF7\n                           PERFORM PROCESS-PF7-KEY\n                       WHEN DFHPF8\n                           PERFORM PROCESS-PF8-KEY\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO USRIDINL OF COUSR0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-USRLST-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-ENTER-KEY\n      *----------------------------------------------------------------*\n       PROCESS-ENTER-KEY.\n\n           EVALUATE TRUE\n               WHEN SEL0001I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0001I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID01I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0002I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0002I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID02I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0003I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0003I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID03I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0004I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0004I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID04I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0005I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0005I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID05I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0006I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0006I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID06I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0007I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0007I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID07I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0008I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0008I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID08I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0009I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0009I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID09I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN SEL0010I OF COUSR0AI NOT = SPACES AND LOW-VALUES\n                   MOVE SEL0010I OF COUSR0AI TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE USRID10I OF COUSR0AI TO CDEMO-CU00-USR-SELECTED\n               WHEN OTHER\n                   MOVE SPACES   TO CDEMO-CU00-USR-SEL-FLG\n                   MOVE SPACES   TO CDEMO-CU00-USR-SELECTED\n           END-EVALUATE\n\n           IF (CDEMO-CU00-USR-SEL-FLG NOT = SPACES AND LOW-VALUES) AND\n              (CDEMO-CU00-USR-SELECTED NOT = SPACES AND LOW-VALUES)\n               EVALUATE CDEMO-CU00-USR-SEL-FLG\n                   WHEN 'U'\n                   WHEN 'u'\n                        MOVE 'COUSR02C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN 'D'\n                   WHEN 'd'\n                        MOVE 'COUSR03C'   TO CDEMO-TO-PROGRAM\n                        MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n                        MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n                        MOVE 0        TO CDEMO-PGM-CONTEXT\n                        EXEC CICS\n                            XCTL PROGRAM(CDEMO-TO-PROGRAM)\n                            COMMAREA(CARDDEMO-COMMAREA)\n                        END-EXEC\n                   WHEN OTHER\n                       MOVE\n                       'Invalid selection. Valid values are U and D' TO\n                                       WS-MESSAGE\n                       MOVE -1       TO USRIDINL OF COUSR0AI\n               END-EVALUATE\n           END-IF\n\n           IF USRIDINI OF COUSR0AI = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE USRIDINI  OF COUSR0AI TO SEC-USR-ID\n           END-IF\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n\n           MOVE 0       TO CDEMO-CU00-PAGE-NUM\n           PERFORM PROCESS-PAGE-FORWARD\n\n           IF NOT ERR-FLG-ON\n               MOVE SPACE   TO USRIDINO  OF COUSR0AO\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF7-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF7-KEY.\n\n           IF CDEMO-CU00-USRID-FIRST = SPACES OR LOW-VALUES\n               MOVE LOW-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE CDEMO-CU00-USRID-FIRST TO SEC-USR-ID\n           END-IF\n\n           SET NEXT-PAGE-YES TO TRUE\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF CDEMO-CU00-PAGE-NUM > 1\n               PERFORM PROCESS-PAGE-BACKWARD\n           ELSE\n               MOVE 'You are already at the top of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-USRLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PF8-KEY\n      *----------------------------------------------------------------*\n       PROCESS-PF8-KEY.\n\n           IF CDEMO-CU00-USRID-LAST = SPACES OR LOW-VALUES\n               MOVE HIGH-VALUES TO SEC-USR-ID\n           ELSE\n               MOVE CDEMO-CU00-USRID-LAST TO SEC-USR-ID\n           END-IF\n\n           MOVE -1       TO USRIDINL OF COUSR0AI\n\n           IF NEXT-PAGE-YES\n               PERFORM PROCESS-PAGE-FORWARD\n           ELSE\n               MOVE 'You are already at the bottom of the page...' TO\n                               WS-MESSAGE\n               SET SEND-ERASE-NO TO TRUE\n               PERFORM SEND-USRLST-SCREEN\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-FORWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-FORWARD.\n\n           PERFORM STARTBR-USER-SEC-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER AND DFHPF7 AND DFHPF3\n                   PERFORM READNEXT-USER-SEC-FILE\n               END-IF\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                   PERFORM INITIALIZE-USER-DATA\n               END-PERFORM\n               END-IF\n\n               MOVE 1             TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX >= 11 OR USER-SEC-EOF OR ERR-FLG-ON\n                   PERFORM READNEXT-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-USER-DATA\n                       COMPUTE WS-IDX = WS-IDX + 1\n                   END-IF\n               END-PERFORM\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                   COMPUTE CDEMO-CU00-PAGE-NUM =\n                           CDEMO-CU00-PAGE-NUM + 1\n                   PERFORM READNEXT-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       SET NEXT-PAGE-YES TO TRUE\n                   ELSE\n                       SET NEXT-PAGE-NO TO TRUE\n                   END-IF\n               ELSE\n                   SET NEXT-PAGE-NO TO TRUE\n                   IF WS-IDX > 1\n                       COMPUTE CDEMO-CU00-PAGE-NUM = CDEMO-CU00-PAGE-NUM\n                        + 1\n                   END-IF\n               END-IF\n\n               PERFORM ENDBR-USER-SEC-FILE\n\n               MOVE CDEMO-CU00-PAGE-NUM TO PAGENUMI  OF COUSR0AI\n               MOVE SPACE   TO USRIDINO  OF COUSR0AO\n               PERFORM SEND-USRLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      PROCESS-PAGE-BACKWARD\n      *----------------------------------------------------------------*\n       PROCESS-PAGE-BACKWARD.\n\n           PERFORM STARTBR-USER-SEC-FILE\n\n           IF NOT ERR-FLG-ON\n\n               IF EIBAID NOT = DFHENTER  AND DFHPF8\n                   PERFORM READPREV-USER-SEC-FILE\n               END-IF\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 10\n                   PERFORM INITIALIZE-USER-DATA\n               END-PERFORM\n               END-IF\n\n               MOVE 10          TO  WS-IDX\n\n               PERFORM UNTIL WS-IDX <= 0 OR USER-SEC-EOF OR ERR-FLG-ON\n                   PERFORM READPREV-USER-SEC-FILE\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n                       PERFORM POPULATE-USER-DATA\n                       COMPUTE WS-IDX = WS-IDX - 1\n                   END-IF\n               END-PERFORM\n\n               IF USER-SEC-NOT-EOF AND ERR-FLG-OFF\n               PERFORM READPREV-USER-SEC-FILE\n               IF NEXT-PAGE-YES\n                   IF USER-SEC-NOT-EOF AND ERR-FLG-OFF AND\n                       CDEMO-CU00-PAGE-NUM > 1\n                       SUBTRACT 1 FROM CDEMO-CU00-PAGE-NUM\n                   ELSE\n                       MOVE 1 TO CDEMO-CU00-PAGE-NUM\n                   END-IF\n               END-IF\n               END-IF\n\n               PERFORM ENDBR-USER-SEC-FILE\n\n               MOVE CDEMO-CU00-PAGE-NUM TO PAGENUMI  OF COUSR0AI\n               PERFORM SEND-USRLST-SCREEN\n\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-USER-DATA\n      *----------------------------------------------------------------*\n       POPULATE-USER-DATA.\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SEC-USR-ID    TO USRID01I OF COUSR0AI\n                                         CDEMO-CU00-USRID-FIRST\n                   MOVE SEC-USR-FNAME TO FNAME01I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME01I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE01I OF COUSR0AI\n               WHEN 2\n                   MOVE SEC-USR-ID    TO USRID02I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME02I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME02I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE02I OF COUSR0AI\n               WHEN 3\n                   MOVE SEC-USR-ID    TO USRID03I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME03I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME03I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE03I OF COUSR0AI\n               WHEN 4\n                   MOVE SEC-USR-ID    TO USRID04I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME04I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME04I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE04I OF COUSR0AI\n               WHEN 5\n                   MOVE SEC-USR-ID    TO USRID05I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME05I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME05I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE05I OF COUSR0AI\n               WHEN 6\n                   MOVE SEC-USR-ID    TO USRID06I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME06I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME06I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE06I OF COUSR0AI\n               WHEN 7\n                   MOVE SEC-USR-ID    TO USRID07I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME07I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME07I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE07I OF COUSR0AI\n               WHEN 8\n                   MOVE SEC-USR-ID    TO USRID08I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME08I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME08I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE08I OF COUSR0AI\n               WHEN 9\n                   MOVE SEC-USR-ID    TO USRID09I OF COUSR0AI\n                   MOVE SEC-USR-FNAME TO FNAME09I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME09I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE09I OF COUSR0AI\n               WHEN 10\n                   MOVE SEC-USR-ID    TO USRID10I OF COUSR0AI\n                                         CDEMO-CU00-USRID-LAST\n                   MOVE SEC-USR-FNAME TO FNAME10I OF COUSR0AI\n                   MOVE SEC-USR-LNAME TO LNAME10I OF COUSR0AI\n                   MOVE SEC-USR-TYPE  TO UTYPE10I OF COUSR0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      INITIALIZE-USER-DATA\n      *----------------------------------------------------------------*\n       INITIALIZE-USER-DATA.\n\n           EVALUATE WS-IDX\n               WHEN 1\n                   MOVE SPACES TO USRID01I OF COUSR0AI\n                   MOVE SPACES TO FNAME01I OF COUSR0AI\n                   MOVE SPACES TO LNAME01I OF COUSR0AI\n                   MOVE SPACES TO UTYPE01I OF COUSR0AI\n               WHEN 2\n                   MOVE SPACES TO USRID02I OF COUSR0AI\n                   MOVE SPACES TO FNAME02I OF COUSR0AI\n                   MOVE SPACES TO LNAME02I OF COUSR0AI\n                   MOVE SPACES TO UTYPE02I OF COUSR0AI\n               WHEN 3\n                   MOVE SPACES TO USRID03I OF COUSR0AI\n                   MOVE SPACES TO FNAME03I OF COUSR0AI\n                   MOVE SPACES TO LNAME03I OF COUSR0AI\n                   MOVE SPACES TO UTYPE03I OF COUSR0AI\n               WHEN 4\n                   MOVE SPACES TO USRID04I OF COUSR0AI\n                   MOVE SPACES TO FNAME04I OF COUSR0AI\n                   MOVE SPACES TO LNAME04I OF COUSR0AI\n                   MOVE SPACES TO UTYPE04I OF COUSR0AI\n               WHEN 5\n                   MOVE SPACES TO USRID05I OF COUSR0AI\n                   MOVE SPACES TO FNAME05I OF COUSR0AI\n                   MOVE SPACES TO LNAME05I OF COUSR0AI\n                   MOVE SPACES TO UTYPE05I OF COUSR0AI\n               WHEN 6\n                   MOVE SPACES TO USRID06I OF COUSR0AI\n                   MOVE SPACES TO FNAME06I OF COUSR0AI\n                   MOVE SPACES TO LNAME06I OF COUSR0AI\n                   MOVE SPACES TO UTYPE06I OF COUSR0AI\n               WHEN 7\n                   MOVE SPACES TO USRID07I OF COUSR0AI\n                   MOVE SPACES TO FNAME07I OF COUSR0AI\n                   MOVE SPACES TO LNAME07I OF COUSR0AI\n                   MOVE SPACES TO UTYPE07I OF COUSR0AI\n               WHEN 8\n                   MOVE SPACES TO USRID08I OF COUSR0AI\n                   MOVE SPACES TO FNAME08I OF COUSR0AI\n                   MOVE SPACES TO LNAME08I OF COUSR0AI\n                   MOVE SPACES TO UTYPE08I OF COUSR0AI\n               WHEN 9\n                   MOVE SPACES TO USRID09I OF COUSR0AI\n                   MOVE SPACES TO FNAME09I OF COUSR0AI\n                   MOVE SPACES TO LNAME09I OF COUSR0AI\n                   MOVE SPACES TO UTYPE09I OF COUSR0AI\n               WHEN 10\n                   MOVE SPACES TO USRID10I OF COUSR0AI\n                   MOVE SPACES TO FNAME10I OF COUSR0AI\n                   MOVE SPACES TO LNAME10I OF COUSR0AI\n                   MOVE SPACES TO UTYPE10I OF COUSR0AI\n               WHEN OTHER\n                   CONTINUE\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      RETURN-TO-PREV-SCREEN\n      *----------------------------------------------------------------*\n       RETURN-TO-PREV-SCREEN.\n\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      SEND-USRLST-SCREEN\n      *----------------------------------------------------------------*\n       SEND-USRLST-SCREEN.\n\n           PERFORM POPULATE-HEADER-INFO\n\n           MOVE WS-MESSAGE TO ERRMSGO OF COUSR0AO\n\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('COUSR0A')\n                         MAPSET('COUSR00')\n                         FROM(COUSR0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('COUSR0A')\n                         MAPSET('COUSR00')\n                         FROM(COUSR0AO)\n      *                  ERASE\n                         CURSOR\n               END-EXEC\n           END-IF.\n\n      *----------------------------------------------------------------*\n      *                      RECEIVE-USRLST-SCREEN\n      *----------------------------------------------------------------*\n       RECEIVE-USRLST-SCREEN.\n\n           EXEC CICS RECEIVE\n                     MAP('COUSR0A')\n                     MAPSET('COUSR00')\n                     INTO(COUSR0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n\n      *----------------------------------------------------------------*\n      *                      POPULATE-HEADER-INFO\n      *----------------------------------------------------------------*\n       POPULATE-HEADER-INFO.\n\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01           TO TITLE01O OF COUSR0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF COUSR0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF COUSR0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF COUSR0AO\n\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COUSR0AO\n\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COUSR0AO.\n\n      *----------------------------------------------------------------*\n      *                      STARTBR-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       STARTBR-USER-SEC-FILE.\n\n           EXEC CICS STARTBR\n                DATASET   (WS-USRSEC-FILE)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n      *         GTEQ\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(NOTFND)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You are at the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READNEXT-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READNEXT-USER-SEC-FILE.\n\n           EXEC CICS READNEXT\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You have reached the bottom of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      READPREV-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       READPREV-USER-SEC-FILE.\n\n           EXEC CICS READPREV\n                DATASET   (WS-USRSEC-FILE)\n                INTO      (SEC-USER-DATA)\n                LENGTH    (LENGTH OF SEC-USER-DATA)\n                RIDFLD    (SEC-USR-ID)\n                KEYLENGTH (LENGTH OF SEC-USR-ID)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC.\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN DFHRESP(ENDFILE)\n                   CONTINUE\n                   SET USER-SEC-EOF TO TRUE\n                   MOVE 'You have reached the top of the page...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to lookup User...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO USRIDINL OF COUSR0AI\n                   PERFORM SEND-USRLST-SCREEN\n           END-EVALUATE.\n\n      *----------------------------------------------------------------*\n      *                      ENDBR-USER-SEC-FILE\n      *----------------------------------------------------------------*\n       ENDBR-USER-SEC-FILE.\n\n           EXEC CICS ENDBR\n                DATASET   (WS-USRSEC-FILE)\n           END-EXEC.\n      \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:34 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "COUSR00",
        "COTTL01Y",
        "DFHAID"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant COUSR00C as \"COUSR00C Program\"\n    participant USRSEC as \"USRSEC File\"\n    participant COUSR02C as \"COUSR02C (Update)\"\n    participant COUSR03C as \"COUSR03C (Delete)\"\n    participant COADM01C as \"COADM01C (Admin Menu)\"\n    \n    User->>COUSR00C: Access user listing screen\n    \n    alt First Entry (EIBCALEN = 0)\n        COUSR00C->>COSGN00C: Redirect to sign-on screen\n    else Program Re-entry\n        alt First Time Display\n            COUSR00C->>USRSEC: STARTBR (Browse user file)\n            USRSEC-->>COUSR00C: File status\n            COUSR00C->>USRSEC: READNEXT (Get user records)\n            USRSEC-->>COUSR00C: User records\n            COUSR00C->>USRSEC: ENDBR (End browse)\n            COUSR00C->>User: Display user list screen\n        else Process User Input\n            COUSR00C->>User: RECEIVE user input\n            \n            alt ENTER Key\n                User->>COUSR00C: Select user (U/D) or filter\n                \n                alt User Selected for Update\n                    COUSR00C->>COUSR02C: Transfer to update program\n                else User Selected for Delete\n                    COUSR00C->>COUSR03C: Transfer to delete program\n                else Filter Applied\n                    COUSR00C->>USRSEC: STARTBR with filter\n                    USRSEC-->>COUSR00C: File status\n                    COUSR00C->>USRSEC: READNEXT (Get filtered records)\n                    USRSEC-->>COUSR00C: Filtered user records\n                    COUSR00C->>USRSEC: ENDBR (End browse)\n                    COUSR00C->>User: Display filtered results\n                end\n                \n            else PF3 Key\n                User->>COUSR00C: Return to admin menu\n                COUSR00C->>COADM01C: Transfer to admin menu\n                \n            else PF7 Key (Page Up)\n                User->>COUSR00C: Request previous page\n                COUSR00C->>USRSEC: STARTBR (Browse user file)\n                USRSEC-->>COUSR00C: File status\n                COUSR00C->>USRSEC: READPREV (Get previous records)\n                USRSEC-->>COUSR00C: Previous user records\n                COUSR00C->>USRSEC: ENDBR (End browse)\n                COUSR00C->>User: Display previous page\n                \n            else PF8 Key (Page Down)\n                User->>COUSR00C: Request next page\n                COUSR00C->>USRSEC: STARTBR (Browse user file)\n                USRSEC-->>COUSR00C: File status\n                COUSR00C->>USRSEC: READNEXT (Get next records)\n                USRSEC-->>COUSR00C: Next user records\n                COUSR00C->>USRSEC: ENDBR (End browse)\n                COUSR00C->>User: Display next page\n                \n            else Other Key\n                COUSR00C->>User: Display invalid key message\n            end\n        end\n    end"
    },
    {
      "id": "COACTUPC",
      "author": "",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "",
            "description": "This section would typically contain the INPUT-OUTPUT SECTION of the COACTUPC program, which would define file control entries and file descriptions for the database files used in the account update process. However, the provided snippet is empty, suggesting that the INPUT-OUTPUT SECTION might be defined elsewhere in the program or inherited from included copybooks. In the CardDemo application context, this section would normally specify the CICS files for account data (ACCTDAT), customer data (CUSTDAT), and card cross-reference files that the program accesses for viewing and updating account information."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01  WS-MISC-STORAGE.\n      ******************************************************************\n      * General CICS related\n      ******************************************************************\n         05 WS-CICS-PROCESSNG-VARS.\n            07 WS-RESP-CD                          PIC S9(09) COMP\n                                                   VALUE ZEROS.\n            07 WS-REAS-CD                          PIC S9(09) COMP\n                                                   VALUE ZEROS.\n            07 WS-TRANID                           PIC X(4)\n                                                   VALUE SPACES.\n            07 WS-UCTRANS                          PIC X(4)\n                                                   VALUE SPACES.\n      ******************************************************************\n      *      Input edits\n      ******************************************************************\n      *  Generic Input Edits\n         05  WS-GENERIC-EDITS.\n           10 WS-EDIT-VARIABLE-NAME                PIC X(25).\n\n           10 WS-EDIT-SIGNED-NUMBER-9V2-X          PIC X(15).\n           10 WS-FLG-SIGNED-NUMBER-EDIT            PIC X(1).\n              88  FLG-SIGNED-NUMBER-ISVALID        VALUE LOW-VALUES.\n              88  FLG-SIGNED-NUMBER-NOT-OK         VALUE '0'.\n              88  FLG-SIGNED-NUMBER-BLANK          VALUE 'B'.\n\n           10 WS-EDIT-ALPHANUM-ONLY                PIC X(256).\n           10 WS-EDIT-ALPHANUM-LENGTH              PIC S9(4) COMP-3.\n\n           10 WS-EDIT-ALPHA-ONLY-FLAGS             PIC X(1).\n              88  FLG-ALPHA-ISVALID                VALUE LOW-VALUES.\n              88  FLG-ALPHA-NOT-OK                 VALUE '0'.\n              88  FLG-ALPHA-BLANK                  VALUE 'B'.\n           10 WS-EDIT-ALPHANUM-ONLY-FLAGS          PIC X(1).\n              88  FLG-ALPHNANUM-ISVALID            VALUE LOW-VALUES.\n              88  FLG-ALPHNANUM-NOT-OK             VALUE '0'.\n              88  FLG-ALPHNANUM-BLANK              VALUE 'B'.\n           10 WS-EDIT-MANDATORY-FLAGS              PIC X(1).\n              88  FLG-MANDATORY-ISVALID            VALUE LOW-VALUES.\n              88  FLG-MANDATORY-NOT-OK             VALUE '0'.\n              88  FLG-MANDATORY-BLANK              VALUE 'B'.\n           10 WS-EDIT-YES-NO                       PIC X(1)\n                                                   VALUE 'N'.\n              88 FLG-YES-NO-ISVALID                VALUES 'Y', 'N'.\n              88 FLG-YES-NO-NOT-OK                 VALUE '0'.\n              88 FLG-YES-NO-BLANK                  VALUE 'B'.\n\n           10 WS-EDIT-US-PHONE-NUM                 PIC X(15).\n           10 WS-EDIT-US-PHONE-NUM-X REDEFINES\n              WS-EDIT-US-PHONE-NUM.\n              20 FILLER                            PIC X(1).\n      *                                            VALUE '('\n              20 WS-EDIT-US-PHONE-NUMA             PIC X(3).\n              20 WS-EDIT-US-PHONE-NUMA-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMA             PIC 9(3).\n              20 FILLER                            PIC X(1).\n      *                                            VALUE ')'\n              20 WS-EDIT-US-PHONE-NUMB             PIC X(3).\n              20 WS-EDIT-US-PHONE-NUMB-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMB             PIC 9(3).\n              20 FILLER                            PIC X(1).\n      *                                            VALUE '-'\n              20 WS-EDIT-US-PHONE-NUMC             PIC X(4).\n              20 WS-EDIT-US-PHONE-NUMC-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMC             PIC 9(4).\n              20 FILLER                            PIC X(2).\n           10 WS-EDIT-US-PHONE-NUM-FLGS.\n               88 WS-EDIT-US-PHONE-IS-INVALID      VALUE '000'.\n               88 WS-EDIT-US-PHONE-IS-VALID        VALUE LOW-VALUES.\n               20 WS-EDIT-US-PHONEA-FLG            PIC X(01).\n                  88 FLG-EDIT-US-PHONEA-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEA-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEA-BLANK      VALUE 'B'.\n               20 WS-EDIT-EDIT-US-PHONEB           PIC X(01).\n                  88 FLG-EDIT-US-PHONEB-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEB-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEB-BLANK      VALUE 'B'.\n               20 WS-EDIT-EDIT-PHONEC              PIC X(01).\n                  88 FLG-EDIT-US-PHONEC-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEC-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEC-BLANK      VALUE 'B'.\n\n           10 WS-EDIT-US-SSN.\n               20 WS-EDIT-US-SSN-PART1              PIC X(3).\n               20 WS-EDIT-US-SSN-PART1-N REDEFINES\n                  WS-EDIT-US-SSN-PART1              PIC 9(3).\n                  88 INVALID-SSN-PART1  VALUES      0,\n                                                    666,\n                                                    900 THRU 999.\n               20 WS-EDIT-US-SSN-PART2              PIC X(2).\n               20 WS-EDIT-US-SSN-PART2-N REDEFINES\n                  WS-EDIT-US-SSN-PART2              PIC 9(2).\n               20 WS-EDIT-US-SSN-PART3              PIC X(4).\n               20 WS-EDIT-US-SSN-PART3-N REDEFINES\n                  WS-EDIT-US-SSN-PART3              PIC 9(4).\n           10 WS-EDIT-US-SSN-N REDEFINES\n              WS-EDIT-US-SSN                        PIC 9(09).\n           10 WS-EDIT-US-SSN-FLGS.\n               88 WS-EDIT-US-SSN-IS-INVALID         VALUE '000'.\n               88 WS-EDIT-US-SSN-IS-VALID           VALUE LOW-VALUES.\n               20 WS-EDIT-US-SSN-PART1-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART1-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART1-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART1-BLANK    VALUE 'B'.\n               20 WS-EDIT-US-SSN-PART2-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART2-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART2-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART2-BLANK    VALUE 'B'.\n               20 WS-EDIT-US-SSN-PART3-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART3-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART3-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART3-BLANK    VALUE 'B'.\n\n      ******************************************************************\n      *    Work variables\n      ******************************************************************\n         05 WS-CALCULATION-VARS.\n          10 WS-DIV-BY                             PIC S9(4) COMP-3\n                                                   VALUE 4.\n          10 WS-DIVIDEND                           PIC S9(4) COMP-3\n                                                   VALUE 0.\n\n          10 WS-REMAINDER                          PIC S9(4) COMP-3\n                                                   VALUE 0.\n          10 WS-CURR-DATE                          PIC X(21)\n                                                   VALUE SPACES.\n\n\n      ******************************************************************\n      *    Generic date edit variables CCYYMMDD\n      ******************************************************************\n           COPY 'CSUTLDWY'.\n      ******************************************************************\n         05  WS-DATACHANGED-FLAG                   PIC X(1).\n           88  NO-CHANGES-FOUND                    VALUE '0'.\n           88  CHANGE-HAS-OCCURRED                 VALUE '1'.\n         05  WS-INPUT-FLAG                         PIC X(1).\n           88  INPUT-OK                            VALUE '0'.\n           88  INPUT-ERROR                         VALUE '1'.\n           88  INPUT-PENDING                       VALUE LOW-VALUES.\n         05  WS-RETURN-FLAG                        PIC X(1).\n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.\n           88  WS-RETURN-FLAG-ON                   VALUE '1'.\n         05  WS-PFK-FLAG                           PIC X(1).\n           88  PFK-VALID                           VALUE '0'.\n           88  PFK-INVALID                         VALUE '1'.\n\n      *  Program specific edits\n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).\n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.\n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.\n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.\n         05  WS-EDIT-CUST-FLAG                     PIC X(1).\n           88  FLG-CUSTFILTER-ISVALID              VALUE '1'.\n           88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.\n           88  FLG-CUSTFILTER-BLANK                VALUE ' '.\n         05 WS-NON-KEY-FLAGS.\n           10  WS-EDIT-ACCT-STATUS                 PIC  X(1).\n               88  FLG-ACCT-STATUS-ISVALID         VALUES 'Y', 'N'.\n               88  FLG-ACCT-STATUS-NOT-OK          VALUE '0'.\n               88  FLG-ACCT-STATUS-BLANK           VALUE 'B'.\n           10  WS-EDIT-CREDIT-LIMIT                PIC  X(1).\n               88  FLG-CRED-LIMIT-ISVALID          VALUE LOW-VALUES.\n               88  FLG-CRED-LIMIT-NOT-OK           VALUE '0'.\n               88  FLG-CRED-LIMIT-BLANK            VALUE 'B'.\n           10  WS-EDIT-CASH-CREDIT-LIMIT           PIC  X(1).\n               88  FLG-CASH-CREDIT-LIMIT-ISVALID   VALUE LOW-VALUES.\n               88  FLG-CASH-CREDIT-LIMIT-NOT-OK    VALUE '0'.\n               88  FLG-CASH-CREDIT-LIMIT-BLANK     VALUE 'B'.\n           10  WS-EDIT-CURR-BAL                    PIC  X(1).\n               88  FLG-CURR-BAL-ISVALID            VALUE LOW-VALUES.\n               88  FLG-CURR-BAL-NOT-OK             VALUE '0'.\n               88  FLG-CURR-BAL-BLANK              VALUE 'B'.\n           10  WS-EDIT-CURR-CYC-CREDIT             PIC  X(1).\n               88  FLG-CURR-CYC-CREDIT-ISVALID     VALUE LOW-VALUES.\n               88  FLG-CURR-CYC-CREDIT-NOT-OK      VALUE '0'.\n               88  FLG-CURR-CYC-CREDIT-BLANK       VALUE 'B'.\n           10  WS-EDIT-CURR-CYC-DEBIT              PIC  X(1).\n               88  FLG-CURR-CYC-DEBIT-ISVALID      VALUE LOW-VALUES.\n               88  FLG-CURR-CYC-DEBIT-NOT-OK       VALUE '0'.\n               88  FLG-CURR-CYC-DEBIT-BLANK        VALUE 'B'.\n           10 WS-EDIT-DT-OF-BIRTH-FLGS.\n               88 WS-EDIT-DT-OF-BIRTH-INVALID      VALUE '000'.\n               88 WS-EDIT-DT-OF-BIRTH-ISVALID      VALUE LOW-VALUES.\n               20 WS-EDIT-DT-OF-BIRTH-YEAR-FLG     PIC X(01).\n                  88 FLG-DT-OF-BIRTH-YEAR-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-YEAR-NOT-OK   VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-YEAR-BLANK    VALUE 'B'.\n               20 WS-EDIT-DT-OF-BIRTH-MONTH        PIC X(01).\n                  88 FLG-DT-OF-BIRTH-MONTH-ISVALID VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-MONTH-NOT-OK  VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-MONTH-BLANK   VALUE 'B'.\n               20 WS-EDIT-DT-OF-BIRTH-DAY          PIC X(01).\n                  88 FLG-DT-OF-BIRTH-DAY-ISVALID   VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-DAY-NOT-OK    VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-DAY-BLANK     VALUE 'B'.\n           10  WS-EDIT-FICO-SCORE-FLGS             PIC  X(1).\n               88  FLG-FICO-SCORE-ISVALID          VALUE LOW-VALUES.\n               88  FLG-FICO-SCORE-NOT-OK           VALUE '0'.\n               88  FLG-FICO-SCORE-BLANK            VALUE 'B'.\n           10 WS-EDIT-OPEN-DATE-FLGS.\n               88 WS-EDIT-OPEN-DATE-IS-INVALID     VALUE '000'.\n               20 WS-EDIT-OPEN-YEAR-FLG            PIC X(01).\n                  88 FLG-OPEN-YEAR-ISVALID         VALUE LOW-VALUES.\n                  88 FLG-OPEN-YEAR-NOT-OK          VALUE '0'.\n                  88 FLG-OPEN-YEAR-BLANK           VALUE 'B'.\n               20 WS-EDIT-OPEN-MONTH               PIC X(01).\n                  88 FLG-OPEN-MONTH-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-OPEN-MONTH-NOT-OK         VALUE '0'.\n                  88 FLG-OPEN-MONTH-BLANK          VALUE 'B'.\n               20 WS-EDIT-OPEN-DAY                 PIC X(01).\n                  88 FLG-OPEN-DAY-ISVALID          VALUE LOW-VALUES.\n                  88 FLG-OPEN-DAY-NOT-OK           VALUE '0'.\n                  88 FLG-OPEN-DAY-BLANK            VALUE 'B'.\n           10 WS-EXPIRY-DATE-FLGS.\n               88 WS-EDIT-EXPIRY-IS-INVALID        VALUE '000'.\n               20 WS-EDIT-EXPIRY-YEAR-FLG          PIC X(01).\n                  88 FLG-EXPIRY-YEAR-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-YEAR-NOT-OK        VALUE '0'.\n                  88 FLG-EXPIRY-YEAR-BLANK         VALUE 'B'.\n               20 WS-EDIT-EXPIRY-MONTH             PIC X(01).\n                  88 FLG-EXPIRY-MONTH-ISVALID      VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-MONTH-NOT-OK       VALUE '0'.\n                  88 FLG-EXPIRY-MONTH-BLANK        VALUE 'B'.\n               20 WS-EDIT-EXPIRY-DAY               PIC X(01).\n                  88 FLG-EXPIRY-DAY-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-DAY-NOT-OK         VALUE '0'.\n                  88 FLG-EXPIRY-DAY-BLANK          VALUE 'B'.\n           10 WS-EDIT-REISSUE-DATE-FLGS.\n               88 WS-EDIT-REISSUE-DATE-INVALID     VALUE '000'.\n               20 WS-EDIT-REISSUE-YEAR-FLG         PIC X(01).\n                  88 FLG-REISSUE-YEAR-ISVALID      VALUE LOW-VALUES.\n                  88 FLG-REISSUE-YEAR-NOT-OK       VALUE '0'.\n                  88 FLG-REISSUE-YEAR-BLANK        VALUE 'B'.\n               20 WS-EDIT-REISSUE-MONTH            PIC X(01).\n                  88 FLG-REISSUE-MONTH-ISVALID     VALUE LOW-VALUES.\n                  88 FLG-REISSUE-MONTH-NOT-OK      VALUE '0'.\n                  88 FLG-REISSUE-MONTH-BLANK       VALUE 'B'.\n               20 WS-EDIT-REISSUE-DAY              PIC X(01).\n                  88 FLG-REISSUE-DAY-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-REISSUE-DAY-NOT-OK        VALUE '0'.\n                  88 FLG-REISSUE-DAY-BLANK         VALUE 'B'.\n           10 WS-EDIT-NAME-FLAGS.\n               20 WS-EDIT-FIRST-NAME-FLGS          PIC X(01).\n                  88 FLG-FIRST-NAME-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-FIRST-NAME-NOT-OK         VALUE '0'.\n                  88 FLG-FIRST-NAME-BLANK          VALUE 'B'.\n               20 WS-EDIT-MIDDLE-NAME-FLGS         PIC X(01).\n                  88 FLG-MIDDLE-NAME-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-MIDDLE-NAME-NOT-OK        VALUE '0'.\n                  88 FLG-MIDDLE-NAME-BLANK         VALUE 'B'.\n               20 WS-EDIT-LAST-NAME-FLGS           PIC X(01).\n                  88 FLG-LAST-NAME-ISVALID         VALUE LOW-VALUES.\n                  88 FLG-LAST-NAME-NOT-OK          VALUE '0'.\n                  88 FLG-LAST-NAME-BLANK           VALUE 'B'.\n           10 WS-EDIT-ADDRESS-FLAGS.\n               20 WS-EDIT-ADDRESS-LINE-1-FLGS      PIC X(01).\n                  88 FLG-ADDRESS-LINE-1-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-ADDRESS-LINE-1-NOT-OK     VALUE '0'.\n                  88 FLG-ADDRESS-LINE-1-BLANK      VALUE 'B'.\n               20 WS-EDIT-ADDRESS-LINE-2-FLGS      PIC X(01).\n                  88 FLG-ADDRESS-LINE-2-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-ADDRESS-LINE-2-NOT-OK     VALUE '0'.\n                  88 FLG-ADDRESS-LINE-2-BLANK      VALUE 'B'.\n               20 WS-EDIT-CITY-FLGS                PIC X(01).\n                  88 FLG-CITY-ISVALID              VALUE LOW-VALUES.\n                  88 FLG-CITY-NOT-OK               VALUE '0'.\n                  88 FLG-CITY-BLANK                VALUE 'B'.\n               20 WS-EDIT-STATE-FLGS               PIC X(01).\n                  88 FLG-STATE-ISVALID             VALUE LOW-VALUES.\n                  88 FLG-STATE-NOT-OK              VALUE '0'.\n                  88 FLG-STATE-BLANK               VALUE 'B'.\n               20 WS-EDIT-ZIPCODE-FLGS             PIC X(01).\n                  88 FLG-ZIPCODE-ISVALID           VALUE LOW-VALUES.\n                  88 FLG-ZIPCODE-NOT-OK            VALUE '0'.\n                  88 FLG-ZIPCODE-BLANK             VALUE 'B'.\n               20 WS-EDIT-COUNTRY-FLGS             PIC X(01).\n                  88 FLG-COUNTRY-ISVALID           VALUE LOW-VALUES.\n                  88 FLG-COUNTRY-NOT-OK            VALUE '0'.\n                  88 FLG-COUNTRY-BLANK             VALUE 'B'.\n               20 WS-EDIT-PHONE-NUM-1-FLGS.\n                  88 WS-EDIT-PHONE-NUM-1-IS-INVALID\n                                                   VALUE '000'.\n                  30 WS-EDIT-PHONE-NUM-1A-FLG      PIC X(01).\n                     88 FLG-PHONE-NUM-1A-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1A-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1A-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-1B          PIC X(01).\n                     88 FLG-PHONE-NUM-1B-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1B-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1B-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-1C          PIC X(01).\n                     88 FLG-PHONE-NUM-1C-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1C-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1C-BLANK     VALUE 'B'.\n               20 WS-EDIT-PHONE-NUM-2-FLGS.\n                  88 WS-EDIT-PHONE-NUM-2-IS-INVALID\n                                                   VALUE '000'.\n                  30 WS-EDIT-PHONE-NUM-2A-FLG      PIC X(01).\n                     88 FLG-PHONE-NUM-2A-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2A-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2A-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-2B          PIC X(01).\n                     88 FLG-PHONE-NUM-2B-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2B-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2B-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-2C          PIC X(01).\n                     88 FLG-PHONE-NUM-2C-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2C-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2C-BLANK     VALUE 'B'.\n           10  WS-EFT-ACCOUNT-ID-FLGS              PIC X(01).\n               88 FLG-EFT-ACCOUNT-ID-ISVALID       VALUE LOW-VALUES.\n               88 FLG-EFT-ACCOUNT-ID-NOT-OK        VALUE '0'.\n               88 FLG-EFT-ACCOUNT-ID-BLANK         VALUE 'B'.\n           10  WS-EDIT-PRI-CARDHOLDER              PIC  X(1).\n               88  FLG-PRI-CARDHOLDER-ISVALID      VALUES 'Y', 'N'.\n               88  FLG-PRI-CARDHOLDER-NOT-OK       VALUE '0'.\n               88  FLG-PRI-CARDHOLDER-BLANK        VALUE 'B'.\n\n      ******************************************************************\n      * Output edits\n      ******************************************************************\n         05 CICS-OUTPUT-EDIT-VARS.\n           10  CUST-ACCT-ID-X                      PIC X(11).\n           10  CUST-ACCT-ID-N REDEFINES CUST-ACCT-ID-X\n                                                   PIC 9(11).\n           10  WS-EDIT-DATE-X                      PIC X(10).\n           10  FILLER REDEFINES WS-EDIT-DATE-X.\n               20 WS-EDIT-DATE-X-YEAR              PIC X(4).\n               20 FILLER                           PIC X(1).\n               20 WS-EDIT-DATE-MONTH               PIC X(2).\n               20 FILLER                           PIC X(1).\n               20 WS-EDIT-DATE-DAY                 PIC X(2).\n           10  WS-EDIT-DATE-X REDEFINES\n               WS-EDIT-DATE-X                      PIC 9(10).\n           10  WS-EDIT-CURRENCY-9-2                PIC X(15).\n           10  WS-EDIT-CURRENCY-9-2-F              PIC +ZZZ,ZZZ,ZZZ.99.\n\n      ******************************************************************\n      *      File and data Handling\n      ******************************************************************\n         05 WS-XREF-RID.\n           10  WS-CARD-RID-CARDNUM                 PIC X(16).\n           10  WS-CARD-RID-CUST-ID                 PIC 9(09).\n           10  WS-CARD-RID-CUST-ID-X REDEFINES\n                  WS-CARD-RID-CUST-ID              PIC X(09).\n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).\n           10  WS-CARD-RID-ACCT-ID-X REDEFINES\n                  WS-CARD-RID-ACCT-ID              PIC X(11).\n         05  WS-FILE-READ-FLAGS.\n           10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).\n              88 FOUND-ACCT-IN-MASTER              VALUE '1'.\n           10 WS-CUST-MASTER-READ-FLAG             PIC X(1).\n              88 FOUND-CUST-IN-MASTER              VALUE '1'.\n         05  WS-FILE-ERROR-MESSAGE.\n           10  FILLER                         PIC X(12)\n                                                   VALUE 'File Error: '.\n           10  ERROR-OPNAME                        PIC X(8)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(4)\n                                                   VALUE ' on '.\n           10  ERROR-FILE                          PIC X(9)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(15)\n                                                   VALUE\n                                                   ' returned RESP '.\n           10  ERROR-RESP                          PIC X(10)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(7)\n                                                   VALUE ',RESP2 '.\n           10  ERROR-RESP2                         PIC X(10)\n                                                   VALUE SPACES.\n          10  FILLER                               PIC X(5)\n                                                   VALUE SPACES.\n      *  Alpha variables for editing numerics\n      *\n          05 ALPHA-VARS-FOR-DATA-EDITING.\n             15 ACUP-NEW-CREDIT-LIMIT-X            PIC X(15).\n             15 ACUP-NEW-CASH-CREDIT-LIMIT-X       PIC X(15).\n             15 ACUP-NEW-CURR-BAL-X                PIC X(15).\n             15 ACUP-NEW-CURR-CYC-CREDIT-X         PIC X(15).\n             15 ACUP-NEW-CURR-CYC-DEBIT-X          PIC X(15).\n\n          05 ACCT-UPDATE-RECORD.\n      *****************************************************************\n      *    Data-structure for  account entity (RECLN 300)\n      *****************************************************************\n               15  ACCT-UPDATE-ID                      PIC 9(11).\n               15  ACCT-UPDATE-ACTIVE-STATUS           PIC X(01).\n               15  ACCT-UPDATE-CURR-BAL                PIC S9(10)V99.\n               15  ACCT-UPDATE-CREDIT-LIMIT            PIC S9(10)V99.\n               15  ACCT-UPDATE-CASH-CREDIT-LIMIT       PIC S9(10)V99.\n               15  ACCT-UPDATE-OPEN-DATE               PIC X(10).\n               15  ACCT-UPDATE-EXPIRAION-DATE          PIC X(10).\n               15  ACCT-UPDATE-REISSUE-DATE            PIC X(10).\n               15  ACCT-UPDATE-CURR-CYC-CREDIT         PIC S9(10)V99.\n               15  ACCT-UPDATE-CURR-CYC-DEBIT          PIC S9(10)V99.\n               15  ACCT-UPDATE-GROUP-ID                PIC X(10).\n               15  FILLER                              PIC X(188).\n          05 CUST-UPDATE-RECORD.\n      *****************************************************************\n      *    Data-structure for  CUSTOMER entity (RECLN 300)\n      *****************************************************************\n               15  CUST-UPDATE-ID                      PIC 9(09).\n               15  CUST-UPDATE-FIRST-NAME              PIC X(25).\n               15  CUST-UPDATE-MIDDLE-NAME             PIC X(25).\n               15  CUST-UPDATE-LAST-NAME               PIC X(25).\n               15  CUST-UPDATE-ADDR-LINE-1             PIC X(50).\n               15  CUST-UPDATE-ADDR-LINE-2             PIC X(50).\n               15  CUST-UPDATE-ADDR-LINE-3             PIC X(50).\n               15  CUST-UPDATE-ADDR-STATE-CD           PIC X(02).\n               15  CUST-UPDATE-ADDR-COUNTRY-CD         PIC X(03).\n               15  CUST-UPDATE-ADDR-ZIP                PIC X(10).\n               15  CUST-UPDATE-PHONE-NUM-1             PIC X(15).\n               15  CUST-UPDATE-PHONE-NUM-2             PIC X(15).\n               15  CUST-UPDATE-SSN                     PIC 9(09).\n               15  CUST-UPDATE-GOVT-ISSUED-ID          PIC X(20).\n               15  CUST-UPDATE-DOB-YYYY-MM-DD          PIC X(10).\n               15  CUST-UPDATE-EFT-ACCOUNT-ID          PIC X(10).\n               15  CUST-UPDATE-PRI-CARD-IND            PIC X(01).\n               15  CUST-UPDATE-FICO-CREDIT-SCORE       PIC 9(03).\n               15  FILLER                              PIC X(168).\n\n\n      ******************************************************************\n      *      Output Message Construction\n      ******************************************************************\n         05  WS-LONG-MSG                           PIC X(500).\n         05  WS-INFO-MSG                           PIC X(40).\n           88  WS-NO-INFO-MESSAGE                 VALUES\n                                                  SPACES LOW-VALUES.\n           88  FOUND-ACCOUNT-DATA             VALUE\n               'Details of selected account shown above'.\n           88  PROMPT-FOR-SEARCH-KEYS              VALUE\n               'Enter or update id of account to update'.\n           88  PROMPT-FOR-CHANGES                  VALUE\n               'Update account details presented above.'.\n           88  PROMPT-FOR-CONFIRMATION             VALUE\n               'Changes validated.Press F5 to save'.\n           88  CONFIRM-UPDATE-SUCCESS              VALUE\n               'Changes committed to database'.\n           88  INFORM-FAILURE                      VALUE\n               'Changes unsuccessful. Please try again'.\n\n         05  WS-RETURN-MSG                         PIC X(75).\n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.\n           88  WS-EXIT-MESSAGE                     VALUE\n               'PF03 pressed.Exiting              '.\n           88  WS-PROMPT-FOR-ACCT                  VALUE\n               'Account number not provided'.\n           88  WS-PROMPT-FOR-LASTNAME              VALUE\n               'Last name not provided'.\n           88  WS-NAME-MUST-BE-ALPHA               VALUE\n               'Name can only contain alphabets and spaces'.\n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE\n               'No input received'.\n           88  NO-CHANGES-DETECTED                 VALUE\n               'No change detected with respect to values fetched.'.\n           88  SEARCHED-ACCT-ZEROES                VALUE\n               'Account number must be a non zero 11 digit number'.\n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE\n               'Account number must be a non zero 11 digit number'.\n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE\n               'Did not find this account in account card xref file'.\n           88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE\n               'Did not find this account in account master file'.\n           88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE\n               'Did not find associated customer in master file'.\n           88  ACCT-STATUS-MUST-BE-YES-NO          VALUE\n               'Account Active Status must be Y or N'.\n           88  CRED-LIMIT-IS-BLANK                 VALUE\n               'Credit Limit must be supplied'.\n           88  CRED-LIMIT-IS-NOT-VALID             VALUE\n               'Credit Limit is not valid'.\n           88  THIS-MONTH-NOT-VALID                VALUE\n               'Card expiry month must be between 1 and 12'.\n           88  THIS-YEAR-NOT-VALID                 VALUE\n               'Invalid card expiry year'.\n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE\n               'Did not find this account in cards database'.\n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE\n               'Did not find cards for this search condition'.\n           88  COULD-NOT-LOCK-ACCT-FOR-UPDATE      VALUE\n               'Could not lock account record for update'.\n           88  COULD-NOT-LOCK-CUST-FOR-UPDATE      VALUE\n               'Could not lock customer record for update'.\n           88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE\n               'Record changed by some one else. Please review'.\n           88  LOCKED-BUT-UPDATE-FAILED            VALUE\n               'Update of record failed'.\n           88  XREF-READ-ERROR                     VALUE\n               'Error reading Card Data File'.\n           88  CODING-TO-BE-DONE                   VALUE\n               'Looks Good.... so far'.\n      ******************************************************************\n      *      Literals and Constants\n      ******************************************************************\n       01 WS-LITERALS.\n          05 LIT-THISPGM                           PIC X(8)\n                                                   VALUE 'COACTUPC'.\n          05 LIT-THISTRANID                        PIC X(4)\n                                                   VALUE 'CAUP'.\n          05 LIT-THISMAPSET                        PIC X(8)\n                                                   VALUE 'COACTUP '.\n          05 LIT-THISMAP                           PIC X(7)\n                                                   VALUE 'CACTUPA'.\n          05 LIT-CARDUPDATE-PGM                    PIC X(8)\n                                                   VALUE 'COCRDUPC'.\n          05 LIT-CARDUPDATE-TRANID                 PIC X(4)\n                                                   VALUE 'CCUP'.\n          05 LIT-CARDUPDATE-MAPSET                 PIC X(8)\n                                                   VALUE 'COCRDUP '.\n          05 LIT-CARDUPDATE-MAP                    PIC X(7)\n                                                   VALUE 'CCRDUPA'.\n          05 LIT-CCLISTPGM                         PIC X(8)\n                                                   VALUE 'COCRDLIC'.\n          05 LIT-CCLISTTRANID                      PIC X(4)\n                                                   VALUE 'CCLI'.\n          05 LIT-CCLISTMAPSET                      PIC X(7)\n                                                   VALUE 'COCRDLI'.\n          05 LIT-CCLISTMAP                         PIC X(7)\n                                                   VALUE 'CCRDSLA'.\n          05 LIT-MENUPGM                           PIC X(8)\n                                                   VALUE 'COMEN01C'.\n          05 LIT-MENUTRANID                        PIC X(4)\n                                                   VALUE 'CM00'.\n          05 LIT-MENUMAPSET                        PIC X(7)\n                                                   VALUE 'COMEN01'.\n          05 LIT-MENUMAP                           PIC X(7)\n                                                   VALUE 'COMEN1A'.\n          05 LIT-CARDDTLPGM                        PIC X(8)\n                                                   VALUE 'COCRDSLC'.\n          05 LIT-CARDDTLTRANID                     PIC X(4)\n                                                   VALUE 'CCDL'.\n          05 LIT-CARDDTLMAPSET                     PIC X(7)\n                                                   VALUE 'COCRDSL'.\n          05 LIT-CARDDTLMAP                        PIC X(7)\n                                                   VALUE 'CCRDSLA'.\n          05 LIT-ACCTFILENAME                      PIC X(8)\n                                                   VALUE 'ACCTDAT '.\n          05 LIT-CUSTFILENAME                      PIC X(8)\n                                                   VALUE 'CUSTDAT '.\n          05 LIT-CARDFILENAME                      PIC X(8)\n                                                   VALUE 'CARDDAT '.\n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)\n                                                   VALUE 'CARDAIX '.\n          05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)\n                                                   VALUE 'CXACAIX '.\n      ******************************************************************\n      * Literals for use in INSPECT statements\n      ******************************************************************\n          05 LIT-ALL-ALPHANUM-FROM-X.\n             10 LIT-ALL-ALPHA-FROM-X.\n                15 LIT-UPPER                       PIC X(26)\n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.\n                15 LIT-LOWER                       PIC X(26)\n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.\n             10 LIT-NUMBERS                        PIC X(10)\n                                 VALUE '0123456789'.             \n      ******************************************************************\n      *Other common working storage Variables\n      ******************************************************************\n       COPY CVCRD01Y.\n      ******************************************************************\n      *Lookups\n      ******************************************************************\n      *North America Phone Area codes\n       COPY CSLKPCDY.\n\n      ******************************************************************\n      * Variables for use in INSPECT statements\n      ******************************************************************\n       01  LIT-ALL-ALPHA-FROM     PIC X(52) VALUE SPACES.\n       01  LIT-ALL-ALPHANUM-FROM  PIC X(62) VALUE SPACES.\n       01  LIT-ALL-NUM-FROM       PIC X(10) VALUE SPACES.\n       77  LIT-ALPHA-SPACES-TO    PIC X(52) VALUE SPACES.\n       77  LIT-ALPHANUM-SPACES-TO PIC X(62) VALUE SPACES.\n       77  LIT-NUM-SPACES-TO      PIC X(10) VALUE SPACES.\n\n      *IBM SUPPLIED COPYBOOKS\n       COPY DFHBMSCA.\n       COPY DFHAID.\n\n      *COMMON COPYBOOKS\n      *Screen Titles\n       COPY COTTL01Y.\n\n      *Account Update Screen Layout\n       COPY COACTUP.\n\n      *Current Date\n       COPY CSDAT01Y.\n\n      *Common Messages\n       COPY CSMSG01Y.\n\n      *Abend Variables\n       COPY CSMSG02Y.\n\n      *Signed on user data\n       COPY CSUSR01Y.\n\n      *Dataset layouts\n\n      *ACCT RECORD LAYOUT\n       COPY CVACT01Y.\n\n      *CARD XREF LAYOUT\n       COPY CVACT03Y.\n\n      *CUSTOMER LAYOUT\n       COPY CVCUS01Y.\n\n      ******************************************************************\n      *Application Commmarea Copybook\n       COPY COCOM01Y.\n\n       01 WS-THIS-PROGCOMMAREA.\n          05 ACCT-UPDATE-SCREEN-DATA.\n             10 ACUP-CHANGE-ACTION                     PIC X(1)\n                                                       VALUE LOW-VALUES.\n                88 ACUP-DETAILS-NOT-FETCHED            VALUES\n                                                       LOW-VALUES,\n                                                       SPACES.\n                88 ACUP-SHOW-DETAILS                   VALUE 'S'.\n                88 ACUP-CHANGES-MADE                   VALUES 'E', 'N'\n                                                            , 'C', 'L'\n                                                            , 'F'.\n                88 ACUP-CHANGES-NOT-OK                 VALUE 'E'.\n                88 ACUP-CHANGES-OK-NOT-CONFIRMED       VALUE 'N'.\n                88 ACUP-CHANGES-OKAYED-AND-DONE        VALUE 'C'.\n                88 ACUP-CHANGES-FAILED                 VALUES 'L', 'F'.\n                88 ACUP-CHANGES-OKAYED-LOCK-ERROR      VALUE 'L'.\n                88 ACUP-CHANGES-OKAYED-BUT-FAILED      VALUE 'F'.\n          05 ACUP-OLD-DETAILS.\n             10 ACUP-OLD-ACCT-DATA.\n                15  ACUP-OLD-ACCT-ID-X                 PIC X(11).\n                15  ACUP-OLD-ACCT-ID                   REDEFINES\n                    ACUP-OLD-ACCT-ID-X                 PIC 9(11).\n                15  ACUP-OLD-ACTIVE-STATUS             PIC X(01).\n                15  ACUP-OLD-CURR-BAL                  PIC X(12).\n                15  ACUP-OLD-CURR-BAL-N REDEFINES\n                    ACUP-OLD-CURR-BAL                  PIC S9(10)V99.\n                15  ACUP-OLD-CREDIT-LIMIT              PIC X(12).\n                15  ACUP-OLD-CREDIT-LIMIT-N            REDEFINES\n                    ACUP-OLD-CREDIT-LIMIT              PIC S9(10)V99.\n                15  ACUP-OLD-CASH-CREDIT-LIMIT         PIC X(12).\n                15  ACUP-OLD-CASH-CREDIT-LIMIT-N       REDEFINES\n                    ACUP-OLD-CASH-CREDIT-LIMIT         PIC S9(10)V99.\n                15  ACUP-OLD-OPEN-DATE                 PIC X(08).\n                15  ACUP-OLD-OPEN-DATE-PARTS           REDEFINES\n                    ACUP-OLD-OPEN-DATE.\n                    20 ACUP-OLD-OPEN-YEAR              PIC X(4).\n                    20 ACUP-OLD-OPEN-MON               PIC X(2).\n                    20 ACUP-OLD-OPEN-DAY               PIC X(2).\n                15  ACUP-OLD-EXPIRAION-DATE            PIC X(08).\n                15  ACUP-OLD-EXPIRAION-DATE-PARTS      REDEFINES\n                    ACUP-OLD-EXPIRAION-DATE.\n                    20 ACUP-OLD-EXP-YEAR                PIC X(4).\n                    20 ACUP-OLD-EXP-MON                 PIC X(2).\n                    20 ACUP-OLD-EXP-DAY                 PIC X(2).\n                15  ACUP-OLD-REISSUE-DATE              PIC X(08).\n                15  ACUP-OLD-REISSUE-DATE-PARTS        REDEFINES\n                    ACUP-OLD-REISSUE-DATE.\n                    20 ACUP-OLD-REISSUE-YEAR           PIC X(4).\n                    20 ACUP-OLD-REISSUE-MON            PIC X(2).\n                    20 ACUP-OLD-REISSUE-DAY            PIC X(2).\n                15  ACUP-OLD-CURR-CYC-CREDIT           PIC X(12).\n                15  ACUP-OLD-CURR-CYC-CREDIT-N         REDEFINES\n                    ACUP-OLD-CURR-CYC-CREDIT           PIC S9(10)V99.\n                15  ACUP-OLD-CURR-CYC-DEBIT            PIC X(12).\n                15  ACUP-OLD-CURR-CYC-DEBIT-N          REDEFINES\n                    ACUP-OLD-CURR-CYC-DEBIT            PIC S9(10)V99.\n                15  ACUP-OLD-GROUP-ID                  PIC X(10).\n             10 ACUP-OLD-CUST-DATA.\n                15  ACUP-OLD-CUST-ID-X                 PIC X(09).\n                15  ACUP-OLD-CUST-ID                   REDEFINES\n                    ACUP-OLD-CUST-ID-X                 PIC 9(09).\n                15  ACUP-OLD-CUST-FIRST-NAME           PIC X(25).\n                15  ACUP-OLD-CUST-MIDDLE-NAME          PIC X(25).\n                15  ACUP-OLD-CUST-LAST-NAME            PIC X(25).\n                15  ACUP-OLD-CUST-ADDR-LINE-1          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-LINE-2          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-LINE-3          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-STATE-CD        PIC X(02).\n                15  ACUP-OLD-CUST-ADDR-COUNTRY-CD      PIC X(03).\n                15  ACUP-OLD-CUST-ADDR-ZIP             PIC X(10).\n                15  ACUP-OLD-CUST-PHONE-NUM-1          PIC X(15).\n                15  ACUP-OLD-CUST-PHONE-NUM-1-X REDEFINES\n                    ACUP-OLD-CUST-PHONE-NUM-1.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-OLD-CUST-PHONE-NUM-2          PIC X(15).\n                15  ACUP-OLD-CUST-PHONE-NUM-2-X REDEFINES\n                    ACUP-OLD-CUST-PHONE-NUM-2.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-OLD-CUST-SSN-X                PIC X(09).\n                15  ACUP-OLD-CUST-SSN                  REDEFINES\n                    ACUP-OLD-CUST-SSN-X                PIC 9(09).\n                15  ACUP-OLD-CUST-GOVT-ISSUED-ID       PIC X(20).\n                15  ACUP-OLD-CUST-DOB-YYYY-MM-DD       PIC X(08).\n                15  ACUP-OLD-CUST-DOB-PARTS            REDEFINES\n                    ACUP-OLD-CUST-DOB-YYYY-MM-DD.\n                    20 ACUP-OLD-CUST-DOB-YEAR          PIC X(4).\n                    20 ACUP-OLD-CUST-DOB-MON           PIC X(2).\n                    20 ACUP-OLD-CUST-DOB-DAY           PIC X(2).\n                15  ACUP-OLD-CUST-EFT-ACCOUNT-ID       PIC X(10).\n                15  ACUP-OLD-CUST-PRI-HOLDER-IND       PIC X(01).\n                15  ACUP-OLD-CUST-FICO-SCORE-X         PIC X(03).\n                15  ACUP-OLD-CUST-FICO-SCORE           REDEFINES\n                    ACUP-OLD-CUST-FICO-SCORE-X         PIC 9(03).\n          05 ACUP-NEW-DETAILS.\n             10 ACUP-NEW-ACCT-DATA.\n                15  ACUP-NEW-ACCT-ID-X                 PIC X(11).\n                15  ACUP-NEW-ACCT-ID                   REDEFINES\n                    ACUP-NEW-ACCT-ID-X                 PIC 9(11).\n                15  ACUP-NEW-ACTIVE-STATUS             PIC X(01).\n                15  ACUP-NEW-CURR-BAL                  PIC X(12).\n                15  ACUP-NEW-CURR-BAL-N                REDEFINES\n                    ACUP-NEW-CURR-BAL                  PIC S9(10)V99.\n                15  ACUP-NEW-CREDIT-LIMIT              PIC X(12).\n                15  ACUP-NEW-CREDIT-LIMIT-N            REDEFINES\n                    ACUP-NEW-CREDIT-LIMIT              PIC S9(10)V99.\n                15  ACUP-NEW-CASH-CREDIT-LIMIT         PIC X(12).\n                15  ACUP-NEW-CASH-CREDIT-LIMIT-N       REDEFINES\n                    ACUP-NEW-CASH-CREDIT-LIMIT         PIC S9(10)V99.\n                15  ACUP-NEW-OPEN-DATE                 PIC X(08).\n                15  ACUP-NEW-OPEN-DATE-PARTS           REDEFINES\n                    ACUP-NEW-OPEN-DATE.\n                    20 ACUP-NEW-OPEN-YEAR              PIC X(4).\n                    20 ACUP-NEW-OPEN-MON               PIC X(2).\n                    20 ACUP-NEW-OPEN-DAY               PIC X(2).\n                15  ACUP-NEW-EXPIRAION-DATE            PIC X(08).\n                15  ACUP-NEW-EXPIRAION-DATE-PARTS      REDEFINES\n                    ACUP-NEW-EXPIRAION-DATE.\n                    20 ACUP-NEW-EXP-YEAR                PIC X(4).\n                    20 ACUP-NEW-EXP-MON                 PIC X(2).\n                    20 ACUP-NEW-EXP-DAY                 PIC X(2).\n                15  ACUP-NEW-REISSUE-DATE              PIC X(08).\n                15  ACUP-NEW-REISSUE-DATE-PARTS        REDEFINES\n                    ACUP-NEW-REISSUE-DATE.\n                    20 ACUP-NEW-REISSUE-YEAR           PIC X(4).\n                    20 ACUP-NEW-REISSUE-MON            PIC X(2).\n                    20 ACUP-NEW-REISSUE-DAY            PIC X(2).\n                15  ACUP-NEW-CURR-CYC-CREDIT           PIC X(12).\n                15  ACUP-NEW-CURR-CYC-CREDIT-N         REDEFINES\n                    ACUP-NEW-CURR-CYC-CREDIT           PIC S9(10)V99.\n                15  ACUP-NEW-CURR-CYC-DEBIT            PIC X(12).\n                15  ACUP-NEW-CURR-CYC-DEBIT-N          REDEFINES\n                    ACUP-NEW-CURR-CYC-DEBIT            PIC S9(10)V99.\n                15  ACUP-NEW-GROUP-ID                  PIC X(10).\n             10 ACUP-NEW-CUST-DATA.\n                15  ACUP-NEW-CUST-ID-X                 PIC X(09).\n                15  ACUP-NEW-CUST-ID                   REDEFINES\n                    ACUP-NEW-CUST-ID-X                 PIC 9(09).\n                15  ACUP-NEW-CUST-FIRST-NAME           PIC X(25).\n                15  ACUP-NEW-CUST-MIDDLE-NAME          PIC X(25).\n                15  ACUP-NEW-CUST-LAST-NAME            PIC X(25).\n                15  ACUP-NEW-CUST-ADDR-LINE-1          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-LINE-2          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-LINE-3          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-STATE-CD        PIC X(02).\n                15  ACUP-NEW-CUST-ADDR-COUNTRY-CD      PIC X(03).\n                15  ACUP-NEW-CUST-ADDR-ZIP             PIC X(10).\n                15  ACUP-NEW-CUST-PHONE-NUM-1          PIC X(15).\n                15  ACUP-NEW-CUST-PHONE-NUM-1-X REDEFINES\n                    ACUP-NEW-CUST-PHONE-NUM-1.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-NEW-CUST-PHONE-NUM-2          PIC X(15).\n                15  ACUP-NEW-CUST-PHONE-NUM-2-X REDEFINES\n                    ACUP-NEW-CUST-PHONE-NUM-2.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-NEW-CUST-SSN-X.\n                    20 ACUP-NEW-CUST-SSN-1             PIC X(03).\n                    20 ACUP-NEW-CUST-SSN-2             PIC X(02).\n                    20 ACUP-NEW-CUST-SSN-3             PIC X(04).\n                15  ACUP-NEW-CUST-SSN                  REDEFINES\n                    ACUP-NEW-CUST-SSN-X                PIC 9(09).\n                15  ACUP-NEW-CUST-GOVT-ISSUED-ID       PIC X(20).\n                15  ACUP-NEW-CUST-DOB-YYYY-MM-DD       PIC X(08).\n                15  ACUP-NEW-CUST-DOB-PARTS            REDEFINES\n                    ACUP-NEW-CUST-DOB-YYYY-MM-DD.\n                    20 ACUP-NEW-CUST-DOB-YEAR          PIC X(4).\n                    20 ACUP-NEW-CUST-DOB-MON           PIC X(2).\n                    20 ACUP-NEW-CUST-DOB-DAY           PIC X(2).\n                15  ACUP-NEW-CUST-EFT-ACCOUNT-ID       PIC X(10).\n                15  ACUP-NEW-CUST-PRI-HOLDER-IND       PIC X(01).\n                15  ACUP-NEW-CUST-FICO-SCORE-X         PIC X(03).\n                15  ACUP-NEW-CUST-FICO-SCORE           REDEFINES\n                    ACUP-NEW-CUST-FICO-SCORE-X         PIC 9(03).\n                    88 FICO-RANGE-IS-VALID             VALUES 300\n                                                       THROUGH 850.\n       01  WS-COMMAREA                                 PIC X(2000).",
            "description": "This data section defines the working storage variables for the COACTUPC program, which handles account updates in the CardDemo application. It contains several key components:\n\n1. CICS processing variables for tracking response codes and transaction IDs\n2. Extensive input validation structures for different data types including:\n   - Signed numbers and currency amounts\n   - Alphanumeric fields\n   - US phone numbers with area code validation\n   - Social Security Numbers with validity checks\n   - Yes/No indicators\n   - Mandatory field validation\n\n3. Date validation structures for various date fields (account opening, expiration, reissue dates, and customer date of birth)\n\n4. Status flags to track:\n   - Data changes\n   - Input validation status\n   - Return conditions\n   - Function key validity\n\n5. Field-specific validation flags for all account and customer data elements\n\n6. File handling variables for account, customer, and card cross-reference files\n\n7. Message construction areas for user feedback, error messages, and informational displays\n\n8. Record structures for account and customer data updates, including:\n   - Account details (ID, status, balances, credit limits, dates)\n   - Customer information (personal details, address, contact information)\n\n9. Program communication area (COMMAREA) structures to maintain state between transactions, with both \"old\" and \"new\" versions of all data fields to track changes\n\nThe section also includes various copybooks for common functionality like date handling, screen layouts, and file record definitions used throughout the CardDemo application."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.\n         05  FILLER                                PIC X(1)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.",
            "description": "This section defines the DFHCOMMAREA structure in the Linkage Section, which serves as the communication area for data passing between CICS programs. It contains a single field defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length passed in EIBCALEN (CICS Executive Interface Block Communication Area Length). This flexible structure allows the program to receive data of varying sizes from calling programs without needing to know the exact structure in advance."
          }
        ],
        "copybooks": [],
        "code": "WORKING-STORAGE SECTION.\n       01  WS-MISC-STORAGE.\n      ******************************************************************\n      * General CICS related\n      ******************************************************************\n         05 WS-CICS-PROCESSNG-VARS.\n            07 WS-RESP-CD                          PIC S9(09) COMP\n                                                   VALUE ZEROS.\n            07 WS-REAS-CD                          PIC S9(09) COMP\n                                                   VALUE ZEROS.\n            07 WS-TRANID                           PIC X(4)\n                                                   VALUE SPACES.\n            07 WS-UCTRANS                          PIC X(4)\n                                                   VALUE SPACES.\n      ******************************************************************\n      *      Input edits\n      ******************************************************************\n      *  Generic Input Edits\n         05  WS-GENERIC-EDITS.\n           10 WS-EDIT-VARIABLE-NAME                PIC X(25).\n\n           10 WS-EDIT-SIGNED-NUMBER-9V2-X          PIC X(15).\n           10 WS-FLG-SIGNED-NUMBER-EDIT            PIC X(1).\n              88  FLG-SIGNED-NUMBER-ISVALID        VALUE LOW-VALUES.\n              88  FLG-SIGNED-NUMBER-NOT-OK         VALUE '0'.\n              88  FLG-SIGNED-NUMBER-BLANK          VALUE 'B'.\n\n           10 WS-EDIT-ALPHANUM-ONLY                PIC X(256).\n           10 WS-EDIT-ALPHANUM-LENGTH              PIC S9(4) COMP-3.\n\n           10 WS-EDIT-ALPHA-ONLY-FLAGS             PIC X(1).\n              88  FLG-ALPHA-ISVALID                VALUE LOW-VALUES.\n              88  FLG-ALPHA-NOT-OK                 VALUE '0'.\n              88  FLG-ALPHA-BLANK                  VALUE 'B'.\n           10 WS-EDIT-ALPHANUM-ONLY-FLAGS          PIC X(1).\n              88  FLG-ALPHNANUM-ISVALID            VALUE LOW-VALUES.\n              88  FLG-ALPHNANUM-NOT-OK             VALUE '0'.\n              88  FLG-ALPHNANUM-BLANK              VALUE 'B'.\n           10 WS-EDIT-MANDATORY-FLAGS              PIC X(1).\n              88  FLG-MANDATORY-ISVALID            VALUE LOW-VALUES.\n              88  FLG-MANDATORY-NOT-OK             VALUE '0'.\n              88  FLG-MANDATORY-BLANK              VALUE 'B'.\n           10 WS-EDIT-YES-NO                       PIC X(1)\n                                                   VALUE 'N'.\n              88 FLG-YES-NO-ISVALID                VALUES 'Y', 'N'.\n              88 FLG-YES-NO-NOT-OK                 VALUE '0'.\n              88 FLG-YES-NO-BLANK                  VALUE 'B'.\n\n           10 WS-EDIT-US-PHONE-NUM                 PIC X(15).\n           10 WS-EDIT-US-PHONE-NUM-X REDEFINES\n              WS-EDIT-US-PHONE-NUM.\n              20 FILLER                            PIC X(1).\n      *                                            VALUE '('\n              20 WS-EDIT-US-PHONE-NUMA             PIC X(3).\n              20 WS-EDIT-US-PHONE-NUMA-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMA             PIC 9(3).\n              20 FILLER                            PIC X(1).\n      *                                            VALUE ')'\n              20 WS-EDIT-US-PHONE-NUMB             PIC X(3).\n              20 WS-EDIT-US-PHONE-NUMB-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMB             PIC 9(3).\n              20 FILLER                            PIC X(1).\n      *                                            VALUE '-'\n              20 WS-EDIT-US-PHONE-NUMC             PIC X(4).\n              20 WS-EDIT-US-PHONE-NUMC-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMC             PIC 9(4).\n              20 FILLER                            PIC X(2).\n           10 WS-EDIT-US-PHONE-NUM-FLGS.\n               88 WS-EDIT-US-PHONE-IS-INVALID      VALUE '000'.\n               88 WS-EDIT-US-PHONE-IS-VALID        VALUE LOW-VALUES.\n               20 WS-EDIT-US-PHONEA-FLG            PIC X(01).\n                  88 FLG-EDIT-US-PHONEA-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEA-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEA-BLANK      VALUE 'B'.\n               20 WS-EDIT-EDIT-US-PHONEB           PIC X(01).\n                  88 FLG-EDIT-US-PHONEB-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEB-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEB-BLANK      VALUE 'B'.\n               20 WS-EDIT-EDIT-PHONEC              PIC X(01).\n                  88 FLG-EDIT-US-PHONEC-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEC-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEC-BLANK      VALUE 'B'.\n\n           10 WS-EDIT-US-SSN.\n               20 WS-EDIT-US-SSN-PART1              PIC X(3).\n               20 WS-EDIT-US-SSN-PART1-N REDEFINES\n                  WS-EDIT-US-SSN-PART1              PIC 9(3).\n                  88 INVALID-SSN-PART1  VALUES      0,\n                                                    666,\n                                                    900 THRU 999.\n               20 WS-EDIT-US-SSN-PART2              PIC X(2).\n               20 WS-EDIT-US-SSN-PART2-N REDEFINES\n                  WS-EDIT-US-SSN-PART2              PIC 9(2).\n               20 WS-EDIT-US-SSN-PART3              PIC X(4).\n               20 WS-EDIT-US-SSN-PART3-N REDEFINES\n                  WS-EDIT-US-SSN-PART3              PIC 9(4).\n           10 WS-EDIT-US-SSN-N REDEFINES\n              WS-EDIT-US-SSN                        PIC 9(09).\n           10 WS-EDIT-US-SSN-FLGS.\n               88 WS-EDIT-US-SSN-IS-INVALID         VALUE '000'.\n               88 WS-EDIT-US-SSN-IS-VALID           VALUE LOW-VALUES.\n               20 WS-EDIT-US-SSN-PART1-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART1-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART1-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART1-BLANK    VALUE 'B'.\n               20 WS-EDIT-US-SSN-PART2-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART2-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART2-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART2-BLANK    VALUE 'B'.\n               20 WS-EDIT-US-SSN-PART3-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART3-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART3-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART3-BLANK    VALUE 'B'.\n\n      ******************************************************************\n      *    Work variables\n      ******************************************************************\n         05 WS-CALCULATION-VARS.\n          10 WS-DIV-BY                             PIC S9(4) COMP-3\n                                                   VALUE 4.\n          10 WS-DIVIDEND                           PIC S9(4) COMP-3\n                                                   VALUE 0.\n\n          10 WS-REMAINDER                          PIC S9(4) COMP-3\n                                                   VALUE 0.\n          10 WS-CURR-DATE                          PIC X(21)\n                                                   VALUE SPACES.\n\n\n      ******************************************************************\n      *    Generic date edit variables CCYYMMDD\n      ******************************************************************\n           COPY 'CSUTLDWY'.\n      ******************************************************************\n         05  WS-DATACHANGED-FLAG                   PIC X(1).\n           88  NO-CHANGES-FOUND                    VALUE '0'.\n           88  CHANGE-HAS-OCCURRED                 VALUE '1'.\n         05  WS-INPUT-FLAG                         PIC X(1).\n           88  INPUT-OK                            VALUE '0'.\n           88  INPUT-ERROR                         VALUE '1'.\n           88  INPUT-PENDING                       VALUE LOW-VALUES.\n         05  WS-RETURN-FLAG                        PIC X(1).\n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.\n           88  WS-RETURN-FLAG-ON                   VALUE '1'.\n         05  WS-PFK-FLAG                           PIC X(1).\n           88  PFK-VALID                           VALUE '0'.\n           88  PFK-INVALID                         VALUE '1'.\n\n      *  Program specific edits\n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).\n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.\n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.\n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.\n         05  WS-EDIT-CUST-FLAG                     PIC X(1).\n           88  FLG-CUSTFILTER-ISVALID              VALUE '1'.\n           88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.\n           88  FLG-CUSTFILTER-BLANK                VALUE ' '.\n         05 WS-NON-KEY-FLAGS.\n           10  WS-EDIT-ACCT-STATUS                 PIC  X(1).\n               88  FLG-ACCT-STATUS-ISVALID         VALUES 'Y', 'N'.\n               88  FLG-ACCT-STATUS-NOT-OK          VALUE '0'.\n               88  FLG-ACCT-STATUS-BLANK           VALUE 'B'.\n           10  WS-EDIT-CREDIT-LIMIT                PIC  X(1).\n               88  FLG-CRED-LIMIT-ISVALID          VALUE LOW-VALUES.\n               88  FLG-CRED-LIMIT-NOT-OK           VALUE '0'.\n               88  FLG-CRED-LIMIT-BLANK            VALUE 'B'.\n           10  WS-EDIT-CASH-CREDIT-LIMIT           PIC  X(1).\n               88  FLG-CASH-CREDIT-LIMIT-ISVALID   VALUE LOW-VALUES.\n               88  FLG-CASH-CREDIT-LIMIT-NOT-OK    VALUE '0'.\n               88  FLG-CASH-CREDIT-LIMIT-BLANK     VALUE 'B'.\n           10  WS-EDIT-CURR-BAL                    PIC  X(1).\n               88  FLG-CURR-BAL-ISVALID            VALUE LOW-VALUES.\n               88  FLG-CURR-BAL-NOT-OK             VALUE '0'.\n               88  FLG-CURR-BAL-BLANK              VALUE 'B'.\n           10  WS-EDIT-CURR-CYC-CREDIT             PIC  X(1).\n               88  FLG-CURR-CYC-CREDIT-ISVALID     VALUE LOW-VALUES.\n               88  FLG-CURR-CYC-CREDIT-NOT-OK      VALUE '0'.\n               88  FLG-CURR-CYC-CREDIT-BLANK       VALUE 'B'.\n           10  WS-EDIT-CURR-CYC-DEBIT              PIC  X(1).\n               88  FLG-CURR-CYC-DEBIT-ISVALID      VALUE LOW-VALUES.\n               88  FLG-CURR-CYC-DEBIT-NOT-OK       VALUE '0'.\n               88  FLG-CURR-CYC-DEBIT-BLANK        VALUE 'B'.\n           10 WS-EDIT-DT-OF-BIRTH-FLGS.\n               88 WS-EDIT-DT-OF-BIRTH-INVALID      VALUE '000'.\n               88 WS-EDIT-DT-OF-BIRTH-ISVALID      VALUE LOW-VALUES.\n               20 WS-EDIT-DT-OF-BIRTH-YEAR-FLG     PIC X(01).\n                  88 FLG-DT-OF-BIRTH-YEAR-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-YEAR-NOT-OK   VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-YEAR-BLANK    VALUE 'B'.\n               20 WS-EDIT-DT-OF-BIRTH-MONTH        PIC X(01).\n                  88 FLG-DT-OF-BIRTH-MONTH-ISVALID VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-MONTH-NOT-OK  VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-MONTH-BLANK   VALUE 'B'.\n               20 WS-EDIT-DT-OF-BIRTH-DAY          PIC X(01).\n                  88 FLG-DT-OF-BIRTH-DAY-ISVALID   VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-DAY-NOT-OK    VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-DAY-BLANK     VALUE 'B'.\n           10  WS-EDIT-FICO-SCORE-FLGS             PIC  X(1).\n               88  FLG-FICO-SCORE-ISVALID          VALUE LOW-VALUES.\n               88  FLG-FICO-SCORE-NOT-OK           VALUE '0'.\n               88  FLG-FICO-SCORE-BLANK            VALUE 'B'.\n           10 WS-EDIT-OPEN-DATE-FLGS.\n               88 WS-EDIT-OPEN-DATE-IS-INVALID     VALUE '000'.\n               20 WS-EDIT-OPEN-YEAR-FLG            PIC X(01).\n                  88 FLG-OPEN-YEAR-ISVALID         VALUE LOW-VALUES.\n                  88 FLG-OPEN-YEAR-NOT-OK          VALUE '0'.\n                  88 FLG-OPEN-YEAR-BLANK           VALUE 'B'.\n               20 WS-EDIT-OPEN-MONTH               PIC X(01).\n                  88 FLG-OPEN-MONTH-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-OPEN-MONTH-NOT-OK         VALUE '0'.\n                  88 FLG-OPEN-MONTH-BLANK          VALUE 'B'.\n               20 WS-EDIT-OPEN-DAY                 PIC X(01).\n                  88 FLG-OPEN-DAY-ISVALID          VALUE LOW-VALUES.\n                  88 FLG-OPEN-DAY-NOT-OK           VALUE '0'.\n                  88 FLG-OPEN-DAY-BLANK            VALUE 'B'.\n           10 WS-EXPIRY-DATE-FLGS.\n               88 WS-EDIT-EXPIRY-IS-INVALID        VALUE '000'.\n               20 WS-EDIT-EXPIRY-YEAR-FLG          PIC X(01).\n                  88 FLG-EXPIRY-YEAR-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-YEAR-NOT-OK        VALUE '0'.\n                  88 FLG-EXPIRY-YEAR-BLANK         VALUE 'B'.\n               20 WS-EDIT-EXPIRY-MONTH             PIC X(01).\n                  88 FLG-EXPIRY-MONTH-ISVALID      VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-MONTH-NOT-OK       VALUE '0'.\n                  88 FLG-EXPIRY-MONTH-BLANK        VALUE 'B'.\n               20 WS-EDIT-EXPIRY-DAY               PIC X(01).\n                  88 FLG-EXPIRY-DAY-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-DAY-NOT-OK         VALUE '0'.\n                  88 FLG-EXPIRY-DAY-BLANK          VALUE 'B'.\n           10 WS-EDIT-REISSUE-DATE-FLGS.\n               88 WS-EDIT-REISSUE-DATE-INVALID     VALUE '000'.\n               20 WS-EDIT-REISSUE-YEAR-FLG         PIC X(01).\n                  88 FLG-REISSUE-YEAR-ISVALID      VALUE LOW-VALUES.\n                  88 FLG-REISSUE-YEAR-NOT-OK       VALUE '0'.\n                  88 FLG-REISSUE-YEAR-BLANK        VALUE 'B'.\n               20 WS-EDIT-REISSUE-MONTH            PIC X(01).\n                  88 FLG-REISSUE-MONTH-ISVALID     VALUE LOW-VALUES.\n                  88 FLG-REISSUE-MONTH-NOT-OK      VALUE '0'.\n                  88 FLG-REISSUE-MONTH-BLANK       VALUE 'B'.\n               20 WS-EDIT-REISSUE-DAY              PIC X(01).\n                  88 FLG-REISSUE-DAY-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-REISSUE-DAY-NOT-OK        VALUE '0'.\n                  88 FLG-REISSUE-DAY-BLANK         VALUE 'B'.\n           10 WS-EDIT-NAME-FLAGS.\n               20 WS-EDIT-FIRST-NAME-FLGS          PIC X(01).\n                  88 FLG-FIRST-NAME-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-FIRST-NAME-NOT-OK         VALUE '0'.\n                  88 FLG-FIRST-NAME-BLANK          VALUE 'B'.\n               20 WS-EDIT-MIDDLE-NAME-FLGS         PIC X(01).\n                  88 FLG-MIDDLE-NAME-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-MIDDLE-NAME-NOT-OK        VALUE '0'.\n                  88 FLG-MIDDLE-NAME-BLANK         VALUE 'B'.\n               20 WS-EDIT-LAST-NAME-FLGS           PIC X(01).\n                  88 FLG-LAST-NAME-ISVALID         VALUE LOW-VALUES.\n                  88 FLG-LAST-NAME-NOT-OK          VALUE '0'.\n                  88 FLG-LAST-NAME-BLANK           VALUE 'B'.\n           10 WS-EDIT-ADDRESS-FLAGS.\n               20 WS-EDIT-ADDRESS-LINE-1-FLGS      PIC X(01).\n                  88 FLG-ADDRESS-LINE-1-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-ADDRESS-LINE-1-NOT-OK     VALUE '0'.\n                  88 FLG-ADDRESS-LINE-1-BLANK      VALUE 'B'.\n               20 WS-EDIT-ADDRESS-LINE-2-FLGS      PIC X(01).\n                  88 FLG-ADDRESS-LINE-2-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-ADDRESS-LINE-2-NOT-OK     VALUE '0'.\n                  88 FLG-ADDRESS-LINE-2-BLANK      VALUE 'B'.\n               20 WS-EDIT-CITY-FLGS                PIC X(01).\n                  88 FLG-CITY-ISVALID              VALUE LOW-VALUES.\n                  88 FLG-CITY-NOT-OK               VALUE '0'.\n                  88 FLG-CITY-BLANK                VALUE 'B'.\n               20 WS-EDIT-STATE-FLGS               PIC X(01).\n                  88 FLG-STATE-ISVALID             VALUE LOW-VALUES.\n                  88 FLG-STATE-NOT-OK              VALUE '0'.\n                  88 FLG-STATE-BLANK               VALUE 'B'.\n               20 WS-EDIT-ZIPCODE-FLGS             PIC X(01).\n                  88 FLG-ZIPCODE-ISVALID           VALUE LOW-VALUES.\n                  88 FLG-ZIPCODE-NOT-OK            VALUE '0'.\n                  88 FLG-ZIPCODE-BLANK             VALUE 'B'.\n               20 WS-EDIT-COUNTRY-FLGS             PIC X(01).\n                  88 FLG-COUNTRY-ISVALID           VALUE LOW-VALUES.\n                  88 FLG-COUNTRY-NOT-OK            VALUE '0'.\n                  88 FLG-COUNTRY-BLANK             VALUE 'B'.\n               20 WS-EDIT-PHONE-NUM-1-FLGS.\n                  88 WS-EDIT-PHONE-NUM-1-IS-INVALID\n                                                   VALUE '000'.\n                  30 WS-EDIT-PHONE-NUM-1A-FLG      PIC X(01).\n                     88 FLG-PHONE-NUM-1A-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1A-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1A-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-1B          PIC X(01).\n                     88 FLG-PHONE-NUM-1B-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1B-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1B-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-1C          PIC X(01).\n                     88 FLG-PHONE-NUM-1C-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1C-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1C-BLANK     VALUE 'B'.\n               20 WS-EDIT-PHONE-NUM-2-FLGS.\n                  88 WS-EDIT-PHONE-NUM-2-IS-INVALID\n                                                   VALUE '000'.\n                  30 WS-EDIT-PHONE-NUM-2A-FLG      PIC X(01).\n                     88 FLG-PHONE-NUM-2A-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2A-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2A-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-2B          PIC X(01).\n                     88 FLG-PHONE-NUM-2B-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2B-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2B-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-2C          PIC X(01).\n                     88 FLG-PHONE-NUM-2C-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2C-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2C-BLANK     VALUE 'B'.\n           10  WS-EFT-ACCOUNT-ID-FLGS              PIC X(01).\n               88 FLG-EFT-ACCOUNT-ID-ISVALID       VALUE LOW-VALUES.\n               88 FLG-EFT-ACCOUNT-ID-NOT-OK        VALUE '0'.\n               88 FLG-EFT-ACCOUNT-ID-BLANK         VALUE 'B'.\n           10  WS-EDIT-PRI-CARDHOLDER              PIC  X(1).\n               88  FLG-PRI-CARDHOLDER-ISVALID      VALUES 'Y', 'N'.\n               88  FLG-PRI-CARDHOLDER-NOT-OK       VALUE '0'.\n               88  FLG-PRI-CARDHOLDER-BLANK        VALUE 'B'.\n\n      ******************************************************************\n      * Output edits\n      ******************************************************************\n         05 CICS-OUTPUT-EDIT-VARS.\n           10  CUST-ACCT-ID-X                      PIC X(11).\n           10  CUST-ACCT-ID-N REDEFINES CUST-ACCT-ID-X\n                                                   PIC 9(11).\n           10  WS-EDIT-DATE-X                      PIC X(10).\n           10  FILLER REDEFINES WS-EDIT-DATE-X.\n               20 WS-EDIT-DATE-X-YEAR              PIC X(4).\n               20 FILLER                           PIC X(1).\n               20 WS-EDIT-DATE-MONTH               PIC X(2).\n               20 FILLER                           PIC X(1).\n               20 WS-EDIT-DATE-DAY                 PIC X(2).\n           10  WS-EDIT-DATE-X REDEFINES\n               WS-EDIT-DATE-X                      PIC 9(10).\n           10  WS-EDIT-CURRENCY-9-2                PIC X(15).\n           10  WS-EDIT-CURRENCY-9-2-F              PIC +ZZZ,ZZZ,ZZZ.99.\n\n      ******************************************************************\n      *      File and data Handling\n      ******************************************************************\n         05 WS-XREF-RID.\n           10  WS-CARD-RID-CARDNUM                 PIC X(16).\n           10  WS-CARD-RID-CUST-ID                 PIC 9(09).\n           10  WS-CARD-RID-CUST-ID-X REDEFINES\n                  WS-CARD-RID-CUST-ID              PIC X(09).\n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).\n           10  WS-CARD-RID-ACCT-ID-X REDEFINES\n                  WS-CARD-RID-ACCT-ID              PIC X(11).\n         05  WS-FILE-READ-FLAGS.\n           10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).\n              88 FOUND-ACCT-IN-MASTER              VALUE '1'.\n           10 WS-CUST-MASTER-READ-FLAG             PIC X(1).\n              88 FOUND-CUST-IN-MASTER              VALUE '1'.\n         05  WS-FILE-ERROR-MESSAGE.\n           10  FILLER                         PIC X(12)\n                                                   VALUE 'File Error: '.\n           10  ERROR-OPNAME                        PIC X(8)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(4)\n                                                   VALUE ' on '.\n           10  ERROR-FILE                          PIC X(9)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(15)\n                                                   VALUE\n                                                   ' returned RESP '.\n           10  ERROR-RESP                          PIC X(10)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(7)\n                                                   VALUE ',RESP2 '.\n           10  ERROR-RESP2                         PIC X(10)\n                                                   VALUE SPACES.\n          10  FILLER                               PIC X(5)\n                                                   VALUE SPACES.\n      *  Alpha variables for editing numerics\n      *\n          05 ALPHA-VARS-FOR-DATA-EDITING.\n             15 ACUP-NEW-CREDIT-LIMIT-X            PIC X(15).\n             15 ACUP-NEW-CASH-CREDIT-LIMIT-X       PIC X(15).\n             15 ACUP-NEW-CURR-BAL-X                PIC X(15).\n             15 ACUP-NEW-CURR-CYC-CREDIT-X         PIC X(15).\n             15 ACUP-NEW-CURR-CYC-DEBIT-X          PIC X(15).\n\n          05 ACCT-UPDATE-RECORD.\n      *****************************************************************\n      *    Data-structure for  account entity (RECLN 300)\n      *****************************************************************\n               15  ACCT-UPDATE-ID                      PIC 9(11).\n               15  ACCT-UPDATE-ACTIVE-STATUS           PIC X(01).\n               15  ACCT-UPDATE-CURR-BAL                PIC S9(10)V99.\n               15  ACCT-UPDATE-CREDIT-LIMIT            PIC S9(10)V99.\n               15  ACCT-UPDATE-CASH-CREDIT-LIMIT       PIC S9(10)V99.\n               15  ACCT-UPDATE-OPEN-DATE               PIC X(10).\n               15  ACCT-UPDATE-EXPIRAION-DATE          PIC X(10).\n               15  ACCT-UPDATE-REISSUE-DATE            PIC X(10).\n               15  ACCT-UPDATE-CURR-CYC-CREDIT         PIC S9(10)V99.\n               15  ACCT-UPDATE-CURR-CYC-DEBIT          PIC S9(10)V99.\n               15  ACCT-UPDATE-GROUP-ID                PIC X(10).\n               15  FILLER                              PIC X(188).\n          05 CUST-UPDATE-RECORD.\n      *****************************************************************\n      *    Data-structure for  CUSTOMER entity (RECLN 300)\n      *****************************************************************\n               15  CUST-UPDATE-ID                      PIC 9(09).\n               15  CUST-UPDATE-FIRST-NAME              PIC X(25).\n               15  CUST-UPDATE-MIDDLE-NAME             PIC X(25).\n               15  CUST-UPDATE-LAST-NAME               PIC X(25).\n               15  CUST-UPDATE-ADDR-LINE-1             PIC X(50).\n               15  CUST-UPDATE-ADDR-LINE-2             PIC X(50).\n               15  CUST-UPDATE-ADDR-LINE-3             PIC X(50).\n               15  CUST-UPDATE-ADDR-STATE-CD           PIC X(02).\n               15  CUST-UPDATE-ADDR-COUNTRY-CD         PIC X(03).\n               15  CUST-UPDATE-ADDR-ZIP                PIC X(10).\n               15  CUST-UPDATE-PHONE-NUM-1             PIC X(15).\n               15  CUST-UPDATE-PHONE-NUM-2             PIC X(15).\n               15  CUST-UPDATE-SSN                     PIC 9(09).\n               15  CUST-UPDATE-GOVT-ISSUED-ID          PIC X(20).\n               15  CUST-UPDATE-DOB-YYYY-MM-DD          PIC X(10).\n               15  CUST-UPDATE-EFT-ACCOUNT-ID          PIC X(10).\n               15  CUST-UPDATE-PRI-CARD-IND            PIC X(01).\n               15  CUST-UPDATE-FICO-CREDIT-SCORE       PIC 9(03).\n               15  FILLER                              PIC X(168).\n\n\n      ******************************************************************\n      *      Output Message Construction\n      ******************************************************************\n         05  WS-LONG-MSG                           PIC X(500).\n         05  WS-INFO-MSG                           PIC X(40).\n           88  WS-NO-INFO-MESSAGE                 VALUES\n                                                  SPACES LOW-VALUES.\n           88  FOUND-ACCOUNT-DATA             VALUE\n               'Details of selected account shown above'.\n           88  PROMPT-FOR-SEARCH-KEYS              VALUE\n               'Enter or update id of account to update'.\n           88  PROMPT-FOR-CHANGES                  VALUE\n               'Update account details presented above.'.\n           88  PROMPT-FOR-CONFIRMATION             VALUE\n               'Changes validated.Press F5 to save'.\n           88  CONFIRM-UPDATE-SUCCESS              VALUE\n               'Changes committed to database'.\n           88  INFORM-FAILURE                      VALUE\n               'Changes unsuccessful. Please try again'.\n\n         05  WS-RETURN-MSG                         PIC X(75).\n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.\n           88  WS-EXIT-MESSAGE                     VALUE\n               'PF03 pressed.Exiting              '.\n           88  WS-PROMPT-FOR-ACCT                  VALUE\n               'Account number not provided'.\n           88  WS-PROMPT-FOR-LASTNAME              VALUE\n               'Last name not provided'.\n           88  WS-NAME-MUST-BE-ALPHA               VALUE\n               'Name can only contain alphabets and spaces'.\n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE\n               'No input received'.\n           88  NO-CHANGES-DETECTED                 VALUE\n               'No change detected with respect to values fetched.'.\n           88  SEARCHED-ACCT-ZEROES                VALUE\n               'Account number must be a non zero 11 digit number'.\n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE\n               'Account number must be a non zero 11 digit number'.\n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE\n               'Did not find this account in account card xref file'.\n           88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE\n               'Did not find this account in account master file'.\n           88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE\n               'Did not find associated customer in master file'.\n           88  ACCT-STATUS-MUST-BE-YES-NO          VALUE\n               'Account Active Status must be Y or N'.\n           88  CRED-LIMIT-IS-BLANK                 VALUE\n               'Credit Limit must be supplied'.\n           88  CRED-LIMIT-IS-NOT-VALID             VALUE\n               'Credit Limit is not valid'.\n           88  THIS-MONTH-NOT-VALID                VALUE\n               'Card expiry month must be between 1 and 12'.\n           88  THIS-YEAR-NOT-VALID                 VALUE\n               'Invalid card expiry year'.\n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE\n               'Did not find this account in cards database'.\n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE\n               'Did not find cards for this search condition'.\n           88  COULD-NOT-LOCK-ACCT-FOR-UPDATE      VALUE\n               'Could not lock account record for update'.\n           88  COULD-NOT-LOCK-CUST-FOR-UPDATE      VALUE\n               'Could not lock customer record for update'.\n           88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE\n               'Record changed by some one else. Please review'.\n           88  LOCKED-BUT-UPDATE-FAILED            VALUE\n               'Update of record failed'.\n           88  XREF-READ-ERROR                     VALUE\n               'Error reading Card Data File'.\n           88  CODING-TO-BE-DONE                   VALUE\n               'Looks Good.... so far'.\n      ******************************************************************\n      *      Literals and Constants\n      ******************************************************************\n       01 WS-LITERALS.\n          05 LIT-THISPGM                           PIC X(8)\n                                                   VALUE 'COACTUPC'.\n          05 LIT-THISTRANID                        PIC X(4)\n                                                   VALUE 'CAUP'.\n          05 LIT-THISMAPSET                        PIC X(8)\n                                                   VALUE 'COACTUP '.\n          05 LIT-THISMAP                           PIC X(7)\n                                                   VALUE 'CACTUPA'.\n          05 LIT-CARDUPDATE-PGM                    PIC X(8)\n                                                   VALUE 'COCRDUPC'.\n          05 LIT-CARDUPDATE-TRANID                 PIC X(4)\n                                                   VALUE 'CCUP'.\n          05 LIT-CARDUPDATE-MAPSET                 PIC X(8)\n                                                   VALUE 'COCRDUP '.\n          05 LIT-CARDUPDATE-MAP                    PIC X(7)\n                                                   VALUE 'CCRDUPA'.\n          05 LIT-CCLISTPGM                         PIC X(8)\n                                                   VALUE 'COCRDLIC'.\n          05 LIT-CCLISTTRANID                      PIC X(4)\n                                                   VALUE 'CCLI'.\n          05 LIT-CCLISTMAPSET                      PIC X(7)\n                                                   VALUE 'COCRDLI'.\n          05 LIT-CCLISTMAP                         PIC X(7)\n                                                   VALUE 'CCRDSLA'.\n          05 LIT-MENUPGM                           PIC X(8)\n                                                   VALUE 'COMEN01C'.\n          05 LIT-MENUTRANID                        PIC X(4)\n                                                   VALUE 'CM00'.\n          05 LIT-MENUMAPSET                        PIC X(7)\n                                                   VALUE 'COMEN01'.\n          05 LIT-MENUMAP                           PIC X(7)\n                                                   VALUE 'COMEN1A'.\n          05 LIT-CARDDTLPGM                        PIC X(8)\n                                                   VALUE 'COCRDSLC'.\n          05 LIT-CARDDTLTRANID                     PIC X(4)\n                                                   VALUE 'CCDL'.\n          05 LIT-CARDDTLMAPSET                     PIC X(7)\n                                                   VALUE 'COCRDSL'.\n          05 LIT-CARDDTLMAP                        PIC X(7)\n                                                   VALUE 'CCRDSLA'.\n          05 LIT-ACCTFILENAME                      PIC X(8)\n                                                   VALUE 'ACCTDAT '.\n          05 LIT-CUSTFILENAME                      PIC X(8)\n                                                   VALUE 'CUSTDAT '.\n          05 LIT-CARDFILENAME                      PIC X(8)\n                                                   VALUE 'CARDDAT '.\n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)\n                                                   VALUE 'CARDAIX '.\n          05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)\n                                                   VALUE 'CXACAIX '.\n      ******************************************************************\n      * Literals for use in INSPECT statements\n      ******************************************************************\n          05 LIT-ALL-ALPHANUM-FROM-X.\n             10 LIT-ALL-ALPHA-FROM-X.\n                15 LIT-UPPER                       PIC X(26)\n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.\n                15 LIT-LOWER                       PIC X(26)\n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.\n             10 LIT-NUMBERS                        PIC X(10)\n                                 VALUE '0123456789'.             \n      ******************************************************************\n      *Other common working storage Variables\n      ******************************************************************\n       COPY CVCRD01Y.\n      ******************************************************************\n      *Lookups\n      ******************************************************************\n      *North America Phone Area codes\n       COPY CSLKPCDY.\n\n      ******************************************************************\n      * Variables for use in INSPECT statements\n      ******************************************************************\n       01  LIT-ALL-ALPHA-FROM     PIC X(52) VALUE SPACES.\n       01  LIT-ALL-ALPHANUM-FROM  PIC X(62) VALUE SPACES.\n       01  LIT-ALL-NUM-FROM       PIC X(10) VALUE SPACES.\n       77  LIT-ALPHA-SPACES-TO    PIC X(52) VALUE SPACES.\n       77  LIT-ALPHANUM-SPACES-TO PIC X(62) VALUE SPACES.\n       77  LIT-NUM-SPACES-TO      PIC X(10) VALUE SPACES.\n\n      *IBM SUPPLIED COPYBOOKS\n       COPY DFHBMSCA.\n       COPY DFHAID.\n\n      *COMMON COPYBOOKS\n      *Screen Titles\n       COPY COTTL01Y.\n\n      *Account Update Screen Layout\n       COPY COACTUP.\n\n      *Current Date\n       COPY CSDAT01Y.\n\n      *Common Messages\n       COPY CSMSG01Y.\n\n      *Abend Variables\n       COPY CSMSG02Y.\n\n      *Signed on user data\n       COPY CSUSR01Y.\n\n      *Dataset layouts\n\n      *ACCT RECORD LAYOUT\n       COPY CVACT01Y.\n\n      *CARD XREF LAYOUT\n       COPY CVACT03Y.\n\n      *CUSTOMER LAYOUT\n       COPY CVCUS01Y.\n\n      ******************************************************************\n      *Application Commmarea Copybook\n       COPY COCOM01Y.\n\n       01 WS-THIS-PROGCOMMAREA.\n          05 ACCT-UPDATE-SCREEN-DATA.\n             10 ACUP-CHANGE-ACTION                     PIC X(1)\n                                                       VALUE LOW-VALUES.\n                88 ACUP-DETAILS-NOT-FETCHED            VALUES\n                                                       LOW-VALUES,\n                                                       SPACES.\n                88 ACUP-SHOW-DETAILS                   VALUE 'S'.\n                88 ACUP-CHANGES-MADE                   VALUES 'E', 'N'\n                                                            , 'C', 'L'\n                                                            , 'F'.\n                88 ACUP-CHANGES-NOT-OK                 VALUE 'E'.\n                88 ACUP-CHANGES-OK-NOT-CONFIRMED       VALUE 'N'.\n                88 ACUP-CHANGES-OKAYED-AND-DONE        VALUE 'C'.\n                88 ACUP-CHANGES-FAILED                 VALUES 'L', 'F'.\n                88 ACUP-CHANGES-OKAYED-LOCK-ERROR      VALUE 'L'.\n                88 ACUP-CHANGES-OKAYED-BUT-FAILED      VALUE 'F'.\n          05 ACUP-OLD-DETAILS.\n             10 ACUP-OLD-ACCT-DATA.\n                15  ACUP-OLD-ACCT-ID-X                 PIC X(11).\n                15  ACUP-OLD-ACCT-ID                   REDEFINES\n                    ACUP-OLD-ACCT-ID-X                 PIC 9(11).\n                15  ACUP-OLD-ACTIVE-STATUS             PIC X(01).\n                15  ACUP-OLD-CURR-BAL                  PIC X(12).\n                15  ACUP-OLD-CURR-BAL-N REDEFINES\n                    ACUP-OLD-CURR-BAL                  PIC S9(10)V99.\n                15  ACUP-OLD-CREDIT-LIMIT              PIC X(12).\n                15  ACUP-OLD-CREDIT-LIMIT-N            REDEFINES\n                    ACUP-OLD-CREDIT-LIMIT              PIC S9(10)V99.\n                15  ACUP-OLD-CASH-CREDIT-LIMIT         PIC X(12).\n                15  ACUP-OLD-CASH-CREDIT-LIMIT-N       REDEFINES\n                    ACUP-OLD-CASH-CREDIT-LIMIT         PIC S9(10)V99.\n                15  ACUP-OLD-OPEN-DATE                 PIC X(08).\n                15  ACUP-OLD-OPEN-DATE-PARTS           REDEFINES\n                    ACUP-OLD-OPEN-DATE.\n                    20 ACUP-OLD-OPEN-YEAR              PIC X(4).\n                    20 ACUP-OLD-OPEN-MON               PIC X(2).\n                    20 ACUP-OLD-OPEN-DAY               PIC X(2).\n                15  ACUP-OLD-EXPIRAION-DATE            PIC X(08).\n                15  ACUP-OLD-EXPIRAION-DATE-PARTS      REDEFINES\n                    ACUP-OLD-EXPIRAION-DATE.\n                    20 ACUP-OLD-EXP-YEAR                PIC X(4).\n                    20 ACUP-OLD-EXP-MON                 PIC X(2).\n                    20 ACUP-OLD-EXP-DAY                 PIC X(2).\n                15  ACUP-OLD-REISSUE-DATE              PIC X(08).\n                15  ACUP-OLD-REISSUE-DATE-PARTS        REDEFINES\n                    ACUP-OLD-REISSUE-DATE.\n                    20 ACUP-OLD-REISSUE-YEAR           PIC X(4).\n                    20 ACUP-OLD-REISSUE-MON            PIC X(2).\n                    20 ACUP-OLD-REISSUE-DAY            PIC X(2).\n                15  ACUP-OLD-CURR-CYC-CREDIT           PIC X(12).\n                15  ACUP-OLD-CURR-CYC-CREDIT-N         REDEFINES\n                    ACUP-OLD-CURR-CYC-CREDIT           PIC S9(10)V99.\n                15  ACUP-OLD-CURR-CYC-DEBIT            PIC X(12).\n                15  ACUP-OLD-CURR-CYC-DEBIT-N          REDEFINES\n                    ACUP-OLD-CURR-CYC-DEBIT            PIC S9(10)V99.\n                15  ACUP-OLD-GROUP-ID                  PIC X(10).\n             10 ACUP-OLD-CUST-DATA.\n                15  ACUP-OLD-CUST-ID-X                 PIC X(09).\n                15  ACUP-OLD-CUST-ID                   REDEFINES\n                    ACUP-OLD-CUST-ID-X                 PIC 9(09).\n                15  ACUP-OLD-CUST-FIRST-NAME           PIC X(25).\n                15  ACUP-OLD-CUST-MIDDLE-NAME          PIC X(25).\n                15  ACUP-OLD-CUST-LAST-NAME            PIC X(25).\n                15  ACUP-OLD-CUST-ADDR-LINE-1          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-LINE-2          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-LINE-3          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-STATE-CD        PIC X(02).\n                15  ACUP-OLD-CUST-ADDR-COUNTRY-CD      PIC X(03).\n                15  ACUP-OLD-CUST-ADDR-ZIP             PIC X(10).\n                15  ACUP-OLD-CUST-PHONE-NUM-1          PIC X(15).\n                15  ACUP-OLD-CUST-PHONE-NUM-1-X REDEFINES\n                    ACUP-OLD-CUST-PHONE-NUM-1.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-OLD-CUST-PHONE-NUM-2          PIC X(15).\n                15  ACUP-OLD-CUST-PHONE-NUM-2-X REDEFINES\n                    ACUP-OLD-CUST-PHONE-NUM-2.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-OLD-CUST-SSN-X                PIC X(09).\n                15  ACUP-OLD-CUST-SSN                  REDEFINES\n                    ACUP-OLD-CUST-SSN-X                PIC 9(09).\n                15  ACUP-OLD-CUST-GOVT-ISSUED-ID       PIC X(20).\n                15  ACUP-OLD-CUST-DOB-YYYY-MM-DD       PIC X(08).\n                15  ACUP-OLD-CUST-DOB-PARTS            REDEFINES\n                    ACUP-OLD-CUST-DOB-YYYY-MM-DD.\n                    20 ACUP-OLD-CUST-DOB-YEAR          PIC X(4).\n                    20 ACUP-OLD-CUST-DOB-MON           PIC X(2).\n                    20 ACUP-OLD-CUST-DOB-DAY           PIC X(2).\n                15  ACUP-OLD-CUST-EFT-ACCOUNT-ID       PIC X(10).\n                15  ACUP-OLD-CUST-PRI-HOLDER-IND       PIC X(01).\n                15  ACUP-OLD-CUST-FICO-SCORE-X         PIC X(03).\n                15  ACUP-OLD-CUST-FICO-SCORE           REDEFINES\n                    ACUP-OLD-CUST-FICO-SCORE-X         PIC 9(03).\n          05 ACUP-NEW-DETAILS.\n             10 ACUP-NEW-ACCT-DATA.\n                15  ACUP-NEW-ACCT-ID-X                 PIC X(11).\n                15  ACUP-NEW-ACCT-ID                   REDEFINES\n                    ACUP-NEW-ACCT-ID-X                 PIC 9(11).\n                15  ACUP-NEW-ACTIVE-STATUS             PIC X(01).\n                15  ACUP-NEW-CURR-BAL                  PIC X(12).\n                15  ACUP-NEW-CURR-BAL-N                REDEFINES\n                    ACUP-NEW-CURR-BAL                  PIC S9(10)V99.\n                15  ACUP-NEW-CREDIT-LIMIT              PIC X(12).\n                15  ACUP-NEW-CREDIT-LIMIT-N            REDEFINES\n                    ACUP-NEW-CREDIT-LIMIT              PIC S9(10)V99.\n                15  ACUP-NEW-CASH-CREDIT-LIMIT         PIC X(12).\n                15  ACUP-NEW-CASH-CREDIT-LIMIT-N       REDEFINES\n                    ACUP-NEW-CASH-CREDIT-LIMIT         PIC S9(10)V99.\n                15  ACUP-NEW-OPEN-DATE                 PIC X(08).\n                15  ACUP-NEW-OPEN-DATE-PARTS           REDEFINES\n                    ACUP-NEW-OPEN-DATE.\n                    20 ACUP-NEW-OPEN-YEAR              PIC X(4).\n                    20 ACUP-NEW-OPEN-MON               PIC X(2).\n                    20 ACUP-NEW-OPEN-DAY               PIC X(2).\n                15  ACUP-NEW-EXPIRAION-DATE            PIC X(08).\n                15  ACUP-NEW-EXPIRAION-DATE-PARTS      REDEFINES\n                    ACUP-NEW-EXPIRAION-DATE.\n                    20 ACUP-NEW-EXP-YEAR                PIC X(4).\n                    20 ACUP-NEW-EXP-MON                 PIC X(2).\n                    20 ACUP-NEW-EXP-DAY                 PIC X(2).\n                15  ACUP-NEW-REISSUE-DATE              PIC X(08).\n                15  ACUP-NEW-REISSUE-DATE-PARTS        REDEFINES\n                    ACUP-NEW-REISSUE-DATE.\n                    20 ACUP-NEW-REISSUE-YEAR           PIC X(4).\n                    20 ACUP-NEW-REISSUE-MON            PIC X(2).\n                    20 ACUP-NEW-REISSUE-DAY            PIC X(2).\n                15  ACUP-NEW-CURR-CYC-CREDIT           PIC X(12).\n                15  ACUP-NEW-CURR-CYC-CREDIT-N         REDEFINES\n                    ACUP-NEW-CURR-CYC-CREDIT           PIC S9(10)V99.\n                15  ACUP-NEW-CURR-CYC-DEBIT            PIC X(12).\n                15  ACUP-NEW-CURR-CYC-DEBIT-N          REDEFINES\n                    ACUP-NEW-CURR-CYC-DEBIT            PIC S9(10)V99.\n                15  ACUP-NEW-GROUP-ID                  PIC X(10).\n             10 ACUP-NEW-CUST-DATA.\n                15  ACUP-NEW-CUST-ID-X                 PIC X(09).\n                15  ACUP-NEW-CUST-ID                   REDEFINES\n                    ACUP-NEW-CUST-ID-X                 PIC 9(09).\n                15  ACUP-NEW-CUST-FIRST-NAME           PIC X(25).\n                15  ACUP-NEW-CUST-MIDDLE-NAME          PIC X(25).\n                15  ACUP-NEW-CUST-LAST-NAME            PIC X(25).\n                15  ACUP-NEW-CUST-ADDR-LINE-1          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-LINE-2          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-LINE-3          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-STATE-CD        PIC X(02).\n                15  ACUP-NEW-CUST-ADDR-COUNTRY-CD      PIC X(03).\n                15  ACUP-NEW-CUST-ADDR-ZIP             PIC X(10).\n                15  ACUP-NEW-CUST-PHONE-NUM-1          PIC X(15).\n                15  ACUP-NEW-CUST-PHONE-NUM-1-X REDEFINES\n                    ACUP-NEW-CUST-PHONE-NUM-1.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-NEW-CUST-PHONE-NUM-2          PIC X(15).\n                15  ACUP-NEW-CUST-PHONE-NUM-2-X REDEFINES\n                    ACUP-NEW-CUST-PHONE-NUM-2.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-NEW-CUST-SSN-X.\n                    20 ACUP-NEW-CUST-SSN-1             PIC X(03).\n                    20 ACUP-NEW-CUST-SSN-2             PIC X(02).\n                    20 ACUP-NEW-CUST-SSN-3             PIC X(04).\n                15  ACUP-NEW-CUST-SSN                  REDEFINES\n                    ACUP-NEW-CUST-SSN-X                PIC 9(09).\n                15  ACUP-NEW-CUST-GOVT-ISSUED-ID       PIC X(20).\n                15  ACUP-NEW-CUST-DOB-YYYY-MM-DD       PIC X(08).\n                15  ACUP-NEW-CUST-DOB-PARTS            REDEFINES\n                    ACUP-NEW-CUST-DOB-YYYY-MM-DD.\n                    20 ACUP-NEW-CUST-DOB-YEAR          PIC X(4).\n                    20 ACUP-NEW-CUST-DOB-MON           PIC X(2).\n                    20 ACUP-NEW-CUST-DOB-DAY           PIC X(2).\n                15  ACUP-NEW-CUST-EFT-ACCOUNT-ID       PIC X(10).\n                15  ACUP-NEW-CUST-PRI-HOLDER-IND       PIC X(01).\n                15  ACUP-NEW-CUST-FICO-SCORE-X         PIC X(03).\n                15  ACUP-NEW-CUST-FICO-SCORE           REDEFINES\n                    ACUP-NEW-CUST-FICO-SCORE-X         PIC 9(03).\n                    88 FICO-RANGE-IS-VALID             VALUES 300\n                                                       THROUGH 850.\n       01  WS-COMMAREA                                 PIC X(2000).\n\n\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  FILLER                                PIC X(1)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN."
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-MAIN",
            "code": "EXEC CICS HANDLE ABEND\n                     LABEL(ABEND-ROUTINE)\n           END-EXEC\n\n           INITIALIZE CC-WORK-AREA\n                      WS-MISC-STORAGE\n                      WS-COMMAREA\n      *****************************************************************\n      * Store our context\n      *****************************************************************\n           MOVE LIT-THISTRANID       TO WS-TRANID\n      *****************************************************************\n      * Ensure error message is cleared                               *\n      *****************************************************************\n           SET WS-RETURN-MSG-OFF  TO TRUE\n      *****************************************************************\n      * Store passed data if  any                *\n      *****************************************************************\n           IF EIBCALEN IS EQUAL TO 0\n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA\n              SET CDEMO-PGM-ENTER TO TRUE\n              SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO\n                                CARDDEMO-COMMAREA\n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO\n                                WS-THIS-PROGCOMMAREA\n           END-IF\n      *****************************************************************\n      * Remap PFkeys as needed.\n      * Store the Mapped PF Key\n      *****************************************************************\n           PERFORM YYYY-STORE-PFKEY\n              THRU YYYY-STORE-PFKEY-EXIT\n      *****************************************************************\n      * Check the AID to see if its valid at this point               *\n      * F3 - Exit\n      * Enter show screen again\n      *****************************************************************\n           SET PFK-INVALID TO TRUE\n           IF CCARD-AID-ENTER OR\n              CCARD-AID-PFK03 OR\n              (CCARD-AID-PFK05 AND ACUP-CHANGES-OK-NOT-CONFIRMED)\n                              OR\n              (CCARD-AID-PFK12 AND NOT ACUP-DETAILS-NOT-FETCHED)\n              SET PFK-VALID TO TRUE\n           END-IF\n\n           IF PFK-INVALID\n              SET CCARD-AID-ENTER TO TRUE\n           END-IF\n\n      *****************************************************************\n      * Decide what to do based on inputs received\n      *****************************************************************\n           EVALUATE TRUE\n      ******************************************************************\n      *       USER PRESSES PF03 TO EXIT\n      *  OR   USER IS DONE WITH UPDATE\n      *            XCTL TO CALLING PROGRAM OR MAIN MENU\n      ******************************************************************\n              WHEN CCARD-AID-PFK03\n                   SET CCARD-AID-PFK03     TO TRUE\n\n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                   OR CDEMO-FROM-TRANID    EQUAL SPACES\n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID\n                   ELSE\n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID\n                   END-IF\n\n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES\n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES\n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM\n                   ELSE\n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM\n                   END-IF\n\n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID\n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM\n\n                   SET  CDEMO-USRTYP-USER  TO TRUE\n                   SET  CDEMO-PGM-ENTER    TO TRUE\n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET\n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP\n\n                   EXEC CICS\n                        SYNCPOINT\n                   END-EXEC\n      *\n                   EXEC CICS XCTL\n                        PROGRAM (CDEMO-TO-PROGRAM)\n                        COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n      ******************************************************************\n      *       FRESH ENTRY INTO PROGRAM\n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n               AND CDEMO-PGM-ENTER\n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER        TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *       ACCT DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY\n      *            RESET THE SEARCH KEYS\n      *            ASK THE USER FOR FRESH SEARCH CRITERIA\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n              WHEN ACUP-CHANGES-FAILED\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                              WS-MISC-STORAGE\n                              CDEMO-ACCT-ID\n                   SET CDEMO-PGM-ENTER            TO TRUE\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER          TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED   TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *      ACCT DATA HAS BEEN PRESENTED TO USER\n      *            CHECK THE USER INPUTS\n      *            DECIDE WHAT TO DO\n      *            PRESENT NEXT STEPS TO USER\n      ******************************************************************\n              WHEN OTHER\n                   PERFORM 1000-PROCESS-INPUTS\n                      THRU 1000-PROCESS-INPUTS-EXIT\n                   PERFORM 2000-DECIDE-ACTION\n                      THRU 2000-DECIDE-ACTION-EXIT\n                   PERFORM 3000-SEND-MAP\n                      THRU 3000-SEND-MAP-EXIT\n                   GO TO COMMON-RETURN\n           END-EVALUATE\n           .",
            "description": "This paragraph serves as the main control flow for the COACTUPC program, handling the program initialization, user input processing, and navigation logic. It begins by setting up error handling and initializing work areas, then processes the communication area to maintain state between program invocations. The paragraph validates function key inputs and contains a central EVALUATE statement that directs program flow based on the current transaction state and user actions. Key functions include: handling program exit (PF3), processing initial program entry, managing the completion of account updates (both successful and failed), and orchestrating the standard processing flow through three main routines (process inputs, decide action, and send map). The code maintains transaction context throughout the process and includes proper CICS synchronization points when exiting to other programs."
          },
          {
            "name": "COMMON-RETURN",
            "code": "MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG\n\n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\n           MOVE  WS-THIS-PROGCOMMAREA TO\n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA )\n\n           EXEC CICS RETURN\n                TRANSID (LIT-THISTRANID)\n                COMMAREA (WS-COMMAREA)\n                LENGTH(LENGTH OF WS-COMMAREA)\n           END-EXEC\n           .",
            "description": "This paragraph handles the common return logic for the COACTUPC program. It first transfers any error or status message to the communication area's error message field. Then it constructs a composite communication area by combining the standard CardDemo communication area with this program's specific communication area data. Finally, it executes a CICS RETURN command that maintains the current transaction ID and passes the constructed communication area back to CICS, allowing the program to maintain state between interactions. This is a critical component for preserving transaction context in the account update process."
          },
          {
            "name": "0000-MAIN-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as a standard exit point for the program or a section within COACTUPC. It provides a clean termination point that can be referenced by PERFORM statements throughout the program when processing needs to return to the calling routine."
          },
          {
            "name": "1000-PROCESS-INPUTS",
            "code": "PERFORM 1100-RECEIVE-MAP\n              THRU 1100-RECEIVE-MAP-EXIT\n           PERFORM 1200-EDIT-MAP-INPUTS\n              THRU 1200-EDIT-MAP-INPUTS-EXIT\n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG\n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG\n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP\n           .\n      *",
            "description": "This paragraph handles the initial processing of user inputs in the account update workflow. It first receives data from the user interface by calling the 1100-RECEIVE-MAP paragraph, then validates the received data through the 1200-EDIT-MAP-INPUTS paragraph. After processing the inputs, it sets up the response by assigning any validation messages to CCARD-ERROR-MSG and configuring the application to return to the same program and map for the next interaction. This establishes the foundation for the account update process by ensuring valid data is available before proceeding with business logic operations."
          },
          {
            "name": "1000-PROCESS-INPUTS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 1000-PROCESS-INPUTS section of the COACTUPC program. It provides a clean termination point for the input processing logic, allowing the program to return control to the calling routine after completing the validation and processing of user inputs related to account updates."
          },
          {
            "name": "1100-RECEIVE-MAP",
            "code": "EXEC CICS RECEIVE MAP(LIT-THISMAP)\n                     MAPSET(LIT-THISMAPSET)\n                     INTO(CACTUPAI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC\n      *\n           INITIALIZE ACUP-NEW-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCTSIDI OF CACTUPAI = '*'\n           OR  ACCTSIDI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           ELSE\n               MOVE ACCTSIDI OF CACTUPAI TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n              GO TO 1100-RECEIVE-MAP-EXIT\n           END-IF\n\n      * Active Status\n           IF  ACSTTUSI OF CACTUPAI = '*'\n           OR  ACSTTUSI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-ACTIVE-STATUS\n           ELSE\n               MOVE ACSTTUSI OF CACTUPAI TO ACUP-NEW-ACTIVE-STATUS\n           END-IF\n\n      * Credit Limit\n           IF  ACRDLIMI OF CACTUPAI = '*'\n           OR  ACRDLIMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CREDIT-LIMIT-X\n           ELSE\n               MOVE ACRDLIMI OF CACTUPAI TO ACUP-NEW-CREDIT-LIMIT-X\n               IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CREDIT-LIMIT-X) = 0\n                  COMPUTE ACUP-NEW-CREDIT-LIMIT-N =\n                     FUNCTION NUMVAL-C(ACRDLIMI OF CACTUPAI)\n               ELSE\n                  CONTINUE\n               END-IF\n           END-IF\n\n      * Cash Limit\n           IF  ACSHLIMI OF CACTUPAI = '*'\n           OR  ACSHLIMI OF CACTUPAI = SPACES\n             MOVE LOW-VALUES           TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n           ELSE\n             MOVE ACSHLIMI OF CACTUPAI TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n             IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CASH-CREDIT-LIMIT-X) = 0\n                COMPUTE ACUP-NEW-CASH-CREDIT-LIMIT-N =\n                     FUNCTION NUMVAL-C(ACSHLIMI OF CACTUPAI)\n             ELSE\n                CONTINUE\n             END-IF\n           END-IF\n\n      * Current Balance\n           IF  ACURBALI OF CACTUPAI = '*'\n           OR  ACURBALI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-BAL-X\n           ELSE\n               MOVE ACURBALI OF CACTUPAI TO ACUP-NEW-CURR-BAL-X\n               IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-BAL-X) = 0\n                   COMPUTE ACUP-NEW-CURR-BAL-N =\n                     FUNCTION NUMVAL-C(ACUP-NEW-CURR-BAL-X)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Credit\n           IF  ACRCYCRI OF CACTUPAI = '*'\n           OR  ACRCYCRI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-CREDIT-X\n           ELSE\n               MOVE ACRCYCRI OF CACTUPAI TO ACUP-NEW-CURR-CYC-CREDIT-X\n               IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-CREDIT-X) = 0\n                   COMPUTE ACUP-NEW-CURR-CYC-CREDIT-N =\n                     FUNCTION NUMVAL-C(ACRCYCRI OF CACTUPAI)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Debit\n           IF  ACRCYDBI OF CACTUPAI = '*'\n           OR  ACRCYDBI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-DEBIT-X\n           ELSE\n               MOVE ACRCYDBI OF CACTUPAI TO ACUP-NEW-CURR-CYC-DEBIT-X\n               IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-DEBIT-X) = 0\n                   COMPUTE ACUP-NEW-CURR-CYC-DEBIT-N =\n                     FUNCTION NUMVAL-C(ACRCYDBI OF CACTUPAI)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Open date\n      *\n           IF  OPNYEARI OF CACTUPAI = '*'\n           OR  OPNYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-YEAR\n           ELSE\n               MOVE OPNYEARI OF CACTUPAI TO ACUP-NEW-OPEN-YEAR\n           END-IF\n\n           IF  OPNMONI OF CACTUPAI = '*'\n           OR  OPNMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-MON\n           ELSE\n               MOVE OPNMONI OF CACTUPAI TO  ACUP-NEW-OPEN-MON\n           END-IF\n\n           IF  OPNDAYI OF CACTUPAI = '*'\n           OR  OPNDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-DAY\n           ELSE\n               MOVE OPNDAYI OF CACTUPAI TO  ACUP-NEW-OPEN-DAY\n           END-IF\n\n      *Expiry date\n      *\n           IF  EXPYEARI OF CACTUPAI = '*'\n           OR  EXPYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-YEAR\n           ELSE\n               MOVE EXPYEARI OF CACTUPAI TO ACUP-NEW-EXP-YEAR\n           END-IF\n\n           IF  EXPMONI OF CACTUPAI = '*'\n           OR  EXPMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-MON\n           ELSE\n               MOVE EXPMONI OF CACTUPAI TO  ACUP-NEW-EXP-MON\n           END-IF\n\n           IF  EXPDAYI OF CACTUPAI = '*'\n           OR  EXPDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-DAY\n           ELSE\n               MOVE EXPDAYI OF CACTUPAI TO  ACUP-NEW-EXP-DAY\n           END-IF\n\n      *Reissue date\n      *\n           IF  RISYEARI OF CACTUPAI = '*'\n           OR  RISYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-YEAR\n           ELSE\n               MOVE RISYEARI OF CACTUPAI TO ACUP-NEW-REISSUE-YEAR\n           END-IF\n\n           IF  RISMONI OF CACTUPAI = '*'\n           OR  RISMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-MON\n           ELSE\n               MOVE RISMONI OF CACTUPAI TO  ACUP-NEW-REISSUE-MON\n           END-IF\n\n           IF  RISDAYI OF CACTUPAI = '*'\n           OR  RISDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-DAY\n           ELSE\n               MOVE RISDAYI OF CACTUPAI TO  ACUP-NEW-REISSUE-DAY\n           END-IF\n\n      *Account Group\n      *\n           IF  AADDGRPI OF CACTUPAI = '*'\n           OR  AADDGRPI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-GROUP-ID\n           ELSE\n               MOVE AADDGRPI OF CACTUPAI TO ACUP-NEW-GROUP-ID\n           END-IF\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n      *\n           IF  ACSTNUMI OF CACTUPAI = '*'\n           OR  ACSTNUMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ID-X\n           ELSE\n               MOVE ACSTNUMI OF CACTUPAI TO ACUP-NEW-CUST-ID-X\n           END-IF\n\n      *Social Security Number\n      *\n           IF  ACTSSN1I OF CACTUPAI = '*'\n           OR  ACTSSN1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-1\n           ELSE\n               MOVE ACTSSN1I OF CACTUPAI TO ACUP-NEW-CUST-SSN-1\n           END-IF\n\n           IF  ACTSSN2I OF CACTUPAI = '*'\n           OR  ACTSSN2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-2\n           ELSE\n               MOVE ACTSSN2I OF CACTUPAI TO ACUP-NEW-CUST-SSN-2\n           END-IF\n\n           IF  ACTSSN3I OF CACTUPAI = '*'\n           OR  ACTSSN3I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-3\n           ELSE\n               MOVE ACTSSN3I OF CACTUPAI TO ACUP-NEW-CUST-SSN-3\n           END-IF\n      *\n      *Date of birth\n      *\n           IF  DOBYEARI OF CACTUPAI = '*'\n           OR  DOBYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-YEAR\n           ELSE\n               MOVE DOBYEARI OF CACTUPAI TO ACUP-NEW-CUST-DOB-YEAR\n           END-IF\n\n           IF  DOBMONI OF CACTUPAI = '*'\n           OR  DOBMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-MON\n           ELSE\n               MOVE DOBMONI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-MON\n           END-IF\n\n           IF  DOBDAYI OF CACTUPAI = '*'\n           OR  DOBDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-DAY\n           ELSE\n               MOVE DOBDAYI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-DAY\n           END-IF\n      *\n      *FICO\n      *\n           IF  ACSTFCOI OF CACTUPAI = '*'\n           OR  ACSTFCOI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FICO-SCORE-X\n           ELSE\n               MOVE ACSTFCOI OF CACTUPAI TO ACUP-NEW-CUST-FICO-SCORE-X\n           END-IF\n      *\n      *First Name\n      *\n           IF  ACSFNAMI OF CACTUPAI = '*'\n           OR  ACSFNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FIRST-NAME\n           ELSE\n               MOVE ACSFNAMI OF CACTUPAI TO ACUP-NEW-CUST-FIRST-NAME\n           END-IF\n      *\n      *Middle Name\n      *\n           IF  ACSMNAMI OF CACTUPAI = '*'\n           OR  ACSMNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-MIDDLE-NAME\n           ELSE\n               MOVE ACSMNAMI OF CACTUPAI TO ACUP-NEW-CUST-MIDDLE-NAME\n           END-IF\n      *\n      *Last Name\n      *\n           IF  ACSLNAMI OF CACTUPAI = '*'\n           OR  ACSLNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-LAST-NAME\n           ELSE\n               MOVE ACSLNAMI OF CACTUPAI TO ACUP-NEW-CUST-LAST-NAME\n           END-IF\n      *\n      *Address\n      *\n           IF  ACSADL1I OF CACTUPAI = '*'\n           OR  ACSADL1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-1\n           ELSE\n               MOVE ACSADL1I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-1\n           END-IF\n\n           IF  ACSADL2I OF CACTUPAI = '*'\n           OR  ACSADL2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-2\n           ELSE\n               MOVE ACSADL2I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-2\n           END-IF\n\n           IF  ACSCITYI OF CACTUPAI = '*'\n           OR  ACSCITYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-3\n           ELSE\n               MOVE ACSCITYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-3\n           END-IF\n\n           IF  ACSSTTEI OF CACTUPAI = '*'\n           OR  ACSSTTEI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-STATE-CD\n           ELSE\n               MOVE ACSSTTEI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-STATE-CD\n           END-IF\n\n           IF  ACSCTRYI OF CACTUPAI = '*'\n           OR  ACSCTRYI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           ELSE\n              MOVE ACSCTRYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           END-IF\n\n           IF  ACSZIPCI OF CACTUPAI = '*'\n           OR  ACSZIPCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-ZIP\n           ELSE\n               MOVE ACSZIPCI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-ZIP\n           END-IF\n\n           IF  ACSPH1AI OF CACTUPAI = '*'\n           OR  ACSPH1AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1A\n           ELSE\n               MOVE ACSPH1AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1A\n           END-IF\n\n           IF  ACSPH1BI OF CACTUPAI = '*'\n           OR  ACSPH1BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1B\n           ELSE\n               MOVE ACSPH1BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1B\n           END-IF\n\n           IF  ACSPH1CI OF CACTUPAI = '*'\n           OR  ACSPH1CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1C\n           ELSE\n               MOVE ACSPH1CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1C\n           END-IF\n\n           IF  ACSPH2AI OF CACTUPAI = '*'\n           OR  ACSPH2AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2A\n           ELSE\n               MOVE ACSPH2AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2A\n           END-IF\n\n           IF  ACSPH2BI OF CACTUPAI = '*'\n           OR  ACSPH2BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2B\n           ELSE\n               MOVE ACSPH2BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2B\n           END-IF\n\n           IF  ACSPH2CI OF CACTUPAI = '*'\n           OR  ACSPH2CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2C\n           ELSE\n               MOVE ACSPH2CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2C\n           END-IF\n      *\n      *Government Id\n      *\n           IF  ACSGOVTI OF CACTUPAI = '*'\n           OR  ACSGOVTI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           ELSE\n               MOVE ACSGOVTI OF CACTUPAI TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           END-IF\n      *\n      *EFT Code\n      *\n           IF  ACSEFTCI OF CACTUPAI = '*'\n           OR  ACSEFTCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           ELSE\n               MOVE ACSEFTCI OF CACTUPAI TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           END-IF\n      *\n      *Primary Holder Indicator\n      *\n           IF  ACSPFLGI OF CACTUPAI = '*'\n           OR  ACSPFLGI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES            TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           ELSE\n              MOVE ACSPFLGI OF CACTUPAI  TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           END-IF\n           .",
            "description": "This paragraph handles the reception and processing of user input from a CICS map in the account update program. It first receives data from the screen into the CACTUPAI structure, then initializes the ACUP-NEW-DETAILS work area before systematically processing each input field. The paragraph performs extensive data validation and conversion for various account and customer fields.\n\nFor each input field, the code checks if it contains asterisks or spaces (indicating no entry) and either sets the corresponding field to LOW-VALUES or captures the entered value. For numeric fields like credit limits and balances, it uses the FUNCTION TEST-NUMVAL-C and FUNCTION NUMVAL-C to validate and convert string inputs to numeric values.\n\nThe paragraph processes multiple categories of data including account information (status, limits, balances), date fields (open, expiry, reissue dates), and customer details (personal information, address, contact numbers). Each field is carefully handled with appropriate data type validation to ensure data integrity before proceeding with account updates."
          },
          {
            "name": "1100-RECEIVE-MAP-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 1100-RECEIVE-MAP routine in the COACTUPC program. It provides a clean termination point for the routine that handles receiving user input from the account update interface. The paragraph contains only the EXIT statement followed by a period, marking the end of the logical processing block."
          },
          {
            "name": "1200-EDIT-MAP-INPUTS",
            "code": "SET INPUT-OK                  TO TRUE\n\n           IF  ACUP-DETAILS-NOT-FETCHED\n      *        VALIDATE THE SEARCH KEYS\n               PERFORM 1210-EDIT-ACCOUNT\n                  THRU 1210-EDIT-ACCOUNT-EXIT\n\n               MOVE LOW-VALUES           TO ACUP-OLD-ACCT-DATA\n\n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS FLAG THEM\n              IF  FLG-ACCTFILTER-BLANK\n                  SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE\n              END-IF\n\n      *       AT THIS STAGE. NO DETAILS FETCHED. NOTHING MORE TO EDIT.\n              GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n      *\n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED\n           SET FOUND-ACCOUNT-DATA        TO TRUE\n           SET FOUND-ACCT-IN-MASTER      TO TRUE\n           SET FLG-ACCTFILTER-ISVALID    TO TRUE\n\n           SET FOUND-CUST-IN-MASTER      TO TRUE\n           SET FLG-CUSTFILTER-ISVALID    TO TRUE\n\n      *\n           PERFORM 1205-COMPARE-OLD-NEW\n              THRU 1205-COMPARE-OLD-NEW-EXIT\n\n           IF  NO-CHANGES-FOUND\n           OR  ACUP-CHANGES-OK-NOT-CONFIRMED\n           OR  ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE LOW-VALUES           TO WS-NON-KEY-FLAGS\n               GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           END-IF\n\n           SET ACUP-CHANGES-NOT-OK       TO TRUE\n\n           MOVE 'Account Status'          TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-ACTIVE-STATUS    TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO            TO WS-EDIT-ACCT-STATUS\n\n           MOVE 'Open Date'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-OPEN-DATE       TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-OPEN-DATE-FLGS\n\n           MOVE 'Credit Limit'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CREDIT-LIMIT-X  TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT  TO WS-EDIT-CREDIT-LIMIT\n\n           MOVE 'Expiry Date'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-EXPIRAION-DATE  TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EXPIRY-DATE-FLGS\n\n           MOVE 'Cash Credit Limit'      TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT TO WS-EDIT-CASH-CREDIT-LIMIT\n\n           MOVE 'Reissue Date'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-REISSUE-DATE    TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-REISSUE-DATE-FLGS\n\n           MOVE 'Current Balance'        TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-BAL-X      TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-BAL\n\n           MOVE 'Current Cycle Credit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-CREDIT\n\n           MOVE 'Current Cycle Debit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-DEBIT\n\n           MOVE 'SSN'                    TO WS-EDIT-VARIABLE-NAME\n           PERFORM 1265-EDIT-US-SSN\n              THRU 1265-EDIT-US-SSN-EXIT\n\n           MOVE 'Date of Birth'          TO WS-EDIT-VARIABLE-NAME\n           MOVE   ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                         TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-DT-OF-BIRTH-FLGS\n           IF WS-EDIT-DT-OF-BIRTH-ISVALID\n              PERFORM  EDIT-DATE-OF-BIRTH\n                 THRU  EDIT-DATE-OF-BIRTH-EXIT\n              MOVE WS-EDIT-DATE-FLGS    TO WS-EDIT-DT-OF-BIRTH-FLGS\n           END-IF\n\n           MOVE 'FICO Score'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-FICO-SCORE-FLGS\n           IF FLG-FICO-SCORE-ISVALID\n              PERFORM  1275-EDIT-FICO-SCORE\n                 THRU  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n      ******************************************************************\n      *    Edit names\n      ******************************************************************\n           MOVE 'First Name'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FIRST-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-FIRST-NAME-FLGS\n\n           MOVE 'Middle Name'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1235-EDIT-ALPHA-OPT\n              THRU 1235-EDIT-ALPHA-OPT-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-MIDDLE-NAME-FLGS\n\n           MOVE 'Last Name'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-LAST-NAME  TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                        TO WS-EDIT-LAST-NAME-FLGS\n\n           MOVE 'Address Line 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1215-EDIT-MANDATORY\n              THRU 1215-EDIT-MANDATORY-EXIT\n           MOVE WS-EDIT-MANDATORY-FLAGS\n                                         TO WS-EDIT-ADDRESS-LINE-1-FLGS\n\n           MOVE 'State'                  TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-STATE-FLGS\n           IF FLG-ALPHA-ISVALID\n           PERFORM 1270-EDIT-US-STATE-CD\n              THRU 1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n\n\n           MOVE 'Zip'                    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-ZIP   TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 5                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-ZIPCODE-FLGS\n\n      *    Address Line 2 is optional\n      *    MOVE 'Address Line 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE 'City'                   TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-CITY-FLGS\n\n           MOVE 'Country'                TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                        TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-COUNTRY-FLGS\n\n           MOVE 'Phone Number 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO  WS-EDIT-PHONE-NUM-1-FLGS\n\n           MOVE 'Phone Number 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO WS-EDIT-PHONE-NUM-2-FLGS\n\n           MOVE 'EFT Account Id'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 10                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EFT-ACCOUNT-ID-FLGS\n\n           MOVE 'Primary Card Holder'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO           TO WS-EDIT-PRI-CARDHOLDER\n\n      *    Cross field edits begin here\n           IF  FLG-STATE-ISVALID\n           AND FLG-ZIPCODE-ISVALID\n               PERFORM 1280-EDIT-US-STATE-ZIP-CD\n                  THRU 1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n\n           IF INPUT-ERROR\n              CONTINUE\n           ELSE\n              SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n           END-IF\n           .",
            "description": "This paragraph handles the validation of user inputs for account and customer information updates. It first checks if account details have been fetched - if not, it validates only the search keys and exits. When account data has already been retrieved, it compares old and new values to detect changes.\n\nIf changes are found and not yet confirmed, the paragraph performs extensive field-level validation on all modified fields using specialized validation routines for different data types. The validation includes:\n\n- Account status (Y/N format)\n- Dates (open date, expiry date, reissue date, date of birth)\n- Currency amounts (credit limits, balances) with signed decimal validation\n- Personal information (SSN, FICO score)\n- Name fields with required/optional alpha validation\n- Address components (with special validation for US state codes)\n- ZIP code numeric validation\n- Phone numbers with US format validation\n- EFT account ID\n- Primary cardholder indicator\n\nThe paragraph also performs cross-field validation between state and ZIP code when both are valid. If any validation errors are found, the input is marked as having errors; otherwise, the changes are marked as valid but not yet confirmed, requiring user confirmation before proceeding with updates."
          },
          {
            "name": "1200-EDIT-MAP-INPUTS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 1200-EDIT-MAP-INPUTS section of the COACTUPC program. It provides a clean termination point for the input validation logic, allowing the program to return control to the calling section after completing the validation of user-entered account and customer information."
          },
          {
            "name": "1205-COMPARE-OLD-NEW",
            "code": "SET NO-CHANGES-FOUND           TO TRUE\n\n           IF  ACUP-NEW-ACCT-ID-X         = ACUP-OLD-ACCT-ID-X\n           AND FUNCTION UPPER-CASE (\n               ACUP-NEW-ACTIVE-STATUS)    =\n               FUNCTION UPPER-CASE (\n               ACUP-OLD-ACTIVE-STATUS)\n           AND ACUP-NEW-CURR-BAL          = ACUP-OLD-CURR-BAL\n           AND ACUP-NEW-CREDIT-LIMIT      = ACUP-OLD-CREDIT-LIMIT\n           AND ACUP-NEW-CASH-CREDIT-LIMIT = ACUP-OLD-CASH-CREDIT-LIMIT\n           AND ACUP-NEW-OPEN-DATE         = ACUP-OLD-OPEN-DATE\n           AND ACUP-NEW-EXPIRAION-DATE    = ACUP-OLD-EXPIRAION-DATE\n           AND ACUP-NEW-REISSUE-DATE      = ACUP-OLD-REISSUE-DATE\n           AND ACUP-NEW-CURR-CYC-CREDIT   = ACUP-OLD-CURR-CYC-CREDIT\n           AND ACUP-NEW-CURR-CYC-DEBIT    = ACUP-OLD-CURR-CYC-DEBIT\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-GROUP-ID))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-GROUP-ID))\n               CONTINUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n\n           IF  FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ID-X))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ID-X))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-FIRST-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-FIRST-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-MIDDLE-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-MIDDLE-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-LAST-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-LAST-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-1))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-1))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-2))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-2))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-3))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-3))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-STATE-CD))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-STATE-CD))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-COUNTRY-CD))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-COUNTRY-CD))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-ZIP))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-ZIP))\n           AND ACUP-NEW-CUST-PHONE-NUM-1A = ACUP-OLD-CUST-PHONE-NUM-1A\n           AND ACUP-NEW-CUST-PHONE-NUM-1B = ACUP-OLD-CUST-PHONE-NUM-1B\n           AND ACUP-NEW-CUST-PHONE-NUM-1C = ACUP-OLD-CUST-PHONE-NUM-1C\n           AND ACUP-NEW-CUST-PHONE-NUM-2A = ACUP-OLD-CUST-PHONE-NUM-2A\n           AND ACUP-NEW-CUST-PHONE-NUM-2B = ACUP-OLD-CUST-PHONE-NUM-2B\n           AND ACUP-NEW-CUST-PHONE-NUM-2C = ACUP-OLD-CUST-PHONE-NUM-2C\n           AND ACUP-NEW-CUST-SSN-X       = ACUP-OLD-CUST-SSN-X\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-GOVT-ISSUED-ID ))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-GOVT-ISSUED-ID))\n           AND ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                     = ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           AND ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                     = ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-PRI-HOLDER-IND))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-PRI-HOLDER-IND))\n           AND ACUP-NEW-CUST-FICO-SCORE-X\n                                     = ACUP-OLD-CUST-FICO-SCORE-X\n               SET NO-CHANGES-DETECTED   TO TRUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n           .",
            "description": "This paragraph compares the original account and customer data with the newly entered values to determine if any changes have been made. It performs an exhaustive field-by-field comparison between the old and new values, using FUNCTION UPPER-CASE and FUNCTION TRIM to ensure case-insensitive and whitespace-normalized comparisons for text fields. The comparison covers all account details (account ID, status, balances, credit limits, dates, cycle information) and customer information (personal details, address, phone numbers, SSN, government ID, date of birth, EFT account, primary holder indicator, and FICO score). If any field differs between the old and new values, the CHANGE-HAS-OCCURRED flag is set to TRUE and processing exits the paragraph. If all fields match, NO-CHANGES-DETECTED is set to TRUE, preventing unnecessary database updates."
          },
          {
            "name": "1205-COMPARE-OLD-NEW-EXIT",
            "code": "EXIT\n           .\n\n\n      *",
            "description": "This paragraph serves as an exit point for the COMPARE-OLD-NEW routine in the account update process. It's a simple exit paragraph that marks the end of the comparison logic between old and new account/customer data values, allowing the program to return control to the calling routine."
          },
          {
            "name": "1210-EDIT-ACCOUNT",
            "code": "SET FLG-ACCTFILTER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF CC-ACCT-ID   EQUAL LOW-VALUES\n           OR CC-ACCT-ID   EQUAL SPACES\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ACCTFILTER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 SET WS-PROMPT-FOR-ACCT TO TRUE\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n                                           ACUP-NEW-ACCT-ID\n              GO TO  1210-EDIT-ACCOUNT-EXIT\n           END-IF\n\n      *    Not numeric\n      *    Not 11 characters\n           MOVE CC-ACCT-ID              TO ACUP-NEW-ACCT-ID\n           IF CC-ACCT-ID   IS NOT NUMERIC\n           OR CC-ACCT-ID-N EQUAL ZEROS\n              SET INPUT-ERROR TO TRUE\n              IF WS-RETURN-MSG-OFF\n                STRING\n                 'Account Number if supplied must be a 11 digit'\n                 ' Non-Zero Number'\n                DELIMITED BY SIZE\n                INTO WS-RETURN-MSG\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n              GO TO 1210-EDIT-ACCOUNT-EXIT\n           ELSE\n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID\n              SET FLG-ACCTFILTER-ISVALID TO TRUE\n           END-IF\n           .",
            "description": "This paragraph validates the account ID input field (CC-ACCT-ID) during the account update process. It performs several validation checks:\n\n1. First, it checks if the account ID is empty or blank. If so, it sets appropriate error flags, prompts the user for an account number if messaging is enabled, and exits the validation routine.\n\n2. If an account ID is provided, it checks whether the value is numeric and non-zero. If the validation fails, it sets an error flag and generates a specific error message explaining that the account number must be an 11-digit non-zero number.\n\n3. When the account ID passes all validation checks, it copies the value to CDEMO-ACCT-ID and sets a flag indicating the account filter is valid.\n\nThe paragraph handles data validation while providing appropriate user feedback, ensuring only valid account numbers proceed to further processing."
          },
          {
            "name": "1210-EDIT-ACCOUNT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the account editing process in the COACTUPC program. It provides a structured way to terminate the account validation and editing logic, allowing the program flow to return to the calling routine after account data has been processed and validated."
          },
          {
            "name": "1215-EDIT-MANDATORY",
            "code": "*    Initialize\n           SET FLG-MANDATORY-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR          TO TRUE\n              SET FLG-MANDATORY-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1215-EDIT-MANDATORY-EXIT\n           END-IF\n\n           SET FLG-MANDATORY-ISVALID   TO TRUE\n           .",
            "description": "This paragraph validates mandatory fields in the account update process. It checks if the input field (stored in WS-EDIT-ALPHANUM-ONLY) is empty, contains only spaces, or has zero length after trimming. If the field is empty, it sets error flags (INPUT-ERROR and FLG-MANDATORY-BLANK) and constructs an error message indicating that the field must be supplied, using the field name stored in WS-EDIT-VARIABLE-NAME. If the field contains valid data, it sets the FLG-MANDATORY-ISVALID flag. This validation ensures that required information is provided before proceeding with account updates."
          },
          {
            "name": "1215-EDIT-MANDATORY-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the mandatory field validation routine in the account update process. It marks the end of the validation logic for required fields, allowing the program to return control to the calling section after completing the validation checks."
          },
          {
            "name": "1220-EDIT-YESNO",
            "code": "*    Must be Y or N\n      *    SET FLG-YES-NO-NOT-OK         TO TRUE\n      *\n      *    Not supplied\n           IF WS-EDIT-YES-NO             EQUAL LOW-VALUES\n           OR WS-EDIT-YES-NO             EQUAL SPACES\n           OR WS-EDIT-YES-NO             EQUAL ZEROS\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-YES-NO-BLANK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n\n\n           IF FLG-YES-NO-ISVALID\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-YES-NO-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be Y or N.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n           .",
            "description": "This paragraph validates a Yes/No input field. It first checks if the input is empty (spaces, low-values, or zeros) and sets an error flag with an appropriate message if the field is required but not supplied. If the input is provided, it then verifies that the value is valid (presumably checking elsewhere if it's 'Y' or 'N') and sets an error flag with a message if the value is invalid. The validation uses a flag system to track error states and constructs user-friendly error messages that include the name of the field being validated. The paragraph is designed to be reusable across different Yes/No fields in the program by using a variable field name in the error messages."
          },
          {
            "name": "1220-EDIT-YESNO-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the EDIT-YESNO routine in the account update process. It provides a standard return point when the yes/no validation is complete, allowing the program to continue with its normal flow after validating user confirmation responses."
          },
          {
            "name": "1225-EDIT-ALPHA-REQD",
            "code": "*    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHA-BLANK            TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X   TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .",
            "description": "This paragraph validates required alphabetic input fields. It first checks if the field is empty or contains only spaces, setting an error flag and generating a message that the field must be supplied if empty. If the field has content, it then verifies that only alphabetic characters and spaces are present by using character conversion and checking if any non-alphabetic characters remain. If invalid characters are found, it sets an error flag and generates a message indicating that only alphabets are allowed. The paragraph uses function TRIM and LENGTH to properly handle spaces in the validation process, and sets appropriate status flags to indicate the validation result for use by the calling routine."
          },
          {
            "name": "1225-EDIT-ALPHA-REQD-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the EDIT-ALPHA-REQD routine in the account update process. It provides a standard control flow mechanism to return to the calling routine after completing the validation of required alphabetic fields."
          },
          {
            "name": "1230-EDIT-ALPHANUM-REQD",
            "code": "*    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets,numbers and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .",
            "description": "This paragraph validates required alphanumeric input fields. It first checks if the field is empty (contains spaces, low-values, or has zero length after trimming), and if so, sets an error flag and creates an error message indicating the field must be supplied. If the field is not empty, it then validates that the field contains only alphabetic characters, numbers, and spaces by using a character conversion technique that replaces valid characters with spaces and then checks if anything remains after trimming. If invalid characters are found, it sets an error flag and creates an appropriate error message. The paragraph uses several flags to track the validation state and supports conditional message generation based on the WS-RETURN-MSG-OFF flag. When validation passes, it sets the FLG-ALPHNANUM-ISVALID flag to TRUE."
          },
          {
            "name": "1230-EDIT-ALPHANUM-REQD-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the EDIT-ALPHANUM-REQD routine in the account update process. It marks the end of the alphanumeric field validation logic that requires user input, allowing the program to return to the calling routine after validation is complete."
          },
          {
            "name": "1235-EDIT-ALPHA-OPT",
            "code": "*    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET FLG-ALPHA-ISVALID          TO TRUE\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X    TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .",
            "description": "This paragraph validates that an input field contains only alphabetic characters or is empty. It first checks if the field is empty or contains only spaces, in which case it's considered valid. If the field has content, it performs a character conversion that replaces all alphabetic characters with spaces, then checks if anything remains after trimming. If non-alphabetic characters are detected, it sets an error flag and generates an appropriate error message. The validation is optional, as indicated by the \"OPT\" in the paragraph name, allowing empty values to pass validation. The result of the validation is stored in flags that can be checked by the calling routine."
          },
          {
            "name": "1235-EDIT-ALPHA-OPT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as a simple exit point for the EDIT-ALPHA-OPT routine in the account update process. It provides a clean termination point for the alpha field validation logic, allowing the program to return control to the calling routine after completing optional alpha field validation."
          },
          {
            "name": "1240-EDIT-ALPHANUM-OPT",
            "code": "*    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied, but ok as optional\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n              SET FLG-ALPHNANUM-ISVALID     TO TRUE\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .",
            "description": "This paragraph validates an optional alphanumeric input field. It first checks if the field is empty (contains spaces, low-values, or trims to zero length), in which case it's considered valid since the field is optional. If the field contains data, it performs validation by converting all valid alphanumeric characters to spaces and then checking if anything remains after trimming. If non-alphanumeric characters are found, it sets an error flag and generates an appropriate error message indicating that only numbers and alphabets are allowed. The validation result is stored in a flag variable that can be checked by the calling routine."
          },
          {
            "name": "1240-EDIT-ALPHANUM-OPT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the EDIT-ALPHANUM-OPT routine in the account update process. It provides a structured way to return control to the calling routine after optional alphanumeric field validation has been completed."
          },
          {
            "name": "1245-EDIT-NUM-REQD",
            "code": "*    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Only all numeric allowed\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                  IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be all numeric.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Must not be zero\n\n           IF FUNCTION NUMVAL(WS-EDIT-ALPHANUM-ONLY(1:\n                              WS-EDIT-ALPHANUM-LENGTH)) = 0\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must not be zero.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .",
            "description": "This paragraph performs validation for required numeric input fields. It checks that the input field is not empty, contains only numeric characters, and is not zero. If any validation fails, it sets appropriate error flags and constructs a specific error message that includes the name of the field being validated. The validation process first checks for blank/empty values, then verifies the input contains only numeric characters, and finally ensures the numeric value is not zero. When validation passes, it sets a flag indicating the input is valid. The error messages are only generated if the message buffer is available (WS-RETURN-MSG-OFF condition)."
          },
          {
            "name": "1245-EDIT-NUM-REQD-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the numeric field validation routine in the account update process. It marks the end of the validation logic for required numeric fields, allowing the program to return to the calling routine after completing the validation checks."
          },
          {
            "name": "1250-EDIT-SIGNED-9V2",
            "code": "SET FLG-SIGNED-NUMBER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL LOW-VALUES\n           OR WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-SIGNED-NUMBER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF FUNCTION TEST-NUMVAL-C(WS-EDIT-SIGNED-NUMBER-9V2-X) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-SIGNED-NUMBER-NOT-OK   TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' is not valid'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n\n           END-IF\n\n      *    If we got here all edits were cleared\n           SET FLG-SIGNED-NUMBER-ISVALID  TO TRUE\n           .",
            "description": "This paragraph validates a signed numeric field with 2 decimal places. It first checks if the field is empty (spaces or low-values), setting appropriate error flags and generating a message that the field must be supplied if empty. If the field contains data, it uses the FUNCTION TEST-NUMVAL-C intrinsic function to verify the value is a valid numeric value. When validation fails, it sets error flags and generates an appropriate error message. If all validations pass, it sets a flag indicating the signed number is valid. The paragraph uses a parameter-driven approach where the field name is passed in WS-EDIT-VARIABLE-NAME to create context-specific error messages."
          },
          {
            "name": "1250-EDIT-SIGNED-9V2-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 1250-EDIT-SIGNED-9V2 validation routine. It marks the end of the validation logic for signed numeric fields with two decimal places, allowing the program to return to the calling section after processing is complete."
          },
          {
            "name": "1260-EDIT-US-PHONE-NUM",
            "code": "*    The database stores date in X(15) format (999)999-9999\n      *                                             1234567890123\n      *    So we take the X(15) input into WS-EDIT-US-PHONE-NUM\n      *    and edit it\n\n           SET WS-EDIT-US-PHONE-IS-INVALID TO TRUE\n      *    Not mandatory to enter a phone number\n           IF  (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES)\n                SET WS-EDIT-US-PHONE-IS-VALID TO TRUE\n                GO TO EDIT-US-PHONE-EXIT\n           ELSE\n                CONTINUE\n           END-IF\n           .",
            "description": "This paragraph validates US phone number input by checking if the phone number fields are empty. It sets the phone number validation flag to invalid by default, then checks if all three parts of the phone number (area code, prefix, and line number) are either spaces or low-values (nulls). If all parts are empty, it marks the phone number as valid and exits the validation routine, as phone numbers are not mandatory fields. If any part contains data, the validation continues to subsequent logic not shown in this snippet. The paragraph handles the special case where no phone number is provided, treating empty phone numbers as valid input."
          },
          {
            "name": "EDIT-AREA-CODE",
            "code": "IF WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEA-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA       IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           MOVE FUNCTION TRIM (WS-EDIT-US-PHONE-NUMA)\n             TO WS-US-PHONE-AREA-CODE-TO-EDIT\n           IF VALID-GENERAL-PURP-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Not valid North America general purpose area code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           SET FLG-EDIT-US-PHONEA-ISVALID    TO TRUE\n           .",
            "description": "This paragraph validates the area code portion of a US phone number. It performs several checks: ensuring the area code is not blank, verifying it contains only numeric characters, confirming it's not zero, and validating it against a list of valid North American area codes. For each validation failure, it sets appropriate error flags and constructs a specific error message that includes the field name being validated. If all validations pass, it sets a flag indicating the area code is valid before proceeding to validate the phone number prefix. The validation logic supports the account update process by ensuring phone number data meets formatting and validity requirements before database updates occur."
          },
          {
            "name": "EDIT-US-PHONE-PREFIX",
            "code": "IF WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEB-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           SET FLG-EDIT-US-PHONEB-ISVALID    TO TRUE\n           .",
            "description": "This paragraph validates the US phone number prefix (area code) portion of a phone number. It performs three key validation checks: first ensuring the prefix is not blank or spaces, then verifying it contains only numeric characters, and finally confirming the prefix is not zero. If any validation fails, it sets appropriate error flags and constructs a specific error message that includes the field name being validated. The error message is stored in WS-RETURN-MSG if no message has been set previously (WS-RETURN-MSG-OFF condition). When validation passes, it sets a flag indicating the phone prefix is valid. Each validation check includes a conditional branch to EDIT-US-PHONE-LINENUM when errors are detected."
          },
          {
            "name": "EDIT-US-PHONE-LINENUM",
            "code": "IF WS-EDIT-US-PHONE-NUMC EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEC-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO EDIT-US-PHONE-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code must be A 4 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n\n\n           SET FLG-EDIT-US-PHONEC-ISVALID    TO TRUE\n           .",
            "description": "This paragraph validates the line number portion of a US phone number. It performs three key validation checks: first ensuring the field is not blank or empty, then verifying the value is numeric, and finally confirming the value is not zero. For each validation failure, it sets appropriate error flags and constructs a specific error message that includes the field name from WS-EDIT-VARIABLE-NAME. If all validations pass, it sets a flag indicating the phone line number is valid. The validation process terminates immediately upon encountering any error condition, with control returning to the calling routine via EDIT-US-PHONE-EXIT."
          },
          {
            "name": "EDIT-US-PHONE-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the US phone number validation routine in the account update process. It marks the end of the phone number validation logic, allowing the program to return to the calling section after completing the validation checks."
          },
          {
            "name": "1260-EDIT-US-PHONE-NUM-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the US phone number validation routine. It marks the end of the phone number validation logic, allowing the program to return to the calling process after completing the validation checks."
          },
          {
            "name": "1265-EDIT-US-SSN",
            "code": "*Format xxx-xx-xxxx\n      *Part1 :should have 3 digits\n      *Part2 :should have 2 digits and it should be from 01 to 99\n      *Part3 should have 4 digits from 0001 to 9999.\n      ******************************************************************\n      *    Edit SSN Part 1\n      ******************************************************************\n           MOVE 'SSN: First 3 chars'     TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-1      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART1-FLGS\n\n      *Part1 :should not be 000, 666, or between 900 and 999\n           IF FLG-EDIT-US-SSN-PART1-ISVALID\n              MOVE ACUP-NEW-CUST-SSN-1   TO WS-EDIT-US-SSN-PART1\n              IF INVALID-SSN-PART1\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-EDIT-US-SSN-PART1-NOT-OK\n                                 TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': should not be 000, 666, or between 900 and 999'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              ELSE\n                CONTINUE\n              END-IF\n           END-IF\n\n      ******************************************************************\n      *    Edit SSN Part 2\n      ******************************************************************\n           MOVE 'SSN 4th & 5th chars'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-2      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART2-FLGS\n\n\n      ******************************************************************\n      *    Edit SSN Part 3\n      ******************************************************************\n           MOVE 'SSN Last 4 chars'       TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-3      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 4                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART3-FLGS\n           .",
            "description": "This paragraph validates a US Social Security Number (SSN) in the format xxx-xx-xxxx by checking each part separately. It first validates that the first part contains exactly 3 numeric digits and is not an invalid value (000, 666, or 900-999). Then it validates the second part contains exactly 2 numeric digits. Finally, it validates the third part contains exactly 4 numeric digits. For each part, it sets appropriate flags to indicate validation status and generates specific error messages when validation fails. The validation leverages a common numeric validation routine (1245-EDIT-NUM-REQD) and maintains detailed status flags to track the validity of each SSN component."
          },
          {
            "name": "1265-EDIT-US-SSN-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the US Social Security Number (SSN) validation routine. It marks the end of the SSN validation logic, allowing the program to return to the calling section after completing the validation process."
          },
          {
            "name": "1270-EDIT-US-STATE-CD",
            "code": "MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO US-STATE-CODE-TO-EDIT\n           IF VALID-US-STATE-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': is not a valid state code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n           .",
            "description": "This paragraph validates the US state code entered by the user during account updates. It takes the state code from the ACUP-NEW-CUST-ADDR-STATE-CD field and checks if it's valid using the VALID-US-STATE-CODE condition (likely defined elsewhere). If the state code is valid, processing continues normally. If invalid, it sets error flags (INPUT-ERROR and FLG-STATE-NOT-OK) and constructs an error message indicating the state code is invalid, but only if message display is enabled (WS-RETURN-MSG-OFF). The error message includes the field name from WS-EDIT-VARIABLE-NAME. After validation, regardless of outcome, control passes to the paragraph exit point."
          },
          {
            "name": "1270-EDIT-US-STATE-CD-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the US state code validation routine. It marks the end of the state code validation logic, allowing the program to return to the calling process after completing the validation checks for US state codes."
          },
          {
            "name": "1275-EDIT-FICO-SCORE",
            "code": "IF FICO-RANGE-IS-VALID\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-FICO-SCORE-NOT-OK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': should be between 300 and 850'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n           .",
            "description": "This paragraph validates if a FICO credit score falls within the acceptable range (300-850). If the score is valid, processing continues. If invalid, it sets error flags (INPUT-ERROR and FLG-FICO-SCORE-NOT-OK) and constructs an appropriate error message when message display is enabled. The error message includes the field name and the valid range requirement. After validation, control passes to the paragraph exit point regardless of the outcome."
          },
          {
            "name": "1275-EDIT-FICO-SCORE-EXIT",
            "code": "EXIT\n           .\n\n      *A crude zip code edit based on data from USPS web site",
            "description": "This paragraph serves as an exit point for the FICO score validation routine in the account update process. The comment indicates that the program also includes a basic ZIP code validation mechanism based on data from the United States Postal Service website, though the actual validation logic is not shown in this snippet."
          },
          {
            "name": "1280-EDIT-US-STATE-ZIP-CD",
            "code": "STRING ACUP-NEW-CUST-ADDR-STATE-CD\n                  ACUP-NEW-CUST-ADDR-ZIP(1:2)\n             DELIMITED BY SIZE\n             INTO US-STATE-AND-FIRST-ZIP2\n\n           IF VALID-US-STATE-ZIP-CD2-COMBO\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              SET FLG-ZIPCODE-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   'Invalid zip code for state'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n           .",
            "description": "This paragraph validates the relationship between the US state code and ZIP code entered by the user. It combines the state code with the first two digits of the ZIP code into a single field and checks if this combination is valid according to US postal standards. If the combination is invalid, it sets error flags for both the state and ZIP code fields and generates an error message indicating that the ZIP code is not valid for the specified state. This validation ensures that customer address information is geographically consistent before allowing updates to proceed."
          },
          {
            "name": "1280-EDIT-US-STATE-ZIP-CD-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the US state and ZIP code validation routine. It marks the end of the validation logic for these fields, allowing the program to return to the calling section after completing the state and ZIP code validation checks."
          },
          {
            "name": "2000-DECIDE-ACTION",
            "code": "EVALUATE TRUE\n      ******************************************************************\n      *       NO DETAILS SHOWN.\n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      ******************************************************************\n      *       CHANGES MADE. BUT USER CANCELS\n      ******************************************************************\n              WHEN CCARD-AID-PFK12\n                 IF  FLG-ACCTFILTER-ISVALID\n                     SET WS-RETURN-MSG-OFF       TO TRUE\n                     PERFORM 9000-READ-ACCT\n                        THRU 9000-READ-ACCT-EXIT\n                     IF FOUND-CUST-IN-MASTER\n                        SET ACUP-SHOW-DETAILS    TO TRUE\n                     END-IF\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD\n      ******************************************************************\n              WHEN ACUP-SHOW-DETAILS\n                 IF INPUT-ERROR\n                 OR NO-CHANGES-DETECTED\n                    CONTINUE\n                 ELSE\n                    SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       BUT INPUT EDIT ERRORS FOUND\n      ******************************************************************\n              WHEN ACUP-CHANGES-NOT-OK\n                  CONTINUE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n               AND CCARD-AID-PFK05\n                 PERFORM 9600-WRITE-PROCESSING\n                    THRU 9600-WRITE-PROCESSING-EXIT\n                 EVALUATE TRUE\n                    WHEN COULD-NOT-LOCK-ACCT-FOR-UPDATE\n                         SET ACUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE\n                    WHEN LOCKED-BUT-UPDATE-FAILED\n                       SET ACUP-CHANGES-OKAYED-BUT-FAILED TO TRUE\n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE\n                        SET ACUP-SHOW-DETAILS            TO TRUE\n                    WHEN OTHER\n                       SET ACUP-CHANGES-OKAYED-AND-DONE   TO TRUE\n                 END-EVALUATE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                  CONTINUE\n      ******************************************************************\n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                  SET ACUP-SHOW-DETAILS TO TRUE\n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                  OR CDEMO-FROM-TRANID    EQUAL SPACES\n                     MOVE ZEROES       TO CDEMO-ACCT-ID\n                                          CDEMO-CARD-NUM\n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS\n                  END-IF\n              WHEN OTHER\n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT\n                   MOVE '0001'         TO ABEND-CODE\n                   MOVE SPACES         TO ABEND-REASON\n                   MOVE 'UNEXPECTED DATA SCENARIO'\n                                       TO ABEND-MSG\n                   PERFORM ABEND-ROUTINE\n                      THRU ABEND-ROUTINE-EXIT\n           END-EVALUATE\n           .",
            "description": "This paragraph handles the decision logic for different states of the account update process. It evaluates the current transaction state and user actions to determine the next processing step. The logic includes handling scenarios such as: initial data retrieval, user cancellation of changes, validation of input data, confirmation of changes, processing database updates, and handling various error conditions. The paragraph implements a state machine approach where each condition triggers appropriate actions based on the current state flag and user input. It includes error handling for unexpected scenarios, record locking issues, and update failures. The code also manages the return to previous screens or reset of the process based on transaction completion status."
          },
          {
            "name": "2000-DECIDE-ACTION-EXIT",
            "code": "EXIT\n           .",
            "description": "This is a simple exit paragraph that serves as the termination point for the 2000-DECIDE-ACTION section. It provides a clean exit point when the decision logic in that section has completed processing, allowing the program to continue with the next sequential instruction after the section call."
          },
          {
            "name": "3000-SEND-MAP",
            "code": "PERFORM 3100-SCREEN-INIT\n              THRU 3100-SCREEN-INIT-EXIT\n           PERFORM 3200-SETUP-SCREEN-VARS\n              THRU 3200-SETUP-SCREEN-VARS-EXIT\n           PERFORM 3250-SETUP-INFOMSG\n              THRU 3250-SETUP-INFOMSG-EXIT\n           PERFORM 3300-SETUP-SCREEN-ATTRS\n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT\n           PERFORM 3390-SETUP-INFOMSG-ATTRS\n              THRU 3390-SETUP-INFOMSG-ATTRS-EXIT\n           PERFORM 3400-SEND-SCREEN\n              THRU 3400-SEND-SCREEN-EXIT\n           .",
            "description": "This paragraph orchestrates the preparation and display of the account update screen. It follows a sequential process by first initializing the screen, setting up screen variables with appropriate values, preparing informational messages for the user, configuring screen attributes (such as field highlighting, protection status, and colors), setting attributes for information messages, and finally sending the completed screen to the terminal. This structured approach ensures the user interface is properly prepared with all necessary data and formatting before being presented to the user."
          },
          {
            "name": "3000-SEND-MAP-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the SEND-MAP routine in the COACTUPC program. It provides a clean termination point for the routine that handles displaying account update information to the user interface in the CICS environment."
          },
          {
            "name": "3100-SCREEN-INIT",
            "code": "MOVE LOW-VALUES TO CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01              TO TITLE01O OF CACTUPAO\n           MOVE CCDA-TITLE02              TO TITLE02O OF CACTUPAO\n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CACTUPAO\n           MOVE LIT-THISPGM               TO PGMNAMEO OF CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CACTUPAO\n\n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CACTUPAO\n\n           .",
            "description": "This paragraph initializes the account update screen by clearing the output area (CACTUPAO) and populating standard header information. It retrieves the current date and time using the FUNCTION CURRENT-DATE intrinsic function, then formats this information into display format. The paragraph sets up the screen with title information from constants, transaction and program identifiers, and properly formatted date (MM/DD/YY) and time (HH:MM:SS) values. This initialization ensures the screen displays consistent header information before any account-specific data is presented to the user."
          },
          {
            "name": "3100-SCREEN-INIT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the screen initialization process in the COACTUPC program. It's a simple exit paragraph that marks the end of the screen initialization logic, allowing the program to return control to the calling routine after completing the setup of the account update screen."
          },
          {
            "name": "3200-SETUP-SCREEN-VARS",
            "code": "*    INITIALIZE SEARCH CRITERIA\n           IF CDEMO-PGM-ENTER\n              CONTINUE\n           ELSE\n              IF CC-ACCT-ID-N = 0\n              AND FLG-ACCTFILTER-ISVALID\n                 MOVE LOW-VALUES                TO ACCTSIDO OF CACTUPAO\n              ELSE\n                 MOVE CC-ACCT-ID                TO ACCTSIDO OF CACTUPAO\n              END-IF\n\n              EVALUATE TRUE\n                WHEN ACUP-DETAILS-NOT-FETCHED\n                WHEN CC-ACCT-ID-N =  0\n                  PERFORM 3201-SHOW-INITIAL-VALUES\n                     THRU 3201-SHOW-INITIAL-VALUES-EXIT\n               WHEN ACUP-SHOW-DETAILS\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n               WHEN ACUP-CHANGES-MADE\n                  PERFORM 3203-SHOW-UPDATED-VALUES\n                     THRU 3203-SHOW-UPDATED-VALUES-EXIT\n               WHEN OTHER\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n              END-EVALUATE\n            END-IF\n           .",
            "description": "This paragraph handles the setup of screen variables for the account update interface based on the current state of the transaction. It first checks if this is an initial program entry or a subsequent interaction. For non-initial entries, it manages the account ID display field, either clearing it or populating it with the current account ID depending on validation status. The paragraph then uses an EVALUATE statement to determine which values should be displayed on the screen based on the current transaction state: showing initial default values when no details have been fetched yet, displaying the original account values when details are available, or showing updated values when changes have been made. Each state triggers a specific paragraph to populate the appropriate screen fields."
          },
          {
            "name": "3200-SETUP-SCREEN-VARS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3200-SETUP-SCREEN-VARS routine. It provides a clean termination point for the routine that prepares screen variables for display, allowing the program to return control to the calling section after screen setup operations are complete."
          },
          {
            "name": "3201-SHOW-INITIAL-VALUES",
            "code": "MOVE LOW-VALUES                     TO  ACSTTUSO OF CACTUPAO\n                                                   ACRDLIMO OF CACTUPAO\n      *Account Limits\n                                                   ACURBALO OF CACTUPAO\n                                                   ACSHLIMO OF CACTUPAO\n                                                   ACRCYCRO OF CACTUPAO\n                                                   ACRCYDBO OF CACTUPAO\n      *Account Dates\n                                                   OPNYEARO OF CACTUPAO\n                                                   OPNMONO  OF CACTUPAO\n                                                   OPNDAYO  OF CACTUPAO\n                                                   EXPYEARO OF CACTUPAO\n                                                   EXPMONO  OF CACTUPAO\n                                                   EXPDAYO  OF CACTUPAO\n                                                   RISYEARO OF CACTUPAO\n                                                   RISMONO  OF CACTUPAO\n                                                   RISDAYO  OF CACTUPAO\n                                                   AADDGRPO OF CACTUPAO\n      *Customer data\n                                                   ACSTNUMO OF CACTUPAO\n                                                   ACTSSN1O OF CACTUPAO\n                                                   ACTSSN2O OF CACTUPAO\n                                                   ACTSSN3O OF CACTUPAO\n                                                   ACSTFCOO OF CACTUPAO\n                                                   DOBYEARO OF CACTUPAO\n                                                   DOBMONO  OF CACTUPAO\n                                                   DOBDAYO  OF CACTUPAO\n                                                   ACSFNAMO OF CACTUPAO\n                                                   ACSMNAMO OF CACTUPAO\n                                                   ACSLNAMO OF CACTUPAO\n      *Customer address and contact info\n                                                   ACSADL1O OF CACTUPAO\n                                                   ACSADL2O OF CACTUPAO\n                                                   ACSCITYO OF CACTUPAO\n                                                   ACSSTTEO OF CACTUPAO\n                                                   ACSZIPCO OF CACTUPAO\n                                                   ACSCTRYO OF CACTUPAO\n\n                                                   ACSPH1AO OF CACTUPAO\n                                                   ACSPH1BO OF CACTUPAO\n                                                   ACSPH1CO OF CACTUPAO\n                                                   ACSPH2AO OF CACTUPAO\n                                                   ACSPH2BO OF CACTUPAO\n                                                   ACSPH2CO OF CACTUPAO\n\n      *Customer other good stuff\n                                                   ACSGOVTO OF CACTUPAO\n                                                   ACSEFTCO OF CACTUPAO\n                                                   ACSPFLGO OF CACTUPAO\n           .",
            "description": "This paragraph initializes the account update screen (CACTUPAO) by clearing all input fields with LOW-VALUES. The code systematically clears several groups of fields: account status and limits, account dates, customer identification data, personal information, address and contact details, and customer flags. This preparation step ensures the screen is ready for new data entry or for displaying existing account information without any residual values from previous operations. The fields are organized in logical groups that correspond to the different sections of customer and account information managed by the program."
          },
          {
            "name": "3201-SHOW-INITIAL-VALUES-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3201-SHOW-INITIAL-VALUES routine. It provides a clean termination point for the routine that displays the initial account and customer values to the user before they make any modifications."
          },
          {
            "name": "3202-SHOW-ORIGINAL-VALUES",
            "code": "MOVE LOW-VALUES                     TO WS-NON-KEY-FLAGS\n\n           SET PROMPT-FOR-CHANGES              TO TRUE\n\n           IF FOUND-ACCT-IN-MASTER\n           OR FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-ACTIVE-STATUS      TO ACSTTUSO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n\n              MOVE ACUP-OLD-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n\n              MOVE ACUP-OLD-OPEN-YEAR          TO OPNYEARO OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-MON           TO OPNMONO  OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-DAY           TO OPNDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-EXP-YEAR           TO EXPYEARO OF CACTUPAO\n              MOVE ACUP-OLD-EXP-MON            TO EXPMONO  OF CACTUPAO\n              MOVE ACUP-OLD-EXP-DAY            TO EXPDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-REISSUE-YEAR       TO RISYEARO OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-MON        TO RISMONO  OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-DAY        TO RISDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-GROUP-ID           TO AADDGRPO OF CACTUPAO\n           END-IF\n\n           IF FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-CUST-ID-X          TO ACSTNUMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(1:3)    TO ACTSSN1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(4:2)    TO ACTSSN2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(6:4)    TO ACTSSN3O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FICO-SCORE-X  TO ACSTFCOO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-YEAR      TO DOBYEARO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-MON       TO DOBMONO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-DAY       TO DOBDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FIRST-NAME    TO ACSFNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-MIDDLE-NAME   TO ACSMNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-LAST-NAME     TO ACSLNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-1   TO ACSADL1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-2   TO ACSADL2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-3   TO ACSCITYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-STATE-CD TO ACSSTTEO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-ZIP      TO ACSZIPCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-COUNTRY-CD\n                                               TO ACSCTRYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(2:3)\n                                               TO ACSPH1AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(6:3)\n                                               TO ACSPH1BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(10:4)\n                                               TO ACSPH1CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(2:3)\n                                               TO ACSPH2AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(6:3)\n                                               TO ACSPH2BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(10:4)\n                                               TO ACSPH2CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-GOVT-ISSUED-ID\n                                               TO ACSGOVTO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-EFT-ACCOUNT-ID\n                                               TO ACSEFTCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PRI-HOLDER-IND\n                                               TO ACSPFLGO OF CACTUPAO\n           END-IF\n           .",
            "description": "This paragraph populates the display screen with original account and customer values from the database records. It first initializes flags and sets the transaction state to prompt for changes. When account or customer records are found, it formats and transfers data from internal working storage fields to the corresponding output screen fields. For account information, it handles financial data (converting numeric values to formatted currency), account status, balance information, credit limits, cycle credits/debits, and various dates (open, expiration, reissue). For customer information, it populates personal details including SSN (split into three parts), FICO score, date of birth, name fields, complete address information, phone numbers (formatted into area code, exchange, and line number components), government ID, EFT account information, and primary holder indicator. This paragraph essentially prepares the screen to show the user what data currently exists before they make any modifications."
          },
          {
            "name": "3202-SHOW-ORIGINAL-VALUES-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3202-SHOW-ORIGINAL-VALUES routine. It provides a clean termination point for the routine that displays the original account and customer values to the user before modifications are made."
          },
          {
            "name": "3203-SHOW-UPDATED-VALUES",
            "code": "MOVE ACUP-NEW-ACTIVE-STATUS         TO ACSTTUSO OF CACTUPAO\n\n           IF FLG-CRED-LIMIT-ISVALID\n              MOVE ACUP-NEW-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CREDIT-LIMIT-X     TO ACRDLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CASH-CREDIT-LIMIT-ISVALID\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                               TO ACSHLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-BAL-ISVALID\n              MOVE ACUP-NEW-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-BAL-X         TO ACURBALO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-CREDIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-X  TO ACRCYCRO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-DEBIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-X   TO ACRCYDBO OF CACTUPAO\n           END-IF\n\n           MOVE ACUP-NEW-OPEN-YEAR             TO OPNYEARO OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-MON              TO OPNMONO  OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-DAY              TO OPNDAYO  OF CACTUPAO\n\n           MOVE ACUP-NEW-EXP-YEAR              TO EXPYEARO OF CACTUPAO\n           MOVE ACUP-NEW-EXP-MON               TO EXPMONO  OF CACTUPAO\n           MOVE ACUP-NEW-EXP-DAY               TO EXPDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-YEAR          TO RISYEARO OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-MON           TO RISMONO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-DAY           TO RISDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-GROUP-ID              TO AADDGRPO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ID-X             TO ACSTNUMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-1            TO ACTSSN1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-2            TO ACTSSN2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-3            TO ACTSSN3O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X     TO ACSTFCOO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-YEAR         TO DOBYEARO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-MON          TO DOBMONO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-DAY          TO DOBDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FIRST-NAME       TO ACSFNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME      TO ACSMNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-LAST-NAME        TO ACSLNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1      TO ACSADL1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-2      TO ACSADL2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3      TO ACSCITYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD    TO ACSSTTEO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-ZIP         TO ACSZIPCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD  TO ACSCTRYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1A     TO ACSPH1AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1B     TO ACSPH1BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1C     TO ACSPH1CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2A     TO ACSPH2AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2B     TO ACSPH2BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2C     TO ACSPH2CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-GOVT-ISSUED-ID   TO ACSGOVTO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID   TO ACSEFTCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND   TO ACSPFLGO OF CACTUPAO\n\n           .",
            "description": "This paragraph populates the account update display screen (CACTUPAO) with the new values that have been entered or modified by the user. It transfers data from the working storage fields (ACUP-NEW-*) to the corresponding screen fields. The paragraph handles different data types appropriately:\n\nFor monetary values (credit limits, balances), it checks validation flags first and either formats the numeric values using a currency editing field (WS-EDIT-CURRENCY-9-2-F) or displays the raw input if validation failed. This ensures proper display formatting while preserving invalid entries for correction.\n\nThe paragraph populates all account information including status, credit limits, balances, cycle credits/debits, and important dates (open date, expiration date, reissue date). It also transfers all customer information including identification details (customer ID, SSN, FICO score), personal information (name, date of birth), address information (multiple address lines, city, state, zip, country), contact information (phone numbers), and account relationship data (government ID, EFT account, primary holder indicator)."
          },
          {
            "name": "3203-SHOW-UPDATED-VALUES-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3203-SHOW-UPDATED-VALUES routine. It provides a clean termination point for the routine that displays updated account and customer values to the user after modifications have been made but before they are committed to the database."
          },
          {
            "name": "3250-SETUP-INFOMSG",
            "code": "*    SETUP INFORMATION MESSAGE\n           EVALUATE TRUE\n               WHEN CDEMO-PGM-ENTER\n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE\n               WHEN ACUP-DETAILS-NOT-FETCHED\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n               WHEN ACUP-SHOW-DETAILS\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-NOT-OK\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE\n\n               WHEN ACUP-CHANGES-OKAYED-LOCK-ERROR\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-BUT-FAILED\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN WS-NO-INFO-MESSAGE\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n           END-EVALUATE\n\n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CACTUPAO\n\n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CACTUPAO\n           .",
            "description": "This paragraph sets up the appropriate information message to display to the user based on the current state of the account update process. It uses an EVALUATE statement to determine which message to display according to where the user is in the workflow - whether they need to enter search criteria, make changes to account details, confirm changes, or receive feedback about the success or failure of an update operation. After determining the appropriate message type, it moves the selected message to the output fields on the CACTUPAO screen. The paragraph handles all possible states of the transaction flow, ensuring the user receives relevant guidance or feedback at each step of the process."
          },
          {
            "name": "3250-SETUP-INFOMSG-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the SETUP-INFOMSG routine in the account update process. It provides a structured way to return control to the calling routine after information messages have been prepared for display to the user."
          },
          {
            "name": "3300-SETUP-SCREEN-ATTRS",
            "code": "*    PROTECT ALL FIELDS\n           PERFORM 3310-PROTECT-ALL-ATTRS\n              THRU 3310-PROTECT-ALL-ATTRS-EXIT\n\n      *    UNPROTECT BASED ON CONTEXT\n           EVALUATE TRUE\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      *            Make Account Id editable\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n              WHEN  ACUP-SHOW-DETAILS\n              WHEN  ACUP-CHANGES-NOT-OK\n                   PERFORM 3320-UNPROTECT-FEW-ATTRS\n                      THRU 3320-UNPROTECT-FEW-ATTRS-EXIT\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                   CONTINUE\n              WHEN OTHER\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n           END-EVALUATE\n\n      *    POSITION CURSOR - ORDER BASED ON SCREEN LOCATION\n           EVALUATE TRUE\n              WHEN FOUND-ACCOUNT-DATA\n              WHEN NO-CHANGES-DETECTED\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n              WHEN FLG-ACCTFILTER-NOT-OK\n              WHEN FLG-ACCTFILTER-BLANK\n                   MOVE -1             TO ACCTSIDL OF CACTUPAI\n      *    Account Status\n              WHEN FLG-ACCT-STATUS-NOT-OK\n              WHEN FLG-ACCT-STATUS-BLANK\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n      *    Open Year\n              WHEN FLG-OPEN-YEAR-NOT-OK\n              WHEN FLG-OPEN-YEAR-BLANK\n                  MOVE -1              TO OPNYEARL OF CACTUPAI\n      *    Open Month\n              WHEN FLG-OPEN-MONTH-NOT-OK\n              WHEN FLG-OPEN-MONTH-BLANK\n                  MOVE -1              TO OPNMONL  OF CACTUPAI\n      *    Open Day\n              WHEN FLG-OPEN-DAY-NOT-OK\n              WHEN FLG-OPEN-DAY-BLANK\n                  MOVE -1              TO OPNDAYL  OF CACTUPAI\n      *    Credit Limit\n              WHEN FLG-CRED-LIMIT-NOT-OK\n              WHEN FLG-CRED-LIMIT-BLANK\n                  MOVE -1              TO ACRDLIML OF CACTUPAI\n      *    Expiry Year\n              WHEN FLG-EXPIRY-YEAR-NOT-OK\n              WHEN FLG-EXPIRY-YEAR-BLANK\n                  MOVE -1              TO EXPYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-EXPIRY-MONTH-NOT-OK\n              WHEN FLG-EXPIRY-MONTH-BLANK\n                  MOVE -1              TO EXPMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-EXPIRY-DAY-NOT-OK\n              WHEN FLG-EXPIRY-DAY-BLANK\n                  MOVE -1              TO EXPDAYL  OF CACTUPAI\n      *    Cash credit limit\n              WHEN FLG-CASH-CREDIT-LIMIT-NOT-OK\n              WHEN FLG-CASH-CREDIT-LIMIT-BLANK\n                  MOVE -1              TO ACSHLIML OF CACTUPAI\n      *    Reissue Year\n              WHEN FLG-REISSUE-YEAR-NOT-OK\n              WHEN FLG-REISSUE-YEAR-BLANK\n                  MOVE -1              TO RISYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-REISSUE-MONTH-NOT-OK\n              WHEN FLG-REISSUE-MONTH-BLANK\n                  MOVE -1              TO RISMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-REISSUE-DAY-NOT-OK\n              WHEN FLG-REISSUE-DAY-BLANK\n                  MOVE -1              TO RISDAYL  OF CACTUPAI\n\n      *    Current Balance\n              WHEN FLG-CURR-BAL-NOT-OK\n              WHEN FLG-CURR-BAL-BLANK\n                  MOVE -1              TO ACURBALL OF CACTUPAI\n      *    Current Cycle Credit\n              WHEN FLG-CURR-CYC-CREDIT-NOT-OK\n              WHEN FLG-CURR-CYC-CREDIT-BLANK\n                  MOVE -1              TO ACRCYCRL OF CACTUPAI\n      *    Current Cycle Debit\n              WHEN FLG-CURR-CYC-DEBIT-NOT-OK\n              WHEN FLG-CURR-CYC-DEBIT-BLANK\n                  MOVE -1              TO ACRCYDBL OF CACTUPAI\n      *    SSN Part 1\n              WHEN FLG-EDIT-US-SSN-PART1-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART1-BLANK\n                  MOVE -1              TO ACTSSN1L OF CACTUPAI\n      *    SSN Part 2\n              WHEN FLG-EDIT-US-SSN-PART2-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART2-BLANK\n                  MOVE -1              TO ACTSSN2L  OF CACTUPAI\n      *    SSN Part 3\n              WHEN FLG-EDIT-US-SSN-PART3-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART3-BLANK\n                  MOVE -1              TO ACTSSN3L  OF CACTUPAI\n      *    Date of Birth Year\n              WHEN FLG-DT-OF-BIRTH-YEAR-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-YEAR-BLANK\n                  MOVE -1              TO DOBYEARL OF CACTUPAI\n      *    Date of Birth Month\n              WHEN FLG-DT-OF-BIRTH-MONTH-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-MONTH-BLANK\n                  MOVE -1              TO DOBMONL  OF CACTUPAI\n      *    Date of Birth Day\n              WHEN FLG-DT-OF-BIRTH-DAY-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-DAY-BLANK\n                  MOVE -1              TO DOBDAYL  OF CACTUPAI\n      *    FICO Score\n              WHEN FLG-FICO-SCORE-NOT-OK\n              WHEN FLG-FICO-SCORE-BLANK\n                  MOVE -1              TO ACSTFCOL OF CACTUPAI\n      *    First Name\n              WHEN FLG-FIRST-NAME-NOT-OK\n              WHEN FLG-FIRST-NAME-BLANK\n                  MOVE -1              TO ACSFNAML OF CACTUPAI\n      *    Middle Name\n              WHEN FLG-MIDDLE-NAME-NOT-OK\n                  MOVE -1              TO ACSMNAML OF CACTUPAI\n      *    Last Name\n              WHEN FLG-LAST-NAME-NOT-OK\n              WHEN FLG-LAST-NAME-BLANK\n                  MOVE -1              TO ACSLNAML OF CACTUPAI\n      *    Address Line 1\n              WHEN FLG-ADDRESS-LINE-1-NOT-OK\n              WHEN FLG-ADDRESS-LINE-1-BLANK\n                  MOVE -1              TO ACSADL1L OF CACTUPAI\n      *    State (appears next to Line 2 on screen before city)\n              WHEN FLG-STATE-NOT-OK\n              WHEN FLG-STATE-BLANK\n                  MOVE -1              TO ACSSTTEL OF CACTUPAI\n      *    Address Line 2 has no edits\n      *    Zip code\n              WHEN FLG-ZIPCODE-NOT-OK\n              WHEN FLG-ZIPCODE-BLANK\n                  MOVE -1              TO ACSZIPCL OF CACTUPAI\n      *    Address Line 3 (City)\n              WHEN FLG-CITY-NOT-OK\n              WHEN FLG-CITY-BLANK\n                  MOVE -1              TO ACSCITYL OF CACTUPAI\n      *    Country edits.\n              WHEN FLG-COUNTRY-NOT-OK\n              WHEN FLG-COUNTRY-BLANK\n                  MOVE -1              TO ACSCTRYL OF CACTUPAI\n      *    Phone 1\n              WHEN FLG-PHONE-NUM-1A-NOT-OK\n              WHEN FLG-PHONE-NUM-1A-BLANK\n                  MOVE -1              TO ACSPH1AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1B-NOT-OK\n              WHEN FLG-PHONE-NUM-1B-BLANK\n                  MOVE -1              TO ACSPH1BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1C-NOT-OK\n              WHEN FLG-PHONE-NUM-1C-BLANK\n                  MOVE -1              TO ACSPH1CL OF CACTUPAI\n      *    Phone 2\n              WHEN FLG-PHONE-NUM-2A-NOT-OK\n              WHEN FLG-PHONE-NUM-2A-BLANK\n                  MOVE -1              TO ACSPH2AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2B-NOT-OK\n              WHEN FLG-PHONE-NUM-2B-BLANK\n                  MOVE -1              TO ACSPH2BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2C-NOT-OK\n              WHEN FLG-PHONE-NUM-2C-BLANK\n                  MOVE -1              TO ACSPH2CL OF CACTUPAI\n      *    EFT Account Id\n              WHEN FLG-EFT-ACCOUNT-ID-NOT-OK\n              WHEN FLG-EFT-ACCOUNT-ID-BLANK\n                  MOVE -1              TO ACSEFTCL OF CACTUPAI\n      *    Primary Card Holder\n              WHEN FLG-PRI-CARDHOLDER-NOT-OK\n              WHEN FLG-PRI-CARDHOLDER-BLANK\n                  MOVE -1              TO ACSPFLGL OF CACTUPAI\n              WHEN OTHER\n                  MOVE -1              TO ACCTSIDL OF CACTUPAI\n            END-EVALUATE\n\n\n      *    SETUP COLOR\n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n              MOVE DFHDFCOL            TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n      *    Account Filter\n           IF FLG-ACCTFILTER-NOT-OK\n              MOVE DFHRED              TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF  FLG-ACCTFILTER-BLANK\n           AND CDEMO-PGM-REENTER\n               MOVE '*'                TO ACCTSIDO OF CACTUPAO\n               MOVE DFHRED             TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n           OR FLG-ACCTFILTER-BLANK\n           OR FLG-ACCTFILTER-NOT-OK\n              GO TO 3300-SETUP-SCREEN-ATTRS-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      ******************************************************************\n      *    Using Copy replacing to set attribs for remaining vars\n      *    Write specific code only if rules differ\n      ******************************************************************\n      *    IF (FLG-ACCT-STATUS-NOT-OK\n      *    OR  FLG-ACCT-STATUS-BLANK)\n      *    AND CDEMO-PGM-REENTER\n      *        MOVE DFHRED             TO ACSTTUSC OF CACTUPAO\n      *        IF  FLG-ACCT-STATUS-BLANK\n      *            MOVE '*'            TO ACSTTUSO OF CACTUPAO\n      *        END-IF\n      *    END-IF\n\n      *    Account Status\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ACCT-STATUS==\n             ==(SCRNVAR2)== BY ==ACSTTUS==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-YEAR==\n             ==(SCRNVAR2)== BY ==OPNYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-MONTH==\n             ==(SCRNVAR2)== BY ==OPNMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-DAY==\n             ==(SCRNVAR2)== BY ==OPNDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CRED-LIMIT==\n             ==(SCRNVAR2)== BY ==ACRDLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-YEAR==\n             ==(SCRNVAR2)== BY ==EXPYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-MONTH==\n             ==(SCRNVAR2)== BY ==EXPMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-DAY==\n             ==(SCRNVAR2)== BY ==EXPDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Cash Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CASH-CREDIT-LIMIT==\n             ==(SCRNVAR2)== BY ==ACSHLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-YEAR==\n             ==(SCRNVAR2)== BY ==RISYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-MONTH==\n             ==(SCRNVAR2)== BY ==RISMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-DAY==\n             ==(SCRNVAR2)== BY ==RISDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Balance\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-BAL==\n             ==(SCRNVAR2)== BY ==ACURBAL==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Credit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-CREDIT==\n             ==(SCRNVAR2)== BY ==ACRCYCR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Debit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-DEBIT==\n             ==(SCRNVAR2)== BY ==ACRCYDB==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART1==\n             ==(SCRNVAR2)== BY ==ACTSSN1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 2\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART2==\n             ==(SCRNVAR2)== BY ==ACTSSN2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 3\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART3==\n             ==(SCRNVAR2)== BY ==ACTSSN3==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-YEAR==\n             ==(SCRNVAR2)== BY ==DOBYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-MONTH==\n             ==(SCRNVAR2)== BY ==DOBMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-DAY==\n             ==(SCRNVAR2)== BY ==DOBDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    FICO Score\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FICO-SCORE==\n             ==(SCRNVAR2)== BY ==ACSTFCO==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    First Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FIRST-NAME==\n             ==(SCRNVAR2)== BY ==ACSFNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Middle Name (no edits coded)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==MIDDLE-NAME==\n             ==(SCRNVAR2)== BY ==ACSMNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Last Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==LAST-NAME==\n             ==(SCRNVAR2)== BY ==ACSLNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-1==\n             ==(SCRNVAR2)== BY ==ACSADL1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==STATE==\n             ==(SCRNVAR2)== BY ==ACSSTTE==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 2 (NO EDITS CODED AS YET)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-2==\n             ==(SCRNVAR2)== BY ==ACSADL2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ZIPCODE==\n             ==(SCRNVAR2)== BY ==ACSZIPC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    City\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CITY==\n             ==(SCRNVAR2)== BY ==ACSCITY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Country\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==COUNTRY==\n             ==(SCRNVAR2)== BY ==ACSCTRY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1A==\n             ==(SCRNVAR2)== BY ==ACSPH1A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1B==\n             ==(SCRNVAR2)== BY ==ACSPH1B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 1 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1C==\n             ==(SCRNVAR2)== BY ==ACSPH1C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2A==\n             ==(SCRNVAR2)== BY ==ACSPH2A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2B==\n             ==(SCRNVAR2)== BY ==ACSPH2B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 2 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2C==\n             ==(SCRNVAR2)== BY ==ACSPH2C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    EFT Account Id\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PRI-CARDHOLDER==\n             ==(SCRNVAR2)== BY ==ACSPFLG==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Primary Card Holder\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EFT-ACCOUNT-ID==\n             ==(SCRNVAR2)== BY ==ACSEFTC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n           .",
            "description": "This paragraph manages the screen attributes for the account update interface based on the current transaction state. It first protects all fields, then selectively unprotects fields depending on the context (whether account details have been fetched, changes are pending, etc.). The bulk of the code handles cursor positioning logic, which determines where the cursor should be placed on the screen based on validation errors or the current field being edited. The cursor is positioned on the first field with an error, following a top-to-bottom, left-to-right screen order.\n\nThe paragraph also handles visual feedback by setting color attributes for fields - highlighting invalid entries in red and marking required fields with an asterisk when they're blank. It uses a reusable copybook (CSSETATY) with the REPLACING option to efficiently apply consistent attribute handling across numerous fields including dates, monetary amounts, personal information, and contact details. This approach ensures consistent user experience while reducing code duplication across the many editable fields in the account update screen."
          },
          {
            "name": "3300-SETUP-SCREEN-ATTRS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3300-SETUP-SCREEN-ATTRS routine. It simply contains the EXIT statement followed by a period, which returns control to the calling routine after the screen attributes setup process has completed."
          },
          {
            "name": "3310-PROTECT-ALL-ATTRS",
            "code": "MOVE DFHBMPRF              TO ACCTSIDA OF CACTUPAI\n                                         ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n                                         ACSTNUMA OF CACTUPAI\n                                         ACTSSN1A OF CACTUPAI\n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n                                         ACSCTRYA OF CACTUPAI\n\n                                         ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n                                         ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n                                         INFOMSGA OF CACTUPAI\n           .",
            "description": "This paragraph sets all input fields on the account update screen (CACTUPAI) to protected status by applying the DFHBMPRF attribute. This prevents users from modifying any data fields on the screen, effectively making the entire form read-only. The fields being protected include account identification, status, financial limits, balance information, various dates (opening, expiration, risk assessment), customer personal information (SSN, name components), address details (street, city, state, zip), phone numbers, and various flags and indicators. This paragraph is likely called when the system needs to display account information without allowing modifications, such as during a view-only mode or after a transaction has been completed."
          },
          {
            "name": "3310-PROTECT-ALL-ATTRS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the PROTECT-ALL-ATTRS routine in the account update program. It provides a clean termination point for the routine that handles attribute protection for screen fields, allowing the program flow to return to the calling section after the protection logic has been applied."
          },
          {
            "name": "3320-UNPROTECT-FEW-ATTRS",
            "code": "MOVE DFHBMFSE              TO ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n      *Open Date\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n      *Expiry date\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n      *Reissue date\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n            MOVE DFHBMPRF            TO  ACSTNUMA OF CACTUPAI\n            MOVE DFHBMFSE            TO  ACTSSN1A OF CACTUPAI         \n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n      *Since most of the edits are USA specific protected country\n           MOVE DFHBMPRF              TO ACSCTRYA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n           MOVE DFHBMPRF              TO INFOMSGA OF CACTUPAI\n           .",
            "description": "This paragraph configures the input fields on the account update screen by setting specific attribute properties. It makes certain fields modifiable by applying the DFHBMFSE attribute (Field Selection, Extended highlighting) to various account and customer data fields. The paragraph enables user editing for account status, financial limits, balance fields, various date components (open date, expiry date, reissue date, date of birth), and customer information including SSN, name fields, address components, and phone numbers. It also protects certain fields from modification by applying the DFHBMPRF attribute (Protected Field) to the account number, country code (which is fixed as USA due to USA-specific validation logic), and the information message field. This paragraph essentially prepares the screen for user input by controlling which fields can be modified during the account update process."
          },
          {
            "name": "3320-UNPROTECT-FEW-ATTRS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3320-UNPROTECT-FEW-ATTRS routine in the account update process. It provides a clean termination point for the routine that selectively enables specific fields for user modification on the account update screen."
          },
          {
            "name": "3390-SETUP-INFOMSG-ATTRS",
            "code": "IF  WS-NO-INFO-MESSAGE\n               MOVE DFHBMDAR           TO INFOMSGA OF CACTUPAI\n           ELSE\n               MOVE DFHBMASB           TO INFOMSGA OF CACTUPAI\n           END-IF\n\n           IF ACUP-CHANGES-MADE\n           AND NOT ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           IF PROMPT-FOR-CONFIRMATION\n               MOVE DFHBMASB           TO FKEY05A  OF CACTUPAI\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           .",
            "description": "This paragraph sets the visual attributes for various fields on the account update screen (CACTUPAI). It controls the display characteristics of the information message area based on whether a message needs to be shown, highlighting it when a message is present. Additionally, it manages the visibility of function key prompts based on the current state of the transaction - specifically highlighting PF12 when changes have been made but not yet confirmed, and highlighting both PF5 and PF12 when user confirmation is required. These visual cues help guide the user through the account update workflow by drawing attention to relevant action options at each step."
          },
          {
            "name": "3390-SETUP-INFOMSG-ATTRS-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3390-SETUP-INFOMSG-ATTRS routine in the account update program. It provides a clean termination point for the routine that sets up information message attributes, allowing the program flow to return to the calling section after the attribute setup is complete."
          },
          {
            "name": "3400-SEND-SCREEN",
            "code": "MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP\n\n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)\n                          MAPSET(CCARD-NEXT-MAPSET)\n                          FROM(CACTUPAO)\n                          CURSOR\n                          ERASE\n                          FREEKB\n                          RESP(WS-RESP-CD)\n           END-EXEC\n           .",
            "description": "This paragraph handles the display of the account update screen in the CICS environment. It first sets up the next map and mapset names using literal values, then issues a CICS SEND MAP command to display the screen to the user. The command sends the map defined in CCARD-NEXT-MAP from the CACTUPAO data area, positions the cursor appropriately, clears the screen (ERASE), and enables keyboard input (FREEKB). The response code from this operation is captured in WS-RESP-CD for error handling purposes."
          },
          {
            "name": "3400-SEND-SCREEN-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 3400-SEND-SCREEN routine in the account update program. It provides a clean termination point for the routine that handles screen display operations, allowing control to return to the calling section after the screen has been sent to the user."
          },
          {
            "name": "9000-READ-ACCT",
            "code": "INITIALIZE ACUP-OLD-DETAILS\n\n           SET  WS-NO-INFO-MESSAGE      TO TRUE\n\n           MOVE CC-ACCT-ID              TO ACUP-OLD-ACCT-ID\n                                           WS-CARD-RID-ACCT-ID\n\n           PERFORM 9200-GETCARDXREF-BYACCT\n              THRU 9200-GETCARDXREF-BYACCT-EXIT\n\n           IF FLG-ACCTFILTER-NOT-OK\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           PERFORM 9300-GETACCTDATA-BYACCT\n              THRU 9300-GETACCTDATA-BYACCT-EXIT\n\n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID\n\n           PERFORM 9400-GETCUSTDATA-BYCUST\n              THRU 9400-GETCUSTDATA-BYCUST-EXIT\n\n           IF DID-NOT-FIND-CUST-IN-CUSTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n\n\n           PERFORM 9500-STORE-FETCHED-DATA\n              THRU 9500-STORE-FETCHED-DATA-EXIT\n           .",
            "description": "This paragraph retrieves and prepares account and customer data for the update process. It first initializes the old details structure and clears any information messages. Using the account ID from the communication area, it performs a series of data retrieval operations: first checking the card cross-reference file (9200-GETCARDXREF-BYACCT), then retrieving account data (9300-GETACCTDATA-BYACCT), and finally fetching the associated customer information (9400-GETCUSTDATA-BYCUST). The process exits early if any of these lookups fail. When all data is successfully retrieved, it stores the fetched information in working storage (9500-STORE-FETCHED-DATA) for subsequent processing in the update workflow."
          },
          {
            "name": "9000-READ-ACCT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the account reading process in the COACTUPC program. It's a simple exit routine that provides a structured way to return control to the calling section after account data has been read from the database. This follows standard structured programming practices in COBOL where dedicated exit paragraphs are used to maintain clear control flow."
          },
          {
            "name": "9200-GETCARDXREF-BYACCT",
            "code": "*    Read the Card file. Access via alternate index ACCTID\n      *\n           EXEC CICS READ\n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID\n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Cross ref file.  Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *          PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .",
            "description": "This paragraph retrieves a card cross-reference record using the account ID as the key. It reads from the card cross-reference file through its alternate index path (ACCTID) and processes the result based on the response code. When successful, it extracts the customer ID and card number from the retrieved record. If the record is not found, it sets appropriate error flags and constructs a detailed error message indicating the account was not found in the cross-reference file. For other errors, it captures file operation details and sets a generic file error message. The paragraph is essential for linking account information to customer and card data during the account update process."
          },
          {
            "name": "9200-GETCARDXREF-BYACCT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the GETCARDXREF-BYACCT routine. It provides a standard control flow marker that allows the program to return to the calling routine after completing the card cross-reference lookup by account number. This is a simple control structure element that helps maintain the program's organized flow when retrieving card cross-reference information."
          },
          {
            "name": "9300-GETACCTDATA-BYACCT",
            "code": "EXEC CICS READ\n                DATASET   (LIT-ACCTFILENAME)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-ACCT-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Acct Master file.Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n      *\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .",
            "description": "This paragraph retrieves account data from the account master file using the account ID as the key. It performs a CICS READ operation on the account file and handles three possible outcomes: successful retrieval, record not found, or other errors. When successful, it sets a flag indicating the account was found. If the account is not found, it sets appropriate error flags and constructs a detailed error message including the account ID and response codes. For other errors, it captures file operation details and generates a standard file error message. The paragraph is essential for validating account existence before proceeding with account updates in the main program flow."
          },
          {
            "name": "9300-GETACCTDATA-BYACCT-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 9300-GETACCTDATA-BYACCT routine. It provides a structured way to return control to the calling routine after the account data retrieval process has completed, whether successfully or with errors. This follows standard COBOL structured programming practices for paragraph termination."
          },
          {
            "name": "9400-GETCUSTDATA-BYCUST",
            "code": "EXEC CICS READ\n                DATASET   (LIT-CUSTFILENAME)\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-CUST-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE\n                  MOVE WS-RESP-CD               TO ERROR-RESP\n                  MOVE WS-REAS-CD               TO ERROR-RESP2\n                  IF WS-RETURN-MSG-OFF\n                    STRING\n                    'CustId:'\n                     WS-CARD-RID-CUST-ID-X\n                    ' not found'\n                    ' in customer master.Resp: '\n                    ERROR-RESP\n                    ' REAS:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .",
            "description": "This paragraph retrieves customer data from the customer master file using the customer ID as the key. It performs a CICS READ operation on the customer file and evaluates the response code to determine the outcome. If the read is successful, it sets a flag indicating the customer was found. If the customer is not found, it sets error flags and constructs an error message containing the customer ID and response codes. For any other response code, it sets error flags and prepares a file error message. The paragraph handles all possible outcomes of the database read operation, ensuring proper error handling and user feedback when retrieving customer information."
          },
          {
            "name": "9400-GETCUSTDATA-BYCUST-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 9400-GETCUSTDATA-BYCUST routine, which retrieves customer data by customer identifier. It provides a clean termination point for the routine, allowing control to return to the calling section after customer data retrieval operations are complete."
          },
          {
            "name": "9500-STORE-FETCHED-DATA",
            "code": "*    Store Context in Commarea\n      *\n           MOVE ACCT-ID                   TO CDEMO-ACCT-ID\n           MOVE CUST-ID                   TO CDEMO-CUST-ID\n           MOVE CUST-FIRST-NAME           TO CDEMO-CUST-FNAME\n           MOVE CUST-MIDDLE-NAME          TO CDEMO-CUST-MNAME\n           MOVE CUST-LAST-NAME            TO CDEMO-CUST-LNAME\n           MOVE ACCT-ACTIVE-STATUS        TO CDEMO-ACCT-STATUS\n           MOVE XREF-CARD-NUM             TO CDEMO-CARD-NUM\n\n           INITIALIZE ACUP-OLD-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACCT-ID                  TO ACUP-OLD-ACCT-ID\n      * Active Status\n           MOVE ACCT-ACTIVE-STATUS       TO ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACCT-CURR-BAL            TO ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           MOVE ACCT-CREDIT-LIMIT        TO ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           MOVE ACCT-CASH-CREDIT-LIMIT   TO ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           MOVE ACCT-CURR-CYC-CREDIT     TO ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           MOVE ACCT-CURR-CYC-DEBIT      TO ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n      *    MOVE ACCT-OPEN-DATE           TO ACUP-OLD-OPEN-DATE\n           MOVE ACCT-OPEN-DATE(1:4)      TO ACUP-OLD-OPEN-YEAR\n           MOVE ACCT-OPEN-DATE(6:2)      TO ACUP-OLD-OPEN-MON\n           MOVE ACCT-OPEN-DATE(9:2)      TO ACUP-OLD-OPEN-DAY\n      * Expiry date\n      *    MOVE ACCT-EXPIRAION-DATE      TO ACUP-OLD-EXPIRAION-DATE\n           MOVE ACCT-EXPIRAION-DATE(1:4) TO ACUP-OLD-EXP-YEAR\n           MOVE ACCT-EXPIRAION-DATE(6:2) TO ACUP-OLD-EXP-MON\n           MOVE ACCT-EXPIRAION-DATE(9:2) TO ACUP-OLD-EXP-DAY\n\n      * Reissue date\n      *    MOVE ACCT-REISSUE-DATE        TO ACUP-OLD-REISSUE-DATE\n           MOVE ACCT-REISSUE-DATE(1:4)   TO ACUP-OLD-REISSUE-YEAR\n           MOVE ACCT-REISSUE-DATE(6:2)   TO ACUP-OLD-REISSUE-MON\n           MOVE ACCT-REISSUE-DATE(9:2)   TO ACUP-OLD-REISSUE-DAY\n      * Account Group\n           MOVE ACCT-GROUP-ID            TO ACUP-OLD-GROUP-ID\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n           MOVE CUST-ID                  TO ACUP-OLD-CUST-ID\n      *Social Security Number\n           MOVE CUST-SSN                 TO ACUP-OLD-CUST-SSN\n      *Date of birth\n      *    MOVE CUST-DOB-YYYY-MM-DD      TO ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           MOVE CUST-DOB-YYYY-MM-DD(1:4) TO ACUP-OLD-CUST-DOB-YEAR\n           MOVE CUST-DOB-YYYY-MM-DD(6:2) TO ACUP-OLD-CUST-DOB-MON\n           MOVE CUST-DOB-YYYY-MM-DD(9:2) TO ACUP-OLD-CUST-DOB-DAY\n      *FICO\n           MOVE CUST-FICO-CREDIT-SCORE   TO ACUP-OLD-CUST-FICO-SCORE\n      *First Name\n           MOVE CUST-FIRST-NAME          TO ACUP-OLD-CUST-FIRST-NAME\n      *Middle Name\n           MOVE CUST-MIDDLE-NAME         TO ACUP-OLD-CUST-MIDDLE-NAME\n      *Last Name\n           MOVE CUST-LAST-NAME           TO ACUP-OLD-CUST-LAST-NAME\n      *Address\n           MOVE CUST-ADDR-LINE-1         TO ACUP-OLD-CUST-ADDR-LINE-1\n           MOVE CUST-ADDR-LINE-2         TO ACUP-OLD-CUST-ADDR-LINE-2\n           MOVE CUST-ADDR-LINE-3         TO ACUP-OLD-CUST-ADDR-LINE-3\n           MOVE CUST-ADDR-STATE-CD       TO ACUP-OLD-CUST-ADDR-STATE-CD\n           MOVE CUST-ADDR-COUNTRY-CD     TO\n                                          ACUP-OLD-CUST-ADDR-COUNTRY-CD\n           MOVE CUST-ADDR-ZIP            TO ACUP-OLD-CUST-ADDR-ZIP\n           MOVE CUST-PHONE-NUM-1         TO ACUP-OLD-CUST-PHONE-NUM-1\n           MOVE CUST-PHONE-NUM-2         TO ACUP-OLD-CUST-PHONE-NUM-2\n      *Government Id\n           MOVE CUST-GOVT-ISSUED-ID      TO ACUP-OLD-CUST-GOVT-ISSUED-ID\n      *EFT Code\n           MOVE CUST-EFT-ACCOUNT-ID      TO ACUP-OLD-CUST-EFT-ACCOUNT-ID\n      *Primary Holder Indicator\n           MOVE CUST-PRI-CARD-HOLDER-IND TO ACUP-OLD-CUST-PRI-HOLDER-IND\n           .",
            "description": "This paragraph stores retrieved account and customer data into two main areas: the communication area (CDEMO fields) for context preservation between program calls, and a structured backup area (ACUP-OLD-DETAILS). The backup area captures the original state of all account and customer fields before any modifications are made. The paragraph handles various data types including account identifiers, financial information (balances, credit limits), dates (which are split into separate year, month, and day components), and customer personal information (name, address, contact details, identification numbers). This stored data serves as both the initial display values for the update screen and as a baseline for detecting which fields have been changed when processing updates."
          },
          {
            "name": "9500-STORE-FETCHED-DATA-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the 9500-STORE-FETCHED-DATA routine in the account update program. It provides a clean termination point for the routine that stores retrieved account and customer data from the database into program variables for processing."
          },
          {
            "name": "9600-WRITE-PROCESSING",
            "code": "*    Read the account file for update\n\n           MOVE CC-ACCT-ID              TO WS-CARD-RID-ACCT-ID\n\n           EXEC CICS READ\n                FILE      (LIT-ACCTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the account record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-ACCT-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *    Read the customer file for update\n\n           MOVE CDEMO-CUST-ID                   TO WS-CARD-RID-CUST-ID\n\n           EXEC CICS READ\n                FILE      (LIT-CUSTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the customer record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-CUST-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *****************************************************************\n      *    Did someone change the record while we were out ?\n      *****************************************************************\n           PERFORM 9700-CHECK-CHANGE-IN-REC\n              THRU 9700-CHECK-CHANGE-IN-REC-EXIT\n\n           IF DATA-WAS-CHANGED-BEFORE-UPDATE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Prepare the update\n      *****************************************************************\n           INITIALIZE ACCT-UPDATE-RECORD\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACUP-NEW-ACCT-ID         TO ACCT-UPDATE-ID\n      * Active Status\n           MOVE ACUP-NEW-ACTIVE-STATUS   TO ACCT-UPDATE-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACUP-NEW-CURR-BAL-N      TO ACCT-UPDATE-CURR-BAL\n      * Credit Limit\n           MOVE ACUP-NEW-CREDIT-LIMIT-N  TO ACCT-UPDATE-CREDIT-LIMIT\n      * Cash Limit\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                      TO ACCT-UPDATE-CASH-CREDIT-LIMIT\n      * Current Cycle Credit\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-N\n                                          TO ACCT-UPDATE-CURR-CYC-CREDIT\n      * Current Cycle Debit\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-N TO ACCT-UPDATE-CURR-CYC-DEBIT\n      * Open date\n           STRING ACUP-NEW-OPEN-YEAR\n                  '-'\n                  ACUP-NEW-OPEN-MON\n                  '-'\n                  ACUP-NEW-OPEN-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-OPEN-DATE\n      * Expiry date\n           STRING ACUP-NEW-EXP-YEAR\n                  '-'\n                  ACUP-NEW-EXP-MON\n                  '-'\n                  ACUP-NEW-EXP-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-EXPIRAION-DATE\n\n      * Reissue date\n           MOVE ACCT-REISSUE-DATE        TO ACCT-UPDATE-REISSUE-DATE\n           STRING ACUP-NEW-REISSUE-YEAR\n                  '-'\n                  ACUP-NEW-REISSUE-MON\n                  '-'\n                  ACUP-NEW-REISSUE-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-REISSUE-DATE\n      * Account Group\n           MOVE ACUP-NEW-GROUP-ID        TO ACCT-UPDATE-GROUP-ID\n\n      ******************************************************************\n      *    Customer data\n      ******************************************************************\n           INITIALIZE CUST-UPDATE-RECORD\n\n           MOVE  ACUP-NEW-CUST-ID        TO CUST-UPDATE-ID\n           MOVE  ACUP-NEW-CUST-FIRST-NAME\n                                   TO CUST-UPDATE-FIRST-NAME\n           MOVE  ACUP-NEW-CUST-MIDDLE-NAME\n                                   TO CUST-UPDATE-MIDDLE-NAME\n           MOVE  ACUP-NEW-CUST-LAST-NAME TO CUST-UPDATE-LAST-NAME\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-1\n                                   TO CUST-UPDATE-ADDR-LINE-1\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-2\n                                   TO CUST-UPDATE-ADDR-LINE-2\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-3\n                                   TO CUST-UPDATE-ADDR-LINE-3\n           MOVE  ACUP-NEW-CUST-ADDR-STATE-CD\n                                   TO CUST-UPDATE-ADDR-STATE-CD\n           MOVE  ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                   TO CUST-UPDATE-ADDR-COUNTRY-CD\n           MOVE  ACUP-NEW-CUST-ADDR-ZIP  TO CUST-UPDATE-ADDR-ZIP\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-1A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-1B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-1C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-1\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-2A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-2B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-2C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-2\n\n\n           MOVE  ACUP-NEW-CUST-SSN       TO CUST-UPDATE-SSN\n           MOVE  ACUP-NEW-CUST-GOVT-ISSUED-ID\n                                   TO CUST-UPDATE-GOVT-ISSUED-ID\n           STRING ACUP-NEW-CUST-DOB-YEAR\n                  '-'\n                  ACUP-NEW-CUST-DOB-MON\n                  '-'\n                  ACUP-NEW-CUST-DOB-DAY\n           DELIMITED BY SIZE           INTO CUST-UPDATE-DOB-YYYY-MM-DD\n\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO CUST-UPDATE-EFT-ACCOUNT-ID\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO CUST-UPDATE-PRI-CARD-IND\n           MOVE ACUP-NEW-CUST-FICO-SCORE TO\n                                   CUST-UPDATE-FICO-CREDIT-SCORE\n      *****************************************************************\n      * Update account *\n      *****************************************************************\n\n\n           EXEC CICS\n                REWRITE FILE(LIT-ACCTFILENAME)\n                        FROM(ACCT-UPDATE-RECORD)\n                        LENGTH(LENGTH OF ACCT-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *\n      *****************************************************************\n      * Did account update succeed ?  *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Update customer *\n      *****************************************************************\n           EXEC CICS\n                        REWRITE FILE(LIT-CUSTFILENAME)\n                        FROM(CUST-UPDATE-RECORD)\n                        LENGTH(LENGTH OF CUST-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *****************************************************************\n      * Did customer update succeed ? *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             EXEC CICS\n                SYNCPOINT ROLLBACK\n             END-EXEC\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .",
            "description": "This paragraph handles the database update process for account and customer information in the CardDemo application. It first attempts to lock both the account and customer records for update by performing READ UPDATE operations on the respective files. If either record cannot be locked, it sets appropriate error flags and exits.\n\nAfter successfully locking the records, it checks if the data has changed since it was initially retrieved (via the 9700-CHECK-CHANGE-IN-REC paragraph) to prevent overwriting concurrent changes. If no conflicts are detected, it prepares the update records by transferring the modified data from the screen fields to the database record structures.\n\nThe paragraph carefully formats various fields including dates (open date, expiry date, reissue date, date of birth) and phone numbers with proper formatting. It then performs the actual database updates by executing CICS REWRITE commands for both the account and customer records. If either update fails, it sets an error flag and performs a SYNCPOINT ROLLBACK to ensure data integrity. The comprehensive error handling throughout the paragraph ensures that database operations maintain transactional integrity."
          },
          {
            "name": "9600-WRITE-PROCESSING-EXIT",
            "code": "EXIT\n           .",
            "description": "This paragraph serves as an exit point for the write processing routine in the COACTUPC program. It's a simple exit paragraph that marks the end of a processing section, allowing the program to return control to the calling routine after completing write operations related to account updates."
          },
          {
            "name": "9700-CHECK-CHANGE-IN-REC",
            "code": "******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCT-ACTIVE-STATUS      EQUAL ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           AND ACCT-CURR-BAL           EQUAL ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           AND ACCT-CREDIT-LIMIT       EQUAL ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           AND ACCT-CASH-CREDIT-LIMIT EQUAL ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           AND ACCT-CURR-CYC-CREDIT    EQUAL ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           AND ACCT-CURR-CYC-DEBIT     EQUAL ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n           AND ACCT-OPEN-DATE(1:4)     EQUAL ACUP-OLD-OPEN-YEAR\n           AND ACCT-OPEN-DATE(6:2)     EQUAL ACUP-OLD-OPEN-MON\n           AND ACCT-OPEN-DATE(9:2)     EQUAL ACUP-OLD-OPEN-DAY\n      * Expiry date\n           AND ACCT-EXPIRAION-DATE(1:4)EQUAL ACUP-OLD-EXP-YEAR\n           AND ACCT-EXPIRAION-DATE(6:2)EQUAL ACUP-OLD-EXP-MON\n           AND ACCT-EXPIRAION-DATE(9:2)EQUAL ACUP-OLD-EXP-DAY\n      * Reissue date\n           AND ACCT-REISSUE-DATE(1:4)  EQUAL ACUP-OLD-REISSUE-YEAR\n           AND ACCT-REISSUE-DATE(6:2)  EQUAL ACUP-OLD-REISSUE-MON\n           AND ACCT-REISSUE-DATE(9:2)  EQUAL ACUP-OLD-REISSUE-DAY\n      * Account Group\n           AND FUNCTION LOWER-CASE (ACCT-GROUP-ID)           EQUAL\n               FUNCTION LOWER-CASE (ACUP-OLD-GROUP-ID)\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      ******************************************************************\n      *    Customer  data - Split into 2 IFs for easier reading\n      *    And maybe put logic to update only 1 file if only date\n      *    pertaining to one of them is updated\n      ******************************************************************\n           IF  FUNCTION UPPER-CASE (CUST-FIRST-NAME          ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-FIRST-NAME )\n           AND FUNCTION UPPER-CASE (CUST-MIDDLE-NAME         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-MIDDLE-NAME)\n           AND FUNCTION UPPER-CASE (CUST-LAST-NAME           ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-LAST-NAME  )\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-1         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-1)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-2         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-2)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-3         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-3)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-STATE-CD       ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-STATE-CD)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-COUNTRY-CD     ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-COUNTRY-CD )\n           AND CUST-ADDR-ZIP           EQUAL ACUP-OLD-CUST-ADDR-ZIP\n           AND CUST-PHONE-NUM-1        EQUAL ACUP-OLD-CUST-PHONE-NUM-1\n           AND CUST-PHONE-NUM-2        EQUAL ACUP-OLD-CUST-PHONE-NUM-2\n           AND CUST-SSN                EQUAL ACUP-OLD-CUST-SSN\n           AND FUNCTION UPPER-CASE (CUST-GOVT-ISSUED-ID      ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-GOVT-ISSUED-ID )\n           AND CUST-DOB-YYYY-MM-DD (1:4)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (1:4)\n           AND CUST-DOB-YYYY-MM-DD (6:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (5:2)\n           AND CUST-DOB-YYYY-MM-DD (9:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (7:2)\n\n           AND CUST-EFT-ACCOUNT-ID     EQUAL\n                                            ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND CUST-PRI-CARD-HOLDER-IND\n                                       EQUAL\n                                            ACUP-OLD-CUST-PRI-HOLDER-IND\n           AND CUST-FICO-CREDIT-SCORE  EQUAL ACUP-OLD-CUST-FICO-SCORE\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .",
            "description": "This paragraph performs a comprehensive comparison between the current account and customer data values and their original values stored in the program's working storage. It checks if any changes have been made to the data before proceeding with an update operation. The comparison includes account details (active status, balances, credit limits, and various dates) and customer information (personal details, address, contact information, and identification data). If any field has been modified from its original value, it sets a flag indicating data was changed and exits the current processing flow. This validation ensures that unnecessary updates are avoided when no actual changes have been made to the data, improving efficiency and preventing unintended modifications to the database records."
          },
          {
            "name": "9700-CHECK-CHANGE-IN-REC-EXIT",
            "code": "EXIT\n           .\n      ******************************************************************\n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .",
            "description": "This paragraph serves as an exit point for the change detection routine in the account update process. It includes a reference to the 'CSSTRPFY' copybook, which contains common code for storing function key (PFKey) information. This is part of the program's user interface handling, allowing it to track which function keys the user presses during the account update workflow."
          },
          {
            "name": "ABEND-ROUTINE",
            "code": "IF ABEND-MSG EQUAL LOW-VALUES\n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG\n           END-IF\n\n           MOVE LIT-THISPGM       TO ABEND-CULPRIT\n\n           EXEC CICS SEND\n                            FROM (ABEND-DATA)\n                            LENGTH(LENGTH OF ABEND-DATA)\n                            NOHANDLE\n                            ERASE\n           END-EXEC\n\n           EXEC CICS HANDLE ABEND\n                CANCEL\n           END-EXEC\n\n           EXEC CICS ABEND\n                ABCODE('9999')\n           END-EXEC\n           .",
            "description": "This paragraph handles abnormal termination (ABEND) processing for the account update program. It ensures a meaningful error message is displayed to the user before terminating the transaction. If no specific error message has been set (ABEND-MSG contains LOW-VALUES), it displays a generic \"UNEXPECTED ABEND OCCURRED\" message. The routine identifies the current program as the source of the error, sends the error information to the terminal with screen clearing, cancels any existing abend handlers to prevent recursive handling, and finally terminates the transaction with abend code '9999'. This provides a controlled shutdown path when unrecoverable errors occur during account update processing."
          },
          {
            "name": "ABEND-ROUTINE-EXIT",
            "code": "EXIT\n           .\n      ******************************************************************\n      * Common Date Routines\n      ******************************************************************\n       COPY CSUTLDPY\n           .\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *",
            "description": "This paragraph serves as the exit point for the ABEND-ROUTINE section in the COACTUPC program. After executing the ABEND handling logic, control flows to this EXIT statement which marks the end of the routine. Following this exit point, the program incorporates the CSUTLDPY copybook which contains common date manipulation routines used throughout the application. These shared date utilities likely support the program's extensive date validation and formatting requirements when processing account updates. The final comment line indicates the version control information for the program, showing it's based on CardDemo version 1.0 with specific commit details and a timestamp from July 19, 2022."
          }
        ],
        "code": "0000-MAIN.\n\n\n           EXEC CICS HANDLE ABEND\n                     LABEL(ABEND-ROUTINE)\n           END-EXEC\n\n           INITIALIZE CC-WORK-AREA\n                      WS-MISC-STORAGE\n                      WS-COMMAREA\n      *****************************************************************\n      * Store our context\n      *****************************************************************\n           MOVE LIT-THISTRANID       TO WS-TRANID\n      *****************************************************************\n      * Ensure error message is cleared                               *\n      *****************************************************************\n           SET WS-RETURN-MSG-OFF  TO TRUE\n      *****************************************************************\n      * Store passed data if  any                *\n      *****************************************************************\n           IF EIBCALEN IS EQUAL TO 0\n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA\n              SET CDEMO-PGM-ENTER TO TRUE\n              SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO\n                                CARDDEMO-COMMAREA\n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO\n                                WS-THIS-PROGCOMMAREA\n           END-IF\n      *****************************************************************\n      * Remap PFkeys as needed.\n      * Store the Mapped PF Key\n      *****************************************************************\n           PERFORM YYYY-STORE-PFKEY\n              THRU YYYY-STORE-PFKEY-EXIT\n      *****************************************************************\n      * Check the AID to see if its valid at this point               *\n      * F3 - Exit\n      * Enter show screen again\n      *****************************************************************\n           SET PFK-INVALID TO TRUE\n           IF CCARD-AID-ENTER OR\n              CCARD-AID-PFK03 OR\n              (CCARD-AID-PFK05 AND ACUP-CHANGES-OK-NOT-CONFIRMED)\n                              OR\n              (CCARD-AID-PFK12 AND NOT ACUP-DETAILS-NOT-FETCHED)\n              SET PFK-VALID TO TRUE\n           END-IF\n\n           IF PFK-INVALID\n              SET CCARD-AID-ENTER TO TRUE\n           END-IF\n\n      *****************************************************************\n      * Decide what to do based on inputs received\n      *****************************************************************\n           EVALUATE TRUE\n      ******************************************************************\n      *       USER PRESSES PF03 TO EXIT\n      *  OR   USER IS DONE WITH UPDATE\n      *            XCTL TO CALLING PROGRAM OR MAIN MENU\n      ******************************************************************\n              WHEN CCARD-AID-PFK03\n                   SET CCARD-AID-PFK03     TO TRUE\n\n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                   OR CDEMO-FROM-TRANID    EQUAL SPACES\n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID\n                   ELSE\n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID\n                   END-IF\n\n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES\n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES\n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM\n                   ELSE\n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM\n                   END-IF\n\n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID\n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM\n\n                   SET  CDEMO-USRTYP-USER  TO TRUE\n                   SET  CDEMO-PGM-ENTER    TO TRUE\n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET\n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP\n\n                   EXEC CICS\n                        SYNCPOINT\n                   END-EXEC\n      *\n                   EXEC CICS XCTL\n                        PROGRAM (CDEMO-TO-PROGRAM)\n                        COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n      ******************************************************************\n      *       FRESH ENTRY INTO PROGRAM\n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n               AND CDEMO-PGM-ENTER\n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER        TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *       ACCT DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY\n      *            RESET THE SEARCH KEYS\n      *            ASK THE USER FOR FRESH SEARCH CRITERIA\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n              WHEN ACUP-CHANGES-FAILED\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                              WS-MISC-STORAGE\n                              CDEMO-ACCT-ID\n                   SET CDEMO-PGM-ENTER            TO TRUE\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER          TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED   TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *      ACCT DATA HAS BEEN PRESENTED TO USER\n      *            CHECK THE USER INPUTS\n      *            DECIDE WHAT TO DO\n      *            PRESENT NEXT STEPS TO USER\n      ******************************************************************\n              WHEN OTHER\n                   PERFORM 1000-PROCESS-INPUTS\n                      THRU 1000-PROCESS-INPUTS-EXIT\n                   PERFORM 2000-DECIDE-ACTION\n                      THRU 2000-DECIDE-ACTION-EXIT\n                   PERFORM 3000-SEND-MAP\n                      THRU 3000-SEND-MAP-EXIT\n                   GO TO COMMON-RETURN\n           END-EVALUATE\n           .\n\n       COMMON-RETURN.\n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG\n\n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\n           MOVE  WS-THIS-PROGCOMMAREA TO\n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA )\n\n           EXEC CICS RETURN\n                TRANSID (LIT-THISTRANID)\n                COMMAREA (WS-COMMAREA)\n                LENGTH(LENGTH OF WS-COMMAREA)\n           END-EXEC\n           .\n       0000-MAIN-EXIT.\n           EXIT\n           .\n\n       1000-PROCESS-INPUTS.\n           PERFORM 1100-RECEIVE-MAP\n              THRU 1100-RECEIVE-MAP-EXIT\n           PERFORM 1200-EDIT-MAP-INPUTS\n              THRU 1200-EDIT-MAP-INPUTS-EXIT\n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG\n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG\n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP\n           .\n      *\n       1000-PROCESS-INPUTS-EXIT.\n           EXIT\n           .\n       1100-RECEIVE-MAP.\n           EXEC CICS RECEIVE MAP(LIT-THISMAP)\n                     MAPSET(LIT-THISMAPSET)\n                     INTO(CACTUPAI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC\n      *\n           INITIALIZE ACUP-NEW-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCTSIDI OF CACTUPAI = '*'\n           OR  ACCTSIDI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           ELSE\n               MOVE ACCTSIDI OF CACTUPAI TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n              GO TO 1100-RECEIVE-MAP-EXIT\n           END-IF\n\n      * Active Status\n           IF  ACSTTUSI OF CACTUPAI = '*'\n           OR  ACSTTUSI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-ACTIVE-STATUS\n           ELSE\n               MOVE ACSTTUSI OF CACTUPAI TO ACUP-NEW-ACTIVE-STATUS\n           END-IF\n\n      * Credit Limit\n           IF  ACRDLIMI OF CACTUPAI = '*'\n           OR  ACRDLIMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CREDIT-LIMIT-X\n           ELSE\n               MOVE ACRDLIMI OF CACTUPAI TO ACUP-NEW-CREDIT-LIMIT-X\n               IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CREDIT-LIMIT-X) = 0\n                  COMPUTE ACUP-NEW-CREDIT-LIMIT-N =\n                     FUNCTION NUMVAL-C(ACRDLIMI OF CACTUPAI)\n               ELSE\n                  CONTINUE\n               END-IF\n           END-IF\n\n      * Cash Limit\n           IF  ACSHLIMI OF CACTUPAI = '*'\n           OR  ACSHLIMI OF CACTUPAI = SPACES\n             MOVE LOW-VALUES           TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n           ELSE\n             MOVE ACSHLIMI OF CACTUPAI TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n             IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CASH-CREDIT-LIMIT-X) = 0\n                COMPUTE ACUP-NEW-CASH-CREDIT-LIMIT-N =\n                     FUNCTION NUMVAL-C(ACSHLIMI OF CACTUPAI)\n             ELSE\n                CONTINUE\n             END-IF\n           END-IF\n\n      * Current Balance\n           IF  ACURBALI OF CACTUPAI = '*'\n           OR  ACURBALI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-BAL-X\n           ELSE\n               MOVE ACURBALI OF CACTUPAI TO ACUP-NEW-CURR-BAL-X\n               IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-BAL-X) = 0\n                   COMPUTE ACUP-NEW-CURR-BAL-N =\n                     FUNCTION NUMVAL-C(ACUP-NEW-CURR-BAL-X)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Credit\n           IF  ACRCYCRI OF CACTUPAI = '*'\n           OR  ACRCYCRI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-CREDIT-X\n           ELSE\n               MOVE ACRCYCRI OF CACTUPAI TO ACUP-NEW-CURR-CYC-CREDIT-X\n               IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-CREDIT-X) = 0\n                   COMPUTE ACUP-NEW-CURR-CYC-CREDIT-N =\n                     FUNCTION NUMVAL-C(ACRCYCRI OF CACTUPAI)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Debit\n           IF  ACRCYDBI OF CACTUPAI = '*'\n           OR  ACRCYDBI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-DEBIT-X\n           ELSE\n               MOVE ACRCYDBI OF CACTUPAI TO ACUP-NEW-CURR-CYC-DEBIT-X\n               IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-DEBIT-X) = 0\n                   COMPUTE ACUP-NEW-CURR-CYC-DEBIT-N =\n                     FUNCTION NUMVAL-C(ACRCYDBI OF CACTUPAI)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Open date\n      *\n           IF  OPNYEARI OF CACTUPAI = '*'\n           OR  OPNYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-YEAR\n           ELSE\n               MOVE OPNYEARI OF CACTUPAI TO ACUP-NEW-OPEN-YEAR\n           END-IF\n\n           IF  OPNMONI OF CACTUPAI = '*'\n           OR  OPNMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-MON\n           ELSE\n               MOVE OPNMONI OF CACTUPAI TO  ACUP-NEW-OPEN-MON\n           END-IF\n\n           IF  OPNDAYI OF CACTUPAI = '*'\n           OR  OPNDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-DAY\n           ELSE\n               MOVE OPNDAYI OF CACTUPAI TO  ACUP-NEW-OPEN-DAY\n           END-IF\n\n      *Expiry date\n      *\n           IF  EXPYEARI OF CACTUPAI = '*'\n           OR  EXPYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-YEAR\n           ELSE\n               MOVE EXPYEARI OF CACTUPAI TO ACUP-NEW-EXP-YEAR\n           END-IF\n\n           IF  EXPMONI OF CACTUPAI = '*'\n           OR  EXPMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-MON\n           ELSE\n               MOVE EXPMONI OF CACTUPAI TO  ACUP-NEW-EXP-MON\n           END-IF\n\n           IF  EXPDAYI OF CACTUPAI = '*'\n           OR  EXPDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-DAY\n           ELSE\n               MOVE EXPDAYI OF CACTUPAI TO  ACUP-NEW-EXP-DAY\n           END-IF\n\n      *Reissue date\n      *\n           IF  RISYEARI OF CACTUPAI = '*'\n           OR  RISYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-YEAR\n           ELSE\n               MOVE RISYEARI OF CACTUPAI TO ACUP-NEW-REISSUE-YEAR\n           END-IF\n\n           IF  RISMONI OF CACTUPAI = '*'\n           OR  RISMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-MON\n           ELSE\n               MOVE RISMONI OF CACTUPAI TO  ACUP-NEW-REISSUE-MON\n           END-IF\n\n           IF  RISDAYI OF CACTUPAI = '*'\n           OR  RISDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-DAY\n           ELSE\n               MOVE RISDAYI OF CACTUPAI TO  ACUP-NEW-REISSUE-DAY\n           END-IF\n\n      *Account Group\n      *\n           IF  AADDGRPI OF CACTUPAI = '*'\n           OR  AADDGRPI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-GROUP-ID\n           ELSE\n               MOVE AADDGRPI OF CACTUPAI TO ACUP-NEW-GROUP-ID\n           END-IF\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n      *\n           IF  ACSTNUMI OF CACTUPAI = '*'\n           OR  ACSTNUMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ID-X\n           ELSE\n               MOVE ACSTNUMI OF CACTUPAI TO ACUP-NEW-CUST-ID-X\n           END-IF\n\n      *Social Security Number\n      *\n           IF  ACTSSN1I OF CACTUPAI = '*'\n           OR  ACTSSN1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-1\n           ELSE\n               MOVE ACTSSN1I OF CACTUPAI TO ACUP-NEW-CUST-SSN-1\n           END-IF\n\n           IF  ACTSSN2I OF CACTUPAI = '*'\n           OR  ACTSSN2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-2\n           ELSE\n               MOVE ACTSSN2I OF CACTUPAI TO ACUP-NEW-CUST-SSN-2\n           END-IF\n\n           IF  ACTSSN3I OF CACTUPAI = '*'\n           OR  ACTSSN3I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-3\n           ELSE\n               MOVE ACTSSN3I OF CACTUPAI TO ACUP-NEW-CUST-SSN-3\n           END-IF\n      *\n      *Date of birth\n      *\n           IF  DOBYEARI OF CACTUPAI = '*'\n           OR  DOBYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-YEAR\n           ELSE\n               MOVE DOBYEARI OF CACTUPAI TO ACUP-NEW-CUST-DOB-YEAR\n           END-IF\n\n           IF  DOBMONI OF CACTUPAI = '*'\n           OR  DOBMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-MON\n           ELSE\n               MOVE DOBMONI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-MON\n           END-IF\n\n           IF  DOBDAYI OF CACTUPAI = '*'\n           OR  DOBDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-DAY\n           ELSE\n               MOVE DOBDAYI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-DAY\n           END-IF\n      *\n      *FICO\n      *\n           IF  ACSTFCOI OF CACTUPAI = '*'\n           OR  ACSTFCOI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FICO-SCORE-X\n           ELSE\n               MOVE ACSTFCOI OF CACTUPAI TO ACUP-NEW-CUST-FICO-SCORE-X\n           END-IF\n      *\n      *First Name\n      *\n           IF  ACSFNAMI OF CACTUPAI = '*'\n           OR  ACSFNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FIRST-NAME\n           ELSE\n               MOVE ACSFNAMI OF CACTUPAI TO ACUP-NEW-CUST-FIRST-NAME\n           END-IF\n      *\n      *Middle Name\n      *\n           IF  ACSMNAMI OF CACTUPAI = '*'\n           OR  ACSMNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-MIDDLE-NAME\n           ELSE\n               MOVE ACSMNAMI OF CACTUPAI TO ACUP-NEW-CUST-MIDDLE-NAME\n           END-IF\n      *\n      *Last Name\n      *\n           IF  ACSLNAMI OF CACTUPAI = '*'\n           OR  ACSLNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-LAST-NAME\n           ELSE\n               MOVE ACSLNAMI OF CACTUPAI TO ACUP-NEW-CUST-LAST-NAME\n           END-IF\n      *\n      *Address\n      *\n           IF  ACSADL1I OF CACTUPAI = '*'\n           OR  ACSADL1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-1\n           ELSE\n               MOVE ACSADL1I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-1\n           END-IF\n\n           IF  ACSADL2I OF CACTUPAI = '*'\n           OR  ACSADL2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-2\n           ELSE\n               MOVE ACSADL2I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-2\n           END-IF\n\n           IF  ACSCITYI OF CACTUPAI = '*'\n           OR  ACSCITYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-3\n           ELSE\n               MOVE ACSCITYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-3\n           END-IF\n\n           IF  ACSSTTEI OF CACTUPAI = '*'\n           OR  ACSSTTEI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-STATE-CD\n           ELSE\n               MOVE ACSSTTEI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-STATE-CD\n           END-IF\n\n           IF  ACSCTRYI OF CACTUPAI = '*'\n           OR  ACSCTRYI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           ELSE\n              MOVE ACSCTRYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           END-IF\n\n           IF  ACSZIPCI OF CACTUPAI = '*'\n           OR  ACSZIPCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-ZIP\n           ELSE\n               MOVE ACSZIPCI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-ZIP\n           END-IF\n\n           IF  ACSPH1AI OF CACTUPAI = '*'\n           OR  ACSPH1AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1A\n           ELSE\n               MOVE ACSPH1AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1A\n           END-IF\n\n           IF  ACSPH1BI OF CACTUPAI = '*'\n           OR  ACSPH1BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1B\n           ELSE\n               MOVE ACSPH1BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1B\n           END-IF\n\n           IF  ACSPH1CI OF CACTUPAI = '*'\n           OR  ACSPH1CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1C\n           ELSE\n               MOVE ACSPH1CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1C\n           END-IF\n\n           IF  ACSPH2AI OF CACTUPAI = '*'\n           OR  ACSPH2AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2A\n           ELSE\n               MOVE ACSPH2AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2A\n           END-IF\n\n           IF  ACSPH2BI OF CACTUPAI = '*'\n           OR  ACSPH2BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2B\n           ELSE\n               MOVE ACSPH2BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2B\n           END-IF\n\n           IF  ACSPH2CI OF CACTUPAI = '*'\n           OR  ACSPH2CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2C\n           ELSE\n               MOVE ACSPH2CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2C\n           END-IF\n      *\n      *Government Id\n      *\n           IF  ACSGOVTI OF CACTUPAI = '*'\n           OR  ACSGOVTI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           ELSE\n               MOVE ACSGOVTI OF CACTUPAI TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           END-IF\n      *\n      *EFT Code\n      *\n           IF  ACSEFTCI OF CACTUPAI = '*'\n           OR  ACSEFTCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           ELSE\n               MOVE ACSEFTCI OF CACTUPAI TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           END-IF\n      *\n      *Primary Holder Indicator\n      *\n           IF  ACSPFLGI OF CACTUPAI = '*'\n           OR  ACSPFLGI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES            TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           ELSE\n              MOVE ACSPFLGI OF CACTUPAI  TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           END-IF\n           .\n       1100-RECEIVE-MAP-EXIT.\n           EXIT\n           .\n       1200-EDIT-MAP-INPUTS.\n\n           SET INPUT-OK                  TO TRUE\n\n           IF  ACUP-DETAILS-NOT-FETCHED\n      *        VALIDATE THE SEARCH KEYS\n               PERFORM 1210-EDIT-ACCOUNT\n                  THRU 1210-EDIT-ACCOUNT-EXIT\n\n               MOVE LOW-VALUES           TO ACUP-OLD-ACCT-DATA\n\n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS FLAG THEM\n              IF  FLG-ACCTFILTER-BLANK\n                  SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE\n              END-IF\n\n      *       AT THIS STAGE. NO DETAILS FETCHED. NOTHING MORE TO EDIT.\n              GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n      *\n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED\n           SET FOUND-ACCOUNT-DATA        TO TRUE\n           SET FOUND-ACCT-IN-MASTER      TO TRUE\n           SET FLG-ACCTFILTER-ISVALID    TO TRUE\n\n           SET FOUND-CUST-IN-MASTER      TO TRUE\n           SET FLG-CUSTFILTER-ISVALID    TO TRUE\n\n      *\n           PERFORM 1205-COMPARE-OLD-NEW\n              THRU 1205-COMPARE-OLD-NEW-EXIT\n\n           IF  NO-CHANGES-FOUND\n           OR  ACUP-CHANGES-OK-NOT-CONFIRMED\n           OR  ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE LOW-VALUES           TO WS-NON-KEY-FLAGS\n               GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           END-IF\n\n           SET ACUP-CHANGES-NOT-OK       TO TRUE\n\n           MOVE 'Account Status'          TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-ACTIVE-STATUS    TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO            TO WS-EDIT-ACCT-STATUS\n\n           MOVE 'Open Date'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-OPEN-DATE       TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-OPEN-DATE-FLGS\n\n           MOVE 'Credit Limit'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CREDIT-LIMIT-X  TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT  TO WS-EDIT-CREDIT-LIMIT\n\n           MOVE 'Expiry Date'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-EXPIRAION-DATE  TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EXPIRY-DATE-FLGS\n\n           MOVE 'Cash Credit Limit'      TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT TO WS-EDIT-CASH-CREDIT-LIMIT\n\n           MOVE 'Reissue Date'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-REISSUE-DATE    TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-REISSUE-DATE-FLGS\n\n           MOVE 'Current Balance'        TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-BAL-X      TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-BAL\n\n           MOVE 'Current Cycle Credit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-CREDIT\n\n           MOVE 'Current Cycle Debit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-DEBIT\n\n           MOVE 'SSN'                    TO WS-EDIT-VARIABLE-NAME\n           PERFORM 1265-EDIT-US-SSN\n              THRU 1265-EDIT-US-SSN-EXIT\n\n           MOVE 'Date of Birth'          TO WS-EDIT-VARIABLE-NAME\n           MOVE   ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                         TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-DT-OF-BIRTH-FLGS\n           IF WS-EDIT-DT-OF-BIRTH-ISVALID\n              PERFORM  EDIT-DATE-OF-BIRTH\n                 THRU  EDIT-DATE-OF-BIRTH-EXIT\n              MOVE WS-EDIT-DATE-FLGS    TO WS-EDIT-DT-OF-BIRTH-FLGS\n           END-IF\n\n           MOVE 'FICO Score'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-FICO-SCORE-FLGS\n           IF FLG-FICO-SCORE-ISVALID\n              PERFORM  1275-EDIT-FICO-SCORE\n                 THRU  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n      ******************************************************************\n      *    Edit names\n      ******************************************************************\n           MOVE 'First Name'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FIRST-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-FIRST-NAME-FLGS\n\n           MOVE 'Middle Name'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1235-EDIT-ALPHA-OPT\n              THRU 1235-EDIT-ALPHA-OPT-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-MIDDLE-NAME-FLGS\n\n           MOVE 'Last Name'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-LAST-NAME  TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                        TO WS-EDIT-LAST-NAME-FLGS\n\n           MOVE 'Address Line 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1215-EDIT-MANDATORY\n              THRU 1215-EDIT-MANDATORY-EXIT\n           MOVE WS-EDIT-MANDATORY-FLAGS\n                                         TO WS-EDIT-ADDRESS-LINE-1-FLGS\n\n           MOVE 'State'                  TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-STATE-FLGS\n           IF FLG-ALPHA-ISVALID\n           PERFORM 1270-EDIT-US-STATE-CD\n              THRU 1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n\n\n           MOVE 'Zip'                    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-ZIP   TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 5                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-ZIPCODE-FLGS\n\n      *    Address Line 2 is optional\n      *    MOVE 'Address Line 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE 'City'                   TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-CITY-FLGS\n\n           MOVE 'Country'                TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                        TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-COUNTRY-FLGS\n\n           MOVE 'Phone Number 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO  WS-EDIT-PHONE-NUM-1-FLGS\n\n           MOVE 'Phone Number 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO WS-EDIT-PHONE-NUM-2-FLGS\n\n           MOVE 'EFT Account Id'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 10                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EFT-ACCOUNT-ID-FLGS\n\n           MOVE 'Primary Card Holder'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO           TO WS-EDIT-PRI-CARDHOLDER\n\n      *    Cross field edits begin here\n           IF  FLG-STATE-ISVALID\n           AND FLG-ZIPCODE-ISVALID\n               PERFORM 1280-EDIT-US-STATE-ZIP-CD\n                  THRU 1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n\n           IF INPUT-ERROR\n              CONTINUE\n           ELSE\n              SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n           END-IF\n           .\n\n       1200-EDIT-MAP-INPUTS-EXIT.\n           EXIT\n           .\n       1205-COMPARE-OLD-NEW.\n           SET NO-CHANGES-FOUND           TO TRUE\n\n           IF  ACUP-NEW-ACCT-ID-X         = ACUP-OLD-ACCT-ID-X\n           AND FUNCTION UPPER-CASE (\n               ACUP-NEW-ACTIVE-STATUS)    =\n               FUNCTION UPPER-CASE (\n               ACUP-OLD-ACTIVE-STATUS)\n           AND ACUP-NEW-CURR-BAL          = ACUP-OLD-CURR-BAL\n           AND ACUP-NEW-CREDIT-LIMIT      = ACUP-OLD-CREDIT-LIMIT\n           AND ACUP-NEW-CASH-CREDIT-LIMIT = ACUP-OLD-CASH-CREDIT-LIMIT\n           AND ACUP-NEW-OPEN-DATE         = ACUP-OLD-OPEN-DATE\n           AND ACUP-NEW-EXPIRAION-DATE    = ACUP-OLD-EXPIRAION-DATE\n           AND ACUP-NEW-REISSUE-DATE      = ACUP-OLD-REISSUE-DATE\n           AND ACUP-NEW-CURR-CYC-CREDIT   = ACUP-OLD-CURR-CYC-CREDIT\n           AND ACUP-NEW-CURR-CYC-DEBIT    = ACUP-OLD-CURR-CYC-DEBIT\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-GROUP-ID))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-GROUP-ID))\n               CONTINUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n\n           IF  FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ID-X))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ID-X))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-FIRST-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-FIRST-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-MIDDLE-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-MIDDLE-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-LAST-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-LAST-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-1))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-1))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-2))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-2))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-3))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-3))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-STATE-CD))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-STATE-CD))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-COUNTRY-CD))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-COUNTRY-CD))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-ZIP))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-ZIP))\n           AND ACUP-NEW-CUST-PHONE-NUM-1A = ACUP-OLD-CUST-PHONE-NUM-1A\n           AND ACUP-NEW-CUST-PHONE-NUM-1B = ACUP-OLD-CUST-PHONE-NUM-1B\n           AND ACUP-NEW-CUST-PHONE-NUM-1C = ACUP-OLD-CUST-PHONE-NUM-1C\n           AND ACUP-NEW-CUST-PHONE-NUM-2A = ACUP-OLD-CUST-PHONE-NUM-2A\n           AND ACUP-NEW-CUST-PHONE-NUM-2B = ACUP-OLD-CUST-PHONE-NUM-2B\n           AND ACUP-NEW-CUST-PHONE-NUM-2C = ACUP-OLD-CUST-PHONE-NUM-2C\n           AND ACUP-NEW-CUST-SSN-X       = ACUP-OLD-CUST-SSN-X\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-GOVT-ISSUED-ID ))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-GOVT-ISSUED-ID))\n           AND ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                     = ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           AND ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                     = ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-PRI-HOLDER-IND))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-PRI-HOLDER-IND))\n           AND ACUP-NEW-CUST-FICO-SCORE-X\n                                     = ACUP-OLD-CUST-FICO-SCORE-X\n               SET NO-CHANGES-DETECTED   TO TRUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n           .\n\n       1205-COMPARE-OLD-NEW-EXIT.\n           EXIT\n           .\n\n\n      *\n       1210-EDIT-ACCOUNT.\n           SET FLG-ACCTFILTER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF CC-ACCT-ID   EQUAL LOW-VALUES\n           OR CC-ACCT-ID   EQUAL SPACES\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ACCTFILTER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 SET WS-PROMPT-FOR-ACCT TO TRUE\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n                                           ACUP-NEW-ACCT-ID\n              GO TO  1210-EDIT-ACCOUNT-EXIT\n           END-IF\n\n      *    Not numeric\n      *    Not 11 characters\n           MOVE CC-ACCT-ID              TO ACUP-NEW-ACCT-ID\n           IF CC-ACCT-ID   IS NOT NUMERIC\n           OR CC-ACCT-ID-N EQUAL ZEROS\n              SET INPUT-ERROR TO TRUE\n              IF WS-RETURN-MSG-OFF\n                STRING\n                 'Account Number if supplied must be a 11 digit'\n                 ' Non-Zero Number'\n                DELIMITED BY SIZE\n                INTO WS-RETURN-MSG\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n              GO TO 1210-EDIT-ACCOUNT-EXIT\n           ELSE\n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID\n              SET FLG-ACCTFILTER-ISVALID TO TRUE\n           END-IF\n           .\n\n       1210-EDIT-ACCOUNT-EXIT.\n           EXIT\n           .\n\n       1215-EDIT-MANDATORY.\n      *    Initialize\n           SET FLG-MANDATORY-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR          TO TRUE\n              SET FLG-MANDATORY-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1215-EDIT-MANDATORY-EXIT\n           END-IF\n\n           SET FLG-MANDATORY-ISVALID   TO TRUE\n           .\n       1215-EDIT-MANDATORY-EXIT.\n           EXIT\n           .\n\n       1220-EDIT-YESNO.\n      *    Must be Y or N\n      *    SET FLG-YES-NO-NOT-OK         TO TRUE\n      *\n      *    Not supplied\n           IF WS-EDIT-YES-NO             EQUAL LOW-VALUES\n           OR WS-EDIT-YES-NO             EQUAL SPACES\n           OR WS-EDIT-YES-NO             EQUAL ZEROS\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-YES-NO-BLANK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n\n\n           IF FLG-YES-NO-ISVALID\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-YES-NO-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be Y or N.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n           .\n       1220-EDIT-YESNO-EXIT.\n           EXIT\n           .\n\n       1225-EDIT-ALPHA-REQD.\n      *    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHA-BLANK            TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X   TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .\n       1225-EDIT-ALPHA-REQD-EXIT.\n           EXIT\n           .\n\n       1230-EDIT-ALPHANUM-REQD.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets,numbers and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n       1230-EDIT-ALPHANUM-REQD-EXIT.\n           EXIT\n           .\n       1235-EDIT-ALPHA-OPT.\n      *    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET FLG-ALPHA-ISVALID          TO TRUE\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X    TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .\n       1235-EDIT-ALPHA-OPT-EXIT.\n           EXIT\n           .\n\n       1240-EDIT-ALPHANUM-OPT.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied, but ok as optional\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n              SET FLG-ALPHNANUM-ISVALID     TO TRUE\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n       1240-EDIT-ALPHANUM-OPT-EXIT.\n           EXIT\n           .\n\n       1245-EDIT-NUM-REQD.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Only all numeric allowed\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                  IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be all numeric.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Must not be zero\n\n           IF FUNCTION NUMVAL(WS-EDIT-ALPHANUM-ONLY(1:\n                              WS-EDIT-ALPHANUM-LENGTH)) = 0\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must not be zero.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n       1245-EDIT-NUM-REQD-EXIT.\n           EXIT\n           .\n\n       1250-EDIT-SIGNED-9V2.\n           SET FLG-SIGNED-NUMBER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL LOW-VALUES\n           OR WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-SIGNED-NUMBER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF FUNCTION TEST-NUMVAL-C(WS-EDIT-SIGNED-NUMBER-9V2-X) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-SIGNED-NUMBER-NOT-OK   TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' is not valid'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n\n           END-IF\n\n      *    If we got here all edits were cleared\n           SET FLG-SIGNED-NUMBER-ISVALID  TO TRUE\n           .\n\n       1250-EDIT-SIGNED-9V2-EXIT.\n           EXIT\n           .\n\n       1260-EDIT-US-PHONE-NUM.\n\n      *    The database stores date in X(15) format (999)999-9999\n      *                                             1234567890123\n      *    So we take the X(15) input into WS-EDIT-US-PHONE-NUM\n      *    and edit it\n\n           SET WS-EDIT-US-PHONE-IS-INVALID TO TRUE\n      *    Not mandatory to enter a phone number\n           IF  (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES)\n                SET WS-EDIT-US-PHONE-IS-VALID TO TRUE\n                GO TO EDIT-US-PHONE-EXIT\n           ELSE\n                CONTINUE\n           END-IF\n           .\n       EDIT-AREA-CODE.\n           IF WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEA-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA       IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           MOVE FUNCTION TRIM (WS-EDIT-US-PHONE-NUMA)\n             TO WS-US-PHONE-AREA-CODE-TO-EDIT\n           IF VALID-GENERAL-PURP-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Not valid North America general purpose area code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           SET FLG-EDIT-US-PHONEA-ISVALID    TO TRUE\n           .\n       EDIT-US-PHONE-PREFIX.\n\n           IF WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEB-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           SET FLG-EDIT-US-PHONEB-ISVALID    TO TRUE\n           .\n\n       EDIT-US-PHONE-LINENUM.\n           IF WS-EDIT-US-PHONE-NUMC EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEC-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO EDIT-US-PHONE-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code must be A 4 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n\n\n           SET FLG-EDIT-US-PHONEC-ISVALID    TO TRUE\n           .\n\n       EDIT-US-PHONE-EXIT.\n           EXIT\n           .\n       1260-EDIT-US-PHONE-NUM-EXIT.\n           EXIT\n           .\n\n       1265-EDIT-US-SSN.\n      *Format xxx-xx-xxxx\n      *Part1 :should have 3 digits\n      *Part2 :should have 2 digits and it should be from 01 to 99\n      *Part3 should have 4 digits from 0001 to 9999.\n      ******************************************************************\n      *    Edit SSN Part 1\n      ******************************************************************\n           MOVE 'SSN: First 3 chars'     TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-1      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART1-FLGS\n\n      *Part1 :should not be 000, 666, or between 900 and 999\n           IF FLG-EDIT-US-SSN-PART1-ISVALID\n              MOVE ACUP-NEW-CUST-SSN-1   TO WS-EDIT-US-SSN-PART1\n              IF INVALID-SSN-PART1\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-EDIT-US-SSN-PART1-NOT-OK\n                                 TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': should not be 000, 666, or between 900 and 999'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              ELSE\n                CONTINUE\n              END-IF\n           END-IF\n\n      ******************************************************************\n      *    Edit SSN Part 2\n      ******************************************************************\n           MOVE 'SSN 4th & 5th chars'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-2      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART2-FLGS\n\n\n      ******************************************************************\n      *    Edit SSN Part 3\n      ******************************************************************\n           MOVE 'SSN Last 4 chars'       TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-3      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 4                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART3-FLGS\n           .\n       1265-EDIT-US-SSN-EXIT.\n           EXIT\n           .\n\n       1270-EDIT-US-STATE-CD.\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO US-STATE-CODE-TO-EDIT\n           IF VALID-US-STATE-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': is not a valid state code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n           .\n       1270-EDIT-US-STATE-CD-EXIT.\n           EXIT\n           .\n       1275-EDIT-FICO-SCORE.\n           IF FICO-RANGE-IS-VALID\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-FICO-SCORE-NOT-OK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': should be between 300 and 850'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n           .\n       1275-EDIT-FICO-SCORE-EXIT.\n           EXIT\n           .\n\n      *A crude zip code edit based on data from USPS web site\n       1280-EDIT-US-STATE-ZIP-CD.\n           STRING ACUP-NEW-CUST-ADDR-STATE-CD\n                  ACUP-NEW-CUST-ADDR-ZIP(1:2)\n             DELIMITED BY SIZE\n             INTO US-STATE-AND-FIRST-ZIP2\n\n           IF VALID-US-STATE-ZIP-CD2-COMBO\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              SET FLG-ZIPCODE-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   'Invalid zip code for state'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n           .\n       1280-EDIT-US-STATE-ZIP-CD-EXIT.\n           EXIT\n           .\n\n       2000-DECIDE-ACTION.\n           EVALUATE TRUE\n      ******************************************************************\n      *       NO DETAILS SHOWN.\n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      ******************************************************************\n      *       CHANGES MADE. BUT USER CANCELS\n      ******************************************************************\n              WHEN CCARD-AID-PFK12\n                 IF  FLG-ACCTFILTER-ISVALID\n                     SET WS-RETURN-MSG-OFF       TO TRUE\n                     PERFORM 9000-READ-ACCT\n                        THRU 9000-READ-ACCT-EXIT\n                     IF FOUND-CUST-IN-MASTER\n                        SET ACUP-SHOW-DETAILS    TO TRUE\n                     END-IF\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD\n      ******************************************************************\n              WHEN ACUP-SHOW-DETAILS\n                 IF INPUT-ERROR\n                 OR NO-CHANGES-DETECTED\n                    CONTINUE\n                 ELSE\n                    SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       BUT INPUT EDIT ERRORS FOUND\n      ******************************************************************\n              WHEN ACUP-CHANGES-NOT-OK\n                  CONTINUE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n               AND CCARD-AID-PFK05\n                 PERFORM 9600-WRITE-PROCESSING\n                    THRU 9600-WRITE-PROCESSING-EXIT\n                 EVALUATE TRUE\n                    WHEN COULD-NOT-LOCK-ACCT-FOR-UPDATE\n                         SET ACUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE\n                    WHEN LOCKED-BUT-UPDATE-FAILED\n                       SET ACUP-CHANGES-OKAYED-BUT-FAILED TO TRUE\n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE\n                        SET ACUP-SHOW-DETAILS            TO TRUE\n                    WHEN OTHER\n                       SET ACUP-CHANGES-OKAYED-AND-DONE   TO TRUE\n                 END-EVALUATE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                  CONTINUE\n      ******************************************************************\n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                  SET ACUP-SHOW-DETAILS TO TRUE\n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                  OR CDEMO-FROM-TRANID    EQUAL SPACES\n                     MOVE ZEROES       TO CDEMO-ACCT-ID\n                                          CDEMO-CARD-NUM\n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS\n                  END-IF\n              WHEN OTHER\n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT\n                   MOVE '0001'         TO ABEND-CODE\n                   MOVE SPACES         TO ABEND-REASON\n                   MOVE 'UNEXPECTED DATA SCENARIO'\n                                       TO ABEND-MSG\n                   PERFORM ABEND-ROUTINE\n                      THRU ABEND-ROUTINE-EXIT\n           END-EVALUATE\n           .\n       2000-DECIDE-ACTION-EXIT.\n           EXIT\n           .\n\n\n\n       3000-SEND-MAP.\n           PERFORM 3100-SCREEN-INIT\n              THRU 3100-SCREEN-INIT-EXIT\n           PERFORM 3200-SETUP-SCREEN-VARS\n              THRU 3200-SETUP-SCREEN-VARS-EXIT\n           PERFORM 3250-SETUP-INFOMSG\n              THRU 3250-SETUP-INFOMSG-EXIT\n           PERFORM 3300-SETUP-SCREEN-ATTRS\n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT\n           PERFORM 3390-SETUP-INFOMSG-ATTRS\n              THRU 3390-SETUP-INFOMSG-ATTRS-EXIT\n           PERFORM 3400-SEND-SCREEN\n              THRU 3400-SEND-SCREEN-EXIT\n           .\n\n       3000-SEND-MAP-EXIT.\n           EXIT\n           .\n\n       3100-SCREEN-INIT.\n           MOVE LOW-VALUES TO CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01              TO TITLE01O OF CACTUPAO\n           MOVE CCDA-TITLE02              TO TITLE02O OF CACTUPAO\n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CACTUPAO\n           MOVE LIT-THISPGM               TO PGMNAMEO OF CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CACTUPAO\n\n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CACTUPAO\n\n           .\n\n       3100-SCREEN-INIT-EXIT.\n           EXIT\n           .\n\n       3200-SETUP-SCREEN-VARS.\n      *    INITIALIZE SEARCH CRITERIA\n           IF CDEMO-PGM-ENTER\n              CONTINUE\n           ELSE\n              IF CC-ACCT-ID-N = 0\n              AND FLG-ACCTFILTER-ISVALID\n                 MOVE LOW-VALUES                TO ACCTSIDO OF CACTUPAO\n              ELSE\n                 MOVE CC-ACCT-ID                TO ACCTSIDO OF CACTUPAO\n              END-IF\n\n              EVALUATE TRUE\n                WHEN ACUP-DETAILS-NOT-FETCHED\n                WHEN CC-ACCT-ID-N =  0\n                  PERFORM 3201-SHOW-INITIAL-VALUES\n                     THRU 3201-SHOW-INITIAL-VALUES-EXIT\n               WHEN ACUP-SHOW-DETAILS\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n               WHEN ACUP-CHANGES-MADE\n                  PERFORM 3203-SHOW-UPDATED-VALUES\n                     THRU 3203-SHOW-UPDATED-VALUES-EXIT\n               WHEN OTHER\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n              END-EVALUATE\n            END-IF\n           .\n       3200-SETUP-SCREEN-VARS-EXIT.\n           EXIT\n           .\n\n       3201-SHOW-INITIAL-VALUES.\n           MOVE LOW-VALUES                     TO  ACSTTUSO OF CACTUPAO\n                                                   ACRDLIMO OF CACTUPAO\n      *Account Limits\n                                                   ACURBALO OF CACTUPAO\n                                                   ACSHLIMO OF CACTUPAO\n                                                   ACRCYCRO OF CACTUPAO\n                                                   ACRCYDBO OF CACTUPAO\n      *Account Dates\n                                                   OPNYEARO OF CACTUPAO\n                                                   OPNMONO  OF CACTUPAO\n                                                   OPNDAYO  OF CACTUPAO\n                                                   EXPYEARO OF CACTUPAO\n                                                   EXPMONO  OF CACTUPAO\n                                                   EXPDAYO  OF CACTUPAO\n                                                   RISYEARO OF CACTUPAO\n                                                   RISMONO  OF CACTUPAO\n                                                   RISDAYO  OF CACTUPAO\n                                                   AADDGRPO OF CACTUPAO\n      *Customer data\n                                                   ACSTNUMO OF CACTUPAO\n                                                   ACTSSN1O OF CACTUPAO\n                                                   ACTSSN2O OF CACTUPAO\n                                                   ACTSSN3O OF CACTUPAO\n                                                   ACSTFCOO OF CACTUPAO\n                                                   DOBYEARO OF CACTUPAO\n                                                   DOBMONO  OF CACTUPAO\n                                                   DOBDAYO  OF CACTUPAO\n                                                   ACSFNAMO OF CACTUPAO\n                                                   ACSMNAMO OF CACTUPAO\n                                                   ACSLNAMO OF CACTUPAO\n      *Customer address and contact info\n                                                   ACSADL1O OF CACTUPAO\n                                                   ACSADL2O OF CACTUPAO\n                                                   ACSCITYO OF CACTUPAO\n                                                   ACSSTTEO OF CACTUPAO\n                                                   ACSZIPCO OF CACTUPAO\n                                                   ACSCTRYO OF CACTUPAO\n\n                                                   ACSPH1AO OF CACTUPAO\n                                                   ACSPH1BO OF CACTUPAO\n                                                   ACSPH1CO OF CACTUPAO\n                                                   ACSPH2AO OF CACTUPAO\n                                                   ACSPH2BO OF CACTUPAO\n                                                   ACSPH2CO OF CACTUPAO\n\n      *Customer other good stuff\n                                                   ACSGOVTO OF CACTUPAO\n                                                   ACSEFTCO OF CACTUPAO\n                                                   ACSPFLGO OF CACTUPAO\n           .\n\n       3201-SHOW-INITIAL-VALUES-EXIT.\n           EXIT\n           .\n\n       3202-SHOW-ORIGINAL-VALUES.\n\n           MOVE LOW-VALUES                     TO WS-NON-KEY-FLAGS\n\n           SET PROMPT-FOR-CHANGES              TO TRUE\n\n           IF FOUND-ACCT-IN-MASTER\n           OR FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-ACTIVE-STATUS      TO ACSTTUSO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n\n              MOVE ACUP-OLD-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n\n              MOVE ACUP-OLD-OPEN-YEAR          TO OPNYEARO OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-MON           TO OPNMONO  OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-DAY           TO OPNDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-EXP-YEAR           TO EXPYEARO OF CACTUPAO\n              MOVE ACUP-OLD-EXP-MON            TO EXPMONO  OF CACTUPAO\n              MOVE ACUP-OLD-EXP-DAY            TO EXPDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-REISSUE-YEAR       TO RISYEARO OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-MON        TO RISMONO  OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-DAY        TO RISDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-GROUP-ID           TO AADDGRPO OF CACTUPAO\n           END-IF\n\n           IF FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-CUST-ID-X          TO ACSTNUMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(1:3)    TO ACTSSN1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(4:2)    TO ACTSSN2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(6:4)    TO ACTSSN3O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FICO-SCORE-X  TO ACSTFCOO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-YEAR      TO DOBYEARO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-MON       TO DOBMONO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-DAY       TO DOBDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FIRST-NAME    TO ACSFNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-MIDDLE-NAME   TO ACSMNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-LAST-NAME     TO ACSLNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-1   TO ACSADL1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-2   TO ACSADL2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-3   TO ACSCITYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-STATE-CD TO ACSSTTEO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-ZIP      TO ACSZIPCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-COUNTRY-CD\n                                               TO ACSCTRYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(2:3)\n                                               TO ACSPH1AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(6:3)\n                                               TO ACSPH1BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(10:4)\n                                               TO ACSPH1CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(2:3)\n                                               TO ACSPH2AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(6:3)\n                                               TO ACSPH2BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(10:4)\n                                               TO ACSPH2CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-GOVT-ISSUED-ID\n                                               TO ACSGOVTO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-EFT-ACCOUNT-ID\n                                               TO ACSEFTCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PRI-HOLDER-IND\n                                               TO ACSPFLGO OF CACTUPAO\n           END-IF\n           .\n\n       3202-SHOW-ORIGINAL-VALUES-EXIT.\n           EXIT\n           .\n       3203-SHOW-UPDATED-VALUES.\n\n           MOVE ACUP-NEW-ACTIVE-STATUS         TO ACSTTUSO OF CACTUPAO\n\n           IF FLG-CRED-LIMIT-ISVALID\n              MOVE ACUP-NEW-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CREDIT-LIMIT-X     TO ACRDLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CASH-CREDIT-LIMIT-ISVALID\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                               TO ACSHLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-BAL-ISVALID\n              MOVE ACUP-NEW-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-BAL-X         TO ACURBALO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-CREDIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-X  TO ACRCYCRO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-DEBIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-X   TO ACRCYDBO OF CACTUPAO\n           END-IF\n\n           MOVE ACUP-NEW-OPEN-YEAR             TO OPNYEARO OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-MON              TO OPNMONO  OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-DAY              TO OPNDAYO  OF CACTUPAO\n\n           MOVE ACUP-NEW-EXP-YEAR              TO EXPYEARO OF CACTUPAO\n           MOVE ACUP-NEW-EXP-MON               TO EXPMONO  OF CACTUPAO\n           MOVE ACUP-NEW-EXP-DAY               TO EXPDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-YEAR          TO RISYEARO OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-MON           TO RISMONO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-DAY           TO RISDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-GROUP-ID              TO AADDGRPO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ID-X             TO ACSTNUMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-1            TO ACTSSN1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-2            TO ACTSSN2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-3            TO ACTSSN3O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X     TO ACSTFCOO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-YEAR         TO DOBYEARO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-MON          TO DOBMONO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-DAY          TO DOBDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FIRST-NAME       TO ACSFNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME      TO ACSMNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-LAST-NAME        TO ACSLNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1      TO ACSADL1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-2      TO ACSADL2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3      TO ACSCITYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD    TO ACSSTTEO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-ZIP         TO ACSZIPCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD  TO ACSCTRYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1A     TO ACSPH1AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1B     TO ACSPH1BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1C     TO ACSPH1CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2A     TO ACSPH2AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2B     TO ACSPH2BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2C     TO ACSPH2CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-GOVT-ISSUED-ID   TO ACSGOVTO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID   TO ACSEFTCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND   TO ACSPFLGO OF CACTUPAO\n\n           .\n\n       3203-SHOW-UPDATED-VALUES-EXIT.\n           EXIT\n           .\n\n       3250-SETUP-INFOMSG.\n      *    SETUP INFORMATION MESSAGE\n           EVALUATE TRUE\n               WHEN CDEMO-PGM-ENTER\n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE\n               WHEN ACUP-DETAILS-NOT-FETCHED\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n               WHEN ACUP-SHOW-DETAILS\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-NOT-OK\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE\n\n               WHEN ACUP-CHANGES-OKAYED-LOCK-ERROR\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-BUT-FAILED\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN WS-NO-INFO-MESSAGE\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n           END-EVALUATE\n\n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CACTUPAO\n\n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CACTUPAO\n           .\n       3250-SETUP-INFOMSG-EXIT.\n           EXIT\n           .\n       3300-SETUP-SCREEN-ATTRS.\n\n      *    PROTECT ALL FIELDS\n           PERFORM 3310-PROTECT-ALL-ATTRS\n              THRU 3310-PROTECT-ALL-ATTRS-EXIT\n\n      *    UNPROTECT BASED ON CONTEXT\n           EVALUATE TRUE\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      *            Make Account Id editable\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n              WHEN  ACUP-SHOW-DETAILS\n              WHEN  ACUP-CHANGES-NOT-OK\n                   PERFORM 3320-UNPROTECT-FEW-ATTRS\n                      THRU 3320-UNPROTECT-FEW-ATTRS-EXIT\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                   CONTINUE\n              WHEN OTHER\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n           END-EVALUATE\n\n      *    POSITION CURSOR - ORDER BASED ON SCREEN LOCATION\n           EVALUATE TRUE\n              WHEN FOUND-ACCOUNT-DATA\n              WHEN NO-CHANGES-DETECTED\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n              WHEN FLG-ACCTFILTER-NOT-OK\n              WHEN FLG-ACCTFILTER-BLANK\n                   MOVE -1             TO ACCTSIDL OF CACTUPAI\n      *    Account Status\n              WHEN FLG-ACCT-STATUS-NOT-OK\n              WHEN FLG-ACCT-STATUS-BLANK\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n      *    Open Year\n              WHEN FLG-OPEN-YEAR-NOT-OK\n              WHEN FLG-OPEN-YEAR-BLANK\n                  MOVE -1              TO OPNYEARL OF CACTUPAI\n      *    Open Month\n              WHEN FLG-OPEN-MONTH-NOT-OK\n              WHEN FLG-OPEN-MONTH-BLANK\n                  MOVE -1              TO OPNMONL  OF CACTUPAI\n      *    Open Day\n              WHEN FLG-OPEN-DAY-NOT-OK\n              WHEN FLG-OPEN-DAY-BLANK\n                  MOVE -1              TO OPNDAYL  OF CACTUPAI\n      *    Credit Limit\n              WHEN FLG-CRED-LIMIT-NOT-OK\n              WHEN FLG-CRED-LIMIT-BLANK\n                  MOVE -1              TO ACRDLIML OF CACTUPAI\n      *    Expiry Year\n              WHEN FLG-EXPIRY-YEAR-NOT-OK\n              WHEN FLG-EXPIRY-YEAR-BLANK\n                  MOVE -1              TO EXPYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-EXPIRY-MONTH-NOT-OK\n              WHEN FLG-EXPIRY-MONTH-BLANK\n                  MOVE -1              TO EXPMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-EXPIRY-DAY-NOT-OK\n              WHEN FLG-EXPIRY-DAY-BLANK\n                  MOVE -1              TO EXPDAYL  OF CACTUPAI\n      *    Cash credit limit\n              WHEN FLG-CASH-CREDIT-LIMIT-NOT-OK\n              WHEN FLG-CASH-CREDIT-LIMIT-BLANK\n                  MOVE -1              TO ACSHLIML OF CACTUPAI\n      *    Reissue Year\n              WHEN FLG-REISSUE-YEAR-NOT-OK\n              WHEN FLG-REISSUE-YEAR-BLANK\n                  MOVE -1              TO RISYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-REISSUE-MONTH-NOT-OK\n              WHEN FLG-REISSUE-MONTH-BLANK\n                  MOVE -1              TO RISMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-REISSUE-DAY-NOT-OK\n              WHEN FLG-REISSUE-DAY-BLANK\n                  MOVE -1              TO RISDAYL  OF CACTUPAI\n\n      *    Current Balance\n              WHEN FLG-CURR-BAL-NOT-OK\n              WHEN FLG-CURR-BAL-BLANK\n                  MOVE -1              TO ACURBALL OF CACTUPAI\n      *    Current Cycle Credit\n              WHEN FLG-CURR-CYC-CREDIT-NOT-OK\n              WHEN FLG-CURR-CYC-CREDIT-BLANK\n                  MOVE -1              TO ACRCYCRL OF CACTUPAI\n      *    Current Cycle Debit\n              WHEN FLG-CURR-CYC-DEBIT-NOT-OK\n              WHEN FLG-CURR-CYC-DEBIT-BLANK\n                  MOVE -1              TO ACRCYDBL OF CACTUPAI\n      *    SSN Part 1\n              WHEN FLG-EDIT-US-SSN-PART1-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART1-BLANK\n                  MOVE -1              TO ACTSSN1L OF CACTUPAI\n      *    SSN Part 2\n              WHEN FLG-EDIT-US-SSN-PART2-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART2-BLANK\n                  MOVE -1              TO ACTSSN2L  OF CACTUPAI\n      *    SSN Part 3\n              WHEN FLG-EDIT-US-SSN-PART3-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART3-BLANK\n                  MOVE -1              TO ACTSSN3L  OF CACTUPAI\n      *    Date of Birth Year\n              WHEN FLG-DT-OF-BIRTH-YEAR-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-YEAR-BLANK\n                  MOVE -1              TO DOBYEARL OF CACTUPAI\n      *    Date of Birth Month\n              WHEN FLG-DT-OF-BIRTH-MONTH-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-MONTH-BLANK\n                  MOVE -1              TO DOBMONL  OF CACTUPAI\n      *    Date of Birth Day\n              WHEN FLG-DT-OF-BIRTH-DAY-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-DAY-BLANK\n                  MOVE -1              TO DOBDAYL  OF CACTUPAI\n      *    FICO Score\n              WHEN FLG-FICO-SCORE-NOT-OK\n              WHEN FLG-FICO-SCORE-BLANK\n                  MOVE -1              TO ACSTFCOL OF CACTUPAI\n      *    First Name\n              WHEN FLG-FIRST-NAME-NOT-OK\n              WHEN FLG-FIRST-NAME-BLANK\n                  MOVE -1              TO ACSFNAML OF CACTUPAI\n      *    Middle Name\n              WHEN FLG-MIDDLE-NAME-NOT-OK\n                  MOVE -1              TO ACSMNAML OF CACTUPAI\n      *    Last Name\n              WHEN FLG-LAST-NAME-NOT-OK\n              WHEN FLG-LAST-NAME-BLANK\n                  MOVE -1              TO ACSLNAML OF CACTUPAI\n      *    Address Line 1\n              WHEN FLG-ADDRESS-LINE-1-NOT-OK\n              WHEN FLG-ADDRESS-LINE-1-BLANK\n                  MOVE -1              TO ACSADL1L OF CACTUPAI\n      *    State (appears next to Line 2 on screen before city)\n              WHEN FLG-STATE-NOT-OK\n              WHEN FLG-STATE-BLANK\n                  MOVE -1              TO ACSSTTEL OF CACTUPAI\n      *    Address Line 2 has no edits\n      *    Zip code\n              WHEN FLG-ZIPCODE-NOT-OK\n              WHEN FLG-ZIPCODE-BLANK\n                  MOVE -1              TO ACSZIPCL OF CACTUPAI\n      *    Address Line 3 (City)\n              WHEN FLG-CITY-NOT-OK\n              WHEN FLG-CITY-BLANK\n                  MOVE -1              TO ACSCITYL OF CACTUPAI\n      *    Country edits.\n              WHEN FLG-COUNTRY-NOT-OK\n              WHEN FLG-COUNTRY-BLANK\n                  MOVE -1              TO ACSCTRYL OF CACTUPAI\n      *    Phone 1\n              WHEN FLG-PHONE-NUM-1A-NOT-OK\n              WHEN FLG-PHONE-NUM-1A-BLANK\n                  MOVE -1              TO ACSPH1AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1B-NOT-OK\n              WHEN FLG-PHONE-NUM-1B-BLANK\n                  MOVE -1              TO ACSPH1BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1C-NOT-OK\n              WHEN FLG-PHONE-NUM-1C-BLANK\n                  MOVE -1              TO ACSPH1CL OF CACTUPAI\n      *    Phone 2\n              WHEN FLG-PHONE-NUM-2A-NOT-OK\n              WHEN FLG-PHONE-NUM-2A-BLANK\n                  MOVE -1              TO ACSPH2AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2B-NOT-OK\n              WHEN FLG-PHONE-NUM-2B-BLANK\n                  MOVE -1              TO ACSPH2BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2C-NOT-OK\n              WHEN FLG-PHONE-NUM-2C-BLANK\n                  MOVE -1              TO ACSPH2CL OF CACTUPAI\n      *    EFT Account Id\n              WHEN FLG-EFT-ACCOUNT-ID-NOT-OK\n              WHEN FLG-EFT-ACCOUNT-ID-BLANK\n                  MOVE -1              TO ACSEFTCL OF CACTUPAI\n      *    Primary Card Holder\n              WHEN FLG-PRI-CARDHOLDER-NOT-OK\n              WHEN FLG-PRI-CARDHOLDER-BLANK\n                  MOVE -1              TO ACSPFLGL OF CACTUPAI\n              WHEN OTHER\n                  MOVE -1              TO ACCTSIDL OF CACTUPAI\n            END-EVALUATE\n\n\n      *    SETUP COLOR\n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n              MOVE DFHDFCOL            TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n      *    Account Filter\n           IF FLG-ACCTFILTER-NOT-OK\n              MOVE DFHRED              TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF  FLG-ACCTFILTER-BLANK\n           AND CDEMO-PGM-REENTER\n               MOVE '*'                TO ACCTSIDO OF CACTUPAO\n               MOVE DFHRED             TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n           OR FLG-ACCTFILTER-BLANK\n           OR FLG-ACCTFILTER-NOT-OK\n              GO TO 3300-SETUP-SCREEN-ATTRS-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      ******************************************************************\n      *    Using Copy replacing to set attribs for remaining vars\n      *    Write specific code only if rules differ\n      ******************************************************************\n      *    IF (FLG-ACCT-STATUS-NOT-OK\n      *    OR  FLG-ACCT-STATUS-BLANK)\n      *    AND CDEMO-PGM-REENTER\n      *        MOVE DFHRED             TO ACSTTUSC OF CACTUPAO\n      *        IF  FLG-ACCT-STATUS-BLANK\n      *            MOVE '*'            TO ACSTTUSO OF CACTUPAO\n      *        END-IF\n      *    END-IF\n\n      *    Account Status\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ACCT-STATUS==\n             ==(SCRNVAR2)== BY ==ACSTTUS==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-YEAR==\n             ==(SCRNVAR2)== BY ==OPNYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-MONTH==\n             ==(SCRNVAR2)== BY ==OPNMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-DAY==\n             ==(SCRNVAR2)== BY ==OPNDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CRED-LIMIT==\n             ==(SCRNVAR2)== BY ==ACRDLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-YEAR==\n             ==(SCRNVAR2)== BY ==EXPYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-MONTH==\n             ==(SCRNVAR2)== BY ==EXPMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-DAY==\n             ==(SCRNVAR2)== BY ==EXPDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Cash Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CASH-CREDIT-LIMIT==\n             ==(SCRNVAR2)== BY ==ACSHLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-YEAR==\n             ==(SCRNVAR2)== BY ==RISYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-MONTH==\n             ==(SCRNVAR2)== BY ==RISMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-DAY==\n             ==(SCRNVAR2)== BY ==RISDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Balance\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-BAL==\n             ==(SCRNVAR2)== BY ==ACURBAL==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Credit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-CREDIT==\n             ==(SCRNVAR2)== BY ==ACRCYCR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Debit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-DEBIT==\n             ==(SCRNVAR2)== BY ==ACRCYDB==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART1==\n             ==(SCRNVAR2)== BY ==ACTSSN1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 2\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART2==\n             ==(SCRNVAR2)== BY ==ACTSSN2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 3\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART3==\n             ==(SCRNVAR2)== BY ==ACTSSN3==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-YEAR==\n             ==(SCRNVAR2)== BY ==DOBYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-MONTH==\n             ==(SCRNVAR2)== BY ==DOBMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-DAY==\n             ==(SCRNVAR2)== BY ==DOBDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    FICO Score\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FICO-SCORE==\n             ==(SCRNVAR2)== BY ==ACSTFCO==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    First Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FIRST-NAME==\n             ==(SCRNVAR2)== BY ==ACSFNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Middle Name (no edits coded)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==MIDDLE-NAME==\n             ==(SCRNVAR2)== BY ==ACSMNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Last Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==LAST-NAME==\n             ==(SCRNVAR2)== BY ==ACSLNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-1==\n             ==(SCRNVAR2)== BY ==ACSADL1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==STATE==\n             ==(SCRNVAR2)== BY ==ACSSTTE==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 2 (NO EDITS CODED AS YET)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-2==\n             ==(SCRNVAR2)== BY ==ACSADL2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ZIPCODE==\n             ==(SCRNVAR2)== BY ==ACSZIPC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    City\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CITY==\n             ==(SCRNVAR2)== BY ==ACSCITY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Country\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==COUNTRY==\n             ==(SCRNVAR2)== BY ==ACSCTRY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1A==\n             ==(SCRNVAR2)== BY ==ACSPH1A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1B==\n             ==(SCRNVAR2)== BY ==ACSPH1B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 1 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1C==\n             ==(SCRNVAR2)== BY ==ACSPH1C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2A==\n             ==(SCRNVAR2)== BY ==ACSPH2A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2B==\n             ==(SCRNVAR2)== BY ==ACSPH2B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 2 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2C==\n             ==(SCRNVAR2)== BY ==ACSPH2C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    EFT Account Id\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PRI-CARDHOLDER==\n             ==(SCRNVAR2)== BY ==ACSPFLG==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Primary Card Holder\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EFT-ACCOUNT-ID==\n             ==(SCRNVAR2)== BY ==ACSEFTC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n           .\n       3300-SETUP-SCREEN-ATTRS-EXIT.\n           EXIT\n           .\n\n       3310-PROTECT-ALL-ATTRS.\n           MOVE DFHBMPRF              TO ACCTSIDA OF CACTUPAI\n                                         ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n                                         ACSTNUMA OF CACTUPAI\n                                         ACTSSN1A OF CACTUPAI\n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n                                         ACSCTRYA OF CACTUPAI\n\n                                         ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n                                         ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n                                         INFOMSGA OF CACTUPAI\n           .\n       3310-PROTECT-ALL-ATTRS-EXIT.\n           EXIT\n           .\n\n       3320-UNPROTECT-FEW-ATTRS.\n\n           MOVE DFHBMFSE              TO ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n      *Open Date\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n      *Expiry date\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n      *Reissue date\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n            MOVE DFHBMPRF            TO  ACSTNUMA OF CACTUPAI\n            MOVE DFHBMFSE            TO  ACTSSN1A OF CACTUPAI         \n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n      *Since most of the edits are USA specific protected country\n           MOVE DFHBMPRF              TO ACSCTRYA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n           MOVE DFHBMPRF              TO INFOMSGA OF CACTUPAI\n           .\n       3320-UNPROTECT-FEW-ATTRS-EXIT.\n           EXIT\n           .\n\n       3390-SETUP-INFOMSG-ATTRS.\n           IF  WS-NO-INFO-MESSAGE\n               MOVE DFHBMDAR           TO INFOMSGA OF CACTUPAI\n           ELSE\n               MOVE DFHBMASB           TO INFOMSGA OF CACTUPAI\n           END-IF\n\n           IF ACUP-CHANGES-MADE\n           AND NOT ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           IF PROMPT-FOR-CONFIRMATION\n               MOVE DFHBMASB           TO FKEY05A  OF CACTUPAI\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           .\n       3390-SETUP-INFOMSG-ATTRS-EXIT.\n           EXIT\n           .\n\n\n       3400-SEND-SCREEN.\n\n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP\n\n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)\n                          MAPSET(CCARD-NEXT-MAPSET)\n                          FROM(CACTUPAO)\n                          CURSOR\n                          ERASE\n                          FREEKB\n                          RESP(WS-RESP-CD)\n           END-EXEC\n           .\n       3400-SEND-SCREEN-EXIT.\n           EXIT\n           .\n\n\n       9000-READ-ACCT.\n\n           INITIALIZE ACUP-OLD-DETAILS\n\n           SET  WS-NO-INFO-MESSAGE      TO TRUE\n\n           MOVE CC-ACCT-ID              TO ACUP-OLD-ACCT-ID\n                                           WS-CARD-RID-ACCT-ID\n\n           PERFORM 9200-GETCARDXREF-BYACCT\n              THRU 9200-GETCARDXREF-BYACCT-EXIT\n\n           IF FLG-ACCTFILTER-NOT-OK\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           PERFORM 9300-GETACCTDATA-BYACCT\n              THRU 9300-GETACCTDATA-BYACCT-EXIT\n\n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID\n\n           PERFORM 9400-GETCUSTDATA-BYCUST\n              THRU 9400-GETCUSTDATA-BYCUST-EXIT\n\n           IF DID-NOT-FIND-CUST-IN-CUSTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n\n\n           PERFORM 9500-STORE-FETCHED-DATA\n              THRU 9500-STORE-FETCHED-DATA-EXIT\n           .\n\n\n       9000-READ-ACCT-EXIT.\n           EXIT\n           .\n       9200-GETCARDXREF-BYACCT.\n\n      *    Read the Card file. Access via alternate index ACCTID\n      *\n           EXEC CICS READ\n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID\n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Cross ref file.  Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *          PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n       9200-GETCARDXREF-BYACCT-EXIT.\n           EXIT\n           .\n       9300-GETACCTDATA-BYACCT.\n\n           EXEC CICS READ\n                DATASET   (LIT-ACCTFILENAME)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-ACCT-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Acct Master file.Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n      *\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n       9300-GETACCTDATA-BYACCT-EXIT.\n           EXIT\n           .\n\n       9400-GETCUSTDATA-BYCUST.\n           EXEC CICS READ\n                DATASET   (LIT-CUSTFILENAME)\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-CUST-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE\n                  MOVE WS-RESP-CD               TO ERROR-RESP\n                  MOVE WS-REAS-CD               TO ERROR-RESP2\n                  IF WS-RETURN-MSG-OFF\n                    STRING\n                    'CustId:'\n                     WS-CARD-RID-CUST-ID-X\n                    ' not found'\n                    ' in customer master.Resp: '\n                    ERROR-RESP\n                    ' REAS:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n       9400-GETCUSTDATA-BYCUST-EXIT.\n           EXIT\n           .\n\n       9500-STORE-FETCHED-DATA.\n\n      *    Store Context in Commarea\n      *\n           MOVE ACCT-ID                   TO CDEMO-ACCT-ID\n           MOVE CUST-ID                   TO CDEMO-CUST-ID\n           MOVE CUST-FIRST-NAME           TO CDEMO-CUST-FNAME\n           MOVE CUST-MIDDLE-NAME          TO CDEMO-CUST-MNAME\n           MOVE CUST-LAST-NAME            TO CDEMO-CUST-LNAME\n           MOVE ACCT-ACTIVE-STATUS        TO CDEMO-ACCT-STATUS\n           MOVE XREF-CARD-NUM             TO CDEMO-CARD-NUM\n\n           INITIALIZE ACUP-OLD-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACCT-ID                  TO ACUP-OLD-ACCT-ID\n      * Active Status\n           MOVE ACCT-ACTIVE-STATUS       TO ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACCT-CURR-BAL            TO ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           MOVE ACCT-CREDIT-LIMIT        TO ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           MOVE ACCT-CASH-CREDIT-LIMIT   TO ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           MOVE ACCT-CURR-CYC-CREDIT     TO ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           MOVE ACCT-CURR-CYC-DEBIT      TO ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n      *    MOVE ACCT-OPEN-DATE           TO ACUP-OLD-OPEN-DATE\n           MOVE ACCT-OPEN-DATE(1:4)      TO ACUP-OLD-OPEN-YEAR\n           MOVE ACCT-OPEN-DATE(6:2)      TO ACUP-OLD-OPEN-MON\n           MOVE ACCT-OPEN-DATE(9:2)      TO ACUP-OLD-OPEN-DAY\n      * Expiry date\n      *    MOVE ACCT-EXPIRAION-DATE      TO ACUP-OLD-EXPIRAION-DATE\n           MOVE ACCT-EXPIRAION-DATE(1:4) TO ACUP-OLD-EXP-YEAR\n           MOVE ACCT-EXPIRAION-DATE(6:2) TO ACUP-OLD-EXP-MON\n           MOVE ACCT-EXPIRAION-DATE(9:2) TO ACUP-OLD-EXP-DAY\n\n      * Reissue date\n      *    MOVE ACCT-REISSUE-DATE        TO ACUP-OLD-REISSUE-DATE\n           MOVE ACCT-REISSUE-DATE(1:4)   TO ACUP-OLD-REISSUE-YEAR\n           MOVE ACCT-REISSUE-DATE(6:2)   TO ACUP-OLD-REISSUE-MON\n           MOVE ACCT-REISSUE-DATE(9:2)   TO ACUP-OLD-REISSUE-DAY\n      * Account Group\n           MOVE ACCT-GROUP-ID            TO ACUP-OLD-GROUP-ID\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n           MOVE CUST-ID                  TO ACUP-OLD-CUST-ID\n      *Social Security Number\n           MOVE CUST-SSN                 TO ACUP-OLD-CUST-SSN\n      *Date of birth\n      *    MOVE CUST-DOB-YYYY-MM-DD      TO ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           MOVE CUST-DOB-YYYY-MM-DD(1:4) TO ACUP-OLD-CUST-DOB-YEAR\n           MOVE CUST-DOB-YYYY-MM-DD(6:2) TO ACUP-OLD-CUST-DOB-MON\n           MOVE CUST-DOB-YYYY-MM-DD(9:2) TO ACUP-OLD-CUST-DOB-DAY\n      *FICO\n           MOVE CUST-FICO-CREDIT-SCORE   TO ACUP-OLD-CUST-FICO-SCORE\n      *First Name\n           MOVE CUST-FIRST-NAME          TO ACUP-OLD-CUST-FIRST-NAME\n      *Middle Name\n           MOVE CUST-MIDDLE-NAME         TO ACUP-OLD-CUST-MIDDLE-NAME\n      *Last Name\n           MOVE CUST-LAST-NAME           TO ACUP-OLD-CUST-LAST-NAME\n      *Address\n           MOVE CUST-ADDR-LINE-1         TO ACUP-OLD-CUST-ADDR-LINE-1\n           MOVE CUST-ADDR-LINE-2         TO ACUP-OLD-CUST-ADDR-LINE-2\n           MOVE CUST-ADDR-LINE-3         TO ACUP-OLD-CUST-ADDR-LINE-3\n           MOVE CUST-ADDR-STATE-CD       TO ACUP-OLD-CUST-ADDR-STATE-CD\n           MOVE CUST-ADDR-COUNTRY-CD     TO\n                                          ACUP-OLD-CUST-ADDR-COUNTRY-CD\n           MOVE CUST-ADDR-ZIP            TO ACUP-OLD-CUST-ADDR-ZIP\n           MOVE CUST-PHONE-NUM-1         TO ACUP-OLD-CUST-PHONE-NUM-1\n           MOVE CUST-PHONE-NUM-2         TO ACUP-OLD-CUST-PHONE-NUM-2\n      *Government Id\n           MOVE CUST-GOVT-ISSUED-ID      TO ACUP-OLD-CUST-GOVT-ISSUED-ID\n      *EFT Code\n           MOVE CUST-EFT-ACCOUNT-ID      TO ACUP-OLD-CUST-EFT-ACCOUNT-ID\n      *Primary Holder Indicator\n           MOVE CUST-PRI-CARD-HOLDER-IND TO ACUP-OLD-CUST-PRI-HOLDER-IND\n           .\n       9500-STORE-FETCHED-DATA-EXIT.\n           EXIT\n           .\n       9600-WRITE-PROCESSING.\n\n      *    Read the account file for update\n\n           MOVE CC-ACCT-ID              TO WS-CARD-RID-ACCT-ID\n\n           EXEC CICS READ\n                FILE      (LIT-ACCTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the account record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-ACCT-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *    Read the customer file for update\n\n           MOVE CDEMO-CUST-ID                   TO WS-CARD-RID-CUST-ID\n\n           EXEC CICS READ\n                FILE      (LIT-CUSTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the customer record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-CUST-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *****************************************************************\n      *    Did someone change the record while we were out ?\n      *****************************************************************\n           PERFORM 9700-CHECK-CHANGE-IN-REC\n              THRU 9700-CHECK-CHANGE-IN-REC-EXIT\n\n           IF DATA-WAS-CHANGED-BEFORE-UPDATE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Prepare the update\n      *****************************************************************\n           INITIALIZE ACCT-UPDATE-RECORD\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACUP-NEW-ACCT-ID         TO ACCT-UPDATE-ID\n      * Active Status\n           MOVE ACUP-NEW-ACTIVE-STATUS   TO ACCT-UPDATE-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACUP-NEW-CURR-BAL-N      TO ACCT-UPDATE-CURR-BAL\n      * Credit Limit\n           MOVE ACUP-NEW-CREDIT-LIMIT-N  TO ACCT-UPDATE-CREDIT-LIMIT\n      * Cash Limit\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                      TO ACCT-UPDATE-CASH-CREDIT-LIMIT\n      * Current Cycle Credit\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-N\n                                          TO ACCT-UPDATE-CURR-CYC-CREDIT\n      * Current Cycle Debit\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-N TO ACCT-UPDATE-CURR-CYC-DEBIT\n      * Open date\n           STRING ACUP-NEW-OPEN-YEAR\n                  '-'\n                  ACUP-NEW-OPEN-MON\n                  '-'\n                  ACUP-NEW-OPEN-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-OPEN-DATE\n      * Expiry date\n           STRING ACUP-NEW-EXP-YEAR\n                  '-'\n                  ACUP-NEW-EXP-MON\n                  '-'\n                  ACUP-NEW-EXP-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-EXPIRAION-DATE\n\n      * Reissue date\n           MOVE ACCT-REISSUE-DATE        TO ACCT-UPDATE-REISSUE-DATE\n           STRING ACUP-NEW-REISSUE-YEAR\n                  '-'\n                  ACUP-NEW-REISSUE-MON\n                  '-'\n                  ACUP-NEW-REISSUE-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-REISSUE-DATE\n      * Account Group\n           MOVE ACUP-NEW-GROUP-ID        TO ACCT-UPDATE-GROUP-ID\n\n      ******************************************************************\n      *    Customer data\n      ******************************************************************\n           INITIALIZE CUST-UPDATE-RECORD\n\n           MOVE  ACUP-NEW-CUST-ID        TO CUST-UPDATE-ID\n           MOVE  ACUP-NEW-CUST-FIRST-NAME\n                                   TO CUST-UPDATE-FIRST-NAME\n           MOVE  ACUP-NEW-CUST-MIDDLE-NAME\n                                   TO CUST-UPDATE-MIDDLE-NAME\n           MOVE  ACUP-NEW-CUST-LAST-NAME TO CUST-UPDATE-LAST-NAME\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-1\n                                   TO CUST-UPDATE-ADDR-LINE-1\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-2\n                                   TO CUST-UPDATE-ADDR-LINE-2\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-3\n                                   TO CUST-UPDATE-ADDR-LINE-3\n           MOVE  ACUP-NEW-CUST-ADDR-STATE-CD\n                                   TO CUST-UPDATE-ADDR-STATE-CD\n           MOVE  ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                   TO CUST-UPDATE-ADDR-COUNTRY-CD\n           MOVE  ACUP-NEW-CUST-ADDR-ZIP  TO CUST-UPDATE-ADDR-ZIP\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-1A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-1B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-1C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-1\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-2A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-2B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-2C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-2\n\n\n           MOVE  ACUP-NEW-CUST-SSN       TO CUST-UPDATE-SSN\n           MOVE  ACUP-NEW-CUST-GOVT-ISSUED-ID\n                                   TO CUST-UPDATE-GOVT-ISSUED-ID\n           STRING ACUP-NEW-CUST-DOB-YEAR\n                  '-'\n                  ACUP-NEW-CUST-DOB-MON\n                  '-'\n                  ACUP-NEW-CUST-DOB-DAY\n           DELIMITED BY SIZE           INTO CUST-UPDATE-DOB-YYYY-MM-DD\n\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO CUST-UPDATE-EFT-ACCOUNT-ID\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO CUST-UPDATE-PRI-CARD-IND\n           MOVE ACUP-NEW-CUST-FICO-SCORE TO\n                                   CUST-UPDATE-FICO-CREDIT-SCORE\n      *****************************************************************\n      * Update account *\n      *****************************************************************\n\n\n           EXEC CICS\n                REWRITE FILE(LIT-ACCTFILENAME)\n                        FROM(ACCT-UPDATE-RECORD)\n                        LENGTH(LENGTH OF ACCT-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *\n      *****************************************************************\n      * Did account update succeed ?  *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Update customer *\n      *****************************************************************\n           EXEC CICS\n                        REWRITE FILE(LIT-CUSTFILENAME)\n                        FROM(CUST-UPDATE-RECORD)\n                        LENGTH(LENGTH OF CUST-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *****************************************************************\n      * Did customer update succeed ? *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             EXEC CICS\n                SYNCPOINT ROLLBACK\n             END-EXEC\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .\n       9600-WRITE-PROCESSING-EXIT.\n           EXIT\n           .\n\n       9700-CHECK-CHANGE-IN-REC.\n\n\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCT-ACTIVE-STATUS      EQUAL ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           AND ACCT-CURR-BAL           EQUAL ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           AND ACCT-CREDIT-LIMIT       EQUAL ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           AND ACCT-CASH-CREDIT-LIMIT EQUAL ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           AND ACCT-CURR-CYC-CREDIT    EQUAL ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           AND ACCT-CURR-CYC-DEBIT     EQUAL ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n           AND ACCT-OPEN-DATE(1:4)     EQUAL ACUP-OLD-OPEN-YEAR\n           AND ACCT-OPEN-DATE(6:2)     EQUAL ACUP-OLD-OPEN-MON\n           AND ACCT-OPEN-DATE(9:2)     EQUAL ACUP-OLD-OPEN-DAY\n      * Expiry date\n           AND ACCT-EXPIRAION-DATE(1:4)EQUAL ACUP-OLD-EXP-YEAR\n           AND ACCT-EXPIRAION-DATE(6:2)EQUAL ACUP-OLD-EXP-MON\n           AND ACCT-EXPIRAION-DATE(9:2)EQUAL ACUP-OLD-EXP-DAY\n      * Reissue date\n           AND ACCT-REISSUE-DATE(1:4)  EQUAL ACUP-OLD-REISSUE-YEAR\n           AND ACCT-REISSUE-DATE(6:2)  EQUAL ACUP-OLD-REISSUE-MON\n           AND ACCT-REISSUE-DATE(9:2)  EQUAL ACUP-OLD-REISSUE-DAY\n      * Account Group\n           AND FUNCTION LOWER-CASE (ACCT-GROUP-ID)           EQUAL\n               FUNCTION LOWER-CASE (ACUP-OLD-GROUP-ID)\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      ******************************************************************\n      *    Customer  data - Split into 2 IFs for easier reading\n      *    And maybe put logic to update only 1 file if only date\n      *    pertaining to one of them is updated\n      ******************************************************************\n           IF  FUNCTION UPPER-CASE (CUST-FIRST-NAME          ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-FIRST-NAME )\n           AND FUNCTION UPPER-CASE (CUST-MIDDLE-NAME         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-MIDDLE-NAME)\n           AND FUNCTION UPPER-CASE (CUST-LAST-NAME           ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-LAST-NAME  )\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-1         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-1)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-2         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-2)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-3         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-3)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-STATE-CD       ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-STATE-CD)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-COUNTRY-CD     ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-COUNTRY-CD )\n           AND CUST-ADDR-ZIP           EQUAL ACUP-OLD-CUST-ADDR-ZIP\n           AND CUST-PHONE-NUM-1        EQUAL ACUP-OLD-CUST-PHONE-NUM-1\n           AND CUST-PHONE-NUM-2        EQUAL ACUP-OLD-CUST-PHONE-NUM-2\n           AND CUST-SSN                EQUAL ACUP-OLD-CUST-SSN\n           AND FUNCTION UPPER-CASE (CUST-GOVT-ISSUED-ID      ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-GOVT-ISSUED-ID )\n           AND CUST-DOB-YYYY-MM-DD (1:4)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (1:4)\n           AND CUST-DOB-YYYY-MM-DD (6:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (5:2)\n           AND CUST-DOB-YYYY-MM-DD (9:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (7:2)\n\n           AND CUST-EFT-ACCOUNT-ID     EQUAL\n                                            ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND CUST-PRI-CARD-HOLDER-IND\n                                       EQUAL\n                                            ACUP-OLD-CUST-PRI-HOLDER-IND\n           AND CUST-FICO-CREDIT-SCORE  EQUAL ACUP-OLD-CUST-FICO-SCORE\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .\n       9700-CHECK-CHANGE-IN-REC-EXIT.\n           EXIT\n           .\n      ******************************************************************\n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n\n       ABEND-ROUTINE.\n\n           IF ABEND-MSG EQUAL LOW-VALUES\n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG\n           END-IF\n\n           MOVE LIT-THISPGM       TO ABEND-CULPRIT\n\n           EXEC CICS SEND\n                            FROM (ABEND-DATA)\n                            LENGTH(LENGTH OF ABEND-DATA)\n                            NOHANDLE\n                            ERASE\n           END-EXEC\n\n           EXEC CICS HANDLE ABEND\n                CANCEL\n           END-EXEC\n\n           EXEC CICS ABEND\n                ABCODE('9999')\n           END-EXEC\n           .\n       ABEND-ROUTINE-EXIT.\n           EXIT\n           .\n      ******************************************************************\n      * Common Date Routines\n      ******************************************************************\n       COPY CSUTLDPY\n           .\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *"
      },
      "description": "This program, COACTUPC, is a business logic component of the CardDemo application that handles account updates. It allows users to view and modify account and customer information in a CICS environment. The program provides a comprehensive interface for updating various account details including credit limits, balances, dates, and customer information such as personal details, address, and contact information.\n\nThe program follows a structured workflow where it first receives and validates user input, then processes the data based on the current state of the transaction, and finally updates the relevant database records if changes are confirmed. It includes extensive validation logic for different data types including dates, currency amounts, phone numbers, SSNs, and address components.\n\nKey features include:\n- Account and customer data retrieval from multiple files (ACCTDAT, CUSTDAT, and card cross-reference files)\n- Comprehensive field-level validation with specific error messages\n- Change detection to prevent unnecessary updates\n- Record locking and transaction management to ensure data integrity\n- Support for various function keys to navigate the application workflow\n- Formatted display of account and customer information\n\nThe program handles various states of the update process, from initial data entry to confirmation and completion, with appropriate user prompts and feedback at each stage. It also includes error handling for database operations and validation failures.",
      "error_handling": null,
      "code": "      **************************************** *************************\n      * Program:     COACTUPC.CBL                                     *\n      * Layer:       Business logic                                   *\n      * Function:    Accept and process ACCOUNT UPDATE                *\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************      \n       IDENTIFICATION DIVISION.\n       PROGRAM-ID.\n           COACTUPC.\n       DATE-WRITTEN.\n           July 2022.\n       DATE-COMPILED.\n           Today.\n\n       ENVIRONMENT DIVISION.\n       INPUT-OUTPUT SECTION.\n\n       DATA DIVISION.\n\n       WORKING-STORAGE SECTION.\n       01  WS-MISC-STORAGE.\n      ******************************************************************\n      * General CICS related\n      ******************************************************************\n         05 WS-CICS-PROCESSNG-VARS.\n            07 WS-RESP-CD                          PIC S9(09) COMP\n                                                   VALUE ZEROS.\n            07 WS-REAS-CD                          PIC S9(09) COMP\n                                                   VALUE ZEROS.\n            07 WS-TRANID                           PIC X(4)\n                                                   VALUE SPACES.\n            07 WS-UCTRANS                          PIC X(4)\n                                                   VALUE SPACES.\n      ******************************************************************\n      *      Input edits\n      ******************************************************************\n      *  Generic Input Edits\n         05  WS-GENERIC-EDITS.\n           10 WS-EDIT-VARIABLE-NAME                PIC X(25).\n\n           10 WS-EDIT-SIGNED-NUMBER-9V2-X          PIC X(15).\n           10 WS-FLG-SIGNED-NUMBER-EDIT            PIC X(1).\n              88  FLG-SIGNED-NUMBER-ISVALID        VALUE LOW-VALUES.\n              88  FLG-SIGNED-NUMBER-NOT-OK         VALUE '0'.\n              88  FLG-SIGNED-NUMBER-BLANK          VALUE 'B'.\n\n           10 WS-EDIT-ALPHANUM-ONLY                PIC X(256).\n           10 WS-EDIT-ALPHANUM-LENGTH              PIC S9(4) COMP-3.\n\n           10 WS-EDIT-ALPHA-ONLY-FLAGS             PIC X(1).\n              88  FLG-ALPHA-ISVALID                VALUE LOW-VALUES.\n              88  FLG-ALPHA-NOT-OK                 VALUE '0'.\n              88  FLG-ALPHA-BLANK                  VALUE 'B'.\n           10 WS-EDIT-ALPHANUM-ONLY-FLAGS          PIC X(1).\n              88  FLG-ALPHNANUM-ISVALID            VALUE LOW-VALUES.\n              88  FLG-ALPHNANUM-NOT-OK             VALUE '0'.\n              88  FLG-ALPHNANUM-BLANK              VALUE 'B'.\n           10 WS-EDIT-MANDATORY-FLAGS              PIC X(1).\n              88  FLG-MANDATORY-ISVALID            VALUE LOW-VALUES.\n              88  FLG-MANDATORY-NOT-OK             VALUE '0'.\n              88  FLG-MANDATORY-BLANK              VALUE 'B'.\n           10 WS-EDIT-YES-NO                       PIC X(1)\n                                                   VALUE 'N'.\n              88 FLG-YES-NO-ISVALID                VALUES 'Y', 'N'.\n              88 FLG-YES-NO-NOT-OK                 VALUE '0'.\n              88 FLG-YES-NO-BLANK                  VALUE 'B'.\n\n           10 WS-EDIT-US-PHONE-NUM                 PIC X(15).\n           10 WS-EDIT-US-PHONE-NUM-X REDEFINES\n              WS-EDIT-US-PHONE-NUM.\n              20 FILLER                            PIC X(1).\n      *                                            VALUE '('\n              20 WS-EDIT-US-PHONE-NUMA             PIC X(3).\n              20 WS-EDIT-US-PHONE-NUMA-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMA             PIC 9(3).\n              20 FILLER                            PIC X(1).\n      *                                            VALUE ')'\n              20 WS-EDIT-US-PHONE-NUMB             PIC X(3).\n              20 WS-EDIT-US-PHONE-NUMB-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMB             PIC 9(3).\n              20 FILLER                            PIC X(1).\n      *                                            VALUE '-'\n              20 WS-EDIT-US-PHONE-NUMC             PIC X(4).\n              20 WS-EDIT-US-PHONE-NUMC-N REDEFINES\n                 WS-EDIT-US-PHONE-NUMC             PIC 9(4).\n              20 FILLER                            PIC X(2).\n           10 WS-EDIT-US-PHONE-NUM-FLGS.\n               88 WS-EDIT-US-PHONE-IS-INVALID      VALUE '000'.\n               88 WS-EDIT-US-PHONE-IS-VALID        VALUE LOW-VALUES.\n               20 WS-EDIT-US-PHONEA-FLG            PIC X(01).\n                  88 FLG-EDIT-US-PHONEA-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEA-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEA-BLANK      VALUE 'B'.\n               20 WS-EDIT-EDIT-US-PHONEB           PIC X(01).\n                  88 FLG-EDIT-US-PHONEB-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEB-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEB-BLANK      VALUE 'B'.\n               20 WS-EDIT-EDIT-PHONEC              PIC X(01).\n                  88 FLG-EDIT-US-PHONEC-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-PHONEC-NOT-OK     VALUE '0'.\n                  88 FLG-EDIT-US-PHONEC-BLANK      VALUE 'B'.\n\n           10 WS-EDIT-US-SSN.\n               20 WS-EDIT-US-SSN-PART1              PIC X(3).\n               20 WS-EDIT-US-SSN-PART1-N REDEFINES\n                  WS-EDIT-US-SSN-PART1              PIC 9(3).\n                  88 INVALID-SSN-PART1  VALUES      0,\n                                                    666,\n                                                    900 THRU 999.\n               20 WS-EDIT-US-SSN-PART2              PIC X(2).\n               20 WS-EDIT-US-SSN-PART2-N REDEFINES\n                  WS-EDIT-US-SSN-PART2              PIC 9(2).\n               20 WS-EDIT-US-SSN-PART3              PIC X(4).\n               20 WS-EDIT-US-SSN-PART3-N REDEFINES\n                  WS-EDIT-US-SSN-PART3              PIC 9(4).\n           10 WS-EDIT-US-SSN-N REDEFINES\n              WS-EDIT-US-SSN                        PIC 9(09).\n           10 WS-EDIT-US-SSN-FLGS.\n               88 WS-EDIT-US-SSN-IS-INVALID         VALUE '000'.\n               88 WS-EDIT-US-SSN-IS-VALID           VALUE LOW-VALUES.\n               20 WS-EDIT-US-SSN-PART1-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART1-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART1-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART1-BLANK    VALUE 'B'.\n               20 WS-EDIT-US-SSN-PART2-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART2-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART2-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART2-BLANK    VALUE 'B'.\n               20 WS-EDIT-US-SSN-PART3-FLGS         PIC X(01).\n                  88 FLG-EDIT-US-SSN-PART3-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-EDIT-US-SSN-PART3-NOT-OK   VALUE '0'.\n                  88 FLG-EDIT-US-SSN-PART3-BLANK    VALUE 'B'.\n\n      ******************************************************************\n      *    Work variables\n      ******************************************************************\n         05 WS-CALCULATION-VARS.\n          10 WS-DIV-BY                             PIC S9(4) COMP-3\n                                                   VALUE 4.\n          10 WS-DIVIDEND                           PIC S9(4) COMP-3\n                                                   VALUE 0.\n\n          10 WS-REMAINDER                          PIC S9(4) COMP-3\n                                                   VALUE 0.\n          10 WS-CURR-DATE                          PIC X(21)\n                                                   VALUE SPACES.\n\n\n      ******************************************************************\n      *    Generic date edit variables CCYYMMDD\n      ******************************************************************\n           COPY 'CSUTLDWY'.\n      ******************************************************************\n         05  WS-DATACHANGED-FLAG                   PIC X(1).\n           88  NO-CHANGES-FOUND                    VALUE '0'.\n           88  CHANGE-HAS-OCCURRED                 VALUE '1'.\n         05  WS-INPUT-FLAG                         PIC X(1).\n           88  INPUT-OK                            VALUE '0'.\n           88  INPUT-ERROR                         VALUE '1'.\n           88  INPUT-PENDING                       VALUE LOW-VALUES.\n         05  WS-RETURN-FLAG                        PIC X(1).\n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.\n           88  WS-RETURN-FLAG-ON                   VALUE '1'.\n         05  WS-PFK-FLAG                           PIC X(1).\n           88  PFK-VALID                           VALUE '0'.\n           88  PFK-INVALID                         VALUE '1'.\n\n      *  Program specific edits\n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).\n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.\n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.\n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.\n         05  WS-EDIT-CUST-FLAG                     PIC X(1).\n           88  FLG-CUSTFILTER-ISVALID              VALUE '1'.\n           88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.\n           88  FLG-CUSTFILTER-BLANK                VALUE ' '.\n         05 WS-NON-KEY-FLAGS.\n           10  WS-EDIT-ACCT-STATUS                 PIC  X(1).\n               88  FLG-ACCT-STATUS-ISVALID         VALUES 'Y', 'N'.\n               88  FLG-ACCT-STATUS-NOT-OK          VALUE '0'.\n               88  FLG-ACCT-STATUS-BLANK           VALUE 'B'.\n           10  WS-EDIT-CREDIT-LIMIT                PIC  X(1).\n               88  FLG-CRED-LIMIT-ISVALID          VALUE LOW-VALUES.\n               88  FLG-CRED-LIMIT-NOT-OK           VALUE '0'.\n               88  FLG-CRED-LIMIT-BLANK            VALUE 'B'.\n           10  WS-EDIT-CASH-CREDIT-LIMIT           PIC  X(1).\n               88  FLG-CASH-CREDIT-LIMIT-ISVALID   VALUE LOW-VALUES.\n               88  FLG-CASH-CREDIT-LIMIT-NOT-OK    VALUE '0'.\n               88  FLG-CASH-CREDIT-LIMIT-BLANK     VALUE 'B'.\n           10  WS-EDIT-CURR-BAL                    PIC  X(1).\n               88  FLG-CURR-BAL-ISVALID            VALUE LOW-VALUES.\n               88  FLG-CURR-BAL-NOT-OK             VALUE '0'.\n               88  FLG-CURR-BAL-BLANK              VALUE 'B'.\n           10  WS-EDIT-CURR-CYC-CREDIT             PIC  X(1).\n               88  FLG-CURR-CYC-CREDIT-ISVALID     VALUE LOW-VALUES.\n               88  FLG-CURR-CYC-CREDIT-NOT-OK      VALUE '0'.\n               88  FLG-CURR-CYC-CREDIT-BLANK       VALUE 'B'.\n           10  WS-EDIT-CURR-CYC-DEBIT              PIC  X(1).\n               88  FLG-CURR-CYC-DEBIT-ISVALID      VALUE LOW-VALUES.\n               88  FLG-CURR-CYC-DEBIT-NOT-OK       VALUE '0'.\n               88  FLG-CURR-CYC-DEBIT-BLANK        VALUE 'B'.\n           10 WS-EDIT-DT-OF-BIRTH-FLGS.\n               88 WS-EDIT-DT-OF-BIRTH-INVALID      VALUE '000'.\n               88 WS-EDIT-DT-OF-BIRTH-ISVALID      VALUE LOW-VALUES.\n               20 WS-EDIT-DT-OF-BIRTH-YEAR-FLG     PIC X(01).\n                  88 FLG-DT-OF-BIRTH-YEAR-ISVALID  VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-YEAR-NOT-OK   VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-YEAR-BLANK    VALUE 'B'.\n               20 WS-EDIT-DT-OF-BIRTH-MONTH        PIC X(01).\n                  88 FLG-DT-OF-BIRTH-MONTH-ISVALID VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-MONTH-NOT-OK  VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-MONTH-BLANK   VALUE 'B'.\n               20 WS-EDIT-DT-OF-BIRTH-DAY          PIC X(01).\n                  88 FLG-DT-OF-BIRTH-DAY-ISVALID   VALUE LOW-VALUES.\n                  88 FLG-DT-OF-BIRTH-DAY-NOT-OK    VALUE '0'.\n                  88 FLG-DT-OF-BIRTH-DAY-BLANK     VALUE 'B'.\n           10  WS-EDIT-FICO-SCORE-FLGS             PIC  X(1).\n               88  FLG-FICO-SCORE-ISVALID          VALUE LOW-VALUES.\n               88  FLG-FICO-SCORE-NOT-OK           VALUE '0'.\n               88  FLG-FICO-SCORE-BLANK            VALUE 'B'.\n           10 WS-EDIT-OPEN-DATE-FLGS.\n               88 WS-EDIT-OPEN-DATE-IS-INVALID     VALUE '000'.\n               20 WS-EDIT-OPEN-YEAR-FLG            PIC X(01).\n                  88 FLG-OPEN-YEAR-ISVALID         VALUE LOW-VALUES.\n                  88 FLG-OPEN-YEAR-NOT-OK          VALUE '0'.\n                  88 FLG-OPEN-YEAR-BLANK           VALUE 'B'.\n               20 WS-EDIT-OPEN-MONTH               PIC X(01).\n                  88 FLG-OPEN-MONTH-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-OPEN-MONTH-NOT-OK         VALUE '0'.\n                  88 FLG-OPEN-MONTH-BLANK          VALUE 'B'.\n               20 WS-EDIT-OPEN-DAY                 PIC X(01).\n                  88 FLG-OPEN-DAY-ISVALID          VALUE LOW-VALUES.\n                  88 FLG-OPEN-DAY-NOT-OK           VALUE '0'.\n                  88 FLG-OPEN-DAY-BLANK            VALUE 'B'.\n           10 WS-EXPIRY-DATE-FLGS.\n               88 WS-EDIT-EXPIRY-IS-INVALID        VALUE '000'.\n               20 WS-EDIT-EXPIRY-YEAR-FLG          PIC X(01).\n                  88 FLG-EXPIRY-YEAR-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-YEAR-NOT-OK        VALUE '0'.\n                  88 FLG-EXPIRY-YEAR-BLANK         VALUE 'B'.\n               20 WS-EDIT-EXPIRY-MONTH             PIC X(01).\n                  88 FLG-EXPIRY-MONTH-ISVALID      VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-MONTH-NOT-OK       VALUE '0'.\n                  88 FLG-EXPIRY-MONTH-BLANK        VALUE 'B'.\n               20 WS-EDIT-EXPIRY-DAY               PIC X(01).\n                  88 FLG-EXPIRY-DAY-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-EXPIRY-DAY-NOT-OK         VALUE '0'.\n                  88 FLG-EXPIRY-DAY-BLANK          VALUE 'B'.\n           10 WS-EDIT-REISSUE-DATE-FLGS.\n               88 WS-EDIT-REISSUE-DATE-INVALID     VALUE '000'.\n               20 WS-EDIT-REISSUE-YEAR-FLG         PIC X(01).\n                  88 FLG-REISSUE-YEAR-ISVALID      VALUE LOW-VALUES.\n                  88 FLG-REISSUE-YEAR-NOT-OK       VALUE '0'.\n                  88 FLG-REISSUE-YEAR-BLANK        VALUE 'B'.\n               20 WS-EDIT-REISSUE-MONTH            PIC X(01).\n                  88 FLG-REISSUE-MONTH-ISVALID     VALUE LOW-VALUES.\n                  88 FLG-REISSUE-MONTH-NOT-OK      VALUE '0'.\n                  88 FLG-REISSUE-MONTH-BLANK       VALUE 'B'.\n               20 WS-EDIT-REISSUE-DAY              PIC X(01).\n                  88 FLG-REISSUE-DAY-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-REISSUE-DAY-NOT-OK        VALUE '0'.\n                  88 FLG-REISSUE-DAY-BLANK         VALUE 'B'.\n           10 WS-EDIT-NAME-FLAGS.\n               20 WS-EDIT-FIRST-NAME-FLGS          PIC X(01).\n                  88 FLG-FIRST-NAME-ISVALID        VALUE LOW-VALUES.\n                  88 FLG-FIRST-NAME-NOT-OK         VALUE '0'.\n                  88 FLG-FIRST-NAME-BLANK          VALUE 'B'.\n               20 WS-EDIT-MIDDLE-NAME-FLGS         PIC X(01).\n                  88 FLG-MIDDLE-NAME-ISVALID       VALUE LOW-VALUES.\n                  88 FLG-MIDDLE-NAME-NOT-OK        VALUE '0'.\n                  88 FLG-MIDDLE-NAME-BLANK         VALUE 'B'.\n               20 WS-EDIT-LAST-NAME-FLGS           PIC X(01).\n                  88 FLG-LAST-NAME-ISVALID         VALUE LOW-VALUES.\n                  88 FLG-LAST-NAME-NOT-OK          VALUE '0'.\n                  88 FLG-LAST-NAME-BLANK           VALUE 'B'.\n           10 WS-EDIT-ADDRESS-FLAGS.\n               20 WS-EDIT-ADDRESS-LINE-1-FLGS      PIC X(01).\n                  88 FLG-ADDRESS-LINE-1-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-ADDRESS-LINE-1-NOT-OK     VALUE '0'.\n                  88 FLG-ADDRESS-LINE-1-BLANK      VALUE 'B'.\n               20 WS-EDIT-ADDRESS-LINE-2-FLGS      PIC X(01).\n                  88 FLG-ADDRESS-LINE-2-ISVALID    VALUE LOW-VALUES.\n                  88 FLG-ADDRESS-LINE-2-NOT-OK     VALUE '0'.\n                  88 FLG-ADDRESS-LINE-2-BLANK      VALUE 'B'.\n               20 WS-EDIT-CITY-FLGS                PIC X(01).\n                  88 FLG-CITY-ISVALID              VALUE LOW-VALUES.\n                  88 FLG-CITY-NOT-OK               VALUE '0'.\n                  88 FLG-CITY-BLANK                VALUE 'B'.\n               20 WS-EDIT-STATE-FLGS               PIC X(01).\n                  88 FLG-STATE-ISVALID             VALUE LOW-VALUES.\n                  88 FLG-STATE-NOT-OK              VALUE '0'.\n                  88 FLG-STATE-BLANK               VALUE 'B'.\n               20 WS-EDIT-ZIPCODE-FLGS             PIC X(01).\n                  88 FLG-ZIPCODE-ISVALID           VALUE LOW-VALUES.\n                  88 FLG-ZIPCODE-NOT-OK            VALUE '0'.\n                  88 FLG-ZIPCODE-BLANK             VALUE 'B'.\n               20 WS-EDIT-COUNTRY-FLGS             PIC X(01).\n                  88 FLG-COUNTRY-ISVALID           VALUE LOW-VALUES.\n                  88 FLG-COUNTRY-NOT-OK            VALUE '0'.\n                  88 FLG-COUNTRY-BLANK             VALUE 'B'.\n               20 WS-EDIT-PHONE-NUM-1-FLGS.\n                  88 WS-EDIT-PHONE-NUM-1-IS-INVALID\n                                                   VALUE '000'.\n                  30 WS-EDIT-PHONE-NUM-1A-FLG      PIC X(01).\n                     88 FLG-PHONE-NUM-1A-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1A-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1A-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-1B          PIC X(01).\n                     88 FLG-PHONE-NUM-1B-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1B-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1B-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-1C          PIC X(01).\n                     88 FLG-PHONE-NUM-1C-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-1C-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-1C-BLANK     VALUE 'B'.\n               20 WS-EDIT-PHONE-NUM-2-FLGS.\n                  88 WS-EDIT-PHONE-NUM-2-IS-INVALID\n                                                   VALUE '000'.\n                  30 WS-EDIT-PHONE-NUM-2A-FLG      PIC X(01).\n                     88 FLG-PHONE-NUM-2A-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2A-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2A-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-2B          PIC X(01).\n                     88 FLG-PHONE-NUM-2B-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2B-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2B-BLANK     VALUE 'B'.\n                  30 WS-EDIT-PHONE-NUM-2C          PIC X(01).\n                     88 FLG-PHONE-NUM-2C-ISVALID   VALUE LOW-VALUES.\n                     88 FLG-PHONE-NUM-2C-NOT-OK    VALUE '0'.\n                     88 FLG-PHONE-NUM-2C-BLANK     VALUE 'B'.\n           10  WS-EFT-ACCOUNT-ID-FLGS              PIC X(01).\n               88 FLG-EFT-ACCOUNT-ID-ISVALID       VALUE LOW-VALUES.\n               88 FLG-EFT-ACCOUNT-ID-NOT-OK        VALUE '0'.\n               88 FLG-EFT-ACCOUNT-ID-BLANK         VALUE 'B'.\n           10  WS-EDIT-PRI-CARDHOLDER              PIC  X(1).\n               88  FLG-PRI-CARDHOLDER-ISVALID      VALUES 'Y', 'N'.\n               88  FLG-PRI-CARDHOLDER-NOT-OK       VALUE '0'.\n               88  FLG-PRI-CARDHOLDER-BLANK        VALUE 'B'.\n\n      ******************************************************************\n      * Output edits\n      ******************************************************************\n         05 CICS-OUTPUT-EDIT-VARS.\n           10  CUST-ACCT-ID-X                      PIC X(11).\n           10  CUST-ACCT-ID-N REDEFINES CUST-ACCT-ID-X\n                                                   PIC 9(11).\n           10  WS-EDIT-DATE-X                      PIC X(10).\n           10  FILLER REDEFINES WS-EDIT-DATE-X.\n               20 WS-EDIT-DATE-X-YEAR              PIC X(4).\n               20 FILLER                           PIC X(1).\n               20 WS-EDIT-DATE-MONTH               PIC X(2).\n               20 FILLER                           PIC X(1).\n               20 WS-EDIT-DATE-DAY                 PIC X(2).\n           10  WS-EDIT-DATE-X REDEFINES\n               WS-EDIT-DATE-X                      PIC 9(10).\n           10  WS-EDIT-CURRENCY-9-2                PIC X(15).\n           10  WS-EDIT-CURRENCY-9-2-F              PIC +ZZZ,ZZZ,ZZZ.99.\n\n      ******************************************************************\n      *      File and data Handling\n      ******************************************************************\n         05 WS-XREF-RID.\n           10  WS-CARD-RID-CARDNUM                 PIC X(16).\n           10  WS-CARD-RID-CUST-ID                 PIC 9(09).\n           10  WS-CARD-RID-CUST-ID-X REDEFINES\n                  WS-CARD-RID-CUST-ID              PIC X(09).\n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).\n           10  WS-CARD-RID-ACCT-ID-X REDEFINES\n                  WS-CARD-RID-ACCT-ID              PIC X(11).\n         05  WS-FILE-READ-FLAGS.\n           10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).\n              88 FOUND-ACCT-IN-MASTER              VALUE '1'.\n           10 WS-CUST-MASTER-READ-FLAG             PIC X(1).\n              88 FOUND-CUST-IN-MASTER              VALUE '1'.\n         05  WS-FILE-ERROR-MESSAGE.\n           10  FILLER                         PIC X(12)\n                                                   VALUE 'File Error: '.\n           10  ERROR-OPNAME                        PIC X(8)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(4)\n                                                   VALUE ' on '.\n           10  ERROR-FILE                          PIC X(9)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(15)\n                                                   VALUE\n                                                   ' returned RESP '.\n           10  ERROR-RESP                          PIC X(10)\n                                                   VALUE SPACES.\n           10  FILLER                              PIC X(7)\n                                                   VALUE ',RESP2 '.\n           10  ERROR-RESP2                         PIC X(10)\n                                                   VALUE SPACES.\n          10  FILLER                               PIC X(5)\n                                                   VALUE SPACES.\n      *  Alpha variables for editing numerics\n      *\n          05 ALPHA-VARS-FOR-DATA-EDITING.\n             15 ACUP-NEW-CREDIT-LIMIT-X            PIC X(15).\n             15 ACUP-NEW-CASH-CREDIT-LIMIT-X       PIC X(15).\n             15 ACUP-NEW-CURR-BAL-X                PIC X(15).\n             15 ACUP-NEW-CURR-CYC-CREDIT-X         PIC X(15).\n             15 ACUP-NEW-CURR-CYC-DEBIT-X          PIC X(15).\n\n          05 ACCT-UPDATE-RECORD.\n      *****************************************************************\n      *    Data-structure for  account entity (RECLN 300)\n      *****************************************************************\n               15  ACCT-UPDATE-ID                      PIC 9(11).\n               15  ACCT-UPDATE-ACTIVE-STATUS           PIC X(01).\n               15  ACCT-UPDATE-CURR-BAL                PIC S9(10)V99.\n               15  ACCT-UPDATE-CREDIT-LIMIT            PIC S9(10)V99.\n               15  ACCT-UPDATE-CASH-CREDIT-LIMIT       PIC S9(10)V99.\n               15  ACCT-UPDATE-OPEN-DATE               PIC X(10).\n               15  ACCT-UPDATE-EXPIRAION-DATE          PIC X(10).\n               15  ACCT-UPDATE-REISSUE-DATE            PIC X(10).\n               15  ACCT-UPDATE-CURR-CYC-CREDIT         PIC S9(10)V99.\n               15  ACCT-UPDATE-CURR-CYC-DEBIT          PIC S9(10)V99.\n               15  ACCT-UPDATE-GROUP-ID                PIC X(10).\n               15  FILLER                              PIC X(188).\n          05 CUST-UPDATE-RECORD.\n      *****************************************************************\n      *    Data-structure for  CUSTOMER entity (RECLN 300)\n      *****************************************************************\n               15  CUST-UPDATE-ID                      PIC 9(09).\n               15  CUST-UPDATE-FIRST-NAME              PIC X(25).\n               15  CUST-UPDATE-MIDDLE-NAME             PIC X(25).\n               15  CUST-UPDATE-LAST-NAME               PIC X(25).\n               15  CUST-UPDATE-ADDR-LINE-1             PIC X(50).\n               15  CUST-UPDATE-ADDR-LINE-2             PIC X(50).\n               15  CUST-UPDATE-ADDR-LINE-3             PIC X(50).\n               15  CUST-UPDATE-ADDR-STATE-CD           PIC X(02).\n               15  CUST-UPDATE-ADDR-COUNTRY-CD         PIC X(03).\n               15  CUST-UPDATE-ADDR-ZIP                PIC X(10).\n               15  CUST-UPDATE-PHONE-NUM-1             PIC X(15).\n               15  CUST-UPDATE-PHONE-NUM-2             PIC X(15).\n               15  CUST-UPDATE-SSN                     PIC 9(09).\n               15  CUST-UPDATE-GOVT-ISSUED-ID          PIC X(20).\n               15  CUST-UPDATE-DOB-YYYY-MM-DD          PIC X(10).\n               15  CUST-UPDATE-EFT-ACCOUNT-ID          PIC X(10).\n               15  CUST-UPDATE-PRI-CARD-IND            PIC X(01).\n               15  CUST-UPDATE-FICO-CREDIT-SCORE       PIC 9(03).\n               15  FILLER                              PIC X(168).\n\n\n      ******************************************************************\n      *      Output Message Construction\n      ******************************************************************\n         05  WS-LONG-MSG                           PIC X(500).\n         05  WS-INFO-MSG                           PIC X(40).\n           88  WS-NO-INFO-MESSAGE                 VALUES\n                                                  SPACES LOW-VALUES.\n           88  FOUND-ACCOUNT-DATA             VALUE\n               'Details of selected account shown above'.\n           88  PROMPT-FOR-SEARCH-KEYS              VALUE\n               'Enter or update id of account to update'.\n           88  PROMPT-FOR-CHANGES                  VALUE\n               'Update account details presented above.'.\n           88  PROMPT-FOR-CONFIRMATION             VALUE\n               'Changes validated.Press F5 to save'.\n           88  CONFIRM-UPDATE-SUCCESS              VALUE\n               'Changes committed to database'.\n           88  INFORM-FAILURE                      VALUE\n               'Changes unsuccessful. Please try again'.\n\n         05  WS-RETURN-MSG                         PIC X(75).\n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.\n           88  WS-EXIT-MESSAGE                     VALUE\n               'PF03 pressed.Exiting              '.\n           88  WS-PROMPT-FOR-ACCT                  VALUE\n               'Account number not provided'.\n           88  WS-PROMPT-FOR-LASTNAME              VALUE\n               'Last name not provided'.\n           88  WS-NAME-MUST-BE-ALPHA               VALUE\n               'Name can only contain alphabets and spaces'.\n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE\n               'No input received'.\n           88  NO-CHANGES-DETECTED                 VALUE\n               'No change detected with respect to values fetched.'.\n           88  SEARCHED-ACCT-ZEROES                VALUE\n               'Account number must be a non zero 11 digit number'.\n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE\n               'Account number must be a non zero 11 digit number'.\n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE\n               'Did not find this account in account card xref file'.\n           88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE\n               'Did not find this account in account master file'.\n           88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE\n               'Did not find associated customer in master file'.\n           88  ACCT-STATUS-MUST-BE-YES-NO          VALUE\n               'Account Active Status must be Y or N'.\n           88  CRED-LIMIT-IS-BLANK                 VALUE\n               'Credit Limit must be supplied'.\n           88  CRED-LIMIT-IS-NOT-VALID             VALUE\n               'Credit Limit is not valid'.\n           88  THIS-MONTH-NOT-VALID                VALUE\n               'Card expiry month must be between 1 and 12'.\n           88  THIS-YEAR-NOT-VALID                 VALUE\n               'Invalid card expiry year'.\n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE\n               'Did not find this account in cards database'.\n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE\n               'Did not find cards for this search condition'.\n           88  COULD-NOT-LOCK-ACCT-FOR-UPDATE      VALUE\n               'Could not lock account record for update'.\n           88  COULD-NOT-LOCK-CUST-FOR-UPDATE      VALUE\n               'Could not lock customer record for update'.\n           88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE\n               'Record changed by some one else. Please review'.\n           88  LOCKED-BUT-UPDATE-FAILED            VALUE\n               'Update of record failed'.\n           88  XREF-READ-ERROR                     VALUE\n               'Error reading Card Data File'.\n           88  CODING-TO-BE-DONE                   VALUE\n               'Looks Good.... so far'.\n      ******************************************************************\n      *      Literals and Constants\n      ******************************************************************\n       01 WS-LITERALS.\n          05 LIT-THISPGM                           PIC X(8)\n                                                   VALUE 'COACTUPC'.\n          05 LIT-THISTRANID                        PIC X(4)\n                                                   VALUE 'CAUP'.\n          05 LIT-THISMAPSET                        PIC X(8)\n                                                   VALUE 'COACTUP '.\n          05 LIT-THISMAP                           PIC X(7)\n                                                   VALUE 'CACTUPA'.\n          05 LIT-CARDUPDATE-PGM                    PIC X(8)\n                                                   VALUE 'COCRDUPC'.\n          05 LIT-CARDUPDATE-TRANID                 PIC X(4)\n                                                   VALUE 'CCUP'.\n          05 LIT-CARDUPDATE-MAPSET                 PIC X(8)\n                                                   VALUE 'COCRDUP '.\n          05 LIT-CARDUPDATE-MAP                    PIC X(7)\n                                                   VALUE 'CCRDUPA'.\n          05 LIT-CCLISTPGM                         PIC X(8)\n                                                   VALUE 'COCRDLIC'.\n          05 LIT-CCLISTTRANID                      PIC X(4)\n                                                   VALUE 'CCLI'.\n          05 LIT-CCLISTMAPSET                      PIC X(7)\n                                                   VALUE 'COCRDLI'.\n          05 LIT-CCLISTMAP                         PIC X(7)\n                                                   VALUE 'CCRDSLA'.\n          05 LIT-MENUPGM                           PIC X(8)\n                                                   VALUE 'COMEN01C'.\n          05 LIT-MENUTRANID                        PIC X(4)\n                                                   VALUE 'CM00'.\n          05 LIT-MENUMAPSET                        PIC X(7)\n                                                   VALUE 'COMEN01'.\n          05 LIT-MENUMAP                           PIC X(7)\n                                                   VALUE 'COMEN1A'.\n          05 LIT-CARDDTLPGM                        PIC X(8)\n                                                   VALUE 'COCRDSLC'.\n          05 LIT-CARDDTLTRANID                     PIC X(4)\n                                                   VALUE 'CCDL'.\n          05 LIT-CARDDTLMAPSET                     PIC X(7)\n                                                   VALUE 'COCRDSL'.\n          05 LIT-CARDDTLMAP                        PIC X(7)\n                                                   VALUE 'CCRDSLA'.\n          05 LIT-ACCTFILENAME                      PIC X(8)\n                                                   VALUE 'ACCTDAT '.\n          05 LIT-CUSTFILENAME                      PIC X(8)\n                                                   VALUE 'CUSTDAT '.\n          05 LIT-CARDFILENAME                      PIC X(8)\n                                                   VALUE 'CARDDAT '.\n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)\n                                                   VALUE 'CARDAIX '.\n          05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)\n                                                   VALUE 'CXACAIX '.\n      ******************************************************************\n      * Literals for use in INSPECT statements\n      ******************************************************************\n          05 LIT-ALL-ALPHANUM-FROM-X.\n             10 LIT-ALL-ALPHA-FROM-X.\n                15 LIT-UPPER                       PIC X(26)\n                                 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.\n                15 LIT-LOWER                       PIC X(26)\n                                 VALUE 'abcdefghijklmnopqrstuvwxyz'.\n             10 LIT-NUMBERS                        PIC X(10)\n                                 VALUE '0123456789'.             \n      ******************************************************************\n      *Other common working storage Variables\n      ******************************************************************\n       COPY CVCRD01Y.\n      ******************************************************************\n      *Lookups\n      ******************************************************************\n      *North America Phone Area codes\n       COPY CSLKPCDY.\n\n      ******************************************************************\n      * Variables for use in INSPECT statements\n      ******************************************************************\n       01  LIT-ALL-ALPHA-FROM     PIC X(52) VALUE SPACES.\n       01  LIT-ALL-ALPHANUM-FROM  PIC X(62) VALUE SPACES.\n       01  LIT-ALL-NUM-FROM       PIC X(10) VALUE SPACES.\n       77  LIT-ALPHA-SPACES-TO    PIC X(52) VALUE SPACES.\n       77  LIT-ALPHANUM-SPACES-TO PIC X(62) VALUE SPACES.\n       77  LIT-NUM-SPACES-TO      PIC X(10) VALUE SPACES.\n\n      *IBM SUPPLIED COPYBOOKS\n       COPY DFHBMSCA.\n       COPY DFHAID.\n\n      *COMMON COPYBOOKS\n      *Screen Titles\n       COPY COTTL01Y.\n\n      *Account Update Screen Layout\n       COPY COACTUP.\n\n      *Current Date\n       COPY CSDAT01Y.\n\n      *Common Messages\n       COPY CSMSG01Y.\n\n      *Abend Variables\n       COPY CSMSG02Y.\n\n      *Signed on user data\n       COPY CSUSR01Y.\n\n      *Dataset layouts\n\n      *ACCT RECORD LAYOUT\n       COPY CVACT01Y.\n\n      *CARD XREF LAYOUT\n       COPY CVACT03Y.\n\n      *CUSTOMER LAYOUT\n       COPY CVCUS01Y.\n\n      ******************************************************************\n      *Application Commmarea Copybook\n       COPY COCOM01Y.\n\n       01 WS-THIS-PROGCOMMAREA.\n          05 ACCT-UPDATE-SCREEN-DATA.\n             10 ACUP-CHANGE-ACTION                     PIC X(1)\n                                                       VALUE LOW-VALUES.\n                88 ACUP-DETAILS-NOT-FETCHED            VALUES\n                                                       LOW-VALUES,\n                                                       SPACES.\n                88 ACUP-SHOW-DETAILS                   VALUE 'S'.\n                88 ACUP-CHANGES-MADE                   VALUES 'E', 'N'\n                                                            , 'C', 'L'\n                                                            , 'F'.\n                88 ACUP-CHANGES-NOT-OK                 VALUE 'E'.\n                88 ACUP-CHANGES-OK-NOT-CONFIRMED       VALUE 'N'.\n                88 ACUP-CHANGES-OKAYED-AND-DONE        VALUE 'C'.\n                88 ACUP-CHANGES-FAILED                 VALUES 'L', 'F'.\n                88 ACUP-CHANGES-OKAYED-LOCK-ERROR      VALUE 'L'.\n                88 ACUP-CHANGES-OKAYED-BUT-FAILED      VALUE 'F'.\n          05 ACUP-OLD-DETAILS.\n             10 ACUP-OLD-ACCT-DATA.\n                15  ACUP-OLD-ACCT-ID-X                 PIC X(11).\n                15  ACUP-OLD-ACCT-ID                   REDEFINES\n                    ACUP-OLD-ACCT-ID-X                 PIC 9(11).\n                15  ACUP-OLD-ACTIVE-STATUS             PIC X(01).\n                15  ACUP-OLD-CURR-BAL                  PIC X(12).\n                15  ACUP-OLD-CURR-BAL-N REDEFINES\n                    ACUP-OLD-CURR-BAL                  PIC S9(10)V99.\n                15  ACUP-OLD-CREDIT-LIMIT              PIC X(12).\n                15  ACUP-OLD-CREDIT-LIMIT-N            REDEFINES\n                    ACUP-OLD-CREDIT-LIMIT              PIC S9(10)V99.\n                15  ACUP-OLD-CASH-CREDIT-LIMIT         PIC X(12).\n                15  ACUP-OLD-CASH-CREDIT-LIMIT-N       REDEFINES\n                    ACUP-OLD-CASH-CREDIT-LIMIT         PIC S9(10)V99.\n                15  ACUP-OLD-OPEN-DATE                 PIC X(08).\n                15  ACUP-OLD-OPEN-DATE-PARTS           REDEFINES\n                    ACUP-OLD-OPEN-DATE.\n                    20 ACUP-OLD-OPEN-YEAR              PIC X(4).\n                    20 ACUP-OLD-OPEN-MON               PIC X(2).\n                    20 ACUP-OLD-OPEN-DAY               PIC X(2).\n                15  ACUP-OLD-EXPIRAION-DATE            PIC X(08).\n                15  ACUP-OLD-EXPIRAION-DATE-PARTS      REDEFINES\n                    ACUP-OLD-EXPIRAION-DATE.\n                    20 ACUP-OLD-EXP-YEAR                PIC X(4).\n                    20 ACUP-OLD-EXP-MON                 PIC X(2).\n                    20 ACUP-OLD-EXP-DAY                 PIC X(2).\n                15  ACUP-OLD-REISSUE-DATE              PIC X(08).\n                15  ACUP-OLD-REISSUE-DATE-PARTS        REDEFINES\n                    ACUP-OLD-REISSUE-DATE.\n                    20 ACUP-OLD-REISSUE-YEAR           PIC X(4).\n                    20 ACUP-OLD-REISSUE-MON            PIC X(2).\n                    20 ACUP-OLD-REISSUE-DAY            PIC X(2).\n                15  ACUP-OLD-CURR-CYC-CREDIT           PIC X(12).\n                15  ACUP-OLD-CURR-CYC-CREDIT-N         REDEFINES\n                    ACUP-OLD-CURR-CYC-CREDIT           PIC S9(10)V99.\n                15  ACUP-OLD-CURR-CYC-DEBIT            PIC X(12).\n                15  ACUP-OLD-CURR-CYC-DEBIT-N          REDEFINES\n                    ACUP-OLD-CURR-CYC-DEBIT            PIC S9(10)V99.\n                15  ACUP-OLD-GROUP-ID                  PIC X(10).\n             10 ACUP-OLD-CUST-DATA.\n                15  ACUP-OLD-CUST-ID-X                 PIC X(09).\n                15  ACUP-OLD-CUST-ID                   REDEFINES\n                    ACUP-OLD-CUST-ID-X                 PIC 9(09).\n                15  ACUP-OLD-CUST-FIRST-NAME           PIC X(25).\n                15  ACUP-OLD-CUST-MIDDLE-NAME          PIC X(25).\n                15  ACUP-OLD-CUST-LAST-NAME            PIC X(25).\n                15  ACUP-OLD-CUST-ADDR-LINE-1          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-LINE-2          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-LINE-3          PIC X(50).\n                15  ACUP-OLD-CUST-ADDR-STATE-CD        PIC X(02).\n                15  ACUP-OLD-CUST-ADDR-COUNTRY-CD      PIC X(03).\n                15  ACUP-OLD-CUST-ADDR-ZIP             PIC X(10).\n                15  ACUP-OLD-CUST-PHONE-NUM-1          PIC X(15).\n                15  ACUP-OLD-CUST-PHONE-NUM-1-X REDEFINES\n                    ACUP-OLD-CUST-PHONE-NUM-1.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-1C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-OLD-CUST-PHONE-NUM-2          PIC X(15).\n                15  ACUP-OLD-CUST-PHONE-NUM-2-X REDEFINES\n                    ACUP-OLD-CUST-PHONE-NUM-2.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-OLD-CUST-PHONE-NUM-2C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-OLD-CUST-SSN-X                PIC X(09).\n                15  ACUP-OLD-CUST-SSN                  REDEFINES\n                    ACUP-OLD-CUST-SSN-X                PIC 9(09).\n                15  ACUP-OLD-CUST-GOVT-ISSUED-ID       PIC X(20).\n                15  ACUP-OLD-CUST-DOB-YYYY-MM-DD       PIC X(08).\n                15  ACUP-OLD-CUST-DOB-PARTS            REDEFINES\n                    ACUP-OLD-CUST-DOB-YYYY-MM-DD.\n                    20 ACUP-OLD-CUST-DOB-YEAR          PIC X(4).\n                    20 ACUP-OLD-CUST-DOB-MON           PIC X(2).\n                    20 ACUP-OLD-CUST-DOB-DAY           PIC X(2).\n                15  ACUP-OLD-CUST-EFT-ACCOUNT-ID       PIC X(10).\n                15  ACUP-OLD-CUST-PRI-HOLDER-IND       PIC X(01).\n                15  ACUP-OLD-CUST-FICO-SCORE-X         PIC X(03).\n                15  ACUP-OLD-CUST-FICO-SCORE           REDEFINES\n                    ACUP-OLD-CUST-FICO-SCORE-X         PIC 9(03).\n          05 ACUP-NEW-DETAILS.\n             10 ACUP-NEW-ACCT-DATA.\n                15  ACUP-NEW-ACCT-ID-X                 PIC X(11).\n                15  ACUP-NEW-ACCT-ID                   REDEFINES\n                    ACUP-NEW-ACCT-ID-X                 PIC 9(11).\n                15  ACUP-NEW-ACTIVE-STATUS             PIC X(01).\n                15  ACUP-NEW-CURR-BAL                  PIC X(12).\n                15  ACUP-NEW-CURR-BAL-N                REDEFINES\n                    ACUP-NEW-CURR-BAL                  PIC S9(10)V99.\n                15  ACUP-NEW-CREDIT-LIMIT              PIC X(12).\n                15  ACUP-NEW-CREDIT-LIMIT-N            REDEFINES\n                    ACUP-NEW-CREDIT-LIMIT              PIC S9(10)V99.\n                15  ACUP-NEW-CASH-CREDIT-LIMIT         PIC X(12).\n                15  ACUP-NEW-CASH-CREDIT-LIMIT-N       REDEFINES\n                    ACUP-NEW-CASH-CREDIT-LIMIT         PIC S9(10)V99.\n                15  ACUP-NEW-OPEN-DATE                 PIC X(08).\n                15  ACUP-NEW-OPEN-DATE-PARTS           REDEFINES\n                    ACUP-NEW-OPEN-DATE.\n                    20 ACUP-NEW-OPEN-YEAR              PIC X(4).\n                    20 ACUP-NEW-OPEN-MON               PIC X(2).\n                    20 ACUP-NEW-OPEN-DAY               PIC X(2).\n                15  ACUP-NEW-EXPIRAION-DATE            PIC X(08).\n                15  ACUP-NEW-EXPIRAION-DATE-PARTS      REDEFINES\n                    ACUP-NEW-EXPIRAION-DATE.\n                    20 ACUP-NEW-EXP-YEAR                PIC X(4).\n                    20 ACUP-NEW-EXP-MON                 PIC X(2).\n                    20 ACUP-NEW-EXP-DAY                 PIC X(2).\n                15  ACUP-NEW-REISSUE-DATE              PIC X(08).\n                15  ACUP-NEW-REISSUE-DATE-PARTS        REDEFINES\n                    ACUP-NEW-REISSUE-DATE.\n                    20 ACUP-NEW-REISSUE-YEAR           PIC X(4).\n                    20 ACUP-NEW-REISSUE-MON            PIC X(2).\n                    20 ACUP-NEW-REISSUE-DAY            PIC X(2).\n                15  ACUP-NEW-CURR-CYC-CREDIT           PIC X(12).\n                15  ACUP-NEW-CURR-CYC-CREDIT-N         REDEFINES\n                    ACUP-NEW-CURR-CYC-CREDIT           PIC S9(10)V99.\n                15  ACUP-NEW-CURR-CYC-DEBIT            PIC X(12).\n                15  ACUP-NEW-CURR-CYC-DEBIT-N          REDEFINES\n                    ACUP-NEW-CURR-CYC-DEBIT            PIC S9(10)V99.\n                15  ACUP-NEW-GROUP-ID                  PIC X(10).\n             10 ACUP-NEW-CUST-DATA.\n                15  ACUP-NEW-CUST-ID-X                 PIC X(09).\n                15  ACUP-NEW-CUST-ID                   REDEFINES\n                    ACUP-NEW-CUST-ID-X                 PIC 9(09).\n                15  ACUP-NEW-CUST-FIRST-NAME           PIC X(25).\n                15  ACUP-NEW-CUST-MIDDLE-NAME          PIC X(25).\n                15  ACUP-NEW-CUST-LAST-NAME            PIC X(25).\n                15  ACUP-NEW-CUST-ADDR-LINE-1          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-LINE-2          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-LINE-3          PIC X(50).\n                15  ACUP-NEW-CUST-ADDR-STATE-CD        PIC X(02).\n                15  ACUP-NEW-CUST-ADDR-COUNTRY-CD      PIC X(03).\n                15  ACUP-NEW-CUST-ADDR-ZIP             PIC X(10).\n                15  ACUP-NEW-CUST-PHONE-NUM-1          PIC X(15).\n                15  ACUP-NEW-CUST-PHONE-NUM-1-X REDEFINES\n                    ACUP-NEW-CUST-PHONE-NUM-1.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-1C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-NEW-CUST-PHONE-NUM-2          PIC X(15).\n                15  ACUP-NEW-CUST-PHONE-NUM-2-X REDEFINES\n                    ACUP-NEW-CUST-PHONE-NUM-2.\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2A      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2B      PIC X(3).\n                    20 FILLER                          PIC X(1).\n                    20 ACUP-NEW-CUST-PHONE-NUM-2C      PIC X(4).\n                    20 FILLER                          PIC X(2).\n                15  ACUP-NEW-CUST-SSN-X.\n                    20 ACUP-NEW-CUST-SSN-1             PIC X(03).\n                    20 ACUP-NEW-CUST-SSN-2             PIC X(02).\n                    20 ACUP-NEW-CUST-SSN-3             PIC X(04).\n                15  ACUP-NEW-CUST-SSN                  REDEFINES\n                    ACUP-NEW-CUST-SSN-X                PIC 9(09).\n                15  ACUP-NEW-CUST-GOVT-ISSUED-ID       PIC X(20).\n                15  ACUP-NEW-CUST-DOB-YYYY-MM-DD       PIC X(08).\n                15  ACUP-NEW-CUST-DOB-PARTS            REDEFINES\n                    ACUP-NEW-CUST-DOB-YYYY-MM-DD.\n                    20 ACUP-NEW-CUST-DOB-YEAR          PIC X(4).\n                    20 ACUP-NEW-CUST-DOB-MON           PIC X(2).\n                    20 ACUP-NEW-CUST-DOB-DAY           PIC X(2).\n                15  ACUP-NEW-CUST-EFT-ACCOUNT-ID       PIC X(10).\n                15  ACUP-NEW-CUST-PRI-HOLDER-IND       PIC X(01).\n                15  ACUP-NEW-CUST-FICO-SCORE-X         PIC X(03).\n                15  ACUP-NEW-CUST-FICO-SCORE           REDEFINES\n                    ACUP-NEW-CUST-FICO-SCORE-X         PIC 9(03).\n                    88 FICO-RANGE-IS-VALID             VALUES 300\n                                                       THROUGH 850.\n       01  WS-COMMAREA                                 PIC X(2000).\n\n\n       LINKAGE SECTION.\n       01  DFHCOMMAREA.\n         05  FILLER                                PIC X(1)\n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\n       PROCEDURE DIVISION.\n       0000-MAIN.\n\n\n           EXEC CICS HANDLE ABEND\n                     LABEL(ABEND-ROUTINE)\n           END-EXEC\n\n           INITIALIZE CC-WORK-AREA\n                      WS-MISC-STORAGE\n                      WS-COMMAREA\n      *****************************************************************\n      * Store our context\n      *****************************************************************\n           MOVE LIT-THISTRANID       TO WS-TRANID\n      *****************************************************************\n      * Ensure error message is cleared                               *\n      *****************************************************************\n           SET WS-RETURN-MSG-OFF  TO TRUE\n      *****************************************************************\n      * Store passed data if  any                *\n      *****************************************************************\n           IF EIBCALEN IS EQUAL TO 0\n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA\n              SET CDEMO-PGM-ENTER TO TRUE\n              SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO\n                                CARDDEMO-COMMAREA\n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO\n                                WS-THIS-PROGCOMMAREA\n           END-IF\n      *****************************************************************\n      * Remap PFkeys as needed.\n      * Store the Mapped PF Key\n      *****************************************************************\n           PERFORM YYYY-STORE-PFKEY\n              THRU YYYY-STORE-PFKEY-EXIT\n      *****************************************************************\n      * Check the AID to see if its valid at this point               *\n      * F3 - Exit\n      * Enter show screen again\n      *****************************************************************\n           SET PFK-INVALID TO TRUE\n           IF CCARD-AID-ENTER OR\n              CCARD-AID-PFK03 OR\n              (CCARD-AID-PFK05 AND ACUP-CHANGES-OK-NOT-CONFIRMED)\n                              OR\n              (CCARD-AID-PFK12 AND NOT ACUP-DETAILS-NOT-FETCHED)\n              SET PFK-VALID TO TRUE\n           END-IF\n\n           IF PFK-INVALID\n              SET CCARD-AID-ENTER TO TRUE\n           END-IF\n\n      *****************************************************************\n      * Decide what to do based on inputs received\n      *****************************************************************\n           EVALUATE TRUE\n      ******************************************************************\n      *       USER PRESSES PF03 TO EXIT\n      *  OR   USER IS DONE WITH UPDATE\n      *            XCTL TO CALLING PROGRAM OR MAIN MENU\n      ******************************************************************\n              WHEN CCARD-AID-PFK03\n                   SET CCARD-AID-PFK03     TO TRUE\n\n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                   OR CDEMO-FROM-TRANID    EQUAL SPACES\n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID\n                   ELSE\n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID\n                   END-IF\n\n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES\n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES\n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM\n                   ELSE\n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM\n                   END-IF\n\n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID\n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM\n\n                   SET  CDEMO-USRTYP-USER  TO TRUE\n                   SET  CDEMO-PGM-ENTER    TO TRUE\n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET\n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP\n\n                   EXEC CICS\n                        SYNCPOINT\n                   END-EXEC\n      *\n                   EXEC CICS XCTL\n                        PROGRAM (CDEMO-TO-PROGRAM)\n                        COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n      ******************************************************************\n      *       FRESH ENTRY INTO PROGRAM\n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n               AND CDEMO-PGM-ENTER\n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER        TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *       ACCT DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY\n      *            RESET THE SEARCH KEYS\n      *            ASK THE USER FOR FRESH SEARCH CRITERIA\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n              WHEN ACUP-CHANGES-FAILED\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                              WS-MISC-STORAGE\n                              CDEMO-ACCT-ID\n                   SET CDEMO-PGM-ENTER            TO TRUE\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER          TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED   TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *      ACCT DATA HAS BEEN PRESENTED TO USER\n      *            CHECK THE USER INPUTS\n      *            DECIDE WHAT TO DO\n      *            PRESENT NEXT STEPS TO USER\n      ******************************************************************\n              WHEN OTHER\n                   PERFORM 1000-PROCESS-INPUTS\n                      THRU 1000-PROCESS-INPUTS-EXIT\n                   PERFORM 2000-DECIDE-ACTION\n                      THRU 2000-DECIDE-ACTION-EXIT\n                   PERFORM 3000-SEND-MAP\n                      THRU 3000-SEND-MAP-EXIT\n                   GO TO COMMON-RETURN\n           END-EVALUATE\n           .\n\n       COMMON-RETURN.\n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG\n\n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\n           MOVE  WS-THIS-PROGCOMMAREA TO\n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA )\n\n           EXEC CICS RETURN\n                TRANSID (LIT-THISTRANID)\n                COMMAREA (WS-COMMAREA)\n                LENGTH(LENGTH OF WS-COMMAREA)\n           END-EXEC\n           .\n       0000-MAIN-EXIT.\n           EXIT\n           .\n\n       1000-PROCESS-INPUTS.\n           PERFORM 1100-RECEIVE-MAP\n              THRU 1100-RECEIVE-MAP-EXIT\n           PERFORM 1200-EDIT-MAP-INPUTS\n              THRU 1200-EDIT-MAP-INPUTS-EXIT\n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG\n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG\n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP\n           .\n      *\n       1000-PROCESS-INPUTS-EXIT.\n           EXIT\n           .\n       1100-RECEIVE-MAP.\n           EXEC CICS RECEIVE MAP(LIT-THISMAP)\n                     MAPSET(LIT-THISMAPSET)\n                     INTO(CACTUPAI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC\n      *\n           INITIALIZE ACUP-NEW-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCTSIDI OF CACTUPAI = '*'\n           OR  ACCTSIDI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           ELSE\n               MOVE ACCTSIDI OF CACTUPAI TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n              GO TO 1100-RECEIVE-MAP-EXIT\n           END-IF\n\n      * Active Status\n           IF  ACSTTUSI OF CACTUPAI = '*'\n           OR  ACSTTUSI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-ACTIVE-STATUS\n           ELSE\n               MOVE ACSTTUSI OF CACTUPAI TO ACUP-NEW-ACTIVE-STATUS\n           END-IF\n\n      * Credit Limit\n           IF  ACRDLIMI OF CACTUPAI = '*'\n           OR  ACRDLIMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CREDIT-LIMIT-X\n           ELSE\n               MOVE ACRDLIMI OF CACTUPAI TO ACUP-NEW-CREDIT-LIMIT-X\n               IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CREDIT-LIMIT-X) = 0\n                  COMPUTE ACUP-NEW-CREDIT-LIMIT-N =\n                     FUNCTION NUMVAL-C(ACRDLIMI OF CACTUPAI)\n               ELSE\n                  CONTINUE\n               END-IF\n           END-IF\n\n      * Cash Limit\n           IF  ACSHLIMI OF CACTUPAI = '*'\n           OR  ACSHLIMI OF CACTUPAI = SPACES\n             MOVE LOW-VALUES           TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n           ELSE\n             MOVE ACSHLIMI OF CACTUPAI TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n             IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CASH-CREDIT-LIMIT-X) = 0\n                COMPUTE ACUP-NEW-CASH-CREDIT-LIMIT-N =\n                     FUNCTION NUMVAL-C(ACSHLIMI OF CACTUPAI)\n             ELSE\n                CONTINUE\n             END-IF\n           END-IF\n\n      * Current Balance\n           IF  ACURBALI OF CACTUPAI = '*'\n           OR  ACURBALI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-BAL-X\n           ELSE\n               MOVE ACURBALI OF CACTUPAI TO ACUP-NEW-CURR-BAL-X\n               IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-BAL-X) = 0\n                   COMPUTE ACUP-NEW-CURR-BAL-N =\n                     FUNCTION NUMVAL-C(ACUP-NEW-CURR-BAL-X)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Credit\n           IF  ACRCYCRI OF CACTUPAI = '*'\n           OR  ACRCYCRI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-CREDIT-X\n           ELSE\n               MOVE ACRCYCRI OF CACTUPAI TO ACUP-NEW-CURR-CYC-CREDIT-X\n               IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-CREDIT-X) = 0\n                   COMPUTE ACUP-NEW-CURR-CYC-CREDIT-N =\n                     FUNCTION NUMVAL-C(ACRCYCRI OF CACTUPAI)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Debit\n           IF  ACRCYDBI OF CACTUPAI = '*'\n           OR  ACRCYDBI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-DEBIT-X\n           ELSE\n               MOVE ACRCYDBI OF CACTUPAI TO ACUP-NEW-CURR-CYC-DEBIT-X\n               IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-DEBIT-X) = 0\n                   COMPUTE ACUP-NEW-CURR-CYC-DEBIT-N =\n                     FUNCTION NUMVAL-C(ACRCYDBI OF CACTUPAI)\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Open date\n      *\n           IF  OPNYEARI OF CACTUPAI = '*'\n           OR  OPNYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-YEAR\n           ELSE\n               MOVE OPNYEARI OF CACTUPAI TO ACUP-NEW-OPEN-YEAR\n           END-IF\n\n           IF  OPNMONI OF CACTUPAI = '*'\n           OR  OPNMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-MON\n           ELSE\n               MOVE OPNMONI OF CACTUPAI TO  ACUP-NEW-OPEN-MON\n           END-IF\n\n           IF  OPNDAYI OF CACTUPAI = '*'\n           OR  OPNDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-DAY\n           ELSE\n               MOVE OPNDAYI OF CACTUPAI TO  ACUP-NEW-OPEN-DAY\n           END-IF\n\n      *Expiry date\n      *\n           IF  EXPYEARI OF CACTUPAI = '*'\n           OR  EXPYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-YEAR\n           ELSE\n               MOVE EXPYEARI OF CACTUPAI TO ACUP-NEW-EXP-YEAR\n           END-IF\n\n           IF  EXPMONI OF CACTUPAI = '*'\n           OR  EXPMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-MON\n           ELSE\n               MOVE EXPMONI OF CACTUPAI TO  ACUP-NEW-EXP-MON\n           END-IF\n\n           IF  EXPDAYI OF CACTUPAI = '*'\n           OR  EXPDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-DAY\n           ELSE\n               MOVE EXPDAYI OF CACTUPAI TO  ACUP-NEW-EXP-DAY\n           END-IF\n\n      *Reissue date\n      *\n           IF  RISYEARI OF CACTUPAI = '*'\n           OR  RISYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-YEAR\n           ELSE\n               MOVE RISYEARI OF CACTUPAI TO ACUP-NEW-REISSUE-YEAR\n           END-IF\n\n           IF  RISMONI OF CACTUPAI = '*'\n           OR  RISMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-MON\n           ELSE\n               MOVE RISMONI OF CACTUPAI TO  ACUP-NEW-REISSUE-MON\n           END-IF\n\n           IF  RISDAYI OF CACTUPAI = '*'\n           OR  RISDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-DAY\n           ELSE\n               MOVE RISDAYI OF CACTUPAI TO  ACUP-NEW-REISSUE-DAY\n           END-IF\n\n      *Account Group\n      *\n           IF  AADDGRPI OF CACTUPAI = '*'\n           OR  AADDGRPI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-GROUP-ID\n           ELSE\n               MOVE AADDGRPI OF CACTUPAI TO ACUP-NEW-GROUP-ID\n           END-IF\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n      *\n           IF  ACSTNUMI OF CACTUPAI = '*'\n           OR  ACSTNUMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ID-X\n           ELSE\n               MOVE ACSTNUMI OF CACTUPAI TO ACUP-NEW-CUST-ID-X\n           END-IF\n\n      *Social Security Number\n      *\n           IF  ACTSSN1I OF CACTUPAI = '*'\n           OR  ACTSSN1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-1\n           ELSE\n               MOVE ACTSSN1I OF CACTUPAI TO ACUP-NEW-CUST-SSN-1\n           END-IF\n\n           IF  ACTSSN2I OF CACTUPAI = '*'\n           OR  ACTSSN2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-2\n           ELSE\n               MOVE ACTSSN2I OF CACTUPAI TO ACUP-NEW-CUST-SSN-2\n           END-IF\n\n           IF  ACTSSN3I OF CACTUPAI = '*'\n           OR  ACTSSN3I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-3\n           ELSE\n               MOVE ACTSSN3I OF CACTUPAI TO ACUP-NEW-CUST-SSN-3\n           END-IF\n      *\n      *Date of birth\n      *\n           IF  DOBYEARI OF CACTUPAI = '*'\n           OR  DOBYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-YEAR\n           ELSE\n               MOVE DOBYEARI OF CACTUPAI TO ACUP-NEW-CUST-DOB-YEAR\n           END-IF\n\n           IF  DOBMONI OF CACTUPAI = '*'\n           OR  DOBMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-MON\n           ELSE\n               MOVE DOBMONI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-MON\n           END-IF\n\n           IF  DOBDAYI OF CACTUPAI = '*'\n           OR  DOBDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-DAY\n           ELSE\n               MOVE DOBDAYI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-DAY\n           END-IF\n      *\n      *FICO\n      *\n           IF  ACSTFCOI OF CACTUPAI = '*'\n           OR  ACSTFCOI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FICO-SCORE-X\n           ELSE\n               MOVE ACSTFCOI OF CACTUPAI TO ACUP-NEW-CUST-FICO-SCORE-X\n           END-IF\n      *\n      *First Name\n      *\n           IF  ACSFNAMI OF CACTUPAI = '*'\n           OR  ACSFNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FIRST-NAME\n           ELSE\n               MOVE ACSFNAMI OF CACTUPAI TO ACUP-NEW-CUST-FIRST-NAME\n           END-IF\n      *\n      *Middle Name\n      *\n           IF  ACSMNAMI OF CACTUPAI = '*'\n           OR  ACSMNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-MIDDLE-NAME\n           ELSE\n               MOVE ACSMNAMI OF CACTUPAI TO ACUP-NEW-CUST-MIDDLE-NAME\n           END-IF\n      *\n      *Last Name\n      *\n           IF  ACSLNAMI OF CACTUPAI = '*'\n           OR  ACSLNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-LAST-NAME\n           ELSE\n               MOVE ACSLNAMI OF CACTUPAI TO ACUP-NEW-CUST-LAST-NAME\n           END-IF\n      *\n      *Address\n      *\n           IF  ACSADL1I OF CACTUPAI = '*'\n           OR  ACSADL1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-1\n           ELSE\n               MOVE ACSADL1I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-1\n           END-IF\n\n           IF  ACSADL2I OF CACTUPAI = '*'\n           OR  ACSADL2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-2\n           ELSE\n               MOVE ACSADL2I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-2\n           END-IF\n\n           IF  ACSCITYI OF CACTUPAI = '*'\n           OR  ACSCITYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-3\n           ELSE\n               MOVE ACSCITYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-3\n           END-IF\n\n           IF  ACSSTTEI OF CACTUPAI = '*'\n           OR  ACSSTTEI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-STATE-CD\n           ELSE\n               MOVE ACSSTTEI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-STATE-CD\n           END-IF\n\n           IF  ACSCTRYI OF CACTUPAI = '*'\n           OR  ACSCTRYI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           ELSE\n              MOVE ACSCTRYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           END-IF\n\n           IF  ACSZIPCI OF CACTUPAI = '*'\n           OR  ACSZIPCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-ZIP\n           ELSE\n               MOVE ACSZIPCI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-ZIP\n           END-IF\n\n           IF  ACSPH1AI OF CACTUPAI = '*'\n           OR  ACSPH1AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1A\n           ELSE\n               MOVE ACSPH1AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1A\n           END-IF\n\n           IF  ACSPH1BI OF CACTUPAI = '*'\n           OR  ACSPH1BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1B\n           ELSE\n               MOVE ACSPH1BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1B\n           END-IF\n\n           IF  ACSPH1CI OF CACTUPAI = '*'\n           OR  ACSPH1CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1C\n           ELSE\n               MOVE ACSPH1CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1C\n           END-IF\n\n           IF  ACSPH2AI OF CACTUPAI = '*'\n           OR  ACSPH2AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2A\n           ELSE\n               MOVE ACSPH2AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2A\n           END-IF\n\n           IF  ACSPH2BI OF CACTUPAI = '*'\n           OR  ACSPH2BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2B\n           ELSE\n               MOVE ACSPH2BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2B\n           END-IF\n\n           IF  ACSPH2CI OF CACTUPAI = '*'\n           OR  ACSPH2CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2C\n           ELSE\n               MOVE ACSPH2CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2C\n           END-IF\n      *\n      *Government Id\n      *\n           IF  ACSGOVTI OF CACTUPAI = '*'\n           OR  ACSGOVTI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           ELSE\n               MOVE ACSGOVTI OF CACTUPAI TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           END-IF\n      *\n      *EFT Code\n      *\n           IF  ACSEFTCI OF CACTUPAI = '*'\n           OR  ACSEFTCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           ELSE\n               MOVE ACSEFTCI OF CACTUPAI TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           END-IF\n      *\n      *Primary Holder Indicator\n      *\n           IF  ACSPFLGI OF CACTUPAI = '*'\n           OR  ACSPFLGI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES            TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           ELSE\n              MOVE ACSPFLGI OF CACTUPAI  TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           END-IF\n           .\n       1100-RECEIVE-MAP-EXIT.\n           EXIT\n           .\n       1200-EDIT-MAP-INPUTS.\n\n           SET INPUT-OK                  TO TRUE\n\n           IF  ACUP-DETAILS-NOT-FETCHED\n      *        VALIDATE THE SEARCH KEYS\n               PERFORM 1210-EDIT-ACCOUNT\n                  THRU 1210-EDIT-ACCOUNT-EXIT\n\n               MOVE LOW-VALUES           TO ACUP-OLD-ACCT-DATA\n\n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS FLAG THEM\n              IF  FLG-ACCTFILTER-BLANK\n                  SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE\n              END-IF\n\n      *       AT THIS STAGE. NO DETAILS FETCHED. NOTHING MORE TO EDIT.\n              GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n      *\n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED\n           SET FOUND-ACCOUNT-DATA        TO TRUE\n           SET FOUND-ACCT-IN-MASTER      TO TRUE\n           SET FLG-ACCTFILTER-ISVALID    TO TRUE\n\n           SET FOUND-CUST-IN-MASTER      TO TRUE\n           SET FLG-CUSTFILTER-ISVALID    TO TRUE\n\n      *\n           PERFORM 1205-COMPARE-OLD-NEW\n              THRU 1205-COMPARE-OLD-NEW-EXIT\n\n           IF  NO-CHANGES-FOUND\n           OR  ACUP-CHANGES-OK-NOT-CONFIRMED\n           OR  ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE LOW-VALUES           TO WS-NON-KEY-FLAGS\n               GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           END-IF\n\n           SET ACUP-CHANGES-NOT-OK       TO TRUE\n\n           MOVE 'Account Status'          TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-ACTIVE-STATUS    TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO            TO WS-EDIT-ACCT-STATUS\n\n           MOVE 'Open Date'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-OPEN-DATE       TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-OPEN-DATE-FLGS\n\n           MOVE 'Credit Limit'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CREDIT-LIMIT-X  TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT  TO WS-EDIT-CREDIT-LIMIT\n\n           MOVE 'Expiry Date'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-EXPIRAION-DATE  TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EXPIRY-DATE-FLGS\n\n           MOVE 'Cash Credit Limit'      TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT TO WS-EDIT-CASH-CREDIT-LIMIT\n\n           MOVE 'Reissue Date'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-REISSUE-DATE    TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-REISSUE-DATE-FLGS\n\n           MOVE 'Current Balance'        TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-BAL-X      TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-BAL\n\n           MOVE 'Current Cycle Credit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-CREDIT\n\n           MOVE 'Current Cycle Debit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-DEBIT\n\n           MOVE 'SSN'                    TO WS-EDIT-VARIABLE-NAME\n           PERFORM 1265-EDIT-US-SSN\n              THRU 1265-EDIT-US-SSN-EXIT\n\n           MOVE 'Date of Birth'          TO WS-EDIT-VARIABLE-NAME\n           MOVE   ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                         TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-DT-OF-BIRTH-FLGS\n           IF WS-EDIT-DT-OF-BIRTH-ISVALID\n              PERFORM  EDIT-DATE-OF-BIRTH\n                 THRU  EDIT-DATE-OF-BIRTH-EXIT\n              MOVE WS-EDIT-DATE-FLGS    TO WS-EDIT-DT-OF-BIRTH-FLGS\n           END-IF\n\n           MOVE 'FICO Score'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-FICO-SCORE-FLGS\n           IF FLG-FICO-SCORE-ISVALID\n              PERFORM  1275-EDIT-FICO-SCORE\n                 THRU  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n      ******************************************************************\n      *    Edit names\n      ******************************************************************\n           MOVE 'First Name'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FIRST-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-FIRST-NAME-FLGS\n\n           MOVE 'Middle Name'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1235-EDIT-ALPHA-OPT\n              THRU 1235-EDIT-ALPHA-OPT-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-MIDDLE-NAME-FLGS\n\n           MOVE 'Last Name'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-LAST-NAME  TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                        TO WS-EDIT-LAST-NAME-FLGS\n\n           MOVE 'Address Line 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1215-EDIT-MANDATORY\n              THRU 1215-EDIT-MANDATORY-EXIT\n           MOVE WS-EDIT-MANDATORY-FLAGS\n                                         TO WS-EDIT-ADDRESS-LINE-1-FLGS\n\n           MOVE 'State'                  TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-STATE-FLGS\n           IF FLG-ALPHA-ISVALID\n           PERFORM 1270-EDIT-US-STATE-CD\n              THRU 1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n\n\n           MOVE 'Zip'                    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-ZIP   TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 5                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-ZIPCODE-FLGS\n\n      *    Address Line 2 is optional\n      *    MOVE 'Address Line 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE 'City'                   TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-CITY-FLGS\n\n           MOVE 'Country'                TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                        TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-COUNTRY-FLGS\n\n           MOVE 'Phone Number 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO  WS-EDIT-PHONE-NUM-1-FLGS\n\n           MOVE 'Phone Number 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO WS-EDIT-PHONE-NUM-2-FLGS\n\n           MOVE 'EFT Account Id'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 10                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EFT-ACCOUNT-ID-FLGS\n\n           MOVE 'Primary Card Holder'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO           TO WS-EDIT-PRI-CARDHOLDER\n\n      *    Cross field edits begin here\n           IF  FLG-STATE-ISVALID\n           AND FLG-ZIPCODE-ISVALID\n               PERFORM 1280-EDIT-US-STATE-ZIP-CD\n                  THRU 1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n\n           IF INPUT-ERROR\n              CONTINUE\n           ELSE\n              SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n           END-IF\n           .\n\n       1200-EDIT-MAP-INPUTS-EXIT.\n           EXIT\n           .\n       1205-COMPARE-OLD-NEW.\n           SET NO-CHANGES-FOUND           TO TRUE\n\n           IF  ACUP-NEW-ACCT-ID-X         = ACUP-OLD-ACCT-ID-X\n           AND FUNCTION UPPER-CASE (\n               ACUP-NEW-ACTIVE-STATUS)    =\n               FUNCTION UPPER-CASE (\n               ACUP-OLD-ACTIVE-STATUS)\n           AND ACUP-NEW-CURR-BAL          = ACUP-OLD-CURR-BAL\n           AND ACUP-NEW-CREDIT-LIMIT      = ACUP-OLD-CREDIT-LIMIT\n           AND ACUP-NEW-CASH-CREDIT-LIMIT = ACUP-OLD-CASH-CREDIT-LIMIT\n           AND ACUP-NEW-OPEN-DATE         = ACUP-OLD-OPEN-DATE\n           AND ACUP-NEW-EXPIRAION-DATE    = ACUP-OLD-EXPIRAION-DATE\n           AND ACUP-NEW-REISSUE-DATE      = ACUP-OLD-REISSUE-DATE\n           AND ACUP-NEW-CURR-CYC-CREDIT   = ACUP-OLD-CURR-CYC-CREDIT\n           AND ACUP-NEW-CURR-CYC-DEBIT    = ACUP-OLD-CURR-CYC-DEBIT\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-GROUP-ID))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-GROUP-ID))\n               CONTINUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n\n           IF  FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ID-X))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ID-X))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-FIRST-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-FIRST-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-MIDDLE-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-MIDDLE-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-LAST-NAME))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-LAST-NAME))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-1))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-1))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-2))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-2))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-3))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-3))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-STATE-CD))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-STATE-CD))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-COUNTRY-CD))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-COUNTRY-CD))\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-ADDR-ZIP))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-ADDR-ZIP))\n           AND ACUP-NEW-CUST-PHONE-NUM-1A = ACUP-OLD-CUST-PHONE-NUM-1A\n           AND ACUP-NEW-CUST-PHONE-NUM-1B = ACUP-OLD-CUST-PHONE-NUM-1B\n           AND ACUP-NEW-CUST-PHONE-NUM-1C = ACUP-OLD-CUST-PHONE-NUM-1C\n           AND ACUP-NEW-CUST-PHONE-NUM-2A = ACUP-OLD-CUST-PHONE-NUM-2A\n           AND ACUP-NEW-CUST-PHONE-NUM-2B = ACUP-OLD-CUST-PHONE-NUM-2B\n           AND ACUP-NEW-CUST-PHONE-NUM-2C = ACUP-OLD-CUST-PHONE-NUM-2C\n           AND ACUP-NEW-CUST-SSN-X       = ACUP-OLD-CUST-SSN-X\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-GOVT-ISSUED-ID ))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-GOVT-ISSUED-ID))\n           AND ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                     = ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           AND ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                     = ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-NEW-CUST-PRI-HOLDER-IND))=\n               FUNCTION UPPER-CASE (\n               FUNCTION TRIM (ACUP-OLD-CUST-PRI-HOLDER-IND))\n           AND ACUP-NEW-CUST-FICO-SCORE-X\n                                     = ACUP-OLD-CUST-FICO-SCORE-X\n               SET NO-CHANGES-DETECTED   TO TRUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n           .\n\n       1205-COMPARE-OLD-NEW-EXIT.\n           EXIT\n           .\n\n\n      *\n       1210-EDIT-ACCOUNT.\n           SET FLG-ACCTFILTER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF CC-ACCT-ID   EQUAL LOW-VALUES\n           OR CC-ACCT-ID   EQUAL SPACES\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ACCTFILTER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 SET WS-PROMPT-FOR-ACCT TO TRUE\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n                                           ACUP-NEW-ACCT-ID\n              GO TO  1210-EDIT-ACCOUNT-EXIT\n           END-IF\n\n      *    Not numeric\n      *    Not 11 characters\n           MOVE CC-ACCT-ID              TO ACUP-NEW-ACCT-ID\n           IF CC-ACCT-ID   IS NOT NUMERIC\n           OR CC-ACCT-ID-N EQUAL ZEROS\n              SET INPUT-ERROR TO TRUE\n              IF WS-RETURN-MSG-OFF\n                STRING\n                 'Account Number if supplied must be a 11 digit'\n                 ' Non-Zero Number'\n                DELIMITED BY SIZE\n                INTO WS-RETURN-MSG\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n              GO TO 1210-EDIT-ACCOUNT-EXIT\n           ELSE\n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID\n              SET FLG-ACCTFILTER-ISVALID TO TRUE\n           END-IF\n           .\n\n       1210-EDIT-ACCOUNT-EXIT.\n           EXIT\n           .\n\n       1215-EDIT-MANDATORY.\n      *    Initialize\n           SET FLG-MANDATORY-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR          TO TRUE\n              SET FLG-MANDATORY-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1215-EDIT-MANDATORY-EXIT\n           END-IF\n\n           SET FLG-MANDATORY-ISVALID   TO TRUE\n           .\n       1215-EDIT-MANDATORY-EXIT.\n           EXIT\n           .\n\n       1220-EDIT-YESNO.\n      *    Must be Y or N\n      *    SET FLG-YES-NO-NOT-OK         TO TRUE\n      *\n      *    Not supplied\n           IF WS-EDIT-YES-NO             EQUAL LOW-VALUES\n           OR WS-EDIT-YES-NO             EQUAL SPACES\n           OR WS-EDIT-YES-NO             EQUAL ZEROS\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-YES-NO-BLANK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n\n\n           IF FLG-YES-NO-ISVALID\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-YES-NO-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be Y or N.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n           .\n       1220-EDIT-YESNO-EXIT.\n           EXIT\n           .\n\n       1225-EDIT-ALPHA-REQD.\n      *    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHA-BLANK            TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X   TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .\n       1225-EDIT-ALPHA-REQD-EXIT.\n           EXIT\n           .\n\n       1230-EDIT-ALPHANUM-REQD.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets,numbers and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n       1230-EDIT-ALPHANUM-REQD-EXIT.\n           EXIT\n           .\n       1235-EDIT-ALPHA-OPT.\n      *    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET FLG-ALPHA-ISVALID          TO TRUE\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X    TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .\n       1235-EDIT-ALPHA-OPT-EXIT.\n           EXIT\n           .\n\n       1240-EDIT-ALPHANUM-OPT.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied, but ok as optional\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n              SET FLG-ALPHNANUM-ISVALID     TO TRUE\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF FUNCTION LENGTH(\n                   FUNCTION TRIM(\n                   WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                  )) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n       1240-EDIT-ALPHANUM-OPT-EXIT.\n           EXIT\n           .\n\n       1245-EDIT-NUM-REQD.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR FUNCTION LENGTH(FUNCTION TRIM(\n              WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Only all numeric allowed\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                  IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be all numeric.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Must not be zero\n\n           IF FUNCTION NUMVAL(WS-EDIT-ALPHANUM-ONLY(1:\n                              WS-EDIT-ALPHANUM-LENGTH)) = 0\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must not be zero.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n       1245-EDIT-NUM-REQD-EXIT.\n           EXIT\n           .\n\n       1250-EDIT-SIGNED-9V2.\n           SET FLG-SIGNED-NUMBER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL LOW-VALUES\n           OR WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-SIGNED-NUMBER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF FUNCTION TEST-NUMVAL-C(WS-EDIT-SIGNED-NUMBER-9V2-X) = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-SIGNED-NUMBER-NOT-OK   TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' is not valid'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n\n           END-IF\n\n      *    If we got here all edits were cleared\n           SET FLG-SIGNED-NUMBER-ISVALID  TO TRUE\n           .\n\n       1250-EDIT-SIGNED-9V2-EXIT.\n           EXIT\n           .\n\n       1260-EDIT-US-PHONE-NUM.\n\n      *    The database stores date in X(15) format (999)999-9999\n      *                                             1234567890123\n      *    So we take the X(15) input into WS-EDIT-US-PHONE-NUM\n      *    and edit it\n\n           SET WS-EDIT-US-PHONE-IS-INVALID TO TRUE\n      *    Not mandatory to enter a phone number\n           IF  (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES)\n                SET WS-EDIT-US-PHONE-IS-VALID TO TRUE\n                GO TO EDIT-US-PHONE-EXIT\n           ELSE\n                CONTINUE\n           END-IF\n           .\n       EDIT-AREA-CODE.\n           IF WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEA-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA       IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Area code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           MOVE FUNCTION TRIM (WS-EDIT-US-PHONE-NUMA)\n             TO WS-US-PHONE-AREA-CODE-TO-EDIT\n           IF VALID-GENERAL-PURP-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Not valid North America general purpose area code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           SET FLG-EDIT-US-PHONEA-ISVALID    TO TRUE\n           .\n       EDIT-US-PHONE-PREFIX.\n\n           IF WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEB-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Prefix code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           SET FLG-EDIT-US-PHONEB-ISVALID    TO TRUE\n           .\n\n       EDIT-US-PHONE-LINENUM.\n           IF WS-EDIT-US-PHONE-NUMC EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEC-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO EDIT-US-PHONE-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code must be A 4 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Line number code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n\n\n           SET FLG-EDIT-US-PHONEC-ISVALID    TO TRUE\n           .\n\n       EDIT-US-PHONE-EXIT.\n           EXIT\n           .\n       1260-EDIT-US-PHONE-NUM-EXIT.\n           EXIT\n           .\n\n       1265-EDIT-US-SSN.\n      *Format xxx-xx-xxxx\n      *Part1 :should have 3 digits\n      *Part2 :should have 2 digits and it should be from 01 to 99\n      *Part3 should have 4 digits from 0001 to 9999.\n      ******************************************************************\n      *    Edit SSN Part 1\n      ******************************************************************\n           MOVE 'SSN: First 3 chars'     TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-1      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART1-FLGS\n\n      *Part1 :should not be 000, 666, or between 900 and 999\n           IF FLG-EDIT-US-SSN-PART1-ISVALID\n              MOVE ACUP-NEW-CUST-SSN-1   TO WS-EDIT-US-SSN-PART1\n              IF INVALID-SSN-PART1\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-EDIT-US-SSN-PART1-NOT-OK\n                                 TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': should not be 000, 666, or between 900 and 999'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              ELSE\n                CONTINUE\n              END-IF\n           END-IF\n\n      ******************************************************************\n      *    Edit SSN Part 2\n      ******************************************************************\n           MOVE 'SSN 4th & 5th chars'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-2      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART2-FLGS\n\n\n      ******************************************************************\n      *    Edit SSN Part 3\n      ******************************************************************\n           MOVE 'SSN Last 4 chars'       TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-3      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 4                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART3-FLGS\n           .\n       1265-EDIT-US-SSN-EXIT.\n           EXIT\n           .\n\n       1270-EDIT-US-STATE-CD.\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO US-STATE-CODE-TO-EDIT\n           IF VALID-US-STATE-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': is not a valid state code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n           .\n       1270-EDIT-US-STATE-CD-EXIT.\n           EXIT\n           .\n       1275-EDIT-FICO-SCORE.\n           IF FICO-RANGE-IS-VALID\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-FICO-SCORE-NOT-OK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': should be between 300 and 850'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n           .\n       1275-EDIT-FICO-SCORE-EXIT.\n           EXIT\n           .\n\n      *A crude zip code edit based on data from USPS web site\n       1280-EDIT-US-STATE-ZIP-CD.\n           STRING ACUP-NEW-CUST-ADDR-STATE-CD\n                  ACUP-NEW-CUST-ADDR-ZIP(1:2)\n             DELIMITED BY SIZE\n             INTO US-STATE-AND-FIRST-ZIP2\n\n           IF VALID-US-STATE-ZIP-CD2-COMBO\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              SET FLG-ZIPCODE-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   'Invalid zip code for state'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n           .\n       1280-EDIT-US-STATE-ZIP-CD-EXIT.\n           EXIT\n           .\n\n       2000-DECIDE-ACTION.\n           EVALUATE TRUE\n      ******************************************************************\n      *       NO DETAILS SHOWN.\n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      ******************************************************************\n      *       CHANGES MADE. BUT USER CANCELS\n      ******************************************************************\n              WHEN CCARD-AID-PFK12\n                 IF  FLG-ACCTFILTER-ISVALID\n                     SET WS-RETURN-MSG-OFF       TO TRUE\n                     PERFORM 9000-READ-ACCT\n                        THRU 9000-READ-ACCT-EXIT\n                     IF FOUND-CUST-IN-MASTER\n                        SET ACUP-SHOW-DETAILS    TO TRUE\n                     END-IF\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD\n      ******************************************************************\n              WHEN ACUP-SHOW-DETAILS\n                 IF INPUT-ERROR\n                 OR NO-CHANGES-DETECTED\n                    CONTINUE\n                 ELSE\n                    SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       BUT INPUT EDIT ERRORS FOUND\n      ******************************************************************\n              WHEN ACUP-CHANGES-NOT-OK\n                  CONTINUE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n               AND CCARD-AID-PFK05\n                 PERFORM 9600-WRITE-PROCESSING\n                    THRU 9600-WRITE-PROCESSING-EXIT\n                 EVALUATE TRUE\n                    WHEN COULD-NOT-LOCK-ACCT-FOR-UPDATE\n                         SET ACUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE\n                    WHEN LOCKED-BUT-UPDATE-FAILED\n                       SET ACUP-CHANGES-OKAYED-BUT-FAILED TO TRUE\n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE\n                        SET ACUP-SHOW-DETAILS            TO TRUE\n                    WHEN OTHER\n                       SET ACUP-CHANGES-OKAYED-AND-DONE   TO TRUE\n                 END-EVALUATE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                  CONTINUE\n      ******************************************************************\n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                  SET ACUP-SHOW-DETAILS TO TRUE\n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                  OR CDEMO-FROM-TRANID    EQUAL SPACES\n                     MOVE ZEROES       TO CDEMO-ACCT-ID\n                                          CDEMO-CARD-NUM\n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS\n                  END-IF\n              WHEN OTHER\n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT\n                   MOVE '0001'         TO ABEND-CODE\n                   MOVE SPACES         TO ABEND-REASON\n                   MOVE 'UNEXPECTED DATA SCENARIO'\n                                       TO ABEND-MSG\n                   PERFORM ABEND-ROUTINE\n                      THRU ABEND-ROUTINE-EXIT\n           END-EVALUATE\n           .\n       2000-DECIDE-ACTION-EXIT.\n           EXIT\n           .\n\n\n\n       3000-SEND-MAP.\n           PERFORM 3100-SCREEN-INIT\n              THRU 3100-SCREEN-INIT-EXIT\n           PERFORM 3200-SETUP-SCREEN-VARS\n              THRU 3200-SETUP-SCREEN-VARS-EXIT\n           PERFORM 3250-SETUP-INFOMSG\n              THRU 3250-SETUP-INFOMSG-EXIT\n           PERFORM 3300-SETUP-SCREEN-ATTRS\n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT\n           PERFORM 3390-SETUP-INFOMSG-ATTRS\n              THRU 3390-SETUP-INFOMSG-ATTRS-EXIT\n           PERFORM 3400-SEND-SCREEN\n              THRU 3400-SEND-SCREEN-EXIT\n           .\n\n       3000-SEND-MAP-EXIT.\n           EXIT\n           .\n\n       3100-SCREEN-INIT.\n           MOVE LOW-VALUES TO CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01              TO TITLE01O OF CACTUPAO\n           MOVE CCDA-TITLE02              TO TITLE02O OF CACTUPAO\n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CACTUPAO\n           MOVE LIT-THISPGM               TO PGMNAMEO OF CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CACTUPAO\n\n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CACTUPAO\n\n           .\n\n       3100-SCREEN-INIT-EXIT.\n           EXIT\n           .\n\n       3200-SETUP-SCREEN-VARS.\n      *    INITIALIZE SEARCH CRITERIA\n           IF CDEMO-PGM-ENTER\n              CONTINUE\n           ELSE\n              IF CC-ACCT-ID-N = 0\n              AND FLG-ACCTFILTER-ISVALID\n                 MOVE LOW-VALUES                TO ACCTSIDO OF CACTUPAO\n              ELSE\n                 MOVE CC-ACCT-ID                TO ACCTSIDO OF CACTUPAO\n              END-IF\n\n              EVALUATE TRUE\n                WHEN ACUP-DETAILS-NOT-FETCHED\n                WHEN CC-ACCT-ID-N =  0\n                  PERFORM 3201-SHOW-INITIAL-VALUES\n                     THRU 3201-SHOW-INITIAL-VALUES-EXIT\n               WHEN ACUP-SHOW-DETAILS\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n               WHEN ACUP-CHANGES-MADE\n                  PERFORM 3203-SHOW-UPDATED-VALUES\n                     THRU 3203-SHOW-UPDATED-VALUES-EXIT\n               WHEN OTHER\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n              END-EVALUATE\n            END-IF\n           .\n       3200-SETUP-SCREEN-VARS-EXIT.\n           EXIT\n           .\n\n       3201-SHOW-INITIAL-VALUES.\n           MOVE LOW-VALUES                     TO  ACSTTUSO OF CACTUPAO\n                                                   ACRDLIMO OF CACTUPAO\n      *Account Limits\n                                                   ACURBALO OF CACTUPAO\n                                                   ACSHLIMO OF CACTUPAO\n                                                   ACRCYCRO OF CACTUPAO\n                                                   ACRCYDBO OF CACTUPAO\n      *Account Dates\n                                                   OPNYEARO OF CACTUPAO\n                                                   OPNMONO  OF CACTUPAO\n                                                   OPNDAYO  OF CACTUPAO\n                                                   EXPYEARO OF CACTUPAO\n                                                   EXPMONO  OF CACTUPAO\n                                                   EXPDAYO  OF CACTUPAO\n                                                   RISYEARO OF CACTUPAO\n                                                   RISMONO  OF CACTUPAO\n                                                   RISDAYO  OF CACTUPAO\n                                                   AADDGRPO OF CACTUPAO\n      *Customer data\n                                                   ACSTNUMO OF CACTUPAO\n                                                   ACTSSN1O OF CACTUPAO\n                                                   ACTSSN2O OF CACTUPAO\n                                                   ACTSSN3O OF CACTUPAO\n                                                   ACSTFCOO OF CACTUPAO\n                                                   DOBYEARO OF CACTUPAO\n                                                   DOBMONO  OF CACTUPAO\n                                                   DOBDAYO  OF CACTUPAO\n                                                   ACSFNAMO OF CACTUPAO\n                                                   ACSMNAMO OF CACTUPAO\n                                                   ACSLNAMO OF CACTUPAO\n      *Customer address and contact info\n                                                   ACSADL1O OF CACTUPAO\n                                                   ACSADL2O OF CACTUPAO\n                                                   ACSCITYO OF CACTUPAO\n                                                   ACSSTTEO OF CACTUPAO\n                                                   ACSZIPCO OF CACTUPAO\n                                                   ACSCTRYO OF CACTUPAO\n\n                                                   ACSPH1AO OF CACTUPAO\n                                                   ACSPH1BO OF CACTUPAO\n                                                   ACSPH1CO OF CACTUPAO\n                                                   ACSPH2AO OF CACTUPAO\n                                                   ACSPH2BO OF CACTUPAO\n                                                   ACSPH2CO OF CACTUPAO\n\n      *Customer other good stuff\n                                                   ACSGOVTO OF CACTUPAO\n                                                   ACSEFTCO OF CACTUPAO\n                                                   ACSPFLGO OF CACTUPAO\n           .\n\n       3201-SHOW-INITIAL-VALUES-EXIT.\n           EXIT\n           .\n\n       3202-SHOW-ORIGINAL-VALUES.\n\n           MOVE LOW-VALUES                     TO WS-NON-KEY-FLAGS\n\n           SET PROMPT-FOR-CHANGES              TO TRUE\n\n           IF FOUND-ACCT-IN-MASTER\n           OR FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-ACTIVE-STATUS      TO ACSTTUSO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n\n              MOVE ACUP-OLD-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n\n              MOVE ACUP-OLD-OPEN-YEAR          TO OPNYEARO OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-MON           TO OPNMONO  OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-DAY           TO OPNDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-EXP-YEAR           TO EXPYEARO OF CACTUPAO\n              MOVE ACUP-OLD-EXP-MON            TO EXPMONO  OF CACTUPAO\n              MOVE ACUP-OLD-EXP-DAY            TO EXPDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-REISSUE-YEAR       TO RISYEARO OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-MON        TO RISMONO  OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-DAY        TO RISDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-GROUP-ID           TO AADDGRPO OF CACTUPAO\n           END-IF\n\n           IF FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-CUST-ID-X          TO ACSTNUMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(1:3)    TO ACTSSN1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(4:2)    TO ACTSSN2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(6:4)    TO ACTSSN3O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FICO-SCORE-X  TO ACSTFCOO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-YEAR      TO DOBYEARO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-MON       TO DOBMONO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-DAY       TO DOBDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FIRST-NAME    TO ACSFNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-MIDDLE-NAME   TO ACSMNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-LAST-NAME     TO ACSLNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-1   TO ACSADL1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-2   TO ACSADL2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-3   TO ACSCITYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-STATE-CD TO ACSSTTEO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-ZIP      TO ACSZIPCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-COUNTRY-CD\n                                               TO ACSCTRYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(2:3)\n                                               TO ACSPH1AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(6:3)\n                                               TO ACSPH1BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(10:4)\n                                               TO ACSPH1CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(2:3)\n                                               TO ACSPH2AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(6:3)\n                                               TO ACSPH2BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(10:4)\n                                               TO ACSPH2CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-GOVT-ISSUED-ID\n                                               TO ACSGOVTO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-EFT-ACCOUNT-ID\n                                               TO ACSEFTCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PRI-HOLDER-IND\n                                               TO ACSPFLGO OF CACTUPAO\n           END-IF\n           .\n\n       3202-SHOW-ORIGINAL-VALUES-EXIT.\n           EXIT\n           .\n       3203-SHOW-UPDATED-VALUES.\n\n           MOVE ACUP-NEW-ACTIVE-STATUS         TO ACSTTUSO OF CACTUPAO\n\n           IF FLG-CRED-LIMIT-ISVALID\n              MOVE ACUP-NEW-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CREDIT-LIMIT-X     TO ACRDLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CASH-CREDIT-LIMIT-ISVALID\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                               TO ACSHLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-BAL-ISVALID\n              MOVE ACUP-NEW-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-BAL-X         TO ACURBALO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-CREDIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-X  TO ACRCYCRO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-DEBIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-X   TO ACRCYDBO OF CACTUPAO\n           END-IF\n\n           MOVE ACUP-NEW-OPEN-YEAR             TO OPNYEARO OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-MON              TO OPNMONO  OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-DAY              TO OPNDAYO  OF CACTUPAO\n\n           MOVE ACUP-NEW-EXP-YEAR              TO EXPYEARO OF CACTUPAO\n           MOVE ACUP-NEW-EXP-MON               TO EXPMONO  OF CACTUPAO\n           MOVE ACUP-NEW-EXP-DAY               TO EXPDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-YEAR          TO RISYEARO OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-MON           TO RISMONO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-DAY           TO RISDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-GROUP-ID              TO AADDGRPO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ID-X             TO ACSTNUMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-1            TO ACTSSN1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-2            TO ACTSSN2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-3            TO ACTSSN3O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X     TO ACSTFCOO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-YEAR         TO DOBYEARO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-MON          TO DOBMONO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-DAY          TO DOBDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FIRST-NAME       TO ACSFNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME      TO ACSMNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-LAST-NAME        TO ACSLNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1      TO ACSADL1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-2      TO ACSADL2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3      TO ACSCITYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD    TO ACSSTTEO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-ZIP         TO ACSZIPCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD  TO ACSCTRYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1A     TO ACSPH1AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1B     TO ACSPH1BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1C     TO ACSPH1CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2A     TO ACSPH2AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2B     TO ACSPH2BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2C     TO ACSPH2CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-GOVT-ISSUED-ID   TO ACSGOVTO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID   TO ACSEFTCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND   TO ACSPFLGO OF CACTUPAO\n\n           .\n\n       3203-SHOW-UPDATED-VALUES-EXIT.\n           EXIT\n           .\n\n       3250-SETUP-INFOMSG.\n      *    SETUP INFORMATION MESSAGE\n           EVALUATE TRUE\n               WHEN CDEMO-PGM-ENTER\n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE\n               WHEN ACUP-DETAILS-NOT-FETCHED\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n               WHEN ACUP-SHOW-DETAILS\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-NOT-OK\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE\n\n               WHEN ACUP-CHANGES-OKAYED-LOCK-ERROR\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-BUT-FAILED\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN WS-NO-INFO-MESSAGE\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n           END-EVALUATE\n\n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CACTUPAO\n\n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CACTUPAO\n           .\n       3250-SETUP-INFOMSG-EXIT.\n           EXIT\n           .\n       3300-SETUP-SCREEN-ATTRS.\n\n      *    PROTECT ALL FIELDS\n           PERFORM 3310-PROTECT-ALL-ATTRS\n              THRU 3310-PROTECT-ALL-ATTRS-EXIT\n\n      *    UNPROTECT BASED ON CONTEXT\n           EVALUATE TRUE\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      *            Make Account Id editable\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n              WHEN  ACUP-SHOW-DETAILS\n              WHEN  ACUP-CHANGES-NOT-OK\n                   PERFORM 3320-UNPROTECT-FEW-ATTRS\n                      THRU 3320-UNPROTECT-FEW-ATTRS-EXIT\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                   CONTINUE\n              WHEN OTHER\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n           END-EVALUATE\n\n      *    POSITION CURSOR - ORDER BASED ON SCREEN LOCATION\n           EVALUATE TRUE\n              WHEN FOUND-ACCOUNT-DATA\n              WHEN NO-CHANGES-DETECTED\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n              WHEN FLG-ACCTFILTER-NOT-OK\n              WHEN FLG-ACCTFILTER-BLANK\n                   MOVE -1             TO ACCTSIDL OF CACTUPAI\n      *    Account Status\n              WHEN FLG-ACCT-STATUS-NOT-OK\n              WHEN FLG-ACCT-STATUS-BLANK\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n      *    Open Year\n              WHEN FLG-OPEN-YEAR-NOT-OK\n              WHEN FLG-OPEN-YEAR-BLANK\n                  MOVE -1              TO OPNYEARL OF CACTUPAI\n      *    Open Month\n              WHEN FLG-OPEN-MONTH-NOT-OK\n              WHEN FLG-OPEN-MONTH-BLANK\n                  MOVE -1              TO OPNMONL  OF CACTUPAI\n      *    Open Day\n              WHEN FLG-OPEN-DAY-NOT-OK\n              WHEN FLG-OPEN-DAY-BLANK\n                  MOVE -1              TO OPNDAYL  OF CACTUPAI\n      *    Credit Limit\n              WHEN FLG-CRED-LIMIT-NOT-OK\n              WHEN FLG-CRED-LIMIT-BLANK\n                  MOVE -1              TO ACRDLIML OF CACTUPAI\n      *    Expiry Year\n              WHEN FLG-EXPIRY-YEAR-NOT-OK\n              WHEN FLG-EXPIRY-YEAR-BLANK\n                  MOVE -1              TO EXPYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-EXPIRY-MONTH-NOT-OK\n              WHEN FLG-EXPIRY-MONTH-BLANK\n                  MOVE -1              TO EXPMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-EXPIRY-DAY-NOT-OK\n              WHEN FLG-EXPIRY-DAY-BLANK\n                  MOVE -1              TO EXPDAYL  OF CACTUPAI\n      *    Cash credit limit\n              WHEN FLG-CASH-CREDIT-LIMIT-NOT-OK\n              WHEN FLG-CASH-CREDIT-LIMIT-BLANK\n                  MOVE -1              TO ACSHLIML OF CACTUPAI\n      *    Reissue Year\n              WHEN FLG-REISSUE-YEAR-NOT-OK\n              WHEN FLG-REISSUE-YEAR-BLANK\n                  MOVE -1              TO RISYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-REISSUE-MONTH-NOT-OK\n              WHEN FLG-REISSUE-MONTH-BLANK\n                  MOVE -1              TO RISMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-REISSUE-DAY-NOT-OK\n              WHEN FLG-REISSUE-DAY-BLANK\n                  MOVE -1              TO RISDAYL  OF CACTUPAI\n\n      *    Current Balance\n              WHEN FLG-CURR-BAL-NOT-OK\n              WHEN FLG-CURR-BAL-BLANK\n                  MOVE -1              TO ACURBALL OF CACTUPAI\n      *    Current Cycle Credit\n              WHEN FLG-CURR-CYC-CREDIT-NOT-OK\n              WHEN FLG-CURR-CYC-CREDIT-BLANK\n                  MOVE -1              TO ACRCYCRL OF CACTUPAI\n      *    Current Cycle Debit\n              WHEN FLG-CURR-CYC-DEBIT-NOT-OK\n              WHEN FLG-CURR-CYC-DEBIT-BLANK\n                  MOVE -1              TO ACRCYDBL OF CACTUPAI\n      *    SSN Part 1\n              WHEN FLG-EDIT-US-SSN-PART1-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART1-BLANK\n                  MOVE -1              TO ACTSSN1L OF CACTUPAI\n      *    SSN Part 2\n              WHEN FLG-EDIT-US-SSN-PART2-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART2-BLANK\n                  MOVE -1              TO ACTSSN2L  OF CACTUPAI\n      *    SSN Part 3\n              WHEN FLG-EDIT-US-SSN-PART3-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART3-BLANK\n                  MOVE -1              TO ACTSSN3L  OF CACTUPAI\n      *    Date of Birth Year\n              WHEN FLG-DT-OF-BIRTH-YEAR-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-YEAR-BLANK\n                  MOVE -1              TO DOBYEARL OF CACTUPAI\n      *    Date of Birth Month\n              WHEN FLG-DT-OF-BIRTH-MONTH-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-MONTH-BLANK\n                  MOVE -1              TO DOBMONL  OF CACTUPAI\n      *    Date of Birth Day\n              WHEN FLG-DT-OF-BIRTH-DAY-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-DAY-BLANK\n                  MOVE -1              TO DOBDAYL  OF CACTUPAI\n      *    FICO Score\n              WHEN FLG-FICO-SCORE-NOT-OK\n              WHEN FLG-FICO-SCORE-BLANK\n                  MOVE -1              TO ACSTFCOL OF CACTUPAI\n      *    First Name\n              WHEN FLG-FIRST-NAME-NOT-OK\n              WHEN FLG-FIRST-NAME-BLANK\n                  MOVE -1              TO ACSFNAML OF CACTUPAI\n      *    Middle Name\n              WHEN FLG-MIDDLE-NAME-NOT-OK\n                  MOVE -1              TO ACSMNAML OF CACTUPAI\n      *    Last Name\n              WHEN FLG-LAST-NAME-NOT-OK\n              WHEN FLG-LAST-NAME-BLANK\n                  MOVE -1              TO ACSLNAML OF CACTUPAI\n      *    Address Line 1\n              WHEN FLG-ADDRESS-LINE-1-NOT-OK\n              WHEN FLG-ADDRESS-LINE-1-BLANK\n                  MOVE -1              TO ACSADL1L OF CACTUPAI\n      *    State (appears next to Line 2 on screen before city)\n              WHEN FLG-STATE-NOT-OK\n              WHEN FLG-STATE-BLANK\n                  MOVE -1              TO ACSSTTEL OF CACTUPAI\n      *    Address Line 2 has no edits\n      *    Zip code\n              WHEN FLG-ZIPCODE-NOT-OK\n              WHEN FLG-ZIPCODE-BLANK\n                  MOVE -1              TO ACSZIPCL OF CACTUPAI\n      *    Address Line 3 (City)\n              WHEN FLG-CITY-NOT-OK\n              WHEN FLG-CITY-BLANK\n                  MOVE -1              TO ACSCITYL OF CACTUPAI\n      *    Country edits.\n              WHEN FLG-COUNTRY-NOT-OK\n              WHEN FLG-COUNTRY-BLANK\n                  MOVE -1              TO ACSCTRYL OF CACTUPAI\n      *    Phone 1\n              WHEN FLG-PHONE-NUM-1A-NOT-OK\n              WHEN FLG-PHONE-NUM-1A-BLANK\n                  MOVE -1              TO ACSPH1AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1B-NOT-OK\n              WHEN FLG-PHONE-NUM-1B-BLANK\n                  MOVE -1              TO ACSPH1BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1C-NOT-OK\n              WHEN FLG-PHONE-NUM-1C-BLANK\n                  MOVE -1              TO ACSPH1CL OF CACTUPAI\n      *    Phone 2\n              WHEN FLG-PHONE-NUM-2A-NOT-OK\n              WHEN FLG-PHONE-NUM-2A-BLANK\n                  MOVE -1              TO ACSPH2AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2B-NOT-OK\n              WHEN FLG-PHONE-NUM-2B-BLANK\n                  MOVE -1              TO ACSPH2BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2C-NOT-OK\n              WHEN FLG-PHONE-NUM-2C-BLANK\n                  MOVE -1              TO ACSPH2CL OF CACTUPAI\n      *    EFT Account Id\n              WHEN FLG-EFT-ACCOUNT-ID-NOT-OK\n              WHEN FLG-EFT-ACCOUNT-ID-BLANK\n                  MOVE -1              TO ACSEFTCL OF CACTUPAI\n      *    Primary Card Holder\n              WHEN FLG-PRI-CARDHOLDER-NOT-OK\n              WHEN FLG-PRI-CARDHOLDER-BLANK\n                  MOVE -1              TO ACSPFLGL OF CACTUPAI\n              WHEN OTHER\n                  MOVE -1              TO ACCTSIDL OF CACTUPAI\n            END-EVALUATE\n\n\n      *    SETUP COLOR\n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n              MOVE DFHDFCOL            TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n      *    Account Filter\n           IF FLG-ACCTFILTER-NOT-OK\n              MOVE DFHRED              TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF  FLG-ACCTFILTER-BLANK\n           AND CDEMO-PGM-REENTER\n               MOVE '*'                TO ACCTSIDO OF CACTUPAO\n               MOVE DFHRED             TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n           OR FLG-ACCTFILTER-BLANK\n           OR FLG-ACCTFILTER-NOT-OK\n              GO TO 3300-SETUP-SCREEN-ATTRS-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      ******************************************************************\n      *    Using Copy replacing to set attribs for remaining vars\n      *    Write specific code only if rules differ\n      ******************************************************************\n      *    IF (FLG-ACCT-STATUS-NOT-OK\n      *    OR  FLG-ACCT-STATUS-BLANK)\n      *    AND CDEMO-PGM-REENTER\n      *        MOVE DFHRED             TO ACSTTUSC OF CACTUPAO\n      *        IF  FLG-ACCT-STATUS-BLANK\n      *            MOVE '*'            TO ACSTTUSO OF CACTUPAO\n      *        END-IF\n      *    END-IF\n\n      *    Account Status\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ACCT-STATUS==\n             ==(SCRNVAR2)== BY ==ACSTTUS==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-YEAR==\n             ==(SCRNVAR2)== BY ==OPNYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-MONTH==\n             ==(SCRNVAR2)== BY ==OPNMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-DAY==\n             ==(SCRNVAR2)== BY ==OPNDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CRED-LIMIT==\n             ==(SCRNVAR2)== BY ==ACRDLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-YEAR==\n             ==(SCRNVAR2)== BY ==EXPYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-MONTH==\n             ==(SCRNVAR2)== BY ==EXPMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-DAY==\n             ==(SCRNVAR2)== BY ==EXPDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Cash Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CASH-CREDIT-LIMIT==\n             ==(SCRNVAR2)== BY ==ACSHLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-YEAR==\n             ==(SCRNVAR2)== BY ==RISYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-MONTH==\n             ==(SCRNVAR2)== BY ==RISMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-DAY==\n             ==(SCRNVAR2)== BY ==RISDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Balance\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-BAL==\n             ==(SCRNVAR2)== BY ==ACURBAL==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Credit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-CREDIT==\n             ==(SCRNVAR2)== BY ==ACRCYCR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Debit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-DEBIT==\n             ==(SCRNVAR2)== BY ==ACRCYDB==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART1==\n             ==(SCRNVAR2)== BY ==ACTSSN1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 2\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART2==\n             ==(SCRNVAR2)== BY ==ACTSSN2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 3\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART3==\n             ==(SCRNVAR2)== BY ==ACTSSN3==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-YEAR==\n             ==(SCRNVAR2)== BY ==DOBYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-MONTH==\n             ==(SCRNVAR2)== BY ==DOBMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-DAY==\n             ==(SCRNVAR2)== BY ==DOBDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    FICO Score\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FICO-SCORE==\n             ==(SCRNVAR2)== BY ==ACSTFCO==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    First Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FIRST-NAME==\n             ==(SCRNVAR2)== BY ==ACSFNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Middle Name (no edits coded)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==MIDDLE-NAME==\n             ==(SCRNVAR2)== BY ==ACSMNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Last Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==LAST-NAME==\n             ==(SCRNVAR2)== BY ==ACSLNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-1==\n             ==(SCRNVAR2)== BY ==ACSADL1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==STATE==\n             ==(SCRNVAR2)== BY ==ACSSTTE==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 2 (NO EDITS CODED AS YET)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-2==\n             ==(SCRNVAR2)== BY ==ACSADL2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ZIPCODE==\n             ==(SCRNVAR2)== BY ==ACSZIPC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    City\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CITY==\n             ==(SCRNVAR2)== BY ==ACSCITY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Country\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==COUNTRY==\n             ==(SCRNVAR2)== BY ==ACSCTRY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1A==\n             ==(SCRNVAR2)== BY ==ACSPH1A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1B==\n             ==(SCRNVAR2)== BY ==ACSPH1B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 1 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1C==\n             ==(SCRNVAR2)== BY ==ACSPH1C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2A==\n             ==(SCRNVAR2)== BY ==ACSPH2A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2B==\n             ==(SCRNVAR2)== BY ==ACSPH2B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 2 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2C==\n             ==(SCRNVAR2)== BY ==ACSPH2C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    EFT Account Id\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PRI-CARDHOLDER==\n             ==(SCRNVAR2)== BY ==ACSPFLG==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Primary Card Holder\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EFT-ACCOUNT-ID==\n             ==(SCRNVAR2)== BY ==ACSEFTC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n           .\n       3300-SETUP-SCREEN-ATTRS-EXIT.\n           EXIT\n           .\n\n       3310-PROTECT-ALL-ATTRS.\n           MOVE DFHBMPRF              TO ACCTSIDA OF CACTUPAI\n                                         ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n                                         ACSTNUMA OF CACTUPAI\n                                         ACTSSN1A OF CACTUPAI\n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n                                         ACSCTRYA OF CACTUPAI\n\n                                         ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n                                         ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n                                         INFOMSGA OF CACTUPAI\n           .\n       3310-PROTECT-ALL-ATTRS-EXIT.\n           EXIT\n           .\n\n       3320-UNPROTECT-FEW-ATTRS.\n\n           MOVE DFHBMFSE              TO ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n      *Open Date\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n      *Expiry date\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n      *Reissue date\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n            MOVE DFHBMPRF            TO  ACSTNUMA OF CACTUPAI\n            MOVE DFHBMFSE            TO  ACTSSN1A OF CACTUPAI         \n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n      *Since most of the edits are USA specific protected country\n           MOVE DFHBMPRF              TO ACSCTRYA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n           MOVE DFHBMPRF              TO INFOMSGA OF CACTUPAI\n           .\n       3320-UNPROTECT-FEW-ATTRS-EXIT.\n           EXIT\n           .\n\n       3390-SETUP-INFOMSG-ATTRS.\n           IF  WS-NO-INFO-MESSAGE\n               MOVE DFHBMDAR           TO INFOMSGA OF CACTUPAI\n           ELSE\n               MOVE DFHBMASB           TO INFOMSGA OF CACTUPAI\n           END-IF\n\n           IF ACUP-CHANGES-MADE\n           AND NOT ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           IF PROMPT-FOR-CONFIRMATION\n               MOVE DFHBMASB           TO FKEY05A  OF CACTUPAI\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           .\n       3390-SETUP-INFOMSG-ATTRS-EXIT.\n           EXIT\n           .\n\n\n       3400-SEND-SCREEN.\n\n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP\n\n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)\n                          MAPSET(CCARD-NEXT-MAPSET)\n                          FROM(CACTUPAO)\n                          CURSOR\n                          ERASE\n                          FREEKB\n                          RESP(WS-RESP-CD)\n           END-EXEC\n           .\n       3400-SEND-SCREEN-EXIT.\n           EXIT\n           .\n\n\n       9000-READ-ACCT.\n\n           INITIALIZE ACUP-OLD-DETAILS\n\n           SET  WS-NO-INFO-MESSAGE      TO TRUE\n\n           MOVE CC-ACCT-ID              TO ACUP-OLD-ACCT-ID\n                                           WS-CARD-RID-ACCT-ID\n\n           PERFORM 9200-GETCARDXREF-BYACCT\n              THRU 9200-GETCARDXREF-BYACCT-EXIT\n\n           IF FLG-ACCTFILTER-NOT-OK\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           PERFORM 9300-GETACCTDATA-BYACCT\n              THRU 9300-GETACCTDATA-BYACCT-EXIT\n\n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID\n\n           PERFORM 9400-GETCUSTDATA-BYCUST\n              THRU 9400-GETCUSTDATA-BYCUST-EXIT\n\n           IF DID-NOT-FIND-CUST-IN-CUSTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n\n\n           PERFORM 9500-STORE-FETCHED-DATA\n              THRU 9500-STORE-FETCHED-DATA-EXIT\n           .\n\n\n       9000-READ-ACCT-EXIT.\n           EXIT\n           .\n       9200-GETCARDXREF-BYACCT.\n\n      *    Read the Card file. Access via alternate index ACCTID\n      *\n           EXEC CICS READ\n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID\n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Cross ref file.  Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *          PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n       9200-GETCARDXREF-BYACCT-EXIT.\n           EXIT\n           .\n       9300-GETACCTDATA-BYACCT.\n\n           EXEC CICS READ\n                DATASET   (LIT-ACCTFILENAME)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-ACCT-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Acct Master file.Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n      *\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n       9300-GETACCTDATA-BYACCT-EXIT.\n           EXIT\n           .\n\n       9400-GETCUSTDATA-BYCUST.\n           EXEC CICS READ\n                DATASET   (LIT-CUSTFILENAME)\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-CUST-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE\n                  MOVE WS-RESP-CD               TO ERROR-RESP\n                  MOVE WS-REAS-CD               TO ERROR-RESP2\n                  IF WS-RETURN-MSG-OFF\n                    STRING\n                    'CustId:'\n                     WS-CARD-RID-CUST-ID-X\n                    ' not found'\n                    ' in customer master.Resp: '\n                    ERROR-RESP\n                    ' REAS:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n       9400-GETCUSTDATA-BYCUST-EXIT.\n           EXIT\n           .\n\n       9500-STORE-FETCHED-DATA.\n\n      *    Store Context in Commarea\n      *\n           MOVE ACCT-ID                   TO CDEMO-ACCT-ID\n           MOVE CUST-ID                   TO CDEMO-CUST-ID\n           MOVE CUST-FIRST-NAME           TO CDEMO-CUST-FNAME\n           MOVE CUST-MIDDLE-NAME          TO CDEMO-CUST-MNAME\n           MOVE CUST-LAST-NAME            TO CDEMO-CUST-LNAME\n           MOVE ACCT-ACTIVE-STATUS        TO CDEMO-ACCT-STATUS\n           MOVE XREF-CARD-NUM             TO CDEMO-CARD-NUM\n\n           INITIALIZE ACUP-OLD-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACCT-ID                  TO ACUP-OLD-ACCT-ID\n      * Active Status\n           MOVE ACCT-ACTIVE-STATUS       TO ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACCT-CURR-BAL            TO ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           MOVE ACCT-CREDIT-LIMIT        TO ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           MOVE ACCT-CASH-CREDIT-LIMIT   TO ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           MOVE ACCT-CURR-CYC-CREDIT     TO ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           MOVE ACCT-CURR-CYC-DEBIT      TO ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n      *    MOVE ACCT-OPEN-DATE           TO ACUP-OLD-OPEN-DATE\n           MOVE ACCT-OPEN-DATE(1:4)      TO ACUP-OLD-OPEN-YEAR\n           MOVE ACCT-OPEN-DATE(6:2)      TO ACUP-OLD-OPEN-MON\n           MOVE ACCT-OPEN-DATE(9:2)      TO ACUP-OLD-OPEN-DAY\n      * Expiry date\n      *    MOVE ACCT-EXPIRAION-DATE      TO ACUP-OLD-EXPIRAION-DATE\n           MOVE ACCT-EXPIRAION-DATE(1:4) TO ACUP-OLD-EXP-YEAR\n           MOVE ACCT-EXPIRAION-DATE(6:2) TO ACUP-OLD-EXP-MON\n           MOVE ACCT-EXPIRAION-DATE(9:2) TO ACUP-OLD-EXP-DAY\n\n      * Reissue date\n      *    MOVE ACCT-REISSUE-DATE        TO ACUP-OLD-REISSUE-DATE\n           MOVE ACCT-REISSUE-DATE(1:4)   TO ACUP-OLD-REISSUE-YEAR\n           MOVE ACCT-REISSUE-DATE(6:2)   TO ACUP-OLD-REISSUE-MON\n           MOVE ACCT-REISSUE-DATE(9:2)   TO ACUP-OLD-REISSUE-DAY\n      * Account Group\n           MOVE ACCT-GROUP-ID            TO ACUP-OLD-GROUP-ID\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n           MOVE CUST-ID                  TO ACUP-OLD-CUST-ID\n      *Social Security Number\n           MOVE CUST-SSN                 TO ACUP-OLD-CUST-SSN\n      *Date of birth\n      *    MOVE CUST-DOB-YYYY-MM-DD      TO ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           MOVE CUST-DOB-YYYY-MM-DD(1:4) TO ACUP-OLD-CUST-DOB-YEAR\n           MOVE CUST-DOB-YYYY-MM-DD(6:2) TO ACUP-OLD-CUST-DOB-MON\n           MOVE CUST-DOB-YYYY-MM-DD(9:2) TO ACUP-OLD-CUST-DOB-DAY\n      *FICO\n           MOVE CUST-FICO-CREDIT-SCORE   TO ACUP-OLD-CUST-FICO-SCORE\n      *First Name\n           MOVE CUST-FIRST-NAME          TO ACUP-OLD-CUST-FIRST-NAME\n      *Middle Name\n           MOVE CUST-MIDDLE-NAME         TO ACUP-OLD-CUST-MIDDLE-NAME\n      *Last Name\n           MOVE CUST-LAST-NAME           TO ACUP-OLD-CUST-LAST-NAME\n      *Address\n           MOVE CUST-ADDR-LINE-1         TO ACUP-OLD-CUST-ADDR-LINE-1\n           MOVE CUST-ADDR-LINE-2         TO ACUP-OLD-CUST-ADDR-LINE-2\n           MOVE CUST-ADDR-LINE-3         TO ACUP-OLD-CUST-ADDR-LINE-3\n           MOVE CUST-ADDR-STATE-CD       TO ACUP-OLD-CUST-ADDR-STATE-CD\n           MOVE CUST-ADDR-COUNTRY-CD     TO\n                                          ACUP-OLD-CUST-ADDR-COUNTRY-CD\n           MOVE CUST-ADDR-ZIP            TO ACUP-OLD-CUST-ADDR-ZIP\n           MOVE CUST-PHONE-NUM-1         TO ACUP-OLD-CUST-PHONE-NUM-1\n           MOVE CUST-PHONE-NUM-2         TO ACUP-OLD-CUST-PHONE-NUM-2\n      *Government Id\n           MOVE CUST-GOVT-ISSUED-ID      TO ACUP-OLD-CUST-GOVT-ISSUED-ID\n      *EFT Code\n           MOVE CUST-EFT-ACCOUNT-ID      TO ACUP-OLD-CUST-EFT-ACCOUNT-ID\n      *Primary Holder Indicator\n           MOVE CUST-PRI-CARD-HOLDER-IND TO ACUP-OLD-CUST-PRI-HOLDER-IND\n           .\n       9500-STORE-FETCHED-DATA-EXIT.\n           EXIT\n           .\n       9600-WRITE-PROCESSING.\n\n      *    Read the account file for update\n\n           MOVE CC-ACCT-ID              TO WS-CARD-RID-ACCT-ID\n\n           EXEC CICS READ\n                FILE      (LIT-ACCTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the account record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-ACCT-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *    Read the customer file for update\n\n           MOVE CDEMO-CUST-ID                   TO WS-CARD-RID-CUST-ID\n\n           EXEC CICS READ\n                FILE      (LIT-CUSTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the customer record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-CUST-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *****************************************************************\n      *    Did someone change the record while we were out ?\n      *****************************************************************\n           PERFORM 9700-CHECK-CHANGE-IN-REC\n              THRU 9700-CHECK-CHANGE-IN-REC-EXIT\n\n           IF DATA-WAS-CHANGED-BEFORE-UPDATE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Prepare the update\n      *****************************************************************\n           INITIALIZE ACCT-UPDATE-RECORD\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACUP-NEW-ACCT-ID         TO ACCT-UPDATE-ID\n      * Active Status\n           MOVE ACUP-NEW-ACTIVE-STATUS   TO ACCT-UPDATE-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACUP-NEW-CURR-BAL-N      TO ACCT-UPDATE-CURR-BAL\n      * Credit Limit\n           MOVE ACUP-NEW-CREDIT-LIMIT-N  TO ACCT-UPDATE-CREDIT-LIMIT\n      * Cash Limit\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                      TO ACCT-UPDATE-CASH-CREDIT-LIMIT\n      * Current Cycle Credit\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-N\n                                          TO ACCT-UPDATE-CURR-CYC-CREDIT\n      * Current Cycle Debit\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-N TO ACCT-UPDATE-CURR-CYC-DEBIT\n      * Open date\n           STRING ACUP-NEW-OPEN-YEAR\n                  '-'\n                  ACUP-NEW-OPEN-MON\n                  '-'\n                  ACUP-NEW-OPEN-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-OPEN-DATE\n      * Expiry date\n           STRING ACUP-NEW-EXP-YEAR\n                  '-'\n                  ACUP-NEW-EXP-MON\n                  '-'\n                  ACUP-NEW-EXP-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-EXPIRAION-DATE\n\n      * Reissue date\n           MOVE ACCT-REISSUE-DATE        TO ACCT-UPDATE-REISSUE-DATE\n           STRING ACUP-NEW-REISSUE-YEAR\n                  '-'\n                  ACUP-NEW-REISSUE-MON\n                  '-'\n                  ACUP-NEW-REISSUE-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-REISSUE-DATE\n      * Account Group\n           MOVE ACUP-NEW-GROUP-ID        TO ACCT-UPDATE-GROUP-ID\n\n      ******************************************************************\n      *    Customer data\n      ******************************************************************\n           INITIALIZE CUST-UPDATE-RECORD\n\n           MOVE  ACUP-NEW-CUST-ID        TO CUST-UPDATE-ID\n           MOVE  ACUP-NEW-CUST-FIRST-NAME\n                                   TO CUST-UPDATE-FIRST-NAME\n           MOVE  ACUP-NEW-CUST-MIDDLE-NAME\n                                   TO CUST-UPDATE-MIDDLE-NAME\n           MOVE  ACUP-NEW-CUST-LAST-NAME TO CUST-UPDATE-LAST-NAME\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-1\n                                   TO CUST-UPDATE-ADDR-LINE-1\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-2\n                                   TO CUST-UPDATE-ADDR-LINE-2\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-3\n                                   TO CUST-UPDATE-ADDR-LINE-3\n           MOVE  ACUP-NEW-CUST-ADDR-STATE-CD\n                                   TO CUST-UPDATE-ADDR-STATE-CD\n           MOVE  ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                   TO CUST-UPDATE-ADDR-COUNTRY-CD\n           MOVE  ACUP-NEW-CUST-ADDR-ZIP  TO CUST-UPDATE-ADDR-ZIP\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-1A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-1B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-1C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-1\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-2A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-2B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-2C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-2\n\n\n           MOVE  ACUP-NEW-CUST-SSN       TO CUST-UPDATE-SSN\n           MOVE  ACUP-NEW-CUST-GOVT-ISSUED-ID\n                                   TO CUST-UPDATE-GOVT-ISSUED-ID\n           STRING ACUP-NEW-CUST-DOB-YEAR\n                  '-'\n                  ACUP-NEW-CUST-DOB-MON\n                  '-'\n                  ACUP-NEW-CUST-DOB-DAY\n           DELIMITED BY SIZE           INTO CUST-UPDATE-DOB-YYYY-MM-DD\n\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO CUST-UPDATE-EFT-ACCOUNT-ID\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO CUST-UPDATE-PRI-CARD-IND\n           MOVE ACUP-NEW-CUST-FICO-SCORE TO\n                                   CUST-UPDATE-FICO-CREDIT-SCORE\n      *****************************************************************\n      * Update account *\n      *****************************************************************\n\n\n           EXEC CICS\n                REWRITE FILE(LIT-ACCTFILENAME)\n                        FROM(ACCT-UPDATE-RECORD)\n                        LENGTH(LENGTH OF ACCT-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *\n      *****************************************************************\n      * Did account update succeed ?  *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Update customer *\n      *****************************************************************\n           EXEC CICS\n                        REWRITE FILE(LIT-CUSTFILENAME)\n                        FROM(CUST-UPDATE-RECORD)\n                        LENGTH(LENGTH OF CUST-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *****************************************************************\n      * Did customer update succeed ? *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             EXEC CICS\n                SYNCPOINT ROLLBACK\n             END-EXEC\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .\n       9600-WRITE-PROCESSING-EXIT.\n           EXIT\n           .\n\n       9700-CHECK-CHANGE-IN-REC.\n\n\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCT-ACTIVE-STATUS      EQUAL ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           AND ACCT-CURR-BAL           EQUAL ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           AND ACCT-CREDIT-LIMIT       EQUAL ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           AND ACCT-CASH-CREDIT-LIMIT EQUAL ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           AND ACCT-CURR-CYC-CREDIT    EQUAL ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           AND ACCT-CURR-CYC-DEBIT     EQUAL ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n           AND ACCT-OPEN-DATE(1:4)     EQUAL ACUP-OLD-OPEN-YEAR\n           AND ACCT-OPEN-DATE(6:2)     EQUAL ACUP-OLD-OPEN-MON\n           AND ACCT-OPEN-DATE(9:2)     EQUAL ACUP-OLD-OPEN-DAY\n      * Expiry date\n           AND ACCT-EXPIRAION-DATE(1:4)EQUAL ACUP-OLD-EXP-YEAR\n           AND ACCT-EXPIRAION-DATE(6:2)EQUAL ACUP-OLD-EXP-MON\n           AND ACCT-EXPIRAION-DATE(9:2)EQUAL ACUP-OLD-EXP-DAY\n      * Reissue date\n           AND ACCT-REISSUE-DATE(1:4)  EQUAL ACUP-OLD-REISSUE-YEAR\n           AND ACCT-REISSUE-DATE(6:2)  EQUAL ACUP-OLD-REISSUE-MON\n           AND ACCT-REISSUE-DATE(9:2)  EQUAL ACUP-OLD-REISSUE-DAY\n      * Account Group\n           AND FUNCTION LOWER-CASE (ACCT-GROUP-ID)           EQUAL\n               FUNCTION LOWER-CASE (ACUP-OLD-GROUP-ID)\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      ******************************************************************\n      *    Customer  data - Split into 2 IFs for easier reading\n      *    And maybe put logic to update only 1 file if only date\n      *    pertaining to one of them is updated\n      ******************************************************************\n           IF  FUNCTION UPPER-CASE (CUST-FIRST-NAME          ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-FIRST-NAME )\n           AND FUNCTION UPPER-CASE (CUST-MIDDLE-NAME         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-MIDDLE-NAME)\n           AND FUNCTION UPPER-CASE (CUST-LAST-NAME           ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-LAST-NAME  )\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-1         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-1)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-2         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-2)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-3         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-3)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-STATE-CD       ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-STATE-CD)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-COUNTRY-CD     ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-COUNTRY-CD )\n           AND CUST-ADDR-ZIP           EQUAL ACUP-OLD-CUST-ADDR-ZIP\n           AND CUST-PHONE-NUM-1        EQUAL ACUP-OLD-CUST-PHONE-NUM-1\n           AND CUST-PHONE-NUM-2        EQUAL ACUP-OLD-CUST-PHONE-NUM-2\n           AND CUST-SSN                EQUAL ACUP-OLD-CUST-SSN\n           AND FUNCTION UPPER-CASE (CUST-GOVT-ISSUED-ID      ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-GOVT-ISSUED-ID )\n           AND CUST-DOB-YYYY-MM-DD (1:4)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (1:4)\n           AND CUST-DOB-YYYY-MM-DD (6:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (5:2)\n           AND CUST-DOB-YYYY-MM-DD (9:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (7:2)\n\n           AND CUST-EFT-ACCOUNT-ID     EQUAL\n                                            ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND CUST-PRI-CARD-HOLDER-IND\n                                       EQUAL\n                                            ACUP-OLD-CUST-PRI-HOLDER-IND\n           AND CUST-FICO-CREDIT-SCORE  EQUAL ACUP-OLD-CUST-FICO-SCORE\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .\n       9700-CHECK-CHANGE-IN-REC-EXIT.\n           EXIT\n           .\n      ******************************************************************\n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n\n       ABEND-ROUTINE.\n\n           IF ABEND-MSG EQUAL LOW-VALUES\n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG\n           END-IF\n\n           MOVE LIT-THISPGM       TO ABEND-CULPRIT\n\n           EXEC CICS SEND\n                            FROM (ABEND-DATA)\n                            LENGTH(LENGTH OF ABEND-DATA)\n                            NOHANDLE\n                            ERASE\n           END-EXEC\n\n           EXEC CICS HANDLE ABEND\n                CANCEL\n           END-EXEC\n\n           EXEC CICS ABEND\n                ABCODE('9999')\n           END-EXEC\n           .\n       ABEND-ROUTINE-EXIT.\n           EXIT\n           .\n      ******************************************************************\n      * Common Date Routines\n      ******************************************************************\n       COPY CSUTLDPY\n           .\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "COCOM01Y",
        "DFHBMSCA",
        "CVCUS01Y",
        "replacing",
        "CSUSR01Y",
        "CVCRD01Y",
        "CSSTRPFY",
        "CSSETATY",
        "CSUTLDPY",
        "CSDAT01Y",
        "CSUTLDWY",
        "CSLKPCDY",
        "CVACT01Y",
        "COACTUP",
        "CSMSG01Y",
        "COTTL01Y",
        "CSMSG02Y",
        "DFHAID",
        "CVACT03Y"
      ],
      "diagram": "sequenceDiagram\n    participant User\n    participant CICS\n    participant COACTUPC\n    participant AccountFile\n    participant CustomerFile\n    participant CardXrefFile\n\n    User->>CICS: Start transaction\n    CICS->>COACTUPC: Invoke program\n    \n    activate COACTUPC\n    \n    COACTUPC->>COACTUPC: 0000-MAIN (Initialize)\n    \n    alt First entry to program\n        COACTUPC->>COACTUPC: 3000-SEND-MAP (Display initial screen)\n        COACTUPC-->>User: Show account search screen\n    else User entered account ID\n        COACTUPC->>COACTUPC: 1000-PROCESS-INPUTS\n        COACTUPC->>COACTUPC: 1100-RECEIVE-MAP\n        COACTUPC->>COACTUPC: 1200-EDIT-MAP-INPUTS\n        COACTUPC->>COACTUPC: 1210-EDIT-ACCOUNT\n        \n        alt Valid account ID\n            COACTUPC->>COACTUPC: 9000-READ-ACCT\n            COACTUPC->>CardXrefFile: 9200-GETCARDXREF-BYACCT\n            CardXrefFile-->>COACTUPC: Return cross-reference data\n            \n            COACTUPC->>AccountFile: 9300-GETACCTDATA-BYACCT\n            AccountFile-->>COACTUPC: Return account data\n            \n            COACTUPC->>CustomerFile: 9400-GETCUSTDATA-BYCUST\n            CustomerFile-->>COACTUPC: Return customer data\n            \n            COACTUPC->>COACTUPC: 9500-STORE-FETCHED-DATA\n            COACTUPC->>COACTUPC: 3000-SEND-MAP (Display account details)\n            COACTUPC-->>User: Show account details for update\n        else Invalid account ID\n            COACTUPC-->>User: Show error message\n        end\n    else User modified account data\n        COACTUPC->>COACTUPC: 1000-PROCESS-INPUTS\n        COACTUPC->>COACTUPC: 1100-RECEIVE-MAP\n        COACTUPC->>COACTUPC: 1200-EDIT-MAP-INPUTS\n        COACTUPC->>COACTUPC: 1205-COMPARE-OLD-NEW\n        \n        alt Changes detected and valid\n            COACTUPC->>COACTUPC: 2000-DECIDE-ACTION\n            COACTUPC->>COACTUPC: 3000-SEND-MAP (Confirm changes)\n            COACTUPC-->>User: Show confirmation screen\n        else No changes or invalid data\n            COACTUPC-->>User: Show error message or original screen\n        end\n    else User confirmed changes (PF5)\n        COACTUPC->>COACTUPC: 9600-WRITE-PROCESSING\n        \n        COACTUPC->>AccountFile: READ UPDATE (Lock record)\n        AccountFile-->>COACTUPC: Return locked account record\n        \n        COACTUPC->>CustomerFile: READ UPDATE (Lock record)\n        CustomerFile-->>COACTUPC: Return locked customer record\n        \n        COACTUPC->>COACTUPC: 9700-CHECK-CHANGE-IN-REC\n        \n        alt No concurrent changes detected\n            COACTUPC->>AccountFile: REWRITE (Update account)\n            AccountFile-->>COACTUPC: Update successful\n            \n            COACTUPC->>CustomerFile: REWRITE (Update customer)\n            CustomerFile-->>COACTUPC: Update successful\n            \n            COACTUPC->>COACTUPC: 3000-SEND-MAP (Success message)\n            COACTUPC-->>User: Show success message\n        else Concurrent changes detected\n            COACTUPC->>CICS: SYNCPOINT ROLLBACK\n            COACTUPC-->>User: Show error message\n        end\n    else User pressed PF3 (Exit)\n        COACTUPC->>CICS: SYNCPOINT\n        COACTUPC->>CICS: XCTL (Return to menu)\n        CICS-->>User: Display menu screen\n    end\n    \n    COACTUPC->>COACTUPC: COMMON-RETURN\n    COACTUPC->>CICS: RETURN TRANSID\n    deactivate COACTUPC\n    \n    CICS-->>User: Wait for next user action"
    },
    {
      "id": "CBTRN02C",
      "author": "AWS",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "FILE-CONTROL.                                                            \n           SELECT DALYTRAN-FILE ASSIGN TO DALYTRAN                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  FILE STATUS  IS DALYTRAN-STATUS.                              \n                                                                                \n           SELECT TRANSACT-FILE ASSIGN TO TRANFILE                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRANS-ID                                   \n                  FILE STATUS  IS TRANFILE-STATUS.                              \n                                                                                \n           SELECT XREF-FILE ASSIGN TO   XREFFILE                                \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  FILE STATUS  IS XREFFILE-STATUS.                              \n                                                                                \n           SELECT DALYREJS-FILE ASSIGN TO DALYREJS                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  FILE STATUS  IS DALYREJS-STATUS.                              \n                                                                                \n           SELECT ACCOUNT-FILE ASSIGN TO ACCTFILE                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-ACCT-ID                                    \n                  FILE STATUS  IS ACCTFILE-STATUS.                              \n                                                                                \n           SELECT TCATBAL-FILE ASSIGN TO TCATBALF                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRAN-CAT-KEY                               \n                  FILE STATUS  IS TCATBALF-STATUS.                              \n                                                                                \n      *",
            "description": "This section defines the file assignments and access methods for the transaction processing program. It specifies six files:\n\n1. DALYTRAN-FILE: A sequential input file containing the daily credit card transactions to be processed.\n\n2. TRANSACT-FILE: An indexed file accessed randomly by transaction ID (FD-TRANS-ID) where valid transactions are written.\n\n3. XREF-FILE: An indexed file accessed randomly by card number (FD-XREF-CARD-NUM) used to validate credit card numbers.\n\n4. DALYREJS-FILE: A sequential output file where rejected transactions are written.\n\n5. ACCOUNT-FILE: An indexed file accessed randomly by account ID (FD-ACCT-ID) containing account master information.\n\n6. TCATBAL-FILE: An indexed file accessed randomly by transaction category key (FD-TRAN-CAT-KEY) used to track transaction balances by category.\n\nEach file definition includes its organization type, access method, key field (for indexed files), and a status field for error handling."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "FILE SECTION",
            "code": "FD  DALYTRAN-FILE.                                                       \n       01  FD-TRAN-RECORD.                                                      \n           05 FD-TRAN-ID                        PIC X(16).                      \n           05 FD-CUST-DATA                      PIC X(334).                     \n                                                                                \n       FD  TRANSACT-FILE.                                                       \n       01  FD-TRANFILE-REC.                                                     \n           05 FD-TRANS-ID                       PIC X(16).                      \n           05 FD-ACCT-DATA                      PIC X(334).                     \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       FD  DALYREJS-FILE.                                                       \n       01  FD-REJS-RECORD.                                                      \n           05 FD-REJECT-RECORD                  PIC X(350).                     \n           05 FD-VALIDATION-TRAILER             PIC X(80).                      \n                                                                                \n       FD  ACCOUNT-FILE.                                                        \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       FD  TCATBAL-FILE.                                                        \n       01  FD-TRAN-CAT-BAL-RECORD.                                              \n           05 FD-TRAN-CAT-KEY.                                                  \n              10 FD-TRANCAT-ACCT-ID             PIC 9(11).                      \n              10 FD-TRANCAT-TYPE-CD             PIC X(02).                      \n              10 FD-TRANCAT-CD                  PIC 9(04).                      \n           05 FD-FD-TRAN-CAT-DATA               PIC X(33).",
            "description": "This File Section defines the structure of six key files used in the transaction processing program. It includes:\n\n1. DALYTRAN-FILE: The input file containing daily credit card transactions with a 16-character transaction ID followed by customer data.\n\n2. TRANSACT-FILE: The output file for valid processed transactions, maintaining a similar structure to the input file.\n\n3. XREF-FILE: A cross-reference file used to validate card numbers against accounts, containing the card number and associated reference data.\n\n4. DALYREJS-FILE: The output file for rejected transactions, which includes both the original transaction record and an 80-character validation message explaining the rejection reason.\n\n5. ACCOUNT-FILE: The master account file containing account information with an 11-digit numeric account ID as the key field.\n\n6. TCATBAL-FILE: A transaction category balance file that tracks balances by account ID, transaction type, and category code, used for categorizing and summarizing transaction activity.\n\nThese file definitions support the program's core functions of transaction validation, account updates, and transaction categorization."
          },
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "*****************************************************************         \n       COPY CVTRA06Y.                                                           \n       01  DALYTRAN-STATUS.                                                     \n           05  DALYTRAN-STAT1      PIC X.                                       \n           05  DALYTRAN-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA05Y.                                                           \n       01  TRANFILE-STATUS.                                                     \n           05  TRANFILE-STAT1      PIC X.                                       \n           05  TRANFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       01  DALYREJS-STATUS.                                                     \n           05  DALYREJS-STAT1      PIC X.                                       \n           05  DALYREJS-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA01Y.                                                           \n       01  TCATBALF-STATUS.                                                     \n           05  TCATBALF-STAT1      PIC X.                                       \n           05  TCATBALF-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         \n       01  COBOL-TS.                                                            \n           05 COB-YYYY                  PIC X(04).                              \n           05 COB-MM                    PIC X(02).                              \n           05 COB-DD                    PIC X(02).                              \n           05 COB-HH                    PIC X(02).                              \n           05 COB-MIN                   PIC X(02).                              \n           05 COB-SS                    PIC X(02).                              \n           05 COB-MIL                   PIC X(02).                              \n           05 COB-REST                  PIC X(05).                              \n       01  DB2-FORMAT-TS                PIC X(26).                              \n       01  FILLER REDEFINES DB2-FORMAT-TS.                                      \n           06 DB2-YYYY                  PIC X(004).                      E      \n           06 DB2-STREEP-1              PIC X.                           -      \n           06 DB2-MM                    PIC X(002).                      M      \n           06 DB2-STREEP-2              PIC X.                           -      \n           06 DB2-DD                    PIC X(002).                      D      \n           06 DB2-STREEP-3              PIC X.                           -      \n           06 DB2-HH                    PIC X(002).                      U      \n           06 DB2-DOT-1                 PIC X.                                  \n           06 DB2-MIN                   PIC X(002).                             \n           06 DB2-DOT-2                 PIC X.                                  \n           06 DB2-SS                    PIC X(002).                             \n           06 DB2-DOT-3                 PIC X.                                  \n           06 DB2-MIL                   PIC 9(002).                             \n           06 DB2-REST                  PIC X(04).                              \n                                                                                \n        01 REJECT-RECORD.                                                       \n           05 REJECT-TRAN-DATA          PIC X(350).                             \n           05 VALIDATION-TRAILER        PIC X(80).                              \n                                                                                \n        01 WS-VALIDATION-TRAILER.                                               \n           05 WS-VALIDATION-FAIL-REASON      PIC 9(04).                         \n           05 WS-VALIDATION-FAIL-REASON-DESC PIC X(76).                         \n                                                                                \n        01 WS-COUNTERS.                                                         \n           05 WS-TRANSACTION-COUNT          PIC 9(09) VALUE 0.                  \n           05 WS-REJECT-COUNT               PIC 9(09) VALUE 0.                  \n           05 WS-TEMP-BAL                   PIC S9(09)V99.                      \n                                                                                \n        01 WS-FLAGS.                                                            \n           05 WS-CREATE-TRANCAT-REC         PIC X(01) VALUE 'N'.                \n                                                                                \n      *****************************************************************",
            "description": "This Working Storage Section defines the data structures used by the CBTRN02C program for processing credit card transactions. It includes file status variables for all files used in the program (daily transactions, transaction file, cross-reference file, rejection file, account file, and transaction category balance file). The section also contains utility fields for I/O operations, binary conversions, and timestamp formatting.\n\nKey components include error handling structures (IO-STATUS fields and APPL-RESULT), timestamp fields for formatting between COBOL and DB2 formats, a REJECT-RECORD structure for storing invalid transactions with their failure reasons, and program counters to track processed and rejected transactions. The WS-FLAGS area includes a flag to determine when transaction category records need to be created.\n\nThe section incorporates several copybooks (CVTRA06Y, CVTRA05Y, CVACT03Y, CVACT01Y, CVTRA01Y) which likely contain record layouts for the various files processed by the program."
          }
        ],
        "copybooks": [],
        "code": "FILE SECTION.                                                            \n       FD  DALYTRAN-FILE.                                                       \n       01  FD-TRAN-RECORD.                                                      \n           05 FD-TRAN-ID                        PIC X(16).                      \n           05 FD-CUST-DATA                      PIC X(334).                     \n                                                                                \n       FD  TRANSACT-FILE.                                                       \n       01  FD-TRANFILE-REC.                                                     \n           05 FD-TRANS-ID                       PIC X(16).                      \n           05 FD-ACCT-DATA                      PIC X(334).                     \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       FD  DALYREJS-FILE.                                                       \n       01  FD-REJS-RECORD.                                                      \n           05 FD-REJECT-RECORD                  PIC X(350).                     \n           05 FD-VALIDATION-TRAILER             PIC X(80).                      \n                                                                                \n       FD  ACCOUNT-FILE.                                                        \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       FD  TCATBAL-FILE.                                                        \n       01  FD-TRAN-CAT-BAL-RECORD.                                              \n           05 FD-TRAN-CAT-KEY.                                                  \n              10 FD-TRANCAT-ACCT-ID             PIC 9(11).                      \n              10 FD-TRANCAT-TYPE-CD             PIC X(02).                      \n              10 FD-TRANCAT-CD                  PIC 9(04).                      \n           05 FD-FD-TRAN-CAT-DATA               PIC X(33).                      \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVTRA06Y.                                                           \n       01  DALYTRAN-STATUS.                                                     \n           05  DALYTRAN-STAT1      PIC X.                                       \n           05  DALYTRAN-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA05Y.                                                           \n       01  TRANFILE-STATUS.                                                     \n           05  TRANFILE-STAT1      PIC X.                                       \n           05  TRANFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       01  DALYREJS-STATUS.                                                     \n           05  DALYREJS-STAT1      PIC X.                                       \n           05  DALYREJS-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA01Y.                                                           \n       01  TCATBALF-STATUS.                                                     \n           05  TCATBALF-STAT1      PIC X.                                       \n           05  TCATBALF-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         \n       01  COBOL-TS.                                                            \n           05 COB-YYYY                  PIC X(04).                              \n           05 COB-MM                    PIC X(02).                              \n           05 COB-DD                    PIC X(02).                              \n           05 COB-HH                    PIC X(02).                              \n           05 COB-MIN                   PIC X(02).                              \n           05 COB-SS                    PIC X(02).                              \n           05 COB-MIL                   PIC X(02).                              \n           05 COB-REST                  PIC X(05).                              \n       01  DB2-FORMAT-TS                PIC X(26).                              \n       01  FILLER REDEFINES DB2-FORMAT-TS.                                      \n           06 DB2-YYYY                  PIC X(004).                      E      \n           06 DB2-STREEP-1              PIC X.                           -      \n           06 DB2-MM                    PIC X(002).                      M      \n           06 DB2-STREEP-2              PIC X.                           -      \n           06 DB2-DD                    PIC X(002).                      D      \n           06 DB2-STREEP-3              PIC X.                           -      \n           06 DB2-HH                    PIC X(002).                      U      \n           06 DB2-DOT-1                 PIC X.                                  \n           06 DB2-MIN                   PIC X(002).                             \n           06 DB2-DOT-2                 PIC X.                                  \n           06 DB2-SS                    PIC X(002).                             \n           06 DB2-DOT-3                 PIC X.                                  \n           06 DB2-MIL                   PIC 9(002).                             \n           06 DB2-REST                  PIC X(04).                              \n                                                                                \n        01 REJECT-RECORD.                                                       \n           05 REJECT-TRAN-DATA          PIC X(350).                             \n           05 VALIDATION-TRAILER        PIC X(80).                              \n                                                                                \n        01 WS-VALIDATION-TRAILER.                                               \n           05 WS-VALIDATION-FAIL-REASON      PIC 9(04).                         \n           05 WS-VALIDATION-FAIL-REASON-DESC PIC X(76).                         \n                                                                                \n        01 WS-COUNTERS.                                                         \n           05 WS-TRANSACTION-COUNT          PIC 9(09) VALUE 0.                  \n           05 WS-REJECT-COUNT               PIC 9(09) VALUE 0.                  \n           05 WS-TEMP-BAL                   PIC S9(09)V99.                      \n                                                                                \n        01 WS-FLAGS.                                                            \n           05 WS-CREATE-TRANCAT-REC         PIC X(01) VALUE 'N'.                \n                                                                                \n      *****************************************************************"
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-DALYTRAN-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DALYTRAN-FILE                                             \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALYTRAN'                                 \n               MOVE DALYTRAN-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the DALYTRAN-FILE, which contains the daily credit card transactions to be processed. It initializes APPL-RESULT to 8, attempts to open the input file, and then sets APPL-RESULT to 0 if successful or 12 if unsuccessful. If the file open operation fails (APPL-RESULT not equal to 0), the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then terminates the program abnormally. This is a critical initialization step that ensures the primary input file is available before proceeding with transaction processing."
          },
          {
            "name": "0100-TRANFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT TRANSACT-FILE                                            \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the transaction output file. It attempts to open the TRANSACT-FILE in OUTPUT mode and then validates the operation's success. If the file opens successfully (status '00'), it sets APPL-RESULT to 0 indicating success. If the open operation fails, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then terminates the program abnormally. This is a critical initialization step that ensures the program can write transaction records to the output file before proceeding with transaction processing."
          },
          {
            "name": "0200-XREFFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the cross-reference file (XREF-FILE) used to validate card numbers. It initializes the application result code to 8, attempts to open the file in INPUT mode, and then checks the operation's success. If the file opens successfully (status '00'), the result code is set to 0; otherwise, it's set to 12. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then aborts the program execution. This is a critical initialization step as the cross-reference file is essential for transaction validation in the main processing logic."
          },
          {
            "name": "0300-DALYREJS-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT DALYREJS-FILE                                            \n           IF  DALYREJS-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALY REJECTS FILE'                        \n               MOVE DALYREJS-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the daily rejects output file (DALYREJS-FILE). It initializes the application result code to 8, attempts to open the file, and then sets the result code to 0 if successful or 12 if unsuccessful. If the file open operation fails, the paragraph displays an error message, calls a routine to display the I/O status details, and then terminates the program abnormally. This is part of the program's error handling for file operations that ensures proper initialization of the rejection file where invalid transactions will be written."
          },
          {
            "name": "0400-ACCTFILE-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O  ACCOUNT-FILE                                               \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCOUNT MASTER FILE'                      \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the opening of the Account Master file in I-O (input-output) mode. It first sets a default error code of 8, then attempts to open the file. If the operation is successful (status code '00'), it resets the result code to 0; otherwise, it sets a more severe error code of 12. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then terminates the program abnormally. This is a critical initialization step that ensures the program has proper access to the account data before proceeding with transaction processing."
          },
          {
            "name": "0500-TCATBALF-OPEN",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O  TCATBAL-FILE                                               \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph attempts to open the Transaction Category Balance file in I-O (input-output) mode. It sets an initial result code of 8, then attempts the file open operation. If the file opens successfully (status '00'), it resets the result code to 0; otherwise, it sets a more severe error code of 12. If the operation fails, the paragraph displays an error message, shows the specific file status code through the 9910-DISPLAY-IO-STATUS paragraph, and then terminates the program by calling the 9999-ABEND-PROGRAM paragraph. This is a critical file operation as the program needs to update transaction category balances for valid credit card transactions."
          },
          {
            "name": "1000-DALYTRAN-GET-NEXT",
            "code": "READ DALYTRAN-FILE INTO DALYTRAN-RECORD.                             \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n      *        DISPLAY DALYTRAN-RECORD                                          \n           ELSE                                                                 \n               IF  DALYTRAN-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING DALYTRAN FILE'                        \n                   MOVE DALYTRAN-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph reads the next record from the daily transaction file (DALYTRAN-FILE) and handles any file access errors. It sets APPL-RESULT to 0 for successful reads, 16 for end-of-file conditions, and 12 for other file errors. When a successful read occurs, processing continues normally. When end-of-file is reached, it sets the END-OF-FILE flag to 'Y'. For any other file errors, it displays an error message, captures the file status code, displays detailed I/O status information, and then terminates the program abnormally. This paragraph is a critical part of the transaction processing loop, controlling the sequential reading of input transactions."
          },
          {
            "name": "1500-VALIDATE-TRAN",
            "code": "PERFORM 1500-A-LOOKUP-XREF.                                          \n           IF WS-VALIDATION-FAIL-REASON = 0                                     \n              PERFORM 1500-B-LOOKUP-ACCT                                        \n           ELSE                                                                 \n              CONTINUE                                                          \n           END-IF                                                               \n      * ADD MORE VALIDATIONS HERE                                               \n           EXIT.",
            "description": "This paragraph orchestrates the transaction validation process by first performing a cross-reference lookup (1500-A-LOOKUP-XREF) to validate the card number. If this initial validation passes (indicated by WS-VALIDATION-FAIL-REASON = 0), it proceeds to look up and validate the account details by calling the 1500-B-LOOKUP-ACCT paragraph. The code includes a comment indicating where additional validation steps could be added in the future. The paragraph serves as a control point for the sequential validation steps required before a transaction can be processed."
          },
          {
            "name": "1500-A-LOOKUP-XREF",
            "code": "*    DISPLAY 'CARD NUMBER: ' DALYTRAN-CARD-NUM                            \n           MOVE DALYTRAN-CARD-NUM TO FD-XREF-CARD-NUM                           \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n              INVALID KEY                                                       \n                MOVE 100 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'INVALID CARD NUMBER FOUND'                                \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n              NOT INVALID KEY                                                   \n      *           DISPLAY 'ACCOUNT RECORD FOUND'                                \n                  CONTINUE                                                      \n           END-READ                                                             \n           EXIT.",
            "description": "This paragraph performs a lookup in the card cross-reference file to validate the card number from the daily transaction record. It reads the XREF-FILE using the card number as the key. If the card number is not found (INVALID KEY), it sets the validation failure reason code to 100 and the description to \"INVALID CARD NUMBER FOUND\". If the card number is found, the program continues processing. This is a critical validation step that ensures transactions are only processed for valid card numbers that exist in the system."
          },
          {
            "name": "1500-B-LOOKUP-ACCT",
            "code": "MOVE XREF-ACCT-ID TO FD-ACCT-ID                                      \n           READ ACCOUNT-FILE INTO ACCOUNT-RECORD                                \n              INVALID KEY                                                       \n                MOVE 101 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'ACCOUNT RECORD NOT FOUND'                                 \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n              NOT INVALID KEY                                                   \n      *         DISPLAY 'ACCT-CREDIT-LIMIT:' ACCT-CREDIT-LIMIT                  \n      *         DISPLAY 'TRAN-AMT         :' DALYTRAN-AMT                       \n                COMPUTE WS-TEMP-BAL = ACCT-CURR-CYC-CREDIT                      \n                                    - ACCT-CURR-CYC-DEBIT                       \n                                    + DALYTRAN-AMT                              \n                                                                                \n                IF ACCT-CREDIT-LIMIT >= WS-TEMP-BAL                             \n                  CONTINUE                                                      \n                ELSE                                                            \n                  MOVE 102 TO WS-VALIDATION-FAIL-REASON                         \n                  MOVE 'OVERLIMIT TRANSACTION'                                  \n                    TO WS-VALIDATION-FAIL-REASON-DESC                           \n                END-IF                                                          \n                IF ACCT-EXPIRAION-DATE >= DALYTRAN-ORIG-TS (1:10)               \n                  CONTINUE                                                      \n                ELSE                                                            \n                  MOVE 103 TO WS-VALIDATION-FAIL-REASON                         \n                  MOVE 'TRANSACTION RECEIVED AFTER ACCT EXPIRATION'             \n                    TO WS-VALIDATION-FAIL-REASON-DESC                           \n                END-IF                                                          \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph performs account validation for a credit card transaction. It reads the account record using the account ID from the cross-reference file and performs several validation checks. First, it verifies the account exists, setting error code 101 if not found. For valid accounts, it calculates a temporary balance by adding the transaction amount to the difference between current cycle credits and debits. It then checks if this new balance would exceed the account's credit limit (error code 102) and verifies the transaction date is not after the account's expiration date (error code 103). Each validation failure sets an appropriate reason code and description for later processing. The paragraph is a critical part of the transaction validation workflow, ensuring transactions are only processed for valid, active accounts with sufficient available credit."
          },
          {
            "name": "2000-POST-TRANSACTION",
            "code": "MOVE  DALYTRAN-ID            TO    TRAN-ID                           \n           MOVE  DALYTRAN-TYPE-CD       TO    TRAN-TYPE-CD                      \n           MOVE  DALYTRAN-CAT-CD        TO    TRAN-CAT-CD                       \n           MOVE  DALYTRAN-SOURCE        TO    TRAN-SOURCE                       \n           MOVE  DALYTRAN-DESC          TO    TRAN-DESC                         \n           MOVE  DALYTRAN-AMT           TO    TRAN-AMT                          \n           MOVE  DALYTRAN-MERCHANT-ID   TO    TRAN-MERCHANT-ID                  \n           MOVE  DALYTRAN-MERCHANT-NAME TO    TRAN-MERCHANT-NAME                \n           MOVE  DALYTRAN-MERCHANT-CITY TO    TRAN-MERCHANT-CITY                \n           MOVE  DALYTRAN-MERCHANT-ZIP  TO    TRAN-MERCHANT-ZIP                 \n           MOVE  DALYTRAN-CARD-NUM      TO    TRAN-CARD-NUM                     \n           MOVE  DALYTRAN-ORIG-TS       TO    TRAN-ORIG-TS                      \n           PERFORM Z-GET-DB2-FORMAT-TIMESTAMP                                   \n           MOVE  DB2-FORMAT-TS          TO    TRAN-PROC-TS                      \n                                                                                \n           PERFORM 2700-UPDATE-TCATBAL                                          \n           PERFORM 2800-UPDATE-ACCOUNT-REC                                      \n           PERFORM 2900-WRITE-TRANSACTION-FILE                                  \n                                                                                \n           EXIT.",
            "description": "This paragraph handles the posting of a valid credit card transaction. It first maps data from the daily transaction record (DALYTRAN) to the transaction record (TRAN) fields, including transaction ID, type code, category code, source, description, amount, merchant details, card number, and original timestamp. It then generates a current timestamp in DB2 format for the transaction processing time. After preparing the transaction record, the paragraph calls three sub-procedures: one to update transaction category balances (2700-UPDATE-TCATBAL), another to update the account record with the new transaction details (2800-UPDATE-ACCOUNT-REC), and finally a procedure to write the completed transaction to the transaction file (2900-WRITE-TRANSACTION-FILE)."
          },
          {
            "name": "2500-WRITE-REJECT-REC",
            "code": "MOVE DALYTRAN-RECORD TO REJECT-TRAN-DATA                             \n           MOVE WS-VALIDATION-TRAILER TO VALIDATION-TRAILER                     \n      *     DISPLAY '***' REJECT-RECORD                                         \n           MOVE 8 TO APPL-RESULT                                                \n           WRITE FD-REJS-RECORD FROM REJECT-RECORD                              \n           IF DALYREJS-STATUS = '00'                                            \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TO REJECTS FILE'                          \n               MOVE DALYREJS-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the writing of rejected transaction records to the rejection file. It copies the original transaction data to the rejection record structure, adds validation trailer information, and attempts to write the record to the rejection file. The paragraph sets a return code of 8 to indicate a rejected transaction. If the write operation fails (status not '00'), it sets a higher return code of 12, displays an error message, shows the I/O status details, and abends the program. This ensures that any file writing failures are properly handled and reported rather than allowing the program to continue with potentially corrupted data."
          },
          {
            "name": "2700-UPDATE-TCATBAL",
            "code": "* Update the balances in transaction balance file.                        \n           MOVE XREF-ACCT-ID TO FD-TRANCAT-ACCT-ID                              \n           MOVE DALYTRAN-TYPE-CD TO FD-TRANCAT-TYPE-CD                          \n           MOVE DALYTRAN-CAT-CD TO FD-TRANCAT-CD                                \n                                                                                \n           MOVE 'N' TO WS-CREATE-TRANCAT-REC                                    \n           READ TCATBAL-FILE INTO TRAN-CAT-BAL-RECORD                           \n              INVALID KEY                                                       \n                DISPLAY 'TCATBAL record not found for key : '                   \n                   FD-TRAN-CAT-KEY '.. Creating.'                               \n                MOVE 'Y' TO WS-CREATE-TRANCAT-REC                               \n           END-READ.                                                            \n                                                                                \n           IF  TCATBALF-STATUS = '00'  OR '23'                                  \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n                                                                                \n           IF WS-CREATE-TRANCAT-REC = 'Y'                                       \n              PERFORM 2700-A-CREATE-TCATBAL-REC                                 \n           ELSE                                                                 \n              PERFORM 2700-B-UPDATE-TCATBAL-REC                                 \n           END-IF                                                               \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph updates transaction category balances in the TCATBAL file based on the current transaction. It first attempts to read a record using the account ID, transaction type code, and category code as the key. If the record doesn't exist (indicated by an INVALID KEY condition), it sets a flag to create a new record. The paragraph includes error handling for file operations, displaying detailed status information and aborting the program if a read error occurs. Based on whether the record exists or not, it then calls either the 2700-A-CREATE-TCATBAL-REC paragraph to create a new transaction category balance record or the 2700-B-UPDATE-TCATBAL-REC paragraph to update an existing one."
          },
          {
            "name": "2700-A-CREATE-TCATBAL-REC",
            "code": "INITIALIZE TRAN-CAT-BAL-RECORD                                       \n           MOVE XREF-ACCT-ID TO TRANCAT-ACCT-ID                                 \n           MOVE DALYTRAN-TYPE-CD TO TRANCAT-TYPE-CD                             \n           MOVE DALYTRAN-CAT-CD TO TRANCAT-CD                                   \n           ADD DALYTRAN-AMT TO TRAN-CAT-BAL                                     \n                                                                                \n           WRITE FD-TRAN-CAT-BAL-RECORD FROM TRAN-CAT-BAL-RECORD                \n                                                                                \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n      *---------------------------------------------------------------*",
            "description": "This paragraph creates and writes a new transaction category balance record. It initializes a new record structure, populates it with account ID from the cross-reference file, transaction type and category codes from the daily transaction record, and adds the transaction amount to the category balance. The record is then written to the transaction category balance file. If the write operation is successful (status '00'), processing continues normally. If the write fails, the program displays an error message, shows the I/O status details by calling the 9910-DISPLAY-IO-STATUS paragraph, and then terminates abnormally by calling the 9999-ABEND-PROGRAM paragraph. This paragraph is part of the transaction processing logic that maintains running balances by transaction category for each account."
          },
          {
            "name": "2700-B-UPDATE-TCATBAL-REC",
            "code": "ADD DALYTRAN-AMT TO TRAN-CAT-BAL                                     \n           REWRITE FD-TRAN-CAT-BAL-RECORD FROM TRAN-CAT-BAL-RECORD              \n                                                                                \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR REWRITING TRANSACTION BALANCE FILE'               \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph updates the transaction category balance record by adding the current transaction amount to the existing balance. It then rewrites the updated record back to the transaction category balance file. If the rewrite operation is successful (status code '00'), it sets APPL-RESULT to 0 indicating success. If the rewrite fails, it sets APPL-RESULT to 12, displays an error message, shows the I/O status, and abends the program. This ensures that transaction category balances are accurately maintained and that any file operation failures are immediately detected and handled."
          },
          {
            "name": "2800-UPDATE-ACCOUNT-REC",
            "code": "* Update the balances in account record to reflect posted trans.          \n           ADD DALYTRAN-AMT  TO ACCT-CURR-BAL                                   \n           IF DALYTRAN-AMT >= 0                                                 \n              ADD DALYTRAN-AMT TO ACCT-CURR-CYC-CREDIT                          \n           ELSE                                                                 \n              ADD DALYTRAN-AMT TO ACCT-CURR-CYC-DEBIT                           \n           END-IF                                                               \n                                                                                \n           REWRITE FD-ACCTFILE-REC FROM  ACCOUNT-RECORD                         \n              INVALID KEY                                                       \n                MOVE 109 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'ACCOUNT RECORD NOT FOUND'                                 \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n           END-REWRITE.                                                         \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph updates the account record balances to reflect a posted transaction. It adds the transaction amount to the current balance and then, based on whether the transaction is positive (credit) or negative (debit), updates either the current cycle credit or debit total accordingly. After updating the in-memory record, it attempts to rewrite the modified account record back to the account file. If the rewrite operation fails due to an invalid key (account record not found), it sets error code 109 with a descriptive message. This paragraph is a critical part of the transaction processing flow, ensuring account balances are properly maintained after a transaction is validated."
          },
          {
            "name": "2900-WRITE-TRANSACTION-FILE",
            "code": "MOVE 8 TO  APPL-RESULT.                                              \n           WRITE FD-TRANFILE-REC FROM TRAN-RECORD                               \n                                                                                \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TO TRANSACTION FILE'                      \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles writing transaction records to the transaction file. It attempts to write the TRAN-RECORD to the file and then validates the operation's success. If the write operation is successful (status '00'), it sets APPL-RESULT to 0 indicating success. If the write fails, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, displays detailed I/O status information, and then abends the program. This ensures that transaction file write failures are properly handled and reported rather than allowing the program to continue with potentially corrupted data."
          },
          {
            "name": "9000-DALYTRAN-CLOSE",
            "code": "MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE DALYTRAN-FILE                                                  \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DALYTRAN FILE'                            \n               MOVE DALYTRAN-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the DALYTRAN-FILE (daily transaction file) with error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the close operation is successful (status '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then abends the program. This ensures proper file closure and appropriate error handling for the daily transaction file processing."
          },
          {
            "name": "9100-TRANFILE-CLOSE",
            "code": "MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE TRANSACT-FILE                                                  \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the transaction file (TRANSACT-FILE) with error handling. It initially sets the application result code to 8, then attempts to close the file. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets it to 12. When an error occurs during file closing, the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then abends the program. This ensures proper file handling and provides clear error reporting when transaction file closure fails."
          },
          {
            "name": "9200-XREFFILE-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the cross-reference file (XREF-FILE) used to validate card numbers. It initially sets the application result code to 8, then attempts to close the file. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets it to 12. When an error occurs during file closing, the paragraph displays an error message, captures the file status code, calls a routine to display detailed I/O status information, and then abends the program. This ensures proper file handling and provides clear error reporting when file closure fails."
          },
          {
            "name": "9300-DALYREJS-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DALYREJS-FILE                                                  \n           IF  DALYREJS-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DAILY REJECTS FILE'                       \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the daily rejects file (DALYREJS-FILE) and performs error handling. It initially sets APPL-RESULT to 8, then attempts to close the file. If the close operation is successful (status code '00'), it resets APPL-RESULT to 0; otherwise, it sets APPL-RESULT to 12 indicating an error. When an error occurs, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then aborts the program execution by calling the abend routine. This ensures proper file closure and appropriate error handling for the daily transaction rejection file."
          },
          {
            "name": "9400-ACCTFILE-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE ACCOUNT-FILE                                                   \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*",
            "description": "This paragraph handles the closing of the Account File with error handling. It initially sets a default error code (8), then attempts to close the file. If the close operation is successful (status '00'), it resets the result code to 0; otherwise, it sets a more severe error code (12). When an error occurs, the paragraph displays an error message, captures the file status code, displays detailed I/O status information, and terminates the program abnormally. This ensures proper file closure and appropriate error handling during program termination."
          },
          {
            "name": "9500-TCATBALF-CLOSE",
            "code": "MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TCATBAL-FILE                                                   \n           IF  TCATBALF-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.",
            "description": "This paragraph handles the closing of the Transaction Category Balance File (TCATBAL-FILE). It initially sets an error code (8) in APPL-RESULT, then attempts to close the file. If the close operation is successful (status '00'), it resets APPL-RESULT to 0 indicating success. If the close fails, it sets APPL-RESULT to 12 indicating a more severe error. When an error occurs, the paragraph displays an error message, retrieves the file status code, calls a routine to display the I/O status details, and then abends the program. This ensures proper file handling and provides clear error reporting when file closure problems occur."
          },
          {
            "name": "Z-GET-DB2-FORMAT-TIMESTAMP",
            "code": "MOVE FUNCTION CURRENT-DATE TO COBOL-TS                               \n           MOVE COB-YYYY TO DB2-YYYY                                            \n           MOVE COB-MM   TO DB2-MM                                              \n           MOVE COB-DD   TO DB2-DD                                              \n           MOVE COB-HH   TO DB2-HH                                              \n           MOVE COB-MIN  TO DB2-MIN                                             \n           MOVE COB-SS   TO DB2-SS                                              \n           MOVE COB-MIL  TO DB2-MIL                                             \n           MOVE '0000'   TO DB2-REST                                            \n           MOVE '-' TO DB2-STREEP-1 DB2-STREEP-2 DB2-STREEP-3                   \n           MOVE '.' TO DB2-DOT-1 DB2-DOT-2 DB2-DOT-3                            \n      *    DISPLAY 'DB2-TIMESTAMP = ' DB2-FORMAT-TS                             \n           EXIT.",
            "description": "This paragraph retrieves the current system date and time and formats it into a DB2-compatible timestamp format. It uses the FUNCTION CURRENT-DATE to get the current timestamp, then maps individual components (year, month, day, hour, minute, second, millisecond) from the COBOL timestamp structure to a DB2 timestamp format. The paragraph adds necessary formatting characters like hyphens and decimal points to create a properly formatted DB2 timestamp (YYYY-MM-DD-HH.MI.SS.MMMMMM). This timestamp can be used for database operations that require timestamp values, such as recording when transactions were processed."
          },
          {
            "name": "9999-ABEND-PROGRAM",
            "code": "DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************",
            "description": "This paragraph handles abnormal program termination by displaying an \"ABENDING PROGRAM\" message, resetting the timing variable to zero, setting an abort code of 999, and then calling the Language Environment service 'CEE3ABD' to force an immediate program abort. This is likely used in critical error situations where the program cannot continue execution and needs to terminate in a controlled manner."
          },
          {
            "name": "9910-DISPLAY-IO-STATUS",
            "code": "IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *",
            "description": "This paragraph handles the display of file I/O status codes in a standardized format. When a file operation error occurs, it formats the status code for display, with special handling for extended file status codes (where the first digit is '9'). For extended status codes, it extracts the first digit and converts the second byte to a binary value for proper display. For standard status codes, it formats them as '00xx' where 'xx' is the two-digit status code. The paragraph ensures consistent error reporting by displaying all file status codes in a 'NNNN' format with the message \"FILE STATUS IS: NNNN\" regardless of whether they are standard or extended codes."
          }
        ],
        "code": "DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN02C'.                    \n           PERFORM 0000-DALYTRAN-OPEN.                                          \n           PERFORM 0100-TRANFILE-OPEN.                                          \n           PERFORM 0200-XREFFILE-OPEN.                                          \n           PERFORM 0300-DALYREJS-OPEN.                                          \n           PERFORM 0400-ACCTFILE-OPEN.                                          \n           PERFORM 0500-TCATBALF-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-DALYTRAN-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                     ADD 1 TO WS-TRANSACTION-COUNT                              \n      *              DISPLAY DALYTRAN-RECORD                                    \n                     MOVE 0 TO WS-VALIDATION-FAIL-REASON                        \n                     MOVE SPACES TO WS-VALIDATION-FAIL-REASON-DESC              \n                     PERFORM 1500-VALIDATE-TRAN                                 \n                     IF WS-VALIDATION-FAIL-REASON = 0                           \n                       PERFORM 2000-POST-TRANSACTION                            \n                     ELSE                                                       \n                       ADD 1 TO WS-REJECT-COUNT                                 \n                       PERFORM 2500-WRITE-REJECT-REC                            \n                     END-IF                                                     \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-DALYTRAN-CLOSE.                                         \n           PERFORM 9100-TRANFILE-CLOSE.                                         \n           PERFORM 9200-XREFFILE-CLOSE.                                         \n           PERFORM 9300-DALYREJS-CLOSE.                                         \n           PERFORM 9400-ACCTFILE-CLOSE.                                         \n           PERFORM 9500-TCATBALF-CLOSE.                                         \n           DISPLAY 'TRANSACTIONS PROCESSED :' WS-TRANSACTION-COUNT              \n           DISPLAY 'TRANSACTIONS REJECTED  :' WS-REJECT-COUNT                   \n           IF WS-REJECT-COUNT > 0                                               \n              MOVE 4 TO RETURN-CODE                                             \n           END-IF                                                               \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN02C'.                      \n                                                                                \n           GOBACK.                                                              \n      *---------------------------------------------------------------*         \n       0000-DALYTRAN-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DALYTRAN-FILE                                             \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALYTRAN'                                 \n               MOVE DALYTRAN-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0100-TRANFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT TRANSACT-FILE                                            \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       0200-XREFFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0300-DALYREJS-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT DALYREJS-FILE                                            \n           IF  DALYREJS-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALY REJECTS FILE'                        \n               MOVE DALYREJS-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0400-ACCTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O  ACCOUNT-FILE                                               \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCOUNT MASTER FILE'                      \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0500-TCATBALF-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O  TCATBAL-FILE                                               \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1000-DALYTRAN-GET-NEXT.                                                  \n           READ DALYTRAN-FILE INTO DALYTRAN-RECORD.                             \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n      *        DISPLAY DALYTRAN-RECORD                                          \n           ELSE                                                                 \n               IF  DALYTRAN-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING DALYTRAN FILE'                        \n                   MOVE DALYTRAN-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n       1500-VALIDATE-TRAN.                                                      \n           PERFORM 1500-A-LOOKUP-XREF.                                          \n           IF WS-VALIDATION-FAIL-REASON = 0                                     \n              PERFORM 1500-B-LOOKUP-ACCT                                        \n           ELSE                                                                 \n              CONTINUE                                                          \n           END-IF                                                               \n      * ADD MORE VALIDATIONS HERE                                               \n           EXIT.                                                                \n                                                                                \n       1500-A-LOOKUP-XREF.                                                      \n      *    DISPLAY 'CARD NUMBER: ' DALYTRAN-CARD-NUM                            \n           MOVE DALYTRAN-CARD-NUM TO FD-XREF-CARD-NUM                           \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n              INVALID KEY                                                       \n                MOVE 100 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'INVALID CARD NUMBER FOUND'                                \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n              NOT INVALID KEY                                                   \n      *           DISPLAY 'ACCOUNT RECORD FOUND'                                \n                  CONTINUE                                                      \n           END-READ                                                             \n           EXIT.                                                                \n       1500-B-LOOKUP-ACCT.                                                      \n           MOVE XREF-ACCT-ID TO FD-ACCT-ID                                      \n           READ ACCOUNT-FILE INTO ACCOUNT-RECORD                                \n              INVALID KEY                                                       \n                MOVE 101 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'ACCOUNT RECORD NOT FOUND'                                 \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n              NOT INVALID KEY                                                   \n      *         DISPLAY 'ACCT-CREDIT-LIMIT:' ACCT-CREDIT-LIMIT                  \n      *         DISPLAY 'TRAN-AMT         :' DALYTRAN-AMT                       \n                COMPUTE WS-TEMP-BAL = ACCT-CURR-CYC-CREDIT                      \n                                    - ACCT-CURR-CYC-DEBIT                       \n                                    + DALYTRAN-AMT                              \n                                                                                \n                IF ACCT-CREDIT-LIMIT >= WS-TEMP-BAL                             \n                  CONTINUE                                                      \n                ELSE                                                            \n                  MOVE 102 TO WS-VALIDATION-FAIL-REASON                         \n                  MOVE 'OVERLIMIT TRANSACTION'                                  \n                    TO WS-VALIDATION-FAIL-REASON-DESC                           \n                END-IF                                                          \n                IF ACCT-EXPIRAION-DATE >= DALYTRAN-ORIG-TS (1:10)               \n                  CONTINUE                                                      \n                ELSE                                                            \n                  MOVE 103 TO WS-VALIDATION-FAIL-REASON                         \n                  MOVE 'TRANSACTION RECEIVED AFTER ACCT EXPIRATION'             \n                    TO WS-VALIDATION-FAIL-REASON-DESC                           \n                END-IF                                                          \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2000-POST-TRANSACTION.                                                   \n           MOVE  DALYTRAN-ID            TO    TRAN-ID                           \n           MOVE  DALYTRAN-TYPE-CD       TO    TRAN-TYPE-CD                      \n           MOVE  DALYTRAN-CAT-CD        TO    TRAN-CAT-CD                       \n           MOVE  DALYTRAN-SOURCE        TO    TRAN-SOURCE                       \n           MOVE  DALYTRAN-DESC          TO    TRAN-DESC                         \n           MOVE  DALYTRAN-AMT           TO    TRAN-AMT                          \n           MOVE  DALYTRAN-MERCHANT-ID   TO    TRAN-MERCHANT-ID                  \n           MOVE  DALYTRAN-MERCHANT-NAME TO    TRAN-MERCHANT-NAME                \n           MOVE  DALYTRAN-MERCHANT-CITY TO    TRAN-MERCHANT-CITY                \n           MOVE  DALYTRAN-MERCHANT-ZIP  TO    TRAN-MERCHANT-ZIP                 \n           MOVE  DALYTRAN-CARD-NUM      TO    TRAN-CARD-NUM                     \n           MOVE  DALYTRAN-ORIG-TS       TO    TRAN-ORIG-TS                      \n           PERFORM Z-GET-DB2-FORMAT-TIMESTAMP                                   \n           MOVE  DB2-FORMAT-TS          TO    TRAN-PROC-TS                      \n                                                                                \n           PERFORM 2700-UPDATE-TCATBAL                                          \n           PERFORM 2800-UPDATE-ACCOUNT-REC                                      \n           PERFORM 2900-WRITE-TRANSACTION-FILE                                  \n                                                                                \n           EXIT.                                                                \n                                                                                \n       2500-WRITE-REJECT-REC.                                                   \n           MOVE DALYTRAN-RECORD TO REJECT-TRAN-DATA                             \n           MOVE WS-VALIDATION-TRAILER TO VALIDATION-TRAILER                     \n      *     DISPLAY '***' REJECT-RECORD                                         \n           MOVE 8 TO APPL-RESULT                                                \n           WRITE FD-REJS-RECORD FROM REJECT-RECORD                              \n           IF DALYREJS-STATUS = '00'                                            \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TO REJECTS FILE'                          \n               MOVE DALYREJS-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2700-UPDATE-TCATBAL.                                                     \n      * Update the balances in transaction balance file.                        \n           MOVE XREF-ACCT-ID TO FD-TRANCAT-ACCT-ID                              \n           MOVE DALYTRAN-TYPE-CD TO FD-TRANCAT-TYPE-CD                          \n           MOVE DALYTRAN-CAT-CD TO FD-TRANCAT-CD                                \n                                                                                \n           MOVE 'N' TO WS-CREATE-TRANCAT-REC                                    \n           READ TCATBAL-FILE INTO TRAN-CAT-BAL-RECORD                           \n              INVALID KEY                                                       \n                DISPLAY 'TCATBAL record not found for key : '                   \n                   FD-TRAN-CAT-KEY '.. Creating.'                               \n                MOVE 'Y' TO WS-CREATE-TRANCAT-REC                               \n           END-READ.                                                            \n                                                                                \n           IF  TCATBALF-STATUS = '00'  OR '23'                                  \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n                                                                                \n           IF WS-CREATE-TRANCAT-REC = 'Y'                                       \n              PERFORM 2700-A-CREATE-TCATBAL-REC                                 \n           ELSE                                                                 \n              PERFORM 2700-B-UPDATE-TCATBAL-REC                                 \n           END-IF                                                               \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2700-A-CREATE-TCATBAL-REC.                                               \n           INITIALIZE TRAN-CAT-BAL-RECORD                                       \n           MOVE XREF-ACCT-ID TO TRANCAT-ACCT-ID                                 \n           MOVE DALYTRAN-TYPE-CD TO TRANCAT-TYPE-CD                             \n           MOVE DALYTRAN-CAT-CD TO TRANCAT-CD                                   \n           ADD DALYTRAN-AMT TO TRAN-CAT-BAL                                     \n                                                                                \n           WRITE FD-TRAN-CAT-BAL-RECORD FROM TRAN-CAT-BAL-RECORD                \n                                                                                \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n      *---------------------------------------------------------------*         \n       2700-B-UPDATE-TCATBAL-REC.                                               \n           ADD DALYTRAN-AMT TO TRAN-CAT-BAL                                     \n           REWRITE FD-TRAN-CAT-BAL-RECORD FROM TRAN-CAT-BAL-RECORD              \n                                                                                \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR REWRITING TRANSACTION BALANCE FILE'               \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n                                                                                \n      *---------------------------------------------------------------*         \n       2800-UPDATE-ACCOUNT-REC.                                                 \n      * Update the balances in account record to reflect posted trans.          \n           ADD DALYTRAN-AMT  TO ACCT-CURR-BAL                                   \n           IF DALYTRAN-AMT >= 0                                                 \n              ADD DALYTRAN-AMT TO ACCT-CURR-CYC-CREDIT                          \n           ELSE                                                                 \n              ADD DALYTRAN-AMT TO ACCT-CURR-CYC-DEBIT                           \n           END-IF                                                               \n                                                                                \n           REWRITE FD-ACCTFILE-REC FROM  ACCOUNT-RECORD                         \n              INVALID KEY                                                       \n                MOVE 109 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'ACCOUNT RECORD NOT FOUND'                                 \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n           END-REWRITE.                                                         \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2900-WRITE-TRANSACTION-FILE.                                             \n           MOVE 8 TO  APPL-RESULT.                                              \n           WRITE FD-TRANFILE-REC FROM TRAN-RECORD                               \n                                                                                \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TO TRANSACTION FILE'                      \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9000-DALYTRAN-CLOSE.                                                     \n           MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE DALYTRAN-FILE                                                  \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DALYTRAN FILE'                            \n               MOVE DALYTRAN-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9100-TRANFILE-CLOSE.                                                     \n           MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE TRANSACT-FILE                                                  \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9200-XREFFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9300-DALYREJS-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DALYREJS-FILE                                                  \n           IF  DALYREJS-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DAILY REJECTS FILE'                       \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9400-ACCTFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE ACCOUNT-FILE                                                   \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9500-TCATBALF-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TCATBAL-FILE                                                   \n           IF  TCATBALF-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       Z-GET-DB2-FORMAT-TIMESTAMP.                                              \n           MOVE FUNCTION CURRENT-DATE TO COBOL-TS                               \n           MOVE COB-YYYY TO DB2-YYYY                                            \n           MOVE COB-MM   TO DB2-MM                                              \n           MOVE COB-DD   TO DB2-DD                                              \n           MOVE COB-HH   TO DB2-HH                                              \n           MOVE COB-MIN  TO DB2-MIN                                             \n           MOVE COB-SS   TO DB2-SS                                              \n           MOVE COB-MIL  TO DB2-MIL                                             \n           MOVE '0000'   TO DB2-REST                                            \n           MOVE '-' TO DB2-STREEP-1 DB2-STREEP-2 DB2-STREEP-3                   \n           MOVE '.' TO DB2-DOT-1 DB2-DOT-2 DB2-DOT-3                            \n      *    DISPLAY 'DB2-TIMESTAMP = ' DB2-FORMAT-TS                             \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *"
      },
      "description": "This batch COBOL program (CBTRN02C) processes daily credit card transactions from a sequential input file and posts them to various account and transaction files. The program reads each transaction record, validates it against account and card reference data, and then updates account balances and transaction category balances accordingly.\n\nThe program performs several key functions:\n1. Validates transactions by checking card numbers against a cross-reference file\n2. Verifies account existence, credit limits, and expiration dates\n3. Updates account balances (current balance, cycle credits/debits)\n4. Updates transaction category balances by account\n5. Writes valid transactions to a transaction file\n6. Writes rejected transactions to a rejection file with reason codes\n\nThe validation process includes checks for invalid card numbers, non-existent accounts, over-limit transactions, and expired accounts. For valid transactions, the program updates multiple files to reflect the transaction, including the account master file and a transaction category balance file.\n\nThe program maintains counters for processed and rejected transactions, and sets a non-zero return code if any transactions are rejected. It includes comprehensive error handling for file operations and displays detailed status information when errors occur.",
      "error_handling": null,
      "code": "      ******************************************************************\n      * Program     : CBTRN02C.CBL                                      \n      * Application : CardDemo                                          \n      * Type        : BATCH COBOL Program                                \n      * Function    : Post the records from daily transaction file.     \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************\n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.    CBTRN02C.                                                 \n       AUTHOR.        AWS.                                                      \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n       FILE-CONTROL.                                                            \n           SELECT DALYTRAN-FILE ASSIGN TO DALYTRAN                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  FILE STATUS  IS DALYTRAN-STATUS.                              \n                                                                                \n           SELECT TRANSACT-FILE ASSIGN TO TRANFILE                              \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRANS-ID                                   \n                  FILE STATUS  IS TRANFILE-STATUS.                              \n                                                                                \n           SELECT XREF-FILE ASSIGN TO   XREFFILE                                \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-XREF-CARD-NUM                              \n                  FILE STATUS  IS XREFFILE-STATUS.                              \n                                                                                \n           SELECT DALYREJS-FILE ASSIGN TO DALYREJS                              \n                  ORGANIZATION IS SEQUENTIAL                                    \n                  ACCESS MODE  IS SEQUENTIAL                                    \n                  FILE STATUS  IS DALYREJS-STATUS.                              \n                                                                                \n           SELECT ACCOUNT-FILE ASSIGN TO ACCTFILE                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-ACCT-ID                                    \n                  FILE STATUS  IS ACCTFILE-STATUS.                              \n                                                                                \n           SELECT TCATBAL-FILE ASSIGN TO TCATBALF                               \n                  ORGANIZATION IS INDEXED                                       \n                  ACCESS MODE  IS RANDOM                                        \n                  RECORD KEY   IS FD-TRAN-CAT-KEY                               \n                  FILE STATUS  IS TCATBALF-STATUS.                              \n                                                                                \n      *                                                                         \n       DATA DIVISION.                                                           \n       FILE SECTION.                                                            \n       FD  DALYTRAN-FILE.                                                       \n       01  FD-TRAN-RECORD.                                                      \n           05 FD-TRAN-ID                        PIC X(16).                      \n           05 FD-CUST-DATA                      PIC X(334).                     \n                                                                                \n       FD  TRANSACT-FILE.                                                       \n       01  FD-TRANFILE-REC.                                                     \n           05 FD-TRANS-ID                       PIC X(16).                      \n           05 FD-ACCT-DATA                      PIC X(334).                     \n                                                                                \n       FD  XREF-FILE.                                                           \n       01  FD-XREFFILE-REC.                                                     \n           05 FD-XREF-CARD-NUM                  PIC X(16).                      \n           05 FD-XREF-DATA                      PIC X(34).                      \n                                                                                \n       FD  DALYREJS-FILE.                                                       \n       01  FD-REJS-RECORD.                                                      \n           05 FD-REJECT-RECORD                  PIC X(350).                     \n           05 FD-VALIDATION-TRAILER             PIC X(80).                      \n                                                                                \n       FD  ACCOUNT-FILE.                                                        \n       01  FD-ACCTFILE-REC.                                                     \n           05 FD-ACCT-ID                        PIC 9(11).                      \n           05 FD-ACCT-DATA                      PIC X(289).                     \n                                                                                \n       FD  TCATBAL-FILE.                                                        \n       01  FD-TRAN-CAT-BAL-RECORD.                                              \n           05 FD-TRAN-CAT-KEY.                                                  \n              10 FD-TRANCAT-ACCT-ID             PIC 9(11).                      \n              10 FD-TRANCAT-TYPE-CD             PIC X(02).                      \n              10 FD-TRANCAT-CD                  PIC 9(04).                      \n           05 FD-FD-TRAN-CAT-DATA               PIC X(33).                      \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      *****************************************************************         \n       COPY CVTRA06Y.                                                           \n       01  DALYTRAN-STATUS.                                                     \n           05  DALYTRAN-STAT1      PIC X.                                       \n           05  DALYTRAN-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA05Y.                                                           \n       01  TRANFILE-STATUS.                                                     \n           05  TRANFILE-STAT1      PIC X.                                       \n           05  TRANFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT03Y.                                                           \n       01  XREFFILE-STATUS.                                                     \n           05  XREFFILE-STAT1      PIC X.                                       \n           05  XREFFILE-STAT2      PIC X.                                       \n                                                                                \n       01  DALYREJS-STATUS.                                                     \n           05  DALYREJS-STAT1      PIC X.                                       \n           05  DALYREJS-STAT2      PIC X.                                       \n                                                                                \n       COPY CVACT01Y.                                                           \n       01  ACCTFILE-STATUS.                                                     \n           05  ACCTFILE-STAT1      PIC X.                                       \n           05  ACCTFILE-STAT2      PIC X.                                       \n                                                                                \n       COPY CVTRA01Y.                                                           \n       01  TCATBALF-STATUS.                                                     \n           05  TCATBALF-STAT1      PIC X.                                       \n           05  TCATBALF-STAT2      PIC X.                                       \n                                                                                \n       01  IO-STATUS.                                                           \n           05  IO-STAT1            PIC X.                                       \n           05  IO-STAT2            PIC X.                                       \n       01  TWO-BYTES-BINARY        PIC 9(4) BINARY.                             \n       01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.                  \n           05  TWO-BYTES-LEFT      PIC X.                                       \n           05  TWO-BYTES-RIGHT     PIC X.                                       \n       01  IO-STATUS-04.                                                        \n           05  IO-STATUS-0401      PIC 9   VALUE 0.                             \n           05  IO-STATUS-0403      PIC 999 VALUE 0.                             \n                                                                                \n       01  APPL-RESULT             PIC S9(9)   COMP.                            \n           88  APPL-AOK            VALUE 0.                                     \n           88  APPL-EOF            VALUE 16.                                    \n                                                                                \n       01  END-OF-FILE             PIC X(01)    VALUE 'N'.                      \n       01  ABCODE                  PIC S9(9) BINARY.                            \n       01  TIMING                  PIC S9(9) BINARY.                            \n      * T I M E S T A M P   D B 2  X(26)     EEEE-MM-DD-UU.MM.SS.HH0000         \n       01  COBOL-TS.                                                            \n           05 COB-YYYY                  PIC X(04).                              \n           05 COB-MM                    PIC X(02).                              \n           05 COB-DD                    PIC X(02).                              \n           05 COB-HH                    PIC X(02).                              \n           05 COB-MIN                   PIC X(02).                              \n           05 COB-SS                    PIC X(02).                              \n           05 COB-MIL                   PIC X(02).                              \n           05 COB-REST                  PIC X(05).                              \n       01  DB2-FORMAT-TS                PIC X(26).                              \n       01  FILLER REDEFINES DB2-FORMAT-TS.                                      \n           06 DB2-YYYY                  PIC X(004).                      E      \n           06 DB2-STREEP-1              PIC X.                           -      \n           06 DB2-MM                    PIC X(002).                      M      \n           06 DB2-STREEP-2              PIC X.                           -      \n           06 DB2-DD                    PIC X(002).                      D      \n           06 DB2-STREEP-3              PIC X.                           -      \n           06 DB2-HH                    PIC X(002).                      U      \n           06 DB2-DOT-1                 PIC X.                                  \n           06 DB2-MIN                   PIC X(002).                             \n           06 DB2-DOT-2                 PIC X.                                  \n           06 DB2-SS                    PIC X(002).                             \n           06 DB2-DOT-3                 PIC X.                                  \n           06 DB2-MIL                   PIC 9(002).                             \n           06 DB2-REST                  PIC X(04).                              \n                                                                                \n        01 REJECT-RECORD.                                                       \n           05 REJECT-TRAN-DATA          PIC X(350).                             \n           05 VALIDATION-TRAILER        PIC X(80).                              \n                                                                                \n        01 WS-VALIDATION-TRAILER.                                               \n           05 WS-VALIDATION-FAIL-REASON      PIC 9(04).                         \n           05 WS-VALIDATION-FAIL-REASON-DESC PIC X(76).                         \n                                                                                \n        01 WS-COUNTERS.                                                         \n           05 WS-TRANSACTION-COUNT          PIC 9(09) VALUE 0.                  \n           05 WS-REJECT-COUNT               PIC 9(09) VALUE 0.                  \n           05 WS-TEMP-BAL                   PIC S9(09)V99.                      \n                                                                                \n        01 WS-FLAGS.                                                            \n           05 WS-CREATE-TRANCAT-REC         PIC X(01) VALUE 'N'.                \n                                                                                \n      *****************************************************************         \n       PROCEDURE DIVISION.                                                      \n           DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN02C'.                    \n           PERFORM 0000-DALYTRAN-OPEN.                                          \n           PERFORM 0100-TRANFILE-OPEN.                                          \n           PERFORM 0200-XREFFILE-OPEN.                                          \n           PERFORM 0300-DALYREJS-OPEN.                                          \n           PERFORM 0400-ACCTFILE-OPEN.                                          \n           PERFORM 0500-TCATBALF-OPEN.                                          \n                                                                                \n           PERFORM UNTIL END-OF-FILE = 'Y'                                      \n               IF  END-OF-FILE = 'N'                                            \n                   PERFORM 1000-DALYTRAN-GET-NEXT                               \n                   IF  END-OF-FILE = 'N'                                        \n                     ADD 1 TO WS-TRANSACTION-COUNT                              \n      *              DISPLAY DALYTRAN-RECORD                                    \n                     MOVE 0 TO WS-VALIDATION-FAIL-REASON                        \n                     MOVE SPACES TO WS-VALIDATION-FAIL-REASON-DESC              \n                     PERFORM 1500-VALIDATE-TRAN                                 \n                     IF WS-VALIDATION-FAIL-REASON = 0                           \n                       PERFORM 2000-POST-TRANSACTION                            \n                     ELSE                                                       \n                       ADD 1 TO WS-REJECT-COUNT                                 \n                       PERFORM 2500-WRITE-REJECT-REC                            \n                     END-IF                                                     \n                   END-IF                                                       \n               END-IF                                                           \n           END-PERFORM.                                                         \n                                                                                \n           PERFORM 9000-DALYTRAN-CLOSE.                                         \n           PERFORM 9100-TRANFILE-CLOSE.                                         \n           PERFORM 9200-XREFFILE-CLOSE.                                         \n           PERFORM 9300-DALYREJS-CLOSE.                                         \n           PERFORM 9400-ACCTFILE-CLOSE.                                         \n           PERFORM 9500-TCATBALF-CLOSE.                                         \n           DISPLAY 'TRANSACTIONS PROCESSED :' WS-TRANSACTION-COUNT              \n           DISPLAY 'TRANSACTIONS REJECTED  :' WS-REJECT-COUNT                   \n           IF WS-REJECT-COUNT > 0                                               \n              MOVE 4 TO RETURN-CODE                                             \n           END-IF                                                               \n           DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN02C'.                      \n                                                                                \n           GOBACK.                                                              \n      *---------------------------------------------------------------*         \n       0000-DALYTRAN-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT DALYTRAN-FILE                                             \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALYTRAN'                                 \n               MOVE DALYTRAN-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0100-TRANFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT TRANSACT-FILE                                            \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       0200-XREFFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN INPUT XREF-FILE                                                 \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0300-DALYREJS-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN OUTPUT DALYREJS-FILE                                            \n           IF  DALYREJS-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING DALY REJECTS FILE'                        \n               MOVE DALYREJS-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0400-ACCTFILE-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O  ACCOUNT-FILE                                               \n           IF  ACCTFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING ACCOUNT MASTER FILE'                      \n               MOVE ACCTFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       0500-TCATBALF-OPEN.                                                      \n           MOVE 8 TO APPL-RESULT.                                               \n           OPEN I-O  TCATBAL-FILE                                               \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR OPENING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       1000-DALYTRAN-GET-NEXT.                                                  \n           READ DALYTRAN-FILE INTO DALYTRAN-RECORD.                             \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n      *        DISPLAY DALYTRAN-RECORD                                          \n           ELSE                                                                 \n               IF  DALYTRAN-STATUS = '10'                                       \n                   MOVE 16 TO APPL-RESULT                                       \n               ELSE                                                             \n                   MOVE 12 TO APPL-RESULT                                       \n               END-IF                                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               IF  APPL-EOF                                                     \n                   MOVE 'Y' TO END-OF-FILE                                      \n               ELSE                                                             \n                   DISPLAY 'ERROR READING DALYTRAN FILE'                        \n                   MOVE DALYTRAN-STATUS TO IO-STATUS                            \n                   PERFORM 9910-DISPLAY-IO-STATUS                               \n                   PERFORM 9999-ABEND-PROGRAM                                   \n               END-IF                                                           \n           END-IF                                                               \n           EXIT.                                                                \n       1500-VALIDATE-TRAN.                                                      \n           PERFORM 1500-A-LOOKUP-XREF.                                          \n           IF WS-VALIDATION-FAIL-REASON = 0                                     \n              PERFORM 1500-B-LOOKUP-ACCT                                        \n           ELSE                                                                 \n              CONTINUE                                                          \n           END-IF                                                               \n      * ADD MORE VALIDATIONS HERE                                               \n           EXIT.                                                                \n                                                                                \n       1500-A-LOOKUP-XREF.                                                      \n      *    DISPLAY 'CARD NUMBER: ' DALYTRAN-CARD-NUM                            \n           MOVE DALYTRAN-CARD-NUM TO FD-XREF-CARD-NUM                           \n           READ XREF-FILE INTO CARD-XREF-RECORD                                 \n              INVALID KEY                                                       \n                MOVE 100 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'INVALID CARD NUMBER FOUND'                                \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n              NOT INVALID KEY                                                   \n      *           DISPLAY 'ACCOUNT RECORD FOUND'                                \n                  CONTINUE                                                      \n           END-READ                                                             \n           EXIT.                                                                \n       1500-B-LOOKUP-ACCT.                                                      \n           MOVE XREF-ACCT-ID TO FD-ACCT-ID                                      \n           READ ACCOUNT-FILE INTO ACCOUNT-RECORD                                \n              INVALID KEY                                                       \n                MOVE 101 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'ACCOUNT RECORD NOT FOUND'                                 \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n              NOT INVALID KEY                                                   \n      *         DISPLAY 'ACCT-CREDIT-LIMIT:' ACCT-CREDIT-LIMIT                  \n      *         DISPLAY 'TRAN-AMT         :' DALYTRAN-AMT                       \n                COMPUTE WS-TEMP-BAL = ACCT-CURR-CYC-CREDIT                      \n                                    - ACCT-CURR-CYC-DEBIT                       \n                                    + DALYTRAN-AMT                              \n                                                                                \n                IF ACCT-CREDIT-LIMIT >= WS-TEMP-BAL                             \n                  CONTINUE                                                      \n                ELSE                                                            \n                  MOVE 102 TO WS-VALIDATION-FAIL-REASON                         \n                  MOVE 'OVERLIMIT TRANSACTION'                                  \n                    TO WS-VALIDATION-FAIL-REASON-DESC                           \n                END-IF                                                          \n                IF ACCT-EXPIRAION-DATE >= DALYTRAN-ORIG-TS (1:10)               \n                  CONTINUE                                                      \n                ELSE                                                            \n                  MOVE 103 TO WS-VALIDATION-FAIL-REASON                         \n                  MOVE 'TRANSACTION RECEIVED AFTER ACCT EXPIRATION'             \n                    TO WS-VALIDATION-FAIL-REASON-DESC                           \n                END-IF                                                          \n           END-READ                                                             \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2000-POST-TRANSACTION.                                                   \n           MOVE  DALYTRAN-ID            TO    TRAN-ID                           \n           MOVE  DALYTRAN-TYPE-CD       TO    TRAN-TYPE-CD                      \n           MOVE  DALYTRAN-CAT-CD        TO    TRAN-CAT-CD                       \n           MOVE  DALYTRAN-SOURCE        TO    TRAN-SOURCE                       \n           MOVE  DALYTRAN-DESC          TO    TRAN-DESC                         \n           MOVE  DALYTRAN-AMT           TO    TRAN-AMT                          \n           MOVE  DALYTRAN-MERCHANT-ID   TO    TRAN-MERCHANT-ID                  \n           MOVE  DALYTRAN-MERCHANT-NAME TO    TRAN-MERCHANT-NAME                \n           MOVE  DALYTRAN-MERCHANT-CITY TO    TRAN-MERCHANT-CITY                \n           MOVE  DALYTRAN-MERCHANT-ZIP  TO    TRAN-MERCHANT-ZIP                 \n           MOVE  DALYTRAN-CARD-NUM      TO    TRAN-CARD-NUM                     \n           MOVE  DALYTRAN-ORIG-TS       TO    TRAN-ORIG-TS                      \n           PERFORM Z-GET-DB2-FORMAT-TIMESTAMP                                   \n           MOVE  DB2-FORMAT-TS          TO    TRAN-PROC-TS                      \n                                                                                \n           PERFORM 2700-UPDATE-TCATBAL                                          \n           PERFORM 2800-UPDATE-ACCOUNT-REC                                      \n           PERFORM 2900-WRITE-TRANSACTION-FILE                                  \n                                                                                \n           EXIT.                                                                \n                                                                                \n       2500-WRITE-REJECT-REC.                                                   \n           MOVE DALYTRAN-RECORD TO REJECT-TRAN-DATA                             \n           MOVE WS-VALIDATION-TRAILER TO VALIDATION-TRAILER                     \n      *     DISPLAY '***' REJECT-RECORD                                         \n           MOVE 8 TO APPL-RESULT                                                \n           WRITE FD-REJS-RECORD FROM REJECT-RECORD                              \n           IF DALYREJS-STATUS = '00'                                            \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TO REJECTS FILE'                          \n               MOVE DALYREJS-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2700-UPDATE-TCATBAL.                                                     \n      * Update the balances in transaction balance file.                        \n           MOVE XREF-ACCT-ID TO FD-TRANCAT-ACCT-ID                              \n           MOVE DALYTRAN-TYPE-CD TO FD-TRANCAT-TYPE-CD                          \n           MOVE DALYTRAN-CAT-CD TO FD-TRANCAT-CD                                \n                                                                                \n           MOVE 'N' TO WS-CREATE-TRANCAT-REC                                    \n           READ TCATBAL-FILE INTO TRAN-CAT-BAL-RECORD                           \n              INVALID KEY                                                       \n                DISPLAY 'TCATBAL record not found for key : '                   \n                   FD-TRAN-CAT-KEY '.. Creating.'                               \n                MOVE 'Y' TO WS-CREATE-TRANCAT-REC                               \n           END-READ.                                                            \n                                                                                \n           IF  TCATBALF-STATUS = '00'  OR '23'                                  \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR READING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n                                                                                \n           IF WS-CREATE-TRANCAT-REC = 'Y'                                       \n              PERFORM 2700-A-CREATE-TCATBAL-REC                                 \n           ELSE                                                                 \n              PERFORM 2700-B-UPDATE-TCATBAL-REC                                 \n           END-IF                                                               \n                                                                                \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2700-A-CREATE-TCATBAL-REC.                                               \n           INITIALIZE TRAN-CAT-BAL-RECORD                                       \n           MOVE XREF-ACCT-ID TO TRANCAT-ACCT-ID                                 \n           MOVE DALYTRAN-TYPE-CD TO TRANCAT-TYPE-CD                             \n           MOVE DALYTRAN-CAT-CD TO TRANCAT-CD                                   \n           ADD DALYTRAN-AMT TO TRAN-CAT-BAL                                     \n                                                                                \n           WRITE FD-TRAN-CAT-BAL-RECORD FROM TRAN-CAT-BAL-RECORD                \n                                                                                \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n      *---------------------------------------------------------------*         \n       2700-B-UPDATE-TCATBAL-REC.                                               \n           ADD DALYTRAN-AMT TO TRAN-CAT-BAL                                     \n           REWRITE FD-TRAN-CAT-BAL-RECORD FROM TRAN-CAT-BAL-RECORD              \n                                                                                \n           IF  TCATBALF-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR REWRITING TRANSACTION BALANCE FILE'               \n               MOVE TCATBALF-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF.                                                              \n                                                                                \n      *---------------------------------------------------------------*         \n       2800-UPDATE-ACCOUNT-REC.                                                 \n      * Update the balances in account record to reflect posted trans.          \n           ADD DALYTRAN-AMT  TO ACCT-CURR-BAL                                   \n           IF DALYTRAN-AMT >= 0                                                 \n              ADD DALYTRAN-AMT TO ACCT-CURR-CYC-CREDIT                          \n           ELSE                                                                 \n              ADD DALYTRAN-AMT TO ACCT-CURR-CYC-DEBIT                           \n           END-IF                                                               \n                                                                                \n           REWRITE FD-ACCTFILE-REC FROM  ACCOUNT-RECORD                         \n              INVALID KEY                                                       \n                MOVE 109 TO WS-VALIDATION-FAIL-REASON                           \n                MOVE 'ACCOUNT RECORD NOT FOUND'                                 \n                  TO WS-VALIDATION-FAIL-REASON-DESC                             \n           END-REWRITE.                                                         \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       2900-WRITE-TRANSACTION-FILE.                                             \n           MOVE 8 TO  APPL-RESULT.                                              \n           WRITE FD-TRANFILE-REC FROM TRAN-RECORD                               \n                                                                                \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR WRITING TO TRANSACTION FILE'                      \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9000-DALYTRAN-CLOSE.                                                     \n           MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE DALYTRAN-FILE                                                  \n           IF  DALYTRAN-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DALYTRAN FILE'                            \n               MOVE DALYTRAN-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9100-TRANFILE-CLOSE.                                                     \n           MOVE 8 TO  APPL-RESULT.                                              \n           CLOSE TRANSACT-FILE                                                  \n           IF  TRANFILE-STATUS = '00'                                           \n               MOVE 0 TO  APPL-RESULT                                           \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION FILE'                         \n               MOVE TRANFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9200-XREFFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE XREF-FILE                                                      \n           IF  XREFFILE-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING CROSS REF FILE'                           \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9300-DALYREJS-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE DALYREJS-FILE                                                  \n           IF  DALYREJS-STATUS = '00'                                           \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING DAILY REJECTS FILE'                       \n               MOVE XREFFILE-STATUS TO IO-STATUS                                \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n      *---------------------------------------------------------------*         \n       9400-ACCTFILE-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE ACCOUNT-FILE                                                   \n           IF  ACCTFILE-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING ACCOUNT FILE'                             \n               MOVE ACCTFILE-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *---------------------------------------------------------------*         \n       9500-TCATBALF-CLOSE.                                                     \n           MOVE 8 TO APPL-RESULT.                                               \n           CLOSE TCATBAL-FILE                                                   \n           IF  TCATBALF-STATUS  = '00'                                          \n               MOVE 0 TO APPL-RESULT                                            \n           ELSE                                                                 \n               MOVE 12 TO APPL-RESULT                                           \n           END-IF                                                               \n           IF  APPL-AOK                                                         \n               CONTINUE                                                         \n           ELSE                                                                 \n               DISPLAY 'ERROR CLOSING TRANSACTION BALANCE FILE'                 \n               MOVE TCATBALF-STATUS  TO IO-STATUS                               \n               PERFORM 9910-DISPLAY-IO-STATUS                                   \n               PERFORM 9999-ABEND-PROGRAM                                       \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n       Z-GET-DB2-FORMAT-TIMESTAMP.                                              \n           MOVE FUNCTION CURRENT-DATE TO COBOL-TS                               \n           MOVE COB-YYYY TO DB2-YYYY                                            \n           MOVE COB-MM   TO DB2-MM                                              \n           MOVE COB-DD   TO DB2-DD                                              \n           MOVE COB-HH   TO DB2-HH                                              \n           MOVE COB-MIN  TO DB2-MIN                                             \n           MOVE COB-SS   TO DB2-SS                                              \n           MOVE COB-MIL  TO DB2-MIL                                             \n           MOVE '0000'   TO DB2-REST                                            \n           MOVE '-' TO DB2-STREEP-1 DB2-STREEP-2 DB2-STREEP-3                   \n           MOVE '.' TO DB2-DOT-1 DB2-DOT-2 DB2-DOT-3                            \n      *    DISPLAY 'DB2-TIMESTAMP = ' DB2-FORMAT-TS                             \n           EXIT.                                                                \n                                                                                \n       9999-ABEND-PROGRAM.                                                      \n           DISPLAY 'ABENDING PROGRAM'                                           \n           MOVE 0 TO TIMING                                                     \n           MOVE 999 TO ABCODE                                                   \n           CALL 'CEE3ABD'.                                                      \n                                                                                \n      *****************************************************************         \n       9910-DISPLAY-IO-STATUS.                                                  \n           IF  IO-STATUS NOT NUMERIC                                            \n           OR  IO-STAT1 = '9'                                                   \n               MOVE IO-STAT1 TO IO-STATUS-04(1:1)                               \n               MOVE 0        TO TWO-BYTES-BINARY                                \n               MOVE IO-STAT2 TO TWO-BYTES-RIGHT                                 \n               MOVE TWO-BYTES-BINARY TO IO-STATUS-0403                          \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           ELSE                                                                 \n               MOVE '0000' TO IO-STATUS-04                                      \n               MOVE IO-STATUS TO IO-STATUS-04(3:2)                              \n               DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04                      \n           END-IF                                                               \n           EXIT.                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "CVTRA06Y",
        "CVTRA01Y",
        "CVTRA05Y",
        "CVACT01Y",
        "CVACT03Y"
      ],
      "diagram": "sequenceDiagram\n    participant Main as Main Program\n    participant InputFiles as Input Files\n    participant OutputFiles as Output Files\n    participant Validation as Validation Logic\n    participant Processing as Transaction Processing\n    \n    Main->>InputFiles: 0000-DALYTRAN-OPEN\n    Main->>OutputFiles: 0100-TRANFILE-OPEN\n    Main->>InputFiles: 0200-XREFFILE-OPEN\n    Main->>OutputFiles: 0300-DALYREJS-OPEN\n    Main->>InputFiles: 0400-ACCTFILE-OPEN\n    Main->>InputFiles: 0500-TCATBALF-OPEN\n    \n    loop Until End-Of-File\n        Main->>InputFiles: 1000-DALYTRAN-GET-NEXT\n        alt Not End-Of-File\n            Main->>Validation: 1500-VALIDATE-TRAN\n            Validation->>InputFiles: 1500-A-LOOKUP-XREF (Card validation)\n            alt Valid Card\n                Validation->>InputFiles: 1500-B-LOOKUP-ACCT (Account validation)\n                alt Valid Transaction\n                    Main->>Processing: 2000-POST-TRANSACTION\n                    Processing->>InputFiles: 2700-UPDATE-TCATBAL\n                    Processing->>InputFiles: 2700-A-CREATE-TCATBAL-REC/2700-B-UPDATE-TCATBAL-REC\n                    Processing->>InputFiles: 2800-UPDATE-ACCOUNT-REC\n                    Processing->>OutputFiles: 2900-WRITE-TRANSACTION-FILE\n                else Invalid Transaction\n                    Main->>OutputFiles: 2500-WRITE-REJECT-REC\n                end\n            else Invalid Card\n                Main->>OutputFiles: 2500-WRITE-REJECT-REC\n            end\n        end\n    end\n    \n    Main->>InputFiles: 9000-DALYTRAN-CLOSE\n    Main->>OutputFiles: 9100-TRANFILE-CLOSE\n    Main->>InputFiles: 9200-XREFFILE-CLOSE\n    Main->>OutputFiles: 9300-DALYREJS-CLOSE\n    Main->>InputFiles: 9400-ACCTFILE-CLOSE\n    Main->>InputFiles: 9500-TCATBALF-CLOSE"
    },
    {
      "id": "COCRDSLC",
      "author": "",
      "environment_division": {
        "sections": [
          {
            "name": "INPUT-OUTPUT SECTION",
            "code": "",
            "description": "This section would typically contain file-related configuration details for the COCRDSLC program, including file assignments, record descriptions, and access methods for the card data files used in the credit card detail request processing. However, the provided snippet is empty, suggesting that the program may handle all its data access through CICS commands rather than direct file access statements, or that the INPUT-OUTPUT SECTION might be defined elsewhere in the program structure."
          }
        ]
      },
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05  WS-RETURN-FLAG                        PIC X(1).                    \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  CARD-CARD-NUM-X                     PIC X(16).                   \n           10  CARD-CARD-NUM-N REDEFINES  CARD-CARD-NUM-X                       \n                                                   PIC 9(16).                   \n           10  CARD-NAME-EMBOSSED-X                PIC X(50).                   \n           10  CARD-STATUS-X                       PIC X.                       \n           10  CARD-EXPIRAION-DATE-X               PIC X(10).                   \n           10  FILLER REDEFINES CARD-EXPIRAION-DATE-X.                          \n               20 CARD-EXPIRY-YEAR                 PIC X(4).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-MONTH                PIC X(2).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-DAY                  PIC X(2).                    \n           10  CARD-EXPIRAION-DATE-N REDEFINES                                  \n               CARD-EXPIRAION-DATE-X               PIC 9(10).                   \n                                                                                \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-CARD-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  FOUND-CARDS-FOR-ACCOUNT             VALUE                        \n               '   Displaying requested details'.                               \n           88  WS-PROMPT-FOR-INPUT                 VALUE                        \n               'Please enter Account and Card Number'.                          \n                                                                                \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  WS-PROMPT-FOR-CARD                  VALUE                        \n               'Card number not provided'.                                      \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-CARD-NOT-NUMERIC           VALUE                        \n               'Card number if supplied must be a 16 digit number'.             \n                                                                                \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in cards database'.                   \n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE                        \n               'Did not find cards for this search condition'.                  \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading Card Data File'.                                  \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      ******************************************************************        \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COCRDSL '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CA-CALL-CONTEXT.                                                   \n             10 CA-FROM-PROGRAM                    PIC X(08).                   \n             10 CA-FROM-TRANID                     PIC X(04).                   \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n       COPY COCRDSL.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n      *ACCOUNT RECORD LAYOUT                                                    \n      *COPY CVACT01Y.                                                           \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n      *COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.",
            "description": "This Working Storage Section defines the data structures used in the COCRDSLC program for handling credit card detail requests. It contains several key components:\n\n1. CICS processing variables for handling responses and transaction IDs\n2. Input validation flags for tracking the status of account and card number validations\n3. Output edit variables for formatting and processing card details including account ID, card number, CVV code, embossed name, status, and expiration date\n4. File handling structures including record identifiers and error message formatting\n5. Message construction fields for user feedback, including informational messages and error conditions\n6. Program constants and literals defining program names, transaction IDs, mapsets, and file names\n7. References to several copybooks that provide additional data structures:\n   - CVCRD01Y for card-related data\n   - COCOM01Y for application communication area\n   - Standard IBM copybooks for CICS functionality\n   - Screen layout definitions (COCRDSL)\n   - Date handling (CSDAT01Y)\n   - Message formatting (CSMSG01Y, CSMSG02Y)\n   - User data (CSUSR01Y)\n   - Record layouts for cards (CVACT02Y) and customers (CVCUS01Y)\n\nThe section includes comprehensive status flags and condition names to track validation states and error conditions throughout the card detail retrieval process."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.",
            "description": "This section defines the DFHCOMMAREA in the Linkage Section, which is the standard CICS communication area used to pass data between programs. It contains a single field defined as a variable-length array of characters that can expand from 1 to 32,767 bytes depending on the actual length passed (EIBCALEN). This flexible structure allows the program to receive communication data of varying sizes from calling programs within the CardDemo application."
          }
        ],
        "copybooks": [],
        "code": "WORKING-STORAGE SECTION.                                                 \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05  WS-RETURN-FLAG                        PIC X(1).                    \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  CARD-CARD-NUM-X                     PIC X(16).                   \n           10  CARD-CARD-NUM-N REDEFINES  CARD-CARD-NUM-X                       \n                                                   PIC 9(16).                   \n           10  CARD-NAME-EMBOSSED-X                PIC X(50).                   \n           10  CARD-STATUS-X                       PIC X.                       \n           10  CARD-EXPIRAION-DATE-X               PIC X(10).                   \n           10  FILLER REDEFINES CARD-EXPIRAION-DATE-X.                          \n               20 CARD-EXPIRY-YEAR                 PIC X(4).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-MONTH                PIC X(2).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-DAY                  PIC X(2).                    \n           10  CARD-EXPIRAION-DATE-N REDEFINES                                  \n               CARD-EXPIRAION-DATE-X               PIC 9(10).                   \n                                                                                \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-CARD-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  FOUND-CARDS-FOR-ACCOUNT             VALUE                        \n               '   Displaying requested details'.                               \n           88  WS-PROMPT-FOR-INPUT                 VALUE                        \n               'Please enter Account and Card Number'.                          \n                                                                                \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  WS-PROMPT-FOR-CARD                  VALUE                        \n               'Card number not provided'.                                      \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-CARD-NOT-NUMERIC           VALUE                        \n               'Card number if supplied must be a 16 digit number'.             \n                                                                                \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in cards database'.                   \n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE                        \n               'Did not find cards for this search condition'.                  \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading Card Data File'.                                  \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      ******************************************************************        \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COCRDSL '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CA-CALL-CONTEXT.                                                   \n             10 CA-FROM-PROGRAM                    PIC X(08).                   \n             10 CA-FROM-TRANID                     PIC X(04).                   \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n       COPY COCRDSL.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n      *ACCOUNT RECORD LAYOUT                                                    \n      *COPY CVACT01Y.                                                           \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n      *COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN."
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "0000-MAIN",
            "code": "EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)                               \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03                                                   \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n              WHEN CCARD-AID-PFK03                                              \n      ******************************************************************        \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                                                                                \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                             PROGRAM (CDEMO-TO-PROGRAM)                         \n                             COMMAREA(CARDDEMO-COMMAREA)                        \n                   END-EXEC                                                     \n      ******************************************************************        \n      *            COMING FROM CREDIT CARD LIST SCREEN                          \n      *            SELECTION CRITERIA ALREADY VALIDATED                         \n      ******************************************************************        \n              WHEN CDEMO-PGM-ENTER                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n                   SET INPUT-OK TO TRUE                                         \n                   MOVE CDEMO-ACCT-ID       TO CC-ACCT-ID-N                     \n                   MOVE CDEMO-CARD-NUM      TO CC-CARD-NUM-N                    \n                   PERFORM 9000-READ-DATA                                       \n                      THRU 9000-READ-DATA-EXIT                                  \n                   PERFORM 1000-SEND-MAP                                        \n                     THRU 1000-SEND-MAP-EXIT                                    \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-ENTER                                              \n      ******************************************************************        \n      *            COMING FROM SOME OTHER CONTEXT                               \n      *            SELECTION CRITERIA TO BE GATHERED                            \n      ******************************************************************        \n                   PERFORM 1000-SEND-MAP THRU                                   \n                           1000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-REENTER                                            \n                   PERFORM 2000-PROCESS-INPUTS                                  \n                      THRU 2000-PROCESS-INPUTS-EXIT                             \n                   IF INPUT-ERROR                                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   ELSE                                                         \n                      PERFORM 9000-READ-DATA                                    \n                         THRU 9000-READ-DATA-EXIT                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                                                                                \n                   END-IF                                                       \n                                                                                \n              WHEN OTHER                                                        \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO WS-RETURN-MSG                         \n                   PERFORM SEND-PLAIN-TEXT                                      \n                      THRU SEND-PLAIN-TEXT-EXIT                                 \n           END-EVALUATE                                                         \n                                                                                \n                                                                                \n      * If we had an error setup error message that slipped through             \n      * Display and return                                                      \n           IF INPUT-ERROR                                                       \n              MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                            \n              PERFORM 1000-SEND-MAP                                             \n                 THRU 1000-SEND-MAP-EXIT                                        \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n           .",
            "description": "This paragraph serves as the main control flow for the COCRDSLC program, handling program initialization, navigation, and processing logic. It begins by setting up error handling through CICS HANDLE ABEND and initializing work areas. The code then preserves program context, processes any passed communication area data, and validates function key inputs (accepting only ENTER and PF3).\n\nThe core of the paragraph is an EVALUATE statement that directs program flow based on user actions:\n- When PF3 is pressed, it transfers control back to the calling program or main menu\n- When entering from the credit card list screen (COCRDLIC), it processes the already validated account and card numbers\n- When entering from other contexts, it displays the initial input screen\n- When re-entering after input, it validates the data, reads card details if valid, and redisplays the screen\n\nThe paragraph implements navigation logic between screens in the CardDemo application, maintaining context through the communication area. It also includes error handling to ensure appropriate messages are displayed when validation fails or unexpected conditions occur."
          },
          {
            "name": "COMMON-RETURN",
            "code": "MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the common return logic for the program, preparing the communication area before returning control to CICS. It first moves any return message to the error message field in the card data structure. Then it constructs a composite communication area by copying the standard CardDemo communication area to the working storage area, followed by appending this program's specific communication area data. Finally, it executes a CICS RETURN command that specifies the same transaction ID for continuation, passes the constructed communication area, and specifies its length. This ensures that both application-wide and program-specific context is preserved when control returns to the user or when the transaction is restarted."
          },
          {
            "name": "0000-MAIN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as the exit point for the program, marking the end of a logical processing block. It's a standard COBOL construct used to terminate the current paragraph's execution and return control to the calling routine."
          },
          {
            "name": "1000-SEND-MAP",
            "code": "PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SETUP-SCREEN-VARS                                       \n              THRU 1200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SEND-SCREEN                                             \n              THRU 1400-SEND-SCREEN-EXIT                                        \n           .",
            "description": "This paragraph orchestrates the process of preparing and sending the credit card detail screen to the user. It follows a structured sequence by first initializing the screen (1100-SCREEN-INIT), then setting up the screen variables with appropriate data values (1200-SETUP-SCREEN-VARS), configuring the screen attributes for proper display formatting (1300-SETUP-SCREEN-ATTRS), and finally sending the completed screen to the terminal (1400-SEND-SCREEN). This modular approach separates the different aspects of screen preparation and display into distinct, reusable components."
          },
          {
            "name": "1000-SEND-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the SEND-MAP routine in the COCRDSLC program. It marks the end of the map sending process and provides a clean return point for control flow when the program has completed displaying the credit card details screen to the user."
          },
          {
            "name": "1100-SCREEN-INIT",
            "code": "MOVE LOW-VALUES TO CCRDSLAO                                          \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDSLAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDSLAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDSLAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDSLAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDSLAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDSLAO                  \n                                                                                \n           .",
            "description": "This paragraph initializes the screen display for the credit card detail screen. It clears the output area by setting it to LOW-VALUES, then retrieves the current date and time. The paragraph populates the screen header with application titles from the communication area, sets the transaction ID and program name, and formats the current date (MM/DD/YY) and time (HH:MM:SS) for display in the screen header. This establishes the standard header information that appears at the top of the screen before any card-specific data is displayed."
          },
          {
            "name": "1100-SCREEN-INIT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the screen initialization routine in the COCRDSLC program. It marks the end of the screen initialization process and allows the program flow to return to the calling section."
          },
          {
            "name": "1200-SETUP-SCREEN-VARS",
            "code": "*    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n              SET  WS-PROMPT-FOR-INPUT TO TRUE                                  \n           ELSE                                                                 \n              IF CDEMO-ACCT-ID = 0                                              \n                 MOVE LOW-VALUES   TO ACCTSIDO OF CCRDSLAO                      \n              ELSE                                                              \n                 MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDSLAO                      \n              END-IF                                                            \n                                                                                \n              IF CDEMO-CARD-NUM = 0                                             \n                MOVE LOW-VALUES   TO CARDSIDO OF CCRDSLAO                       \n              ELSE                                                              \n                MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDSLAO                       \n              END-IF                                                            \n                                                                                \n              IF FOUND-CARDS-FOR-ACCOUNT                                        \n                 MOVE CARD-EMBOSSED-NAME                                        \n                                        TO CRDNAMEO OF CCRDSLAO                 \n                 MOVE CARD-EXPIRAION-DATE                                       \n                                        TO CARD-EXPIRAION-DATE-X                \n                                                                                \n                 MOVE CARD-EXPIRY-MONTH TO EXPMONO  OF CCRDSLAO                 \n                                                                                \n                 MOVE CARD-EXPIRY-YEAR  TO EXPYEARO OF CCRDSLAO                 \n                                                                                \n                 MOVE CARD-ACTIVE-STATUS TO CRDSTCDO OF CCRDSLAO                \n              END-IF                                                            \n            END-IF                                                              \n                                                                                \n                                                                                \n      *    SETUP MESSAGE                                                        \n           IF WS-NO-INFO-MESSAGE                                                \n             SET WS-PROMPT-FOR-INPUT TO TRUE                                    \n           END-IF                                                               \n                                                                                \n           MOVE WS-RETURN-MSG          TO ERRMSGO OF CCRDSLAO                   \n                                                                                \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDSLAO                  \n           .",
            "description": "This paragraph initializes and populates the screen variables for the credit card detail display. It first checks if the program was called with parameters (EIBCALEN). If not, it sets a prompt for user input. Otherwise, it processes the incoming account and card information, transferring values from the communication area to the screen fields. When account or card numbers are zero, it sets the corresponding screen fields to LOW-VALUES. If card data was successfully found (FOUND-CARDS-FOR-ACCOUNT), it populates the display fields with card details including the embossed name, expiration date (split into month and year components), and card status. The paragraph concludes by setting appropriate informational or error messages on the screen based on the processing status."
          },
          {
            "name": "1200-SETUP-SCREEN-VARS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 1200-SETUP-SCREEN-VARS routine. It marks the end of the screen variable setup process in the COCRDSLC program, allowing the program flow to return to the calling section after screen variables have been properly initialized or configured."
          },
          {
            "name": "1300-SETUP-SCREEN-ATTRS",
            "code": "*    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           IF  CDEMO-LAST-MAPSET  EQUAL LIT-CCLISTMAPSET \n           AND CDEMO-FROM-PROGRAM EQUAL LIT-CCLISTPGM                           \n              MOVE DFHBMPRF     TO ACCTSIDA OF CCRDSLAI                         \n              MOVE DFHBMPRF     TO CARDSIDA OF CCRDSLAI                         \n           ELSE                                                                 \n              MOVE DFHBMFSE      TO ACCTSIDA OF CCRDSLAI                        \n              MOVE DFHBMFSE      TO CARDSIDA OF CCRDSLAI                        \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CCRDSLAI                  \n              WHEN FLG-CARDFILTER-NOT-OK                                        \n              WHEN FLG-CARDFILTER-BLANK                                         \n                   MOVE -1             TO CARDSIDL OF CCRDSLAI                  \n              WHEN OTHER                                                        \n                   MOVE -1             TO ACCTSIDL OF CCRDSLAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           IF  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                          \n              MOVE DFHDFCOL     TO ACCTSIDC OF CCRDSLAO                         \n              MOVE DFHDFCOL     TO CARDSIDC OF CCRDSLAO                         \n           END-IF                                                               \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE DFHRED              TO CARDSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CCRDSLAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO CARDSIDO OF CCRDSLAO                  \n               MOVE DFHRED             TO CARDSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGC OF CCRDSLAO                  \n           ELSE                                                                 \n               MOVE DFHNEUTR           TO INFOMSGC OF CCRDSLAO                  \n           END-IF                                                               \n           .",
            "description": "This paragraph configures the screen attributes for the credit card detail screen based on context and validation results. It determines whether input fields should be protected or unprotected depending on navigation flow - protecting fields when coming from the card list screen and making them editable otherwise. The paragraph handles cursor positioning logic, placing the cursor on the first field with an error or defaulting to the account ID field. It also manages color attributes for fields, highlighting validation errors in red, marking required fields with an asterisk when blank on reentry, and setting appropriate colors for information messages. This creates a user-friendly interface that guides users through error correction and data entry."
          },
          {
            "name": "1300-SETUP-SCREEN-ATTRS-EXIT",
            "code": "EXIT.",
            "description": "This paragraph serves as an exit point for the screen attribute setup routine in the COCRDSLC program. It marks the end of the 1300-SETUP-SCREEN-ATTRS section, allowing the program to return control to the calling section after screen attributes have been configured for the credit card detail display."
          },
          {
            "name": "1400-SEND-SCREEN",
            "code": "MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n           SET  CDEMO-PGM-REENTER TO TRUE                                       \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CCRDSLAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .",
            "description": "This paragraph handles the screen display functionality for the credit card detail screen. It sets up the next map and mapset values in the common communication area, indicating the program should be re-entered after the screen is displayed. The paragraph then uses a CICS SEND MAP command to display the screen to the user, positioning the cursor appropriately, clearing the previous screen content (ERASE), and freeing the keyboard for user input. The response code from this operation is captured in WS-RESP-CD for potential error handling."
          },
          {
            "name": "1400-SEND-SCREEN-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the SEND-SCREEN routine in the COCRDSLC program. It provides a clean termination point for the screen display logic, allowing the program to return control to the calling routine after the credit card detail screen has been formatted and sent to the user terminal."
          },
          {
            "name": "2000-PROCESS-INPUTS",
            "code": "PERFORM 2100-RECEIVE-MAP                                             \n              THRU 2100-RECEIVE-MAP-EXIT                                        \n           PERFORM 2200-EDIT-MAP-INPUTS                                         \n              THRU 2200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .",
            "description": "This paragraph handles the initial processing of user inputs from the screen. It first receives the map data from the user interface, then validates the input fields through the edit map inputs routine. After validation, it sets up the communication area with any error messages generated during validation and prepares for the next screen interaction by setting the program, mapset, and map names to the current program's values, ensuring the application will return to this same screen after processing."
          },
          {
            "name": "2000-PROCESS-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2000-PROCESS-INPUTS section, marking the end of input processing logic. It provides a clean termination point for the section that handles validation and processing of account and card number inputs in the credit card detail request flow."
          },
          {
            "name": "2100-RECEIVE-MAP",
            "code": "EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CCRDSLAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n           .",
            "description": "This paragraph receives user input from the screen map named in LIT-THISMAP within the mapset LIT-THISMAPSET. The data is stored in the CCRDSLAI structure, which likely contains the fields displayed on the credit card detail screen. The paragraph captures both response and reason codes in WS-RESP-CD and WS-REAS-CD respectively, which will be used elsewhere in the program to determine if the receive operation was successful or to handle any errors that occurred during the operation."
          },
          {
            "name": "2100-RECEIVE-MAP-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the RECEIVE-MAP routine in the COCRDSLC program. It marks the end of the map receiving process where user input from the credit card detail screen is captured. The paragraph contains only the EXIT statement, which transfers control back to the calling routine after the map receiving operations are complete."
          },
          {
            "name": "2200-EDIT-MAP-INPUTS",
            "code": "SET INPUT-OK                  TO TRUE                                \n           SET FLG-CARDFILTER-ISVALID    TO TRUE                                \n           SET FLG-ACCTFILTER-ISVALID    TO TRUE                                \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CCRDSLAI = '*'                                       \n           OR  ACCTSIDI OF CCRDSLAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CCRDSLAI TO  CC-ACCT-ID                         \n           END-IF                                                               \n                                                                                \n           IF  CARDSIDI OF CCRDSLAI = '*'                                       \n           OR  CARDSIDI OF CCRDSLAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-CARD-NUM                        \n           ELSE                                                                 \n               MOVE CARDSIDI OF CCRDSLAI TO  CC-CARD-NUM                        \n           END-IF                                                               \n                                                                                \n      *    INDIVIDUAL FIELD EDITS                                               \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n      *    CROSS FIELD EDITS                                                    \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND FLG-CARDFILTER-BLANK                                             \n               SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                          \n           END-IF                                                               \n           .",
            "description": "This paragraph processes and validates user input from the credit card detail screen. It first sets flags to indicate valid input status, then handles the account ID and card number fields by converting asterisks or spaces to low-values (which indicates no filter). The code then performs individual field validation by calling separate paragraphs for account and card number validation. Finally, it performs cross-field validation to determine if no search criteria were provided (both fields blank). This validation logic ensures proper input formatting before attempting to retrieve card details from the database."
          },
          {
            "name": "2200-EDIT-MAP-INPUTS-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the 2200-EDIT-MAP-INPUTS routine. It marks the end of the input validation logic for the credit card detail screen, allowing the program flow to return to the calling section after input field validation is complete."
          },
          {
            "name": "2210-EDIT-ACCOUNT",
            "code": "SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the account ID input field for the credit card detail screen. It performs several checks: first determining if the account ID is empty (blank, low-values, or zeros), in which case it sets an input error flag and prompts the user for an account number. Next, it verifies that the account ID is both numeric and 11 digits in length. If these validations fail, it sets appropriate error flags and generates an error message. When the account ID passes all validations, it moves the value to the CDEMO-ACCT-ID field and sets a flag indicating the account filter is valid. The paragraph uses control flags to manage error handling and conditional message display based on the application's current state."
          },
          {
            "name": "2210-EDIT-ACCOUNT-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the account number validation routine. It marks the end of the account number editing process, allowing the program to continue with the next processing step after account validation is complete."
          },
          {
            "name": "2220-EDIT-CARD",
            "code": "*    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-CARD TO TRUE                                 \n              END-IF                                                            \n                                                                                \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .",
            "description": "This paragraph validates the credit card number input in the card detail request screen. It performs several checks: first, it verifies if the card number was provided at all (checking for spaces, low-values, or zeros). If the card number is missing, it sets appropriate error flags, prompts the user to enter a card number (if message display is enabled), and exits the validation routine. If a card number was entered, it then checks if the value is numeric and 16 digits long. When the input fails this validation, it sets error flags and displays a message informing the user that the card ID must be a 16-digit number. If the card number passes all validations, it moves the numeric value to the CDEMO-CARD-NUM field and sets a flag indicating the card filter is valid. This validation is critical for ensuring proper record retrieval from the card data file."
          },
          {
            "name": "2220-EDIT-CARD-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the card editing process in the COCRDSLC program. It marks the end of the card validation and editing logic, providing a clean return point for the program flow after completing the validation checks on the credit card information."
          },
          {
            "name": "9000-READ-DATA",
            "code": "PERFORM 9100-GETCARD-BYACCTCARD                                      \n              THRU 9100-GETCARD-BYACCTCARD-EXIT                                 \n           .",
            "description": "This paragraph calls the 9100-GETCARD-BYACCTCARD routine to retrieve credit card details based on the account and card number inputs. It serves as a wrapper for the actual data retrieval logic, maintaining the program's structured approach to data access."
          },
          {
            "name": "9000-READ-DATA-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as an exit point for the data reading routine in the COCRDSLC program. It provides a clean termination point for the 9000-READ-DATA section, allowing control to return to the calling routine after data retrieval operations have been completed."
          },
          {
            "name": "9100-GETCARD-BYACCTCARD",
            "code": "*    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N      TO WS-CARD-RID-ACCT-ID                        \n           MOVE CC-CARD-NUM       TO WS-CARD-RID-CARDNUM                        \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                    TO TRUE                    \n                  SET FLG-ACCTFILTER-NOT-OK          TO TRUE                    \n                  SET FLG-CARDFILTER-NOT-OK          TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET DID-NOT-FIND-ACCTCARD-COMBO TO TRUE                   \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                    TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET FLG-ACCTFILTER-NOT-OK      TO TRUE                    \n                  END-IF                                                        \n                  MOVE 'READ'                        TO ERROR-OPNAME            \n                  MOVE LIT-CARDFILENAME                TO ERROR-FILE            \n                  MOVE WS-RESP-CD                    TO ERROR-RESP              \n                  MOVE WS-REAS-CD                    TO ERROR-RESP2             \n                  MOVE WS-FILE-ERROR-MESSAGE         TO WS-RETURN-MSG           \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph retrieves a credit card record from the card file using the card number as the key. It performs a CICS READ operation on the card file and evaluates the response code to determine the outcome. If the read is successful, it sets a flag indicating that cards were found for the account. If the record is not found, it sets error flags for both account and card filters and potentially sets a message indicating the account/card combination was not found. For other error conditions, it captures detailed error information including operation name, file name, and response codes to generate an appropriate error message. The paragraph handles all possible outcomes of the file read operation with appropriate error handling."
          },
          {
            "name": "9100-GETCARD-BYACCTCARD-EXIT",
            "code": "EXIT                                                                 \n           .",
            "description": "This paragraph serves as the exit point for the GETCARD-BYACCTCARD routine. It marks the end of the process that retrieves credit card details using account and card number identifiers. The paragraph contains only the EXIT statement, which returns control to the calling routine after the card retrieval operation has completed."
          },
          {
            "name": "9150-GETCARD-BYACCT",
            "code": "*    Read the Card file. Access via alternate index ACCTID                \n      *                                                                         \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME-ACCT-PATH)                          \n                RIDFLD    (WS-CARD-RID-ACCT-ID)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  SET DID-NOT-FIND-ACCT-IN-CARDXREF TO TRUE                     \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARDFILENAME-ACCT-PATH TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n           END-EVALUATE                                                         \n           .",
            "description": "This paragraph retrieves a credit card record from the card file using the account ID as the access key through an alternate index. It executes a CICS READ command against the card file's account path (LIT-CARDFILENAME-ACCT-PATH) using the account ID stored in WS-CARD-RID-ACCT-ID as the key. The paragraph then evaluates the response code from the read operation and sets appropriate flags based on the outcome. If the read is successful (NORMAL response), it sets the FOUND-CARDS-FOR-ACCOUNT flag. If the record is not found, it sets error flags indicating the account filter is invalid and the account was not found in the card cross-reference. For any other response, it sets error flags and populates error information fields with details about the failed operation, including the operation name, file name, response code, and reason code, and prepares an error message for display to the user."
          },
          {
            "name": "9150-GETCARD-BYACCT-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************",
            "description": "This paragraph serves as an exit point for the GETCARD-BYACCT routine. It includes a comment block explaining that there's functionality to display long text for debugging purposes, but notes that this debugging feature should not be used during normal program operation. The paragraph is minimally implemented with just an EXIT statement followed by a period."
          },
          {
            "name": "SEND-LONG-TEXT",
            "code": "EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends an extended message to the user's terminal screen using CICS SEND TEXT command. It displays the content stored in the WS-LONG-MSG field, clears the screen (ERASE), and unlocks the keyboard (FREEKB). After sending the message, it returns control to CICS, effectively ending the current transaction. This functionality is typically used for displaying detailed error messages or informational text that requires more space than standard screen fields."
          },
          {
            "name": "SEND-LONG-TEXT-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************",
            "description": "This paragraph serves as a placeholder exit point for the SEND-LONG-TEXT routine in the COCRDSLC program. It contains a warning comment indicating that this is a plain text implementation that should not be used in production environments. This suggests it may be a simplified or unencrypted version of text handling that lacks proper security measures required for production use."
          },
          {
            "name": "SEND-PLAIN-TEXT",
            "code": "EXEC CICS SEND TEXT                                                  \n                     FROM(WS-RETURN-MSG)                                        \n                     LENGTH(LENGTH OF WS-RETURN-MSG)                            \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .",
            "description": "This paragraph sends a plain text message to the user's terminal screen. It uses the CICS SEND TEXT command to display the contents of the WS-RETURN-MSG field, specifying the length of the message, clearing the screen (ERASE), and freeing the keyboard (FREEKB). After sending the message, it executes a CICS RETURN command to end the transaction and return control to CICS. This functionality is typically used for displaying error messages or informational text when normal screen formatting isn't required."
          },
          {
            "name": "SEND-PLAIN-TEXT-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n      ******************************************************************        \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .",
            "description": "This paragraph serves as an exit point for the SEND-PLAIN-TEXT routine in the COCRDSLC program. It incorporates a copybook named 'CSSTRPFY' which contains common code for storing PF key information. This is part of the program's navigation handling mechanism, ensuring that function key inputs from the user interface are properly captured and preserved for subsequent processing."
          },
          {
            "name": "ABEND-ROUTINE",
            "code": "IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *",
            "description": "This paragraph handles unexpected abend (abnormal end) conditions in the COCRDSLC program. If no specific abend message has been set (ABEND-MSG equals LOW-VALUES), it sets a default message indicating an unexpected abend occurred. It then identifies the current program as the source of the error by storing the program name in ABEND-CULPRIT. The routine sends the abend information to the user's terminal using CICS SEND, cancels any existing abend handling with CICS HANDLE ABEND CANCEL, and finally forces a controlled termination of the program with a specific abend code ('9999') using CICS ABEND. This provides a graceful error handling mechanism that displays useful diagnostic information before terminating the program when unexpected errors occur."
          }
        ],
        "code": "0000-MAIN.                                                               \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)                               \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03                                                   \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n              WHEN CCARD-AID-PFK03                                              \n      ******************************************************************        \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                                                                                \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                             PROGRAM (CDEMO-TO-PROGRAM)                         \n                             COMMAREA(CARDDEMO-COMMAREA)                        \n                   END-EXEC                                                     \n      ******************************************************************        \n      *            COMING FROM CREDIT CARD LIST SCREEN                          \n      *            SELECTION CRITERIA ALREADY VALIDATED                         \n      ******************************************************************        \n              WHEN CDEMO-PGM-ENTER                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n                   SET INPUT-OK TO TRUE                                         \n                   MOVE CDEMO-ACCT-ID       TO CC-ACCT-ID-N                     \n                   MOVE CDEMO-CARD-NUM      TO CC-CARD-NUM-N                    \n                   PERFORM 9000-READ-DATA                                       \n                      THRU 9000-READ-DATA-EXIT                                  \n                   PERFORM 1000-SEND-MAP                                        \n                     THRU 1000-SEND-MAP-EXIT                                    \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-ENTER                                              \n      ******************************************************************        \n      *            COMING FROM SOME OTHER CONTEXT                               \n      *            SELECTION CRITERIA TO BE GATHERED                            \n      ******************************************************************        \n                   PERFORM 1000-SEND-MAP THRU                                   \n                           1000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-REENTER                                            \n                   PERFORM 2000-PROCESS-INPUTS                                  \n                      THRU 2000-PROCESS-INPUTS-EXIT                             \n                   IF INPUT-ERROR                                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   ELSE                                                         \n                      PERFORM 9000-READ-DATA                                    \n                         THRU 9000-READ-DATA-EXIT                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                                                                                \n                   END-IF                                                       \n                                                                                \n              WHEN OTHER                                                        \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO WS-RETURN-MSG                         \n                   PERFORM SEND-PLAIN-TEXT                                      \n                      THRU SEND-PLAIN-TEXT-EXIT                                 \n           END-EVALUATE                                                         \n                                                                                \n                                                                                \n      * If we had an error setup error message that slipped through             \n      * Display and return                                                      \n           IF INPUT-ERROR                                                       \n              MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                            \n              PERFORM 1000-SEND-MAP                                             \n                 THRU 1000-SEND-MAP-EXIT                                        \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SETUP-SCREEN-VARS                                       \n              THRU 1200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SEND-SCREEN                                             \n              THRU 1400-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES TO CCRDSLAO                                          \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDSLAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDSLAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDSLAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDSLAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDSLAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDSLAO                  \n                                                                                \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1200-SETUP-SCREEN-VARS.                                                  \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n              SET  WS-PROMPT-FOR-INPUT TO TRUE                                  \n           ELSE                                                                 \n              IF CDEMO-ACCT-ID = 0                                              \n                 MOVE LOW-VALUES   TO ACCTSIDO OF CCRDSLAO                      \n              ELSE                                                              \n                 MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDSLAO                      \n              END-IF                                                            \n                                                                                \n              IF CDEMO-CARD-NUM = 0                                             \n                MOVE LOW-VALUES   TO CARDSIDO OF CCRDSLAO                       \n              ELSE                                                              \n                MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDSLAO                       \n              END-IF                                                            \n                                                                                \n              IF FOUND-CARDS-FOR-ACCOUNT                                        \n                 MOVE CARD-EMBOSSED-NAME                                        \n                                        TO CRDNAMEO OF CCRDSLAO                 \n                 MOVE CARD-EXPIRAION-DATE                                       \n                                        TO CARD-EXPIRAION-DATE-X                \n                                                                                \n                 MOVE CARD-EXPIRY-MONTH TO EXPMONO  OF CCRDSLAO                 \n                                                                                \n                 MOVE CARD-EXPIRY-YEAR  TO EXPYEARO OF CCRDSLAO                 \n                                                                                \n                 MOVE CARD-ACTIVE-STATUS TO CRDSTCDO OF CCRDSLAO                \n              END-IF                                                            \n            END-IF                                                              \n                                                                                \n                                                                                \n      *    SETUP MESSAGE                                                        \n           IF WS-NO-INFO-MESSAGE                                                \n             SET WS-PROMPT-FOR-INPUT TO TRUE                                    \n           END-IF                                                               \n                                                                                \n           MOVE WS-RETURN-MSG          TO ERRMSGO OF CCRDSLAO                   \n                                                                                \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDSLAO                  \n           .                                                                    \n                                                                                \n       1200-SETUP-SCREEN-VARS-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS.                                                 \n                                                                                \n      *    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           IF  CDEMO-LAST-MAPSET  EQUAL LIT-CCLISTMAPSET \n           AND CDEMO-FROM-PROGRAM EQUAL LIT-CCLISTPGM                           \n              MOVE DFHBMPRF     TO ACCTSIDA OF CCRDSLAI                         \n              MOVE DFHBMPRF     TO CARDSIDA OF CCRDSLAI                         \n           ELSE                                                                 \n              MOVE DFHBMFSE      TO ACCTSIDA OF CCRDSLAI                        \n              MOVE DFHBMFSE      TO CARDSIDA OF CCRDSLAI                        \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CCRDSLAI                  \n              WHEN FLG-CARDFILTER-NOT-OK                                        \n              WHEN FLG-CARDFILTER-BLANK                                         \n                   MOVE -1             TO CARDSIDL OF CCRDSLAI                  \n              WHEN OTHER                                                        \n                   MOVE -1             TO ACCTSIDL OF CCRDSLAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           IF  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                          \n              MOVE DFHDFCOL     TO ACCTSIDC OF CCRDSLAO                         \n              MOVE DFHDFCOL     TO CARDSIDC OF CCRDSLAO                         \n           END-IF                                                               \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE DFHRED              TO CARDSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CCRDSLAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO CARDSIDO OF CCRDSLAO                  \n               MOVE DFHRED             TO CARDSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGC OF CCRDSLAO                  \n           ELSE                                                                 \n               MOVE DFHNEUTR           TO INFOMSGC OF CCRDSLAO                  \n           END-IF                                                               \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n            EXIT.                                                               \n                                                                                \n                                                                                \n       1400-SEND-SCREEN.                                                        \n                                                                                \n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n           SET  CDEMO-PGM-REENTER TO TRUE                                       \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CCRDSLAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .                                                                    \n       1400-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS.                                                     \n           PERFORM 2100-RECEIVE-MAP                                             \n              THRU 2100-RECEIVE-MAP-EXIT                                        \n           PERFORM 2200-EDIT-MAP-INPUTS                                         \n              THRU 2200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-MAP.                                                        \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CCRDSLAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n       2100-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2200-EDIT-MAP-INPUTS.                                                    \n                                                                                \n           SET INPUT-OK                  TO TRUE                                \n           SET FLG-CARDFILTER-ISVALID    TO TRUE                                \n           SET FLG-ACCTFILTER-ISVALID    TO TRUE                                \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CCRDSLAI = '*'                                       \n           OR  ACCTSIDI OF CCRDSLAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CCRDSLAI TO  CC-ACCT-ID                         \n           END-IF                                                               \n                                                                                \n           IF  CARDSIDI OF CCRDSLAI = '*'                                       \n           OR  CARDSIDI OF CCRDSLAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-CARD-NUM                        \n           ELSE                                                                 \n               MOVE CARDSIDI OF CCRDSLAI TO  CC-CARD-NUM                        \n           END-IF                                                               \n                                                                                \n      *    INDIVIDUAL FIELD EDITS                                               \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n      *    CROSS FIELD EDITS                                                    \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND FLG-CARDFILTER-BLANK                                             \n               SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                          \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2200-EDIT-MAP-INPUTS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-CARD TO TRUE                                 \n              END-IF                                                            \n                                                                                \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-DATA.                                                          \n                                                                                \n           PERFORM 9100-GETCARD-BYACCTCARD                                      \n              THRU 9100-GETCARD-BYACCTCARD-EXIT                                 \n           .                                                                    \n                                                                                \n       9000-READ-DATA-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD.                                                 \n      *    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N      TO WS-CARD-RID-ACCT-ID                        \n           MOVE CC-CARD-NUM       TO WS-CARD-RID-CARDNUM                        \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                    TO TRUE                    \n                  SET FLG-ACCTFILTER-NOT-OK          TO TRUE                    \n                  SET FLG-CARDFILTER-NOT-OK          TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET DID-NOT-FIND-ACCTCARD-COMBO TO TRUE                   \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                    TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET FLG-ACCTFILTER-NOT-OK      TO TRUE                    \n                  END-IF                                                        \n                  MOVE 'READ'                        TO ERROR-OPNAME            \n                  MOVE LIT-CARDFILENAME                TO ERROR-FILE            \n                  MOVE WS-RESP-CD                    TO ERROR-RESP              \n                  MOVE WS-REAS-CD                    TO ERROR-RESP2             \n                  MOVE WS-FILE-ERROR-MESSAGE         TO WS-RETURN-MSG           \n           END-EVALUATE                                                         \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9150-GETCARD-BYACCT.                                                     \n                                                                                \n      *    Read the Card file. Access via alternate index ACCTID                \n      *                                                                         \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME-ACCT-PATH)                          \n                RIDFLD    (WS-CARD-RID-ACCT-ID)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  SET DID-NOT-FIND-ACCT-IN-CARDXREF TO TRUE                     \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARDFILENAME-ACCT-PATH TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n           END-EVALUATE                                                         \n           .                                                                    \n       9150-GETCARD-BYACCT-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-RETURN-MSG)                                        \n                     LENGTH(LENGTH OF WS-RETURN-MSG)                            \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      ******************************************************************        \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n       ABEND-ROUTINE.                                                           \n                                                                                \n           IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *"
      },
      "description": "This program, COCRDSLC, is a CICS-based business logic component of the CardDemo application that handles credit card detail requests. It allows users to view detailed information about a specific credit card by accepting account and card number inputs. The program retrieves card information from a card data file using the provided identifiers and displays details such as the embossed name, expiration date, and card status.\n\nThe program supports navigation from other screens in the application, particularly from the credit card list screen (COCRDLIC), and provides appropriate validation of input parameters. It performs field-level validations to ensure account numbers are 11-digit numeric values and card numbers are 16-digit numeric values. The program handles various error conditions, including invalid inputs and record not found scenarios, displaying appropriate error messages to guide the user.\n\nThe application follows a structured approach with clear separation between screen handling, input processing, data retrieval, and error management functions. It integrates with the broader CardDemo application through a common communication area structure and supports standard PF key navigation, including PF3 for returning to the previous screen or main menu.",
      "error_handling": null,
      "code": "      *****************************************************************         \n      * Program:     COCRDSLC.CBL                                     *         \n      * Layer:       Business logic                                   *         \n      * Function:    Accept and process credit card detail request    *         \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************        \n                                                                                \n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.                                                              \n           COCRDSLC.                                                            \n       DATE-WRITTEN.                                                            \n           April 2022.                                                          \n       DATE-COMPILED.                                                           \n           Today.                                                               \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n                                                                                \n       DATA DIVISION.                                                           \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Input edits                                                        \n      ******************************************************************        \n                                                                                \n         05  WS-INPUT-FLAG                         PIC X(1).                    \n           88  INPUT-OK                            VALUE '0'.                   \n           88  INPUT-ERROR                         VALUE '1'.                   \n           88  INPUT-PENDING                       VALUE LOW-VALUES.            \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID              VALUE '1'.                   \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05  WS-RETURN-FLAG                        PIC X(1).                    \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  CARD-CARD-NUM-X                     PIC X(16).                   \n           10  CARD-CARD-NUM-N REDEFINES  CARD-CARD-NUM-X                       \n                                                   PIC 9(16).                   \n           10  CARD-NAME-EMBOSSED-X                PIC X(50).                   \n           10  CARD-STATUS-X                       PIC X.                       \n           10  CARD-EXPIRAION-DATE-X               PIC X(10).                   \n           10  FILLER REDEFINES CARD-EXPIRAION-DATE-X.                          \n               20 CARD-EXPIRY-YEAR                 PIC X(4).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-MONTH                PIC X(2).                    \n               20 FILLER                           PIC X(1).                    \n               20 CARD-EXPIRY-DAY                  PIC X(2).                    \n           10  CARD-EXPIRAION-DATE-N REDEFINES                                  \n               CARD-EXPIRAION-DATE-X               PIC 9(10).                   \n                                                                                \n      ******************************************************************        \n      *      File and data Handling                                             \n      ******************************************************************        \n         05  WS-CARD-RID.                                                       \n           10  WS-CARD-RID-CARDNUM                 PIC X(16).                   \n           10  WS-CARD-RID-ACCT-ID                 PIC 9(11).                   \n           10  WS-CARD-RID-ACCT-ID-X REDEFINES                                  \n                  WS-CARD-RID-ACCT-ID              PIC X(11).                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error: '.        \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      *      Output Message Construction                                        \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(40).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  FOUND-CARDS-FOR-ACCOUNT             VALUE                        \n               '   Displaying requested details'.                               \n           88  WS-PROMPT-FOR-INPUT                 VALUE                        \n               'Please enter Account and Card Number'.                          \n                                                                                \n         05  WS-RETURN-MSG                         PIC X(75).                   \n           88  WS-RETURN-MSG-OFF                   VALUE SPACES.                \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 pressed.Exiting              '.                            \n           88  WS-PROMPT-FOR-ACCT                  VALUE                        \n               'Account number not provided'.                                   \n           88  WS-PROMPT-FOR-CARD                  VALUE                        \n               'Card number not provided'.                                      \n           88  NO-SEARCH-CRITERIA-RECEIVED         VALUE                        \n               'No input received'.                                             \n           88  SEARCHED-ACCT-ZEROES                VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-ACCT-NOT-NUMERIC           VALUE                        \n               'Account number must be a non zero 11 digit number'.             \n           88  SEARCHED-CARD-NOT-NUMERIC           VALUE                        \n               'Card number if supplied must be a 16 digit number'.             \n                                                                                \n           88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE                        \n               'Did not find this account in cards database'.                   \n           88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE                        \n               'Did not find cards for this search condition'.                  \n           88  XREF-READ-ERROR                     VALUE                        \n               'Error reading Card Data File'.                                  \n           88  CODING-TO-BE-DONE                   VALUE                        \n               'Looks Good.... so far'.                                         \n      ******************************************************************        \n      *      Literals and Constants                                             \n      ******************************************************************        \n       01 WS-LITERALS.                                                          \n          05 LIT-THISPGM                           PIC X(8)                     \n                                                   VALUE 'COCRDSLC'.            \n          05 LIT-THISTRANID                        PIC X(4)                     \n                                                   VALUE 'CCDL'.                \n          05 LIT-THISMAPSET                        PIC X(8)                     \n                                                   VALUE 'COCRDSL '.            \n          05 LIT-THISMAP                           PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-CCLISTPGM                         PIC X(8)                     \n                                                   VALUE 'COCRDLIC'.            \n          05 LIT-CCLISTTRANID                      PIC X(4)                     \n                                                   VALUE 'CCLI'.                \n          05 LIT-CCLISTMAPSET                      PIC X(7)                     \n                                                   VALUE 'COCRDLI'.             \n          05 LIT-CCLISTMAP                         PIC X(7)                     \n                                                   VALUE 'CCRDSLA'.             \n          05 LIT-MENUPGM                           PIC X(8)                     \n                                                   VALUE 'COMEN01C'.            \n          05 LIT-MENUTRANID                        PIC X(4)                     \n                                                   VALUE 'CM00'.                \n          05 LIT-MENUMAPSET                        PIC X(7)                     \n                                                   VALUE 'COMEN01'.             \n          05 LIT-MENUMAP                           PIC X(7)                     \n                                                   VALUE 'COMEN1A'.             \n          05 LIT-CARDFILENAME                      PIC X(8)                     \n                                                   VALUE 'CARDDAT '.            \n          05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)                     \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n          05 CA-CALL-CONTEXT.                                                   \n             10 CA-FROM-PROGRAM                    PIC X(08).                   \n             10 CA-FROM-TRANID                     PIC X(04).                   \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n       COPY COCRDSL.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n                                                                                \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n                                                                                \n      *Abend Variables                                                          \n       COPY CSMSG02Y.                                                           \n                                                                                \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n      *ACCOUNT RECORD LAYOUT                                                    \n      *COPY CVACT01Y.                                                           \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n      *CARD XREF LAYOUT                                                         \n      *COPY CVACT03Y.                                                           \n                                                                                \n      *CUSTOMER LAYOUT                                                          \n       COPY CVCUS01Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.                     \n                                                                                \n       PROCEDURE DIVISION.                                                      \n       0000-MAIN.                                                               \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                     LABEL(ABEND-ROUTINE)                                       \n           END-EXEC                                                             \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-RETURN-MSG-OFF  TO TRUE                                       \n      *****************************************************************         \n      * Store passed data if  any                *                              \n      *****************************************************************         \n           IF EIBCALEN IS EQUAL TO 0                                            \n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)                               \n              INITIALIZE CARDDEMO-COMMAREA                                      \n                         WS-THIS-PROGCOMMAREA                                   \n           ELSE                                                                 \n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO              \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO              \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n      *****************************************************************         \n      * Check the AID to see if its valid at this point               *         \n      * F3 - Exit                                                               \n      * Enter show screen again                                                 \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03                                                   \n              SET PFK-VALID TO TRUE                                             \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n                                                                                \n      *****************************************************************         \n      * Decide what to do based on inputs received                              \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n              WHEN CCARD-AID-PFK03                                              \n      ******************************************************************        \n      *            XCTL TO CALLING PROGRAM OR MAIN MENU                         \n      ******************************************************************        \n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-TRANID    EQUAL SPACES                         \n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID                   \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID                \n                   END-IF                                                       \n                                                                                \n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES                     \n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES                         \n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM                  \n                   ELSE                                                         \n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM               \n                   END-IF                                                       \n                                                                                \n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID                 \n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM                \n                                                                                \n                   SET  CDEMO-USRTYP-USER  TO TRUE                              \n                   SET  CDEMO-PGM-ENTER    TO TRUE                              \n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET                 \n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP                    \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                             PROGRAM (CDEMO-TO-PROGRAM)                         \n                             COMMAREA(CARDDEMO-COMMAREA)                        \n                   END-EXEC                                                     \n      ******************************************************************        \n      *            COMING FROM CREDIT CARD LIST SCREEN                          \n      *            SELECTION CRITERIA ALREADY VALIDATED                         \n      ******************************************************************        \n              WHEN CDEMO-PGM-ENTER                                              \n               AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                      \n                   SET INPUT-OK TO TRUE                                         \n                   MOVE CDEMO-ACCT-ID       TO CC-ACCT-ID-N                     \n                   MOVE CDEMO-CARD-NUM      TO CC-CARD-NUM-N                    \n                   PERFORM 9000-READ-DATA                                       \n                      THRU 9000-READ-DATA-EXIT                                  \n                   PERFORM 1000-SEND-MAP                                        \n                     THRU 1000-SEND-MAP-EXIT                                    \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-ENTER                                              \n      ******************************************************************        \n      *            COMING FROM SOME OTHER CONTEXT                               \n      *            SELECTION CRITERIA TO BE GATHERED                            \n      ******************************************************************        \n                   PERFORM 1000-SEND-MAP THRU                                   \n                           1000-SEND-MAP-EXIT                                   \n                   GO TO COMMON-RETURN                                          \n              WHEN CDEMO-PGM-REENTER                                            \n                   PERFORM 2000-PROCESS-INPUTS                                  \n                      THRU 2000-PROCESS-INPUTS-EXIT                             \n                   IF INPUT-ERROR                                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                   ELSE                                                         \n                      PERFORM 9000-READ-DATA                                    \n                         THRU 9000-READ-DATA-EXIT                               \n                      PERFORM 1000-SEND-MAP                                     \n                         THRU 1000-SEND-MAP-EXIT                                \n                      GO TO COMMON-RETURN                                       \n                                                                                \n                   END-IF                                                       \n                                                                                \n              WHEN OTHER                                                        \n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT                         \n                   MOVE '0001'         TO ABEND-CODE                            \n                   MOVE SPACES         TO ABEND-REASON                          \n                   MOVE 'UNEXPECTED DATA SCENARIO'                              \n                                       TO WS-RETURN-MSG                         \n                   PERFORM SEND-PLAIN-TEXT                                      \n                      THRU SEND-PLAIN-TEXT-EXIT                                 \n           END-EVALUATE                                                         \n                                                                                \n                                                                                \n      * If we had an error setup error message that slipped through             \n      * Display and return                                                      \n           IF INPUT-ERROR                                                       \n              MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                            \n              PERFORM 1000-SEND-MAP                                             \n                 THRU 1000-SEND-MAP-EXIT                                        \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG                            \n                                                                                \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SETUP-SCREEN-VARS                                       \n              THRU 1200-SETUP-SCREEN-VARS-EXIT                                  \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SEND-SCREEN                                             \n              THRU 1400-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES TO CCRDSLAO                                          \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDSLAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDSLAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDSLAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDSLAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDSLAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDSLAO                  \n                                                                                \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1200-SETUP-SCREEN-VARS.                                                  \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n              SET  WS-PROMPT-FOR-INPUT TO TRUE                                  \n           ELSE                                                                 \n              IF CDEMO-ACCT-ID = 0                                              \n                 MOVE LOW-VALUES   TO ACCTSIDO OF CCRDSLAO                      \n              ELSE                                                              \n                 MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDSLAO                      \n              END-IF                                                            \n                                                                                \n              IF CDEMO-CARD-NUM = 0                                             \n                MOVE LOW-VALUES   TO CARDSIDO OF CCRDSLAO                       \n              ELSE                                                              \n                MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDSLAO                       \n              END-IF                                                            \n                                                                                \n              IF FOUND-CARDS-FOR-ACCOUNT                                        \n                 MOVE CARD-EMBOSSED-NAME                                        \n                                        TO CRDNAMEO OF CCRDSLAO                 \n                 MOVE CARD-EXPIRAION-DATE                                       \n                                        TO CARD-EXPIRAION-DATE-X                \n                                                                                \n                 MOVE CARD-EXPIRY-MONTH TO EXPMONO  OF CCRDSLAO                 \n                                                                                \n                 MOVE CARD-EXPIRY-YEAR  TO EXPYEARO OF CCRDSLAO                 \n                                                                                \n                 MOVE CARD-ACTIVE-STATUS TO CRDSTCDO OF CCRDSLAO                \n              END-IF                                                            \n            END-IF                                                              \n                                                                                \n                                                                                \n      *    SETUP MESSAGE                                                        \n           IF WS-NO-INFO-MESSAGE                                                \n             SET WS-PROMPT-FOR-INPUT TO TRUE                                    \n           END-IF                                                               \n                                                                                \n           MOVE WS-RETURN-MSG          TO ERRMSGO OF CCRDSLAO                   \n                                                                                \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDSLAO                  \n           .                                                                    \n                                                                                \n       1200-SETUP-SCREEN-VARS-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS.                                                 \n                                                                                \n      *    PROTECT OR UNPROTECT BASED ON CONTEXT                                \n           IF  CDEMO-LAST-MAPSET  EQUAL LIT-CCLISTMAPSET \n           AND CDEMO-FROM-PROGRAM EQUAL LIT-CCLISTPGM                           \n              MOVE DFHBMPRF     TO ACCTSIDA OF CCRDSLAI                         \n              MOVE DFHBMPRF     TO CARDSIDA OF CCRDSLAI                         \n           ELSE                                                                 \n              MOVE DFHBMFSE      TO ACCTSIDA OF CCRDSLAI                        \n              MOVE DFHBMFSE      TO CARDSIDA OF CCRDSLAI                        \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n           EVALUATE TRUE                                                        \n              WHEN FLG-ACCTFILTER-NOT-OK                                        \n              WHEN FLG-ACCTFILTER-BLANK                                         \n                   MOVE -1             TO ACCTSIDL OF CCRDSLAI                  \n              WHEN FLG-CARDFILTER-NOT-OK                                        \n              WHEN FLG-CARDFILTER-BLANK                                         \n                   MOVE -1             TO CARDSIDL OF CCRDSLAI                  \n              WHEN OTHER                                                        \n                   MOVE -1             TO ACCTSIDL OF CCRDSLAI                  \n           END-EVALUATE                                                         \n                                                                                \n      *    SETUP COLOR                                                          \n           IF  CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-CCLISTPGM                          \n              MOVE DFHDFCOL     TO ACCTSIDC OF CCRDSLAO                         \n              MOVE DFHDFCOL     TO CARDSIDC OF CCRDSLAO                         \n           END-IF                                                               \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE DFHRED              TO ACCTSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE DFHRED              TO CARDSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO ACCTSIDO OF CCRDSLAO                  \n               MOVE DFHRED             TO ACCTSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  FLG-CARDFILTER-BLANK                                             \n           AND CDEMO-PGM-REENTER                                                \n               MOVE '*'                TO CARDSIDO OF CCRDSLAO                  \n               MOVE DFHRED             TO CARDSIDC OF CCRDSLAO                  \n           END-IF                                                               \n                                                                                \n           IF  WS-NO-INFO-MESSAGE                                               \n               MOVE DFHBMDAR           TO INFOMSGC OF CCRDSLAO                  \n           ELSE                                                                 \n               MOVE DFHNEUTR           TO INFOMSGC OF CCRDSLAO                  \n           END-IF                                                               \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n            EXIT.                                                               \n                                                                                \n                                                                                \n       1400-SEND-SCREEN.                                                        \n                                                                                \n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET                     \n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP                        \n           SET  CDEMO-PGM-REENTER TO TRUE                                       \n                                                                                \n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)                                   \n                          MAPSET(CCARD-NEXT-MAPSET)                             \n                          FROM(CCRDSLAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          FREEKB                                                \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n           .                                                                    \n       1400-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS.                                                     \n           PERFORM 2100-RECEIVE-MAP                                             \n              THRU 2100-RECEIVE-MAP-EXIT                                        \n           PERFORM 2200-EDIT-MAP-INPUTS                                         \n              THRU 2200-EDIT-MAP-INPUTS-EXIT                                    \n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG                               \n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG                               \n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET                             \n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP                                \n           .                                                                    \n                                                                                \n       2000-PROCESS-INPUTS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-MAP.                                                        \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                     MAPSET(LIT-THISMAPSET)                                     \n                     INTO(CCRDSLAI)                                             \n                     RESP(WS-RESP-CD)                                           \n                     RESP2(WS-REAS-CD)                                          \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n       2100-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2200-EDIT-MAP-INPUTS.                                                    \n                                                                                \n           SET INPUT-OK                  TO TRUE                                \n           SET FLG-CARDFILTER-ISVALID    TO TRUE                                \n           SET FLG-ACCTFILTER-ISVALID    TO TRUE                                \n                                                                                \n      *    REPLACE * WITH LOW-VALUES                                            \n           IF  ACCTSIDI OF CCRDSLAI = '*'                                       \n           OR  ACCTSIDI OF CCRDSLAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-ACCT-ID                         \n           ELSE                                                                 \n               MOVE ACCTSIDI OF CCRDSLAI TO  CC-ACCT-ID                         \n           END-IF                                                               \n                                                                                \n           IF  CARDSIDI OF CCRDSLAI = '*'                                       \n           OR  CARDSIDI OF CCRDSLAI = SPACES                                    \n               MOVE LOW-VALUES           TO  CC-CARD-NUM                        \n           ELSE                                                                 \n               MOVE CARDSIDI OF CCRDSLAI TO  CC-CARD-NUM                        \n           END-IF                                                               \n                                                                                \n      *    INDIVIDUAL FIELD EDITS                                               \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n      *    CROSS FIELD EDITS                                                    \n           IF  FLG-ACCTFILTER-BLANK                                             \n           AND FLG-CARDFILTER-BLANK                                             \n               SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE                          \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2200-EDIT-MAP-INPUTS-EXIT.                                               \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-ACCT TO TRUE                                 \n              END-IF                                                            \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                MOVE                                                            \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-NOT-OK TO TRUE                                    \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET INPUT-ERROR           TO TRUE                                 \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 SET WS-PROMPT-FOR-CARD TO TRUE                                 \n              END-IF                                                            \n                                                                                \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              IF WS-RETURN-MSG-OFF                                              \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-RETURN-MSG                                  \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-DATA.                                                          \n                                                                                \n           PERFORM 9100-GETCARD-BYACCTCARD                                      \n              THRU 9100-GETCARD-BYACCTCARD-EXIT                                 \n           .                                                                    \n                                                                                \n       9000-READ-DATA-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD.                                                 \n      *    Read the Card file                                                   \n      *                                                                         \n      *    MOVE CC-ACCT-ID-N      TO WS-CARD-RID-ACCT-ID                        \n           MOVE CC-CARD-NUM       TO WS-CARD-RID-CARDNUM                        \n                                                                                \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME)                                    \n                RIDFLD    (WS-CARD-RID-CARDNUM)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-CARDNUM)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                    TO TRUE                    \n                  SET FLG-ACCTFILTER-NOT-OK          TO TRUE                    \n                  SET FLG-CARDFILTER-NOT-OK          TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET DID-NOT-FIND-ACCTCARD-COMBO TO TRUE                   \n                  END-IF                                                        \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                    TO TRUE                    \n                  IF  WS-RETURN-MSG-OFF                                         \n                      SET FLG-ACCTFILTER-NOT-OK      TO TRUE                    \n                  END-IF                                                        \n                  MOVE 'READ'                        TO ERROR-OPNAME            \n                  MOVE LIT-CARDFILENAME                TO ERROR-FILE            \n                  MOVE WS-RESP-CD                    TO ERROR-RESP              \n                  MOVE WS-REAS-CD                    TO ERROR-RESP2             \n                  MOVE WS-FILE-ERROR-MESSAGE         TO WS-RETURN-MSG           \n           END-EVALUATE                                                         \n           .                                                                    \n                                                                                \n       9100-GETCARD-BYACCTCARD-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9150-GETCARD-BYACCT.                                                     \n                                                                                \n      *    Read the Card file. Access via alternate index ACCTID                \n      *                                                                         \n           EXEC CICS READ                                                       \n                FILE      (LIT-CARDFILENAME-ACCT-PATH)                          \n                RIDFLD    (WS-CARD-RID-ACCT-ID)                                 \n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID)                       \n                INTO      (CARD-RECORD)                                         \n                LENGTH    (LENGTH OF CARD-RECORD)                               \n                RESP      (WS-RESP-CD)                                          \n                RESP2     (WS-REAS-CD)                                          \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n                  SET FOUND-CARDS-FOR-ACCOUNT TO TRUE                           \n               WHEN DFHRESP(NOTFND)                                             \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  SET DID-NOT-FIND-ACCT-IN-CARDXREF TO TRUE                     \n               WHEN OTHER                                                       \n                  SET INPUT-ERROR                 TO TRUE                       \n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE              \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARDFILENAME-ACCT-PATH TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG              \n           END-EVALUATE                                                         \n           .                                                                    \n       9150-GETCARD-BYACCT-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-RETURN-MSG)                                        \n                     LENGTH(LENGTH OF WS-RETURN-MSG)                            \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      ******************************************************************        \n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n       ABEND-ROUTINE.                                                           \n                                                                                \n           IF ABEND-MSG EQUAL LOW-VALUES                                        \n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG                    \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM       TO ABEND-CULPRIT                              \n                                                                                \n           EXEC CICS SEND                                                       \n                            FROM (ABEND-DATA)                                   \n                            LENGTH(LENGTH OF ABEND-DATA)                        \n                            NOHANDLE                                            \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS HANDLE ABEND                                               \n                CANCEL                                                          \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS ABEND                                                      \n                ABCODE('9999')                                                  \n           END-EXEC                                                             \n           .                                                                    \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [
        "COCRDSL",
        "CSDAT01Y",
        "COCOM01Y",
        "CSUSR01Y",
        "CVACT02Y",
        "CSMSG01Y",
        "DFHBMSCA",
        "CVCUS01Y",
        "COTTL01Y",
        "CSMSG02Y",
        "DFHAID",
        "CVACT03Y",
        "CSSTRPFY",
        "CVACT01Y",
        "CVCRD01Y"
      ],
      "diagram": "sequenceDiagram\n    actor User\n    participant Main as 0000-MAIN\n    participant SendMap as 1000-SEND-MAP\n    participant ProcessInputs as 2000-PROCESS-INPUTS\n    participant ReadData as 9000-READ-DATA\n    participant CardFile as Card File\n    \n    User->>Main: Start transaction\n    \n    Main->>Main: Initialize work areas\n    Main->>Main: Store context\n    Main->>Main: Process communication area\n    \n    alt PF3 pressed\n        Main->>User: Return to previous screen\n    else Coming from credit card list screen\n        Main->>ReadData: Read card details\n        ReadData->>CardFile: READ using card number\n        CardFile-->>ReadData: Card record\n        ReadData-->>Main: Card details\n        Main->>SendMap: Display card details\n        SendMap-->>User: Show card details screen\n    else Initial entry\n        Main->>SendMap: Display input screen\n        SendMap-->>User: Show input screen\n    else Re-entry after input\n        Main->>ProcessInputs: Process user inputs\n        ProcessInputs->>ProcessInputs: Receive map data\n        ProcessInputs->>ProcessInputs: Validate account ID\n        ProcessInputs->>ProcessInputs: Validate card number\n        \n        alt Input valid\n            ProcessInputs-->>Main: Valid input\n            Main->>ReadData: Read card details\n            ReadData->>CardFile: READ using card number\n            \n            alt Record found\n                CardFile-->>ReadData: Card record\n                ReadData-->>Main: Card details\n                Main->>SendMap: Display card details\n                SendMap-->>User: Show card details screen\n            else Record not found\n                CardFile-->>ReadData: NOTFND response\n                ReadData-->>Main: Error - record not found\n                Main->>SendMap: Display error message\n                SendMap-->>User: Show error message\n            end\n        else Input invalid\n            ProcessInputs-->>Main: Invalid input\n            Main->>SendMap: Display error message\n            SendMap-->>User: Show error message\n        end\n    end\n    \n    Main->>Main: Return to CICS"
    },
    {
      "id": "CSUTLDTC",
      "author": "",
      "environment_division": null,
      "data_division": {
        "sections": [
          {
            "name": "WORKING-STORAGE SECTION",
            "code": "****  Date passed to CEEDAYS API                                          \n         01 WS-DATE-TO-TEST.                                                    \n              02  Vstring-length      PIC S9(4) BINARY.                         \n              02  Vstring-text.                                                 \n                  03  Vstring-char    PIC X                                     \n                              OCCURS 0 TO 256 TIMES                             \n                              DEPENDING ON Vstring-length                       \n                                 of WS-DATE-TO-TEST.                            \n      ****  DATE FORMAT PASSED TO CEEDAYS API                                   \n         01 WS-DATE-FORMAT.                                                     \n              02  Vstring-length      PIC S9(4) BINARY.                         \n              02  Vstring-text.                                                 \n                  03  Vstring-char    PIC X                                     \n                              OCCURS 0 TO 256 TIMES                             \n                              DEPENDING ON Vstring-length                       \n                                 of WS-DATE-FORMAT.                             \n      ****  OUTPUT from CEEDAYS - LILLIAN DATE FORMAT                           \n         01 OUTPUT-LILLIAN    PIC S9(9) USAGE IS BINARY.                        \n         01 WS-MESSAGE.                                                         \n              02 WS-SEVERITY  PIC X(04).                                        \n              02 WS-SEVERITY-N REDEFINES WS-SEVERITY PIC 9(4).                  \n              02 FILLER       PIC X(11) VALUE 'Mesg Code:'.                     \n              02 WS-MSG-NO    PIC X(04).                                        \n              02 WS-MSG-NO-N  REDEFINES WS-MSG-NO PIC 9(4).                     \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 WS-RESULT    PIC X(15).                                        \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(09) VALUE 'TstDate:'.                       \n              02 WS-DATE      PIC X(10) VALUE SPACES.                           \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(10) VALUE 'Mask used:'.                     \n              02 WS-DATE-FMT  PIC X(10).                                        \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(03) VALUE SPACES.                           \n                                                                                \n      * CEEDAYS API FEEDBACK CODE                                               \n          01 FEEDBACK-CODE.                                                     \n           02  FEEDBACK-TOKEN-VALUE. \n             88  FC-INVALID-DATE       VALUE X'0000000000000000'.\n             88  FC-INSUFFICIENT-DATA  VALUE X'000309CB59C3C5C5'.\n             88  FC-BAD-DATE-VALUE     VALUE X'000309CC59C3C5C5'.\n             88  FC-INVALID-ERA        VALUE X'000309CD59C3C5C5'.\n             88  FC-UNSUPP-RANGE       VALUE X'000309D159C3C5C5'.\n             88  FC-INVALID-MONTH      VALUE X'000309D559C3C5C5'.\n             88  FC-BAD-PIC-STRING     VALUE X'000309D659C3C5C5'.\n             88  FC-NON-NUMERIC-DATA   VALUE X'000309D859C3C5C5'.\n             88  FC-YEAR-IN-ERA-ZERO   VALUE X'000309D959C3C5C5'.\n               03  CASE-1-CONDITION-ID.                                         \n                   04  SEVERITY        PIC S9(4) BINARY.                        \n                   04  MSG-NO          PIC S9(4) BINARY.                        \n               03  CASE-2-CONDITION-ID                                          \n                         REDEFINES CASE-1-CONDITION-ID.                         \n                   04  CLASS-CODE      PIC S9(4) BINARY.                        \n                   04  CAUSE-CODE      PIC S9(4) BINARY.                        \n               03  CASE-SEV-CTL    PIC X.                                       \n               03  FACILITY-ID     PIC XXX.                                     \n           02  I-S-INFO        PIC S9(9) BINARY.",
            "description": "This data section defines the structures used for date validation through the IBM Language Environment CEEDAYS API. It contains three main components: WS-DATE-TO-TEST for storing the input date string, WS-DATE-FORMAT for the format pattern, and OUTPUT-LILLIAN for the converted Lilian date value. The WS-MESSAGE structure stores validation results including severity codes, message numbers, and descriptive text about the validation outcome. The FEEDBACK-CODE structure captures detailed error information from the CEEDAYS API, with condition indicators (88-level items) for specific validation failures such as invalid dates, insufficient data, range issues, and non-numeric data. These structures enable the program to process date inputs and provide meaningful validation results to the calling programs within the CardDemo application."
          },
          {
            "name": "LINKAGE SECTION",
            "code": "01 LS-DATE         PIC X(10).                                         \n          01 LS-DATE-FORMAT  PIC X(10).                                         \n          01 LS-RESULT       PIC X(80).",
            "description": "This linkage section defines the interface parameters for the date validation utility. It contains three fields: LS-DATE which holds the input date string (up to 10 characters), LS-DATE-FORMAT which specifies the expected format pattern for validation (up to 10 characters), and LS-RESULT which stores the validation outcome message (up to 80 characters) that will be returned to the calling program."
          }
        ],
        "copybooks": [],
        "code": "WORKING-STORAGE SECTION.                                                 \n                                                                                \n      ****  Date passed to CEEDAYS API                                          \n         01 WS-DATE-TO-TEST.                                                    \n              02  Vstring-length      PIC S9(4) BINARY.                         \n              02  Vstring-text.                                                 \n                  03  Vstring-char    PIC X                                     \n                              OCCURS 0 TO 256 TIMES                             \n                              DEPENDING ON Vstring-length                       \n                                 of WS-DATE-TO-TEST.                            \n      ****  DATE FORMAT PASSED TO CEEDAYS API                                   \n         01 WS-DATE-FORMAT.                                                     \n              02  Vstring-length      PIC S9(4) BINARY.                         \n              02  Vstring-text.                                                 \n                  03  Vstring-char    PIC X                                     \n                              OCCURS 0 TO 256 TIMES                             \n                              DEPENDING ON Vstring-length                       \n                                 of WS-DATE-FORMAT.                             \n      ****  OUTPUT from CEEDAYS - LILLIAN DATE FORMAT                           \n         01 OUTPUT-LILLIAN    PIC S9(9) USAGE IS BINARY.                        \n         01 WS-MESSAGE.                                                         \n              02 WS-SEVERITY  PIC X(04).                                        \n              02 WS-SEVERITY-N REDEFINES WS-SEVERITY PIC 9(4).                  \n              02 FILLER       PIC X(11) VALUE 'Mesg Code:'.                     \n              02 WS-MSG-NO    PIC X(04).                                        \n              02 WS-MSG-NO-N  REDEFINES WS-MSG-NO PIC 9(4).                     \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 WS-RESULT    PIC X(15).                                        \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(09) VALUE 'TstDate:'.                       \n              02 WS-DATE      PIC X(10) VALUE SPACES.                           \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(10) VALUE 'Mask used:'.                     \n              02 WS-DATE-FMT  PIC X(10).                                        \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(03) VALUE SPACES.                           \n                                                                                \n      * CEEDAYS API FEEDBACK CODE                                               \n          01 FEEDBACK-CODE.                                                     \n           02  FEEDBACK-TOKEN-VALUE. \n             88  FC-INVALID-DATE       VALUE X'0000000000000000'.\n             88  FC-INSUFFICIENT-DATA  VALUE X'000309CB59C3C5C5'.\n             88  FC-BAD-DATE-VALUE     VALUE X'000309CC59C3C5C5'.\n             88  FC-INVALID-ERA        VALUE X'000309CD59C3C5C5'.\n             88  FC-UNSUPP-RANGE       VALUE X'000309D159C3C5C5'.\n             88  FC-INVALID-MONTH      VALUE X'000309D559C3C5C5'.\n             88  FC-BAD-PIC-STRING     VALUE X'000309D659C3C5C5'.\n             88  FC-NON-NUMERIC-DATA   VALUE X'000309D859C3C5C5'.\n             88  FC-YEAR-IN-ERA-ZERO   VALUE X'000309D959C3C5C5'.\n               03  CASE-1-CONDITION-ID.                                         \n                   04  SEVERITY        PIC S9(4) BINARY.                        \n                   04  MSG-NO          PIC S9(4) BINARY.                        \n               03  CASE-2-CONDITION-ID                                          \n                         REDEFINES CASE-1-CONDITION-ID.                         \n                   04  CLASS-CODE      PIC S9(4) BINARY.                        \n                   04  CAUSE-CODE      PIC S9(4) BINARY.                        \n               03  CASE-SEV-CTL    PIC X.                                       \n               03  FACILITY-ID     PIC XXX.                                     \n           02  I-S-INFO        PIC S9(9) BINARY.                                \n                                                                                \n                                                                                \n       LINKAGE SECTION.                                                         \n          01 LS-DATE         PIC X(10).                                         \n          01 LS-DATE-FORMAT  PIC X(10).                                         \n          01 LS-RESULT       PIC X(80)."
      },
      "procedure_division": {
        "paragraphs": [
          {
            "name": "A000-MAIN",
            "code": "MOVE LENGTH OF LS-DATE                                               \n                        TO VSTRING-LENGTH  OF WS-DATE-TO-TEST                   \n           MOVE LS-DATE TO VSTRING-TEXT    OF WS-DATE-TO-TEST\n                           WS-DATE                  \n           MOVE LENGTH OF LS-DATE-FORMAT                                        \n                         TO VSTRING-LENGTH OF WS-DATE-FORMAT                    \n           MOVE LS-DATE-FORMAT                                                  \n                         TO VSTRING-TEXT   OF WS-DATE-FORMAT   \n                            WS-DATE-FMT  \n           MOVE 0        TO OUTPUT-LILLIAN                              \n                                                                        \n           CALL \"CEEDAYS\" USING                                                 \n                  WS-DATE-TO-TEST,                                              \n                  WS-DATE-FORMAT,                                               \n                  OUTPUT-LILLIAN,                                               \n                  FEEDBACK-CODE                                                 \n                                                                                \n           MOVE WS-DATE-TO-TEST            TO WS-DATE                           \n           MOVE SEVERITY OF FEEDBACK-CODE  TO WS-SEVERITY-N                     \n           MOVE MSG-NO OF FEEDBACK-CODE    TO WS-MSG-NO-N                       \n                                                                 \n      *    WS-RESULT IS 15 CHARACTERS                                           \n      *                123456789012345'                                         \n           EVALUATE TRUE                                                        \n              WHEN FC-INVALID-DATE                                   \n                 MOVE 'Date is valid'      TO WS-RESULT              \n              WHEN FC-INSUFFICIENT-DATA                              \n                 MOVE 'Insufficient'       TO WS-RESULT              \n              WHEN FC-BAD-DATE-VALUE                                 \n                 MOVE 'Datevalue error'    TO WS-RESULT              \n              WHEN FC-INVALID-ERA                                    \n                 MOVE 'Invalid Era    '    TO WS-RESULT              \n              WHEN FC-UNSUPP-RANGE                                   \n                 MOVE 'Unsupp. Range  '    TO WS-RESULT              \n              WHEN FC-INVALID-MONTH                                  \n                 MOVE 'Invalid month  '    TO WS-RESULT              \n              WHEN FC-BAD-PIC-STRING                                 \n                 MOVE 'Bad Pic String '    TO WS-RESULT              \n              WHEN FC-NON-NUMERIC-DATA                               \n                 MOVE 'Nonnumeric data'    TO WS-RESULT              \n              WHEN FC-YEAR-IN-ERA-ZERO                               \n                 MOVE 'YearInEra is 0 '    TO WS-RESULT              \n              WHEN OTHER                                             \n                 MOVE 'Date is invalid'    TO WS-RESULT \n           END-EVALUATE                                                         \n                                                                                \n           .",
            "description": "This paragraph handles the core date validation logic by preparing input parameters, calling the IBM CEEDAYS API, and interpreting the validation results. It first moves the input date and format pattern into working storage variables with proper length specifications. After calling CEEDAYS with these parameters, it evaluates the returned feedback code to determine the validation status. The paragraph translates technical feedback codes into human-readable messages that describe specific validation issues such as invalid date values, format mismatches, unsupported ranges, or non-numeric data. The result is stored in WS-RESULT, which will be used by the calling program to communicate the validation outcome to users or other processes."
          },
          {
            "name": "A000-MAIN-EXIT",
            "code": "EXIT                                                                 \n           .                                                                    \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:35 CDT\n      *",
            "description": "This paragraph serves as the exit point for the CSUTLDTC program. It marks the end of program execution with a standard EXIT statement. The paragraph includes version control information showing that this code is part of CardDemo version 1.0-15-g27d6c6f-68, with the last update made on July 19, 2022."
          }
        ],
        "code": "USING LS-DATE, LS-DATE-FORMAT, LS-RESULT.             \n           \n           INITIALIZE WS-MESSAGE\n           MOVE SPACES TO WS-DATE\n                                                                        \n           PERFORM A000-MAIN                                                    \n              THRU A000-MAIN-EXIT                                               \n\n      *    DISPLAY WS-MESSAGE                                                   \n           MOVE WS-MESSAGE                 TO LS-RESULT \n           MOVE WS-SEVERITY-N              TO RETURN-CODE          \n                                                                                \n           EXIT PROGRAM                                                         \n      *    GOBACK                                                               \n           .                                                                    \n       A000-MAIN.                                                               \n                                                                                \n           MOVE LENGTH OF LS-DATE                                               \n                        TO VSTRING-LENGTH  OF WS-DATE-TO-TEST                   \n           MOVE LS-DATE TO VSTRING-TEXT    OF WS-DATE-TO-TEST\n                           WS-DATE                  \n           MOVE LENGTH OF LS-DATE-FORMAT                                        \n                         TO VSTRING-LENGTH OF WS-DATE-FORMAT                    \n           MOVE LS-DATE-FORMAT                                                  \n                         TO VSTRING-TEXT   OF WS-DATE-FORMAT   \n                            WS-DATE-FMT  \n           MOVE 0        TO OUTPUT-LILLIAN                              \n                                                                        \n           CALL \"CEEDAYS\" USING                                                 \n                  WS-DATE-TO-TEST,                                              \n                  WS-DATE-FORMAT,                                               \n                  OUTPUT-LILLIAN,                                               \n                  FEEDBACK-CODE                                                 \n                                                                                \n           MOVE WS-DATE-TO-TEST            TO WS-DATE                           \n           MOVE SEVERITY OF FEEDBACK-CODE  TO WS-SEVERITY-N                     \n           MOVE MSG-NO OF FEEDBACK-CODE    TO WS-MSG-NO-N                       \n                                                                 \n      *    WS-RESULT IS 15 CHARACTERS                                           \n      *                123456789012345'                                         \n           EVALUATE TRUE                                                        \n              WHEN FC-INVALID-DATE                                   \n                 MOVE 'Date is valid'      TO WS-RESULT              \n              WHEN FC-INSUFFICIENT-DATA                              \n                 MOVE 'Insufficient'       TO WS-RESULT              \n              WHEN FC-BAD-DATE-VALUE                                 \n                 MOVE 'Datevalue error'    TO WS-RESULT              \n              WHEN FC-INVALID-ERA                                    \n                 MOVE 'Invalid Era    '    TO WS-RESULT              \n              WHEN FC-UNSUPP-RANGE                                   \n                 MOVE 'Unsupp. Range  '    TO WS-RESULT              \n              WHEN FC-INVALID-MONTH                                  \n                 MOVE 'Invalid month  '    TO WS-RESULT              \n              WHEN FC-BAD-PIC-STRING                                 \n                 MOVE 'Bad Pic String '    TO WS-RESULT              \n              WHEN FC-NON-NUMERIC-DATA                               \n                 MOVE 'Nonnumeric data'    TO WS-RESULT              \n              WHEN FC-YEAR-IN-ERA-ZERO                               \n                 MOVE 'YearInEra is 0 '    TO WS-RESULT              \n              WHEN OTHER                                             \n                 MOVE 'Date is invalid'    TO WS-RESULT \n           END-EVALUATE                                                         \n                                                                                \n           .                                                                    \n       A000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:35 CDT\n      *"
      },
      "description": "This program serves as a utility for date validation in the CardDemo application. It leverages the IBM Language Environment CEEDAYS API to validate dates against specified formats. The program accepts an input date string and format pattern, then returns a detailed validation result. It handles various date validation errors, including invalid date values, format mismatches, range issues, and non-numeric data. The program communicates results through a structured message that includes severity codes, message numbers, and descriptive text about the validation outcome. This utility is likely used throughout the CardDemo application to ensure date inputs meet required formats before processing transactions or updates.",
      "error_handling": null,
      "code": "      ******************************************************************        \n      *****       CALL TO CEEDAYS                                *******        \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************        \n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID. CSUTLDTC.                                                    \n       DATA DIVISION.                                                           \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n      ****  Date passed to CEEDAYS API                                          \n         01 WS-DATE-TO-TEST.                                                    \n              02  Vstring-length      PIC S9(4) BINARY.                         \n              02  Vstring-text.                                                 \n                  03  Vstring-char    PIC X                                     \n                              OCCURS 0 TO 256 TIMES                             \n                              DEPENDING ON Vstring-length                       \n                                 of WS-DATE-TO-TEST.                            \n      ****  DATE FORMAT PASSED TO CEEDAYS API                                   \n         01 WS-DATE-FORMAT.                                                     \n              02  Vstring-length      PIC S9(4) BINARY.                         \n              02  Vstring-text.                                                 \n                  03  Vstring-char    PIC X                                     \n                              OCCURS 0 TO 256 TIMES                             \n                              DEPENDING ON Vstring-length                       \n                                 of WS-DATE-FORMAT.                             \n      ****  OUTPUT from CEEDAYS - LILLIAN DATE FORMAT                           \n         01 OUTPUT-LILLIAN    PIC S9(9) USAGE IS BINARY.                        \n         01 WS-MESSAGE.                                                         \n              02 WS-SEVERITY  PIC X(04).                                        \n              02 WS-SEVERITY-N REDEFINES WS-SEVERITY PIC 9(4).                  \n              02 FILLER       PIC X(11) VALUE 'Mesg Code:'.                     \n              02 WS-MSG-NO    PIC X(04).                                        \n              02 WS-MSG-NO-N  REDEFINES WS-MSG-NO PIC 9(4).                     \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 WS-RESULT    PIC X(15).                                        \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(09) VALUE 'TstDate:'.                       \n              02 WS-DATE      PIC X(10) VALUE SPACES.                           \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(10) VALUE 'Mask used:'.                     \n              02 WS-DATE-FMT  PIC X(10).                                        \n              02 FILLER       PIC X(01) VALUE SPACE.                            \n              02 FILLER       PIC X(03) VALUE SPACES.                           \n                                                                                \n      * CEEDAYS API FEEDBACK CODE                                               \n          01 FEEDBACK-CODE.                                                     \n           02  FEEDBACK-TOKEN-VALUE. \n             88  FC-INVALID-DATE       VALUE X'0000000000000000'.\n             88  FC-INSUFFICIENT-DATA  VALUE X'000309CB59C3C5C5'.\n             88  FC-BAD-DATE-VALUE     VALUE X'000309CC59C3C5C5'.\n             88  FC-INVALID-ERA        VALUE X'000309CD59C3C5C5'.\n             88  FC-UNSUPP-RANGE       VALUE X'000309D159C3C5C5'.\n             88  FC-INVALID-MONTH      VALUE X'000309D559C3C5C5'.\n             88  FC-BAD-PIC-STRING     VALUE X'000309D659C3C5C5'.\n             88  FC-NON-NUMERIC-DATA   VALUE X'000309D859C3C5C5'.\n             88  FC-YEAR-IN-ERA-ZERO   VALUE X'000309D959C3C5C5'.\n               03  CASE-1-CONDITION-ID.                                         \n                   04  SEVERITY        PIC S9(4) BINARY.                        \n                   04  MSG-NO          PIC S9(4) BINARY.                        \n               03  CASE-2-CONDITION-ID                                          \n                         REDEFINES CASE-1-CONDITION-ID.                         \n                   04  CLASS-CODE      PIC S9(4) BINARY.                        \n                   04  CAUSE-CODE      PIC S9(4) BINARY.                        \n               03  CASE-SEV-CTL    PIC X.                                       \n               03  FACILITY-ID     PIC XXX.                                     \n           02  I-S-INFO        PIC S9(9) BINARY.                                \n                                                                                \n                                                                                \n       LINKAGE SECTION.                                                         \n          01 LS-DATE         PIC X(10).                                         \n          01 LS-DATE-FORMAT  PIC X(10).                                         \n          01 LS-RESULT       PIC X(80).                                         \n                                                                                \n       PROCEDURE DIVISION USING LS-DATE, LS-DATE-FORMAT, LS-RESULT.             \n           \n           INITIALIZE WS-MESSAGE\n           MOVE SPACES TO WS-DATE\n                                                                        \n           PERFORM A000-MAIN                                                    \n              THRU A000-MAIN-EXIT                                               \n\n      *    DISPLAY WS-MESSAGE                                                   \n           MOVE WS-MESSAGE                 TO LS-RESULT \n           MOVE WS-SEVERITY-N              TO RETURN-CODE          \n                                                                                \n           EXIT PROGRAM                                                         \n      *    GOBACK                                                               \n           .                                                                    \n       A000-MAIN.                                                               \n                                                                                \n           MOVE LENGTH OF LS-DATE                                               \n                        TO VSTRING-LENGTH  OF WS-DATE-TO-TEST                   \n           MOVE LS-DATE TO VSTRING-TEXT    OF WS-DATE-TO-TEST\n                           WS-DATE                  \n           MOVE LENGTH OF LS-DATE-FORMAT                                        \n                         TO VSTRING-LENGTH OF WS-DATE-FORMAT                    \n           MOVE LS-DATE-FORMAT                                                  \n                         TO VSTRING-TEXT   OF WS-DATE-FORMAT   \n                            WS-DATE-FMT  \n           MOVE 0        TO OUTPUT-LILLIAN                              \n                                                                        \n           CALL \"CEEDAYS\" USING                                                 \n                  WS-DATE-TO-TEST,                                              \n                  WS-DATE-FORMAT,                                               \n                  OUTPUT-LILLIAN,                                               \n                  FEEDBACK-CODE                                                 \n                                                                                \n           MOVE WS-DATE-TO-TEST            TO WS-DATE                           \n           MOVE SEVERITY OF FEEDBACK-CODE  TO WS-SEVERITY-N                     \n           MOVE MSG-NO OF FEEDBACK-CODE    TO WS-MSG-NO-N                       \n                                                                 \n      *    WS-RESULT IS 15 CHARACTERS                                           \n      *                123456789012345'                                         \n           EVALUATE TRUE                                                        \n              WHEN FC-INVALID-DATE                                   \n                 MOVE 'Date is valid'      TO WS-RESULT              \n              WHEN FC-INSUFFICIENT-DATA                              \n                 MOVE 'Insufficient'       TO WS-RESULT              \n              WHEN FC-BAD-DATE-VALUE                                 \n                 MOVE 'Datevalue error'    TO WS-RESULT              \n              WHEN FC-INVALID-ERA                                    \n                 MOVE 'Invalid Era    '    TO WS-RESULT              \n              WHEN FC-UNSUPP-RANGE                                   \n                 MOVE 'Unsupp. Range  '    TO WS-RESULT              \n              WHEN FC-INVALID-MONTH                                  \n                 MOVE 'Invalid month  '    TO WS-RESULT              \n              WHEN FC-BAD-PIC-STRING                                 \n                 MOVE 'Bad Pic String '    TO WS-RESULT              \n              WHEN FC-NON-NUMERIC-DATA                               \n                 MOVE 'Nonnumeric data'    TO WS-RESULT              \n              WHEN FC-YEAR-IN-ERA-ZERO                               \n                 MOVE 'YearInEra is 0 '    TO WS-RESULT              \n              WHEN OTHER                                             \n                 MOVE 'Date is invalid'    TO WS-RESULT \n           END-EVALUATE                                                         \n                                                                                \n           .                                                                    \n       A000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:35 CDT\n      *\n",
      "asm_calls": [],
      "referenced_copybooks": [],
      "diagram": "sequenceDiagram\n    participant Caller as \"Calling Program\"\n    participant CSUTLDTC as \"CSUTLDTC Program\"\n    participant CEEDAYS as \"CEEDAYS API\"\n    \n    Caller->>CSUTLDTC: Call with LS-DATE and LS-DATE-FORMAT\n    \n    Note over CSUTLDTC: A000-MAIN\n    CSUTLDTC->>CSUTLDTC: Prepare date and format parameters\n    CSUTLDTC->>CEEDAYS: Call with WS-DATE-TO-TEST, WS-DATE-FORMAT\n    CEEDAYS-->>CSUTLDTC: Return OUTPUT-LILLIAN and FEEDBACK-CODE\n    \n    CSUTLDTC->>CSUTLDTC: Evaluate FEEDBACK-CODE\n    \n    alt FC-INVALID-DATE\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Date is valid'\n    else FC-INSUFFICIENT-DATA\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Insufficient'\n    else FC-BAD-DATE-VALUE\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Datevalue error'\n    else FC-INVALID-ERA\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Invalid Era'\n    else FC-UNSUPP-RANGE\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Unsupp. Range'\n    else FC-INVALID-MONTH\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Invalid month'\n    else FC-BAD-PIC-STRING\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Bad Pic String'\n    else FC-NON-NUMERIC-DATA\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Nonnumeric data'\n    else FC-YEAR-IN-ERA-ZERO\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'YearInEra is 0'\n    else OTHER\n        CSUTLDTC->>CSUTLDTC: Set WS-RESULT = 'Date is invalid'\n    end\n    \n    Note over CSUTLDTC: A000-MAIN-EXIT\n    CSUTLDTC-->>Caller: Return with validation result in WS-RESULT"
    }
  ],
  "visual_age_programs": [],
  "copybooks": [
    {
      "name": "CVCRD01Y",
      "code": "000100 01  CC-WORK-AREAS.                                               00010004\n000200    05 CC-WORK-AREA.                                              00020001\n000900       10 CCARD-AID                         PIC X(5).             00090001\n001000          88  CCARD-AID-ENTER                VALUE 'ENTER'.       00100001\n001100          88  CCARD-AID-CLEAR                VALUE 'CLEAR'.       00110001\n001200          88  CCARD-AID-PA1                  VALUE 'PA1  '.       00120001\n001300          88  CCARD-AID-PA2                  VALUE 'PA2  '.       00130001\n001400          88  CCARD-AID-PFK01                VALUE 'PFK01'.       00140001\n001500          88  CCARD-AID-PFK02                VALUE 'PFK02'.       00150001\n001600          88  CCARD-AID-PFK03                VALUE 'PFK03'.       00160001\n001700          88  CCARD-AID-PFK04                VALUE 'PFK04'.       00170001\n001800          88  CCARD-AID-PFK05                VALUE 'PFK05'.       00180001\n001900          88  CCARD-AID-PFK06                VALUE 'PFK06'.       00190001\n002000          88  CCARD-AID-PFK07                VALUE 'PFK07'.       00200001\n002100          88  CCARD-AID-PFK08                VALUE 'PFK08'.       00210001\n002200          88  CCARD-AID-PFK09                VALUE 'PFK09'.       00220001\n002300          88  CCARD-AID-PFK10                VALUE 'PFK10'.       00230001\n002400          88  CCARD-AID-PFK11                VALUE 'PFK11'.       00240001\n002500          88  CCARD-AID-PFK12                VALUE 'PFK12'.       00250001\n002600*      10  CCARD-LAST-PROG                  PIC X(8).             00260001\n002700       10  CCARD-NEXT-PROG                  PIC X(8).             00270001\n002800*      10  CCARD-RETURN-TO-PROG             PIC X(8).             00280001\n003300       10  CCARD-NEXT-MAPSET                PIC X(7).             00330001\n003400       10  CCARD-NEXT-MAP                   PIC X(7).             00340001\n003500*      10  CCARD-RETURN-FLAG                PIC X(1).             00350001\n003600*        88  CCARD-RETURN-FLAG-OFF          VALUE LOW-VALUES.     00360001\n003700*        88  CCARD-RETURN-FLAG-ON           VALUE '1'.            00370001\n003800       10  CCARD-ERROR-MSG                  PIC X(75).            00380001\n003900       10  CCARD-RETURN-MSG                 PIC X(75).            00390001\n004000         88  CCARD-RETURN-MSG-OFF           VALUE LOW-VALUES.     00400001\n004100*      10  CCARD-FUNCTION                   PIC X(1).             00410001\n004200*        88  CCARD-NO-VALUE                  VALUE LOW-VALUES.    00420001\n004300*        88  CCARD-GET-DATA                  VALUE '1'.           00430001\n004400       10 CC-ACCT-ID                        PIC X(11)             00440005\n004500                                            VALUE SPACES.\n             10 CC-ACCT-ID-N REDEFINES CC-ACCT-ID PIC 9(11).\n004600       10 CC-CARD-NUM                       PIC X(16)             00460005\n004700                                            VALUE SPACES.         00470005\n             10 CC-CARD-NUM-N REDEFINES CC-CARD-NUM PIC 9(16).\n004800       10 CC-CUST-ID                        PIC X(09)             00480005\n004900                                            VALUE SPACES.         00490005\n004800       10 CC-CUST-ID-N REDEFINES CC-CUST-ID PIC 9(9).             00480005\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines a data structure for work areas used in the CardDemo credit card application. It contains fields for handling terminal interactions, program flow control, and key credit card data. The structure includes AID (Attention Identifier) keys with condition names for various keyboard functions (ENTER, CLEAR, PA keys, and PF keys), fields for managing program and map navigation, error and return message areas, and core credit card data fields including account ID, card number, and customer ID. The numeric fields have both alphanumeric and numeric representations through REDEFINES clauses, allowing for flexible data handling in the application."
    },
    {
      "name": "CSMSG02Y",
      "code": "000700*****************************************************************\n000800* CABENDD.CPY                                                   *\n000900*---------------------------------------------------------------*\n001000* Work areas for abend routine                                  *\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n001200 01  ABEND-DATA.\n001300   05  ABEND-CODE                            PIC X(4)\n001400       VALUE SPACES.\n001500   05  ABEND-CULPRIT                         PIC X(8)\n001600       VALUE SPACES.\n001700   05  ABEND-REASON                          PIC X(50)\n001800       VALUE SPACES.\n001900   05  ABEND-MSG                             PIC X(72)\n002000       VALUE SPACES.\n\n\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT\n      *\n",
      "description": "This copybook defines data structures used for handling application abends (abnormal terminations) in the CardDemo application. It contains the ABEND-DATA group item with four fields: ABEND-CODE to store the four-character abend code, ABEND-CULPRIT to identify the program or component that caused the abend, ABEND-REASON to provide a detailed explanation of the error condition, and ABEND-MSG for storing a more comprehensive error message. This shared structure enables consistent error handling and reporting across programs that include this copybook."
    },
    {
      "name": "CSMSG01Y",
      "code": "      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 CCDA-COMMON-MESSAGES.\n         05 CCDA-MSG-THANK-YOU         PIC X(50) VALUE\n              'Thank you for using CardDemo application...      '.\n         05 CCDA-MSG-INVALID-KEY       PIC X(50) VALUE\n              'Invalid key pressed. Please see below...         '.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT\n      *\n",
      "description": "This copybook defines a set of common message constants used throughout the CardDemo application. It contains predefined text messages for standard user interactions, including a thank you message and an invalid key notification. These standardized messages help maintain consistency in user communication across different components of the CardDemo application."
    },
    {
      "name": "CSUSR01Y",
      "code": "      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 SEC-USER-DATA.\n         05 SEC-USR-ID                 PIC X(08).\n         05 SEC-USR-FNAME              PIC X(20).\n         05 SEC-USR-LNAME              PIC X(20).\n         05 SEC-USR-PWD                PIC X(08).\n         05 SEC-USR-TYPE               PIC X(01).\n         05 SEC-USR-FILLER             PIC X(23).\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT\n      *\n",
      "description": "This copybook defines the security user data structure used in the CardDemo application for AWS mainframe migration. It contains fields for storing user authentication and identification information, including user ID, first name, last name, password, user type, and a filler field. This structure is likely used across multiple programs within the application for user management, authentication, and access control operations."
    },
    {
      "name": "CSLKPCDY",
      "code": "      ******************************************************************\n      *Lookup code repository \n      *       1) North america phone area codes\n      *       2) United States - state codes \n      *       3) United States - state + first 2 of zip   \n      *\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n\n       01 WS-US-PHONE-AREA-CODE-TO-EDIT PIC XXX.\n      ******************************************************************\n      *North America Phone area codes List obtained from North America \n      *Numbering Plan Administrator *nanpa\n      *https://nationalnanpa.com/nanp1/npa_report.csv\n      ******************************************************************\n          88 VALID-PHONE-AREA-CODE VALUES '201',                 \n\t\t                            '202',\n\t\t                            '203',\n\t\t                            '204',\n\t\t                            '205',\n\t\t                            '206',\n\t\t                            '207',\n\t\t                            '208',\n\t\t                            '209',\n\t\t                            '210',\n\t\t                            '212',\n\t\t                            '213',\n\t\t                            '214',\n\t\t                            '215',\n\t\t                            '216',\n\t\t                            '217',\n\t\t                            '218',\n\t\t                            '219',\n\t\t                            '220',\n\t\t                            '223',\n\t\t                            '224',\n\t\t                            '225',\n\t\t                            '226',\n\t\t                            '228',\n\t\t                            '229',\n\t\t                            '231',\n\t\t                            '234',\n\t\t                            '236',\n\t\t                            '239',\n\t\t                            '240',\n\t\t                            '242',\n\t\t                            '246',\n\t\t                            '248',\n\t\t                            '249',\n\t\t                            '250',\n\t\t                            '251',\n\t\t                            '252',\n\t\t                            '253',\n\t\t                            '254',\n\t\t                            '256',\n\t\t                            '260',\n\t\t                            '262',\n\t\t                            '264',\n\t\t                            '267',\n\t\t                            '268',\n\t\t                            '269',\n\t\t                            '270',\n\t\t                            '272',\n\t\t                            '276',\n\t\t                            '279',\n\t\t                            '281',\n\t\t                            '284',\n\t\t                            '289',\n\t\t                            '301',\n\t\t                            '302',\n\t\t                            '303',\n\t\t                            '304',\n\t\t                            '305',\n\t\t                            '306',\n\t\t                            '307',\n\t\t                            '308',\n\t\t                            '309',\n\t\t                            '310',\n\t\t                            '312',\n\t\t                            '313',\n\t\t                            '314',\n\t\t                            '315',\n\t\t                            '316',\n\t\t                            '317',\n\t\t                            '318',\n\t\t                            '319',\n\t\t                            '320',\n\t\t                            '321',\n\t\t                            '323',\n\t\t                            '325',\n\t\t                            '326',\n\t\t                            '330',\n\t\t                            '331',\n\t\t                            '332',\n\t\t                            '334',\n\t\t                            '336',\n\t\t                            '337',\n\t\t                            '339',\n\t\t                            '340',\n\t\t                            '341',\n\t\t                            '343',\n\t\t                            '345',\n\t\t                            '346',\n\t\t                            '347',\n\t\t                            '351',\n\t\t                            '352',\n\t\t                            '360',\n\t\t                            '361',\n\t\t                            '364',\n\t\t                            '365',\n\t\t                            '367',\n\t\t                            '368',\n\t\t                            '380',\n\t\t                            '385',\n\t\t                            '386',\n\t\t                            '401',\n\t\t                            '402',\n\t\t                            '403',\n\t\t                            '404',\n\t\t                            '405',\n\t\t                            '406',\n\t\t                            '407',\n\t\t                            '408',\n\t\t                            '409',\n\t\t                            '410',\n\t\t                            '412',\n\t\t                            '413',\n\t\t                            '414',\n\t\t                            '415',\n\t\t                            '416',\n\t\t                            '417',\n\t\t                            '418',\n\t\t                            '419',\n\t\t                            '423',\n\t\t                            '424',\n\t\t                            '425',\n\t\t                            '430',\n\t\t                            '431',\n\t\t                            '432',\n\t\t                            '434',\n\t\t                            '435',\n\t\t                            '437',\n\t\t                            '438',\n\t\t                            '440',\n\t\t                            '441',\n\t\t                            '442',\n\t\t                            '443',\n\t\t                            '445',\n\t\t                            '447',\n\t\t                            '448',\n\t\t                            '450',\n\t\t                            '458',\n\t\t                            '463',\n\t\t                            '464',\n\t\t                            '469',\n\t\t                            '470',\n\t\t                            '473',\n\t\t                            '474',\n\t\t                            '475',\n\t\t                            '478',\n\t\t                            '479',\n\t\t                            '480',\n\t\t                            '484',\n\t\t                            '501',\n\t\t                            '502',\n\t\t                            '503',\n\t\t                            '504',\n\t\t                            '505',\n\t\t                            '506',\n\t\t                            '507',\n\t\t                            '508',\n\t\t                            '509',\n\t\t                            '510',\n\t\t                            '512',\n\t\t                            '513',\n\t\t                            '514',\n\t\t                            '515',\n\t\t                            '516',\n\t\t                            '517',\n\t\t                            '518',\n\t\t                            '519',\n\t\t                            '520',\n\t\t                            '530',\n\t\t                            '531',\n\t\t                            '534',\n\t\t                            '539',\n\t\t                            '540',\n\t\t                            '541',\n\t\t                            '548',\n\t\t                            '551',\n\t\t                            '559',\n\t\t                            '561',\n\t\t                            '562',\n\t\t                            '563',\n\t\t                            '564',\n\t\t                            '567',\n\t\t                            '570',\n\t\t                            '571',\n\t\t                            '572',\n\t\t                            '573',\n\t\t                            '574',\n\t\t                            '575',\n\t\t                            '579',\n\t\t                            '580',\n\t\t                            '581',\n\t\t                            '582',\n\t\t                            '585',\n\t\t                            '586',\n\t\t                            '587',\n\t\t                            '601',\n\t\t                            '602',\n\t\t                            '603',\n\t\t                            '604',\n\t\t                            '605',\n\t\t                            '606',\n\t\t                            '607',\n\t\t                            '608',\n\t\t                            '609',\n\t\t                            '610',\n\t\t                            '612',\n\t\t                            '613',\n\t\t                            '614',\n\t\t                            '615',\n\t\t                            '616',\n\t\t                            '617',\n\t\t                            '618',\n\t\t                            '619',\n\t\t                            '620',\n\t\t                            '623',\n\t\t                            '626',\n\t\t                            '628',\n\t\t                            '629',\n\t\t                            '630',\n\t\t                            '631',\n\t\t                            '636',\n\t\t                            '639',\n\t\t                            '640',\n\t\t                            '641',\n\t\t                            '646',\n\t\t                            '647',\n\t\t                            '649',\n\t\t                            '650',\n\t\t                            '651',\n\t\t                            '656',\n\t\t                            '657',\n\t\t                            '658',\n\t\t                            '659',\n\t\t                            '660',\n\t\t                            '661',\n\t\t                            '662',\n\t\t                            '664',\n\t\t                            '667',\n\t\t                            '669',\n\t\t                            '670',\n\t\t                            '671',\n\t\t                            '672',\n\t\t                            '678',\n\t\t                            '680',\n\t\t                            '681',\n\t\t                            '682',\n\t\t                            '683',\n\t\t                            '684',\n\t\t                            '689',\n\t\t                            '701',\n\t\t                            '702',\n\t\t                            '703',\n\t\t                            '704',\n\t\t                            '705',\n\t\t                            '706',\n\t\t                            '707',\n\t\t                            '708',\n\t\t                            '709',\n\t\t                            '712',\n\t\t                            '713',\n\t\t                            '714',\n\t\t                            '715',\n\t\t                            '716',\n\t\t                            '717',\n\t\t                            '718',\n\t\t                            '719',\n\t\t                            '720',\n\t\t                            '721',\n\t\t                            '724',\n\t\t                            '725',\n\t\t                            '726',\n\t\t                            '727',\n\t\t                            '731',\n\t\t                            '732',\n\t\t                            '734',\n\t\t                            '737',\n\t\t                            '740',\n\t\t                            '742',\n\t\t                            '743',\n\t\t                            '747',\n\t\t                            '753',\n\t\t                            '754',\n\t\t                            '757',\n\t\t                            '758',\n\t\t                            '760',\n\t\t                            '762',\n\t\t                            '763',\n\t\t                            '765',\n\t\t                            '767',\n\t\t                            '769',\n\t\t                            '770',\n\t\t                            '771',\n\t\t                            '772',\n\t\t                            '773',\n\t\t                            '774',\n\t\t                            '775',\n\t\t                            '778',\n\t\t                            '779',\n\t\t                            '780',\n\t\t                            '781',\n\t\t                            '782',\n\t\t                            '784',\n\t\t                            '785',\n\t\t                            '786',\n\t\t                            '787',\n\t\t                            '801',\n\t\t                            '802',\n\t\t                            '803',\n\t\t                            '804',\n\t\t                            '805',\n\t\t                            '806',\n\t\t                            '807',\n\t\t                            '808',\n\t\t                            '809',\n\t\t                            '810',\n\t\t                            '812',\n\t\t                            '813',\n\t\t                            '814',\n\t\t                            '815',\n\t\t                            '816',\n\t\t                            '817',\n\t\t                            '818',\n\t\t                            '819',\n\t\t                            '820',\n\t\t                            '825',\n\t\t                            '826',\n\t\t                            '828',\n\t\t                            '829',\n\t\t                            '830',\n\t\t                            '831',\n\t\t                            '832',\n\t\t                            '838',\n\t\t                            '839',\n\t\t                            '840',\n\t\t                            '843',\n\t\t                            '845',\n\t\t                            '847',\n\t\t                            '848',\n\t\t                            '849',\n\t\t                            '850',\n\t\t                            '854',\n\t\t                            '856',\n\t\t                            '857',\n\t\t                            '858',\n\t\t                            '859',\n\t\t                            '860',\n\t\t                            '862',\n\t\t                            '863',\n\t\t                            '864',\n\t\t                            '865',\n\t\t                            '867',\n\t\t                            '868',\n\t\t                            '869',\n\t\t                            '870',\n\t\t                            '872',\n\t\t                            '873',\n\t\t                            '876',\n\t\t                            '878',\n\t\t                            '901',\n\t\t                            '902',\n\t\t                            '903',\n\t\t                            '904',\n\t\t                            '905',\n\t\t                            '906',\n\t\t                            '907',\n\t\t                            '908',\n\t\t                            '909',\n\t\t                            '910',\n\t\t                            '912',\n\t\t                            '913',\n\t\t                            '914',\n\t\t                            '915',\n\t\t                            '916',\n\t\t                            '917',\n\t\t                            '918',\n\t\t                            '919',\n\t\t                            '920',\n\t\t                            '925',\n\t\t                            '928',\n\t\t                            '929',\n\t\t                            '930',\n\t\t                            '931',\n\t\t                            '934',\n\t\t                            '936',\n\t\t                            '937',\n\t\t                            '938',\n\t\t                            '939',\n\t\t                            '940',\n\t\t                            '941',\n\t\t                            '943',\n\t\t                            '945',\n\t\t                            '947',\n\t\t                            '948',\n\t\t                            '949',\n\t\t                            '951',\n\t\t                            '952',\n\t\t                            '954',\n\t\t                            '956',\n\t\t                            '959',\n\t\t                            '970',\n\t\t                            '971',\n\t\t                            '972',\n\t\t                            '973',\n\t\t                            '978',\n\t\t                            '979',\n\t\t                            '980',\n\t\t                            '983',\n\t\t                            '984',\n\t\t                            '985',\n\t\t                            '986',\n\t\t                            '989',\n      *Easily recognizable codes begin here.\n\t\t                             '200',\n\t\t                             '211',\n\t\t                             '222',\n\t\t                             '233',\n\t\t                             '244',\n\t\t                             '255',\n\t\t                             '266',\n\t\t                             '277',\n\t\t                             '288',\n\t\t                             '299',\n\t\t                             '300',\n\t\t                             '311',\n\t\t                             '322',\n\t\t                             '333',\n\t\t                             '344',\n\t\t                             '355',\n\t\t                             '366',\n\t\t                             '377',\n\t\t                             '388',\n\t\t                             '399',\n\t\t                             '400',\n\t\t                             '411',\n\t\t                             '422',\n\t\t                             '433',\n\t\t                             '444',\n\t\t                             '455',\n\t\t                             '466',\n\t\t                             '477',\n\t\t                             '488',\n\t\t                             '499',\n\t\t                             '500',\n\t\t                             '511',\n\t\t                             '522',\n\t\t                             '533',\n\t\t                             '544',\n\t\t                             '555',\n\t\t                             '566',\n\t\t                             '577',\n\t\t                             '588',\n\t\t                             '599',\n\t\t                             '600',\n\t\t                             '611',\n\t\t                             '622',\n\t\t                             '633',\n\t\t                             '644',\n\t\t                             '655',\n\t\t                             '666',\n\t\t                             '677',\n\t\t                             '688',\n\t\t                             '699',\n\t\t                             '700',\n\t\t                             '711',\n\t\t                             '722',\n\t\t                             '733',\n\t\t                             '744',\n\t\t                             '755',\n\t\t                             '766',\n\t\t                             '777',\n\t\t                             '788',\n\t\t                             '799',\n\t\t                             '800',\n\t\t                             '811',\n\t\t                             '822',\n\t\t                             '833',\n\t\t                             '844',\n\t\t                             '855',\n\t\t                             '866',\n\t\t                             '877',\n\t\t                             '888',\n\t\t                             '899',\n\t\t                             '900',\n\t\t                             '911',\n\t\t                             '922',\n\t\t                             '933',\n\t\t                             '944',\n\t\t                             '955',\n\t\t                             '966',\n\t\t                             '977',\n\t\t                             '988',\n\t\t                             '999'.\n          88 VALID-GENERAL-PURP-CODE VALUES '201',        \n\t\t                            '202',\n\t\t                            '203',\n\t\t                            '204',\n\t\t                            '205',\n\t\t                            '206',\n\t\t                            '207',\n\t\t                            '208',\n\t\t                            '209',\n\t\t                            '210',\n\t\t                            '212',\n\t\t                            '213',\n\t\t                            '214',\n\t\t                            '215',\n\t\t                            '216',\n\t\t                            '217',\n\t\t                            '218',\n\t\t                            '219',\n\t\t                            '220',\n\t\t                            '223',\n\t\t                            '224',\n\t\t                            '225',\n\t\t                            '226',\n\t\t                            '228',\n\t\t                            '229',\n\t\t                            '231',\n\t\t                            '234',\n\t\t                            '236',\n\t\t                            '239',\n\t\t                            '240',\n\t\t                            '242',\n\t\t                            '246',\n\t\t                            '248',\n\t\t                            '249',\n\t\t                            '250',\n\t\t                            '251',\n\t\t                            '252',\n\t\t                            '253',\n\t\t                            '254',\n\t\t                            '256',\n\t\t                            '260',\n\t\t                            '262',\n\t\t                            '264',\n\t\t                            '267',\n\t\t                            '268',\n\t\t                            '269',\n\t\t                            '270',\n\t\t                            '272',\n\t\t                            '276',\n\t\t                            '279',\n\t\t                            '281',\n\t\t                            '284',\n\t\t                            '289',\n\t\t                            '301',\n\t\t                            '302',\n\t\t                            '303',\n\t\t                            '304',\n\t\t                            '305',\n\t\t                            '306',\n\t\t                            '307',\n\t\t                            '308',\n\t\t                            '309',\n\t\t                            '310',\n\t\t                            '312',\n\t\t                            '313',\n\t\t                            '314',\n\t\t                            '315',\n\t\t                            '316',\n\t\t                            '317',\n\t\t                            '318',\n\t\t                            '319',\n\t\t                            '320',\n\t\t                            '321',\n\t\t                            '323',\n\t\t                            '325',\n\t\t                            '326',\n\t\t                            '330',\n\t\t                            '331',\n\t\t                            '332',\n\t\t                            '334',\n\t\t                            '336',\n\t\t                            '337',\n\t\t                            '339',\n\t\t                            '340',\n\t\t                            '341',\n\t\t                            '343',\n\t\t                            '345',\n\t\t                            '346',\n\t\t                            '347',\n\t\t                            '351',\n\t\t                            '352',\n\t\t                            '360',\n\t\t                            '361',\n\t\t                            '364',\n\t\t                            '365',\n\t\t                            '367',\n\t\t                            '368',\n\t\t                            '380',\n\t\t                            '385',\n\t\t                            '386',\n\t\t                            '401',\n\t\t                            '402',\n\t\t                            '403',\n\t\t                            '404',\n\t\t                            '405',\n\t\t                            '406',\n\t\t                            '407',\n\t\t                            '408',\n\t\t                            '409',\n\t\t                            '410',\n\t\t                            '412',\n\t\t                            '413',\n\t\t                            '414',\n\t\t                            '415',\n\t\t                            '416',\n\t\t                            '417',\n\t\t                            '418',\n\t\t                            '419',\n\t\t                            '423',\n\t\t                            '424',\n\t\t                            '425',\n\t\t                            '430',\n\t\t                            '431',\n\t\t                            '432',\n\t\t                            '434',\n\t\t                            '435',\n\t\t                            '437',\n\t\t                            '438',\n\t\t                            '440',\n\t\t                            '441',\n\t\t                            '442',\n\t\t                            '443',\n\t\t                            '445',\n\t\t                            '447',\n\t\t                            '448',\n\t\t                            '450',\n\t\t                            '458',\n\t\t                            '463',\n\t\t                            '464',\n\t\t                            '469',\n\t\t                            '470',\n\t\t                            '473',\n\t\t                            '474',\n\t\t                            '475',\n\t\t                            '478',\n\t\t                            '479',\n\t\t                            '480',\n\t\t                            '484',\n\t\t                            '501',\n\t\t                            '502',\n\t\t                            '503',\n\t\t                            '504',\n\t\t                            '505',\n\t\t                            '506',\n\t\t                            '507',\n\t\t                            '508',\n\t\t                            '509',\n\t\t                            '510',\n\t\t                            '512',\n\t\t                            '513',\n\t\t                            '514',\n\t\t                            '515',\n\t\t                            '516',\n\t\t                            '517',\n\t\t                            '518',\n\t\t                            '519',\n\t\t                            '520',\n\t\t                            '530',\n\t\t                            '531',\n\t\t                            '534',\n\t\t                            '539',\n\t\t                            '540',\n\t\t                            '541',\n\t\t                            '548',\n\t\t                            '551',\n\t\t                            '559',\n\t\t                            '561',\n\t\t                            '562',\n\t\t                            '563',\n\t\t                            '564',\n\t\t                            '567',\n\t\t                            '570',\n\t\t                            '571',\n\t\t                            '572',\n\t\t                            '573',\n\t\t                            '574',\n\t\t                            '575',\n\t\t                            '579',\n\t\t                            '580',\n\t\t                            '581',\n\t\t                            '582',\n\t\t                            '585',\n\t\t                            '586',\n\t\t                            '587',\n\t\t                            '601',\n\t\t                            '602',\n\t\t                            '603',\n\t\t                            '604',\n\t\t                            '605',\n\t\t                            '606',\n\t\t                            '607',\n\t\t                            '608',\n\t\t                            '609',\n\t\t                            '610',\n\t\t                            '612',\n\t\t                            '613',\n\t\t                            '614',\n\t\t                            '615',\n\t\t                            '616',\n\t\t                            '617',\n\t\t                            '618',\n\t\t                            '619',\n\t\t                            '620',\n\t\t                            '623',\n\t\t                            '626',\n\t\t                            '628',\n\t\t                            '629',\n\t\t                            '630',\n\t\t                            '631',\n\t\t                            '636',\n\t\t                            '639',\n\t\t                            '640',\n\t\t                            '641',\n\t\t                            '646',\n\t\t                            '647',\n\t\t                            '649',\n\t\t                            '650',\n\t\t                            '651',\n\t\t                            '656',\n\t\t                            '657',\n\t\t                            '658',\n\t\t                            '659',\n\t\t                            '660',\n\t\t                            '661',\n\t\t                            '662',\n\t\t                            '664',\n\t\t                            '667',\n\t\t                            '669',\n\t\t                            '670',\n\t\t                            '671',\n\t\t                            '672',\n\t\t                            '678',\n\t\t                            '680',\n\t\t                            '681',\n\t\t                            '682',\n\t\t                            '683',\n\t\t                            '684',\n\t\t                            '689',\n\t\t                            '701',\n\t\t                            '702',\n\t\t                            '703',\n\t\t                            '704',\n\t\t                            '705',\n\t\t                            '706',\n\t\t                            '707',\n\t\t                            '708',\n\t\t                            '709',\n\t\t                            '712',\n\t\t                            '713',\n\t\t                            '714',\n\t\t                            '715',\n\t\t                            '716',\n\t\t                            '717',\n\t\t                            '718',\n\t\t                            '719',\n\t\t                            '720',\n\t\t                            '721',\n\t\t                            '724',\n\t\t                            '725',\n\t\t                            '726',\n\t\t                            '727',\n\t\t                            '731',\n\t\t                            '732',\n\t\t                            '734',\n\t\t                            '737',\n\t\t                            '740',\n\t\t                            '742',\n\t\t                            '743',\n\t\t                            '747',\n\t\t                            '753',\n\t\t                            '754',\n\t\t                            '757',\n\t\t                            '758',\n\t\t                            '760',\n\t\t                            '762',\n\t\t                            '763',\n\t\t                            '765',\n\t\t                            '767',\n\t\t                            '769',\n\t\t                            '770',\n\t\t                            '771',\n\t\t                            '772',\n\t\t                            '773',\n\t\t                            '774',\n\t\t                            '775',\n\t\t                            '778',\n\t\t                            '779',\n\t\t                            '780',\n\t\t                            '781',\n\t\t                            '782',\n\t\t                            '784',\n\t\t                            '785',\n\t\t                            '786',\n\t\t                            '787',\n\t\t                            '801',\n\t\t                            '802',\n\t\t                            '803',\n\t\t                            '804',\n\t\t                            '805',\n\t\t                            '806',\n\t\t                            '807',\n\t\t                            '808',\n\t\t                            '809',\n\t\t                            '810',\n\t\t                            '812',\n\t\t                            '813',\n\t\t                            '814',\n\t\t                            '815',\n\t\t                            '816',\n\t\t                            '817',\n\t\t                            '818',\n\t\t                            '819',\n\t\t                            '820',\n\t\t                            '825',\n\t\t                            '826',\n\t\t                            '828',\n\t\t                            '829',\n\t\t                            '830',\n\t\t                            '831',\n\t\t                            '832',\n\t\t                            '838',\n\t\t                            '839',\n\t\t                            '840',\n\t\t                            '843',\n\t\t                            '845',\n\t\t                            '847',\n\t\t                            '848',\n\t\t                            '849',\n\t\t                            '850',\n\t\t                            '854',\n\t\t                            '856',\n\t\t                            '857',\n\t\t                            '858',\n\t\t                            '859',\n\t\t                            '860',\n\t\t                            '862',\n\t\t                            '863',\n\t\t                            '864',\n\t\t                            '865',\n\t\t                            '867',\n\t\t                            '868',\n\t\t                            '869',\n\t\t                            '870',\n\t\t                            '872',\n\t\t                            '873',\n\t\t                            '876',\n\t\t                            '878',\n\t\t                            '901',\n\t\t                            '902',\n\t\t                            '903',\n\t\t                            '904',\n\t\t                            '905',\n\t\t                            '906',\n\t\t                            '907',\n\t\t                            '908',\n\t\t                            '909',\n\t\t                            '910',\n\t\t                            '912',\n\t\t                            '913',\n\t\t                            '914',\n\t\t                            '915',\n\t\t                            '916',\n\t\t                            '917',\n\t\t                            '918',\n\t\t                            '919',\n\t\t                            '920',\n\t\t                            '925',\n\t\t                            '928',\n\t\t                            '929',\n\t\t                            '930',\n\t\t                            '931',\n\t\t                            '934',\n\t\t                            '936',\n\t\t                            '937',\n\t\t                            '938',\n\t\t                            '939',\n\t\t                            '940',\n\t\t                            '941',\n\t\t                            '943',\n\t\t                            '945',\n\t\t                            '947',\n\t\t                            '948',\n\t\t                            '949',\n\t\t                            '951',\n\t\t                            '952',\n\t\t                            '954',\n\t\t                            '956',\n\t\t                            '959',\n\t\t                            '970',\n\t\t                            '971',\n\t\t                            '972',\n\t\t                            '973',\n\t\t                            '978',\n\t\t                            '979',\n\t\t                            '980',\n\t\t                            '983',\n\t\t                            '984',\n\t\t                            '985',\n\t\t                            '986',\n\t\t                            '989'.\n          88 VALID-EASY-RECOG-AREA-CODE VALUES  '200',\n\t\t                             '211',\n\t\t                             '222',\n\t\t                             '233',\n\t\t                             '244',\n\t\t                             '255',\n\t\t                             '266',\n\t\t                             '277',\n\t\t                             '288',\n\t\t                             '299',\n\t\t                             '300',\n\t\t                             '311',\n\t\t                             '322',\n\t\t                             '333',\n\t\t                             '344',\n\t\t                             '355',\n\t\t                             '366',\n\t\t                             '377',\n\t\t                             '388',\n\t\t                             '399',\n\t\t                             '400',\n\t\t                             '411',\n\t\t                             '422',\n\t\t                             '433',\n\t\t                             '444',\n\t\t                             '455',\n\t\t                             '466',\n\t\t                             '477',\n\t\t                             '488',\n\t\t                             '499',\n\t\t                             '500',\n\t\t                             '511',\n\t\t                             '522',\n\t\t                             '533',\n\t\t                             '544',\n\t\t                             '555',\n\t\t                             '566',\n\t\t                             '577',\n\t\t                             '588',\n\t\t                             '599',\n\t\t                             '600',\n\t\t                             '611',\n\t\t                             '622',\n\t\t                             '633',\n\t\t                             '644',\n\t\t                             '655',\n\t\t                             '666',\n\t\t                             '677',\n\t\t                             '688',\n\t\t                             '699',\n\t\t                             '700',\n\t\t                             '711',\n\t\t                             '722',\n\t\t                             '733',\n\t\t                             '744',\n\t\t                             '755',\n\t\t                             '766',\n\t\t                             '777',\n\t\t                             '788',\n\t\t                             '799',\n\t\t                             '800',\n\t\t                             '811',\n\t\t                             '822',\n\t\t                             '833',\n\t\t                             '844',\n\t\t                             '855',\n\t\t                             '866',\n\t\t                             '877',\n\t\t                             '888',\n\t\t                             '899',\n\t\t                             '900',\n\t\t                             '911',\n\t\t                             '922',\n\t\t                             '933',\n\t\t                             '944',\n\t\t                             '955',\n\t\t                             '966',\n\t\t                             '977',\n\t\t                             '988',\n\t\t                             '999'.\n      *Search list of valid Phone area codes\n       01 US-STATE-CODE-TO-EDIT  PIC X(2).\n          88 VALID-US-STATE-CODE VALUES \n \t\t                            'AL',\n \t\t                            'AK',\n \t\t                            'AZ',\n \t\t                            'AR',\n \t\t                            'CA',\n \t\t                            'CO',\n \t\t                            'CT',\n \t\t                            'DE',\n \t\t                            'FL',\n \t\t                            'GA',\n \t\t                            'HI',\n \t\t                            'ID',\n \t\t                            'IL',\n \t\t                            'IN',\n \t\t                            'IA',\n \t\t                            'KS',\n \t\t                            'KY',\n \t\t                            'LA',\n \t\t                            'ME',\n \t\t                            'MD',\n \t\t                            'MA',\n \t\t                            'MI',\n \t\t                            'MN',\n \t\t                            'MS',\n \t\t                            'MO',\n \t\t                            'MT',\n \t\t                            'NE',\n \t\t                            'NV',\n \t\t                            'NH',\n \t\t                            'NJ',\n \t\t                            'NM',\n \t\t                            'NY',\n \t\t                            'NC',\n \t\t                            'ND',\n \t\t                            'OH',\n \t\t                            'OK',\n \t\t                            'OR',\n \t\t                            'PA',\n \t\t                            'RI',\n \t\t                            'SC',\n \t\t                            'SD',\n \t\t                            'TN',\n \t\t                            'TX',\n \t\t                            'UT',\n \t\t                            'VT',\n \t\t                            'VA',\n \t\t                            'WA',\n \t\t                            'WV',\n \t\t                            'WI',\n \t\t                            'WY',\n \t\t                            'DC',\n \t\t                            'AS',\n \t\t                            'GU',\n \t\t                            'MP',\n \t\t                            'PR',\n \t\t                            'VI'.\n      *State Zip Code Combinations\n       01 US-STATE-ZIPCODE-TO-EDIT.\n          02 US-STATE-AND-FIRST-ZIP2 PIC X(4).\n             88 VALID-US-STATE-ZIP-CD2-COMBO VALUES\n                                    'AA34',\n                                    'AE90',\n                                    'AE91',\n                                    'AE92',\n                                    'AE93',\n                                    'AE94',\n                                    'AE95',\n                                    'AE96',\n                                    'AE97',\n                                    'AE98',\n                                    'AK99',\n                                    'AL35',\n                                    'AL36',\n                                    'AP96',\n                                    'AR71',\n                                    'AR72',\n                                    'AS96',\n                                    'AZ85',\n                                    'AZ86',\n                                    'CA90',\n                                    'CA91',\n                                    'CA92',\n                                    'CA93',\n                                    'CA94',\n                                    'CA95',\n                                    'CA96',\n                                    'CO80',\n                                    'CO81',\n                                    'CT60',\n                                    'CT61',\n                                    'CT62',\n                                    'CT63',\n                                    'CT64',\n                                    'CT65',\n                                    'CT66',\n                                    'CT67',\n                                    'CT68',\n                                    'CT69',\n                                    'DC20',\n                                    'DC56',\n                                    'DC88',\n                                    'DE19',\n                                    'FL32',\n                                    'FL33',\n                                    'FL34',\n                                    'FM96',\n                                    'GA30',\n                                    'GA31',\n                                    'GA39',\n                                    'GU96',\n                                    'HI96',\n                                    'IA50',\n                                    'IA51',\n                                    'IA52',\n                                    'ID83',\n                                    'IL60',\n                                    'IL61',\n                                    'IL62',\n                                    'IN46',\n                                    'IN47',\n                                    'KS66',\n                                    'KS67',\n                                    'KY40',\n                                    'KY41',\n                                    'KY42',\n                                    'LA70',\n                                    'LA71',\n                                    'MA10',\n                                    'MA11',\n                                    'MA12',\n                                    'MA13',\n                                    'MA14',\n                                    'MA15',\n                                    'MA16',\n                                    'MA17',\n                                    'MA18',\n                                    'MA19',\n                                    'MA20',\n                                    'MA21',\n                                    'MA22',\n                                    'MA23',\n                                    'MA24',\n                                    'MA25',\n                                    'MA26',\n                                    'MA27',\n                                    'MA55',\n                                    'MD20',\n                                    'MD21',\n                                    'ME39',\n                                    'ME40',\n                                    'ME41',\n                                    'ME42',\n                                    'ME43',\n                                    'ME44',\n                                    'ME45',\n                                    'ME46',\n                                    'ME47',\n                                    'ME48',\n                                    'ME49',\n                                    'MH96',\n                                    'MI48',\n                                    'MI49',\n                                    'MN55',\n                                    'MN56',\n                                    'MO63',\n                                    'MO64',\n                                    'MO65',\n                                    'MO72',\n                                    'MP96',\n                                    'MS38',\n                                    'MS39',\n                                    'MT59',\n                                    'NC27',\n                                    'NC28',\n                                    'ND58',\n                                    'NE68',\n                                    'NE69',\n                                    'NH30',\n                                    'NH31',\n                                    'NH32',\n                                    'NH33',\n                                    'NH34',\n                                    'NH35',\n                                    'NH36',\n                                    'NH37',\n                                    'NH38',\n                                    'NJ70',\n                                    'NJ71',\n                                    'NJ72',\n                                    'NJ73',\n                                    'NJ74',\n                                    'NJ75',\n                                    'NJ76',\n                                    'NJ77',\n                                    'NJ78',\n                                    'NJ79',\n                                    'NJ80',\n                                    'NJ81',\n                                    'NJ82',\n                                    'NJ83',\n                                    'NJ84',\n                                    'NJ85',\n                                    'NJ86',\n                                    'NJ87',\n                                    'NJ88',\n                                    'NJ89',\n                                    'NM87',\n                                    'NM88',\n                                    'NV88',\n                                    'NV89',\n                                    'NY50',\n                                    'NY54',\n                                    'NY63',\n                                    'NY10',\n                                    'NY11',\n                                    'NY12',\n                                    'NY13',\n                                    'NY14',\n                                    'OH43',\n                                    'OH44',\n                                    'OH45',\n                                    'OK73',\n                                    'OK74',\n                                    'OR97',\n                                    'PA15',\n                                    'PA16',\n                                    'PA17',\n                                    'PA18',\n                                    'PA19',\n                                    'PR60',\n                                    'PR61',\n                                    'PR62',\n                                    'PR63',\n                                    'PR64',\n                                    'PR65',\n                                    'PR66',\n                                    'PR67',\n                                    'PR68',\n                                    'PR69',\n                                    'PR70',\n                                    'PR71',\n                                    'PR72',\n                                    'PR73',\n                                    'PR74',\n                                    'PR75',\n                                    'PR76',\n                                    'PR77',\n                                    'PR78',\n                                    'PR79',\n                                    'PR90',\n                                    'PR91',\n                                    'PR92',\n                                    'PR93',\n                                    'PR94',\n                                    'PR95',\n                                    'PR96',\n                                    'PR97',\n                                    'PR98',\n                                    'PW96',\n                                    'RI28',\n                                    'RI29',\n                                    'SC29',\n                                    'SD57',\n                                    'TN37',\n                                    'TN38',\n                                    'TX73',\n                                    'TX75',\n                                    'TX76',\n                                    'TX77',\n                                    'TX78',\n                                    'TX79',\n                                    'TX88',\n                                    'UT84',\n                                    'VA20',\n                                    'VA22',\n                                    'VA23',\n                                    'VA24',\n                                    'VI80',\n                                    'VI82',\n                                    'VI83',\n                                    'VI84',\n                                    'VI85',\n                                    'VT50',\n                                    'VT51',\n                                    'VT52',\n                                    'VT53',\n                                    'VT54',\n                                    'VT56',\n                                    'VT57',\n                                    'VT58',\n                                    'VT59',\n                                    'WA98',\n                                    'WA99',\n                                    'WI53',\n                                    'WI54',\n                                    'WV24',\n                                    'WV25',\n                                    'WV26',\n                                    'WY82',\n                                    'WY83'.\n          02 LAST-3-OF-ZIP           PIC X(3).\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT\n      *\n\n",
      "description": "This copybook serves as a lookup code repository for validating various geographic codes in North America. It contains three main validation structures:\n\n1. North American phone area codes - Defines a field WS-US-PHONE-AREA-CODE-TO-EDIT with condition names that validate telephone area codes. It includes both standard area codes sourced from the North American Numbering Plan Administrator (NANPA) and easily recognizable patterns (like 222, 333, etc.).\n\n2. US state codes - Defines US-STATE-CODE-TO-EDIT with a condition name VALID-US-STATE-CODE that validates standard two-letter state and territory codes (like AL, CA, NY).\n\n3. State-ZIP code combinations - Defines US-STATE-ZIPCODE-TO-EDIT which validates combinations of state codes with the first two digits of ZIP codes, ensuring geographic consistency between states and their associated postal codes.\n\nThe copybook is designed to be included in programs that need to validate geographic data entry, particularly for customer information processing in the CardDemo application."
    },
    {
      "name": "CVACT03Y",
      "code": "      *****************************************************************         \n      *    Data-structure for card xref (RECLN 50)                              \n      *****************************************************************         \n       01 CARD-XREF-RECORD.                                                     \n           05  XREF-CARD-NUM                     PIC X(16).                     \n           05  XREF-CUST-ID                      PIC 9(09).                     \n           05  XREF-ACCT-ID                      PIC 9(11).                     \n           05  FILLER                            PIC X(14).                     \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines the data structure for a card cross-reference record with a record length of 50 bytes. It establishes the relationship between a payment card, customer, and account within the CardDemo application. The structure contains three key fields: a 16-character card number, a 9-digit customer ID, and an 11-digit account ID, followed by 14 bytes of unused filler space. This cross-reference structure enables the application to link card information with the appropriate customer and account records."
    },
    {
      "name": "CSSETATY",
      "code": "      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n      *    Set (TESTVAR1) to red if in error and * if blankACSHLIM\n           IF (FLG-(TESTVAR1)-NOT-OK                                 \n           OR  FLG-(TESTVAR1)-BLANK)                                    \n           AND CDEMO-PGM-REENTER                                        \n               MOVE DFHRED             TO \n                    (SCRNVAR2)C OF (MAPNAME3)O\n               IF  FLG-(TESTVAR1)-BLANK                                 \n                   MOVE '*'            TO \n                    (SCRNVAR2)O OF (MAPNAME3)O\n               END-IF                                                   \n           END-IF \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT\n      *\n",
      "description": "This copybook contains a reusable code snippet for handling field validation and error highlighting in a CICS screen interface. It sets visual attributes for fields that fail validation by changing the color to red and marking blank fields with an asterisk (*) when the program is being re-entered. This standardized error handling approach is likely used across multiple screens in the CardDemo application to provide consistent user feedback for input validation errors."
    },
    {
      "name": "CVTRA06Y",
      "code": "      *****************************************************************         \n      *    Data-structure for DALYTRANsaction record (RECLN = 350)              \n      *****************************************************************         \n       01  DALYTRAN-RECORD.                                                     \n           05  DALYTRAN-ID                             PIC X(16).               \n           05  DALYTRAN-TYPE-CD                        PIC X(02).               \n           05  DALYTRAN-CAT-CD                         PIC 9(04).               \n           05  DALYTRAN-SOURCE                         PIC X(10).               \n           05  DALYTRAN-DESC                           PIC X(100).              \n           05  DALYTRAN-AMT                            PIC S9(09)V99.           \n           05  DALYTRAN-MERCHANT-ID                    PIC 9(09).               \n           05  DALYTRAN-MERCHANT-NAME                  PIC X(50).               \n           05  DALYTRAN-MERCHANT-CITY                  PIC X(50).               \n           05  DALYTRAN-MERCHANT-ZIP                   PIC X(10).               \n           05  DALYTRAN-CARD-NUM                       PIC X(16).               \n           05  DALYTRAN-ORIG-TS                        PIC X(26).               \n           05  DALYTRAN-PROC-TS                        PIC X(26).               \n           05  FILLER                                  PIC X(20).       \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT\n      *\n",
      "description": "This copybook defines the data structure for a daily transaction record (DALYTRAN-RECORD) with a record length of 350 bytes. It captures comprehensive transaction information for card payments including transaction identification, categorization, financial details, merchant information, and timestamps. Key fields include the transaction ID, type code, category code, amount, merchant details (ID, name, city, ZIP), card number, and both origination and processing timestamps. This structure is likely used across multiple programs in the CardDemo application for processing, storing, and reporting on card transactions."
    },
    {
      "name": "CVTRA05Y",
      "code": "      *****************************************************************         \n      *    Data-structure for TRANsaction record (RECLN = 350)                  \n      *****************************************************************         \n       01  TRAN-RECORD.                                                         \n           05  TRAN-ID                                 PIC X(16).               \n           05  TRAN-TYPE-CD                            PIC X(02).               \n           05  TRAN-CAT-CD                             PIC 9(04).               \n           05  TRAN-SOURCE                             PIC X(10).               \n           05  TRAN-DESC                               PIC X(100).              \n           05  TRAN-AMT                                PIC S9(09)V99.           \n           05  TRAN-MERCHANT-ID                        PIC 9(09).               \n           05  TRAN-MERCHANT-NAME                      PIC X(50).               \n           05  TRAN-MERCHANT-CITY                      PIC X(50).               \n           05  TRAN-MERCHANT-ZIP                       PIC X(10).               \n           05  TRAN-CARD-NUM                           PIC X(16).               \n           05  TRAN-ORIG-TS                            PIC X(26).               \n           05  TRAN-PROC-TS                            PIC X(26).               \n           05  FILLER                                  PIC X(20).               \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT\n      *\n",
      "description": "This copybook defines the data structure for transaction records with a record length of 350 bytes. It contains fields for storing transaction details including identification, type, amount, merchant information, and timestamps. Key fields include transaction ID, type code, category code, amount, merchant details (ID, name, city, ZIP), card number, and timestamps for both transaction origin and processing. This structure is likely used throughout the CardDemo application for processing and storing credit card transaction data in various programs that handle transaction processing, reporting, or analysis."
    },
    {
      "name": "COMEN02Y",
      "code": "      ******************************************************************\n      * CardDemo - Admin Menu Options\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 CARDDEMO-MAIN-MENU-OPTIONS.\n\n         05 CDEMO-MENU-OPT-COUNT           PIC 9(02) VALUE 10.\n\n         05 CDEMO-MENU-OPTIONS-DATA.\n\n           10 FILLER                       PIC 9(02) VALUE 1.\n           10 FILLER                       PIC X(35) VALUE\n               'Account View                       '.\n           10 FILLER                       PIC X(08) VALUE 'COACTVWC'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 2.\n           10 FILLER                       PIC X(35) VALUE\n               'Account Update                     '.\n           10 FILLER                       PIC X(08) VALUE 'COACTUPC'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 3.\n           10 FILLER                       PIC X(35) VALUE\n               'Credit Card List                   '.\n           10 FILLER                       PIC X(08) VALUE 'COCRDLIC'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 4.\n           10 FILLER                       PIC X(35) VALUE\n               'Credit Card View                   '.\n           10 FILLER                       PIC X(08) VALUE 'COCRDSLC'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 5.\n           10 FILLER                       PIC X(35) VALUE\n               'Credit Card Update                 '.\n           10 FILLER                       PIC X(08) VALUE 'COCRDUPC'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 6.\n           10 FILLER                       PIC X(35) VALUE\n               'Transaction List                   '.\n           10 FILLER                       PIC X(08) VALUE 'COTRN00C'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 7.\n           10 FILLER                       PIC X(35) VALUE\n               'Transaction View                   '.\n           10 FILLER                       PIC X(08) VALUE 'COTRN01C'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                        PIC 9(02) VALUE 8.\n           10 FILLER                       PIC X(35) VALUE\n      *        'Transaction Add (Admin Only)       '.\n               'Transaction Add                    '.\n           10 FILLER                       PIC X(08) VALUE 'COTRN02C'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 9.\n           10 FILLER                       PIC X(35) VALUE\n               'Transaction Reports                '.\n           10 FILLER                       PIC X(08) VALUE 'CORPT00C'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n           10 FILLER                       PIC 9(02) VALUE 10.\n           10 FILLER                       PIC X(35) VALUE\n               'Bill Payment                       '.\n           10 FILLER                       PIC X(08) VALUE 'COBIL00C'.\n           10 FILLER                       PIC X(01) VALUE 'U'.\n\n\n         05 CDEMO-MENU-OPTIONS REDEFINES CDEMO-MENU-OPTIONS-DATA.\n           10 CDEMO-MENU-OPT OCCURS 12 TIMES.\n             15 CDEMO-MENU-OPT-NUM           PIC 9(02).\n             15 CDEMO-MENU-OPT-NAME          PIC X(35).\n             15 CDEMO-MENU-OPT-PGMNAME       PIC X(08).\n             15 CDEMO-MENU-OPT-USRTYPE       PIC X(01).\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT\n      *\n",
      "description": "This copybook defines the menu structure for the CardDemo application's admin interface. It contains a data structure that holds 10 menu options, each with a number, description, program name, and user type indicator. The menu options provide access to various card management functions including account viewing and updating, credit card operations, transaction management, reporting, and bill payment. The structure is designed to be easily referenced by programs that need to display or process the admin menu, with a redefined area that allows accessing each option as an array element."
    },
    {
      "name": "CVTRA02Y",
      "code": "      *****************************************************************         \n      *    Data-structure for disclosure group (RECLN = 50)                     \n      *****************************************************************         \n       01  DIS-GROUP-RECORD.                                                    \n           05  DIS-GROUP-KEY.                                                   \n              10 DIS-ACCT-GROUP-ID                     PIC X(10).               \n              10 DIS-TRAN-TYPE-CD                      PIC X(02).               \n              10 DIS-TRAN-CAT-CD                       PIC 9(04).               \n           05  DIS-INT-RATE                            PIC S9(04)V99.           \n           05  FILLER                                  PIC X(28).               \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines a data structure for a disclosure group record with a fixed length of 50 bytes. It contains fields for account group identification, transaction type and category codes, and an interest rate. The structure is likely used in the CardDemo application for processing or storing transaction-related disclosure information, possibly for regulatory compliance or customer notification purposes. The key fields form a composite identifier for different types of disclosures, while the interest rate field allows for signed values with four digits before and two digits after the decimal point."
    },
    {
      "name": "CSUTLDPY",
      "code": "      ******************************************************************\n      *Procedure Division Copybook for DATE related code\n      ******************************************************************\n      *Date validation paragraph for reuse and hopefully not misuse\n      *Accompanying WORKING Storage is CSUTLDTR\n      ******************************************************************\n      * ***  PERFORM EDIT-DATE-CCYYMMDD\n      *         THRU EDIT-DATE-CCYYMMDD-EXIT\n      *         to validate CCYYMMDD dates\n      *      Reusable paras\n      *      a) EDIT-YEAR-CCYY\n      *      b) EDIT-MONTH\n      *      c) EDIT-DAY\n      *      d) EDIT-DATE-OF-BIRTH\n      *      e) EDIT-DATE-OF-BIRTH\n      ******************************************************************\n\n       EDIT-DATE-CCYYMMDD.\n           SET WS-EDIT-DATE-IS-INVALID   TO TRUE\n           .\n\n      ******************************************************************\n      *Check for valid year and century\n      ******************************************************************\n       EDIT-YEAR-CCYY.\n\n           SET FLG-YEAR-NOT-OK             TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-DATE-CCYY            EQUAL LOW-VALUES\n           OR WS-EDIT-DATE-CCYY            EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-YEAR-BLANK          TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' : Year must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n      *       Intentional violation of structured programming norms\n              GO TO EDIT-YEAR-CCYY-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Not numeric\n           IF WS-EDIT-DATE-CCYY            IS NOT NUMERIC\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-YEAR-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' must be 4 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-YEAR-CCYY-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      ******************************************************************\n      *    Century not reasonable\n      ******************************************************************\n      *  Not having learnt our lesson from history and Y2K\n      *  And being unable to imagine COBOL in the 2100s\n      *  We code only 19 and 20 as valid century values\n      ******************************************************************\n           IF THIS-CENTURY\n           OR LAST-CENTURY\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-YEAR-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' : Century is not valid.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-YEAR-CCYY-EXIT\n           END-IF\n\n           SET FLG-YEAR-ISVALID            TO TRUE\n           .\n       EDIT-YEAR-CCYY-EXIT.\n           EXIT\n           .\n       EDIT-MONTH.\n           SET FLG-MONTH-NOT-OK            TO TRUE\n\n           IF WS-EDIT-DATE-MM              EQUAL LOW-VALUES\n           OR WS-EDIT-DATE-MM              EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-MONTH-BLANK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' : Month must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-MONTH-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Month not reasonable\n           IF WS-VALID-MONTH\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-MONTH-NOT-OK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Month must be a number between 1 and 12.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-MONTH-EXIT\n           END-IF\n\n           IF FUNCTION TEST-NUMVAL (WS-EDIT-DATE-MM) = 0\n              COMPUTE WS-EDIT-DATE-MM-N\n                          = FUNCTION NUMVAL (WS-EDIT-DATE-MM)\n              END-COMPUTE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-MONTH-NOT-OK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ': Month must be a number between 1 and 12.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-MONTH-EXIT\n           END-IF\n\n           SET FLG-MONTH-ISVALID           TO TRUE\n           .\n       EDIT-MONTH-EXIT.\n           EXIT\n           .\n\n\n       EDIT-DAY.\n\n           SET FLG-DAY-ISVALID             TO TRUE\n\n           IF WS-EDIT-DATE-DD              EQUAL LOW-VALUES\n           OR WS-EDIT-DATE-DD              EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-DAY-BLANK           TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ' : Day must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DAY-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF FUNCTION TEST-NUMVAL (WS-EDIT-DATE-DD) = 0\n              COMPUTE WS-EDIT-DATE-DD-N\n                          = FUNCTION NUMVAL (WS-EDIT-DATE-DD)\n              END-COMPUTE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-DAY-NOT-OK          TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ':day must be a number between 1 and 31.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DAY-EXIT\n           END-IF\n\n           IF WS-VALID-DAY\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-DAY-NOT-OK          TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ':day must be a number between 1 and 31.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DAY-EXIT\n           END-IF\n           .\n\n           SET FLG-DAY-ISVALID           TO TRUE\n           .\n       EDIT-DAY-EXIT.\n           EXIT\n           .\n\n       EDIT-DAY-MONTH-YEAR.\n      ******************************************************************\n      *    Checking for any other combinations\n      ******************************************************************\n           IF  NOT WS-31-DAY-MONTH\n           AND WS-DAY-31\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-DAY-NOT-OK           TO TRUE\n              SET FLG-MONTH-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ':Cannot have 31 days in this month.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DATE-CCYYMMDD-EXIT\n           END-IF\n\n           IF  WS-FEBRUARY\n           AND WS-DAY-30\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-DAY-NOT-OK           TO TRUE\n              SET FLG-MONTH-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ':Cannot have 30 days in this month.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DATE-CCYYMMDD-EXIT\n           END-IF\n\n           IF  WS-FEBRUARY\n           AND WS-DAY-29\n               IF WS-EDIT-DATE-YY-N = 0\n                  MOVE 400                TO  WS-DIV-BY\n               ELSE\n                  MOVE 4                  TO  WS-DIV-BY\n               END-IF\n\n               DIVIDE WS-EDIT-DATE-CCYY-N\n                   BY WS-DIV-BY\n               GIVING WS-DIVIDEND\n               REMAINDER WS-REMAINDER\n\n               IF WS-REMAINDER = ZEROES\n                  CONTINUE\n               ELSE\n                  SET INPUT-ERROR          TO TRUE\n                  SET FLG-DAY-NOT-OK       TO TRUE\n                  SET FLG-MONTH-NOT-OK     TO TRUE\n                  SET FLG-YEAR-NOT-OK      TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                  STRING\n                    FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                   ':Not a leap year.Cannot have 29 days in this month.'\n                    DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                  END-IF\n                  GO TO EDIT-DATE-CCYYMMDD-EXIT\n               END-IF\n           END-IF\n\n           IF WS-EDIT-DATE-IS-VALID\n              CONTINUE\n           ELSE\n              GO TO EDIT-DATE-CCYYMMDD-EXIT\n           END-IF\n           .\n       EDIT-DAY-MONTH-YEAR-EXIT.\n           EXIT\n           .\n\n       EDIT-DATE-LE.\n      ******************************************************************\n      *    In case some one managed to enter a bad date that passsed all\n      *    the edits above ......\n      *                  Use LE Services to verify the supplied date\n      ******************************************************************\n           INITIALIZE WS-DATE-VALIDATION-RESULT\n           MOVE 'YYYYMMDD'                   TO WS-DATE-FORMAT\n\n005100     CALL 'CSUTLDTC'\n           USING WS-EDIT-DATE-CCYYMMDD\n               , WS-DATE-FORMAT\n               , WS-DATE-VALIDATION-RESULT\n\n           IF WS-SEVERITY-N = 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-DAY-NOT-OK             TO TRUE\n              SET FLG-MONTH-NOT-OK           TO TRUE\n              SET FLG-YEAR-NOT-OK            TO TRUE\n              IF WS-RETURN-MSG-OFF\n              STRING\n                FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                ' validation error Sev code: '\n                WS-SEVERITY\n                ' Message code: '\n                WS-MSG-NO\n                DELIMITED BY SIZE\n               INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DATE-LE-EXIT\n           END-IF\n\n           IF NOT INPUT-ERROR\n              SET FLG-DAY-ISVALID           TO TRUE\n           END-IF\n           .\n\n       EDIT-DATE-LE-EXIT.\n           EXIT\n           .\n      *    If we got here all edits were cleared\n           SET WS-EDIT-DATE-IS-VALID        TO TRUE\n           .\n       EDIT-DATE-CCYYMMDD-EXIT.\n           EXIT\n           .\n\n      ******************************************************************\n      *Date of Birth Reasonableness check\n      ******************************************************************\n      *  At the time of writing this program\n      *  Time travel was not possible.\n      *  Date of birth in the future is not acceptable\n      ******************************************************************\n      *\n       EDIT-DATE-OF-BIRTH.\n\n           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE-YYYYMMDD\n\n           COMPUTE WS-EDIT-DATE-BINARY =\n               FUNCTION INTEGER-OF-DATE (WS-EDIT-DATE-CCYYMMDD-N)\n           COMPUTE WS-CURRENT-DATE-BINARY =\n               FUNCTION INTEGER-OF-DATE (WS-CURRENT-DATE-YYYYMMDD-N)\n\n           IF WS-CURRENT-DATE-BINARY > WS-EDIT-DATE-BINARY\n      *    IF FUNCTION FIND-DURATION(FUNCTION CURRENT-DATE\n      *                             ,WS-EDIT-DATE-CCYYMMDD)\n      *                             ,DAYS) > 0\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-DAY-NOT-OK             TO TRUE\n              SET FLG-MONTH-NOT-OK           TO TRUE\n              SET FLG-YEAR-NOT-OK            TO TRUE\n              IF WS-RETURN-MSG-OFF\n              STRING\n                FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)\n                ':cannot be in the future '\n                DELIMITED BY SIZE\n               INTO WS-RETURN-MSG\n              END-IF\n              GO TO EDIT-DATE-OF-BIRTH-EXIT\n           END-IF\n           .\n       EDIT-DATE-OF-BIRTH-EXIT.\n           EXIT\n           .\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT\n      *\n",
      "description": "This copybook provides a comprehensive set of date validation procedures for COBOL programs within the CardDemo application. It contains reusable paragraphs for validating dates in CCYYMMDD format (century, year, month, day). The validation includes checks for:\n\n1. Year and century validation (EDIT-YEAR-CCYY) - ensures years are numeric and have valid century values (19xx or 20xx)\n2. Month validation (EDIT-MONTH) - verifies months are numeric and between 1-12\n3. Day validation (EDIT-DAY) - confirms days are numeric and within valid ranges (1-31)\n4. Date consistency checks (EDIT-DAY-MONTH-YEAR) - handles special cases like:\n   - 30/31 days validation based on month\n   - February-specific validations (28/29 days)\n   - Leap year calculations\n\nThe copybook also includes additional validation using Language Environment services (EDIT-DATE-LE) as a final verification step, and a special date of birth validation (EDIT-DATE-OF-BIRTH) that ensures dates aren't in the future.\n\nThe code uses flags and error messages to communicate validation results back to the calling program, with customizable error messages that include the field name being validated."
    },
    {
      "name": "CUSTREC",
      "code": "      *****************************************************************\n      *    Data-structure for Customer entity (RECLN 500)\n      *****************************************************************\n       01  CUSTOMER-RECORD.\n           05  CUST-ID                                 PIC 9(09).\n\t\t     05  CUST-FIRST-NAME                         PIC X(25).\n\t\t     05  CUST-MIDDLE-NAME                        PIC X(25).\n\t\t     05  CUST-LAST-NAME                          PIC X(25).\n\t\t     05  CUST-ADDR-LINE-1                        PIC X(50).\n\t\t     05  CUST-ADDR-LINE-2                        PIC X(50).\n\t\t     05  CUST-ADDR-LINE-3                        PIC X(50).\t\t   \n\t\t     05  CUST-ADDR-STATE-CD                      PIC X(02).\n\t\t     05  CUST-ADDR-COUNTRY-CD                    PIC X(03).\n\t\t     05  CUST-ADDR-ZIP                           PIC X(10).\n\t\t     05  CUST-PHONE-NUM-1                        PIC X(15).\n\t\t     05  CUST-PHONE-NUM-2                        PIC X(15).\n\t\t     05  CUST-SSN                                PIC 9(09).\n\t\t     05  CUST-GOVT-ISSUED-ID                     PIC X(20).\n\t\t     05  CUST-DOB-YYYYMMDD                       PIC X(10).\n\t\t     05  CUST-EFT-ACCOUNT-ID                     PIC X(10).\n\t\t     05  CUST-PRI-CARD-HOLDER-IND                PIC X(01).\n\t\t     05  CUST-FICO-CREDIT-SCORE                  PIC 9(03).\n             05  FILLER                                  PIC X(168).      \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT\n      *\n",
      "description": "This copybook defines the data structure for a Customer entity with a record length of 500 bytes. It contains comprehensive customer information including personal identification (customer ID, SSN, government ID), contact details (name, address, phone numbers), financial information (EFT account ID, FICO credit score), and status indicators (primary cardholder indicator). The structure is designed to store complete customer profiles for the CardDemo application, which is used to showcase AWS and partner technologies for mainframe migration and modernization scenarios. The fields are organized logically to represent customer demographic and account relationship data needed for credit card processing operations."
    },
    {
      "name": "CVTRA01Y",
      "code": "      *****************************************************************         \n      *    Data-structure for transaction category balance (RECLN = 50)         \n      *****************************************************************         \n       01  TRAN-CAT-BAL-RECORD.                                                 \n           05  TRAN-CAT-KEY.                                                    \n              10 TRANCAT-ACCT-ID                       PIC 9(11).               \n              10 TRANCAT-TYPE-CD                       PIC X(02).               \n              10 TRANCAT-CD                            PIC 9(04).               \n           05  TRAN-CAT-BAL                            PIC S9(09)V99.           \n           05  FILLER                                  PIC X(22).               \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines a data structure for tracking transaction category balances. It contains a record layout with a key composed of an account ID, transaction type code, and category code, followed by a signed balance field with two decimal places. The record has a fixed length of 50 bytes, with 22 bytes of filler space reserved for potential future expansion. This structure is likely used in the CardDemo application to maintain and report on transaction balances categorized by different transaction types."
    },
    {
      "name": "CSUTLDWY",
      "code": "      ******************************************************************\n      *Working Storage Copybook for DATE related code\n      ******************************************************************\n           10 WS-EDIT-DATE-CCYYMMDD.\n              20 WS-EDIT-DATE-CCYY.\n                 25 WS-EDIT-DATE-CC                PIC X(2).\n                 25 WS-EDIT-DATE-CC-N REDEFINES    WS-EDIT-DATE-CC\n                                                   PIC 9(2).\n                    88 THIS-CENTURY                VALUE 20.\n                    88 LAST-CENTURY                VALUE 19.\n                 25 WS-EDIT-DATE-YY                PIC X(2).\n                 25 WS-EDIT-DATE-YY-N REDEFINES    WS-EDIT-DATE-YY\n                                                   PIC 9(2).\n              20 WS-EDIT-DATE-CCYY-N  REDEFINES\n                 WS-EDIT-DATE-CCYY                 PIC 9(4).\n              20 WS-EDIT-DATE-MM                   PIC X(2).\n              20 WS-EDIT-DATE-MM-N REDEFINES WS-EDIT-DATE-MM\n                                                   PIC 9(2).\n                 88 WS-VALID-MONTH                 VALUES\n                                                   1 THROUGH 12.\n                 88 WS-31-DAY-MONTH                VALUES\n                                                   1, 3, 5, 7,\n                                                   8, 10, 12.\n                 88 WS-FEBRUARY                    VALUE 2.\n              20 WS-EDIT-DATE-DD                   PIC X(2).\n              20 WS-EDIT-DATE-DD-N REDEFINES WS-EDIT-DATE-DD\n                                                   PIC 9(2).\n                 88 WS-VALID-DAY                   VALUES\n                                                   1 THROUGH 31.\n                 88 WS-DAY-31                      VALUE 31.\n                 88 WS-DAY-30                      VALUE 30.\n                 88 WS-DAY-29                      VALUE 29.\n                 88 WS-VALID-FEB-DAY               VALUES\n                                                   1 THROUGH 28.\n           10 WS-EDIT-DATE-CCYYMMDD-N REDEFINES\n              WS-EDIT-DATE-CCYYMMDD                PIC 9(8).\n           10 WS-EDIT-DATE-BINARY                  PIC S9(9) BINARY.\n           10 WS-CURRENT-DATE.\n              20 WS-CURRENT-DATE-YYYYMMDD          PIC X(8).\n              20 WS-CURRENT-DATE-YYYYMMDD-N REDEFINES\n                 WS-CURRENT-DATE-YYYYMMDD          PIC 9(8).\n              20 WS-CURRENT-DATE-BINARY            PIC S9(9) BINARY.\n           10 WS-EDIT-DATE-FLGS.\n               88 WS-EDIT-DATE-IS-VALID            VALUE LOW-VALUES.\n               88 WS-EDIT-DATE-IS-INVALID          VALUE '000'.\n               20 WS-EDIT-YEAR-FLG                 PIC X(01).\n                  88 FLG-YEAR-ISVALID              VALUE LOW-VALUES.\n                  88 FLG-YEAR-NOT-OK               VALUE '0'.\n                  88 FLG-YEAR-BLANK                VALUE 'B'.\n               20 WS-EDIT-MONTH                    PIC X(01).\n                  88 FLG-MONTH-ISVALID             VALUE LOW-VALUES.\n                  88 FLG-MONTH-NOT-OK              VALUE '0'.\n                  88 FLG-MONTH-BLANK               VALUE 'B'.\n               20 WS-EDIT-DAY                      PIC X(01).\n                  88 FLG-DAY-ISVALID               VALUE LOW-VALUES.\n                  88 FLG-DAY-NOT-OK                VALUE '0'.\n                  88 FLG-DAY-BLANK                 VALUE 'B'.\n          10 WS-DATE-FORMAT                        PIC X(08)\n                                                   VALUE 'YYYYMMDD'.\n          10 WS-DATE-VALIDATION-RESULT .\n               20 WS-SEVERITY                      PIC X(04).\n               20 WS-SEVERITY-N                    REDEFINES\n                  WS-SEVERITY                      PIC 9(4).\n               20 FILLER                           PIC X(11)\n                                                   VALUE 'Mesg Code:'.\n               20 WS-MSG-NO                        PIC X(04).\n               20 WS-MSG-NO-N                      REDEFINES\n                  WS-MSG-NO                        Pic 9(4).\n               20 FILLER                           PIC X(01)\n                                                   VALUE SPACE.\n               20 WS-RESULT                        PIC X(15).\n               20 FILLER                           PIC X(01)\n                                                   VALUE SPACE.\n               20 FILLER                           PIC X(09)\n                                                   VALUE 'TstDate:'.\n               20 WS-DATE                          PIC X(10).\n               20 FILLER                           PIC X(01)\n                                                   VALUE SPACE.\n               20 FILLER                           PIC X(10)\n                                                   VALUE 'Mask used:' .\n               20 WS-DATE-FMT                      PIC X(10).\n               20 FILLER                           PIC X(01)\n                                                   VALUE SPACE.\n               20 FILLER                           PIC X(03)\n                                                   VALUE SPACES.\n\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT\n      *\n",
      "description": "This copybook defines data structures for date handling and validation in the CardDemo application. It includes fields for storing and manipulating dates in CCYYMMDD format (century, year, month, day), with various numeric redefinitions to facilitate date processing. The structure contains condition names (88-level items) for validating date components such as valid months, days, and special cases like leap year considerations. It also includes fields for current date storage, date validation flags to track validation status, and a comprehensive date validation result structure that captures severity, message codes, test dates, and format information. This copybook serves as a central repository for date-related working storage definitions that can be included in programs requiring date manipulation and validation functionality."
    },
    {
      "name": "CVTRA07Y",
      "code": "      *****************************************************************         \n      *    Reporting data structure for transaction report                      \n      *****************************************************************         \n       01  REPORT-NAME-HEADER.                                                  \n           05  REPT-SHORT-NAME                  PIC X(38) VALUE                 \n           'DALYREPT'.                                                          \n           05  REPT-LONG-NAME                   PIC X(41) VALUE                 \n           'Daily Transaction Report'.                                          \n           05  REPT-DATE-HEADER                 PIC X(12) VALUE                 \n           'Date Range: '.                                                      \n           05  REPT-START-DATE                  PIC X(10) VALUE SPACES.         \n           05  FILLER                           PIC X(04) VALUE ' to '.         \n           05  REPT-END-DATE                    PIC X(10) VALUE SPACES.         \n                                                                                \n       01  TRANSACTION-DETAIL-REPORT.                                           \n           05  TRAN-REPORT-TRANS-ID             PIC X(16).                      \n           05  FILLER                           PIC X(01) VALUE SPACES.         \n           05  TRAN-REPORT-ACCOUNT-ID           PIC X(11).                      \n           05  FILLER                           PIC X(01) VALUE SPACES.         \n           05  TRAN-REPORT-TYPE-CD              PIC X(02).                      \n           05  FILLER                           PIC X(01) VALUE '-'.            \n           05  TRAN-REPORT-TYPE-DESC            PIC X(15).                      \n           05  FILLER                           PIC X(01) VALUE SPACES.         \n           05  TRAN-REPORT-CAT-CD               PIC 9(04).                      \n           05  FILLER                           PIC X(01) VALUE '-'.            \n           05  TRAN-REPORT-CAT-DESC             PIC X(29).                      \n           05  FILLER                           PIC X(01) VALUE SPACES.         \n           05  TRAN-REPORT-SOURCE               PIC X(10).                      \n           05  FILLER                           PIC X(04) VALUE SPACES.         \n           05  TRAN-REPORT-AMT                  PIC -ZZZ,ZZZ,ZZZ.ZZ.            \n           05  FILLER                           PIC X(02) VALUE SPACES.         \n                                                                                \n       01  TRANSACTION-HEADER-1.                                                \n           05  FILLER                           PIC X(17) VALUE                 \n           'Transaction ID'.                                                    \n           05  FILLER                           PIC X(12) VALUE                 \n           'Account ID'.                                                        \n           05  FILLER                           PIC X(19) VALUE                 \n           'Transaction Type'.                                                  \n           05  FILLER                           PIC X(35) VALUE                 \n           'Tran Category'.                                                     \n           05  FILLER                           PIC X(14) VALUE                 \n           'Tran Source'.                                                       \n           05  FILLER                           PIC X VALUE SPACES.             \n           05  FILLER                           PIC X(16) VALUE                 \n           '        Amount'.                                                    \n                                                                                \n       01  TRANSACTION-HEADER-2  PIC X(133) VALUE ALL '-'.                      \n                                                                                \n       01  REPORT-PAGE-TOTALS.                                                  \n           05  FILLER                           PIC X(11) VALUE                 \n           'Page Total'.                                                        \n           05  FILLER                           PIC X(86) VALUE ALL '.'.        \n           05  REPT-PAGE-TOTAL                  PIC +ZZZ,ZZZ,ZZZ.ZZ.            \n                                                                                \n       01  REPORT-ACCOUNT-TOTALS.                                               \n           05  FILLER                           PIC X(13) VALUE                 \n           'Account Total'.                                                     \n           05  FILLER                           PIC X(84) VALUE ALL '.'.        \n           05  REPT-ACCOUNT-TOTAL               PIC +ZZZ,ZZZ,ZZZ.ZZ.            \n                                                                                \n       01  REPORT-GRAND-TOTALS.                                                 \n           05  FILLER                           PIC X(11) VALUE                 \n           'Grand Total'.                                                       \n           05  FILLER                           PIC X(86) VALUE ALL '.'.        \n           05  REPT-GRAND-TOTAL                 PIC +ZZZ,ZZZ,ZZZ.ZZ.            \n                                                                                \n                                                                                \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT\n      *\n",
      "description": "This copybook defines data structures used for generating a daily transaction report in the CardDemo application. It contains layout definitions for report headers, transaction detail lines, and summary totals. The structure includes fields for transaction IDs, account IDs, transaction types with descriptions, category codes with descriptions, transaction sources, and monetary amounts. The copybook also defines header lines for column titles and page formatting, as well as specialized structures for displaying page totals, account totals, and grand totals with proper formatting for currency values. These structures would be used by programs that generate transaction reports to ensure consistent formatting and presentation of financial data."
    },
    {
      "name": "CSSTRPFY",
      "code": "      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       YYYY-STORE-PFKEY.                                                        \n      *****************************************************************         \n      * Map AID to PFKey in COMMON Area                                         \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n             WHEN EIBAID IS EQUAL TO DFHENTER                                   \n               SET CCARD-AID-ENTER TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHCLEAR                                   \n               SET CCARD-AID-CLEAR TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPA1                                     \n               SET CCARD-AID-PA1  TO TRUE                                       \n             WHEN EIBAID IS EQUAL TO DFHPA2                                     \n               SET CCARD-AID-PA2  TO TRUE                                       \n             WHEN EIBAID IS EQUAL TO DFHPF1                                     \n               SET CCARD-AID-PFK01 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF2                                     \n               SET CCARD-AID-PFK02 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF3                                     \n               SET CCARD-AID-PFK03 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF4                                     \n               SET CCARD-AID-PFK04 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF5                                     \n               SET CCARD-AID-PFK05 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF6                                     \n               SET CCARD-AID-PFK06 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF7                                     \n               SET CCARD-AID-PFK07 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF8                                     \n               SET CCARD-AID-PFK08 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF9                                     \n               SET CCARD-AID-PFK09 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF10                                    \n               SET CCARD-AID-PFK10 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF11                                    \n               SET CCARD-AID-PFK11 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF12                                    \n               SET CCARD-AID-PFK12 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF13                                    \n               SET CCARD-AID-PFK01 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF14                                    \n               SET CCARD-AID-PFK02 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF15                                    \n               SET CCARD-AID-PFK03 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF16                                    \n               SET CCARD-AID-PFK04 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF17                                    \n               SET CCARD-AID-PFK05 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF18                                    \n               SET CCARD-AID-PFK06 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF19                                    \n               SET CCARD-AID-PFK07 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF20                                    \n               SET CCARD-AID-PFK08 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF21                                    \n               SET CCARD-AID-PFK09 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF22                                    \n               SET CCARD-AID-PFK10 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF23                                    \n               SET CCARD-AID-PFK11 TO TRUE                                      \n             WHEN EIBAID IS EQUAL TO DFHPF24                                    \n               SET CCARD-AID-PFK12 TO TRUE                                      \n           END-EVALUATE                                                         \n           .                                                                    \n       YYYY-STORE-PFKEY-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT\n      *\n",
      "description": "This copybook provides a standardized mechanism for mapping CICS Attention Identifier (AID) keys to program function keys in the CardDemo application's common area. It contains a reusable EVALUATE statement that translates the EIBAID value (which indicates which key the user pressed) into corresponding CCARD-AID flags in a shared data structure. The copybook handles all standard CICS keys including ENTER, CLEAR, PA1, PA2, and PF1-PF24 (with PF13-PF24 mapped to their PF1-PF12 equivalents). This shared code ensures consistent keyboard handling across multiple programs in the CardDemo application and simplifies terminal interaction processing."
    },
    {
      "name": "CVTRA04Y",
      "code": "      *****************************************************************         \n      *    Data-structure for transaction category type (RECLN = 60)            \n      *****************************************************************         \n       01  TRAN-CAT-RECORD.                                                     \n           05  TRAN-CAT-KEY.                                                    \n              10  TRAN-TYPE-CD                         PIC X(02).               \n              10  TRAN-CAT-CD                          PIC 9(04).               \n           05  TRAN-CAT-TYPE-DESC                      PIC X(50).               \n           05  FILLER                                  PIC X(04).               \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT\n      *\n",
      "description": "This copybook defines a data structure for transaction category types with a record length of 60 bytes. It contains a key composed of a 2-character transaction type code and a 4-digit transaction category code, followed by a 50-character description field. The structure is likely used throughout the CardDemo application to categorize different types of card transactions, providing standardized transaction classification for reporting, processing, or display purposes."
    },
    {
      "name": "COTTL01Y",
      "code": "      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 CCDA-SCREEN-TITLE.\n         05 CCDA-TITLE01    PIC X(40) VALUE\n            '      AWS Mainframe Modernization       '.\n         05 CCDA-TITLE02    PIC X(40) VALUE\n      *     '  Credit Card Demo Application (CCDA)   '.\n            '              CardDemo                  '.\n         05 CCDA-THANK-YOU  PIC X(40) VALUE\n            'Thank you for using CCDA application... '.\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT\n      *\n",
      "description": "This copybook defines the screen title elements used in the CardDemo application for AWS Mainframe Modernization. It contains three 40-character fields that make up the application's header display: a main title identifying it as an AWS Mainframe Modernization application, a secondary title showing \"CardDemo\" (with a commented-out alternative that would have shown \"Credit Card Demo Application (CCDA)\"), and a thank you message displayed to users. This copybook is likely included in various screens throughout the application to maintain consistent header formatting and branding."
    },
    {
      "name": "UNUSED1Y",
      "code": "       01 UNUSED-DATA.\n         05 UNUSED-ID                 PIC X(08).\n         05 UNUSED-FNAME              PIC X(20).\n         05 UNUSED-LNAME              PIC X(20).\n         05 UNUSED-PWD                PIC X(08).\n         05 UNUSED-TYPE               PIC X(01).\n         05 UNUSED-FILLER             PIC X(23).\n      *\n      * Ver: CardDemo_v1.0-56-gd8e5ebf-109 Date: 2022-08-19 17:55:18 CDT\n      *\n",
      "description": "This copybook defines a data structure named UNUSED-DATA that appears to be a placeholder or legacy structure not actively used in the current application. It contains fields for storing user identification information including an ID, first name, last name, password, user type, and filler space. The structure is likely maintained for compatibility with older code or for potential future use within the CardDemo application. The comment at the bottom indicates the version control information for the CardDemo project."
    },
    {
      "name": "COADM02Y",
      "code": "      ******************************************************************\n      * CardDemo - Admin Menu Options\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 CARDDEMO-ADMIN-MENU-OPTIONS.\n         05 CDEMO-ADMIN-OPT-COUNT           PIC 9(02) VALUE 4.\n\n         05 CDEMO-ADMIN-OPTIONS-DATA.\n\n           10 FILLER                        PIC 9(02) VALUE 1.\n           10 FILLER                        PIC X(35) VALUE\n               'User List (Security)               '.\n           10 FILLER                        PIC X(08) VALUE 'COUSR00C'.\n\n           10 FILLER                        PIC 9(02) VALUE 2.\n           10 FILLER                        PIC X(35) VALUE\n               'User Add (Security)                '.\n           10 FILLER                        PIC X(08) VALUE 'COUSR01C'.\n\n           10 FILLER                        PIC 9(02) VALUE 3.\n           10 FILLER                        PIC X(35) VALUE\n               'User Update (Security)             '.\n           10 FILLER                        PIC X(08) VALUE 'COUSR02C'.\n\n           10 FILLER                        PIC 9(02) VALUE 4.\n           10 FILLER                        PIC X(35) VALUE\n               'User Delete (Security)             '.\n           10 FILLER                        PIC X(08) VALUE 'COUSR03C'.\n\n         05 CDEMO-ADMIN-OPTIONS REDEFINES CDEMO-ADMIN-OPTIONS-DATA.\n           10 CDEMO-ADMIN-OPT OCCURS 9 TIMES.\n             15 CDEMO-ADMIN-OPT-NUM           PIC 9(02).\n             15 CDEMO-ADMIN-OPT-NAME          PIC X(35).\n             15 CDEMO-ADMIN-OPT-PGMNAME       PIC X(08).\n      *\n      * Ver: CardDemo_v1.0-26-g42273c1-79 Date: 2022-07-20 16:59:12 CDT\n      *\n",
      "description": "This copybook defines the structure for the CardDemo application's administration menu options, specifically focusing on user security management. It contains a data structure that holds information about four administrative functions: listing users, adding users, updating users, and deleting users. Each menu option is defined with a numeric identifier, descriptive text, and the associated program name to be called when selected. The structure is organized to allow for up to 9 menu options (though only 4 are currently defined) and includes a count field to track the actual number of options available. This copybook is likely used across multiple programs that need to display or process the administration menu within the CardDemo application."
    },
    {
      "name": "COCOM01Y",
      "code": "      ******************************************************************\n      * Communication area for CardDemo application programs\n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 CARDDEMO-COMMAREA.\n          05 CDEMO-GENERAL-INFO.\n             10 CDEMO-FROM-TRANID             PIC X(04).\n             10 CDEMO-FROM-PROGRAM            PIC X(08).\n             10 CDEMO-TO-TRANID               PIC X(04).\n             10 CDEMO-TO-PROGRAM              PIC X(08).\n             10 CDEMO-USER-ID                 PIC X(08).\n             10 CDEMO-USER-TYPE               PIC X(01).\n                88 CDEMO-USRTYP-ADMIN         VALUE 'A'.\n                88 CDEMO-USRTYP-USER          VALUE 'U'.\n             10 CDEMO-PGM-CONTEXT             PIC 9(01).\n                88 CDEMO-PGM-ENTER            VALUE 0.\n                88 CDEMO-PGM-REENTER          VALUE 1.\n          05 CDEMO-CUSTOMER-INFO.\n             10 CDEMO-CUST-ID                 PIC 9(09).\n             10 CDEMO-CUST-FNAME              PIC X(25).\n             10 CDEMO-CUST-MNAME              PIC X(25).\n             10 CDEMO-CUST-LNAME              PIC X(25).\n          05 CDEMO-ACCOUNT-INFO.\n             10 CDEMO-ACCT-ID                 PIC 9(11).\n             10 CDEMO-ACCT-STATUS             PIC X(01).\n          05 CDEMO-CARD-INFO.\n             10 CDEMO-CARD-NUM                PIC 9(16).\n          05 CDEMO-MORE-INFO.\n             10  CDEMO-LAST-MAP               PIC X(7).\n             10  CDEMO-LAST-MAPSET            PIC X(7).\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT\n      *\n",
      "description": "This copybook defines the communication area (COMMAREA) structure used for data exchange between programs in the CardDemo application. It contains several key sections: general information for tracking program flow and user context, customer identification and personal details, account information, card details, and interface tracking data. The structure includes fields for transaction IDs, program names, user identification with role classification (admin or user), program context flags, and core business data elements like customer ID, account status, and card number. This standardized data structure facilitates consistent information passing throughout the CardDemo application's program-to-program communication."
    },
    {
      "name": "CVACT02Y",
      "code": "      *****************************************************************\n      *    Data-structure for card entity (RECLN 150)\n      *****************************************************************\n       01  CARD-RECORD.\n           05  CARD-NUM                          PIC X(16).\n           05  CARD-ACCT-ID                      PIC 9(11).\n           05  CARD-CVV-CD                       PIC 9(03).\n           05  CARD-EMBOSSED-NAME                PIC X(50).\n           05  CARD-EXPIRAION-DATE               PIC X(10).\n           05  CARD-ACTIVE-STATUS                PIC X(01).\n           05  FILLER                            PIC X(59).\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines the data structure for a card entity with a record length of 150 bytes. It contains essential credit/debit card information fields including the card number, associated account ID, CVV code, embossed name, expiration date, and active status indicator. The structure allows for standardized card data representation across the CardDemo application, which is used to showcase AWS and partner technologies for mainframe migration scenarios. The remaining 59 bytes are reserved as filler space for potential future expansion of the card record structure."
    },
    {
      "name": "CVCUS01Y",
      "code": "      *****************************************************************\n      *    Data-structure for Customer entity (RECLN 500)\n      *****************************************************************\n       01  CUSTOMER-RECORD.\n           05  CUST-ID                                 PIC 9(09).\n           05  CUST-FIRST-NAME                         PIC X(25).\n           05  CUST-MIDDLE-NAME                        PIC X(25).\n           05  CUST-LAST-NAME                          PIC X(25).\n           05  CUST-ADDR-LINE-1                        PIC X(50).\n           05  CUST-ADDR-LINE-2                        PIC X(50).\n           05  CUST-ADDR-LINE-3                        PIC X(50).         \n           05  CUST-ADDR-STATE-CD                      PIC X(02).\n           05  CUST-ADDR-COUNTRY-CD                    PIC X(03).\n           05  CUST-ADDR-ZIP                           PIC X(10).\n           05  CUST-PHONE-NUM-1                        PIC X(15).\n           05  CUST-PHONE-NUM-2                        PIC X(15).\n           05  CUST-SSN                                PIC 9(09).\n           05  CUST-GOVT-ISSUED-ID                     PIC X(20).\n           05  CUST-DOB-YYYY-MM-DD                     PIC X(10).\n           05  CUST-EFT-ACCOUNT-ID                     PIC X(10).\n           05  CUST-PRI-CARD-HOLDER-IND                PIC X(01).\n           05  CUST-FICO-CREDIT-SCORE                  PIC 9(03).\n           05  FILLER                                  PIC X(168).      \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines the data structure for a Customer entity with a record length of 500 bytes. It contains essential customer information fields including identification (customer ID, SSN, government ID), personal details (name components, date of birth), contact information (address lines, state code, country code, ZIP code, phone numbers), financial data (EFT account ID, FICO credit score), and a primary cardholder indicator. The structure is designed to store comprehensive customer data for the CardDemo application, which demonstrates AWS and partner technologies for mainframe migration and modernization scenarios."
    },
    {
      "name": "CVTRA03Y",
      "code": "      *****************************************************************         \n      *    Data-structure for transaction type (RECLN = 60)                     \n      *****************************************************************         \n       01  TRAN-TYPE-RECORD.                                                    \n           05  TRAN-TYPE                               PIC X(02).               \n           05  TRAN-TYPE-DESC                          PIC X(50).               \n           05  FILLER                                  PIC X(08).               \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT\n      *\n",
      "description": "This copybook defines a data structure for transaction type records with a fixed length of 60 bytes. It contains fields for storing a 2-character transaction type code, a 50-character description of the transaction type, and an 8-character filler field. This structure is likely used throughout the CardDemo application to standardize the representation of transaction types and their descriptions in various programs that process card transactions."
    },
    {
      "name": "CSDAT01Y",
      "code": "      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ****************************************************************** \n       01 WS-DATE-TIME.\n         05 WS-CURDATE-DATA.\n           10  WS-CURDATE.\n             15  WS-CURDATE-YEAR         PIC 9(04).\n             15  WS-CURDATE-MONTH        PIC 9(02).\n             15  WS-CURDATE-DAY          PIC 9(02).\n           10 WS-CURDATE-N REDEFINES WS-CURDATE PIC 9(08).\n           10  WS-CURTIME.\n             15  WS-CURTIME-HOURS        PIC 9(02).\n             15  WS-CURTIME-MINUTE       PIC 9(02).\n             15  WS-CURTIME-SECOND       PIC 9(02).\n             15  WS-CURTIME-MILSEC       PIC 9(02).\n           10 WS-CURTIME-N REDEFINES WS-CURTIME PIC 9(08).\n         05 WS-CURDATE-MM-DD-YY.\n           10  WS-CURDATE-MM             PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE '/'.\n           10  WS-CURDATE-DD             PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE '/'.\n           10  WS-CURDATE-YY             PIC 9(02).\n         05 WS-CURTIME-HH-MM-SS.\n           10  WS-CURTIME-HH             PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE ':'.\n           10  WS-CURTIME-MM             PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE ':'.\n           10  WS-CURTIME-SS             PIC 9(02).\n         05 WS-TIMESTAMP.\n           10  WS-TIMESTAMP-DT-YYYY      PIC 9(04).\n           10  FILLER                    PIC X(01) VALUE '-'.\n           10  WS-TIMESTAMP-DT-MM        PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE '-'.\n           10  WS-TIMESTAMP-DT-DD        PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE ' '.\n           10  WS-TIMESTAMP-TM-HH        PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE ':'.\n           10  WS-TIMESTAMP-TM-MM        PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE ':'.\n           10  WS-TIMESTAMP-TM-SS        PIC 9(02).\n           10  FILLER                    PIC X(01) VALUE '.'.\n           10  WS-TIMESTAMP-TM-MS6       PIC 9(06).\n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT\n      *\n",
      "description": "This copybook defines a comprehensive date and time data structure used throughout the CardDemo application. It provides multiple formats for representing date and time information, including numeric components, formatted display strings, and timestamp formats. The structure includes fields for year, month, day, hours, minutes, seconds, and milliseconds, with both individual components and combined representations. The copybook also includes redefinitions to allow accessing date and time values as numeric fields. This standardized date-time structure enables consistent handling of temporal data across the CardDemo application, supporting various formatting needs for display, calculations, and database operations."
    },
    {
      "name": "CVACT01Y",
      "code": "      *****************************************************************\n      *    Data-structure for  account entity (RECLN 300)\n      *****************************************************************\n       01  ACCOUNT-RECORD.\n           05  ACCT-ID                           PIC 9(11).\n           05  ACCT-ACTIVE-STATUS                PIC X(01).\n           05  ACCT-CURR-BAL                     PIC S9(10)V99.\n           05  ACCT-CREDIT-LIMIT                 PIC S9(10)V99.\n           05  ACCT-CASH-CREDIT-LIMIT            PIC S9(10)V99.\n           05  ACCT-OPEN-DATE                    PIC X(10).\n           05  ACCT-EXPIRAION-DATE               PIC X(10). \n           05  ACCT-REISSUE-DATE                 PIC X(10).\n           05  ACCT-CURR-CYC-CREDIT              PIC S9(10)V99.\n           05  ACCT-CURR-CYC-DEBIT               PIC S9(10)V99.\n           05  ACCT-ADDR-ZIP                     PIC X(10).\n           05  ACCT-GROUP-ID                     PIC X(10).\n           05  FILLER                            PIC X(178).      \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT\n      *\n",
      "description": "This copybook defines the data structure for an account entity with a record length of 300 bytes. It contains essential account information fields including account identification, status, financial limits, balances, and important dates. Key fields include the account ID, active status indicator, current balance, credit limits (both regular and cash), various date fields (open, expiration, and reissue dates), cycle credits and debits, ZIP code, and a group identifier. This structure is likely used across multiple programs in the CardDemoAWS application for consistent account data representation and processing."
    }
  ],
  "jobs": [
    {
      "name": "BMSCMP",
      "code": "//CBLDBMS  JOB 'Compile BMS Map',CLASS=A,MSGCLASS=H,        \n//             MSGLEVEL=(1,1),REGION=0M,NOTIFY=&SYSUID,TIME=1440\n//*********************************************************************\n//*  Change CICSMAP to your map name everywhere\n//*----->   C CICSMAP xyz all <--------\n//*  set    HLQ      to your high level qualifier\n//*********************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//*********************************************************************    \n//****  Sample Assembler BMS Compile JCL                         ******         \n//****  Check with your Administrator for                        ******         \n//****  JCL suitable to your environment                         ******\n//*********************************************************************\n//****  Compile CICS BMS to generate Copybook                    ******\n//*********************************************************************\n//*  ---------------------------\n//*  Set Parms for this compile:\n//*  ---------------------------\n//   SET HLQ=AWS.M2\n//*\n//*********************************************************************\n//*  Add Proclib Reference\n//*********************************************************************\n//CCLIBS  JCLLIB ORDER=&HLQ..CARDDEMO.PRC.UTIL\n//STEP1 EXEC BUILDBMS,MAPNAME=CICSMAP,HLQ=&HLQ\n//*********************************************************************\n//****  CICS commands in batch to Execute NEWCOPY                ******\n//*********************************************************************\n//SDSF1 EXEC PGM=SDSF\n//ISFOUT DD SYSOUT=*\n//CMDOUT DD SYSOUT=*\n//ISFIN  DD *\n /MODIFY CICSAWSA,'CEMT SET PROG(CICSMAP) NEWCOPY'\n/*\n",
      "description": "This JCL job compiles a BMS (Basic Mapping Support) map for CICS applications within the CardDemo AWS mainframe migration showcase project. It performs a two-step process: first compiling the BMS map to generate the necessary copybook and load modules, then issuing a CICS NEWCOPY command to make the updated map immediately available in the running CICS region. The job uses a custom procedure (BUILDBMS) stored in the project's procedure library and includes parameters for customization, allowing users to specify their high-level qualifier and map name. The job is designed to be reusable by replacing \"CICSMAP\" with the actual map name needed for compilation.",
      "referenced_programs": [
        "SDSF"
      ]
    },
    {
      "name": "BATCMP",
      "code": "//CNJBATMP JOB 'Compile Batch COBOL Program',CLASS=A,MSGCLASS=H,        \n//             MSGLEVEL=(1,1),REGION=0M,NOTIFY=&SYSUID,TIME=1440\n//*********************************************************************         \n//*  change BATCHPGM to your program name everywhere                            \n//*----->   C BATCHPGM xyz all <--------                                        \n//*********************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//*********************************************************************    \n//****  Sample Batch COBOL Compile JCL                           ******         \n//****  Check with your Administrator for                        ******         \n//****  JCL suitable to your environment                         ******\n//*********************************************************************    \n//*  change BATCHPGM to your program name everywhere                            \n//*----->   C BATCHPGM xyz all <--------                                        \n//*********************************************************************         \n//****  COMPILE BATCH COBOL PROGRAM                              ******         \n//*********************************************************************         \n//*  Set Parms for this compile:                                                \n//*********************************************************************         \n//   SET MEMNAME=BATCHPGM                                                       \n//   SET HLQ=AWS.M2                                                             \n//*********************************************************************         \n//*  Add proclib reference                                                      \n//*********************************************************************         \n//CCLIBS  JCLLIB ORDER=&HLQ..CARDDEMO.PRC.UTIL                                  \n//*********************************************************************         \n//*  compile the COBOL code:                                                    \n//*********************************************************************         \n//BATCMP       EXEC BUILDBAT,MEM=&MEMNAME,HLQ=&HLQ                              \n",
      "description": "This JCL job compiles a batch COBOL program for the CardDemo application. It serves as a template where users need to replace \"BATCHPGM\" with their actual program name throughout the job. The job utilizes a predefined procedure called BUILDBAT from the AWS.M2.CARDDEMO.PRC.UTIL library to perform the compilation. It includes configuration parameters for the high-level qualifier (HLQ) and member name, making it reusable for different batch programs within the CardDemo environment. The job is designed to support AWS and partner technology for mainframe migration and modernization use-cases.",
      "referenced_programs": []
    },
    {
      "name": "CICCMP",
      "code": "//CICCMP  JOB 'Compile CICS Program',CLASS=A,MSGCLASS=H,        \n//             MSGLEVEL=(1,1),REGION=0M,NOTIFY=&SYSUID,TIME=1440\n//********************************************************************* \n//*  change CICSPGMN to your program name everywhere                            \n//*----->   C CICSPGMN xyz all <--------                                        \n//*  set    HLQ      to your high level qualifier                              \n//*********************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//*********************************************************************    \n//****  Sample CICS COBOL Compile JCL                            ******         \n//****  Check with your Administrator for                        ******         \n//****  JCL suitable to your environment                         ******\n//*********************************************************************         \n//****  Compile CICS COBOL program                               ******         \n//****  After compiling the related maps                         ****** \n//*********************************************************************         \n//*  Set Parms for this compile:                                                \n//*********************************************************************         \n//   SET HLQ=AWS.M2                                                             \n//   SET MEMNAME=CICSPGMN                                                       \n//*********************************************************************         \n//*  Add proclib reference                                                      \n//*********************************************************************         \n//CCLIBS  JCLLIB ORDER=&HLQ..CARDDEMO.PRC.UTIL                                  \n//*********************************************************************         \n//*  compile the COBOL code:                                                    \n//*********************************************************************         \n//CICSCMP      EXEC BUILDONL,MEM=&MEMNAME,HLQ=&HLQ                              \n//*********************************************************************         \n//****  CICS commands in batch to perform NEWCOPY                ******         \n//*********************************************************************         \n//NEWCOPY EXEC PGM=SDSF,COND=(4,LT)                                             \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /MODIFY CICSAWSA,'CEMT SET PROG(CICSPGMN) NEWCOPY'                             \n/*                                                                              \n",
      "description": "This JCL job compiles a CICS COBOL program and performs a NEWCOPY operation to refresh the program in the CICS environment. It uses a predefined procedure (BUILDONL) from a procedure library to handle the compilation process. After successful compilation, it executes SDSF to issue a CEMT command that instructs the CICS region (CICSAWSA) to load a fresh copy of the program. The job includes placeholders for customization, requiring users to replace \"CICSPGMN\" with their actual program name and set the appropriate high-level qualifier (HLQ) for their environment. This job is part of the CardDemo application used for AWS mainframe migration demonstrations.",
      "referenced_programs": [
        "SDSF"
      ]
    },
    {
      "name": "DUSRSECJ",
      "code": "//DUSRSECJ JOB 'DEF USRSEC FILE',REGION=8M,CLASS=A,\n//      MSGCLASS=H,NOTIFY=&SYSUID\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//*-------------------------------------------------------------------*\n//* PRE DELETE STEP\n//*-------------------------------------------------------------------*\n//*\n//PREDEL  EXEC PGM=IEFBR14\n//*\n//DD01     DD DSN=AWS.M2.CARDDEMO.USRSEC.PS,\n//            DISP=(MOD,DELETE,DELETE)\n//*\n//*-------------------------------------------------------------------*\n//* CREATE USER SECURITY FILE (PS) FROM IN-STREAM DATA\n//*-------------------------------------------------------------------*\n//*\n//STEP01  EXEC PGM=IEBGENER\n//*\n//SYSUT1   DD *\nADMIN001MARGARET            GOLD                PASSWORDA\nADMIN002RUSSELL             RUSSELL             PASSWORDA\nADMIN003RAYMOND             WHITMORE            PASSWORDA\nADMIN004EMMANUEL            CASGRAIN            PASSWORDA\nADMIN005GRANVILLE           LACHAPELLE          PASSWORDA\nUSER0001LAWRENCE            THOMAS              PASSWORDU\nUSER0002AJITH               KUMAR               PASSWORDU\nUSER0003LAURITZ             ALME                PASSWORDU\nUSER0004AVERARDO            MAZZI               PASSWORDU\nUSER0005LEE                 TING                PASSWORDU\n/*\n//SYSUT2   DD DSN=AWS.M2.CARDDEMO.USRSEC.PS,\n//            DISP=(NEW,CATLG,DELETE),\n//            DCB=(LRECL=80,RECFM=FB,DSORG=PS,BLKSIZE=0),\n//            UNIT=SYSDA,SPACE=(TRK,(10,5),RLSE)\n//*\n//SYSPRINT DD SYSOUT=*\n//SYSIN    DD DUMMY\n//*\n//*-------------------------------------------------------------------*\n//* DEFINE VSAM FILE FOR USER SECURITY\n//*-------------------------------------------------------------------*\n//*\n//STEP02  EXEC PGM=IDCAMS\n//*\n//SYSPRINT DD  SYSOUT=*\n//SYSIN    DD  *\n DELETE                  AWS.M2.CARDDEMO.USRSEC.VSAM.KSDS\n SET       MAXCC = 0\n DEFINE    CLUSTER (NAME(AWS.M2.CARDDEMO.USRSEC.VSAM.KSDS)    -\n                    KEYS(8,0)                                 -\n                    RECORDSIZE(80,80)                         -\n                    REUSE                                     -\n                    INDEXED                                   -\n                    TRACKS(45,15)                             -\n                    FREESPACE(10,15)                          -\n                    CISZ(8192))                               -\n           DATA    (NAME(AWS.M2.CARDDEMO.USRSEC.VSAM.KSDS.DAT)) -\n           INDEX   (NAME(AWS.M2.CARDDEMO.USRSEC.VSAM.KSDS.IDX))\n/*\n//*\n//*-------------------------------------------------------------------*\n//* COPY USER SECURITY DATA FROM PS TO VSAM FILE\n//*-------------------------------------------------------------------*\n//*\n//STEP03  EXEC PGM=IDCAMS\n//*\n//IN       DD  DSN=AWS.M2.CARDDEMO.USRSEC.PS,DISP=SHR\n//OUT      DD  DSN=AWS.M2.CARDDEMO.USRSEC.VSAM.KSDS,DISP=SHR\n//SYSOUT   DD  SYSOUT=*\n//SYSPRINT DD  SYSOUT=*\n//SYSIN    DD  *\n  REPRO INFILE(IN) OUTFILE(OUT)\n/*\n//\n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:06 CDT\n//*\n",
      "description": "This JCL job creates and populates a user security file for the CardDemo application. It follows a three-step process: first removing any existing physical sequential file, then creating a new one with predefined user credentials (including admin and regular user accounts with their respective passwords), and finally converting this data into a VSAM KSDS file for application use. The job defines both administrator accounts (ADMIN001-ADMIN005) and regular user accounts (USER0001-USER0005) with their respective names and password types. The VSAM file is configured with an 8-byte key at position 0 and fixed-length 80-byte records, providing the security data structure needed by the CardDemo application for user authentication and authorization.",
      "referenced_programs": [
        "IDCAMS",
        "IEFBR14",
        "IEBGENER"
      ]
    },
    {
      "name": "READXREF",
      "code": "//READXREF JOB 'Read Cross Ref file',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//* *******************************************************************         \n//* RUN THE PROGRAM THAT READS THE XREF MASTER VSAM FILE                        \n//* *******************************************************************         \n//STEP05 EXEC PGM=CBACT03C                                                      \n//STEPLIB  DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.LOADLIB                                          \n//XREFFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS                               \n//SYSOUT   DD SYSOUT=*                                                          \n//SYSPRINT DD SYSOUT=*                                                          \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:07 CDT\n//*\n",
      "description": "This JCL job executes program CBACT03C to read and process the CardDemo cross-reference VSAM file. The job accesses the KSDS VSAM file containing card cross-reference data (AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS) and directs output to SYSOUT. As part of the CardDemo AWS application, this job likely supports functionality related to card account relationships or mappings between different identifiers in the system.",
      "referenced_programs": [
        "CBACT03C"
      ]
    },
    {
      "name": "XREFFILE",
      "code": "//XREFFILE JOB 'Delete define cross ref file',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID    \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE CARD XREF VSAM FILE IF ONE ALREADY EXISTS                            \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n   DELETE  AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX  -                                 \n          ALTERNATEINDEX                                                        \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE CARD XREF VSAM FILE                                                  \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(16 0) -                                                          \n          RECORDSIZE(50 50) -                                                   \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//XREFDATA DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.PS                                      \n//XREFVSAM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(XREFDATA) OUTFILE(XREFVSAM)                                     \n/*                                                                              \n//*********************************************************************         \n//* CREATE ALTERNATE INDEX ON ACCT ID                                           \n//*********************************************************************         \n//STEP20  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   DEFINE ALTERNATEINDEX (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX)-              \n   RELATE(AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS)                    -              \n   KEYS(11,25)                                                   -              \n   NONUNIQUEKEY                                                  -              \n   UPGRADE                                                       -              \n   RECORDSIZE(50,50)                                             -              \n   FREESPACE(10,20)                                              -              \n   VOLUMES(AWSHJ1)                                               -              \n   CYLINDERS(5,1))                                               -              \n   DATA (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX.DATA))           -              \n   INDEX (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX.INDEX))                        \n/*                                                                              \n//*********************************************************************         \n//* DEFINE PATH IS USED TO RELATE THE ALTERNATE INDEX TO BASE CLUSTER           \n//*********************************************************************         \n//STEP25  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n  DEFINE PATH                                           -                       \n   (NAME(AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX.PATH)        -                       \n    PATHENTRY(AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX))                               \n/*                                                                              \n//*********************************************************************         \n//* BUILD ALTERNATE INDEX CLUSTER                                               \n//*********************************************************************         \n//STEP30  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   BLDINDEX                                                      -              \n   INDATASET(AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS)                 -              \n   OUTDATASET(AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX)                                \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:09 CDT\n//*\n",
      "description": "This JCL job creates and configures a VSAM key-sequenced dataset (KSDS) for the CardDemo application's card cross-reference functionality. The job executes in multiple steps: first deleting any existing VSAM files and alternate indexes, then defining a new KSDS with specified parameters (50-byte records with a 16-byte key), populating it with data from a flat file, and finally creating an alternate index based on account ID (11-byte key starting at position 25). The job also defines a path to relate the alternate index to the base cluster and builds the alternate index. This VSAM file likely serves as a cross-reference between card numbers and account information, allowing the CardDemo application to access records through either key.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "TRANTYPE",
      "code": "//TRANTYPE JOB 'DEFINE TRAN TYPE',                                              \n// CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID           \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE TRANSACATION TYPE VSAM FILE IF ONE ALREADY EXISTS                    \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   SET    MAXCC = 0                                                             \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE TRANSACATION TYPE VSAM FILE                                          \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(2 0) -                                                           \n          RECORDSIZE(60 60) -                                                   \n          SHAREOPTIONS(1 4) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//TRANTYPE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANTYPE.PS                                      \n//TTYPVSAM DD DISP=OLD,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(TRANTYPE) OUTFILE(TTYPVSAM)                                     \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:08 CDT\n//*\n",
      "description": "This JCL job creates and populates a VSAM KSDS file for transaction types in the CardDemo application. The job executes in three steps: first deleting any existing transaction type file (STEP05), then defining a new VSAM KSDS file with a 2-byte key and 60-byte fixed-length records (STEP10), and finally copying data from a flat file into the newly created VSAM file (STEP15). The transaction type file (AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS) likely stores reference data for transaction type codes used throughout the CardDemo application.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "READCUST",
      "code": "//READCUST JOB 'Read Customer Data file',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYUID\n//* *******************************************************************\n//* RUN THE PROGRAM THAT READS THE CUSTOMER MASTER VSAM FILE\n//* *******************************************************************\n//STEP05 EXEC PGM=CBCUS01C\n//STEPLIB  DD DISP=SHR,\n//         DSN=AWS.M2.CARDDEMO.LOADLIB\n//CUSTFILE DD DISP=SHR,\n//         DSN=AWS.M2.CARDDEMO.CUSTDATA.VSAM.KSDS\n//SYSOUT   DD SYSOUT=*\n//SYSPRINT DD SYSOUT=*\n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:07 CDT\n//*\n",
      "description": "This JCL job executes program CBCUS01C which reads data from the customer master VSAM file. The job is part of the CardDemo application used for AWS mainframe migration demonstrations. It allocates the necessary datasets including the customer data KSDS file and standard output destinations. The job serves as a utility to access and potentially report on customer information stored in the VSAM file, supporting the application's data access capabilities.",
      "referenced_programs": [
        "CBCUS01C"
      ]
    },
    {
      "name": "DALYREJS",
      "code": "//DALYREJS JOB 'DEF GDG FOR REJS',CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID     \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************        \n//* *******************************************************************         \n//* DELETE TRANSACATION MASTER VSAM FILE IF ONE ALREADY EXISTS                  \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.DALYREJS) -                                            \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:05 CDT\n//*\n",
      "description": "This JCL job defines a Generation Data Group (GDG) for daily rejection records in the CardDemo application. It creates a GDG named AWS.M2.CARDDEMO.DALYREJS with a limit of 5 generations, meaning the system will maintain up to 5 historical versions of the dataset. The SCRATCH parameter indicates that expired generations will be automatically deleted. This GDG is likely used to store daily transaction rejection records that need to be maintained for a limited historical period for analysis or reporting purposes.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "TRANBKP",
      "code": "//TRANBKP JOB 'REPRO and Delete Transaction Master',CLASS=A,MSGCLASS=0,         \n//  NOTIFY=&SYSUID                    \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')                                  \n//* *******************************************************************        \n//* Repro the processed transaction file                                       \n//* *******************************************************************         \n//STEP05R EXEC PROC=REPROC,                                                     \n// CNTLLIB=AWS.M2.CARDDEMO.CNTL                                                 \n//*                                                                             \n//PRC001.FILEIN  DD DISP=SHR,                                                   \n//        DSN=AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS                                \n//*                                                                             \n//PRC001.FILEOUT DD DISP=(NEW,CATLG,DELETE),                                    \n//        UNIT=SYSDA,                                                           \n//        DCB=(LRECL=350,RECFM=FB,BLKSIZE=0),                                   \n//        SPACE=(CYL,(1,1),RLSE),                                               \n//        DSN=AWS.M2.CARDDEMO.TRANSACT.BKUP(+1)                                 \n//* *******************************************************************         \n//* DELETE TRANSACATION MASTER VSAM FILE IF ONE ALREADY EXISTS                  \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n   DELETE AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX -                                   \n          ALTERNATEINDEX                                                        \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE TRANSACATION MASTER VSAM FILE                                        \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS,COND=(4,LT)                                            \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(16 0) -                                                          \n          RECORDSIZE(350 350) -                                                 \n          SHAREOPTIONS(2 3) -                                 \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:08 CDT\n//*\n",
      "description": "This JCL job performs a backup and reset operation for the transaction master file in the CardDemo application. It first backs up the current transaction data from the VSAM KSDS file to a sequential backup dataset with a generation number, then deletes and redefines the transaction master VSAM file with its associated alternate index. The job consists of three main steps: STEP05R uses a custom REPROC procedure to copy the transaction data to a backup file, STEP05 deletes the existing VSAM cluster and alternate index, and STEP10 redefines the empty transaction master VSAM file with specific allocation parameters. This job is likely run periodically to archive processed transactions and reset the transaction master file for new processing cycles.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "CARDFILE",
      "code": "//CARDFILE JOB 'Delete define card data',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID              \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************       \n//*********************************************************************         \n//* Close files in CICS region                                                  \n//*********************************************************************         \n//CLCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(CARDDAT ) CLO'                                       \n /F CICSAWSA,'CEMT SET FIL(CARDAIX ) CLO'                                       \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DELETE CARD DATA VSAM FILE IF ONE ALREADY EXISTS                            \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n   DELETE AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX -                                   \n          ALTERNATEINDEX                                                        \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE CARD DATA VSAM FILE                                                  \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(16 0) -                                                          \n          RECORDSIZE(150 150) -                                                 \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//CARDDATA DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDDATA.PS                                      \n//CARDVSAM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(CARDDATA) OUTFILE(CARDVSAM)                                     \n/*                                                                              \n//*-------------------------------------------------------------------*         \n//* CREATE ALTERNATE INDEX ON ACCT ID                                           \n//*-------------------------------------------------------------------*         \n//STEP40  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   DEFINE ALTERNATEINDEX (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX)-              \n   RELATE(AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS)                    -              \n   KEYS(11 16)                                                   -              \n   NONUNIQUEKEY                                                  -              \n   UPGRADE                                                       -              \n   RECORDSIZE(150,150)                                           -              \n   VOLUMES(AWSHJ1)                                               -              \n   CYLINDERS(5,1))                                               -              \n   DATA (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX.DATA))           -              \n   INDEX (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX.INDEX))                        \n/*                                                                              \n//*-------------------------------------------------------------------*         \n//* DEFINE PATH IS USED TO RELATE THE ALTERNATE INDEX TO BASE CLUSTER           \n//*-------------------------------------------------------------------*         \n//STEP50  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n  DEFINE PATH                                           -                       \n   (NAME(AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX.PATH)        -                       \n    PATHENTRY(AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX))                               \n/*                                                                              \n//*------------------------------------------------------------------           \n//* BUILD ALTERNATE INDEX CLUSTER                                               \n//*-------------------------------------------------------------------*         \n//STEP60  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   BLDINDEX                                                      -              \n   INDATASET(AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS)                 -              \n   OUTDATASET(AWS.M2.CARDDEMO.CARDDATA.VSAM.AIX)                                \n/*                                                                              \n//*                                                                             \n//*********************************************************************         \n//* Open files in CICS region                                                   \n//*********************************************************************         \n//OPCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(CARDDAT ) OPE'                                       \n /F CICSAWSA,'CEMT SET FIL(CARDAIX ) OPE'                                       \n/*                                                                              \n//                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:04 CDT\n//*\n",
      "description": "This JCL job manages the VSAM files used for card data in the CardDemo application. It performs a complete refresh of the card data by first closing the files in the CICS region, deleting existing VSAM files, defining a new KSDS cluster, loading data from a flat file, creating an alternate index on the account ID field, building the path relationship, and finally reopening the files in CICS. The job ensures proper file access during maintenance by coordinating with the CICS region through SDSF commands. The alternate index provides secondary access to card records by account ID, supporting efficient lookups by this field in addition to the primary key.",
      "referenced_programs": [
        "SDSF",
        "IDCAMS"
      ]
    },
    {
      "name": "READCARD",
      "code": "//READCARD JOB 'READCARD',CLASS=A,MSGCLASS=0,                                   \n// NOTIFY=&SYSUID                \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* RUN THE PROGRAM THAT READS THE CARD MASTER VSAM FILE                        \n//* *******************************************************************         \n//STEP05 EXEC PGM=CBACT02C                                                      \n//STEPLIB  DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.LOADLIB                                          \n//CARDFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDDATA.VSAM.KSDS                               \n//SYSOUT   DD SYSOUT=*                                                          \n//SYSPRINT DD SYSOUT=*                                                          \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:07 CDT\n//*\n",
      "description": "This JCL job executes program CBACT02C which reads and processes data from the Card Master VSAM file. The job is part of the CardDemo application used for AWS mainframe migration demonstrations. It accesses the VSAM KSDS dataset containing card data and directs output to standard system output destinations. The job serves as a demonstration of basic file reading operations within the CardDemo application, likely used to showcase data access patterns during migration assessment or testing scenarios.",
      "referenced_programs": [
        "CBACT02C"
      ]
    },
    {
      "name": "TRANIDX",
      "code": "//TRANIDX JOB 'Define AIX on Transaction Master',CLASS=A,MSGCLASS=0,         \n//  NOTIFY=&SYSUID       \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************      \n//*-------------------------------------------------------------------*         \n//* CREATE ALTERNATE INDEX ON PROCESSED TIMESTAMP                               \n//*-------------------------------------------------------------------*         \n//STEP20  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   DEFINE ALTERNATEINDEX (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX)-              \n   RELATE(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS)                    -              \n   KEYS(26 304)                                                  -             \n   NONUNIQUEKEY                                                  -              \n   UPGRADE                                                       -              \n   RECORDSIZE(350,350)                                           -              \n   VOLUMES(AWSHJ1)                                               -              \n   CYLINDERS(5,1))                                               -              \n   DATA (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX.DATA))           -              \n   INDEX (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX.INDEX))                        \n/*                                                                              \n//*-------------------------------------------------------------------*         \n//* DEFINE PATH IS USED TO RELATE THE ALTERNATE INDEX TO BASE CLUSTER           \n//*-------------------------------------------------------------------*         \n//STEP25  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n  DEFINE PATH                                           -                       \n   (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX.PATH)        -                       \n    PATHENTRY(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX))                               \n/*                                                                              \n//*------------------------------------------------------------------           \n//* BUILD ALTERNATE INDEX CLUSTER                                               \n//*-------------------------------------------------------------------*         \n//STEP30  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   BLDINDEX                                                      -              \n   INDATASET(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS)                 -              \n   OUTDATASET(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX)                                \n/*  \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:08 CDT\n//*\n",
      "description": "This JCL job creates and builds an Alternate Index (AIX) for the CardDemo transaction master file. The job consists of three steps that define and implement a secondary access path to the transaction data based on a timestamp field. The AIX allows the application to efficiently retrieve transaction records in chronological order without requiring the base VSAM file to be physically sorted by timestamp. The job defines the AIX structure with non-unique keys, establishes a path relationship to the base cluster, and then builds the index using the existing transaction data. This secondary access method enhances the application's ability to process transactions based on their timestamp while maintaining the primary organization of the data.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "DEFCUST",
      "code": "//DEFCUST JOB 'Define Customer Data File',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//* *******************************************************************\n//* DELETE CUSTOMER VSAM FILE IF ONE ALREADY EXISTS\n//* *******************************************************************\n//STEP05 EXEC PGM=IDCAMS\n//SYSPRINT DD   SYSOUT=*\n//SYSIN    DD   *\n   DELETE AWS.CCDA.CUSTDATA.CLUSTER -\n          CLUSTER                     \n/*\n//*\n//* *******************************************************************\n//* DELETE CUSTOMER VSAM FILE IF ONE ALREADY EXISTS\n//* *******************************************************************\n//STEP05 EXEC PGM=IDCAMS\n//SYSPRINT DD   SYSOUT=*\n//SYSIN    DD   *\n   DEFINE CLUSTER (NAME(AWS.CUSTDATA.CLUSTER) - \n          CYLINDERS(1 5) -                      \n          KEYS(10 0) -                          \n          RECORDSIZE(500 500) -                 \n          SHAREOPTIONS(1 4) -                   \n          ERASE -                               \n          INDEXED -                             \n          ) -                                        \n          DATA (NAME(AWS.CUSTDATA.CLUSTER.DATA) -    \n          ) -                                        \n          INDEX (NAME(AWS.CUSTDATA.CLUSTER.INDEX) -  \n          )                                             \n/*\n",
      "description": "This JCL job defines a VSAM customer data file for the CardDemo application. It first attempts to delete any existing customer data cluster (AWS.CCDA.CUSTDATA.CLUSTER) using IDCAMS, then creates a new indexed VSAM cluster named AWS.CUSTDATA.CLUSTER with specific parameters: 1 primary and 5 secondary cylinders of space allocation, a 10-byte key starting at position 0, fixed 500-byte records, and share options of (1,4). The job creates both data and index components with corresponding names. This file is likely used to store customer information for the CardDemo application's various mainframe modernization demonstration scenarios.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "COMBTRAN",
      "code": "//COMBTRAN JOB 'COMBINE TRANSACTIONS',CLASS=A,MSGCLASS=0,                  \n//  NOTIFY=&SYSUID    \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//* *******************************************************************         \n//* Sort current transaction file and system generated transactions\n//* *******************************************************************         \n//STEP05R  EXEC PGM=SORT                                                        \n//SORTIN   DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.BKUP(0)                                \n//         DD DISP=SHR,\n//         DSN=AWS.M2.CARDDEMO.SYSTRAN(0)                                \n//SYMNAMES DD *                                                                 \nTRAN-ID,1,16,CH                                                         \n//SYSIN    DD *                                                                 \n SORT FIELDS=(TRAN-ID,A)                                                  \n/*                                                                              \n//SYSOUT   DD SYSOUT=*                                                          \n//SORTOUT  DD DISP=(NEW,CATLG,DELETE),                                          \n//         UNIT=SYSDA,                                                          \n//         DCB=(*.SORTIN),                                                      \n//         SPACE=(CYL,(1,1),RLSE),                                              \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.COMBINED(+1)                            \n//* *******************************************************************         \n//* Load combined file to transaction master\n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//TRANSACT DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.COMBINED(+1)                            \n//TRANVSAM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(TRANSACT) OUTFILE(TRANVSAM)                                     \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:05 CDT\n//*\n",
      "description": "This JCL job combines transaction records from two sources and loads them into a transaction master file. It first merges and sorts transactions from the regular transaction backup file and system-generated transactions, sorting them by transaction ID in ascending order. The sorted output is stored in a new generation of the combined transaction dataset. In the second step, the job uses IDCAMS REPRO to load these combined transactions into a VSAM KSDS file that serves as the transaction master. This job is part of the CardDemo application's transaction processing workflow, ensuring that both user-initiated and system-generated transactions are properly consolidated and made available for further processing.",
      "referenced_programs": [
        "SORT",
        "IDCAMS"
      ]
    },
    {
      "name": "OPENFIL",
      "code": "//OEPNFIL JOB 'Open files in CICS',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//*********************************************************************         \n//* Open files in CICS region                                                  \n//*********************************************************************         \n//OPCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(TRANSACT ) OPE'                                      \n /F CICSAWSA,'CEMT SET FIL(CCXREF ) OPE'                                        \n /F CICSAWSA,'CEMT SET FIL(ACCTDAT ) OPE'                                       \n /F CICSAWSA,'CEMT SET FIL(CXACAIX ) OPE'                                       \n /F CICSAWSA,'CEMT SET FIL(USRSEC ) OPE'                                       \n/*      \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:06 CDT\n//*\n",
      "description": "This JCL job opens critical files required by the CardDemo application in the CICS region. It executes the SDSF program to issue CEMT commands that set various files to OPEN status in the CICSAWSA region. The job opens five essential files: TRANSACT (transaction data), CCXREF (cross-reference data), ACCTDAT (account data), CXACAIX (account index), and USRSEC (user security information). This is a maintenance job that ensures the necessary files are available for the CardDemo application to function properly within the CICS environment.",
      "referenced_programs": [
        "SDSF"
      ]
    },
    {
      "name": "TCATBALF",
      "code": "//TCATBALF JOB 'DEFINE TRANCAT BAL',CLASS=A,MSGCLASS=0,                         \n// NOTIFY=&SYSUID          \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE TRANSACTION CATEGORY BALANCE VSAM FILE IF ONE ALREADY EXISTS         \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   SET    MAXCC = 0                                                             \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE TRANSACTION CATEGORY BALANCE VSAM FILE                               \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(17 0) -                                                          \n          RECORDSIZE(50 50) -                                                   \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//TCATBAL DD DISP=SHR,                                                          \n//         DSN=AWS.M2.CARDDEMO.TCATBALF.PS                                      \n//TCATBALV DD DISP=OLD,                                                         \n//         DSN=AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(TCATBAL) OUTFILE(TCATBALV)                                      \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:07 CDT\n//*\n",
      "description": "This JCL job creates and populates the Transaction Category Balance VSAM file for the CardDemo application. The job executes in three steps: first deleting any existing VSAM file with the same name (STEP05), then defining a new VSAM Key Sequenced Data Set with 17-byte keys and 50-byte fixed-length records (STEP10), and finally copying data from a flat file source into the newly created VSAM file (STEP15). The VSAM file is configured with primary allocation of 1 cylinder and secondary allocation of 5 cylinders on volume AWSHJ1, with appropriate sharing options for concurrent access.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "TRANFILE",
      "code": "//TRANFILE JOB 'DEFINE TRANSACTION MASTER',CLASS=A,MSGCLASS=0,                  \n//  NOTIFY=&SYSUID     \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//*********************************************************************         \n//* Close files in CICS region                                                  \n//*********************************************************************         \n//CLCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(TRANSACT ) CLO'                                      \n /F CICSAWSA,'CEMT SET FIL(CXACAIX ) CLO'                                       \n/*                                                                              \n//* *******************************************************************         \n//* DELETE TRANSACATION MASTER VSAM FILE IF ONE ALREADY EXISTS                  \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n   DELETE AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX -                                   \n          ALTERNATEINDEX                                                        \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE TRANSACATION MASTER VSAM FILE                                        \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(16 0) -                                                          \n          RECORDSIZE(350 350) -                                                 \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//TRANSACT DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.DALYTRAN.PS.INIT                                 \n//TRANVSAM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(TRANSACT) OUTFILE(TRANVSAM)                                     \n/*                                                                              \n//*-------------------------------------------------------------------*         \n//* CREATE ALTERNATE INDEX ON PROCESSED TIMESTAMP                               \n//*-------------------------------------------------------------------*         \n//STEP20  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   DEFINE ALTERNATEINDEX (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX)-              \n   RELATE(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS)                    -              \n   KEYS(26 304)                                                  -              \n   NONUNIQUEKEY                                                  -              \n   UPGRADE                                                       -              \n   RECORDSIZE(350,350)                                           -              \n   VOLUMES(AWSHJ1)                                               -              \n   CYLINDERS(5,1))                                               -              \n   DATA (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX.DATA))           -              \n   INDEX (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX.INDEX))                        \n/*                                                                              \n//*-------------------------------------------------------------------*         \n//* DEFINE PATH IS USED TO RELATE THE ALTERNATE INDEX TO BASE CLUSTER           \n//*-------------------------------------------------------------------*         \n//STEP25  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n  DEFINE PATH                                           -                       \n   (NAME(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX.PATH)        -                       \n    PATHENTRY(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX))                               \n/*                                                                              \n//*------------------------------------------------------------------           \n//* BUILD ALTERNATE INDEX CLUSTER                                               \n//*-------------------------------------------------------------------*         \n//STEP30  EXEC PGM=IDCAMS                                                       \n//SYSPRINT DD  SYSOUT=*                                                         \n//SYSIN    DD  *                                                                \n   BLDINDEX                                                      -              \n   INDATASET(AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS)                 -              \n   OUTDATASET(AWS.M2.CARDDEMO.TRANSACT.VSAM.AIX)                                \n/*                                                                              \n//*********************************************************************         \n//* Opem files in CICS region                                                   \n//*********************************************************************         \n//OPCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(TRANSACT ) OPE'                                      \n /F CICSAWSA,'CEMT SET FIL(CXACAIX ) OPE'                                       \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:08 CDT\n//*\n",
      "description": "This JCL job creates and initializes the Transaction Master VSAM file for the CardDemo application. The job performs several sequential operations: first closing any existing file connections in the CICS region, then deleting any existing Transaction Master files, defining a new VSAM key-sequenced dataset, loading initial transaction data from a flat file, creating an alternate index based on processed timestamp, defining a path relationship, and building the alternate index. The job concludes by reopening the files in the CICS region for application use. The alternate index provides a secondary access method to transaction records based on their timestamp, supporting time-based queries while maintaining the primary key access method.",
      "referenced_programs": [
        "SDSF",
        "IDCAMS"
      ]
    },
    {
      "name": "DEFGDGB",
      "code": "//DEFGDGB JOB 'DEF GDG BASES',CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID      \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************           \n//* *******************************************************************         \n//*  DEFINE GDG BASES NEEDED BY CARDDEMO PROJECT                                \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.TRANSACT.BKUP) -                                       \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n   IF LASTCC=12 THEN SET MAXCC=0                                                \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.TRANSACT.DALY) -                                       \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n   IF LASTCC=12 THEN SET MAXCC=0                                                \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.TRANREPT) -                                            \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n   IF LASTCC=12 THEN SET MAXCC=0                                                \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.TCATBALF.BKUP) -                                       \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n   IF LASTCC=12 THEN SET MAXCC=0                                                \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.SYSTRAN) -                                             \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n   IF LASTCC=12 THEN SET MAXCC=0                                                \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.TRANSACT.COMBINED) -                                   \n    LIMIT(5) -                                                                  \n    SCRATCH -                                                                   \n   )                                                                            \n   IF LASTCC=12 THEN SET MAXCC=0                                                \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:05 CDT\n//*\n",
      "description": "This job defines Generation Data Group (GDG) bases required by the CardDemo application. It executes the IDCAMS utility to create six GDG bases with a limit of 5 generations each and the SCRATCH option enabled (which automatically removes entries when they exceed the limit). The defined GDGs are used for various data management purposes within the CardDemo system, including transaction backups, daily transactions, transaction reports, account balance backups, system transactions, and combined transaction data. Error handling is implemented to continue processing even if a GDG already exists (by resetting the condition code when LASTCC=12).",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "CUSTFILE",
      "code": "//CUSTFILE JOB 'DEFINE CUSTOMER FILE',CLASS=A,MSGCLASS=0,                       \n//  NOTIFY=&SYSUID      \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//*********************************************************************         \n//* Close files in CICS region                                                  \n//*********************************************************************         \n//CLCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(CUSTDAT ) CLO'                                       \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DELETE CUSTOMER VSAM FILE IF ONE ALREADY EXISTS                             \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.CUSTDATA.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE CUSTOMER VSAM FILE                                                   \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.CUSTDATA.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(9 0) -                                                           \n          RECORDSIZE(500 500) -                                                 \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.CUSTDATA.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.CUSTDATA.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//CUSTDATA DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CUSTDATA.PS                                      \n//CUSTVSAM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CUSTDATA.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(CUSTDATA) OUTFILE(CUSTVSAM)                                     \n/*                                                                              \n//*********************************************************************         \n//* Open files in CICS region                                                   \n//*********************************************************************         \n//OPCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(CUSTDAT ) OPE'                                       \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:05 CDT\n//*\n",
      "description": "This JCL job creates and initializes the customer data VSAM file for the CardDemo application. The job follows a complete lifecycle process by first closing any existing file connections in CICS, deleting any existing customer file, defining a new VSAM key-sequenced dataset with a 9-byte key, and then populating it with data from a flat file source. After completion, it reopens the file in the CICS region for application use. The VSAM file is configured with specific allocation parameters (1 primary and 5 secondary cylinders) and fixed-length 500-byte records, making it accessible to the CardDemo application's customer data processing functions.",
      "referenced_programs": [
        "SDSF",
        "IDCAMS"
      ]
    },
    {
      "name": "TRANREPT",
      "code": "//TRANREPT JOB 'TRANSACTION REPORT',                                            \n// CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID              \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')                                  \n//* ********************************************************`***********        \n//* Unload the processed transaction file                                       \n//* *******************************************************************         \n//STEP05R EXEC PROC=REPROC,                                                     \n// CNTLLIB=AWS.M2.CARDDEMO.CNTL                                                 \n//*                                                                             \n//PRC001.FILEIN  DD DISP=SHR,                                                   \n//        DSN=AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS                                \n//*                                                                             \n//PRC001.FILEOUT DD DISP=(NEW,CATLG,DELETE),                                    \n//        UNIT=SYSDA,                                                           \n//        DCB=(LRECL=350,RECFM=FB,BLKSIZE=0),                                   \n//        SPACE=(CYL,(1,1),RLSE),                                               \n//        DSN=AWS.M2.CARDDEMO.TRANSACT.BKUP(+1)                                 \n//* *******************************************************************         \n//* Filter the transactions for a the parm date and sort by card num            \n//* *******************************************************************         \n//STEP05R  EXEC PGM=SORT                                                        \n//SORTIN   DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.BKUP(+1)                                \n//SYMNAMES DD *                                                                 \nTRAN-CARD-NUM,263,16,ZD                                                         \nTRAN-PROC-DT,305,10,CH                                                          \nPARM-START-DATE,C'2022-01-01'                                      //Date       \nPARM-END-DATE,C'2022-07-06'                                        //Date       \n//SYSIN    DD *                                                                 \n SORT FIELDS=(TRAN-CARD-NUM,A)                                                  \n INCLUDE COND=(TRAN-PROC-DT,GE,PARM-START-DATE,AND,                             \n         TRAN-PROC-DT,LE,PARM-END-DATE)                                         \n/*                                                                              \n//SYSOUT   DD SYSOUT=*                                                          \n//SORTOUT  DD DISP=(NEW,CATLG,DELETE),                                          \n//         UNIT=SYSDA,                                                          \n//         DCB=(*.SORTIN),                                                      \n//         SPACE=(CYL,(1,1),RLSE),                                              \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.DALY(+1)                                \n//* *******************************************************************         \n//* Produce a formatted report for processed transactions                       \n//* *******************************************************************         \n//STEP10R EXEC PGM=CBTRN03C                                                     \n//STEPLIB  DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.LOADLIB                                          \n//SYSOUT   DD SYSOUT=*                                                          \n//SYSPRINT DD SYSOUT=*                                                          \n//* Input files                                                                 \n//TRANFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.DALY(+1)                                \n//CARDXREF DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS                               \n//TRANTYPE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANTYPE.VSAM.KSDS                               \n//TRANCATG DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS                               \n//DATEPARM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.DATEPARM                                         \n//* Output files                                                                \n//TRANREPT DD DISP=(NEW,CATLG,DELETE),                                          \n//         UNIT=SYSDA,                                                          \n//         DCB=(LRECL=133,RECFM=FB,BLKSIZE=0),                                  \n//         SPACE=(CYL,(1,1),RLSE),                                              \n//         DSN=AWS.M2.CARDDEMO.TRANREPT(+1)                                     \n//                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:08 CDT\n//*\n",
      "description": "This JCL job generates a transaction report for the CardDemo application. It executes in three main steps: first, it unloads processed transaction data from a VSAM KSDS file to a sequential backup file; second, it filters transactions based on a specified date range (January 1, 2022 to July 6, 2022) and sorts them by card number; finally, it runs the CBTRN03C program to produce a formatted transaction report. The job accesses multiple reference files including card cross-reference data, transaction types, and transaction categories to enrich the report information. The resulting report is stored in the AWS.M2.CARDDEMO.TRANREPT dataset with standard report formatting (133-byte fixed-block records).",
      "referenced_programs": [
        "SORT",
        "CBTRN03C"
      ]
    },
    {
      "name": "REPTFILE",
      "code": "//REPTFILE JOB 'DEF GDG FOR REPORT FILE',                                       \n// CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID      \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE TRANSACATION MASTER VSAM FILE IF ONE ALREADY EXISTS                  \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE GENERATIONDATAGROUP -                                                 \n   (NAME(AWS.M2.CARDDEMO.TRANREPT) -                                            \n    LIMIT(10) -                                                                 \n   )                                                                            \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:07 CDT\n//*\n",
      "description": "This JCL job defines a Generation Data Group (GDG) for storing transaction reports in the CardDemo application. The job creates a GDG named AWS.M2.CARDDEMO.TRANREPT with a limit of 10 generations, meaning it will maintain up to 10 historical versions of the report file. The GDG structure allows the application to manage multiple iterations of transaction reports while automatically handling version control and retention policies.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "TRANCATG",
      "code": "//TRANCATG JOB 'DEFINE TRAN CATEGORY',                                          \n// CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID          \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE TRANSACTION CATEGORY TYPE VSAM FILE IF ONE ALREADY EXISTS            \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   SET    MAXCC = 0                                                             \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE TRANSACTION CATEGORY TYPE VSAM FILE                                  \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(6 0) -                                                           \n          RECORDSIZE(60 60) -                                                   \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//TRANCATG DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANCATG.PS                                      \n//TCATVSAM DD DISP=OLD,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(TRANCATG) OUTFILE(TCATVSAM)                                     \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:08 CDT\n//*\n",
      "description": "This JCL job creates and populates a VSAM KSDS file for transaction category types in the CardDemo application. The job executes in three steps: first deleting any existing transaction category VSAM file (STEP05), then defining a new VSAM KSDS file with a 6-byte key and 60-byte fixed-length records (STEP10), and finally copying data from a flat file into the newly created VSAM file (STEP15). The VSAM file is named AWS.M2.CARDDEMO.TRANCATG.VSAM.KSDS and is allocated with primary space of 1 cylinder and secondary space of 5 cylinders on volume AWSHJ1.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "INTCALC",
      "code": "//INTCALC JOB 'INTEREST CALCULATOR',CLASS=A,MSGCLASS=0,\n//   NOTIFY=&SYSUID           \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//* *******************************************************************         \n//* Process transaction balance file and compute interest and fees.\n//* *******************************************************************         \n//STEP15 EXEC PGM=CBACT04C,PARM='2022071800'                                    \n//STEPLIB  DD DISP=SHR,                                                         \n//            DSN=AWS.M2.CARDDEMO.LOADLIB                                       \n//SYSPRINT DD SYSOUT=*                                                          \n//SYSOUT   DD SYSOUT=*       \n//TCATBALF DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS      \n//XREFFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS    \n//XREFFIL1 DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.VSAM.AIX.PATH    \n//ACCTFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS                               \n//DISCGRP  DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.DISCGRP.VSAM.KSDS                                \n//TRANSACT DD DISP=(NEW,CATLG,DELETE),                                          \n//         UNIT=SYSDA,                                                          \n//         DCB=(RECFM=F,LRECL=350,BLKSIZE=0),                                   \n//         SPACE=(CYL,(1,1),RLSE),                                              \n//         DSN=AWS.M2.CARDDEMO.SYSTRAN(+1)           \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:06 CDT\n//*\n",
      "description": "This job calculates interest and fees for card transactions. It executes program CBACT04C with a date parameter (2022071800) and processes transaction balance data from VSAM files. The job reads from multiple input files including transaction balances (TCATBALF), card cross-references (XREFFILE and XREFFIL1), account data (ACCTFILE), and discount groups (DISCGRP). It generates transaction output that is stored in a new generation of the SYSTRAN dataset. This job is part of the CardDemo application which demonstrates AWS mainframe migration capabilities.",
      "referenced_programs": [
        "CBACT04C"
      ]
    },
    {
      "name": "DISCGRP",
      "code": "//DISCGRP JOB 'DEFINE DISCLOSURE GROUP FILE',CLASS=A,MSGCLASS=0,                \n//  NOTIFY=&SYSUID                                                \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE DISCLOSURE GROUP VSAM FILE IF ONE ALREADY EXISTS                     \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.DISCGRP.VSAM.KSDS -                                   \n          CLUSTER                                                               \n   SET    MAXCC = 0                                                             \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE DISCLOSURE GROUP VSAM FILE                                           \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.DISCGRP.VSAM.KSDS) -                    \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(16 0) -                                                          \n          RECORDSIZE(50 50) -                                                   \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.DISCGRP.VSAM.KSDS.DATA) -                  \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.DISCGRP.VSAM.KSDS.INDEX) -                \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//DISCGRP DD DISP=SHR,                                                          \n//         DSN=AWS.M2.CARDDEMO.DISCGRP.PS                                       \n//DISCVSAM DD DISP=OLD,                                                         \n//         DSN=AWS.M2.CARDDEMO.DISCGRP.VSAM.KSDS                                \n//SYSIN    DD   *                                                               \n   REPRO INFILE(DISCGRP) OUTFILE(DISCVSAM)                                      \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:06 CDT\n//*\n",
      "description": "This JCL job creates and populates a VSAM KSDS file for storing disclosure group information in the CardDemo application. The job executes in three steps: first deleting any existing disclosure group VSAM file (STEP05), then defining a new VSAM KSDS file with a 16-byte key and 50-byte fixed-length records (STEP10), and finally copying data from a flat file to the newly created VSAM file (STEP15). The disclosure group file is likely used to store categorization or grouping information related to card disclosures within the CardDemo application's business logic.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "READACCT",
      "code": "//READACCT JOB 'Read account Data',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//* *******************************************************************         \n//* RUN THE PROGRAM THAT READS THE ACCOUNT MASTER VSAM FILE                     \n//* *******************************************************************         \n//STEP05 EXEC PGM=CBACT01C                                                      \n//STEPLIB  DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.LOADLIB                                          \n//ACCTFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS                               \n//SYSOUT   DD SYSOUT=*                                                          \n//SYSPRINT DD SYSOUT=*                                                          \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:07 CDT\n//*\n",
      "description": "This JCL job executes program CBACT01C which reads data from the Account Master VSAM file in the CardDemo application. The job consists of a single step (STEP05) that accesses the VSAM KSDS dataset containing account information. It's designed to support AWS mainframe migration testing by demonstrating data access patterns for account information within the CardDemo application. Output from the program execution is directed to standard system output destinations.",
      "referenced_programs": [
        "CBACT01C"
      ]
    },
    {
      "name": "PRTCATBL",
      "code": "//PRTCATBL JOB 'Print Trasaction Category Balance File',                        \n// CLASS=A,MSGCLASS=0,NOTIFY=&SYSUID           \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')                                  \n//*\n//DELDEF   EXEC PGM=IEFBR14\n//THEFILE  DD DISP=(MOD,DELETE),\n//         UNIT=SYSDA,\n//         SPACE=(TRK,(1,1),RLSE),\n//         DSN=AWS.M2.CARDDEMO.TCATBALF.REPT\n//* ********************************************************`***********        \n//* Unload the processed transaction category balance file                      \n//* *******************************************************************         \n//STEP05R EXEC PROC=REPROC,                                                     \n// CNTLLIB=AWS.M2.CARDDEMO.CNTL                                                 \n//*                                                                             \n//PRC001.FILEIN  DD DISP=SHR,                                                   \n//        DSN=AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS                                \n//*                                                                             \n//PRC001.FILEOUT DD DISP=(NEW,CATLG,DELETE),                                    \n//        UNIT=SYSDA,                                                           \n//        DCB=(LRECL=50,RECFM=FB,BLKSIZE=0),                                   \n//        SPACE=(CYL,(1,1),RLSE),                                               \n//        DSN=AWS.M2.CARDDEMO.TCATBALF.BKUP(+1)                                 \n//* *******************************************************************         \n//* Filter the TCATBALFions for a the parm date and sort by card num            \n//* *******************************************************************         \n//STEP10R  EXEC PGM=SORT                                                        \n//SORTIN   DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TCATBALF.BKUP(+1)                                \n//SYMNAMES DD *                                                                 \nTRANCAT-ACCT-ID,1,11,ZD                                                         \nTRANCAT-TYPE-CD,12,2,CH                                                         \nTRANCAT-CD,14,4,ZD\nTRAN-CAT-BAL,18,11,ZD\n//SYSIN    DD *                                                                 \n SORT FIELDS=(TRANCAT-ACCT-ID,A,TRANCAT-TYPE-CD,A,TRANCAT-CD,A)                 \n OUTREC FIELDS=(TRANCAT-ACCT-ID,X,\n     TRANCAT-TYPE-CD,X,\n     TRANCAT-CD,X,\n     TRAN-CAT-BAL,EDIT=(TTTTTTTTT.TT),9X)\n/*                                                                              \n//SYSOUT   DD SYSOUT=*                                                          \n//SORTOUT  DD DISP=(NEW,CATLG,DELETE),                                          \n//         UNIT=SYSDA,                                                          \n//         DCB=(LRECL=40,RECFM=FB,BLKSIZE=0),                                   \n//         SPACE=(CYL,(1,1),RLSE),                                              \n//         DSN=AWS.M2.CARDDEMO.TCATBALF.REPT                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:06 CDT\n//*\n",
      "description": "This JCL job extracts and formats transaction category balance data from the CardDemo application. It first deletes any existing report file, then executes a processing procedure to unload data from a VSAM KSDS file to a backup dataset. The job then uses SORT to filter and organize the transaction category balances by account ID, transaction type code, and category code. The output is formatted with appropriate decimal editing for balance amounts and written to a report file. This job is part of the CardDemo application's reporting functionality, providing visibility into transaction category balances across accounts.",
      "referenced_programs": [
        "IEFBR14",
        "SORT"
      ]
    },
    {
      "name": "POSTTRAN",
      "code": "//POSTTRAN JOB 'POSTTRAN',CLASS=A,MSGCLASS=0,                                   \n// NOTIFY=&SYSUID           \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* Process and load daily transaction file and create transaction              \n//* category balance and update transaction master vsam                         \n//* *******************************************************************         \n//STEP15 EXEC PGM=CBTRN02C                                                      \n//STEPLIB  DD DISP=SHR,                                                         \n//            DSN=AWS.M2.CARDDEMO.LOADLIB                                       \n//SYSPRINT DD SYSOUT=*                                                          \n//SYSOUT   DD SYSOUT=*                                                          \n//TRANFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TRANSACT.VSAM.KSDS                               \n//DALYTRAN DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.DALYTRAN.PS                                      \n//XREFFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.CARDXREF.VSAM.KSDS                               \n//DALYREJS DD DISP=(NEW,CATLG,DELETE),                                          \n//         UNIT=SYSDA,                                                          \n//         DCB=(RECFM=F,LRECL=430,BLKSIZE=0),                                   \n//         SPACE=(CYL,(1,1),RLSE),                                              \n//         DSN=AWS.M2.CARDDEMO.DALYREJS(+1)                                     \n//ACCTFILE DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS                               \n//TCATBALF DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.TCATBALF.VSAM.KSDS                               \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:06 CDT\n//*\n",
      "description": "This JCL job processes daily credit card transactions for the CardDemo application. It executes program CBTRN02C which reads daily transaction data, updates the transaction master VSAM file, and creates transaction category balances. The job accesses multiple key files including transaction records, card cross-reference data, account information, and transaction category balances. It also generates a rejection file for any transactions that cannot be processed. This job represents a critical daily batch process within the credit card processing workflow of the CardDemo application.",
      "referenced_programs": [
        "CBTRN02C"
      ]
    },
    {
      "name": "CLOSEFIL",
      "code": "//CLOSEFIL JOB 'Close files in CICS',CLASS=A,MSGCLASS=0,\n// NOTIFY=&SYSUID\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//*********************************************************************         \n//* Close files in CICS region                                                  \n//*********************************************************************         \n//CLCIFIL EXEC PGM=SDSF                                                         \n//ISFOUT DD SYSOUT=*                                                            \n//CMDOUT DD SYSOUT=*                                                            \n//ISFIN  DD *                                                                   \n /F CICSAWSA,'CEMT SET FIL(TRANSACT ) CLO'                                      \n /F CICSAWSA,'CEMT SET FIL(CCXREF ) CLO'                                        \n /F CICSAWSA,'CEMT SET FIL(ACCTDAT ) CLO'                                       \n /F CICSAWSA,'CEMT SET FIL(CXACAIX ) CLO'                                       \n /F CICSAWSA,'CEMT SET FIL(USRSEC ) CLO'                                       \n/*      \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:05 CDT\n//*\n",
      "description": "This JCL job is designed to close specific files in the CICSAWSA CICS region. It uses the SDSF program to issue CEMT commands that close five critical files used by the CardDemo application: TRANSACT, CCXREF, ACCTDAT, CXACAIX, and USRSEC. This job would typically be run during maintenance windows or before backup operations to ensure data integrity by properly closing the files in the CICS environment.",
      "referenced_programs": [
        "SDSF"
      ]
    },
    {
      "name": "ACCTFILE",
      "code": "//ACCTFILE JOB 'Delete define Account Data',CLASS=A,MSGCLASS=0,                 \n// NOTIFY=&SYSUID                         \n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************            \n//* *******************************************************************         \n//* DELETE ACCOUNT VSAM FILE IF ONE ALREADY EXISTS                              \n//* *******************************************************************         \n//STEP05 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DELETE AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS -                                  \n          CLUSTER                                                               \n   IF MAXCC LE 08 THEN SET MAXCC = 0                                            \n/*                                                                              \n//*                                                                             \n//* *******************************************************************         \n//* DEFINE ACCOUNT VSAM FILE                                                    \n//* *******************************************************************         \n//STEP10 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//SYSIN    DD   *                                                               \n   DEFINE CLUSTER (NAME(AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS) -                   \n          CYLINDERS(1 5) -                                                      \n          VOLUMES(AWSHJ1 -                                                      \n          ) -                                                                   \n          KEYS(11 0) -                                                          \n          RECORDSIZE(300 300) -                                                 \n          SHAREOPTIONS(2 3) -                                                   \n          ERASE -                                                               \n          INDEXED -                                                             \n          ) -                                                                   \n          DATA (NAME(AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS.DATA) -                 \n          ) -                                                                   \n          INDEX (NAME(AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS.INDEX) -               \n          )                                                                     \n/*                                                                              \n//* *******************************************************************         \n//* COPY DATA FROM FLAT FILE TO VSAM FILE                                       \n//* *******************************************************************         \n//STEP15 EXEC PGM=IDCAMS                                                        \n//SYSPRINT DD   SYSOUT=*                                                        \n//ACCTDATA DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.ACCTDATA.PS                                      \n//ACCTVSAM DD DISP=SHR,                                                         \n//         DSN=AWS.M2.CARDDEMO.ACCTDATA.VSAM.KSDS                               \n//SYSIN    DD   *                                                               \n   REPRO INFILE(ACCTDATA) OUTFILE(ACCTVSAM)                                     \n/*                                                                              \n//*\n//* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:23:04 CDT\n//*\n",
      "description": "This JCL job manages the Account Data VSAM file for the CardDemo application. It performs three main operations in sequence: first deleting any existing Account Data VSAM file (STEP05), then defining a new VSAM key-sequenced dataset with specific parameters including 11-byte keys and 300-byte fixed-length records (STEP10), and finally populating the newly created VSAM file by copying data from a flat file source (STEP15). The job includes error handling to prevent failures if the initial delete operation finds no existing file to delete.",
      "referenced_programs": [
        "IDCAMS"
      ]
    },
    {
      "name": "CBADMCDJ",
      "code": "//CBADMCDJ JOB (COBOL),'AWSCODR',CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),\n//         NOTIFY=&SYSUID,TIME=1440\n//******************************************************************\n//* Copyright Amazon.com, Inc. or its affiliates.                   \n//* All Rights Reserved.                                            \n//*                                                                 \n//* Licensed under the Apache License, Version 2.0 (the \"License\"). \n//* You may not use this file except in compliance with the License.\n//* You may obtain a copy of the License at                         \n//*                                                                 \n//*    http://www.apache.org/licenses/LICENSE-2.0                   \n//*                                                                 \n//* Unless required by applicable law or agreed to in writing,      \n//* software distributed under the License is distributed on an     \n//* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n//* either express or implied. See the License for the specific     \n//* language governing permissions and limitations under the License\n//******************************************************************\n//*********************************************************************\n//****  Create Resources for Card Demo application               ******\n//*********************************************************************\n//*  ---------------------------\n//*  SET PARMS FOR THIS JOB:\n//*  ---------------------------\n//   SET HLQ=AWS.M2.CARDDEMO\n//*\n//STEP1   EXEC PGM=DFHCSDUP,REGION=0M,\n//          PARM='CSD(READWRITE),PAGESIZE(60),NOCOMPAT'\n//STEPLIB  DD  DSN=OEM.CICSTS.V05R06M0.CICS.SDFHLOAD,DISP=SHR\n//DFHCSD   DD  UNIT=SYSDA,DISP=SHR,DSN=OEM.CICSTS.DFHCSD\n//OUTDD    DD  SYSOUT=*\n//SYSPRINT DD  SYSOUT=*\n//SYSIN    DD  *,SYMBOLS=JCLONLY\n*/********************************************************************/\n*/*  CARDDEMO CICS DEFINITIONS                                       */\n*/********************************************************************/\n* NOTE: INSTALL GROUP(CARDDEMO) - CEDA IN G(CARDDEMO)                *\n*     IF YOU ARE RERUNNING THIS, UNCOMMENT THE DELETE COMMAND. *\n*\n* START CARDDEMO RESOURCES:\n*\n* DELETE GROUP(CARDDEMO)\n\n  DEFINE LIBRARY(COM2DOLL) GROUP(CARDDEMO)\n                DSNAME01(&HLQ..LOADLIB)\n\n* DEFINE TDQUEUE(CSSD) GROUP(CARDDEMO) TYPE(INTRA)\n* DEFINE TDQUEUE(IRDC) GROUP(CARDDEMO) TYPE(INTRA)\n\n  DEFINE MAPSET(COSGN00M)   GROUP(CARDDEMO)\n         DESCRIPTION(LOGIN SCREEN)\n\n  DEFINE MAPSET(COSGN00M)   GROUP(CARDDEMO)\n         DESCRIPTION(LOGIN SCREEN)\n\n  DEFINE MAPSET(COACT00S)   GROUP(CARDDEMO)\n         DESCRIPTION(ACCOUNT MENU)\n  DEFINE MAPSET(COACTVWS)   GROUP(CARDDEMO)\n         DESCRIPTION(VIEW ACCOUNT)\n  DEFINE MAPSET(COACTUPS)   GROUP(CARDDEMO)\n         DESCRIPTION(UPDATE ACCOUNT)\n  DEFINE MAPSET(COACTDES)   GROUP(CARDDEMO)\n         DESCRIPTION(DEACTIVATE ACCOUNT)\n\n  DEFINE MAPSET(COACT00S)   GROUP(CARDDEMO)\n         DESCRIPTION(CARD MENU)\n  DEFINE MAPSET(COACTVWS)   GROUP(CARDDEMO)\n         DESCRIPTION(VIEW CARD)\n  DEFINE MAPSET(COACTUPS)   GROUP(CARDDEMO)\n         DESCRIPTION(UPDATE CARD)\n  DEFINE MAPSET(COACTDES)   GROUP(CARDDEMO)\n         DESCRIPTION(DEACTIVATE CARD)\n\n  DEFINE MAPSET(COTRN00S)   GROUP(CARDDEMO)\n         DESCRIPTION(TRANSACTION)\n  DEFINE MAPSET(COTRNVWS)   GROUP(CARDDEMO)\n         DESCRIPTION(TRANSACTION REPORT)\n  DEFINE MAPSET(COTRNVDS)   GROUP(CARDDEMO)\n         DESCRIPTION(TRANSACTION DETAILS)\n  DEFINE MAPSET(COTRNATS)   GROUP(CARDDEMO)\n         DESCRIPTION(ADD TRANSACTIONS)\n\n  DEFINE MAPSET(COBIL00S)   GROUP(CARDDEMO)\n         DESCRIPTION(BILL PAY SETUP)\n\n  DEFINE MAPSET(COADM00S)   GROUP(CARDDEMO)\n         DESCRIPTION(ADMIN MENU)\n\n  DEFINE MAPSET(COTSTP1S)   GROUP(CARDDEMO)\n         DESCRIPTION(PGM1 TEST)\n  DEFINE MAPSET(COTSTP2S)   GROUP(CARDDEMO)\n         DESCRIPTION(PGM2 TEST)\n  DEFINE MAPSET(COTSTP3S)   GROUP(CARDDEMO)\n         DESCRIPTION(PGM3 TEST)\n  DEFINE MAPSET(COTSTP4S)   GROUP(CARDDEMO)\n         DESCRIPTION(PGM4 TEST)\n\n  DEFINE PROGRAM(COSGN00C) GROUP(CARDDEMO) DA(ANY) TRANSID(CC00)\n         DESCRIPTION(LOGIN)\n\n  DEFINE PROGRAM(COACT00C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(ACCOUNT MAIN MENU)\n  DEFINE PROGRAM(COACTVWC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(VIEW ACCOUNT)\n  DEFINE PROGRAM(COACTUPC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(UPDATE ACCOUNT)\n  DEFINE PROGRAM(COACTDEC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(DEACTIVATE ACCOUNT)\n\n  DEFINE PROGRAM(COACT00C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(CARD MENU)\n  DEFINE PROGRAM(COACTVWC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(VIEW CARD)\n  DEFINE PROGRAM(COACTUPC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(UPDATE CARD)\n  DEFINE PROGRAM(COACTDEC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(DEACTIVATE CARD)\n  DEFINE PROGRAM(COTRN00C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(TRANSACTION)\n  DEFINE PROGRAM(COTRNVWC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(TRANSACTION REPORT)\n  DEFINE PROGRAM(COTRNVDC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(TRANSACTION DETAILS)\n  DEFINE PROGRAM(COTRNATC) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(ADD TRANSACTIONS)\n\n  DEFINE PROGRAM(COBIL00C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(BILL PAY)\n\n  DEFINE PROGRAM(COADM00C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(ADMIN MENU)\n         TRANSID(CCAD)\n\n  DEFINE PROGRAM(COTSTP1C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(PGM1 TEST)\n         TRANSID(CCT1)\n  DEFINE PROGRAM(COTSTP2C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(PGM2 TEST)\n         TRANSID(CCT2)\n  DEFINE PROGRAM(COTSTP3C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(PGM1 TEST)\n         TRANSID(CCT3)\n  DEFINE PROGRAM(COTSTP4C) GROUP(CARDDEMO) DA(ANY)\n         DESCRIPTION(PGM4 TEST)\n         TRANSID(CCT4)\n\n  DEFINE TRANSACTION(CCDM) GROUP(CARDDEMO)\n                PROGRAM(COADM00C) TASKDATAL(ANY)\n\n  DEFINE TRANSACTION(CCT1) GROUP(CARDDEMO)\n                PROGRAM(COTSTP1C) TASKDATAL(ANY)\n  DEFINE TRANSACTION(CCT2) GROUP(CARDDEMO)\n                PROGRAM(COTSTP2C) TASKDATAL(ANY)\n  DEFINE TRANSACTION(CCT3) GROUP(CARDDEMO)\n                PROGRAM(COTSTP3C) TASKDATAL(ANY)\n  DEFINE TRANSACTION(CCT4) GROUP(CARDDEMO)\n                PROGRAM(COTSTP4C) TASKDATAL(ANY)\n\n  LIST   GROUP(CARDDEMO)\n*\n* END CARDDEMO RESOURCES\n*\n/*\n//\n//*\n//* Ver: CardDemo_v1.0-70-g193b394-123 Date: 2022-08-22 17:02:44 CDT\n//*\n",
      "description": "This JCL job creates CICS resources required for the CardDemo application. It executes the DFHCSDUP utility to define various CICS resources in the CARDDEMO group, including a library definition pointing to the application's load library, multiple mapsets for different screens (login, account management, card operations, transactions, bill pay, and admin functions), program definitions with their associated descriptions, and transaction definitions that link to specific programs. The job is designed to set up the complete CICS environment needed for the CardDemo application to function, with resources organized to support various credit card management operations.",
      "referenced_programs": [
        "DFHCSDUP"
      ]
    }
  ],
  "assemblies": [],
  "project_name": "Project",
  "language": null,
  "overview": "## Project Description\nCardDemo is a comprehensive mainframe application designed to showcase AWS and partner technologies for mainframe migration and modernization use-cases.\n\n## Summary\nCardDemo simulates a credit card processing system with complete functionality for account management, transaction processing, user administration, and reporting. The application demonstrates various mainframe technologies and patterns to serve as a test bed for migration strategies, modernization approaches, service enablement, and performance testing. It includes both online (CICS) and batch components that work together to provide a complete business solution.\n\n## Technologies\n- COBOL\n- CICS (Customer Information Control System)\n- JCL (Job Control Language)\n- VSAM (Virtual Storage Access Method)\n- IBM Language Environment\n- Batch processing\n- Transient Data Queues (TDQ)\n\n## Dependencies\n- VSAM Files:\n  - CUSTFILE (Customer information)\n  - ACCTFILE/ACCTDAT (Account data)\n  - CARDFILE/CARDDAT (Credit card information)\n  - TRANSACT (Transaction records)\n  - CXACAIX (Account cross-reference)\n  - USRSEC (User security information)\n  - XREFFILE (Card-to-account cross-reference)\n  - TRANTYPE (Transaction type definitions)\n  - TRANCATG (Transaction category definitions)\n  - DISCGRP (Disclosure group/interest rate information)\n- Batch Jobs:\n  - POSTTRAN (Transaction posting)\n  - INTCALC (Interest calculation)\n  - TRANREPT (Transaction reporting)\n  - COMBTRAN (Transaction processing)\n- Utilities:\n  - CSUTLDTC (Date validation utility)\n\n## Starting Points\n- Online Entry Points:\n  - COSGN00C: Sign-on screen and authentication\n  - COMEN01C: Main menu for regular users\n  - COADM01C: Administrative menu\n- Key Batch Processes:\n  - CBTRN01C: Daily transaction validation\n  - CBTRN02C: Transaction posting to accounts\n  - CBACT04C: Interest calculation\n  - CBTRN03C: Transaction reporting\n- Core Business Functions:\n  - COTRN00C/COTRN01C: Transaction viewing\n  - COTRN02C: Transaction entry\n  - COBIL00C: Bill payment\n  - COACTVWC: Account viewing\n  - COCRDLIC: Credit card listing\n\n## Architecture\nCardDemo follows a traditional mainframe architecture with separation between online and batch components. The online system is built on CICS with screen-based navigation between related functions, while batch processes handle periodic tasks like transaction posting and interest calculation.\n\nThe application uses a modular design with clear separation of concerns:\n- User interface components (CO* programs) handle screen interactions\n- Batch programs (CB* programs) process data in bulk\n- Utility components (CS* programs) provide shared functionality\n- Data is stored in VSAM files with indexed access for online lookups\n\nThe system maintains data integrity through proper file handling, transaction management, and validation routines. It demonstrates typical mainframe patterns including master file updates, transaction processing, reporting, and administrative functions. The application uses a communication area (commarea) to maintain context between screens and implements role-based access control for administrative functions.",
  "repo_url": null,
  "repo_name": null,
  "architecture_overview": "## High-Level Architecture\n\nThe CardDemo application is a traditional mainframe application designed to showcase AWS and partner technologies for mainframe migration and modernization. It follows a classic layered architecture typical of mainframe systems, with clear separation between online (CICS) and batch processing components. The system implements a transaction-oriented design pattern with centralized data access through VSAM files.\n\n### Core Components\n\n- **User Interface Layer**: \n  - Sign-on and Menu Systems: COSGN00C (sign-on handler), COMEN01C (regular user menu), COADM01C (admin menu)\n  - Screen-based interfaces for various business functions with standardized navigation patterns\n\n- **Business Logic Layer**:\n  - Account Management: COACTVWC (view accounts), COACTUPC (update accounts)\n  - Card Management: COCRDLIC (list cards), COCRDSLC (view card details), COCRDUPC (update card details)\n  - Transaction Management: COTRN00C (list transactions), COTRN01C (view transactions), COTRN02C (add transactions)\n  - Bill Payment: COBIL00C (online bill payment)\n  - Report Generation: CORPT00C (report submission interface)\n\n- **User Administration Module**:\n  - User Management: COUSR00C (list users), COUSR01C (add users), COUSR02C (update users), COUSR03C (delete users)\n  - Role-based access control (admin vs. regular users)\n\n- **Batch Processing Layer**:\n  - Account Processing: CBACT01C, CBACT02C, CBACT03C, CBACT04C (interest calculation)\n  - Transaction Processing: CBTRN01C (transaction validation), CBTRN02C (transaction posting), CBTRN03C (transaction reporting)\n  - Customer Data Processing: CBCUS01C\n\n- **Utility Services**:\n  - Date Validation: CSUTLDTC (leverages IBM Language Environment for date validation)\n\n### Component Relationships\n\n- **Data Flow**:\n  1. Users authenticate through COSGN00C\n  2. Based on user type, they are directed to either COMEN01C (regular) or COADM01C (admin)\n  3. Users navigate to specific business functions through menu options\n  4. Business logic components interact with data files and return results to the user interface\n  5. Batch processes run independently to process transactions, calculate interest, and generate reports\n\n- **Communication Patterns**:\n  - Online components use CICS COMMAREA for state management between screens\n  - Programs transfer control to each other using CICS XCTL commands\n  - Batch job submission from online components via transient data queues (TDQ)\n  - Standardized error handling and status code processing across components\n\n- **Dependencies**:\n  - Menu systems (COMEN01C, COADM01C) depend on authentication from COSGN00C\n  - Transaction viewing (COTRN01C) depends on transaction listing (COTRN00C)\n  - Card detail screens (COCRDSLC, COCRDUPC) depend on card listing (COCRDLIC)\n  - User management functions (COUSR02C, COUSR03C) depend on user listing (COUSR00C)\n  - Report generation (CORPT00C) submits batch jobs that depend on transaction data\n\n### External Dependencies\n\n- **Data Storage**:\n  - VSAM Files:\n    - CUSTDAT/CUSTFILE: Customer information\n    - ACCTDAT/ACCTFILE: Account information\n    - CARDDAT/CARDFILE: Credit card information\n    - TRANSACT: Transaction records\n    - USRSEC: User security profiles\n    - CXACAIX/XREFFILE: Cross-reference data for accounts and cards\n    - Transaction type and category reference files\n\n- **Runtime Environment**:\n  - CICS Transaction Server for online components\n  - Batch processing environment for scheduled and on-demand jobs\n  - IBM Language Environment (for date validation via CEEDAYS API)\n\n- **Integration Points**:\n  - Internal reader for job submission (via \"JOBS\" TDQ)\n  - Potential integration with external payment systems (implied by COBIL00C)\n\n### Technical Constraints\n\n- **Platform Requirements**:\n  - Traditional mainframe environment (likely z/OS)\n  - COBOL programming language\n  - CICS for online transaction processing\n  - VSAM for data storage\n  - JCL for batch job control\n\n- **Performance Considerations**:\n  - Pagination implemented for large data sets (COTRN00C, COUSR00C, COCRDLIC)\n  - Optimized file access patterns with indexed VSAM files\n  - Batch processing for resource-intensive operations\n\n- **Security Requirements**:\n  - Role-based access control (admin vs. regular users)\n  - User authentication through sign-on process\n  - Function-level authorization (preventing regular users from accessing admin functions)\n\n- **Scalability Considerations**:\n  - Batch processing for high-volume operations\n  - Separation of online and batch components to manage system load\n  - Transaction-oriented design for consistent processing\n\nThe CardDemo application represents a comprehensive demonstration of typical mainframe financial application patterns, with clear separation of concerns between user interface, business logic, and data access components. Its modular design facilitates the showcasing of various migration and modernization approaches when moving to AWS environments.",
  "architecture_diagram": "C4Context\n    title System Context diagram for CardDemo AWS Mainframe Application\n\n    Person(admin, \"Administrator\", \"System administrator with full access\")\n    Person(user, \"Regular User\", \"Customer with limited access\")\n    \n    System_Boundary(cardDemo, \"CardDemo Application\") {\n        System(authSystem, \"Authentication System\", \"User authentication and access control\")\n        System(accountSystem, \"Account Management\", \"Handles account data and operations\")\n        System(cardSystem, \"Card Management\", \"Manages credit card information\")\n        System(transactionSystem, \"Transaction Processing\", \"Processes and manages transactions\")\n        System(reportingSystem, \"Reporting System\", \"Generates reports and analytics\")\n        System(adminSystem, \"Administration System\", \"User and system administration\")\n    }\n    \n    SystemDb(mainframeDb, \"Mainframe Database\", \"VSAM files storing customer, account, card, and transaction data\")\n    \n    System_Ext(batchSystem, \"Batch Processing System\", \"Handles scheduled batch operations\")\n    \n    Rel(user, authSystem, \"Authenticates via\")\n    Rel(admin, authSystem, \"Authenticates via\")\n    \n    Rel(authSystem, adminSystem, \"Routes admin users to\")\n    Rel(authSystem, accountSystem, \"Routes regular users to\")\n    \n    Rel(accountSystem, mainframeDb, \"Reads/writes account data\")\n    Rel(cardSystem, mainframeDb, \"Reads/writes card data\")\n    Rel(transactionSystem, mainframeDb, \"Reads/writes transaction data\")\n    Rel(adminSystem, mainframeDb, \"Manages user data\")\n    \n    Rel(accountSystem, cardSystem, \"References\")\n    Rel(cardSystem, transactionSystem, \"Triggers\")\n    \n    Rel(admin, adminSystem, \"Manages users and system\")\n    Rel(user, accountSystem, \"Views/updates accounts\")\n    Rel(user, cardSystem, \"Views/manages cards\")\n    Rel(user, transactionSystem, \"Views/creates transactions\")\n    \n    Rel(reportingSystem, mainframeDb, \"Generates reports from\")\n    Rel(user, reportingSystem, \"Requests reports from\")\n    Rel(admin, reportingSystem, \"Requests reports from\")\n    \n    Rel(batchSystem, transactionSystem, \"Processes daily transactions\")\n    Rel(batchSystem, accountSystem, \"Updates account balances\")\n    Rel(batchSystem, reportingSystem, \"Generates scheduled reports\")"
}